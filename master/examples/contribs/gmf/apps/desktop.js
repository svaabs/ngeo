/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./contribs/gmf/apps/desktop/Controller.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./contribs/gmf/apps/appmodule.js":
/*!****************************************!*\
  !*** ./contribs/gmf/apps/appmodule.js ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");


var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('app', []);
module.config(['$compileProvider', function ($compileProvider) {
  if (!('debug' in Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["decodeQueryString"])(window.location.search))) {
    $compileProvider.debugInfoEnabled(false);
  }
}]);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/apps/desktop/Controller.js":
/*!*************************************************!*\
  !*** ./contribs/gmf/apps/desktop/Controller.js ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _sass_desktop_scss__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./sass/desktop.scss */ "./contribs/gmf/apps/desktop/sass/desktop.scss");
/* harmony import */ var _sass_desktop_scss__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_sass_desktop_scss__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_controllers_desktop_scss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/controllers/desktop.scss */ "./contribs/gmf/src/controllers/desktop.scss");
/* harmony import */ var gmf_controllers_desktop_scss__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(gmf_controllers_desktop_scss__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _sass_vars_desktop_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./sass/vars_desktop.scss */ "./contribs/gmf/apps/desktop/sass/vars_desktop.scss");
/* harmony import */ var _sass_vars_desktop_scss__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_sass_vars_desktop_scss__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var gmf_controllers_AbstractDesktopController_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/controllers/AbstractDesktopController.js */ "./contribs/gmf/src/controllers/AbstractDesktopController.js");
/* harmony import */ var _appmodule_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../appmodule.js */ "./contribs/gmf/apps/appmodule.js");
/* harmony import */ var _geoblocks_proj_src_EPSG_2056_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @geoblocks/proj/src/EPSG_2056.js */ "./node_modules/@geoblocks/proj/src/EPSG_2056.js");
/* harmony import */ var _geoblocks_proj_src_EPSG_21781_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @geoblocks/proj/src/EPSG_21781.js */ "./node_modules/@geoblocks/proj/src/EPSG_21781.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }










if (!window.requestAnimationFrame) {
  alert('Your browser is not supported, please update it or use another one. You will be redirected.\n\n' + 'Votre navigateur n\'est pas supporté, veuillez le mettre à jour ou en utiliser un autre. ' + 'Vous allez être redirigé.\n\n' + 'Ihr Browser wird nicht unterstützt, bitte aktualisieren Sie ihn oder verwenden Sie einen anderen. ' + 'Sie werden weitergeleitet.');
  window.location.href = 'https://geomapfish.org/';
}

var Controller = function (_AbstractDesktopContr) {
  Controller.$inject = ["$scope", "$injector"];

  _inheritsLoose(Controller, _AbstractDesktopContr);

  function Controller($scope, $injector) {
    var _this;

    _this = _AbstractDesktopContr.call(this, {
      srid: 2056,
      mapViewConfig: {
        center: [2632464, 1185457],
        zoom: 3,
        resolutions: [250, 100, 50, 20, 10, 5, 2, 1, 0.5, 0.25, 0.1, 0.05],
        constrainResolution: true,
        extent: [2485071.54, 175346.36, 2828515.78, 1299941.84]
      }
    }, $scope, $injector) || this;
    _this.searchCoordinatesProjections = [_geoblocks_proj_src_EPSG_21781_js__WEBPACK_IMPORTED_MODULE_7__["default"], _geoblocks_proj_src_EPSG_2056_js__WEBPACK_IMPORTED_MODULE_6__["default"], 'EPSG:4326'];
    _this.scaleSelectorValues = [250000, 100000, 50000, 20000, 10000, 5000, 2000, 1000, 500, 250, 100, 50];
    _this.elevationLayers = ['aster', 'srtm'];
    _this.elevationLayersConfig = {};
    _this.selectedElevationLayer = _this.elevationLayers[0];
    _this.profileLinesconfiguration = {
      'aster': {
        color: '#0000A0'
      },
      'srtm': {
        color: '#00A000'
      }
    };
    _this.mousePositionProjections = [{
      code: _geoblocks_proj_src_EPSG_2056_js__WEBPACK_IMPORTED_MODULE_6__["default"],
      label: 'CH1903+ / LV95',
      filter: 'ngeoNumberCoordinates::{x}, {y} m'
    }, {
      code: _geoblocks_proj_src_EPSG_21781_js__WEBPACK_IMPORTED_MODULE_7__["default"],
      label: 'CH1903 / LV03',
      filter: 'ngeoNumberCoordinates::{x}, {y} m'
    }, {
      code: 'EPSG:4326',
      label: 'WGS84',
      filter: 'ngeoDMSCoordinates:2'
    }];
    var gettextCatalog = $injector.get('gettextCatalog');
    gettextCatalog.getString('Add a theme');
    gettextCatalog.getString('Add a sub theme');
    gettextCatalog.getString('Add a layer');
    return _this;
  }

  return Controller;
}(gmf_controllers_AbstractDesktopController_js__WEBPACK_IMPORTED_MODULE_4__["AbstractDesktopController"]);

var module = angular__WEBPACK_IMPORTED_MODULE_3___default.a.module('Appdesktop', [_appmodule_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, gmf_controllers_AbstractDesktopController_js__WEBPACK_IMPORTED_MODULE_4__["default"].name]);
module.value('gmfContextualdatacontentTemplateUrl', 'gmf/contextualdata');
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/contextualdata', __webpack_require__(/*! ./contextualdata.html */ "./contribs/gmf/apps/desktop/contextualdata.html"));
}]);
module.controller('DesktopController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/apps/desktop/contextualdata.html":
/*!*******************************************************!*\
  !*** ./contribs/gmf/apps/desktop/contextualdata.html ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<table>\n  <tr>\n    <td translate>\n      Swiss grid (LV95)\n    </td>\n    <td>\n      {{coord_2056|ngeoNumberCoordinates:0:\'{x} / {y}\'}}\n    </td>\n  </tr>\n  <tr>\n    <td translate>\n      Swiss grid (LV03)\n    </td>\n    <td>\n      {{coord_21781|ngeoNumberCoordinates:0:\'{x} / {y}\'}}\n    </td>\n  </tr>\n  <tr>\n    <td translate>\n      Wgs Coord.\n    </td>\n    <td>\n      {{coord_4326|ngeoNumberCoordinates:2:\'{y} / {x}\'}}\n    </td>\n  </tr>\n  <tr>\n    <td translate>\n      Wgs Coord. DMS\n    </td>\n    <td>\n      {{coord_4326|ngeoDMSCoordinates:0:\'{y} {x}\'}}\n    </td>\n  </tr>\n  <tr>\n    <td translate>\n      Elevation (SRTM)\n    </td>\n    <td ng-if="srtm">\n      {{srtm | number}} [m]\n    </td>\n  </tr>\n  <tr>\n    <td translate>\n      Elevation (Aster)\n    </td>\n    <td ng-if="aster">\n      {{aster | number}} [m]\n    </td>\n  </tr>\n</table>\n<a ng-href="https://maps.google.ch/?ie=UTF8&ll={{coord_4326_northern}},{{coord_4326_eastern}}&layer=c&cbll={{coord_4326_northern}},{{coord_4326_eastern}}&cbp=12,57.78,,0,8.1" target="_blank">Google StreetView</a>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/apps/desktop/sass/desktop.scss":
/*!*****************************************************!*\
  !*** ./contribs/gmf/apps/desktop/sass/desktop.scss ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/apps/desktop/sass/vars_desktop.scss":
/*!**********************************************************!*\
  !*** ./contribs/gmf/apps/desktop/sass/vars_desktop.scss ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/authentication/Service.js":
/*!****************************************************!*\
  !*** ./contribs/gmf/src/authentication/Service.js ***!
  \****************************************************/
/*! exports provided: RouteSuffix, AuthenticationService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RouteSuffix", function() { return RouteSuffix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthenticationService", function() { return AuthenticationService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/CustomEvent.js */ "./src/CustomEvent.js");
/* harmony import */ var ol_events_Target_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events/Target.js */ "./node_modules/ol/events/Target.js");
/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sentry/browser */ "./node_modules/@sentry/browser/esm/index.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





var RouteSuffix = {
  CHANGE_PASSWORD: 'loginchangepassword',
  IS_LOGGED_IN: 'loginuser',
  LOGIN: 'login',
  LOGOUT: 'logout',
  RESET_PASSWORD: 'loginresetpassword'
};
var AuthenticationService = function (_olEventsEventTarget) {
  AuthenticationService.$inject = ["$http", "$injector", "$rootScope", "authenticationBaseUrl", "gmfUser"];

  _inheritsLoose(AuthenticationService, _olEventsEventTarget);

  function AuthenticationService($http, $injector, $rootScope, authenticationBaseUrl, gmfUser) {
    var _this;

    _this = _olEventsEventTarget.call(this) || this;
    _this.$http_ = $http;
    _this.$rootScope_ = $rootScope;
    _this.baseUrl_ = authenticationBaseUrl.replace(/\/$/, '');
    _this.user_ = gmfUser;
    _this.noReloadRole_ = $injector.has('gmfAuthenticationNoReloadRole') ? $injector.get('gmfAuthenticationNoReloadRole') : null;

    _this.load_();

    return _this;
  }

  var _proto = AuthenticationService.prototype;

  _proto.load_ = function load_() {
    var url = this.baseUrl_ + "/" + RouteSuffix.IS_LOGGED_IN;
    this.$http_.get(url, {
      withCredentials: true
    }).then(this.handleLogin_.bind(this, true));
  };

  _proto.changePassword = function changePassword(login, oldPwd, newPwd, confPwd, otp) {
    var _this2 = this;

    if (otp === void 0) {
      otp = undefined;
    }

    var url = this.baseUrl_ + "/" + RouteSuffix.CHANGE_PASSWORD;
    return this.$http_.post(url, $.param({
      'login': login,
      'oldPassword': oldPwd,
      'otp': otp,
      'newPassword': newPwd,
      'confirmNewPassword': confPwd
    }), {
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      withCredentials: true
    }).then(function () {
      _this2.user_.is_password_changed = true;
      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('ready', {
        user: _this2.user_
      });

      _this2.dispatchEvent(event);
    });
  };

  _proto.login = function login(_login, pwd, otp) {
    if (otp === void 0) {
      otp = undefined;
    }

    var url = this.baseUrl_ + "/" + RouteSuffix.LOGIN;
    var params = {
      'login': _login,
      'password': pwd
    };

    if (otp) {
      Object.assign(params, {
        'otp': otp
      });
    }

    return this.$http_.post(url, $.param(params), {
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      withCredentials: true
    }).then(this.handleLogin_.bind(this, false));
  };

  _proto.logout = function logout() {
    var _this3 = this;

    var noReload = this.noReloadRole_ ? this.getRolesNames().includes(this.noReloadRole_) : false;
    var url = this.baseUrl_ + "/" + RouteSuffix.LOGOUT;
    return this.$http_.get(url, {
      withCredentials: true
    }).then(function () {
      _this3.resetUser_(noReload);
    });
  };

  _proto.resetPassword = function resetPassword(login) {
    var url = this.baseUrl_ + "/" + RouteSuffix.RESET_PASSWORD;
    return this.$http_.post(url, $.param({
      'login': login
    }), {
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    }).then(function (resp) {
      return resp.data;
    });
  };

  _proto.getEmail = function getEmail() {
    return this.user_.email || null;
  };

  _proto.getRolesIds = function getRolesIds() {
    return this.user_.roles ? this.user_.roles.map(function (role) {
      return role.id;
    }) : [];
  };

  _proto.getRolesNames = function getRolesNames() {
    return this.user_.roles ? this.user_.roles.map(function (role) {
      return role.name;
    }) : [];
  };

  _proto.handleLogin_ = function handleLogin_(checkingLoginStatus, resp) {
    this.setUser_(resp.data, !checkingLoginStatus);

    if (checkingLoginStatus) {
      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('ready', {
        user: this.user_
      });
      this.dispatchEvent(event);
    }

    return resp;
  };

  _proto.setUser_ = function setUser_(respData, emitEvent) {
    _sentry_browser__WEBPACK_IMPORTED_MODULE_3__["setUser"]({
      username: respData.username
    });

    for (var key in this.user_) {
      this.user_[key] = null;
    }

    for (var _key in respData) {
      this.user_[_key] = respData[_key];
    }

    if (emitEvent && respData.username !== undefined) {
      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('login', {
        user: this.user_
      });
      this.dispatchEvent(event);
    }
  };

  _proto.resetUser_ = function resetUser_(noReload) {
    noReload = noReload || false;

    for (var key in this.user_) {
      this.user_[key] = null;
    }

    var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('logout', {
      user: this.user_
    });
    this.dispatchEvent(event);

    if (!noReload) {
      this.load_();
    }
  };

  return AuthenticationService;
}(ol_events_Target_js__WEBPACK_IMPORTED_MODULE_2__["default"]);
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfAuthenticationService', []);
module.service('gmfAuthenticationService', AuthenticationService);
module.value('gmfUser', {
  functionalities: null,
  is_password_changed: null,
  roles: null,
  username: null
});
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/authentication/component.html":
/*!********************************************************!*\
  !*** ./contribs/gmf/src/authentication/component.html ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div ng-if="$ctrl.gmfUser.is_intranet">\n  <div class="form-group">\n    <span>{{\'You are recognized as an intranet user.\' | translate}}</span>\n  </div>\n</div>\n<div ng-if="$ctrl.gmfUser.username">\n  <div class="form-group">\n    <span>{{\'Logged in as\' | translate}}</span>\n    <strong>{{ ::$ctrl.gmfUser.username }}</strong>.\n  </div>\n\n  <form\n      name="logoutForm"\n      role="form"\n      ng-submit="$ctrl.logout()"\n      ng-controller="GmfAuthenticationController"\n      ng-class="{\'has-error\': $ctrl.error}"\n      ng-if="!$ctrl.changingPassword">\n    <div class="form-group">\n      <input\n          type="submit"\n          class="form-control btn prime"\n          value="{{\'Logout\' | translate}}" />\n    </div>\n    <div class="form-group">\n    <input\n        ng-show="$ctrl.allowPasswordChange"\n        type="button"\n        class="form-control btn btn-default"\n        value="{{\'Change password\' | translate}}"\n        ng-click="$ctrl.changingPassword = true"/>\n    </div>\n  </form>\n\n  <form\n      name="changePasswordForm"\n      role="form"\n      ng-submit="$ctrl.changePassword()"\n      ng-controller="GmfAuthenticationController"\n      ng-class="{\'has-error\': $ctrl.error}"\n      ng-if="$ctrl.changingPassword">\n    <div class="form-group">\n      <input\n          type="password"\n          class="form-control"\n          name="oldpassword"\n          ng-model="$ctrl.oldPwdVal"\n          ng-attr-placeholder="{{\'Old password\' | translate}}"/>\n    </div>\n    <div class="form-group">\n      <input\n          type="password"\n          class="form-control"\n          name="newpassword"\n          ng-model="$ctrl.newPwdVal"\n          ng-attr-placeholder="{{\'New password\' | translate}}"/>\n    </div>\n    <div class="form-group">\n      <input\n          type="password"\n          class="form-control"\n          name="newpasswordconfirm"\n          ng-model="$ctrl.newPwdConfVal"\n          ng-attr-placeholder="{{\'Confirm new password\' | translate}}"/>\n    </div>\n    <div ng-if="$ctrl.gmfUser.otp_uri" class="form-group">\n      <label translate>Two factor authentication barcode:</label>\n      <div><img class="" ng-src="{{$ctrl.otpImage}}"></div>\n    </div>\n    <div ng-if="$ctrl.gmfUser.two_factor_totp_secret" class="form-group">\n      <label translate>Two factor authentication key:</label>\n      <code>{{$ctrl.gmfUser.two_factor_totp_secret}}</code>\n    </div>\n    <div ng-if="$ctrl.twoFactorAuth" class="form-group">\n      <input\n          type="text"\n          autocomplete="off"\n          class="form-control"\n          name="otp"\n          ng-model="$ctrl.otpVal"\n          ng-attr-placeholder="{{\'Authentication code\' | translate}}"/>\n      </div>\n      <div class="form-group">\n      <input\n          type="submit"\n          class="form-control btn prime"\n          value="{{\'Change password\' | translate}}" />\n    </div>\n    <div class="form-group">\n      <input\n          type="button"\n          class="form-control btn btn-default"\n          value="{{\'Cancel\' | translate}}"\n          ng-if="!$ctrl.userMustChangeItsPassword"\n          ng-click="$ctrl.changePasswordReset()" />\n      <input\n          type="button"\n          class="form-control btn btn-default"\n          value="{{\'Logout\' | translate}}"\n          ng-if="$ctrl.userMustChangeItsPassword"\n          ng-click="$ctrl.logout()" />\n    </div>\n  </form>\n\n  <div ng-show="$ctrl.error" class="gmf-authentication-error help-block"></div>\n</div>\n\n<div ng-if="!$ctrl.gmfUser.username">\n\n  <div class="alert alert-warning" ng-show="$ctrl.infoMessage">\n    <span>{{ $ctrl.infoMessage }}</span>\n  </div>\n\n  <form\n      name="loginForm"\n      role="form"\n      ng-submit="$ctrl.login()"\n      ng-controller="GmfAuthenticationController"\n      ng-class="{\'has-error\': $ctrl.error}">\n    <div class="form-group">\n      <input\n          type="text"\n          class="form-control"\n          name="login"\n          ng-model="$ctrl.loginVal"\n          ng-attr-placeholder="{{\'Username\' | translate}}" />\n    </div>\n    <div class="form-group">\n      <input\n          type="password"\n          class="form-control"\n          name="password"\n          ng-model="$ctrl.pwdVal"\n          ng-attr-placeholder="{{\'Password\' | translate}}"/>\n    </div>\n    <div ng-if="$ctrl.twoFactorAuth" class="form-group">\n      <input\n          type="text"\n          autocomplete="off"\n          class="form-control"\n          name="otp"\n          ng-model="$ctrl.otpVal"\n          ng-attr-placeholder="{{\'Authentication code\' | translate}}"/>\n    </div>\n    <div class="form-group">\n    <input\n        type="submit"\n        class="form-control btn prime"\n        value="{{\'Connect\' | translate}}" />\n    </div>\n    <div ng-show="$ctrl.allowPasswordReset" class="form-group">\n      <a ng-click="$ctrl.resetPassword()"\n         href="">{{\'Password forgotten?\' | translate}}</a>\n    </div>\n  </form>\n\n  <div ng-show="$ctrl.error" class="gmf-authentication-error help-block"></div>\n\n  <ngeo-modal\n      ng-model="$ctrl.resetPasswordModalShown">\n    <div class="modal-header ui-draggable-handle">\n      <button type="button"\n              class="close"\n              data-dismiss="modal"\n              aria-label="{{\'Close\' | translate}}">\n        <span aria-hidden="true">&times;</span>\n      </button>\n      <h4 class="modal-title">\n        {{\'Password forgotten?\' | translate}}\n      </h4>\n    </div>\n    <div class="modal-body" translate>\n      A new password has just been sent to you by e-mail.\n    </div>\n    <div class="modal-footer">\n      <button type="button"\n              class="btn btn-default"\n              data-dismiss="modal">{{\'OK\' | translate}}</button>\n    </div>\n  </ngeo-modal>\n\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/authentication/component.js":
/*!******************************************************!*\
  !*** ./contribs/gmf/src/authentication/component.js ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/authentication/Service.js */ "./contribs/gmf/src/authentication/Service.js");
/* harmony import */ var ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/message/Message.js */ "./src/message/Message.js");
/* harmony import */ var ngeo_message_Notification_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/message/Notification.js */ "./src/message/Notification.js");
/* harmony import */ var ngeo_message_modalComponent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/message/modalComponent.js */ "./src/message/modalComponent.js");
/* harmony import */ var qruri__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! qruri */ "./node_modules/qruri/index.js");
/* harmony import */ var qruri__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(qruri__WEBPACK_IMPORTED_MODULE_5__);






var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfAuthentication', [gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_message_Notification_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_message_modalComponent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name]);

function gmfAuthenticationTemplateUrl_(element, attrs) {
  var templateUrl = attrs.gmfAuthenticationTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'gmf/authentication';
}

module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/authentication', __webpack_require__(/*! ./component.html */ "./contribs/gmf/src/authentication/component.html"));
}]);
gmfAuthenticationTemplateUrl.$inject = ["$element", "$attrs", "gmfAuthenticationTemplateUrl"];

function gmfAuthenticationTemplateUrl($element, $attrs, gmfAuthenticationTemplateUrl) {
  return gmfAuthenticationTemplateUrl($element, $attrs);
}

var authenticationComponent = {
  bindings: {
    'allowPasswordReset': '<?gmfAuthenticationAllowPasswordReset',
    'allowPasswordChange': '<?gmfAuthenticationAllowPasswordChange',
    'passwordValidator': '<?gmfAuthenticationPasswordValidator',
    'forcePasswordChange': '<?gmfAuthenticationForcePasswordChange',
    'infoMessage': '=?gmfAuthenticationInfoMessage'
  },
  controller: 'GmfAuthenticationController',
  templateUrl: gmfAuthenticationTemplateUrl
};
module.value('gmfAuthenticationTemplateUrl', gmfAuthenticationTemplateUrl_);
module.component('gmfAuthentication', authenticationComponent);

var AuthenticationController = function () {
  AuthenticationController.$inject = ["$scope", "$element", "gmfTwoFactorAuth", "gettextCatalog", "gmfAuthenticationService", "gmfUser", "ngeoNotification"];

  function AuthenticationController($scope, $element, gmfTwoFactorAuth, gettextCatalog, gmfAuthenticationService, gmfUser, ngeoNotification) {
    var _this = this;

    this.$element_ = $element;
    this.gmfUser = gmfUser;
    this.gettextCatalog = gettextCatalog;
    this.gmfAuthenticationService_ = gmfAuthenticationService;
    this.notification_ = ngeoNotification;
    this.twoFactorAuth = gmfTwoFactorAuth;
    this.allowPasswordReset = true;
    this.allowPasswordChange = true;
    this.passwordValidator = null;
    this.forcePasswordChange = false;
    this.infoMessage = null;
    this.changingPassword = false;
    this.userMustChangeItsPassword = false;
    this.resetPasswordModalShown = false;
    this.error = false;
    this.loginVal = '';
    this.pwdVal = '';
    this.otpVal;
    this.oldPwdVal = '';
    this.newPwdVal = '';
    this.newPwdConfVal = '';
    this.otpImage;
    $scope.$watch(function () {
      return _this.gmfUser.otp_uri;
    }, function (val) {
      if (val) {
        _this.otpImage = qruri__WEBPACK_IMPORTED_MODULE_5___default()(val, {
          margin: 2
        });
      }
    });
  }

  var _proto = AuthenticationController.prototype;

  _proto.$onInit = function $onInit() {
    this.allowPasswordReset = this.allowPasswordReset !== false;
    this.allowPasswordChange = this.allowPasswordChange !== false;
    this.forcePasswordChange = this.forcePasswordChange === true;

    if (this.forcePasswordChange) {
      this.changingPassword = true;
    }

    this.userMustChangeItsPassword = this.gmfUser.is_password_changed === false && this.forcePasswordChange;
  };

  _proto.changePassword = function changePassword() {
    var _this2 = this;

    var gettextCatalog = this.gettextCatalog;
    var oldPwd = this.oldPwdVal;
    var newPwd = this.newPwdVal;
    var confPwd = this.newPwdConfVal;
    var errors = [];

    if (oldPwd === '') {
      errors.push(gettextCatalog.getString('The old password is required.'));
    }

    if (newPwd === '') {
      errors.push(gettextCatalog.getString('The new password is required.'));
    }

    if (confPwd === '') {
      errors.push(gettextCatalog.getString('The password confirmation is required.'));
    }

    if (errors.length) {
      this.setError_(errors);
    } else {
      if (oldPwd === newPwd) {
        errors.push(gettextCatalog.getString('The old and new passwords are the same.'));
      }

      if (newPwd !== confPwd) {
        errors.push(gettextCatalog.getString('The passwords don\'t match.'));
      }

      if (this.passwordValidator) {
        if (!this.passwordValidator.isPasswordValid(oldPwd)) {
          errors.push(gettextCatalog.getString(this.passwordValidator.notValidMessage));
        }
      }

      if (errors.length) {
        this.setError_(errors);
      } else {
        var username = this.gmfUser.username;
        this.gmfAuthenticationService_.changePassword(username, oldPwd, newPwd, confPwd, this.otpVal).then(function () {
          _this2.changePasswordReset();

          _this2.setError_([gettextCatalog.getString('Your password has successfully been changed.')], ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__["MessageType"].INFORMATION);
        }).catch(function (err) {
          _this2.oldPwdVal = '';
          _this2.otpVal = '';

          _this2.setError_(gettextCatalog.getString('Incorrect old password.'));
        });
      }
    }
  };

  _proto.login = function login() {
    var _this3 = this;

    var gettextCatalog = this.gettextCatalog;
    var errors = [];

    if (this.loginVal === '') {
      errors.push(gettextCatalog.getString('The username is required.'));
    }

    if (this.pwdVal === '') {
      errors.push(gettextCatalog.getString('The password is required.'));
    }

    if (errors.length) {
      this.setError_(errors);
    } else {
      this.gmfAuthenticationService_.login(this.loginVal, this.pwdVal, this.otpVal).then(function () {
        _this3.loginVal = '';
        _this3.pwdVal = '';
        _this3.otpVal = '';

        _this3.resetError_();
      }).catch(function () {
        _this3.pwdVal = '';
        _this3.otpVal = '';

        _this3.setError_(gettextCatalog.getString('Incorrect credentials or disabled account.'));
      });
    }
  };

  _proto.logout = function logout() {
    var _this4 = this;

    var gettextCatalog = this.gettextCatalog;
    this.gmfAuthenticationService_.logout().then(function () {
      _this4.resetError_();
    }).catch(function () {
      _this4.setError_(gettextCatalog.getString('Could not log out.'));
    });
  };

  _proto.resetPassword = function resetPassword() {
    var _this5 = this;

    var gettextCatalog = this.gettextCatalog;

    if (!this.loginVal) {
      this.setError_(gettextCatalog.getString('Please, input a login...'));
      return;
    }

    this.gmfAuthenticationService_.resetPassword(this.loginVal).then(function () {
      _this5.resetPasswordModalShown = true;

      _this5.resetError_();
    }).catch(function () {
      _this5.setError_(gettextCatalog.getString('An error occurred while resetting the password.'));
    });
  };

  _proto.changePasswordReset = function changePasswordReset() {
    this.resetError_();
    this.changingPassword = false;
    this.oldPwdVal = '';
    this.newPwdVal = '';
    this.newPwdConfVal = '';
  };

  _proto.setError_ = function setError_(errors, messageType) {
    var _this6 = this;

    if (messageType == undefined) {
      messageType = ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__["MessageType"].ERROR;
    }

    if (this.error) {
      this.resetError_();
    }

    this.error = true;
    var container = this.$element_.find('.gmf-authentication-error');

    if (!Array.isArray(errors)) {
      errors = [errors];
    }

    errors.forEach(function (error) {
      var options = {
        msg: error,
        target: container
      };

      if (messageType) {
        options.type = messageType;
      }

      _this6.notification_.notify(options);
    });
  };

  _proto.resetError_ = function resetError_() {
    this.notification_.clear();
    this.error = false;
  };

  return AuthenticationController;
}();

module.controller('GmfAuthenticationController', AuthenticationController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/authentication/module.js":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/authentication/module.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_authentication_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/authentication/component.js */ "./contribs/gmf/src/authentication/component.js");
/* harmony import */ var gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/authentication/Service.js */ "./contribs/gmf/src/authentication/Service.js");



/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfAuthenticationModule', [gmf_authentication_component_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/backgroundlayerselector/component.html":
/*!*****************************************************************!*\
  !*** ./contribs/gmf/src/backgroundlayerselector/component.html ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<ul class="gmf-backgroundlayerselector">\n  <li ng-repeat="layer in ctrl.bgLayers"\n      ng-click="ctrl.setLayer(layer)"\n      ng-class="{\'gmf-backgroundlayerselector-active\': ctrl.bgLayer == layer, \'gmf-backgroundlayerselector-disabled\': ctrl.opacityLayer == layer}">\n    <img class="gmf-thumb"\n         ng-src="{{::layer.get(\'metadata\')[\'thumbnail\']}}" />\n    <span class="gmf-text">{{layer.get("label") | translate}}</span>\n    <span ng-class="{\'gmf-backgroundlayerselector-opacity-check\': ctrl.opacityLayer == layer}"></span>\n  </li>\n\n  <input ng-if="ctrl.opacityLayer"\n         class="input-action gmf-backgroundlayerselector-opacity-slider"\n         name="bg-layer-opacity"\n         type="range"\n         min="0"\n         max="1"\n         step="0.01"\n         ng-model="ctrl.getSetBgLayerOpacity"\n         ng-model-options="{getterSetter: true}">\n</ul>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/backgroundlayerselector/component.js":
/*!***************************************************************!*\
  !*** ./contribs/gmf/src/backgroundlayerselector/component.js ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_map_BackgroundLayerMgr_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/map/BackgroundLayerMgr.js */ "./src/map/BackgroundLayerMgr.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
Controller.$inject = ["$scope", "ngeoBackgroundLayerMgr", "gmfThemes"];




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfBackgroundlayerselector', [gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_map_BackgroundLayerMgr_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.value('gmfBackgroundlayerselectorTemplateUrl', function ($element, $attrs) {
  var templateUrl = $attrs.gmfBackgroundlayerselectorTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'gmf/backgroundlayerselector';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/backgroundlayerselector', __webpack_require__(/*! ./component.html */ "./contribs/gmf/src/backgroundlayerselector/component.html"));
}]);
gmfBackgroundlayerselectorTemplateUrl.$inject = ["$element", "$attrs", "gmfBackgroundlayerselectorTemplateUrl"];

function gmfBackgroundlayerselectorTemplateUrl($element, $attrs, gmfBackgroundlayerselectorTemplateUrl) {
  return gmfBackgroundlayerselectorTemplateUrl($element, $attrs);
}

var backgroundlayerselectorComponent = {
  controller: 'GmfBackgroundlayerselectorController as ctrl',
  bindings: {
    'map': '=gmfBackgroundlayerselectorMap',
    'opacityOptions': '=gmfBackgroundlayerOpacityOptions',
    'select': '&?gmfBackgroundlayerselectorSelect'
  },
  templateUrl: gmfBackgroundlayerselectorTemplateUrl
};
module.component('gmfBackgroundlayerselector', backgroundlayerselectorComponent);

function Controller($scope, ngeoBackgroundLayerMgr, gmfThemes) {
  var _this = this;

  this.map = null;
  this.opacityOptions;
  this.select = null;
  this.bgLayer = null;
  this.bgLayers = null;
  this.opacityLayer = null;
  this.gmfThemes_ = gmfThemes;
  this.listenerKeys_ = [];
  this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(gmfThemes, 'change', this.handleThemesChange_, this));
  this.backgroundLayerMgr_ = ngeoBackgroundLayerMgr;
  this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(this.backgroundLayerMgr_, 'change', function (event) {
    _this.bgLayer = event.detail.current;
  }));
  $scope.$on('$destroy', this.handleDestroy_.bind(this));
}

Controller.prototype.$onInit = function () {
  this.handleThemesChange_();
};

Controller.prototype.handleThemesChange_ = function () {
  var _this2 = this;

  this.gmfThemes_.getBgLayers().then(function (layers) {
    _this2.bgLayers = layers;

    if (_this2.opacityOptions !== undefined) {
      var opacityLayer = layers.find(function (layer) {
        return layer.get('label') === _this2.opacityOptions;
      });

      if (opacityLayer !== undefined) {
        _this2.setOpacityBgLayer(opacityLayer);

        _this2.bgLayers = _this2.bgLayers.slice();

        var indexOpa = _this2.bgLayers.findIndex(function (layer) {
          return layer === _this2.opacityLayer;
        });

        _this2.bgLayers.splice(indexOpa, 1);

        _this2.bgLayers.push(opacityLayer);
      }
    }
  });
};

Controller.prototype.getSetBgLayerOpacity = function (val) {
  if (!this.opacityLayer) {
    throw new Error('Missing opacityLayer');
  }

  if (val !== undefined) {
    this.opacityLayer.setOpacity(val);
    this.opacityLayer.setVisible(val !== 0);
    this.bgLayer.setVisible(val !== 1);
  }

  return this.opacityLayer.getOpacity();
};

Controller.prototype.setLayer = function (layer, opt_silent) {
  var opacity = this.opacityLayer ? this.opacityLayer.getOpacity() : 0;
  this.bgLayer = layer;
  this.backgroundLayerMgr_.set(this.map, layer);
  layer.setVisible(opacity !== 1);

  if (this.opacityLayer) {
    this.opacityLayer.setVisible(opacity !== 0);
    this.opacityLayer.setOpacity(opacity);
  }

  if (!opt_silent && this.select) {
    this.select();
  }
};

Controller.prototype.setOpacityBgLayer = function (layer) {
  var opacity = this.opacityLayer ? this.opacityLayer.getOpacity() : layer.getOpacity();
  layer.setOpacity(opacity);
  this.opacityLayer = layer;
  this.opacityLayer.setVisible(opacity !== 0);
  this.bgLayer.setVisible(opacity !== 1);
  this.backgroundLayerMgr_.setOpacityBgLayer(this.map, layer);
};

Controller.prototype.handleDestroy_ = function () {
  this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["unlistenByKey"]);
  this.listenerKeys_.length = 0;
};

module.controller('GmfBackgroundlayerselectorController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/contextualdata/component.js":
/*!******************************************************!*\
  !*** ./contribs/gmf/src/contextualdata/component.js ***!
  \******************************************************/
/*! exports provided: ContextualdataController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContextualdataController", function() { return ContextualdataController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_raster_RasterService_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/raster/RasterService.js */ "./contribs/gmf/src/raster/RasterService.js");
/* harmony import */ var ol_Overlay_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Overlay.js */ "./node_modules/ol/Overlay.js");
/* harmony import */ var ol_proj_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/proj.js */ "./node_modules/ol/proj.js");
contextualDataComponentContent.$inject = ["gmfContextualdatacontentTemplateUrl"];
ContextualdataController.$inject = ["$compile", "$timeout", "$scope", "gmfRaster", "$injector"];




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfContextualdata', [gmf_raster_RasterService_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);

function contextualDataComponent() {
  return {
    restrict: 'A',
    scope: false,
    controller: 'GmfContextualdataController as cdCtrl',
    bindToController: {
      'displayed': '=gmfContextualdataDisplayed',
      'map': '<gmfContextualdataMap',
      'projections': '<gmfContextualdataProjections',
      'callback': '<gmfContextualdataCallback'
    },
    link: function link(scope, element, attrs, controller) {
      if (!controller) {
        throw new Error('Missing controller');
      }

      controller.init();
    }
  };
}

module.directive('gmfContextualdata', contextualDataComponent);
function ContextualdataController($compile, $timeout, $scope, gmfRaster, $injector) {
  var _this = this;

  this.map = null;
  this.projections = [];
  this.displayed = false;

  this.callback = function (c, o) {
    return {};
  };

  this.overlay_ = null;
  this.longPressTimeout_ = null;
  this.$compile_ = $compile;
  this.timeout_ = $timeout;
  this.$scope_ = $scope;
  this.gmfRaster_ = gmfRaster;
  this.gmfContextualdataOptions_ = $injector.has('gmfContextualdataOptions') ? $injector.get('gmfContextualdataOptions') : {};
  document.body.addEventListener('mousedown', function () {
    _this.$scope_.$apply(function () {
      _this.hidePopover();
    });
  });
}

ContextualdataController.prototype.init = function () {
  var _this2 = this;

  this.preparePopover_();

  if (!this.map) {
    throw new Error('Missing map');
  }

  var mapDiv = this.map.getTargetElement();

  if (!mapDiv) {
    throw new Error('Missing mapDiv');
  }

  mapDiv.addEventListener('contextmenu', this.handleMapContextMenu_.bind(this));
  mapDiv.addEventListener('touchstart', this.handleMapTouchStart_.bind(this));
  mapDiv.addEventListener('touchmove', this.handleMapTouchEnd_.bind(this));
  mapDiv.addEventListener('touchend', this.handleMapTouchEnd_.bind(this));
  this.map.on('pointerdown', function () {
    _this2.$scope_.$apply(function () {
      _this2.hidePopover();
    });
  });
};

ContextualdataController.prototype.handleMapTouchStart_ = function (event) {
  var _this3 = this;

  this.longPressTimeout_ = window.setTimeout(function () {
    _this3.handleMapContextMenu_(event);
  }, 500);
};

ContextualdataController.prototype.handleMapTouchEnd_ = function () {
  if (this.longPressTimeout_) {
    clearTimeout(this.longPressTimeout_);
  }
};

ContextualdataController.prototype.handleMapContextMenu_ = function (event) {
  var _this4 = this;

  this.$scope_.$apply(function () {
    if (!_this4.map) {
      throw new Error('Missing map');
    }

    var pixel = _this4.map.getEventPixel(event);

    var coordinate = _this4.map.getCoordinateFromPixel(pixel);

    _this4.setContent_(coordinate);

    event.preventDefault();

    _this4.showPopover();

    _this4.timeout_(function () {
      if (!_this4.overlay_) {
        throw new Error('Missing overlay');
      }

      _this4.overlay_.setPosition(coordinate);
    });
  });
};

ContextualdataController.prototype.setContent_ = function (coordinate) {
  var _this5 = this;

  if (!this.map) {
    throw new Error('Missing map');
  }

  if (!this.content_) {
    throw new Error('Missing content');
  }

  var scope = this.$scope_.$new(true);
  this.$compile_(this.content_)(scope);
  var mapProjection = this.map.getView().getProjection().getCode();
  this.projections.forEach(function (proj) {
    var coord = ol_proj_js__WEBPACK_IMPORTED_MODULE_3__["transform"](coordinate, mapProjection, "EPSG:" + proj);
    scope["coord_" + proj] = coord;
    scope["coord_" + proj + "_eastern"] = coord[0];
    scope["coord_" + proj + "_northern"] = coord[1];
  });
  this.gmfRaster_.getRaster(coordinate, this.gmfContextualdataOptions_.rasterParams).then(function (resp) {
    Object.assign(scope, resp);

    if (_this5.callback) {
      Object.assign(scope, _this5.callback.call(_this5, coordinate, resp));
    }
  }, function () {
    console.error('Error on getting the raster.');
  });
};

ContextualdataController.prototype.preparePopover_ = function () {
  if (!this.map) {
    throw new Error('Missing map');
  }

  var container = document.createElement('DIV');
  container.classList.add('popover');
  container.classList.add('bs-popover-bottom');
  container.classList.add('gmf-contextualdata');
  container.style.position = 'relative';
  var arrow = document.createElement('DIV');
  arrow.classList.add('arrow');
  container.appendChild(arrow);
  this.content_ = document.createElement('DIV');
  this.content_.setAttribute('gmf-contextualdatacontent', '');
  this.content_.classList.add('popover-body');
  container.appendChild(this.content_);
  this.overlay_ = new ol_Overlay_js__WEBPACK_IMPORTED_MODULE_2__["default"]({
    element: container,
    stopEvent: true,
    autoPan: true,
    autoPanAnimation: {
      duration: 250
    },
    positioning: 'top-center'
  });
  this.map.addOverlay(this.overlay_);
};

ContextualdataController.prototype.showPopover = function () {
  if (!this.overlay_) {
    throw new Error('Missing overlay');
  }

  var element = this.overlay_.getElement();

  if (!element) {
    throw new Error('Missing element');
  }

  element.style.display = 'block';
  this.displayed = true;
};

ContextualdataController.prototype.hidePopover = function () {
  if (!this.overlay_) {
    throw new Error('Missing overlay');
  }

  var element = this.overlay_.getElement();

  if (!element) {
    throw new Error('Missing element');
  }

  element.style.display = 'none';
  this.displayed = false;
};

module.controller('GmfContextualdataController', ContextualdataController);

function contextualDataComponentContent(gmfContextualdatacontentTemplateUrl) {
  return {
    restrict: 'A',
    scope: true,
    templateUrl: gmfContextualdatacontentTemplateUrl
  };
}

module.directive('gmfContextualdatacontent', contextualDataComponentContent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/contextualdata/contextualdata.scss":
/*!*************************************************************!*\
  !*** ./contribs/gmf/src/contextualdata/contextualdata.scss ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/contextualdata/module.js":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/contextualdata/module.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_contextualdata_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/contextualdata/component.js */ "./contribs/gmf/src/contextualdata/component.js");
/* harmony import */ var _contextualdata_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./contextualdata.scss */ "./contribs/gmf/src/contextualdata/contextualdata.scss");
/* harmony import */ var _contextualdata_scss__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_contextualdata_scss__WEBPACK_IMPORTED_MODULE_2__);



/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfContextualdataModule', [gmf_contextualdata_component_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/controllers/AbstractAPIController.js":
/*!***************************************************************!*\
  !*** ./contribs/gmf/src/controllers/AbstractAPIController.js ***!
  \***************************************************************/
/*! exports provided: AbstractAPIController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractAPIController", function() { return AbstractAPIController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_controllers_AbstractAppController_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/controllers/AbstractAppController.js */ "./contribs/gmf/src/controllers/AbstractAppController.js");
/* harmony import */ var ngeo_map_resizemap_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/map/resizemap.js */ "./src/map/resizemap.js");
/* harmony import */ var ol_proj_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/proj.js */ "./node_modules/ol/proj.js");
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
/* harmony import */ var ol_View_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/View.js */ "./node_modules/ol/View.js");
/* harmony import */ var ol_control_ScaleLine_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/control/ScaleLine.js */ "./node_modules/ol/control/ScaleLine.js");
/* harmony import */ var ol_control_Zoom_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/control/Zoom.js */ "./node_modules/ol/control/Zoom.js");
/* harmony import */ var ol_control_Rotate_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/control/Rotate.js */ "./node_modules/ol/control/Rotate.js");
/* harmony import */ var ol_interaction_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/interaction.js */ "./node_modules/ol/interaction.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }











var AbstractAPIController = function (_AbstractAppControlle) {
  AbstractAPIController.$inject = ["config", "$scope", "$injector"];

  _inheritsLoose(AbstractAPIController, _AbstractAppControlle);

  function AbstractAPIController(config, $scope, $injector) {
    var viewConfig = {
      projection: ol_proj_js__WEBPACK_IMPORTED_MODULE_3__["get"]("EPSG:" + (config.srid || 2056))
    };
    Object.assign(viewConfig, config.mapViewConfig || {});
    var scaleline = document.getElementById('scaleline');

    if (!scaleline) {
      throw new Error('Missing scaleline');
    }

    return _AbstractAppControlle.call(this, config, new ol_Map_js__WEBPACK_IMPORTED_MODULE_4__["default"]({
      pixelRatio: config.mapPixelRatio,
      layers: [],
      view: new ol_View_js__WEBPACK_IMPORTED_MODULE_5__["default"](viewConfig),
      controls: config.mapControls || [new ol_control_ScaleLine_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
        target: scaleline
      }), new ol_control_Zoom_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
        target: 'ol-zoom-control',
        zoomInTipLabel: '',
        zoomOutTipLabel: ''
      }), new ol_control_Rotate_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
        label: Object(gmf_controllers_AbstractAppController_js__WEBPACK_IMPORTED_MODULE_1__["getLocationIcon"])(),
        tipLabel: ''
      })],
      interactions: config.mapInteractions || ol_interaction_js__WEBPACK_IMPORTED_MODULE_9__["defaults"]({
        pinchRotate: true,
        altShiftDragRotate: true
      })
    }), $scope, $injector) || this;
  }

  return AbstractAPIController;
}(gmf_controllers_AbstractAppController_js__WEBPACK_IMPORTED_MODULE_1__["AbstractAppController"]);
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('GmfAbstractAPIControllerModule', [gmf_controllers_AbstractAppController_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_map_resizemap_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.controller('AbstractAPIController', AbstractAPIController);
module.value('isDesktop', true);
module.value('ngeoQueryOptions', {
  'limit': 20
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/controllers/AbstractAppController.js":
/*!***************************************************************!*\
  !*** ./contribs/gmf/src/controllers/AbstractAppController.js ***!
  \***************************************************************/
/*! exports provided: AbstractAppController, getLocationIcon, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractAppController", function() { return AbstractAppController; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getLocationIcon", function() { return getLocationIcon; });
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var angular_gettext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! angular-gettext */ "./node_modules/angular-gettext/index.js");
/* harmony import */ var angular_gettext__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(angular_gettext__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var angular_dynamic_locale__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! angular-dynamic-locale */ "./node_modules/angular-dynamic-locale/src/tmhDynamicLocale.js");
/* harmony import */ var angular_dynamic_locale__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(angular_dynamic_locale__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var gmf_controllers_bootstrap_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/controllers/bootstrap.js */ "./contribs/gmf/src/controllers/bootstrap.js");
/* harmony import */ var gmf_authentication_module_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/authentication/module.js */ "./contribs/gmf/src/authentication/module.js");
/* harmony import */ var gmf_backgroundlayerselector_component_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! gmf/backgroundlayerselector/component.js */ "./contribs/gmf/src/backgroundlayerselector/component.js");
/* harmony import */ var gmf_datasource_module_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! gmf/datasource/module.js */ "./contribs/gmf/src/datasource/module.js");
/* harmony import */ var gmf_disclaimer_component_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! gmf/disclaimer/component.js */ "./contribs/gmf/src/disclaimer/component.js");
/* harmony import */ var gmf_drawing_module_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! gmf/drawing/module.js */ "./contribs/gmf/src/drawing/module.js");
/* harmony import */ var gmf_filters_module_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! gmf/filters/module.js */ "./contribs/gmf/src/filters/module.js");
/* harmony import */ var gmf_layertree_module_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! gmf/layertree/module.js */ "./contribs/gmf/src/layertree/module.js");
/* harmony import */ var gmf_map_module_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! gmf/map/module.js */ "./contribs/gmf/src/map/module.js");
/* harmony import */ var gmf_query_extraModule_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! gmf/query/extraModule.js */ "./contribs/gmf/src/query/extraModule.js");
/* harmony import */ var gmf_search_module_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! gmf/search/module.js */ "./contribs/gmf/src/search/module.js");
/* harmony import */ var gmf_theme_module_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! gmf/theme/module.js */ "./contribs/gmf/src/theme/module.js");
/* harmony import */ var ngeo_message_displaywindowComponent_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ngeo/message/displaywindowComponent.js */ "./src/message/displaywindowComponent.js");
/* harmony import */ var ngeo_misc_extraModule_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ngeo/misc/extraModule.js */ "./src/misc/extraModule.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ngeo/misc/ToolActivate.js */ "./src/misc/ToolActivate.js");
/* harmony import */ var ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ngeo/query/MapQuerent.js */ "./src/query/MapQuerent.js");
/* harmony import */ var ngeo_query_component_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ngeo/query/component.js */ "./src/query/component.js");
/* harmony import */ var ngeo_statemanager_module_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ngeo/statemanager/module.js */ "./src/statemanager/module.js");
/* harmony import */ var ngeo_statemanager_WfsPermalink_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ngeo/statemanager/WfsPermalink.js */ "./src/statemanager/WfsPermalink.js");
/* harmony import */ var ngeo_geolocation_component_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ngeo/geolocation/component.js */ "./src/geolocation/component.js");
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
/* harmony import */ var ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ol/style/Circle.js */ "./node_modules/ol/style/Circle.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! gmf/theme/Manager.js */ "./contribs/gmf/src/theme/Manager.js");
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! @sentry/browser */ "./node_modules/@sentry/browser/esm/index.js");
AbstractAppController.$inject = ["config", "map", "$scope", "$injector"];



































function AbstractAppController(config, map, $scope, $injector) {
  var _this = this;

  this.ngeoLocation = $injector.get('ngeoLocation');

  if (this.ngeoLocation.hasParam('debug')) {
    window.injector = $injector;
  }

  this.map = map;

  if (!(this.map instanceof ol_Map_js__WEBPACK_IMPORTED_MODULE_27__["default"])) {
    throw new Error('Wrong map type');
  }

  var ngeoFeatures = $injector.get('ngeoFeatures');
  this.drawFeatureLayer = $injector.get('ngeoFeatureOverlayMgr').getFeatureOverlay();
  this.drawFeatureLayer.setFeatures(ngeoFeatures);
  var ngeoFeatureHelper = $injector.get('ngeoFeatureHelper');
  ngeoFeatureHelper.setProjection(this.map.getView().getProjection());
  this.gmfThemeManager = $injector.get('gmfThemeManager');
  this.gmfTreeManager_ = $injector.get('gmfTreeManager');
  this.gmfThemes_ = $injector.get('gmfThemes');
  this.loading = true;
  this.gmfThemes_.getThemesObject().finally(function () {
    _this.loading = false;
  });
  this.permalink_ = $injector.get('gmfPermalink');
  var gmfAuthentication = $injector.get('gmfAuthenticationService');
  this.hasEditableLayers = false;

  this.updateHasEditableLayers_ = function () {
    var _this2 = this;

    this.gmfThemes_.hasEditableLayers().then(function (hasEditableLayers) {
      _this2.hasEditableLayers = hasEditableLayers;
    });
  };

  this.loginRedirectUrl = null;
  this.loginInfoMessage = null;
  this.userMustChangeItsPassword = false;
  $scope.$on('authenticationrequired', function (event, args) {
    var gettextCatalog = $injector.get('gettextCatalog');
    _this.loginInfoMessage = gettextCatalog.getString('Some layers in this link are not accessible to unauthenticated users. ' + 'Please log in to see whole data.');
    _this.loginRedirectUrl = args.url;
    _this.loginActive = true;
    var unbind = $scope.$watch(function () {
      return _this.loginActive;
    }, function () {
      if (!_this.loginActive) {
        _this.loginInfoMessage = null;
        _this.loginRedirectUrl = null;
        unbind();
      }
    });
  });

  var userChange = function userChange(evt) {
    if (_this.gmfUser.is_password_changed === false) {
      return;
    }

    if (_this.loginRedirectUrl) {
      window.location.href = _this.loginRedirectUrl;
      return;
    }

    var roleId = gmfAuthentication.getRolesIds().join(',');
    var functionalities = _this.gmfUser.functionalities;

    if (functionalities && functionalities.filterable_layers && functionalities.filterable_layers.length > 0) {
      _this.filterSelectorEnabled = true;
    }

    _this.gmfThemes_.getThemesObject().then(function (themes) {
      if (functionalities && functionalities.open_panel && functionalities.open_panel[0] === 'layer_filter') {
        _this.filterSelectorActive = true;
      }
    });

    var previousThemeName = _this.gmfThemeManager.getThemeName();

    _this.gmfThemeManager.setThemeName('', true);

    _this.gmfThemes_.loadThemes(roleId);

    if (evt.type !== 'ready') {
      var themeName = _this.permalink_.defaultThemeNameFromFunctionalities();

      _this.gmfThemeManager.updateCurrentTheme(themeName, previousThemeName, true);
    }

    _this.setDefaultBackground_(null);

    _this.updateHasEditableLayers_();
  };

  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(gmfAuthentication, 'ready', userChange);
  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(gmfAuthentication, 'login', userChange);
  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(gmfAuthentication, 'logout', userChange);
  this.searchDatasources = [{
    labelKey: 'label',
    groupValues: $injector.get('gmfSearchGroups'),
    groupActions: $injector.get('gmfSearchActions'),
    projection: "EPSG:" + (config.srid || 2056),
    url: $injector.get('fulltextsearchUrl')
  }];
  this.dimensions = {};
  this.permalink_.setDimensions(this.dimensions);
  var gmfDataSourcesManager = $injector.get('gmfDataSourcesManager');
  gmfDataSourcesManager.setDatasourceMap(this.map);
  gmfDataSourcesManager.setDimensions(this.dimensions);

  if ($injector.has('gmfDefaultDimensions')) {
    var defaultDimensions = $injector.get('gmfDefaultDimensions');

    for (var dim in defaultDimensions) {
      if (this.dimensions[dim] === undefined) {
        this.dimensions[dim] = defaultDimensions[dim];
      }
    }
  }

  this.backgroundLayerMgr_ = $injector.get('ngeoBackgroundLayerMgr');
  $scope.$watchCollection(function () {
    return _this.dimensions;
  }, function () {
    _this.backgroundLayerMgr_.updateDimensions(_this.map, _this.dimensions);
  });
  this.backgroundLayerMgr_.on('change', function () {
    _this.backgroundLayerMgr_.updateDimensions(_this.map, _this.dimensions);
  });
  this.leftNavVisible = false;
  this.rightNavVisible = false;
  var queryFill = new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_29__["default"]({
    color: [255, 170, 0, 0.6]
  });
  var queryStroke = new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_30__["default"]({
    color: [255, 170, 0, 1],
    width: 2
  });
  this.queryFeatureStyle = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_31__["default"]({
    fill: queryFill,
    image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_28__["default"]({
      fill: queryFill,
      radius: 5,
      stroke: queryStroke
    }),
    stroke: queryStroke
  });
  this.filterSelectorEnabled = false;
  this.filterSelectorActive = false;
  this.queryActive = true;
  this.queryAutoClear = true;
  this.printPanelActive = false;
  this.contextdataActive;
  this.printActive = false;
  this.ngeoMapQuerent_ = $injector.get('ngeoMapQuerent');
  $scope.$watch(function () {
    return _this.printPanelActive;
  }, function (newVal) {
    if (!newVal && !_this.queryActive) {
      _this.ngeoMapQuerent_.clear();
    }

    _this.queryAutoClear = !newVal;
    _this.printActive = newVal;
  });
  this.measureAreaActive = false;
  this.measurePointActive = false;
  this.measureLengthActive = false;
  this.drawFeatureActive = false;
  this.drawProfilePanelActive = false;
  this.gmfUser = $injector.get('gmfUser');
  $scope.$watch(function () {
    return _this.gmfUser.is_password_changed;
  }, function (value) {
    _this.userMustChangeItsPassword = value === false;
  });
  this.stateManager = $injector.get('ngeoStateManager');
  this.tmhDynamicLocale = $injector.get('tmhDynamicLocale');
  this.$scope = $scope;
  this.lang = '';
  this.defaultLang = $injector.get('defaultLang');
  this.langUrls = $injector.get('langUrls');
  this.gettextCatalog = $injector.get('gettextCatalog');
  this.initLanguage();
  var mapTools = 'mapTools';
  this.mapToolsGroup = mapTools;
  var ngeoFeatureOverlayMgr = $injector.get('ngeoFeatureOverlayMgr');
  ngeoFeatureOverlayMgr.init(this.map);
  var ngeoToolActivateMgr = $injector.get('ngeoToolActivateMgr');
  var queryToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__["default"](this, 'queryActive');
  ngeoToolActivateMgr.registerTool(mapTools, queryToolActivate, true);
  var measureAreaActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__["default"](this, 'measureAreaActive');
  ngeoToolActivateMgr.registerTool(mapTools, measureAreaActivate, false);
  var measurePointActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__["default"](this, 'measurePointActive');
  ngeoToolActivateMgr.registerTool(mapTools, measurePointActivate, false);
  var measureLengthActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__["default"](this, 'measureLengthActive');
  ngeoToolActivateMgr.registerTool(mapTools, measureLengthActivate, false);
  var drawFeatureActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__["default"](this, 'drawFeatureActive');
  ngeoToolActivateMgr.registerTool(mapTools, drawFeatureActivate, false);
  var drawProfilePanelActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__["default"](this, 'drawProfilePanelActive');
  ngeoToolActivateMgr.registerTool(mapTools, drawProfilePanelActivate, false);
  var printPanelActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__["default"](this, 'printPanelActive');
  ngeoToolActivateMgr.registerTool(mapTools, printPanelActivate, false);
  var contextdataActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_19__["default"](this, 'contextdataActive');
  ngeoToolActivateMgr.registerTool(mapTools, contextdataActivate, false);
  $scope.$root.$on(gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_32__["ThemeEventType"].THEME_NAME_SET, function (event, name) {
    _this.gmfThemes_.getThemeObject(name).then(function (theme) {
      _this.setDefaultBackground_(theme);
    });
  });

  this.updateCurrentBackgroundLayer_ = function (skipPermalink) {
    _this.gmfThemes_.getBgLayers().then(function (layers) {
      var background;

      if (!skipPermalink) {
        background = _this.permalink_.getBackgroundLayer(layers);
      }

      if (!background) {
        var functionalities = _this.gmfUser.functionalities;

        if (functionalities) {
          var defaultBasemapArray = functionalities.default_basemap;

          if (defaultBasemapArray.length > 0) {
            var defaultBasemapLabel = defaultBasemapArray[0];
            background = ol_array_js__WEBPACK_IMPORTED_MODULE_25__["find"](layers, function (layer) {
              return layer.get('label') === defaultBasemapLabel;
            });
          }
        }
      }

      if (!background && layers[1]) {
        background = layers[1];
      }

      if (background) {
        _this.backgroundLayerMgr_.set(_this.map, background);
      }
    });
  };

  this.updateCurrentBackgroundLayer_(false);

  var openPopup_ = function openPopup_(title, opt_width, opt_height, opt_apply) {
    _this.displaywindowTitle = title;
    _this.displaywindowOpen = true;

    if (opt_width) {
      _this.displaywindowWidth = opt_width + "px";
    }

    if (opt_height) {
      _this.displaywindowHeight = opt_height + "px";
    }

    if (opt_apply !== false) {
      _this.$scope.$apply();
    }
  };

  var gmfx = window.gmfx || {};
  window.gmfx = gmfx;

  gmfx.openIframePopup = function (url, title, opt_width, opt_height, opt_apply) {
    _this.displaywindowUrl = url;
    openPopup_(title, opt_width, opt_height, opt_apply);
  };

  gmfx.openTextPopup = function (content, title, opt_width, opt_height, opt_apply) {
    _this.displaywindowContent = content;
    openPopup_(title, opt_width, opt_height, opt_apply);
  };

  this.manageResize = false;
  this.resizeTransition;
  var cgxp = window.cgxp || {};
  window.cgxp = cgxp;
  cgxp.tools = window.cgxp.tools || {};

  cgxp.tools.openInfoWindow = function (url, title, opt_width, opt_height, opt_apply) {
    gmfx.openIframePopup(url, title, opt_width, opt_height, opt_apply);
  };

  this.displaywindowContent = null;
  this.displaywindowDraggableContainment = '.gmf-map';
  this.displaywindowHeight = '50vh';
  this.displaywindowOpen = false;
  this.displaywindowTitle = null;
  this.displaywindowUrl = null;
  this.displaywindowWidth = '50vw';

  if ($injector.has('sentryOptions')) {
    var options = $injector.get('sentryOptions');
    var tags = options.tags || [];
    delete options.tags;
    Object.assign(options, {
      beforeBreadcrumb: augmentBreadcrumb
    });
    _sentry_browser__WEBPACK_IMPORTED_MODULE_34__["init"](options);

    for (var tag in tags) {
      _sentry_browser__WEBPACK_IMPORTED_MODULE_34__["setTag"](tag, tags[tag]);
    }
  }

  var positionFeatureStyle = config.positionFeatureStyle || new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_31__["default"]({
    image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_28__["default"]({
      radius: 6,
      fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_29__["default"]({
        color: 'rgba(230, 100, 100, 1)'
      }),
      stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_30__["default"]({
        color: 'rgba(230, 40, 40, 1)',
        width: 2
      })
    })
  });
  var accuracyFeatureStyle = config.accuracyFeatureStyle || new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_31__["default"]({
    fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_29__["default"]({
      color: 'rgba(100, 100, 230, 0.3)'
    }),
    stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_30__["default"]({
      color: 'rgba(40, 40, 230, 1)',
      width: 2
    })
  });
  this.geolocationOptions = {
    positionFeatureStyle: positionFeatureStyle,
    accuracyFeatureStyle: accuracyFeatureStyle,
    zoom: config.geolocationZoom,
    autorotate: config.autorotate
  };
}

function getLayerByLabels(layers, labels) {
  if (labels && labels.length > 0) {
    return ol_array_js__WEBPACK_IMPORTED_MODULE_25__["find"](layers, function (layer) {
      return layer.get('label') === labels[0];
    });
  }

  return null;
}

AbstractAppController.prototype.switchLanguage = function (lang) {
  if (!(lang in this.langUrls)) {
    throw new Error('Missing lang URL');
  }

  this.gettextCatalog.setCurrentLanguage(lang);
  this.gettextCatalog.loadRemote(this.langUrls[lang]);
  this.tmhDynamicLocale.set(lang);
  this.lang = lang;
};

AbstractAppController.prototype.initLanguage = function () {
  var _this3 = this;

  this.$scope.$watch(function () {
    return _this3.lang;
  }, function (newValue) {
    _this3.stateManager.updateState({
      'lang': newValue
    });
  });
  var browserLanguage = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_33__["getBrowserLanguage"])(Object.keys(this.langUrls));
  var urlLanguage = this.stateManager.getInitialStringValue('lang');

  if (urlLanguage !== undefined && urlLanguage in this.langUrls) {
    this.switchLanguage(urlLanguage);
    return;
  } else if (browserLanguage !== undefined && browserLanguage in this.langUrls) {
    this.switchLanguage(browserLanguage);
    return;
  } else {
    this.switchLanguage(this.defaultLang);
    return;
  }
};

AbstractAppController.prototype.setDefaultBackground_ = function (theme) {
  var _this4 = this;

  this.gmfThemes_.getBgLayers().then(function (layers) {
    var layer;
    layer = _this4.permalink_.getBackgroundLayer(layers);

    if (!layer && _this4.gmfUser.functionalities) {
      layer = getLayerByLabels(layers, _this4.gmfUser.functionalities.default_basemap);
    }

    if (!layer && theme) {
      layer = getLayerByLabels(layers, theme.functionalities.default_basemap);
    }

    if (!layer) {
      layer = layers[layers.length > 1 ? 1 : 0];
    }

    if (!layer) {
      throw new Error('Missing layer');
    }

    _this4.backgroundLayerMgr_.set(_this4.map, layer);
  });
};

function getLocationIcon() {
  var arrow = document.createElement('span');
  arrow.className = 'fa fa-location-arrow';
  arrow.style.transform = 'rotate(-0.82rad)';
  var arrowWrapper = document.createElement('span');
  arrowWrapper.appendChild(arrow);
  return arrowWrapper;
}

function augmentBreadcrumb(breadcrumb, hint) {
  if (breadcrumb.category === 'ui.click') {
    var target = hint.event.target;

    if (target) {
      var message = target.dataset.sentry;

      if (message) {
        breadcrumb.message = breadcrumb.message + " | " + message;
      }
    }
  }
}

var module = angular__WEBPACK_IMPORTED_MODULE_1___default.a.module('GmfAbstractAppControllerModule', ['gettext', 'tmh.dynamicLocale', gmf_authentication_module_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, gmf_backgroundlayerselector_component_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, gmf_datasource_module_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, gmf_disclaimer_component_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, gmf_drawing_module_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, gmf_filters_module_js__WEBPACK_IMPORTED_MODULE_10__["default"].name, gmf_layertree_module_js__WEBPACK_IMPORTED_MODULE_11__["default"].name, gmf_map_module_js__WEBPACK_IMPORTED_MODULE_12__["default"].name, gmf_query_extraModule_js__WEBPACK_IMPORTED_MODULE_13__["default"].name, gmf_search_module_js__WEBPACK_IMPORTED_MODULE_14__["default"].name, gmf_theme_module_js__WEBPACK_IMPORTED_MODULE_15__["default"].name, ngeo_message_displaywindowComponent_js__WEBPACK_IMPORTED_MODULE_16__["default"].name, ngeo_misc_extraModule_js__WEBPACK_IMPORTED_MODULE_17__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_18__["default"].name, ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_20__["default"].name, ngeo_query_component_js__WEBPACK_IMPORTED_MODULE_21__["default"].name, ngeo_statemanager_module_js__WEBPACK_IMPORTED_MODULE_22__["default"].name, ngeo_statemanager_WfsPermalink_js__WEBPACK_IMPORTED_MODULE_23__["default"].name, ngeo_geolocation_component_js__WEBPACK_IMPORTED_MODULE_24__["default"].name]);
module.controller('AbstractController', AbstractAppController);
module.value('ngeoExportFeatureFormats', [ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_18__["FeatureFormatType"].KML, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_18__["FeatureFormatType"].GPX]);
module.config(['tmhDynamicLocaleProvider', 'angularLocaleScript', function (tmhDynamicLocaleProvider, angularLocaleScript) {
  tmhDynamicLocaleProvider.localeLocationPattern(angularLocaleScript);
}]);
Object(gmf_controllers_bootstrap_js__WEBPACK_IMPORTED_MODULE_4__["default"])(module);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/controllers/AbstractDesktopController.js":
/*!*******************************************************************!*\
  !*** ./contribs/gmf/src/controllers/AbstractDesktopController.js ***!
  \*******************************************************************/
/*! exports provided: AbstractDesktopController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractDesktopController", function() { return AbstractDesktopController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_controllers_AbstractAPIController_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/controllers/AbstractAPIController.js */ "./contribs/gmf/src/controllers/AbstractAPIController.js");
/* harmony import */ var gmf_contextualdata_module_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/contextualdata/module.js */ "./contribs/gmf/src/contextualdata/module.js");
/* harmony import */ var gmf_datasource_DataSourceBeingFiltered_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/datasource/DataSourceBeingFiltered.js */ "./contribs/gmf/src/datasource/DataSourceBeingFiltered.js");
/* harmony import */ var gmf_editing_module_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/editing/module.js */ "./contribs/gmf/src/editing/module.js");
/* harmony import */ var gmf_permalink_shareComponent_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/permalink/shareComponent.js */ "./contribs/gmf/src/permalink/shareComponent.js");
/* harmony import */ var gmf_print_module_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! gmf/print/module.js */ "./contribs/gmf/src/print/module.js");
/* harmony import */ var gmf_profile_module_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! gmf/profile/module.js */ "./contribs/gmf/src/profile/module.js");
/* harmony import */ var gmf_raster_component_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! gmf/raster/component.js */ "./contribs/gmf/src/raster/component.js");
/* harmony import */ var ngeo_map_swipe_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/map/swipe.js */ "./src/map/swipe.js");
/* harmony import */ var ngeo_draw_features_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/draw/features.js */ "./src/draw/features.js");
/* harmony import */ var ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/misc/ToolActivate.js */ "./src/misc/ToolActivate.js");
/* harmony import */ var ngeo_query_panelComponent_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/query/panelComponent.js */ "./src/query/panelComponent.js");
/* harmony import */ var gmf_import_module_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! gmf/import/module.js */ "./contribs/gmf/src/import/module.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_style_Text_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ol/style/Text.js */ "./node_modules/ol/style/Text.js");
function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }























var AbstractDesktopController = function (_AbstractAPIControlle) {
  AbstractDesktopController.$inject = ["config", "$scope", "$injector"];

  _inheritsLoose(AbstractDesktopController, _AbstractAPIControlle);

  function AbstractDesktopController(config, $scope, $injector) {
    var _this;

    _this = _AbstractAPIControlle.call(this, config, $scope, $injector) || this;
    _this.dataPanelActive = true;
    _this.loginActive = false;
    _this.toolsActive = false;
    _this.modalShareShown = false;
    _this.editFeatureActive = false;
    _this.queryPanelActive = false;
    _this.routingfeatureActive = false;
    _this.googleStreetViewActive = false;
    $scope.$watch(function () {
      return _this.googleStreetViewActive;
    }, function (newVal) {
      _this.setDataPanelMaxResizableWidth_();
    });
    _this.googleStreetViewStyle = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
      text: new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_21__["default"]({
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_18__["default"]({
          color: '#279B61'
        }),
        font: '900 30px "Font Awesome 5 Free"',
        offsetY: -15,
        stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_19__["default"]({
          color: '#ffffff',
          width: 3
        }),
        text: "\uF041"
      })
    });
    _this.importDataSourceActive = false;
    var body = $('body');
    body.tooltip({
      container: 'body',
      trigger: 'hover',
      selector: '[data-toggle="tooltip"]',
      sanitizeFn: $injector.get('$sanitize')
    });
    body.on('touchstart.detectTouch', function () {
      body.tooltip('dispose');
      body.off('touchstart.detectTouch');
    });
    var ngeoFeatureHelper = $injector.get('ngeoFeatureHelper');
    _this.editFeatureVectorLayer = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_16__["default"]({
      source: new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_17__["default"]({
        wrapX: false,
        features: new ol_Collection_js__WEBPACK_IMPORTED_MODULE_14__["default"]()
      }),
      style: function style(feature, resolution) {
        return ngeoFeatureHelper.createEditingStyles(feature);
      }
    });

    _this.editFeatureVectorLayer.setMap(_this.map);

    var ngeoToolActivateMgr = $injector.get('ngeoToolActivateMgr');
    _this.gmfDataSourceBeingFiltered = $injector.get('gmfDataSourceBeingFiltered');
    _this.gmfLayerBeingSwipe = $injector.get('gmfLayerBeingSwipe');
    var editFeatureActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_11__["default"](_assertThisInitialized(_this), 'editFeatureActive');
    ngeoToolActivateMgr.registerTool('mapTools', editFeatureActivate, false);
    var googleStreetViewActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_11__["default"](_assertThisInitialized(_this), 'googleStreetViewActive');
    ngeoToolActivateMgr.registerTool('mapTools', googleStreetViewActivate, false);
    _this.scaleSelectorOptions = {
      dropup: true
    };
    _this.profileLine = null;
    $scope.$watch(function () {
      return _this.gmfUser.username;
    }, function (newVal) {
      if (newVal !== null && _this.loginActive) {
        _this.loginActive = false;
      }
    });
    _this.dataPanelMinResizableWidth_ = 320;
    var dataPanelCls = 'gmf-app-data-panel';
    var $dataPanel = $("." + dataPanelCls).resizable({
      'ghost': true,
      'handles': 'e',
      'minWidth': _this.dataPanelMinResizableWidth_,
      'stop': function stop(event, ui) {
        _this.map.updateSize();
      }
    });
    _this.$dataPanel_ = $dataPanel;
    var $resizableEastHandle = $dataPanel.find('.ui-resizable-e').on('click', function (evt) {
      _this.dataPanelActive = !_this.dataPanelActive;

      _this.$scope.$apply();
    });
    $('<div>', {
      'class': dataPanelCls + "-toggle-btn btn prime btn-sm"
    }).appendTo($resizableEastHandle).append($('<span>', {
      'class': "fa fa-angle-double-left " + dataPanelCls + "-collapse-btn"
    })).append($('<span>', {
      'class': "fa fa-angle-double-right " + dataPanelCls + "-expand-btn"
    }));
    var ngeoDebounce = $injector.get('ngeoDebounce');
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_15__["listen"])(window, 'resize', ngeoDebounce(_this.setDataPanelMaxResizableWidth_.bind(_assertThisInitialized(_this)), 50, true));

    _this.setDataPanelMaxResizableWidth_();

    return _this;
  }

  var _proto = AbstractDesktopController.prototype;

  _proto.setDataPanelMaxResizableWidth_ = function setDataPanelMaxResizableWidth_() {
    var rightPanelWidth = 320;

    if (this.googleStreetViewActive) {
      rightPanelWidth += 140;
    }

    var minimumMapWidth = 120;
    var windowWidth = window.innerWidth;
    var maxWidth = windowWidth - rightPanelWidth - minimumMapWidth;

    if (maxWidth < this.dataPanelMinResizableWidth_) {
      maxWidth = this.dataPanelMinResizableWidth_;
    }

    this.$dataPanel_.resizable('option', 'maxWidth', maxWidth);
    var width = this.$dataPanel_.width();

    if (!width) {
      throw new Error('Missing width');
    }

    if (width > maxWidth) {
      this.$dataPanel_.width(maxWidth);
      this.map.updateSize();
    }
  };

  return AbstractDesktopController;
}(gmf_controllers_AbstractAPIController_js__WEBPACK_IMPORTED_MODULE_1__["AbstractAPIController"]);
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('GmfAbstractDesktopControllerModule', [ngeo_query_panelComponent_js__WEBPACK_IMPORTED_MODULE_12__["default"].name, gmf_controllers_AbstractAPIController_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_contextualdata_module_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_datasource_DataSourceBeingFiltered_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, gmf_editing_module_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, gmf_permalink_shareComponent_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, gmf_print_module_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, gmf_profile_module_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, gmf_raster_component_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, ngeo_draw_features_js__WEBPACK_IMPORTED_MODULE_10__["default"].name, gmf_import_module_js__WEBPACK_IMPORTED_MODULE_13__["default"].name, ngeo_map_swipe_js__WEBPACK_IMPORTED_MODULE_9__["default"].name]);
module.controller('AbstractDesktopController', AbstractDesktopController);
module.value('ngeoMeasurePrecision', 3);
module.value('ngeoMeasureDecimals', 0);
module.value('ngeoSnappingTolerance', 20);
module.value('ngeoSnappingSource', new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_17__["default"]());
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/controllers/bootstrap.js":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/controllers/bootstrap.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_1__);



function bootstrap(module) {
  var oldObjectToString = Object.prototype.toString;

  if (!oldObjectToString.toString().includes('[native code]')) {
    Object.prototype.toString = function () {
      if (this === null) {
        return '[object Null]';
      }

      if (this === undefined) {
        return '[object Undefined]';
      }

      return oldObjectToString.call(this);
    };
  }

  var interface_ = jquery__WEBPACK_IMPORTED_MODULE_0___default()('meta[name=interface]')[0].getAttribute('content');
  var dynamicUrl_ = jquery__WEBPACK_IMPORTED_MODULE_0___default()('meta[name=dynamicUrl]')[0].getAttribute('content');
  var search = document.location ? document.location.search || '' : '';
  var dynamicUrl = dynamicUrl_ + "?interface=" + interface_ + "&query=" + encodeURIComponent(search) + "&path=" + encodeURIComponent(document.location.pathname);
  var request = jquery__WEBPACK_IMPORTED_MODULE_0___default.a.ajax(dynamicUrl, {
    'dataType': 'json',
    'xhrFields': {
      withCredentials: false
    }
  });
  request.fail(function (jqXHR, textStatus) {
    window.alert("Failed to get the dynamic: " + textStatus);
  });
  request.done(function (dynamic) {
    if (dynamic.doRedirect) {
      var small_screen = window.matchMedia ? window.matchMedia('(max-width: 1024px)') : false;

      if (small_screen && 'ontouchstart' in window) {
        window.location.href = dynamic.redirectUrl;
      }
    }

    for (var name in dynamic.constants) {
      module.constant(name, dynamic.constants[name]);
    }

    angular__WEBPACK_IMPORTED_MODULE_1___default.a.bootstrap(document, ["App" + interface_]);
  });
}

/* harmony default export */ __webpack_exports__["default"] = (bootstrap);

/***/ }),

/***/ "./contribs/gmf/src/controllers/desktop.scss":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/controllers/desktop.scss ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/datasource/DataSourceBeingFiltered.js":
/*!****************************************************************!*\
  !*** ./contribs/gmf/src/datasource/DataSourceBeingFiltered.js ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDataSourceBeingFiltered', []);
module.value('gmfDataSourceBeingFiltered', {
  dataSource: null
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/datasource/ExternalDataSourcesManager.js":
/*!*******************************************************************!*\
  !*** ./contribs/gmf/src/datasource/ExternalDataSourcesManager.js ***!
  \*******************************************************************/
/*! exports provided: ExternalDatSourcesManager, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ExternalDatSourcesManager", function() { return ExternalDatSourcesManager; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/index.js */ "./contribs/gmf/src/index.js");
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
/* harmony import */ var ngeo_misc_File_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/misc/File.js */ "./src/misc/File.js");
/* harmony import */ var ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/datasource/DataSources.js */ "./src/datasource/DataSources.js");
/* harmony import */ var ngeo_datasource_File_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/datasource/File.js */ "./src/datasource/File.js");
/* harmony import */ var ngeo_datasource_FileGroup_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/datasource/FileGroup.js */ "./src/datasource/FileGroup.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
/* harmony import */ var ngeo_datasource_OGCGroup_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/datasource/OGCGroup.js */ "./src/datasource/OGCGroup.js");
/* harmony import */ var ngeo_datasource_WMSGroup_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/datasource/WMSGroup.js */ "./src/datasource/WMSGroup.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_format_GPX_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ol/format/GPX.js */ "./node_modules/ol/format/GPX.js");
/* harmony import */ var ol_format_KML_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/format/KML.js */ "./node_modules/ol/format/KML.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }


















var ExternalDatSourcesManager = function () {
  ExternalDatSourcesManager.$inject = ["gettextCatalog", "$injector", "$q", "$rootScope", "ngeoDataSources", "ngeoFile", "ngeoLayerHelper"];

  function ExternalDatSourcesManager(gettextCatalog, $injector, $q, $rootScope, ngeoDataSources, ngeoFile, ngeoLayerHelper) {
    this.injector_ = $injector;
    this.q_ = $q;
    this.rootScope_ = $rootScope;
    this.dataSources_ = ngeoDataSources.collection;
    this.ngeoFile_ = ngeoFile;
    this.ngeoLayerHelper_ = ngeoLayerHelper;
    this.extDataSources_ = {};
    this.files_ = {};
    this.map_ = null;
    this.fileGroup_ = new ngeo_datasource_FileGroup_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
      dataSources: [],
      injector: this.injector_,
      title: gettextCatalog.getString('Local files')
    });
    this.wmsGroupsCollection_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_13__["default"]();
    this.wmtsGroupsCollection_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_13__["default"]();
    this.wmtsCache_ = {};
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_12__["listen"])(this.dataSources_, 'remove', this.handleDataSourcesRemove_, this);
  }

  var _proto = ExternalDatSourcesManager.prototype;

  _proto.addWMSGroup_ = function addWMSGroup_(wmsGroup) {
    this.wmsGroupsCollection.push(wmsGroup);
  };

  _proto.removeWMSGroup_ = function removeWMSGroup_(wmsGroup) {
    this.wmsGroupsCollection.remove(wmsGroup);
  };

  _proto.getWMSGroup = function getWMSGroup(url) {
    var found = null;

    for (var _iterator = this.wmsGroups, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var wmsGroup = _ref;

      if (wmsGroup.url === url) {
        found = wmsGroup;
        break;
      }
    }

    return found;
  };

  _proto.addWMTSGroup_ = function addWMTSGroup_(wmtsGroup) {
    this.wmtsGroupsCollection.push(wmtsGroup);
  };

  _proto.removeWMTSGroup_ = function removeWMTSGroup_(wmtsGroup) {
    this.wmtsGroupsCollection.remove(wmtsGroup);
  };

  _proto.getWMTSGroup = function getWMTSGroup(url) {
    var found = null;

    for (var _iterator2 = this.wmtsGroups, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
      var _ref2;

      if (_isArray2) {
        if (_i2 >= _iterator2.length) break;
        _ref2 = _iterator2[_i2++];
      } else {
        _i2 = _iterator2.next();
        if (_i2.done) break;
        _ref2 = _i2.value;
      }

      var wmtsGroup = _ref2;

      if (wmtsGroup.url === url) {
        found = wmtsGroup;
        break;
      }
    }

    return found;
  };

  _proto.isExternalDataSource = function isExternalDataSource(dataSource) {
    return !!this.extDataSources_[dataSource.id];
  };

  _proto.addLayer_ = function addLayer_(layer) {
    this.layerGroup.getLayers().push(layer);
  };

  _proto.removeLayer_ = function removeLayer_(layer) {
    this.layerGroup.getLayers().remove(layer);
  };

  _proto.createAndAddDataSourceFromWMSCapability = function createAndAddDataSourceFromWMSCapability(layer, capabilities, url) {
    var id = getId(layer);
    var service = capabilities.Service;
    url = service.OnlineResource || url;
    var dataSource;

    if (this.extDataSources_[id]) {
      dataSource = this.extDataSources_[id];
    } else {
      var req = capabilities.Capability.Request;
      var formats = req.GetMap.Format;
      var imagePngType = 'image/png';
      var ogcImageType = formats.includes(imagePngType) ? imagePngType : formats[0];
      var infoFormats = req.GetFeatureInfo.Format;
      var wmsInfoFormat = infoFormats.includes(ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["WMSInfoFormat"].GML) ? ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["WMSInfoFormat"].GML : undefined;
      var queryable = layer.queryable === true && wmsInfoFormat !== undefined;
      var options = {
        id: id,
        name: layer.Title,
        ogcImageType: ogcImageType,
        wmsLayers: [{
          name: layer.Name,
          queryable: queryable
        }],
        ogcType: ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["Type"].WMS,
        visible: true,
        wmsUrl: url
      };

      if (wmsInfoFormat) {
        options.wmsInfoFormat = wmsInfoFormat;
      }

      dataSource = new ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["default"](options);
      this.extDataSources_[id] = dataSource;
    }

    var wmsGroup = this.getWMSGroup(url);

    if (wmsGroup) {
      if (!wmsGroup.dataSources.includes(dataSource)) {
        wmsGroup.addDataSource(dataSource);
        this.dataSources_.push(dataSource);
      }
    } else {
      wmsGroup = new ngeo_datasource_WMSGroup_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
        dataSources: [dataSource],
        injector: this.injector_,
        title: service.Title,
        url: url
      }, this.ngeoLayerHelper_);
      this.addLayer_(wmsGroup.layer);
      this.addWMSGroup_(wmsGroup);
      this.dataSources_.push(dataSource);
    }
  };

  _proto.createAndAddDataSourceFromWMTSCapability = function createAndAddDataSourceFromWMTSCapability(layer, capabilities, wmtsUrl) {
    var id = getId(layer);

    if (this.wmtsCache_[id]) {
      return;
    }

    var dataSource;

    if (this.extDataSources_[id]) {
      dataSource = this.extDataSources_[id];
    } else {
      var name = typeof layer.Title;
      var wmtsLayer = typeof layer.Identifier;
      dataSource = new ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
        id: id,
        name: name,
        ogcType: ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["Type"].WMTS,
        visible: true,
        wmtsLayer: wmtsLayer,
        wmtsUrl: wmtsUrl
      });
      this.extDataSources_[id] = dataSource;
    }

    var wmtsGroup = this.getWMTSGroup(wmtsUrl);

    if (!wmtsGroup) {
      wmtsGroup = new ngeo_datasource_OGCGroup_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
        dataSources: [],
        title: capabilities.ServiceIdentification.Title,
        url: wmtsUrl
      });
      this.addWMTSGroup_(wmtsGroup);
    }

    wmtsGroup.addDataSource(dataSource);
    var layerObj = this.ngeoLayerHelper_.createWMTSLayerFromCapabilititesObj(capabilities, layer);
    this.addLayer_(layerObj);
    this.dataSources_.push(dataSource);
    this.wmtsCache_[id] = {
      layerObj: layerObj,
      unregister: this.rootScope_.$watch(function () {
        return dataSource.visible;
      }, this.handleWMTSDataSourceVisibleChange_.bind(this, layerObj))
    };
  };

  _proto.createAndAddDataSourceFromFile = function createAndAddDataSourceFromFile(file, opt_callback) {
    var _this = this;

    this.getFileDataSource_(file).then(function (dataSource) {
      var success = true;
      var fileGroup = _this.fileGroup_;

      if (Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_11__["isEmpty"])(dataSource.extent)) {
        success = false;
      } else {
        if (!_this.map_) {
          throw new Error('Missing map');
        }

        if (fileGroup.dataSources.includes(dataSource)) {
          return;
        }

        _this.addLayer_(dataSource.layer);

        fileGroup.addDataSource(dataSource);

        _this.map_.getView().fit(dataSource.extent);

        _this.dataSources_.push(dataSource);
      }

      if (opt_callback) {
        opt_callback(success);
      }
    }, function (rejections) {
      console.error("Failed to load file: " + file.name);

      if (opt_callback) {
        opt_callback(false);
      }
    });
  };

  _proto.getFileDataSource_ = function getFileDataSource_(file) {
    var _this2 = this;

    var defer = this.q_.defer();

    if (this.files_[file.name]) {
      defer.resolve(this.files_[file.name]);
    } else {
      var ngeoFile = this.ngeoFile_;
      ngeoFile.read(file).then(function (content) {
        if (!_this2.map_) {
          throw new Error('Missing map');
        }

        var features;
        var readOptions = {
          featureProjection: _this2.map_.getView().getProjection()
        };

        if (ngeoFile.isKml(content)) {
          features = new ol_format_KML_js__WEBPACK_IMPORTED_MODULE_15__["default"]().readFeatures(content, readOptions);
        } else if (ngeoFile.isGpx(content)) {
          features = new ol_format_GPX_js__WEBPACK_IMPORTED_MODULE_14__["default"]().readFeatures(content, readOptions);
        }

        if (features) {
          var id = getId(file);
          var dataSource = new ngeo_datasource_File_js__WEBPACK_IMPORTED_MODULE_5__["default"]({
            features: new ol_Collection_js__WEBPACK_IMPORTED_MODULE_13__["default"](features),
            id: id,
            name: file.name,
            visible: true
          });
          _this2.files_[file.name] = dataSource;
          _this2.extDataSources_[id] = dataSource;
          defer.resolve(dataSource);
        } else {
          defer.reject();
        }
      });
    }

    return defer.promise;
  };

  _proto.handleWMTSDataSourceVisibleChange_ = function handleWMTSDataSourceVisibleChange_(layer, value, oldValue) {
    if (value !== undefined && value !== oldValue) {
      layer.setVisible(value);
    }
  };

  _proto.handleDataSourcesRemove_ = function handleDataSourcesRemove_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_13__["CollectionEvent"]) {
      var dataSource = evt.element;

      if (this.extDataSources_[dataSource.id] === dataSource) {
        if (dataSource instanceof ngeo_datasource_File_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
          this.removeFileDataSource_(dataSource);
        } else if (dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["default"]) {
          this.removeOGCDataSource_(dataSource);
        }
      }
    }
  };

  _proto.removeFileDataSource_ = function removeFileDataSource_(dataSource) {
    this.removeLayer_(dataSource.layer);
    this.fileGroup_.removeDataSource(dataSource);
  };

  _proto.removeOGCDataSource_ = function removeOGCDataSource_(dataSource) {
    if (dataSource.ogcType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["Type"].WMS) {
      if (!dataSource.wmsUrl) {
        throw new Error('Missing dataSource.wmsUrl');
      }

      var wmsGroup = this.getWMSGroup(dataSource.wmsUrl);

      if (wmsGroup && wmsGroup.dataSources.includes(dataSource)) {
        wmsGroup.removeDataSource(dataSource);

        if (!wmsGroup.dataSources.length) {
          this.removeLayer_(wmsGroup.layer);
          wmsGroup.destroy();
          this.removeWMSGroup_(wmsGroup);
        }
      }
    } else if (dataSource.ogcType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_7__["Type"].WMTS) {
      if (!dataSource.wmtsUrl) {
        throw new Error('Missing dataSource.wmsUrl');
      }

      var wmtsGroup = this.getWMTSGroup(dataSource.wmtsUrl);

      if (wmtsGroup && wmtsGroup.dataSources.includes(dataSource)) {
        wmtsGroup.removeDataSource(dataSource);
        var id = dataSource.id;
        this.removeLayer_(this.wmtsCache_[id].layerObj);
        this.wmtsCache_[id].unregister();
        delete this.wmtsCache_[id];

        if (!wmtsGroup.dataSources.length) {
          wmtsGroup.destroy();
          this.removeWMTSGroup_(wmtsGroup);
        }
      }
    }
  };

  _createClass(ExternalDatSourcesManager, [{
    key: "fileGroup",
    get: function get() {
      return this.fileGroup_;
    }
  }, {
    key: "wmsGroups",
    get: function get() {
      return this.wmsGroupsCollection_.getArray();
    }
  }, {
    key: "wmsGroupsCollection",
    get: function get() {
      return this.wmsGroupsCollection_;
    }
  }, {
    key: "wmtsGroups",
    get: function get() {
      return this.wmtsGroupsCollection_.getArray();
    }
  }, {
    key: "wmtsGroupsCollection",
    get: function get() {
      return this.wmtsGroupsCollection_;
    }
  }, {
    key: "layerGroup",
    get: function get() {
      if (!this.map_) {
        throw new Error('Missing map');
      }

      return this.ngeoLayerHelper_.getGroupFromMap(this.map_, gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["EXTERNALLAYERGROUP_NAME"]);
    }
  }, {
    key: "map",
    set: function set(map) {
      this.map_ = map;
    }
  }]);

  return ExternalDatSourcesManager;
}();

function getId(layer) {
  return Number(Object(ol_util_js__WEBPACK_IMPORTED_MODULE_10__["getUid"])(layer)) + 1000000;
}

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfExternalDataSourcesManager', [ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_misc_File_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_4__["default"].name]);
module.service('gmfExternalDataSourcesManager', ExternalDatSourcesManager);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/datasource/Helper.js":
/*!***********************************************!*\
  !*** ./contribs/gmf/src/datasource/Helper.js ***!
  \***********************************************/
/*! exports provided: DatasourceHelper, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DatasourceHelper", function() { return DatasourceHelper; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_editing_EnumerateAttribute_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/editing/EnumerateAttribute.js */ "./contribs/gmf/src/editing/EnumerateAttribute.js");
/* harmony import */ var ngeo_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/datasource/Helper.js */ "./src/datasource/Helper.js");
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }





var DatasourceHelper = function () {
  DatasourceHelper.$inject = ["$q", "gmfEnumerateAttribute", "ngeoDataSourcesHelper"];

  function DatasourceHelper($q, gmfEnumerateAttribute, ngeoDataSourcesHelper) {
    this.q_ = $q;
    this.gmfEnumerateAttribute_ = gmfEnumerateAttribute;
    this.ngeoDataSourcesHelper_ = ngeoDataSourcesHelper;
    this.collection_ = null;
    this.cache_ = {};
  }

  var _proto = DatasourceHelper.prototype;

  _proto.getDataSource = function getDataSource(id) {
    return this.ngeoDataSourcesHelper_.getDataSource(id);
  };

  _proto.prepareFiltrableDataSource = function prepareFiltrableDataSource(dataSource) {
    var _this = this;

    var prepareFiltrableDataSourceDefer = this.q_.defer();
    this.ngeoDataSourcesHelper_.getDataSourceAttributes(dataSource).then(function (attributes) {
      var enumAttributes = dataSource.gmfLayer.metadata ? dataSource.gmfLayer.metadata.enumeratedAttributes : undefined;

      if (enumAttributes && enumAttributes.length) {
        var promises = [];

        var _loop = function _loop() {
          if (_isArray) {
            if (_i >= _iterator.length) return "break";
            _ref = _iterator[_i++];
          } else {
            _i = _iterator.next();
            if (_i.done) return "break";
            _ref = _i.value;
          }

          var attribute = _ref;

          if (enumAttributes.includes(attribute.name) && attribute.type !== ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_3__["default"].SELECT && (!attribute.choices || !attribute.choices.length)) {
            promises.push(_this.gmfEnumerateAttribute_.getAttributeValues(dataSource, attribute.name).then(function (values) {
              var choices = values.map(function (choice) {
                return choice.value;
              });
              attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_3__["default"].SELECT;
              attribute.choices = choices;
            }));
          }
        };

        for (var _iterator = attributes, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
          var _ref;

          var _ret = _loop();

          if (_ret === "break") break;
        }

        return _this.q_.all(promises).then(function () {
          prepareFiltrableDataSourceDefer.resolve(dataSource);
        });
      } else {
        prepareFiltrableDataSourceDefer.resolve(dataSource);
      }
    });
    return prepareFiltrableDataSourceDefer.promise;
  };

  _createClass(DatasourceHelper, [{
    key: "collection",
    get: function get() {
      return this.ngeoDataSourcesHelper_.collection;
    }
  }]);

  return DatasourceHelper;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDataSourcesHelper', [ngeo_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_editing_EnumerateAttribute_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.service('gmfDataSourcesHelper', DatasourceHelper);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/datasource/LayerBeingSwipe.js":
/*!********************************************************!*\
  !*** ./contribs/gmf/src/datasource/LayerBeingSwipe.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfLayerBeingSwipe', []);
module.value('gmfLayerBeingSwipe', {
  layer: null,
  swipeValue: null
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/datasource/Manager.js":
/*!************************************************!*\
  !*** ./contribs/gmf/src/datasource/Manager.js ***!
  \************************************************/
/*! exports provided: DatasourceManager, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DatasourceManager", function() { return DatasourceManager; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/datasource/OGC.js */ "./contribs/gmf/src/datasource/OGC.js");
/* harmony import */ var gmf_datasource_WFSAliases_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/datasource/WFSAliases.js */ "./contribs/gmf/src/datasource/WFSAliases.js");
/* harmony import */ var gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/layertree/SyncLayertreeMap.js */ "./contribs/gmf/src/layertree/SyncLayertreeMap.js");
/* harmony import */ var gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/layertree/TreeManager.js */ "./contribs/gmf/src/layertree/TreeManager.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
/* harmony import */ var ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/datasource/DataSources.js */ "./src/datasource/DataSources.js");
/* harmony import */ var ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/filter/RuleHelper.js */ "./src/filter/RuleHelper.js");
/* harmony import */ var ngeo_map_BackgroundLayerMgr_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/map/BackgroundLayerMgr.js */ "./src/map/BackgroundLayerMgr.js");
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
/* harmony import */ var ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/misc/WMSTime.js */ "./src/misc/WMSTime.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ol/layer/Tile.js */ "./node_modules/ol/layer/Tile.js");
/* harmony import */ var ol_obj_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/obj.js */ "./node_modules/ol/obj.js");
/* harmony import */ var ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/layer/Image.js */ "./node_modules/ol/layer/Image.js");
/* harmony import */ var ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/source/ImageWMS.js */ "./node_modules/ol/source/ImageWMS.js");
/* harmony import */ var ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/source/TileWMS.js */ "./node_modules/ol/source/TileWMS.js");




















var DatasourceManager = function () {
  DatasourceManager.$inject = ["$q", "$rootScope", "$timeout", "gmfThemes", "gmfTreeManager", "ngeoBackgroundLayerMgr", "ngeoDataSources", "ngeoLayerHelper", "ngeoRuleHelper", "ngeoWMSTime", "gmfWFSAliases"];

  function DatasourceManager($q, $rootScope, $timeout, gmfThemes, gmfTreeManager, ngeoBackgroundLayerMgr, ngeoDataSources, ngeoLayerHelper, ngeoRuleHelper, ngeoWMSTime, gmfWFSAliases) {
    this.q_ = $q;
    this.rootScope_ = $rootScope;
    this.timeout_ = $timeout;
    this.gmfThemes_ = gmfThemes;
    this.gmfTreeManager_ = gmfTreeManager;
    this.ngeoBackgroundLayerMgr_ = ngeoBackgroundLayerMgr;
    this.ngeoDataSources_ = ngeoDataSources;
    this.dataSources_ = ngeoDataSources.collection;
    this.ngeoLayerHelper_ = ngeoLayerHelper;
    this.ngeoRuleHelper_ = ngeoRuleHelper;
    this.ngeoWMSTime_ = ngeoWMSTime;
    this.gmfWFSAliases_ = gmfWFSAliases;
    this.dataSourcesCache_ = {};
    this.dimensions_;
    this.dimensionsWatcherUnregister = null;
    this.treeCtrlCache_ = {};
    this.treeCtrlsUnregister_ = null;
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_13__["listen"])(this.ngeoBackgroundLayerMgr_, 'change', this.handleNgeoBackgroundLayerChange_, this);
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_13__["listen"])(this.gmfThemes_, 'change', this.handleThemesChange_, this);
  }

  var _proto = DatasourceManager.prototype;

  _proto.setDatasourceMap = function setDatasourceMap(map) {
    this.ngeoDataSources_.map = map;
  };

  _proto.setDimensions = function setDimensions(dimensions) {
    var _this = this;

    if (this.dimensionsWatcherUnregister) {
      this.dimensionsWatcherUnregister();
    }

    this.dimensions_ = dimensions;
    this.dimensionsWatcherUnregister = this.rootScope_.$watch(function () {
      return _this.dimensions_;
    }, this.handleDimensionsChange_.bind(this), true);
    this.handleDimensionsChange_();
  };

  _proto.handleDimensionsChange_ = function handleDimensionsChange_() {
    var layers = [];
    var layerIds = [];
    var dataSources = this.dataSources_.getArray();

    for (var _iterator = dataSources, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var dataSource = _ref;

      if (dataSource instanceof gmf_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"] && dataSource.dimensionsFiltersConfig) {
        for (var key in dataSource.dimensionsFiltersConfig) {
          if (dataSource.dimensionsFiltersConfig[key].value === null) {
            var layer = this.getDataSourceLayer_(dataSource);

            if (layer == undefined) {
              return;
            }

            var id = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(layer);

            if (!layerIds.includes(id)) {
              layers.push(layer);
              layerIds.push(id);
            }
          }
        }
      }
    }

    layers.forEach(this.updateLayerFilter_.bind(this));
  };

  _proto.handleThemesChange_ = function handleThemesChange_() {
    var _this2 = this;

    this.clearDataSources_();

    if (this.treeCtrlsUnregister_) {
      this.treeCtrlsUnregister_();
    }

    this.clearTreeCtrlCache_();
    this.gmfThemes_.getOgcServersObject().then(function (ogcServers) {
      var promiseThemes = _this2.gmfThemes_.getThemesObject().then(function (themes) {
        for (var _iterator2 = themes, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
          var _ref2;

          if (_isArray2) {
            if (_i2 >= _iterator2.length) break;
            _ref2 = _iterator2[_i2++];
          } else {
            _i2 = _iterator2.next();
            if (_i2.done) break;
            _ref2 = _i2.value;
          }

          var theme = _ref2;

          for (var _iterator3 = theme.children, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
            var _ref3;

            if (_isArray3) {
              if (_i3 >= _iterator3.length) break;
              _ref3 = _iterator3[_i3++];
            } else {
              _i3 = _iterator3.next();
              if (_i3.done) break;
              _ref3 = _i3.value;
            }

            var child = _ref3;

            _this2.createDataSource_(child, child, ogcServers);
          }
        }
      });

      var promiseBgLayers = _this2.gmfThemes_.getBackgroundLayersObject().then(function (backgroundLayers) {
        for (var _iterator4 = backgroundLayers, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {
          var _ref4;

          if (_isArray4) {
            if (_i4 >= _iterator4.length) break;
            _ref4 = _iterator4[_i4++];
          } else {
            _i4 = _iterator4.next();
            if (_i4.done) break;
            _ref4 = _i4.value;
          }

          var backgroundLayer = _ref4;

          _this2.createDataSource_(null, backgroundLayer, ogcServers);
        }
      });

      _this2.q_.all([promiseThemes, promiseBgLayers]).then(function () {
        _this2.treeCtrlsUnregister_ = _this2.rootScope_.$watchCollection(function () {
          if (_this2.gmfTreeManager_.rootCtrl) {
            return _this2.gmfTreeManager_.rootCtrl.children;
          }
        }, _this2.handleTreeManagerRootChildrenChange_.bind(_this2));
      });
    });
  };

  _proto.handleTreeManagerRootChildrenChange_ = function handleTreeManagerRootChildrenChange_(value) {
    var _this3 = this;

    this.timeout_(function () {
      if (!value) {
        return;
      }

      var newTreeCtrls = [];

      var visitor = function visitor(treeCtrl) {
        var node = treeCtrl.node;
        var groupNode = node;
        var children = groupNode.children;

        if (!children) {
          newTreeCtrls.push(treeCtrl);
        }
      };

      for (var i = 0, ii = value.length; i < ii; i++) {
        value[i].traverseDepthFirst(visitor);
      }

      for (var _i5 = 0, _ii = newTreeCtrls.length; _i5 < _ii; _i5++) {
        var newTreeCtrl = newTreeCtrls[_i5];

        var cacheItem = _this3.getTreeCtrlCacheItem_(newTreeCtrl);

        if (!cacheItem) {
          _this3.addTreeCtrlToCache_(newTreeCtrl);
        }
      }

      var cache = _this3.treeCtrlCache_;

      for (var id in _this3.treeCtrlCache_) {
        var item = cache[id];

        if (!newTreeCtrls.includes(item.treeCtrl)) {
          _this3.removeTreeCtrlCacheItem_(item);
        }
      }
    });
  };

  _proto.clearDataSources_ = function clearDataSources_() {
    var dataSources = this.dataSources_.getArray();

    for (var i = dataSources.length - 1, ii = 0; i >= ii; i--) {
      if (this.dataSourcesCache_[dataSources[i].id]) {
        this.dataSources_.remove(dataSources[i]);
      }
    }

    Object(ol_obj_js__WEBPACK_IMPORTED_MODULE_15__["clear"])(this.dataSourcesCache_);
  };

  _proto.createDataSource_ = function createDataSource_(firstLevelGroup, node, ogcServers) {
    var groupNode = node;
    var children = groupNode.children;

    if (children) {
      for (var _iterator5 = children, _isArray5 = Array.isArray(_iterator5), _i6 = 0, _iterator5 = _isArray5 ? _iterator5 : _iterator5[Symbol.iterator]();;) {
        var _ref5;

        if (_isArray5) {
          if (_i6 >= _iterator5.length) break;
          _ref5 = _iterator5[_i6++];
        } else {
          _i6 = _iterator5.next();
          if (_i6.done) break;
          _ref5 = _i6.value;
        }

        var child = _ref5;
        this.createDataSource_(firstLevelGroup, child, ogcServers);
      }

      return;
    }

    var gmfLayer = node;
    var id = Number(Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(gmfLayer));

    if (this.dataSourcesCache_[id]) {
      return;
    }

    var meta = gmfLayer.metadata;
    var ogcType = gmfLayer.type;
    var maxResolution = 0;
    var minResolution = 0;
    var wmsLayers;
    var wfsLayers;
    var ogcServer;
    var wmtsLayer;
    var wmtsUrl;
    var ogcImageType;
    var timeProperty;

    if (ogcType === gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_5__["ThemeNodeType"].WMTS) {
      var gmfLayerWMTS = gmfLayer;
      wmtsLayer = gmfLayerWMTS.layer;
      wmtsUrl = gmfLayerWMTS.url;
      maxResolution = meta.maxResolution;
      minResolution = meta.minResolution;
      var layers = meta.queryLayers || meta.wmsLayers;

      if (layers) {
        wmsLayers = layers.split(',').map(function (layer) {
          return {
            name: layer,
            queryable: true
          };
        });
        wfsLayers = layers.split(',').map(function (layer) {
          return {
            maxResolution: maxResolution,
            minResolution: minResolution,
            name: layer,
            queryable: true
          };
        });
      }

      if (meta.ogcServer && ogcServers[meta.ogcServer]) {
        ogcServer = ogcServers[meta.ogcServer];
      }

      ogcImageType = gmfLayerWMTS.imageType;
    } else if (ogcType === gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_5__["ThemeNodeType"].WMS) {
      var gmfLayerWMS = gmfLayer;
      maxResolution = gmfLayerWMS.maxResolutionHint;
      minResolution = gmfLayerWMS.minResolutionHint;
      var queryable = false;

      for (var _iterator6 = gmfLayerWMS.childLayers, _isArray6 = Array.isArray(_iterator6), _i7 = 0, _iterator6 = _isArray6 ? _iterator6 : _iterator6[Symbol.iterator]();;) {
        var _ref6;

        if (_isArray6) {
          if (_i7 >= _iterator6.length) break;
          _ref6 = _iterator6[_i7++];
        } else {
          _i7 = _iterator6.next();
          if (_i7.done) break;
          _ref6 = _i7.value;
        }

        var wfslayer = _ref6;

        if (wfslayer.queryable) {
          queryable = true;
          break;
        }
      }

      wmsLayers = gmfLayerWMS.layers.split(',').map(function (childLayer) {
        return {
          name: childLayer,
          queryable: queryable
        };
      });
      wfsLayers = gmfLayerWMS.childLayers.map(function (childLayer) {
        return {
          maxResolution: childLayer.maxResolutionHint,
          minResolution: childLayer.minResolutionHint,
          name: childLayer.name,
          queryable: childLayer.queryable
        };
      });
      var ogcServerName = !firstLevelGroup || firstLevelGroup.mixed ? gmfLayerWMS.ogcServer : firstLevelGroup.ogcServer;
      ogcServer = ogcServers[ogcServerName];
      ogcImageType = ogcServer.imageType;

      if (gmfLayerWMS.time) {
        timeProperty = gmfLayerWMS.time;
      } else if (firstLevelGroup && firstLevelGroup.time) {
        timeProperty = firstLevelGroup.time;
      }
    }

    var ogcServerType = ogcServer ? ogcServer.type : undefined;
    var wfsFeatureNS = ogcServer ? ogcServer.namespace : undefined;
    var wmsIsSingleTile = ogcServer ? ogcServer.isSingleTile : undefined;
    var wfsUrl = ogcServer && ogcServer.wfsSupport ? ogcServer.urlWfs : undefined;
    var wmsUrl = ogcServer ? ogcServer.url : undefined;
    var wfsOutputFormat = ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_6__["WFSOutputFormat"].GML3;

    if (ogcServerType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_6__["ServerType"].QGISSERVER) {
      wfsOutputFormat = ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_6__["WFSOutputFormat"].GML2;
    }

    var snappable = !!meta.snappingConfig;
    var snappingTolerance = meta.snappingConfig ? meta.snappingConfig.tolerance : undefined;
    var snappingToEdges = meta.snappingConfig ? meta.snappingConfig.edge : undefined;
    var snappingToVertice = meta.snappingConfig ? meta.snappingConfig.vertex : undefined;
    var dimensions = this.dimensions_;
    var dimensionsConfig = node.dimensions || firstLevelGroup === null ? {} : firstLevelGroup.dimensions;
    var dimensionsFiltersConfig = gmfLayer.dimensionsFilters;
    var timeLowerValue;
    var timeUpperValue;

    if (timeProperty) {
      var timeValues = this.ngeoWMSTime_.getOptions(timeProperty).values;

      if (Array.isArray(timeValues)) {
        timeLowerValue = timeValues[0];
        timeUpperValue = timeValues[1];
      } else {
        timeLowerValue = timeValues;
      }
    }

    var copyable = meta.copyable;
    var identifierAttribute = meta.identifierAttributeField;
    var name = gmfLayer.name;
    var timeAttributeName = meta.timeAttribute;
    var visible = meta.isChecked === true;
    var ogcAttributes = ogcServer ? ogcServer.attributes : null;
    var options = {
      copyable: copyable,
      dimensionsConfig: dimensionsConfig,
      dimensionsFiltersConfig: dimensionsFiltersConfig,
      gmfLayer: gmfLayer,
      id: id,
      identifierAttribute: identifierAttribute,
      name: name,
      ogcType: ogcType,
      ogcAttributes: ogcAttributes,
      snappable: snappable,
      timeAttributeName: timeAttributeName,
      visible: visible,
      wfsOutputFormat: wfsOutputFormat
    };

    if (dimensions) {
      options.dimensions = dimensions;
    }

    if (maxResolution) {
      options.maxResolution = maxResolution;
    }

    if (minResolution) {
      options.minResolution = minResolution;
    }

    if (ogcImageType) {
      options.ogcImageType = ogcImageType;
    }

    if (wmsLayers) {
      options.wmsLayers = wmsLayers;
    }

    if (wfsLayers) {
      options.wfsLayers = wfsLayers;
    }

    if (ogcServerType) {
      options.ogcServerType = ogcServerType;
    }

    if (wfsFeatureNS) {
      options.wfsFeatureNS = wfsFeatureNS;
    }

    if (snappingTolerance) {
      options.snappingTolerance = snappingTolerance;
    }

    if (snappingToEdges) {
      options.snappingToEdges = snappingToEdges;
    }

    if (snappingToVertice) {
      options.snappingToVertice = snappingToVertice;
    }

    if (timeLowerValue) {
      options.timeLowerValue = timeLowerValue;
    }

    if (timeProperty) {
      options.timeProperty = timeProperty;
    }

    if (timeUpperValue) {
      options.timeUpperValue = timeUpperValue;
    }

    if (wfsUrl) {
      options.wfsUrl = wfsUrl;
    }

    if (wmsIsSingleTile) {
      options.wmsIsSingleTile = wmsIsSingleTile;
    }

    if (wmsUrl) {
      options.wmsUrl = wmsUrl;
    }

    if (wmtsLayer) {
      options.wmtsLayer = wmtsLayer;
    }

    if (wmtsUrl) {
      options.wmtsUrl = wmtsUrl;
    }

    this.dataSourcesCache_[id] = new gmf_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"](options);
  };

  _proto.addTreeCtrlToCache_ = function addTreeCtrlToCache_(treeCtrl) {
    var id = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(treeCtrl.node);
    var dataSource = this.dataSourcesCache_[id];

    if (!dataSource) {
      throw new Error('Missing dataSource');
    }

    treeCtrl.setDataSource(dataSource);
    var stateWatcherUnregister = this.rootScope_.$watch(function () {
      return treeCtrl.getState();
    }, this.handleTreeCtrlStateChange_.bind(this, treeCtrl));
    var filterRulesWatcherUnregister = this.rootScope_.$watch(function () {
      var hasFilters = dataSource.filterRules !== null;
      var isVisible = dataSource.visible;
      return hasFilters && isVisible;
    }, this.handleDataSourceFilterRulesChange_.bind(this, dataSource));
    var timeLowerValueWatcherUnregister;
    var timeUpperValueWatcherUnregister;
    var wmsLayer;

    if (dataSource.timeProperty && dataSource.ogcType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_6__["Type"].WMS) {
      timeLowerValueWatcherUnregister = this.rootScope_.$watch(function () {
        return dataSource.timeLowerValue;
      }, this.handleDataSourceTimeValueChange_.bind(this, dataSource));

      if (dataSource.timeProperty.mode === 'range') {
        timeUpperValueWatcherUnregister = this.rootScope_.$watch(function () {
          return dataSource.timeUpperValue;
        }, this.handleDataSourceTimeValueChange_.bind(this, dataSource));
      }

      wmsLayer = Object(gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_3__["getLayer"])(treeCtrl);
    }

    this.treeCtrlCache_[id] = {
      filterRulesWatcherUnregister: filterRulesWatcherUnregister,
      stateWatcherUnregister: stateWatcherUnregister,
      timeLowerValueWatcherUnregister: timeLowerValueWatcherUnregister,
      timeUpperValueWatcherUnregister: timeUpperValueWatcherUnregister,
      treeCtrl: treeCtrl,
      wmsLayer: wmsLayer
    };
    this.dataSources_.push(dataSource);
    this.gmfWFSAliases_.describe(dataSource);
  };

  _proto.removeTreeCtrlCacheItem_ = function removeTreeCtrlCacheItem_(item) {
    var dataSource = item.treeCtrl.getDataSource();

    if (!dataSource) {
      throw new Error('DataSource should be set');
    }

    this.dataSources_.remove(dataSource);
    item.treeCtrl.setDataSource(null);
    item.filterRulesWatcherUnregister();
    item.stateWatcherUnregister();

    if (item.timeLowerValueWatcherUnregister) {
      item.timeLowerValueWatcherUnregister();
    }

    if (item.timeUpperValueWatcherUnregister) {
      item.timeUpperValueWatcherUnregister();
    }

    delete this.treeCtrlCache_[Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(item.treeCtrl.node)];
  };

  _proto.clearTreeCtrlCache_ = function clearTreeCtrlCache_() {
    for (var id in this.treeCtrlCache_) {
      this.removeTreeCtrlCacheItem_(this.treeCtrlCache_[id]);
    }
  };

  _proto.handleTreeCtrlStateChange_ = function handleTreeCtrlStateChange_(treeCtrl, newVal) {
    var treeDataSource = treeCtrl.getDataSource();

    if (!treeDataSource) {
      throw new Error('DataSource should be set');
    }

    var visible = newVal === 'on';
    treeDataSource.visible = visible;
    var layer = this.getDataSourceLayer_(treeDataSource);

    if (layer == undefined) {
      return;
    }

    this.updateLayerFilter_(layer);
  };

  _proto.getTreeCtrlCacheItem_ = function getTreeCtrlCacheItem_(treeCtrl) {
    return this.treeCtrlCache_[Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(treeCtrl.node)] || null;
  };

  _proto.getDataSourceLayer_ = function getDataSourceLayer_(dataSource) {
    if (!(dataSource instanceof gmf_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"]) || dataSource.gmfLayer == undefined) {
      return;
    }

    var id = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(dataSource.gmfLayer);

    if (id == undefined) {
      return;
    }

    var item = this.treeCtrlCache_[id];

    if (item == undefined) {
      return;
    }

    var treeCtrl = item.treeCtrl;
    return Object(gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_3__["getLayer"])(treeCtrl);
  };

  _proto.updateLayerFilter_ = function updateLayerFilter_(layer) {
    var _source$updateParams;

    if (!(layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_16__["default"] || layer instanceof ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_14__["default"])) {
      return;
    }

    var source = layer.getSource();

    if (!(source instanceof ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_17__["default"] || source instanceof ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_18__["default"])) {
      return;
    }

    var params = source.getParams();
    var layersParam = params.LAYERS;
    var layersList = layersParam.split(',');

    if (!layersList.length) {
      throw new Error('Missing layersList');
    }

    var filterParam = 'FILTER';
    var filterParamValues = [];
    var hasFilter = false;

    for (var _iterator7 = layersList, _isArray7 = Array.isArray(_iterator7), _i8 = 0, _iterator7 = _isArray7 ? _iterator7 : _iterator7[Symbol.iterator]();;) {
      var _ref7;

      if (_isArray7) {
        if (_i8 >= _iterator7.length) break;
        _ref7 = _iterator7[_i8++];
      } else {
        _i8 = _iterator7.next();
        if (_i8.done) break;
        _ref7 = _i8.value;
      }

      var wmsLayerName = _ref7;
      var filterParamValue = '()';
      var dataSources = this.dataSources_.getArray();

      for (var _iterator8 = dataSources, _isArray8 = Array.isArray(_iterator8), _i9 = 0, _iterator8 = _isArray8 ? _iterator8 : _iterator8[Symbol.iterator]();;) {
        var _ref8;

        if (_isArray8) {
          if (_i9 >= _iterator8.length) break;
          _ref8 = _iterator8[_i9++];
        } else {
          _i9 = _iterator8.next();
          if (_i9.done) break;
          _ref8 = _i9.value;
        }

        var dataSource = _ref8;
        var dsLayer = this.getDataSourceLayer_(dataSource);

        if (dsLayer == undefined) {
          continue;
        }

        if (!(dataSource instanceof gmf_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"])) {
          throw new Error('Wrong dataSource type');
        }

        var gmfLayerWMS = dataSource.gmfLayer;

        if (Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(dsLayer) == Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(layer) && layer.get('querySourceIds').includes(String(dataSource.id)) && gmfLayerWMS.layers.split(',').includes(wmsLayerName)) {
          var id = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(dataSource.gmfLayer);
          var item = this.treeCtrlCache_[id];

          if (!item) {
            throw new Error('Missing item');
          }

          var treeCtrl = item.treeCtrl;
          var projCode = treeCtrl.map.getView().getProjection().getCode();

          if (!(dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_6__["default"])) {
            throw new Error('Wrong datasource');
          }

          var filterString = dataSource.visible ? this.ngeoRuleHelper_.createFilterString({
            dataSource: dataSource,
            projCode: projCode,
            incDimensions: true
          }) : null;

          if (filterString) {
            filterParamValue = "(" + filterString + ")";
            hasFilter = true;
          }
        }
      }

      filterParamValues.push(filterParamValue);
    }

    source.updateParams((_source$updateParams = {}, _source$updateParams[filterParam] = hasFilter ? filterParamValues.join('') : null, _source$updateParams));
  };

  _proto.handleDataSourceFilterRulesChange_ = function handleDataSourceFilterRulesChange_(dataSource) {
    if (dataSource.filtrable !== true || dataSource.ogcType !== ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_6__["Type"].WMS) {
      return;
    }

    var layer = this.getDataSourceLayer_(dataSource);

    if (layer === undefined) {
      return;
    }

    this.updateLayerFilter_(layer);
  };

  _proto.handleDataSourceTimeValueChange_ = function handleDataSourceTimeValueChange_(dataSource) {
    var id = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_12__["getUid"])(dataSource.gmfLayer);
    var item = this.treeCtrlCache_[id];

    if (!item) {
      throw new Error('Missing item');
    }

    var wmsLayer = item.wmsLayer;
    var wmsSource = wmsLayer.getSource();
    var timeProperty = dataSource.timeProperty;
    var timeParam;
    var range = dataSource.timeRangeValue;

    if (range) {
      if (!timeProperty) {
        throw new Error('Missing timeProperty');
      }

      timeParam = this.ngeoWMSTime_.formatWMSTimeParam(timeProperty, range);
    }

    var params = wmsSource.getParams();
    var currentTimeParam = params.TIME;

    if (currentTimeParam === timeParam) {
      return;
    }

    this.ngeoLayerHelper_.updateWMSLayerState(wmsLayer, wmsSource.getParams().LAYERS, timeParam);
  };

  _proto.handleNgeoBackgroundLayerChange_ = function handleNgeoBackgroundLayerChange_(evt) {
    var event = evt;
    var previousBackgroundLayer = event.detail.previous;
    var currentBackgroundLayer = event.detail.current;
    var cache = this.dataSourcesCache_;

    if (previousBackgroundLayer) {
      var ids = previousBackgroundLayer.get('querySourceIds');

      if (Array.isArray(ids)) {
        for (var _iterator9 = ids, _isArray9 = Array.isArray(_iterator9), _i10 = 0, _iterator9 = _isArray9 ? _iterator9 : _iterator9[Symbol.iterator]();;) {
          var _ref9;

          if (_isArray9) {
            if (_i10 >= _iterator9.length) break;
            _ref9 = _iterator9[_i10++];
          } else {
            _i10 = _iterator9.next();
            if (_i10.done) break;
            _ref9 = _i10.value;
          }

          var id = _ref9;
          var dataSource = cache[id];

          if (dataSource) {
            dataSource.visible = false;
            this.dataSources_.remove(dataSource);
          }
        }
      }
    }

    if (currentBackgroundLayer) {
      var _ids = currentBackgroundLayer.get('querySourceIds');

      if (Array.isArray(_ids)) {
        for (var _iterator10 = _ids, _isArray10 = Array.isArray(_iterator10), _i11 = 0, _iterator10 = _isArray10 ? _iterator10 : _iterator10[Symbol.iterator]();;) {
          var _ref10;

          if (_isArray10) {
            if (_i11 >= _iterator10.length) break;
            _ref10 = _iterator10[_i11++];
          } else {
            _i11 = _iterator10.next();
            if (_i11.done) break;
            _ref10 = _i11.value;
          }

          var _id = _ref10;
          var _dataSource = cache[_id];

          if (_dataSource) {
            _dataSource.visible = true;
            this.dataSources_.push(_dataSource);
          }
        }
      }
    }
  };

  return DatasourceManager;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDataSourcesManager', [gmf_datasource_WFSAliases_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, ngeo_map_BackgroundLayerMgr_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_10__["default"].name, ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_11__["default"].name]);
module.service('gmfDataSourcesManager', DatasourceManager);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/datasource/OGC.js":
/*!********************************************!*\
  !*** ./contribs/gmf/src/datasource/OGC.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }



var GmfDatasourceOGC = function (_ngeoDatasourceOGC) {
  _inheritsLoose(GmfDatasourceOGC, _ngeoDatasourceOGC);

  function GmfDatasourceOGC(options) {
    var _this;

    _this = _ngeoDatasourceOGC.call(this, options) || this;
    _this.gmfLayer_ = options.gmfLayer;
    return _this;
  }

  _createClass(GmfDatasourceOGC, [{
    key: "gmfLayer",
    get: function get() {
      return this.gmfLayer_;
    }
  }]);

  return GmfDatasourceOGC;
}(ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_0__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (GmfDatasourceOGC);

/***/ }),

/***/ "./contribs/gmf/src/datasource/WFSAliases.js":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/datasource/WFSAliases.js ***!
  \***************************************************/
/*! exports provided: DatasourceWFSAlias, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DatasourceWFSAlias", function() { return DatasourceWFSAlias; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/datasource/Helper.js */ "./src/datasource/Helper.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");



var DatasourceWFSAlias = function () {
  DatasourceWFSAlias.$inject = ["ngeoDataSourcesHelper"];

  function DatasourceWFSAlias(ngeoDataSourcesHelper) {
    this.ngeoDataSourcesHelper_ = ngeoDataSourcesHelper;
  }

  var _proto = DatasourceWFSAlias.prototype;

  _proto.describe = function describe(dataSource) {
    if (dataSource.ogcServerType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_2__["ServerType"].QGISSERVER && dataSource.wfsUrl_ && dataSource.getWFSLayerNames().length == 1 && !dataSource.attributes) {
      this.ngeoDataSourcesHelper_.getDataSourceAttributes(dataSource);
    }
  };

  return DatasourceWFSAlias;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDatasourceWFSAliases', [ngeo_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.service('gmfWFSAliases', DatasourceWFSAlias);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/datasource/module.js":
/*!***********************************************!*\
  !*** ./contribs/gmf/src/datasource/module.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_datasource_DataSourceBeingFiltered_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/datasource/DataSourceBeingFiltered.js */ "./contribs/gmf/src/datasource/DataSourceBeingFiltered.js");
/* harmony import */ var gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/datasource/ExternalDataSourcesManager.js */ "./contribs/gmf/src/datasource/ExternalDataSourcesManager.js");
/* harmony import */ var gmf_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/datasource/Helper.js */ "./contribs/gmf/src/datasource/Helper.js");
/* harmony import */ var gmf_datasource_Manager_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/datasource/Manager.js */ "./contribs/gmf/src/datasource/Manager.js");
/* harmony import */ var gmf_datasource_WFSAliases_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/datasource/WFSAliases.js */ "./contribs/gmf/src/datasource/WFSAliases.js");






/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDatasourceModule', [gmf_datasource_DataSourceBeingFiltered_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, gmf_datasource_Manager_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, gmf_datasource_WFSAliases_js__WEBPACK_IMPORTED_MODULE_5__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/disclaimer/component.js":
/*!**************************************************!*\
  !*** ./contribs/gmf/src/disclaimer/component.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_layer_Base_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/layer/Base.js */ "./node_modules/ol/layer/Base.js");
/* harmony import */ var ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/layer/Group.js */ "./node_modules/ol/layer/Group.js");
/* harmony import */ var gmf_index_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/index.js */ "./contribs/gmf/src/index.js");
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
/* harmony import */ var ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/message/Message.js */ "./src/message/Message.js");
/* harmony import */ var ngeo_message_Disclaimer_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/message/Disclaimer.js */ "./src/message/Disclaimer.js");
/* harmony import */ var ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/misc/EventHelper.js */ "./src/misc/EventHelper.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var angular_sanitize__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! angular-sanitize */ "./node_modules/angular-sanitize/index.js");
/* harmony import */ var angular_sanitize__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(angular_sanitize__WEBPACK_IMPORTED_MODULE_11__);
DisclaimerController.$inject = ["$element", "$sce", "$timeout", "gettextCatalog", "ngeoDisclaimer", "ngeoEventHelper", "ngeoLayerHelper"];












var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDisclaimer', ['ngSanitize', ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, ngeo_message_Disclaimer_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_9__["default"].name]);

function DisclaimerController($element, $sce, $timeout, gettextCatalog, ngeoDisclaimer, ngeoEventHelper, ngeoLayerHelper) {
  this.map = null;
  this.layerVisibility;
  this.external;
  this.popup;
  this.visibility = false;
  this.msg;
  this.msgs_ = [];
  this.sce_ = $sce;
  this.timeout_ = $timeout;
  this.gettextCatalog_ = gettextCatalog;
  this.element_ = $element;
  this.disclaimer_ = ngeoDisclaimer;
  this.eventHelper_ = ngeoEventHelper;
  this.ngeoLayerHelper_ = ngeoLayerHelper;
  this.dataLayerGroup_ = null;
}

DisclaimerController.prototype.$onInit = function () {
  if (!this.map) {
    throw new Error('Missing map');
  }

  this.layerVisibility = this.layerVisibility !== undefined ? this.layerVisibility : true;
  this.dataLayerGroup_ = this.ngeoLayerHelper_.getGroupFromMap(this.map, gmf_index_js__WEBPACK_IMPORTED_MODULE_5__["DATALAYERGROUP_NAME"]);
  this.registerLayer_(this.dataLayerGroup_);
};

DisclaimerController.prototype.handleLayersAdd_ = function (evt) {
  var _this = this;

  if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_10__["CollectionEvent"]) {
    this.timeout_(function () {
      var layer = evt.element;

      if (!(layer instanceof ol_layer_Base_js__WEBPACK_IMPORTED_MODULE_3__["default"])) {
        throw new Error('Wrong layer type');
      }

      _this.registerLayer_(layer);
    });
  }
};

DisclaimerController.prototype.handleLayersRemove_ = function (evt) {
  if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_10__["CollectionEvent"]) {
    var layer = evt.element;

    if (!(layer instanceof ol_layer_Base_js__WEBPACK_IMPORTED_MODULE_3__["default"])) {
      throw new Error('Wrong layer type');
    }

    this.unregisterLayer_(layer);
  }
};

DisclaimerController.prototype.registerLayer_ = function (layer) {
  var _this2 = this;

  var layerUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(layer);

  if (layer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_4__["default"]) {
    this.eventHelper_.addListenerKey(layerUid, Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(layer.getLayers(), 'add', this.handleLayersAdd_, this));
    this.eventHelper_.addListenerKey(layerUid, Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(layer.getLayers(), 'remove', this.handleLayersRemove_, this));
    layer.getLayers().forEach(function (layer) {
      _this2.registerLayer_(layer);
    });
  } else {
    if (this.layerVisibility) {
      if (layer.getVisible()) {
        this.update_(layer);
      } else {
        this.closeAll_(layer);
      }

      var listenerKey = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(layer, 'change', function (event) {
        if (layer.getVisible()) {
          _this2.update_(layer);
        } else {
          _this2.closeAll_(layer);
        }
      });
      this.eventHelper_.addListenerKey(layerUid, listenerKey);
    } else {
      this.showAll_(layer);
    }
  }
};

DisclaimerController.prototype.unregisterLayer_ = function (layer) {
  var _this3 = this;

  var layerUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(layer);

  if (layer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_4__["default"]) {
    this.eventHelper_.clearListenerKey(layerUid);
    layer.getLayers().forEach(function (layer) {
      return _this3.unregisterLayer_(layer);
    });
  } else {
    this.closeAll_(layer);
  }
};

DisclaimerController.prototype.$onDestroy = function () {
  if (!this.dataLayerGroup_) {
    throw new Error('Missing dataLayerGroup');
  }

  this.unregisterLayer_(this.dataLayerGroup_);
};

DisclaimerController.prototype.showDisclaimerMessage_ = function (layerUid, msg) {
  msg = this.gettextCatalog_.getString(msg);

  if (this.external) {
    if (!this.msgs_.includes(msg)) {
      this.msgs_.push(msg);
    }

    this.msg = "" + this.sce_.trustAsHtml(this.msgs_.join('<br />'));
    this.visibility = true;
  } else {
    var options = {
      msg: msg,
      layerUid: layerUid,
      target: this.element_,
      type: ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_7__["MessageType"].WARNING
    };

    if (this.popup) {
      options.popup = this.popup;
    }

    this.disclaimer_.alert(options);
  }
};

DisclaimerController.prototype.closeAll_ = function (layer) {
  var disclaimers = layer.get('disclaimers');

  if (disclaimers) {
    var layerUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(layer);

    for (var key in disclaimers) {
      var uid = layerUid + "-" + key;
      this.closeDisclaimerMessage_(uid, disclaimers[key]);
    }
  }
};

DisclaimerController.prototype.showAll_ = function (layer) {
  var disclaimers = layer.get('disclaimers');

  if (disclaimers) {
    var layerUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(layer);

    for (var key in disclaimers) {
      var uid = layerUid + "-" + key;
      this.showDisclaimerMessage_(uid, disclaimers[key]);
    }
  }
};

DisclaimerController.prototype.update_ = function (layer) {
  var disclaimers = layer.get('disclaimers');

  if (disclaimers) {
    if ('all' in disclaimers) {
      console.assert(Object.keys(disclaimers).length === 1);
      this.showAll_(layer);
    } else {
      var layerWMS = layer;
      var sourceWMS = layerWMS.getSource();

      if (sourceWMS.getParams) {
        var layers = sourceWMS.getParams()['LAYERS'];
        var layerUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(layer);

        for (var key in disclaimers) {
          var uid = layerUid + "-" + key;

          if (layers.indexOf(key) !== -1) {
            this.showDisclaimerMessage_(uid, disclaimers[key]);
          } else {
            this.closeDisclaimerMessage_(uid, disclaimers[key]);
          }
        }
      }
    }
  }
};

DisclaimerController.prototype.closeDisclaimerMessage_ = function (layerUid, msg) {
  msg = this.gettextCatalog_.getString(msg);

  if (this.external) {
    this.visibility = false;
    this.msgs_.length = 0;
    this.msg = '';
  } else {
    var options = {
      msg: msg,
      layerUid: layerUid,
      target: this.element_,
      type: ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_7__["MessageType"].WARNING
    };

    if (this.popup) {
      options.popup = this.popup;
    }

    this.disclaimer_.close(options);
  }
};

var disclaimerComponent = {
  controller: DisclaimerController,
  bindings: {
    'layerVisibility': '<?gmfDisclaimerLayerVisibility',
    'popup': '<?gmfDisclaimerPopup',
    'map': '=gmfDisclaimerMap',
    'external': '<?gmfDisclaimerExternal',
    'visibility': '=?gmfDisclaimerExternalVisibility',
    'msg': '=?gmfDisclaimerExternalMsg'
  }
};
module.component('gmfDisclaimer', disclaimerComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/drawing/drawFeatureComponent.html":
/*!************************************************************!*\
  !*** ./contribs/gmf/src/drawing/drawFeatureComponent.html ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<ngeo-drawfeature\n    ngeo-btn-group\n    class="btn-group"\n    ngeo-drawfeature-active="efCtrl.drawActive"\n    ngeo-drawfeature-map="efCtrl.map"\n    ngeo-drawfeature-showmeasure="efCtrl.showMeasure">\n  <a\n    data-toggle="tooltip"\n    title="{{\'Draw a point on the map\' | translate}}"\n    href\n    ngeo-btn\n    ngeo-drawpoint\n    class="btn btn-default ngeo-drawfeature-point"\n    ng-class="{active: dfCtrl.drawPoint.active}"\n    ng-model="dfCtrl.drawPoint.active">\n    ' +
((__t = (__webpack_require__(/*! gmf/icons/point.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/point.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </a>\n  <a\n    data-toggle="tooltip"\n    title="{{\'Draw a line on the map\' | translate}}"\n    href\n    ngeo-btn\n    ngeo-measurelength\n    class="btn btn-default ngeo-drawfeature-linestring"\n    ng-class="{active: dfCtrl.measureLength.active}"\n    ng-model="dfCtrl.measureLength.active">\n    ' +
((__t = (__webpack_require__(/*! gmf/icons/line.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/line.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </a>\n  <a\n    data-toggle="tooltip"\n    title="{{\'Draw a polygon on the map\' | translate}}"\n    href\n    ngeo-btn\n    ngeo-measurearea\n    class="btn btn-default ngeo-drawfeature-polygon"\n    ng-class="{active: dfCtrl.measureArea.active}"\n    ng-model="dfCtrl.measureArea.active">\n    ' +
((__t = (__webpack_require__(/*! gmf/icons/polygon.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/polygon.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </a>\n  <a\n    data-toggle="tooltip"\n    title="{{\'Draw a circle on the map\' | translate}}"\n    href\n    ngeo-btn\n    ngeo-measureazimut\n    class="btn btn-default ngeo-drawfeature-circle"\n    ng-class="{active: dfCtrl.measureAzimut.active}"\n    ng-model="dfCtrl.measureAzimut.active">\n    ' +
((__t = (__webpack_require__(/*! gmf/icons/circle.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/circle.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </a>\n  <a\n    data-toggle="tooltip"\n    title="{{\'Draw a rectangle on the map\' | translate}}"\n    href\n    ngeo-btn\n    ngeo-drawrectangle\n    class="btn btn-default ngeo-drawfeature-rectangle"\n    ng-class="{active: dfCtrl.drawRectangle.active}"\n    ng-model="dfCtrl.drawRectangle.active">\n    ' +
((__t = (__webpack_require__(/*! gmf/icons/rectangle.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/rectangle.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </a>\n  <a\n    data-toggle="tooltip"\n    title="{{\'Draw a text label on the map\' | translate}}"\n    href\n    ngeo-btn\n    ngeo-drawtext\n    class="btn btn-default ngeo-drawfeature-text"\n    ng-class="{active: dfCtrl.drawText.active}"\n    ng-model="dfCtrl.drawText.active">\n    ' +
((__t = (__webpack_require__(/*! gmf/icons/text.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/text.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </a>\n</ngeo-drawfeature>\n\n<div ng-switch="efCtrl.selectedFeature">\n\n  <hr class="gmf-drawfeature-separator" ng-show="efCtrl.getFeaturesArray().length > 0">\n  <div ng-switch-when="null">\n    <div ng-show="efCtrl.getFeaturesArray().length > 0">\n      <div class="ngeo-drawfeature-actionbuttons">\n        <button\n            type="button"\n            data-toggle="dropdown"\n            aria-haspopup="true"\n            aria-expanded="false"\n            ngeo-exportfeatures\n            ngeo-exportfeatures-features="efCtrl.features"\n            class="btn btn-link btn-sm dropdown-toggle">\n          <span class="fa fa-file-export"></span>\n          {{\'Export\' | translate}}\n        </button>\n        <button\n            ng-click="efCtrl.clearFeatures()"\n            class="btn btn-link btn-sm">\n          <span class="fa fa-trash"></span>\n          {{\'Delete All\' | translate}}\n        </button>\n      </div>\n\n      <div class="gmf-eol"></div>\n\n      <div class="gmf-drawfeature-featurelist list-group list-group-sm">\n        <button\n            role="button"\n            class="list-group-item"\n            ng-repeat="feature in efCtrl.getFeaturesArray()"\n            ng-click="efCtrl.selectFeatureFromList(feature);">\n          {{ feature.get(efCtrl.nameProperty) }}\n        </button>\n      </div>\n    </div>\n\n  </div>\n\n  <div ng-switch-default>\n\n    <button\n        ng-click="efCtrl.selectedFeature = null;"\n        class="btn btn-link btn-sm">\n      <span class="fa fa-arrow-left"></span>\n      {{\'List\' | translate}}\n    </button>\n    <div class="ngeo-drawfeature-actionbuttons">\n      <button\n          type="button"\n          data-toggle="dropdown"\n          aria-haspopup="true"\n          aria-expanded="false"\n          ngeo-exportfeatures\n          ngeo-exportfeatures-features="efCtrl.selectedFeatures"\n          class="btn btn-link btn-sm dropdown-toggle">\n        <span class="fa fa-file-export"></span>\n        {{\'Export\' | translate}}\n      </button>\n      <button\n          ng-click="efCtrl.removeFeature(efCtrl.selectedFeature);"\n          class="btn btn-link btn-sm">\n        <span class="fa fa-trash"></span>\n        {{\'Delete\' | translate}}\n      </button>\n    </div>\n\n    <div class="gmf-eol"></div>\n\n    <gmf-featurestyle\n      gmf-featurestyle-feature="efCtrl.selectedFeature">\n    </gmf-featurestyle>\n  </div>\n\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/drawing/drawFeatureComponent.js":
/*!**********************************************************!*\
  !*** ./contribs/gmf/src/drawing/drawFeatureComponent.js ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_drawing_featureStyleComponent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/drawing/featureStyleComponent.js */ "./contribs/gmf/src/drawing/featureStyleComponent.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_Menu_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/Menu.js */ "./src/Menu.js");
/* harmony import */ var ngeo_editing_exportfeaturesComponent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/editing/exportfeaturesComponent.js */ "./src/editing/exportfeaturesComponent.js");
/* harmony import */ var ngeo_misc_btnComponent_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/misc/btnComponent.js */ "./src/misc/btnComponent.js");
/* harmony import */ var ngeo_draw_component_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/draw/component.js */ "./src/draw/component.js");
/* harmony import */ var ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/format/FeatureProperties.js */ "./src/format/FeatureProperties.js");
/* harmony import */ var ngeo_interaction_Modify_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/interaction/Modify.js */ "./src/interaction/Modify.js");
/* harmony import */ var ngeo_interaction_Rotate_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/interaction/Rotate.js */ "./src/interaction/Rotate.js");
/* harmony import */ var ngeo_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/interaction/Translate.js */ "./src/interaction/Translate.js");
/* harmony import */ var ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/misc/decorate.js */ "./src/misc/decorate.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ngeo/misc/ToolActivate.js */ "./src/misc/ToolActivate.js");
/* harmony import */ var ngeo_misc_ToolActivateMgr_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ngeo/misc/ToolActivateMgr.js */ "./src/misc/ToolActivateMgr.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_style_Text_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ol/style/Text.js */ "./node_modules/ol/style/Text.js");
/* harmony import */ var ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ol/MapBrowserEvent.js */ "./node_modules/ol/MapBrowserEvent.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");
Controller.$inject = ["$scope", "$timeout", "gettextCatalog", "ngeoFeatureHelper", "ngeoFeatures", "ngeoToolActivateMgr"];

























var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('GmfDrawFeatureComponent', [gmf_drawing_featureStyleComponent_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_editing_exportfeaturesComponent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_misc_btnComponent_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_draw_component_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_12__["default"].name, ngeo_misc_ToolActivateMgr_js__WEBPACK_IMPORTED_MODULE_14__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/drawing/drawFeatureComponent', __webpack_require__(/*! ./drawFeatureComponent.html */ "./contribs/gmf/src/drawing/drawFeatureComponent.html"));
}]);

function drawinfDrawFeatureComponent() {
  return {
    controller: 'GmfDrawfeatureController as efCtrl',
    scope: {
      'active': '=gmfDrawfeatureActive',
      'map': '<gmfDrawfeatureMap',
      'showMeasure': '=?gmfDrawfeatureShowmeasure'
    },
    bindToController: true,
    templateUrl: 'gmf/drawing/drawFeatureComponent'
  };
}

module.directive('gmfDrawfeature', drawinfDrawFeatureComponent);

function Controller($scope, $timeout, gettextCatalog, ngeoFeatureHelper, ngeoFeatures, ngeoToolActivateMgr) {
  var _this = this;

  this.map = null;
  this.active = false;
  this.drawActive = false;
  this.drawToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this, 'drawActive');
  this.mapSelectActive = true;
  this.longPressTimeout_ = null;
  this.mapSelectToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this, 'mapSelectActive');
  this.scope_ = $scope;
  this.timeout_ = $timeout;
  this.featureHelper_ = ngeoFeatureHelper;
  this.features = ngeoFeatures;
  this.ngeoToolActivateMgr_ = ngeoToolActivateMgr;
  this.selectedFeature = null;
  this.selectedFeatures = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_17__["default"]();
  this.interactions_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_17__["default"]();
  this.modify_ = new ngeo_interaction_Modify_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
    features: this.selectedFeatures,
    style: ngeoFeatureHelper.getVertexStyle(false)
  });
  this.interactions_.push(this.modify_);
  this.menu_ = null;
  this.menuListenerKey_ = null;
  this.modifyToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this.modify_, 'active');
  this.translate_ = new ngeo_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
    features: this.selectedFeatures,
    style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_19__["default"]({
      text: new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
        text: "\uF0B2",
        font: '900 18px "Font Awesome 5 Free"',
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_18__["default"]({
          color: '#7a7a7a'
        })
      })
    })
  });
  this.interactions_.push(this.translate_);
  this.rotate_ = new ngeo_interaction_Rotate_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
    features: this.selectedFeatures,
    style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_19__["default"]({
      text: new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
        text: "\uF01E",
        font: '900 18px "Font Awesome 5 Free"',
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_18__["default"]({
          color: '#7a7a7a'
        })
      })
    })
  });
  this.interactions_.push(this.rotate_);
  this.initializeInteractions_();
  this.rotateToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this.rotate_, 'active');
  this.translateToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this.translate_, 'active');
  this.listenerKeys_ = [];
  this.mapListenerKeys_ = [];
  this.listSelectionInProgress_ = false;
  $scope.$watch(function () {
    return _this.active;
  }, this.handleActiveChange_.bind(this));
  $scope.$watch(function () {
    return _this.drawActive;
  }, function (active) {
    if (active) {
      _this.selectedFeature = null;
    }
  });
  $scope.$watch(function () {
    return _this.selectedFeature;
  }, function (newFeature, previousFeature) {
    if (!_this.map) {
      throw new Error('Missing map');
    }

    _this.selectedFeatures.clear();

    if (previousFeature) {
      _this.featureHelper_.setStyle(previousFeature);

      _this.unregisterInteractions_();
    }

    if (newFeature) {
      _this.featureHelper_.setStyle(newFeature, true);

      _this.selectedFeatures.push(newFeature);

      _this.registerInteractions_();

      if (_this.listSelectionInProgress_) {
        _this.featureHelper_.fitMapToFeature(newFeature, _this.map);

        _this.listSelectionInProgress_ = false;
      }
    } else {
      _this.closeMenu_();
    }
  });
  $scope.$watch(function () {
    return _this.mapSelectActive;
  }, this.handleMapSelectActiveChange_.bind(this));
  this.nameProperty = ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_7__["default"].NAME;
  this.gettextCatalog_ = gettextCatalog;
}

Controller.prototype.closeMenu_ = function () {
  if (this.menu_) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    if (!this.menuListenerKey_) {
      throw new Error('Missing menuListenerKey');
    }

    this.map.removeOverlay(this.menu_);
    this.menu_ = null;
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["unlistenByKey"])(this.menuListenerKey_);
  }
};

Controller.prototype.initializeInteractions_ = function () {
  this.interactions_.forEach(function (interaction) {
    interaction.setActive(false);
    Object(ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_11__["interactionDecoration"])(interaction);
  });
};

Controller.prototype.registerInteractions_ = function () {
  var _this2 = this;

  this.interactions_.forEach(function (interaction) {
    if (!_this2.map) {
      throw new Error('Missing map');
    }

    _this2.map.addInteraction(interaction);
  });
};

Controller.prototype.unregisterInteractions_ = function () {
  var _this3 = this;

  this.interactions_.forEach(function (interaction) {
    if (!_this3.map) {
      throw new Error('Missing map');
    }

    _this3.map.removeInteraction(interaction);
  });
};

Controller.prototype.handleActiveChange_ = function (active) {
  var keys = this.listenerKeys_;
  var drawUid = ['draw-', Object(ol_util_js__WEBPACK_IMPORTED_MODULE_15__["getUid"])(this)].join('-');
  var otherUid = ['other-', Object(ol_util_js__WEBPACK_IMPORTED_MODULE_15__["getUid"])(this)].join('-');
  var toolMgr = this.ngeoToolActivateMgr_;

  if (active) {
    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(this.features, 'add', this.handleFeaturesAdd_, this));
    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(this.features, 'remove', this.handleFeaturesRemove_, this));
    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(this.translate_, 'translateend', this.handleTranslateEnd_, this));
    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(this.rotate_, 'rotateend', this.handleRotateEnd_, this));
    toolMgr.registerTool(drawUid, this.drawToolActivate, false);
    toolMgr.registerTool(drawUid, this.mapSelectToolActivate, true);
    toolMgr.registerTool(otherUid, this.drawToolActivate, false);
    toolMgr.registerTool(otherUid, this.modifyToolActivate, true);
    toolMgr.registerTool(otherUid, this.translateToolActivate, false);
    toolMgr.registerTool(otherUid, this.rotateToolActivate, false);
    this.mapSelectActive = true;
    this.modify_.setActive(true);
  } else {
    keys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["unlistenByKey"]);
    keys.length = 0;
    toolMgr.unregisterTool(drawUid, this.drawToolActivate);
    toolMgr.unregisterTool(drawUid, this.mapSelectToolActivate);
    toolMgr.unregisterTool(otherUid, this.drawToolActivate);
    toolMgr.unregisterTool(otherUid, this.modifyToolActivate);
    toolMgr.unregisterTool(otherUid, this.translateToolActivate);
    toolMgr.unregisterTool(otherUid, this.rotateToolActivate);
    this.drawActive = false;
    this.modify_.setActive(false);
    this.mapSelectActive = false;
    this.selectedFeature = null;
    this.closeMenu_();
  }
};

Controller.prototype.selectFeatureFromList = function (feature) {
  this.listSelectionInProgress_ = true;
  this.selectedFeature = feature;
  this.drawActive = false;
};

Controller.prototype.getFeaturesArray = function () {
  return this.features.getArray();
};

Controller.prototype.clearFeatures = function () {
  var gettextCatalog = this.gettextCatalog_;
  var msg = gettextCatalog.getString('Do you really want to delete all the features?');

  if (confirm(msg)) {
    this.features.clear();
  }
};

Controller.prototype.removeFeature = function (feature) {
  var gettextCatalog = this.gettextCatalog_;
  var msg = gettextCatalog.getString('Do you really want to delete the selected feature?');

  if (confirm(msg)) {
    this.features.remove(feature);
  }
};

Controller.prototype.handleFeaturesAdd_ = function (evt) {
  var _this4 = this;

  if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_17__["CollectionEvent"]) {
    this.timeout_(function () {
      _this4.selectedFeature = evt.element;
      _this4.drawActive = false;

      _this4.scope_.$apply();
    });
  }
};

Controller.prototype.handleFeaturesRemove_ = function (evt) {
  this.selectedFeature = null;
};

Controller.prototype.handleMapSelectActiveChange_ = function (active) {
  if (!this.map) {
    throw new Error('Missing map');
  }

  var mapDiv = this.map.getViewport();

  if (!mapDiv) {
    throw new Error('Missing mapDiv');
  }

  if (active) {
    this.mapListenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(this.map, 'click', this.handleMapClick_, this));
    this.mapListenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(mapDiv, 'contextmenu', this.handleMapContextMenu_, this));
    this.mapListenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(mapDiv, 'touchstart', this.handleMapTouchStart_, this));
    this.mapListenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(mapDiv, 'touchmove', this.handleMapTouchEnd_, this));
    this.mapListenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(mapDiv, 'touchend', this.handleMapTouchEnd_, this));
  } else {
    this.mapListenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["unlistenByKey"]);
  }
};

Controller.prototype.handleMapClick_ = function (evt) {
  var _this5 = this;

  if (evt instanceof ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_21__["default"]) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    var pixel = evt.pixel;
    var feature = this.map.forEachFeatureAtPixel(pixel, function (feature) {
      var ret = null;

      if (feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_22__["default"]) {
        if (_this5.features.getArray().includes(feature)) {
          ret = feature;
        }
      }

      return ret;
    }, {
      hitTolerance: 5,
      layerFilter: undefined
    });
    feature = feature ? feature : null;

    if (feature === this.selectedFeature) {
      return;
    }

    this.selectedFeature = feature;
    this.scope_.$apply();
  }
};

Controller.prototype.handleMapTouchStart_ = function (evt) {
  var _this6 = this;

  this.longPressTimeout_ = window.setTimeout(function () {
    _this6.handleMapContextMenu_(evt);
  }, 500);
};

Controller.prototype.handleMapTouchEnd_ = function (evt) {
  if (!this.longPressTimeout_) {
    throw new Error('Missing longPressTimeout');
  }

  clearTimeout(this.longPressTimeout_);
};

Controller.prototype.handleMapContextMenu_ = function (evt) {
  var _this7 = this;

  if (evt instanceof Event) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    var gettextCatalog = this.gettextCatalog_;
    var pixel = this.map.getEventPixel(evt);
    var coordinate = this.map.getCoordinateFromPixel(pixel);
    var feature = this.map.forEachFeatureAtPixel(pixel, function (feature) {
      if (feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_22__["default"]) {
        var ret = null;

        if (_this7.features.getArray().includes(feature)) {
          ret = feature;
        }

        return ret;
      }
    }, {
      hitTolerance: 7,
      layerFilter: undefined
    });
    feature = feature ? feature : null;

    if (feature) {
      this.closeMenu_();
      var actions = [];
      var resolution = this.map.getView().getResolution();

      if (resolution === undefined) {
        throw new Error('Missing resolution');
      }

      var vertexInfo = this.featureHelper_.getVertexInfoAtCoordinate(feature, coordinate, resolution);

      if (!vertexInfo) {
        var type = this.featureHelper_.getType(feature);

        if (type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].CIRCLE || type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].LINE_STRING || type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].POLYGON || type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].RECTANGLE) {
          actions = actions.concat([{
            cls: 'fas fa-arrows-alt',
            label: gettextCatalog.getString('Move'),
            name: 'move'
          }, {
            cls: 'fas fa-undo fa-flip-horizontal',
            label: gettextCatalog.getString('Rotate'),
            name: 'rotate'
          }]);
        }
      }

      actions = actions.concat([{
        cls: 'fa fa-trash',
        label: vertexInfo ? gettextCatalog.getString('Delete vertex') : gettextCatalog.getString('Delete'),
        name: 'delete'
      }]);
      this.menu_ = new ngeo_Menu_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
        actions: actions
      });
      this.menuListenerKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_16__["listen"])(this.menu_, 'actionclick', this.handleMenuActionClick_.bind(this, vertexInfo), this);
      this.map.addOverlay(this.menu_);
      this.menu_.open(coordinate);
      evt.preventDefault();
      evt.stopPropagation();
    }

    if (feature === this.selectedFeature) {
      return;
    }

    this.modify_.setActive(true);
    this.selectedFeature = feature;
    this.scope_.$apply();
  }
};

Controller.prototype.handleMenuActionClick_ = function (vertexInfo, evt) {
  var action = evt.detail.action;

  if (!this.selectedFeature) {
    throw new Error('Missing selectedFeature');
  }

  switch (action) {
    case 'delete':
      if (!this.selectedFeature) {
        throw new Error('Missing selectedFeature');
      }

      if (vertexInfo) {
        this.featureHelper_.removeVertex(this.selectedFeature, vertexInfo);
      } else {
        this.removeFeature(this.selectedFeature);
      }

      this.scope_.$apply();
      break;

    case 'move':
      this.translate_.setActive(true);
      this.scope_.$apply();
      break;

    case 'rotate':
      this.rotate_.setActive(true);
      this.scope_.$apply();
      break;

    default:
      console.log("FIXME - support: " + action);
      break;
  }
};

Controller.prototype.handleTranslateEnd_ = function (evt) {
  this.translate_.setActive(false);
  this.scope_.$apply();
};

Controller.prototype.handleRotateEnd_ = function (evt) {
  this.rotate_.setActive(false);
  this.scope_.$apply();
};

module.controller('GmfDrawfeatureController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/drawing/featureStyleComponent.html":
/*!*************************************************************!*\
  !*** ./contribs/gmf/src/drawing/featureStyleComponent.html ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div ng-if="fsCtrl.feature && fsCtrl.type">\n  <div class="form-group">\n    <input\n        ng-model="fsCtrl.getSetName"\n        ng-model-options="{getterSetter: true}"\n        ng-attr-placeholder="{{\'Name\' | translate}}"\n        class="form-control"/>\n  </div>\n  <div\n      ng-if="fsCtrl.type !== \'Text\'"\n      class="form-group">\n        <input\n          id="gmf-featurestyle-showlabel-{{::fsCtrl.uid}}"\n          type="checkbox"\n          ng-model="fsCtrl.getSetShowLabel"\n          ng-model-options="{getterSetter: true}"/>\n        <label\n          ng-switch="fsCtrl.type"\n          for="gmf-featurestyle-showlabel-{{::fsCtrl.uid}}"\n          class="col-form-label">\n          {{\'Display label\' | translate}}\n        </label>\n  </div>\n  <div\n      ng-if="fsCtrl.type !== \'Text\'"\n      class="form-group">\n      <input\n          id="gmf-featurestyle-showmeasure-{{::fsCtrl.uid}}"\n          type="checkbox"\n          ng-model="fsCtrl.getSetShowMeasure"\n          ng-model-options="{getterSetter: true}"/>\n      <label\n          ng-switch="fsCtrl.type"\n          for="gmf-featurestyle-showmeasure-{{::fsCtrl.uid}}"\n          class="col-form-label">\n        <span ng-switch-when="Circle">\n          {{\'Display azimuth and radius\' | translate}}\n        </span>\n        <span ng-switch-when="Polygon">\n          {{\'Display surface\' | translate}}\n        </span>\n        <span ng-switch-when="Rectangle">\n          {{\'Display surface\' | translate}}\n        </span>\n        <span ng-switch-when="LineString">\n          {{\'Display length\' | translate}}\n        </span>\n        <span ng-switch-when="Point">\n          {{\'Display coordinates\' | translate}}\n        </span>\n      </label>\n      <em class="text-muted">\n        ({{ fsCtrl.measure }})\n      </em>\n  </div>\n</div>\n<div ng-if="fsCtrl.feature && fsCtrl.type">\n\n  <div class="form-group">\n    <div\n        ngeo-colorpicker=""\n        ngeo-colorpicker-color="fsCtrl.color"\n        class="col-md-12">\n    </div>\n  </div>\n\n  <div\n      ng-if="fsCtrl.type === \'Point\'"\n      class="form-group form-group-nomargin">\n    <label class="col-form-label col-md-4">{{\'Size\' | translate}}</label>\n    <div class="col-md-8">\n      <input\n          type="range"\n          class="form-control"\n          min="3"\n          max="20"\n          step="1"\n          ng-model="fsCtrl.getSetSize"\n          ng-model-options="{getterSetter: true}"\n          />\n    </div>\n  </div>\n\n  <div\n      ng-if="fsCtrl.type === \'Text\'"\n      class="form-group form-group-nomargin">\n    <label class="col-form-label col-md-4">{{\'Size\' | translate}}</label>\n    <div class="col-md-8">\n      <input\n          type="range"\n          class="form-control"\n          min="8"\n          max="30"\n          step="1"\n          ng-model="fsCtrl.getSetSize"\n          ng-model-options="{getterSetter: true}"\n          />\n    </div>\n  </div>\n\n  <div\n      ng-if="fsCtrl.type === \'Circle\' || fsCtrl.type === \'LineString\' || fsCtrl.type === \'Polygon\' || fsCtrl.type === \'Rectangle\'"\n      class="form-group form-group-nomargin">\n    <label class="col-form-label col-md-4">{{\'Stroke\' | translate}}</label>\n    <div class="col-md-8">\n      <input\n          type="range"\n          class="form-control"\n          min="0.5"\n          max="5"\n          step="0.5"\n          ng-model="fsCtrl.getSetStroke"\n          ng-model-options="{getterSetter: true}"\n          />\n    </div>\n  </div>\n\n  <div\n      ng-if="fsCtrl.type === \'Circle\' || fsCtrl.type === \'Polygon\' || fsCtrl.type === \'Rectangle\'"\n      class="form-group form-group-nomargin">\n    <label class="col-form-label col-md-4">{{\'Opacity\' | translate}}</label>\n    <div class="col-md-8">\n      <input\n          type="range"\n          class="form-control"\n          min="0"\n          max="1"\n          step="0.05"\n          ng-model="fsCtrl.getSetOpacity"\n          ng-model-options="{getterSetter: true}"\n          />\n    </div>\n  </div>\n\n  <div\n      ng-if="fsCtrl.type === \'Text\'"\n      class="form-group form-group-nomargin">\n    <label class="col-form-label col-md-4">{{\'Angle\' | translate}}</label>\n    <div class="col-md-8">\n      <input\n          type="range"\n          class="form-control"\n          min="-180"\n          max="180"\n          step="22.5"\n          ng-model="fsCtrl.getSetAngle"\n          ng-model-options="{getterSetter: true}"\n          />\n    </div>\n  </div>\n\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/drawing/featureStyleComponent.js":
/*!***********************************************************!*\
  !*** ./contribs/gmf/src/drawing/featureStyleComponent.js ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/format/FeatureProperties.js */ "./src/format/FeatureProperties.js");
/* harmony import */ var ngeo_misc_colorpickerComponent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/misc/colorpickerComponent.js */ "./src/misc/colorpickerComponent.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
Controller.$inject = ["$scope", "ngeoFeatureHelper"];






var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDrawingFeatureStyle', [ngeo_misc_colorpickerComponent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_5__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/drawing/featureStyleComponent', __webpack_require__(/*! ./featureStyleComponent.html */ "./contribs/gmf/src/drawing/featureStyleComponent.html"));
}]);

function drawingDrawFeatureComponent() {
  return {
    controller: 'GmfFeaturestyleController as fsCtrl',
    scope: {
      'feature': '=gmfFeaturestyleFeature'
    },
    bindToController: true,
    templateUrl: 'gmf/drawing/featureStyleComponent'
  };
}

module.directive('gmfFeaturestyle', drawingDrawFeatureComponent);

function Controller($scope, ngeoFeatureHelper) {
  var _this = this;

  this.uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(this);
  this.feature = null;
  this.scope_ = $scope;
  this.featureHelper_ = ngeoFeatureHelper;
  this.color = undefined;
  this.label = undefined;
  this.measure = undefined;
  $scope.$watch(function () {
    return _this.color;
  }, this.handleColorSet_.bind(this));
  this.featureListenerKeys_ = [];
  this.type;
  $scope.$watch(function () {
    return _this.feature;
  }, this.handleFeatureSet_.bind(this));
}

Controller.prototype.handleFeatureSet_ = function (newFeature, previousFeature) {
  var _this2 = this;

  var keys = this.featureListenerKeys_;

  if (previousFeature) {
    keys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["unlistenByKey"]);
    keys.length = 0;
    this.type = undefined;
    this.color = undefined;
    this.measure = undefined;
    this.label = undefined;
  }

  if (newFeature) {
    [ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].ANGLE, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].COLOR, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].NAME, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SHOW_LABEL, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].OPACITY, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SHOW_MEASURE, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SIZE, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].STROKE].forEach(function (propName) {
      keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(newFeature, "change:" + propName, _this2.handleFeatureChange_, _this2));
    });
    var geometry = newFeature.getGeometry();

    if (!geometry) {
      throw new Error('Missing geometry');
    }

    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(geometry, 'change', this.handleGeometryChange_, this));
    this.type = this.featureHelper_.getType(newFeature);
    this.color = this.featureHelper_.getColorProperty(newFeature);
    this.measure = this.featureHelper_.getMeasure(newFeature);
  }
};

Controller.prototype.handleColorSet_ = function (newColor) {
  if (this.feature && newColor) {
    var currentColor = this.feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].COLOR);

    if (currentColor !== newColor) {
      this.feature.set(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].COLOR, newColor);
    }
  }
};

Controller.prototype.getSetAngle = function (value) {
  return this.getSetProperty_(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].ANGLE, value);
};

Controller.prototype.getSetName = function (value) {
  return this.getSetProperty_(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].NAME, value);
};

Controller.prototype.getSetShowLabel = function (value) {
  return this.getSetProperty_(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SHOW_LABEL, value);
};

Controller.prototype.getSetOpacity = function (value) {
  return this.getSetProperty_(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].OPACITY, value);
};

Controller.prototype.getSetShowMeasure = function (value) {
  return this.getSetProperty_(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SHOW_MEASURE, value);
};

Controller.prototype.getSetSize = function (value) {
  return this.getSetProperty_(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SIZE, value);
};

Controller.prototype.getSetStroke = function (value) {
  return this.getSetProperty_(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].STROKE, value);
};

Controller.prototype.getSetProperty_ = function (key, value) {
  if (!this.feature) {
    throw new Error('Missing feature');
  }

  if (value !== undefined) {
    this.feature.set(key, value);
  }

  return this.feature.get(key);
};

Controller.prototype.handleFeatureChange_ = function () {
  var feature = this.feature;

  if (!feature) {
    return;
  }

  this.featureHelper_.setStyle(feature, true);
};

Controller.prototype.handleGeometryChange_ = function () {
  if (!this.feature) {
    throw new Error('Missing feature');
  }

  this.measure = this.featureHelper_.getMeasure(this.feature);
  var showMeasure = this.featureHelper_.getShowMeasureProperty(this.feature);

  if (showMeasure) {
    this.handleFeatureChange_();
  }

  this.scope_.$apply();
};

module.controller('GmfFeaturestyleController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/drawing/module.js":
/*!********************************************!*\
  !*** ./contribs/gmf/src/drawing/module.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_drawing_drawFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/drawing/drawFeatureComponent.js */ "./contribs/gmf/src/drawing/drawFeatureComponent.js");
/* harmony import */ var gmf_drawing_featureStyleComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/drawing/featureStyleComponent.js */ "./contribs/gmf/src/drawing/featureStyleComponent.js");



/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDrawingModule', [gmf_drawing_drawFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_drawing_featureStyleComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/editing/EditFeature.js":
/*!*************************************************!*\
  !*** ./contribs/gmf/src/editing/EditFeature.js ***!
  \*************************************************/
/*! exports provided: EditingEditFeature, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditingEditFeature", function() { return EditingEditFeature; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/format/GeoJSON.js */ "./node_modules/ol/format/GeoJSON.js");
/* harmony import */ var ol_uri_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/uri.js */ "./node_modules/ol/uri.js");
EditingEditFeature.$inject = ["$http", "gmfLayersUrl"];



function EditingEditFeature($http, gmfLayersUrl) {
  this.http_ = $http;
  this.baseUrl_ = gmfLayersUrl;
}

EditingEditFeature.prototype.getFeaturesInExtent = function (layerIds, extent) {
  var url = Object(ol_uri_js__WEBPACK_IMPORTED_MODULE_2__["appendParams"])(this.baseUrl_ + "/" + layerIds.join(','), {
    'bbox': extent.join(',')
  });
  return this.http_.get(url).then(function (response) {
    return new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__["default"]().readFeatures(response.data);
  });
};

EditingEditFeature.prototype.getFeaturesWithComparisonFilters = function (layerIds, filters) {
  var properties = [];
  var params = {};

  for (var _iterator = filters, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
    var _ref;

    if (_isArray) {
      if (_i >= _iterator.length) break;
      _ref = _iterator[_i++];
    } else {
      _i = _iterator.next();
      if (_i.done) break;
      _ref = _i.value;
    }

    var filter = _ref;
    params[filter.property + "__" + filter.operator] = filter.value;
    properties.push(filter.property);
  }

  params.queryable = properties.join(',');
  var url = Object(ol_uri_js__WEBPACK_IMPORTED_MODULE_2__["appendParams"])(this.baseUrl_ + "/" + layerIds.join(','), params);
  return this.http_.get(url).then(function (response) {
    return new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__["default"]().readFeatures(response.data);
  });
};

EditingEditFeature.prototype.insertFeatures = function (layerId, features) {
  var url = this.baseUrl_ + "/" + layerId;
  var geoJSON = new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__["default"]().writeFeatures(features);
  return this.http_.post(url, geoJSON, {
    headers: {
      'Content-Type': 'application/geo+json'
    },
    withCredentials: true
  });
};

EditingEditFeature.prototype.updateFeature = function (layerId, feature) {
  var url = this.baseUrl_ + "/" + layerId.toString() + "/" + feature.getId();
  var geoJSON = new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__["default"]().writeFeature(feature);
  return this.http_.put(url, geoJSON, {
    headers: {
      'Content-Type': 'application/geo+json'
    },
    withCredentials: true
  });
};

EditingEditFeature.prototype.deleteFeature = function (layerId, feature) {
  var url = this.baseUrl_ + "/" + layerId.toString() + "/" + feature.getId();
  return this.http_.delete(url, {
    withCredentials: true
  });
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfEditFeature', []);
module.service('gmfEditFeature', EditingEditFeature);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/editing/EnumerateAttribute.js":
/*!********************************************************!*\
  !*** ./contribs/gmf/src/editing/EnumerateAttribute.js ***!
  \********************************************************/
/*! exports provided: EditingEnumerateAttributeService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditingEnumerateAttributeService", function() { return EditingEnumerateAttributeService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);

var EditingEnumerateAttributeService = function () {
  EditingEnumerateAttributeService.$inject = ["$http", "gmfLayersUrl"];

  function EditingEnumerateAttributeService($http, gmfLayersUrl) {
    this.http_ = $http;
    this.baseUrl_ = gmfLayersUrl;
    this.promises_ = {};
  }

  var _proto = EditingEnumerateAttributeService.prototype;

  _proto.getAttributeValues = function getAttributeValues(dataSource, attribute) {
    var promiseId = dataSource.id + "_" + attribute;
    var name = dataSource.name;

    if (!this.promises_[promiseId]) {
      var url = this.baseUrl_ + "/" + name + "/values/" + attribute;
      this.promises_[promiseId] = this.http_.get(url).then(function (resp) {
        return resp.data.items;
      });
    }

    return this.promises_[promiseId];
  };

  return EditingEnumerateAttributeService;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfEnumerateAttribute', []);
module.service('gmfEnumerateAttribute', EditingEnumerateAttributeService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/editing/Snapping.js":
/*!**********************************************!*\
  !*** ./contribs/gmf/src/editing/Snapping.js ***!
  \**********************************************/
/*! exports provided: EditingSnappingService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditingSnappingService", function() { return EditingSnappingService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/layertree/TreeManager.js */ "./contribs/gmf/src/layertree/TreeManager.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/layertree/Controller.js */ "./src/layertree/Controller.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/format/WFS.js */ "./node_modules/ol/format/WFS.js");
/* harmony import */ var ol_interaction_Snap_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/interaction/Snap.js */ "./node_modules/ol/interaction/Snap.js");
EditingSnappingService.$inject = ["$http", "$q", "$rootScope", "$injector", "$timeout", "gmfThemes", "gmfTreeManager"];

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }











function EditingSnappingService($http, $q, $rootScope, $injector, $timeout, gmfThemes, gmfTreeManager) {
  this.http_ = $http;
  this.q_ = $q;
  this.rootScope_ = $rootScope;
  this.timeout_ = $timeout;
  this.injector_ = $injector;
  this.gmfThemes_ = gmfThemes;
  this.gmfTreeManager_ = gmfTreeManager;
  this.cache_ = {};
  this.listenerKeys_ = [];
  this.map_ = null;
  this.mapViewChangePromise_ = null;
  this.ogcServers_ = null;
  this.ngeoSnappingSource_ = this.injector_.has('ngeoSnappingSource') ? this.injector_.get('ngeoSnappingSource') : undefined;
}

var CustomSnap = function (_olInteractionSnap) {
  _inheritsLoose(CustomSnap, _olInteractionSnap);

  function CustomSnap(options) {
    var _this;

    _this = _olInteractionSnap.call(this, options) || this;
    document.body.addEventListener('keydown', function (evt) {
      _this.setActive(evt.keyCode !== 17);
    });
    document.body.addEventListener('keyup', function () {
      _this.setActive(true);
    });
    return _this;
  }

  return CustomSnap;
}(ol_interaction_Snap_js__WEBPACK_IMPORTED_MODULE_9__["default"]);

EditingSnappingService.prototype.ensureSnapInteractionsOnTop = function () {
  if (!this.map_) {
    throw new Error('Missing map');
  }

  var map = this.map_;
  var item;

  for (var uid in this.cache_) {
    item = this.cache_[uid];

    if (item.active) {
      if (!item.interaction) {
        throw new Error('Missing item.interaction');
      }

      map.removeInteraction(item.interaction);
      map.addInteraction(item.interaction);
    }
  }
};

EditingSnappingService.prototype.setMap = function (map) {
  var _this2 = this;

  var keys = this.listenerKeys_;

  if (this.map_) {
    if (!this.treeCtrlsUnregister_) {
      throw new Error('Missing treeCtrlsUnregister');
    }

    this.treeCtrlsUnregister_();
    this.unregisterAllTreeCtrl_();
    keys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_6__["unlistenByKey"]);
    keys.length = 0;
  }

  this.map_ = map;

  if (map) {
    this.treeCtrlsUnregister_ = this.rootScope_.$watchCollection(function () {
      if (_this2.gmfTreeManager_.rootCtrl) {
        return _this2.gmfTreeManager_.rootCtrl.children;
      }
    }, function (value) {
      _this2.timeout_(function () {
        if (value) {
          if (!_this2.gmfTreeManager_.rootCtrl) {
            throw new Error('Missing gmfTreeManager_.rootCtrl');
          }

          _this2.unregisterAllTreeCtrl_();

          _this2.gmfTreeManager_.rootCtrl.traverseDepthFirst(_this2.registerTreeCtrl_.bind(_this2));
        }
      }, 0);
    });
    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_6__["listen"])(this.gmfThemes_, 'change', this.handleThemesChange_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_6__["listen"])(map, 'moveend', this.handleMapMoveEnd_, this));
  }
};

EditingSnappingService.prototype.handleThemesChange_ = function () {
  var _this3 = this;

  this.ogcServers_ = null;
  this.gmfThemes_.getOgcServersObject().then(function (ogcServers) {
    _this3.ogcServers_ = ogcServers;
  });
};

EditingSnappingService.prototype.registerTreeCtrl_ = function (treeCtrl) {
  var _this4 = this;

  var node = treeCtrl.node;
  var groupNode = node;

  if (groupNode.children) {
    return;
  }

  node = treeCtrl.node;
  var snappingConfig = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["getSnappingConfig"])(node);

  if (snappingConfig) {
    var wfsConfig = this.getWFSConfig_(treeCtrl);

    if (wfsConfig) {
      var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_5__["getUid"])(treeCtrl);
      var stateWatcherUnregister = this.rootScope_.$watch(function () {
        return _this4.isSnappingActiveForTreeCtrl_(treeCtrl);
      }, this.handleTreeCtrlStateChange_.bind(this, treeCtrl));
      var ogcServer = this.getOGCServer_(treeCtrl);

      if (!ogcServer) {
        throw new Error('Missing ogcServer');
      }

      this.cache_[uid] = {
        active: false,
        featureNS: ogcServer.wfsFeatureNS,
        featurePrefix: 'feature',
        features: new ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__["default"](),
        interaction: null,
        maxFeatures: 50,
        requestDeferred: null,
        snappingConfig: snappingConfig,
        treeCtrl: treeCtrl,
        wfsConfig: wfsConfig,
        stateWatcherUnregister: stateWatcherUnregister
      };
      this.handleTreeCtrlStateChange_(treeCtrl, this.isSnappingActiveForTreeCtrl_(treeCtrl));
    }
  }
};

EditingSnappingService.prototype.unregisterAllTreeCtrl_ = function () {
  for (var uid in this.cache_) {
    var item = this.cache_[uid];

    if (item) {
      item.stateWatcherUnregister();
      this.deactivateItem_(item);
      delete this.cache_[uid];
    }
  }
};

EditingSnappingService.prototype.getOGCServer_ = function (treeCtrl) {
  var gmfLayer = treeCtrl.node;

  if (gmfLayer.type !== gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["ThemeNodeType"].WMS) {
    return null;
  }

  var gmfLayerWMS = gmfLayer;
  var ogcServerName;
  var gmfGroup = treeCtrl.parent.node;

  if (gmfGroup.mixed) {
    ogcServerName = gmfLayerWMS.ogcServer;
  } else {
    var firstTreeCtrl = Object(ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_3__["getFirstParentTree"])(treeCtrl);
    var firstNode = firstTreeCtrl.node;
    ogcServerName = firstNode.ogcServer;
  }

  if (!ogcServerName) {
    return null;
  }

  if (!this.ogcServers_) {
    throw new Error('Missing ogcServers');
  }

  return this.ogcServers_[ogcServerName];
};

EditingSnappingService.prototype.getWFSConfig_ = function (treeCtrl) {
  if (this.ogcServers_ === null) {
    return null;
  }

  var gmfLayer = treeCtrl.node;

  if (gmfLayer.type !== gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["ThemeNodeType"].WMS) {
    return null;
  }

  var gmfLayerWMS = gmfLayer;
  var featureTypes = [];

  for (var i = 0, ii = gmfLayerWMS.childLayers.length; i < ii; i++) {
    if (gmfLayerWMS.childLayers[i].queryable) {
      featureTypes.push(gmfLayerWMS.childLayers[i].name);
    }
  }

  if (!featureTypes.length) {
    return null;
  }

  var ogcServer = this.getOGCServer_(treeCtrl);

  if (!ogcServer || !ogcServer.wfsSupport) {
    return null;
  }

  var urlWfs = ogcServer.urlWfs;

  if (!urlWfs) {
    throw new Error('Missing urlWfs');
  }

  return {
    featureTypes: featureTypes.join(','),
    url: urlWfs
  };
};

EditingSnappingService.prototype.isSnappingActiveForTreeCtrl_ = function (treeCtrl) {
  if (treeCtrl.getState() !== 'on') {
    return false;
  }

  if (treeCtrl.properties.snapping !== undefined) {
    if (typeof treeCtrl.properties.snapping !== 'boolean') {
      throw new Error('Wrong snappingActive type');
    }

    return treeCtrl.properties.snapping;
  }

  var node = treeCtrl.node;
  var config = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["getSnappingConfig"])(node);
  return config !== null && config.activated;
};

EditingSnappingService.prototype.handleTreeCtrlStateChange_ = function (treeCtrl, newVal) {
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_5__["getUid"])(treeCtrl);
  var item = this.cache_[uid];
  newVal ? this.activateItem_(item) : this.deactivateItem_(item);
};

EditingSnappingService.prototype.activateItem_ = function (item) {
  if (!this.map_) {
    throw new Error('Missing map');
  }

  if (item.active) {
    return;
  }

  var map = this.map_;
  var interaction = new CustomSnap({
    edge: item.snappingConfig.edge,
    features: item.features,
    pixelTolerance: item.snappingConfig.tolerance,
    vertex: item.snappingConfig.vertex
  });
  map.addInteraction(interaction);
  item.interaction = interaction;
  item.active = true;
  this.loadItemFeatures_(item);
};

EditingSnappingService.prototype.deactivateItem_ = function (item) {
  if (!this.map_) {
    throw new Error('Missing map');
  }

  if (!item.active) {
    return;
  }

  var map = this.map_;
  var interaction = item.interaction;

  if (!interaction) {
    throw new Error('Missing interaction');
  }

  map.removeInteraction(interaction);
  item.interaction = null;
  item.features.clear();

  if (item.requestDeferred) {
    item.requestDeferred.resolve();
    item.requestDeferred = null;
  }

  item.active = false;
  this.refreshSnappingSource_();
};

EditingSnappingService.prototype.loadAllItems_ = function () {
  this.mapViewChangePromise_ = null;
  var item;

  for (var uid in this.cache_) {
    item = this.cache_[uid];

    if (item.active) {
      this.loadItemFeatures_(item);
    }
  }
};

EditingSnappingService.prototype.refresh = function () {
  this.loadAllItems_();
};

EditingSnappingService.prototype.loadItemFeatures_ = function (item) {
  var _this5 = this;

  if (!this.map_) {
    throw new Error('Missing map');
  }

  if (item.requestDeferred) {
    item.requestDeferred.resolve();
  }

  var map = this.map_;
  var view = map.getView();
  var size = map.getSize();

  if (!size) {
    throw new Error('Missing size');
  }

  var extent = view.calculateExtent(size);
  var projCode = view.getProjection().getCode();
  var featureTypes = item.wfsConfig.featureTypes.split(',');
  var getFeatureOptions = {
    srsName: projCode,
    featureNS: item.featureNS,
    featurePrefix: item.featurePrefix,
    featureTypes: featureTypes,
    outputFormat: 'GML3',
    bbox: extent,
    geometryName: ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_4__["DEFAULT_GEOMETRY_NAME"],
    maxFeatures: item.maxFeatures
  };
  var wfsFormat = new ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_8__["default"]();
  var xmlSerializer = new XMLSerializer();
  var featureRequestXml = wfsFormat.writeGetFeature(getFeatureOptions);
  var featureRequest = xmlSerializer.serializeToString(featureRequestXml);
  var url = item.wfsConfig.url;
  item.requestDeferred = this.q_.defer();
  this.http_.post(url, featureRequest, {
    timeout: item.requestDeferred.promise
  }).then(function (response) {
    item.requestDeferred = null;
    item.features.clear();
    var readFeatures = new ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_8__["default"]().readFeatures(response.data);

    if (readFeatures) {
      item.features.extend(readFeatures);

      _this5.refreshSnappingSource_();
    }
  });
};

EditingSnappingService.prototype.handleMapMoveEnd_ = function () {
  if (this.mapViewChangePromise_) {
    this.timeout_.cancel(this.mapViewChangePromise_);
  }

  this.mapViewChangePromise_ = this.timeout_(this.loadAllItems_.bind(this), 400);
};

EditingSnappingService.prototype.refreshSnappingSource_ = function () {
  if (this.ngeoSnappingSource_ === undefined) {
    return;
  }

  this.ngeoSnappingSource_.clear();

  for (var uid in this.cache_) {
    var item = this.cache_[uid];

    if (item.features === undefined) {
      throw new Error('Missing features');
    }

    if (item.active) {
      this.ngeoSnappingSource_.addFeatures(item.features.getArray());
    }
  }
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfSnapping', [gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]);
module.service('gmfSnapping', EditingSnappingService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/editing/XSDAttributes.js":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/editing/XSDAttributes.js ***!
  \***************************************************/
/*! exports provided: EditingXSDAttributeService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditingXSDAttributeService", function() { return EditingXSDAttributeService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_format_XSDAttribute_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/format/XSDAttribute.js */ "./src/format/XSDAttribute.js");
EditingXSDAttributeService.$inject = ["$http", "gmfLayersUrl"];


function EditingXSDAttributeService($http, gmfLayersUrl) {
  this.http_ = $http;
  this.baseUrl_ = gmfLayersUrl;
  this.promises_ = {};
}

EditingXSDAttributeService.prototype.getAttributes = function (id) {
  if (!this.promises_[id]) {
    var url = this.baseUrl_ + "/" + id + "/md.xsd";
    this.promises_[id] = this.http_.get(url).then(function (resp) {
      return new ngeo_format_XSDAttribute_js__WEBPACK_IMPORTED_MODULE_1__["default"]().read(resp.data);
    });
  }

  return this.promises_[id];
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfXSDAttributes', []);
module.service('gmfXSDAttributes', EditingXSDAttributeService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/editing/editFeatureComponent.html":
/*!************************************************************!*\
  !*** ./contribs/gmf/src/editing/editFeatureComponent.html ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div>\n  <div ng-switch="efCtrl.feature">\n    <a\n      ng-switch-when="null"\n      ng-if="efCtrl.geomType"\n      href\n      ngeo-btn\n      ngeo-createfeature\n      ngeo-createfeature-active="efCtrl.createActive"\n      ngeo-createfeature-features="::efCtrl.features"\n      ngeo-createfeature-geom-type="::efCtrl.geomType"\n      ngeo-createfeature-map="::efCtrl.map"\n      class="btn btn-default"\n      ng-class="{active: efCtrl.createActive}"\n      ng-model="efCtrl.createActive">\n      <span ng-switch="::efCtrl.geomType">\n        <span ng-switch-when="Point">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/point.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/point.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n          {{\'Draw new point\' | translate}}\n        </span>\n        <span ng-switch-when="MultiPoint">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/point.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/point.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n          {{\'Draw new point\' | translate}}\n        </span>\n        <span ng-switch-when="LineString">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/line.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/line.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n          {{\'Draw new linestring\' | translate}}\n        </span>\n        <span ng-switch-when="MultiLineString">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/line.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/line.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n          {{\'Draw new linestring\' | translate}}\n        </span>\n        <span ng-switch-when="Polygon">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/polygon.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/polygon.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n          {{\'Draw new polygon\' | translate}}\n        </span>\n        <span ng-switch-when="MultiPolygon">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/polygon.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/polygon.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n          {{\'Draw new polygon\' | translate}}\n        </span>\n      </span>\n    </a>\n    <div ng-switch-default>\n      <form\n        novalidate\n        name="form"\n        class="form gmf-editfeature-attributes-container"\n        ng-if="efCtrl.attributes">\n        <div class="row">\n          <div class="col-sm-12">\n            <a\n              class="close"\n              ng-click="efCtrl.cancel()"\n              ng-disabled="efCtrl.pending"\n              title="{{\'Cancel modifications\' | translate}}"\n              href>&times;</a>\n          </div>\n        </div>\n        <ngeo-attributes\n          ngeo-attributes-attributes="::efCtrl.attributes"\n          ngeo-attributes-disabled="efCtrl.pending"\n          ngeo-attributes-feature="::efCtrl.feature">\n        </ngeo-attributes>\n        <input\n          type="submit"\n          value="{{\'Save\' | translate}}"\n          class="btn btn-sm btn-default gmf-editfeature-btn-save"\n          ng-click="form.$valid && efCtrl.save()"\n          ng-disabled="!efCtrl.dirty || efCtrl.pending"\n          title="{{\'Save modifications\' | translate}}"></input>\n        <a\n          class="btn btn-sm btn-default gmf-editfeature-btn-cancel"\n          ng-click="efCtrl.confirmCancel()"\n          ng-disabled="efCtrl.pending"\n          title="{{\'Cancel modifications\' | translate}}"\n          href>{{\'Cancel\' | translate}}</a>\n        <button\n          class="btn btn-sm btn-link gmf-editfeature-btn-delete"\n          ng-click="efCtrl.delete()"\n          ng-disabled="efCtrl.pending"\n          ng-show="efCtrl.featureId"\n          title="{{\'Delete this feature\' | translate}}">\n          <span class="fa fa-trash"></span>\n          {{\'Delete\' | translate}}\n        </button>\n      </form>\n    </div>\n  </div>\n  <ngeo-modal ng-model="efCtrl.unsavedModificationsModalShown">\n    <div class="modal-header ui-draggable-handle">\n      <h4 class="modal-title">{{\'Unsaved modifications!\' | translate}}</h4>\n      <button\n          type="button"\n          class="close"\n          data-dismiss="modal"\n          aria-label="{{\'Close\' | translate}}">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    <div class="modal-body">\n      {{\'There are unsaved changes.\' | translate}}\n    </div>\n    <div class="modal-footer">\n      <button\n          type="button"\n          class="btn btn-default"\n          data-dismiss="modal"\n          ng-click="efCtrl.continueWithoutSaving()">\n        {{\'Continue without saving\' | translate}}\n      </button>\n      <button\n          type="button"\n          class="btn prime"\n          data-dismiss="modal">\n        {{\'Cancel\' | translate}}\n      </button>\n      <button\n          type="button"\n          class="btn btn-default"\n          data-dismiss="modal"\n          ng-click="efCtrl.submit()">\n        {{\'Save\' | translate}}\n      </button>\n    </div>\n  </ngeo-modal>\n  <ngeo-modal ng-model="efCtrl.showServerError">\n    <div class="modal-header ui-draggable-handle">{{\'Server error.\' | translate}}</div>\n    <div class="modal-body">{{efCtrl.serverErrorType}}<br>\n    {{efCtrl.serverErrorMessage || (\'Unexpected server error.\' | translate)}}</div>\n  </ngeo-modal>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/editing/editFeatureComponent.js":
/*!**********************************************************!*\
  !*** ./contribs/gmf/src/editing/editFeatureComponent.js ***!
  \**********************************************************/
/*! exports provided: EditingState, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditingState", function() { return EditingState; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_editing_EditFeature_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/editing/EditFeature.js */ "./contribs/gmf/src/editing/EditFeature.js");
/* harmony import */ var gmf_editing_Snapping_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/editing/Snapping.js */ "./contribs/gmf/src/editing/Snapping.js");
/* harmony import */ var gmf_editing_XSDAttributes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/editing/XSDAttributes.js */ "./contribs/gmf/src/editing/XSDAttributes.js");
/* harmony import */ var gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/layertree/SyncLayertreeMap.js */ "./contribs/gmf/src/layertree/SyncLayertreeMap.js");
/* harmony import */ var ngeo_misc_php_date_formatter_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/misc/php-date-formatter.js */ "./src/misc/php-date-formatter.js");
/* harmony import */ var jquery_datetimepicker_jquery_datetimepicker_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jquery-datetimepicker/jquery.datetimepicker.js */ "./node_modules/jquery-datetimepicker/jquery.datetimepicker.js");
/* harmony import */ var jquery_datetimepicker_jquery_datetimepicker_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jquery_datetimepicker_jquery_datetimepicker_js__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var jquery_datetimepicker_jquery_datetimepicker_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jquery-datetimepicker/jquery.datetimepicker.css */ "./node_modules/jquery-datetimepicker/jquery.datetimepicker.css");
/* harmony import */ var jquery_datetimepicker_jquery_datetimepicker_css__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(jquery_datetimepicker_jquery_datetimepicker_css__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var ngeo_editing_attributesComponent_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/editing/attributesComponent.js */ "./src/editing/attributesComponent.js");
/* harmony import */ var ngeo_editing_createfeatureComponent_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/editing/createfeatureComponent.js */ "./src/editing/createfeatureComponent.js");
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
/* harmony import */ var ngeo_format_XSDAttribute_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/format/XSDAttribute.js */ "./src/format/XSDAttribute.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_interaction_Rotate_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ngeo/interaction/Rotate.js */ "./src/interaction/Rotate.js");
/* harmony import */ var ngeo_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ngeo/interaction/Translate.js */ "./src/interaction/Translate.js");
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
/* harmony import */ var ngeo_Menu_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ngeo/Menu.js */ "./src/Menu.js");
/* harmony import */ var ngeo_message_modalComponent_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ngeo/message/modalComponent.js */ "./src/message/modalComponent.js");
/* harmony import */ var ngeo_misc_btnComponent_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ngeo/misc/btnComponent.js */ "./src/misc/btnComponent.js");
/* harmony import */ var ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ngeo/misc/decorate.js */ "./src/misc/decorate.js");
/* harmony import */ var ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ngeo/misc/EventHelper.js */ "./src/misc/EventHelper.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ngeo/misc/ToolActivate.js */ "./src/misc/ToolActivate.js");
/* harmony import */ var ngeo_misc_ToolActivateMgr_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ngeo/misc/ToolActivateMgr.js */ "./src/misc/ToolActivateMgr.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ol/format/GeoJSON.js */ "./node_modules/ol/format/GeoJSON.js");
/* harmony import */ var ol_interaction_Modify_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ol/interaction/Modify.js */ "./node_modules/ol/interaction/Modify.js");
/* harmony import */ var ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ol/layer/Image.js */ "./node_modules/ol/layer/Image.js");
/* harmony import */ var ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ol/layer/Tile.js */ "./node_modules/ol/layer/Tile.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_style_Text_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ol/style/Text.js */ "./node_modules/ol/style/Text.js");
/* harmony import */ var ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ol/MapBrowserEvent.js */ "./node_modules/ol/MapBrowserEvent.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
Controller.$inject = ["$element", "$q", "$scope", "$timeout", "gettextCatalog", "gmfEditFeature", "gmfSnapping", "gmfXSDAttributes", "ngeoEventHelper", "ngeoFeatureHelper", "ngeoLayerHelper", "ngeoToolActivateMgr"];







































var EditingState = {
  IDLE: 'idle',
  DEACTIVATE_EXECUTE: 'deactivate_execute',
  DEACTIVATE_PENDING: 'deactivate_pending',
  STOP_EDITING_EXECUTE: 'stop_editing_execute',
  STOP_EDITING_PENDING: 'stop_editing_pending'
};
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('GmfEditingFeatureComponent', [gmf_editing_EditFeature_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_editing_Snapping_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_editing_XSDAttributes_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_editing_attributesComponent_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, ngeo_editing_createfeatureComponent_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_15__["default"].name, ngeo_message_modalComponent_js__WEBPACK_IMPORTED_MODULE_17__["default"].name, ngeo_misc_btnComponent_js__WEBPACK_IMPORTED_MODULE_18__["default"].name, ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_20__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_21__["default"].name, ngeo_misc_ToolActivateMgr_js__WEBPACK_IMPORTED_MODULE_23__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/editing/editFeatureComponent', __webpack_require__(/*! ./editFeatureComponent.html */ "./contribs/gmf/src/editing/editFeatureComponent.html"));
}]);

function editingEditFeatureComponent() {
  return {
    controller: 'GmfEditfeatureController as efCtrl',
    scope: {
      'dirty': '=gmfEditfeatureDirty',
      'editableTreeCtrl': '=gmfEditfeatureEditabletreectrl',
      'map': '<gmfEditfeatureMap',
      'state': '=gmfEditfeatureState',
      'tolerance': '<?gmfEditfeatureTolerance',
      'vectorLayer': '<gmfEditfeatureVector',
      'closeAfterSave': '=?gmfEditfeatureCloseaftersave'
    },
    bindToController: true,
    templateUrl: 'gmf/editing/editFeatureComponent'
  };
}

module.directive('gmfEditfeature', editingEditFeatureComponent);

function Controller($element, $q, $scope, $timeout, gettextCatalog, gmfEditFeature, gmfSnapping, gmfXSDAttributes, ngeoEventHelper, ngeoFeatureHelper, ngeoLayerHelper, ngeoToolActivateMgr) {
  var _this = this;

  this.dirty = false;
  this.editableTreeCtrl = null;
  this.map = null;
  this.state = '';
  this.tolerance = 0;
  this.vectorLayer = null;
  this.closeAfterSave = false;
  this.element_ = $element;
  this.q_ = $q;
  this.scope_ = $scope;
  this.timeout_ = $timeout;
  this.gettextCatalog_ = gettextCatalog;
  this.gmfEditFeature_ = gmfEditFeature;
  this.gmfSnapping_ = gmfSnapping;
  this.gmfXSDAttributes_ = gmfXSDAttributes;
  this.ngeoEventHelper_ = ngeoEventHelper;
  this.ngeoFeatureHelper_ = ngeoFeatureHelper;
  this.ngeoLayerHelper_ = ngeoLayerHelper;
  this.ngeoToolActivateMgr_ = ngeoToolActivateMgr;
  this.editableNode_ = null;
  this.editableWMSLayer_ = null;
  this.confirmDeferred_ = null;
  this.unsavedModificationsModalShown = false;
  this.pending = false;
  this.active = true;
  this.createActive = false;
  this.createToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_22__["default"](this, 'createActive');
  this.mapSelectActive = true;
  this.mapSelectToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_22__["default"](this, 'mapSelectActive');
  this.feature = null;
  this.scope_.$watch(function () {
    return _this.feature;
  }, this.handleFeatureChange_.bind(this));
  this.featureId = undefined;
  this.features = null;
  this.interactions_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_25__["default"]();
  this.modify_ = null;
  this.modifyToolActivate = null;
  this.menu_ = new ngeo_Menu_js__WEBPACK_IMPORTED_MODULE_16__["default"]({
    actions: [{
      cls: 'fas fa-arrows-alt',
      label: gettextCatalog.getString('Move'),
      name: 'move'
    }, {
      cls: 'fas fa-undo fa-flip-horizontal',
      label: gettextCatalog.getString('Rotate'),
      name: 'rotate'
    }]
  });
  this.menuVertex_ = new ngeo_Menu_js__WEBPACK_IMPORTED_MODULE_16__["default"]({
    actions: [{
      cls: 'fa fa-trash',
      label: gettextCatalog.getString('Delete vertex'),
      name: 'delete'
    }]
  });
  this.translate_ = null;
  this.rotate_ = null;
  this.rotateToolActivate = null;
  this.translateToolActivate = null;
  this.listenerKeys_ = [];
  this.geomListenerKeys_ = [];
  this.mapListenerKeys_ = [];
  this.attributes = null;
  this.geomType = null;
  this.showServerError = false;
  this.serverErrorMessage = null;
  this.serverErrorType = null;
  this.vertexInfo_ = null;
}

Controller.prototype.$onInit = function () {
  var _this2 = this;

  if (!this.map) {
    throw new Error('Missing map');
  }

  var lang = this.gettextCatalog_.getCurrentLanguage();
  $.datetimepicker.setLocale(lang);
  $.datetimepicker.setDateFormatter(new ngeo_misc_php_date_formatter_js__WEBPACK_IMPORTED_MODULE_5__["default"]());
  this.dirty = this.dirty === true;

  if (!this.editableTreeCtrl) {
    throw new Error('Missing editableTreeCtrl');
  }

  this.editableNode_ = this.editableTreeCtrl.node;

  if (!this.vectorLayer) {
    throw new Error('Missing vectorLayer');
  }

  var source = this.vectorLayer.getSource();

  if (!(source instanceof ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_37__["default"])) {
    throw new Error('Wrong source');
  }

  this.features = source.getFeaturesCollection();
  this.tolerance = this.tolerance || 10;
  var layer = Object(gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_4__["getLayer"])(this.editableTreeCtrl);

  if (layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_31__["default"] || layer instanceof ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_32__["default"]) {
    this.editableWMSLayer_ = layer;
  }

  this.modify_ = new ol_interaction_Modify_js__WEBPACK_IMPORTED_MODULE_30__["default"]({
    deleteCondition: ngeo_utils_js__WEBPACK_IMPORTED_MODULE_10__["deleteCondition"],
    features: this.features,
    style: this.ngeoFeatureHelper_.getVertexStyle(false)
  });
  this.interactions_.push(this.modify_);
  this.rotate_ = new ngeo_interaction_Rotate_js__WEBPACK_IMPORTED_MODULE_13__["default"]({
    features: this.features,
    style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_34__["default"]({
      text: new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_35__["default"]({
        text: "\uF01E",
        font: '900 18px "Font Awesome 5 Free"',
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_33__["default"]({
          color: '#7a7a7a'
        })
      })
    })
  });
  this.interactions_.push(this.rotate_);
  this.translate_ = new ngeo_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_14__["default"]({
    features: this.features,
    style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_34__["default"]({
      text: new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_35__["default"]({
        text: "\uF0B2",
        font: '900 18px "Font Awesome 5 Free"',
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_33__["default"]({
          color: '#7a7a7a'
        })
      })
    })
  });
  this.interactions_.push(this.translate_);
  this.initializeInteractions_();
  this.modifyToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_22__["default"](this.modify_, 'active');
  this.rotateToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_22__["default"](this.rotate_, 'active');
  this.translateToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_22__["default"](this.translate_, 'active');
  this.map.addOverlay(this.menu_);
  this.map.addOverlay(this.menuVertex_);
  this.scope_.$watch(function () {
    return _this2.createActive;
  }, function (newVal, oldVal) {
    if (newVal) {
      _this2.gmfSnapping_.ensureSnapInteractionsOnTop();
    }
  });
  this.scope_.$on('$destroy', this.handleDestroy_.bind(this));
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_24__["getUid"])(this);
  this.ngeoEventHelper_.addListenerKey(uid, Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(this.features, 'add', this.handleFeatureAdd_, this));
  this.scope_.$watch(function () {
    return _this2.mapSelectActive;
  }, this.handleMapSelectActiveChange_.bind(this));
  this.scope_.$watch(function () {
    return _this2.state;
  }, function (newValue, oldValue) {
    var state = EditingState;

    if (newValue === state.STOP_EDITING_PENDING) {
      if (_this2.feature && _this2.dirty) {
        _this2.confirmCancel().then(function () {
          _this2.timeout_(function () {
            _this2.state = state.STOP_EDITING_EXECUTE;

            _this2.scope_.$apply();
          }, 500);
        });
      } else {
        _this2.state = state.STOP_EDITING_EXECUTE;
      }
    } else if (newValue === state.DEACTIVATE_PENDING) {
      if (_this2.feature && _this2.dirty) {
        _this2.confirmCancel().then(function () {
          _this2.timeout_(function () {
            _this2.state = state.DEACTIVATE_EXECUTE;

            _this2.scope_.$apply();
          }, 500);
        });
      } else {
        _this2.state = state.DEACTIVATE_EXECUTE;
      }
    }
  });
  this.scope_.$watch(function () {
    return _this2.unsavedModificationsModalShown;
  }, function (newValue, oldValue) {
    if (oldValue && !newValue) {
      _this2.state = EditingState.IDLE;
    }
  });
  this.gmfXSDAttributes_.getAttributes(this.editableNode_.id).then(this.setAttributes_.bind(this));
  this.toggle_(true);
};

Controller.prototype.save = function () {
  var _this3 = this;

  if (!this.attributes) {
    throw new Error('Missing attributes');
  }

  if (!this.feature) {
    throw new Error('Missing feature');
  }

  if (!this.editableNode_) {
    throw new Error('Missing editableNode');
  }

  var feature = this.feature.clone();
  feature.setId(this.feature.getId());
  var id = this.featureId;
  this.pending = true;
  var dateFormatter = new ngeo_misc_php_date_formatter_js__WEBPACK_IMPORTED_MODULE_5__["default"]();

  for (var _iterator = this.attributes, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
    var _ref;

    if (_isArray) {
      if (_i >= _iterator.length) break;
      _ref = _iterator[_i++];
    } else {
      _i = _iterator.next();
      if (_i.done) break;
      _ref = _i.value;
    }

    var attribute = _ref;

    if (attribute.format) {
      if (this.feature.get(attribute.name)) {
        var name = this.feature.get(attribute.name);
        var value = dateFormatter.parseDate(name, attribute.format);

        if (value === null) {
          throw new Error('Missing date');
        }

        var jsonFormat = 'Y-m-d\\TH:i:s';

        if (attribute.type === 'date') {
          jsonFormat = 'Y-m-d';
        } else if (attribute.type === 'time') {
          jsonFormat = 'H:i:s';
        } else if (attribute.type === 'datetime') {
          value.setMinutes(value.getMinutes() + value.getTimezoneOffset());
        }

        feature.set(attribute.name, dateFormatter.formatDate(value, jsonFormat));
      } else {
        feature.set(attribute.name, null);
      }
    }
  }

  var promise = id ? this.gmfEditFeature_.updateFeature(this.editableNode_.id, feature) : this.gmfEditFeature_.insertFeatures(this.editableNode_.id, [feature]);
  promise.then(function (response) {
    _this3.dirty = false;

    _this3.handleEditFeature_(response);

    _this3.gmfSnapping_.refresh();

    if (_this3.closeAfterSave) {
      _this3.cancel();
    }
  }).catch(function (response) {
    _this3.showServerError = true;
    _this3.serverErrorType = "error type : " + response.data.error_type;
    _this3.serverErrorMessage = "error message : " + response.data.message;
  }).finally(function () {
    _this3.pending = false;
  });
};

Controller.prototype.cancel = function () {
  if (!this.features) {
    throw new Error('Missing features');
  }

  this.dirty = false;
  this.feature = null;
  this.features.clear();
  this.menu_.close();
  this.menuVertex_.close();
  this.unsavedModificationsModalShown = false;
};

Controller.prototype.confirmCancel = function () {
  var _this4 = this;

  return this.checkForModifications_().then(function () {
    _this4.cancel();
  });
};

Controller.prototype.checkForModifications_ = function (scopeApply) {
  this.confirmDeferred_ = this.q_.defer();

  if (this.feature && this.dirty) {
    this.unsavedModificationsModalShown = true;

    if (scopeApply) {
      this.scope_.$apply();
    }
  } else {
    this.confirmDeferred_.resolve();
  }

  return this.confirmDeferred_.promise;
};

Controller.prototype.continueWithoutSaving = function () {
  if (!this.confirmDeferred_) {
    throw new Error('Missing confirmDeferred_');
  }

  this.cancel();
  this.confirmDeferred_.resolve();
};

Controller.prototype.delete = function () {
  var _this5 = this;

  if (!this.editableNode_) {
    throw new Error('Missing editableNode_');
  }

  if (!this.feature) {
    throw new Error('Missing feature');
  }

  var msg = this.gettextCatalog_.getString('Do you really want to delete the selected feature?');

  if (confirm(msg)) {
    this.pending = true;
    this.gmfEditFeature_.deleteFeature(this.editableNode_.id, this.feature).then(function (response) {
      if (!_this5.editableWMSLayer_) {
        throw new Error('Missing editableWMSLayer_');
      }

      _this5.dirty = false;
      _this5.pending = false;

      _this5.ngeoLayerHelper_.refreshWMSLayer(_this5.editableWMSLayer_);

      _this5.cancel();
    }, function (response) {
      _this5.showServerError = true;
      _this5.pending = false;
      _this5.serverErrorType = "error type : " + response.data.error_type;
      _this5.serverErrorMessage = "error message : " + response.data.message;
    });
  }
};

Controller.prototype.submit = function () {
  var _this6 = this;

  this.timeout_(function () {
    _this6.element_.find('input[type="submit"]').click();
  }, 0);
};

Controller.prototype.handleEditFeature_ = function (resp) {
  var features = new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_29__["default"]().readFeatures(resp.data);

  if (features.length) {
    if (!this.editableWMSLayer_) {
      throw new Error('Missing editableWMSLayer_');
    }

    if (!this.feature) {
      throw new Error('Missing feature');
    }

    this.feature.setId(features[0].getId());
    this.ngeoLayerHelper_.refreshWMSLayer(this.editableWMSLayer_);
  }

  if (this.confirmDeferred_) {
    this.confirmDeferred_.resolve();
  }
};

Controller.prototype.setAttributes_ = function (attributes) {
  this.attributes = attributes;

  for (var _iterator2 = attributes, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
    var _ref2;

    if (_isArray2) {
      if (_i2 >= _iterator2.length) break;
      _ref2 = _iterator2[_i2++];
    } else {
      _i2 = _iterator2.next();
      if (_i2.done) break;
      _ref2 = _i2.value;
    }

    var attribute = _ref2;

    if (attribute.type == 'date') {
      attribute.format = 'Y-m-d';
      attribute.mask = '9999-19-39';
    } else if (attribute.type == 'time') {
      attribute.format = 'H:i';
      attribute.mask = '29:59';
    } else if (attribute.type == 'datetime') {
      attribute.format = 'Y-m-d H:i';
      attribute.mask = '9999-19-39 29:59';
    }
  }

  var geomAttr = Object(ngeo_format_XSDAttribute_js__WEBPACK_IMPORTED_MODULE_11__["getGeometryAttribute"])(this.attributes);

  if (geomAttr && geomAttr.geomType) {
    this.geomType = geomAttr.geomType;
  }
};

Controller.prototype.handleFeatureAdd_ = function (evt) {
  var _this7 = this;

  if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_25__["CollectionEvent"]) {
    this.feature = null;
    this.timeout_(function () {
      if (!_this7.attributes) {
        throw new Error('Missing attributes');
      }

      var feature = evt.element;

      if (!(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_28__["default"])) {
        throw new Error('Wrong feature type');
      }

      var dateFormatter = new ngeo_misc_php_date_formatter_js__WEBPACK_IMPORTED_MODULE_5__["default"]();

      for (var _iterator3 = _this7.attributes, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
        var _ref3;

        if (_isArray3) {
          if (_i3 >= _iterator3.length) break;
          _ref3 = _iterator3[_i3++];
        } else {
          _i3 = _iterator3.next();
          if (_i3.done) break;
          _ref3 = _i3.value;
        }

        var attribute = _ref3;

        if (attribute.format) {
          if (feature.get(attribute.name)) {
            var value = void 0;

            if (attribute.type === 'datetime') {
              value = new Date(feature.get(attribute.name));
              value.setMinutes(value.getMinutes() - value.getTimezoneOffset());
            } else {
              var jsonFormat = '';

              if (attribute.type === 'date') {
                jsonFormat = 'Y-m-d';
              } else if (attribute.type === 'time') {
                jsonFormat = 'H:i:s';
              }

              var name = feature.get(attribute.name);

              if (typeof name != 'string') {
                throw new Error('Wrong name type');
              }

              value = dateFormatter.parseDate(name, jsonFormat);
            }

            feature.set(attribute.name, dateFormatter.formatDate(value, attribute.format));
          } else {
            feature.set(attribute.name, null);
          }
        }
      }

      _this7.feature = feature;
      _this7.createActive = false;

      if (!feature.getId()) {
        _this7.dirty = true;
      }

      _this7.scope_.$apply();
    }, 0);
  }
};

Controller.prototype.toggle_ = function (active) {
  if (!this.modifyToolActivate) {
    throw new Error('Missing modifyToolActivate');
  }

  if (!this.translateToolActivate) {
    throw new Error('Missing translateToolActivate');
  }

  if (!this.rotateToolActivate) {
    throw new Error('Missing rotateToolActivate');
  }

  if (!this.modify_) {
    throw new Error('Missing modify');
  }

  if (!this.editableTreeCtrl) {
    throw new Error('Missing editableTreeCtrl');
  }

  var keys = this.listenerKeys_;
  var createUid = ['create-', Object(ol_util_js__WEBPACK_IMPORTED_MODULE_24__["getUid"])(this)].join('-');
  var otherUid = ['other-', Object(ol_util_js__WEBPACK_IMPORTED_MODULE_24__["getUid"])(this)].join('-');
  var toolMgr = this.ngeoToolActivateMgr_;

  if (active) {
    if (!this.translate_) {
      throw new Error('Missing translate');
    }

    if (!this.rotate_) {
      throw new Error('Missing rotate');
    }

    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(this.menu_, 'actionclick', this.handleMenuActionClick_, this));
    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(this.menuVertex_, 'actionclick', this.handleMenuVertexActionClick_, this));
    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(this.translate_, 'translateend', this.handleTranslateEnd_, this));
    keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(this.rotate_, 'rotateend', this.handleRotateEnd_, this));
    toolMgr.registerTool(createUid, this.createToolActivate, false);
    toolMgr.registerTool(createUid, this.mapSelectToolActivate, true);
    toolMgr.registerTool(otherUid, this.createToolActivate, false);
    toolMgr.registerTool(otherUid, this.modifyToolActivate, true);
    toolMgr.registerTool(otherUid, this.translateToolActivate, false);
    toolMgr.registerTool(otherUid, this.rotateToolActivate, false);
  } else {
    keys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["unlistenByKey"]);
    keys.length = 0;
    toolMgr.unregisterTool(createUid, this.createToolActivate);
    toolMgr.unregisterTool(createUid, this.mapSelectToolActivate);
    toolMgr.unregisterTool(otherUid, this.createToolActivate);
    toolMgr.unregisterTool(otherUid, this.modifyToolActivate);
    toolMgr.unregisterTool(otherUid, this.translateToolActivate);
    toolMgr.unregisterTool(otherUid, this.rotateToolActivate);
    this.createActive = false;
    this.cancel();
  }

  this.modify_.setActive(active);
  this.mapSelectActive = active;
  this.editableTreeCtrl.properties.editing = active;
};

Controller.prototype.handleMapSelectActiveChange_ = function (active) {
  if (!this.map) {
    throw new Error('Missing map');
  }

  var mapDiv = this.map.getViewport();

  if (!mapDiv) {
    throw new Error('Missing mapDiv');
  }

  if (active) {
    this.mapListenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(this.map, 'click', this.handleMapClick_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(mapDiv, 'contextmenu', this.handleMapContextMenu_, this));
  } else {
    this.mapListenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["unlistenByKey"]);
  }
};

Controller.prototype.handleMapClick_ = function (evt) {
  var _this8 = this;

  if (evt instanceof ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_36__["default"]) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    var coordinate = evt.coordinate;
    var pixel = evt.pixel;
    var feature = this.map.forEachFeatureAtPixel(pixel, function (feature) {
      if (!(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_28__["default"])) {
        throw new Error('Wrong feature type');
      }

      if (!_this8.features) {
        throw new Error('Missing features');
      }

      var ret = null;

      if (_this8.features.getArray().includes(feature)) {
        ret = feature;
      }

      return ret;
    }, {
      hitTolerance: 5,
      layerFilter: undefined
    });

    if (feature) {
      return;
    }

    this.checkForModifications_(true).then(function () {
      if (!_this8.map) {
        throw new Error('Missing map');
      }

      if (!_this8.editableNode_) {
        throw new Error('Missing editableNode');
      }

      var map = _this8.map;
      var view = map.getView();
      var resolution = view.getResolution();

      if (resolution === undefined) {
        throw new Error('Missing resolution');
      }

      var buffer = resolution * _this8.tolerance;
      var extent = ol_extent_js__WEBPACK_IMPORTED_MODULE_27__["buffer"]([coordinate[0], coordinate[1], coordinate[0], coordinate[1]], buffer);

      _this8.gmfEditFeature_.getFeaturesInExtent([_this8.editableNode_.id], extent).then(_this8.handleGetFeatures_.bind(_this8));

      _this8.cancel();

      _this8.pending = true;
    });
  }
};

Controller.prototype.handleMapContextMenu_ = function (evt) {
  var _this9 = this;

  if (evt instanceof Event) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    var pixel = this.map.getEventPixel(evt);
    var coordinate = this.map.getCoordinateFromPixel(pixel);
    var feature = this.map.forEachFeatureAtPixel(pixel, function (feature) {
      if (!(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_28__["default"])) {
        throw new Error('Wrong feature type');
      }

      if (!_this9.features) {
        throw new Error('Missing features');
      }

      var ret = null;

      if (_this9.features.getArray().includes(feature)) {
        ret = feature;
      }

      return ret;
    }, {
      hitTolerance: 7,
      layerFilter: undefined
    });
    feature = feature ? feature : null;
    this.menu_.close();
    this.menuVertex_.close();
    this.vertexInfo_ = null;

    if (feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_28__["default"]) {
      var resolutions = this.map.getView().getResolution();

      if (!resolutions) {
        throw new Error('Missing resolutions');
      }

      var vertexInfo = this.ngeoFeatureHelper_.getVertexInfoAtCoordinate(feature, coordinate, resolutions);

      if (vertexInfo) {
        this.vertexInfo_ = vertexInfo;
        this.menuVertex_.open(coordinate);
      } else {
        var type = this.ngeoFeatureHelper_.getType(feature);

        if (type === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_12__["default"].POLYGON || type === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_12__["default"].MULTI_POLYGON || type === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_12__["default"].LINE_STRING || type === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_12__["default"].MULTI_LINE_STRING) {
          this.menu_.open(coordinate);
        }
      }

      evt.preventDefault();
      evt.stopPropagation();
    }
  }
};

Controller.prototype.handleGetFeatures_ = function (features) {
  var _this10 = this;

  this.pending = false;
  this.timeout_(function () {
    if (!_this10.features) {
      throw new Error('Missing features');
    }

    if (features.length) {
      var feature = features[0];
      _this10.feature = feature;

      _this10.features.push(feature);
    }
  }, 0);
};

Controller.prototype.initializeInteractions_ = function () {
  this.interactions_.forEach(function (interaction) {
    interaction.setActive(false);
    Object(ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_19__["interactionDecoration"])(interaction);
  });
};

Controller.prototype.registerInteractions_ = function () {
  var _this11 = this;

  this.interactions_.forEach(function (interaction) {
    if (!_this11.map) {
      throw new Error('Missing map');
    }

    _this11.map.addInteraction(interaction);
  });
};

Controller.prototype.unregisterInteractions_ = function () {
  var _this12 = this;

  this.interactions_.forEach(function (interaction) {
    if (!_this12.map) {
      throw new Error('Missing map');
    }

    _this12.map.removeInteraction(interaction);
  });
};

Controller.prototype.handleFeatureChange_ = function (newFeature, oldFeature) {
  var _this13 = this;

  var geom;

  if (oldFeature) {
    this.geomListenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["unlistenByKey"]);
    this.unregisterInteractions_();
  }

  if (newFeature) {
    this.featureId = newFeature.getId();
    geom = newFeature.getGeometry();
    this.geomListenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(newFeature, 'propertychange', this.handleFeaturePropertyChange_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_26__["listen"])(geom, 'change', this.handleFeatureGeometryChange_, this));
    this.registerInteractions_();
    this.gmfSnapping_.ensureSnapInteractionsOnTop();

    if (this.featureId) {
      this.timeout_(function () {
        _this13.dirty = false;

        _this13.scope_.$apply();
      }, 0);
    }
  } else {
    this.featureId = undefined;
  }
};

Controller.prototype.handleFeaturePropertyChange_ = function () {
  this.dirty = true;
};

Controller.prototype.handleFeatureGeometryChange_ = function () {
  this.dirty = true;
  this.scope_.$apply();
};

Controller.prototype.handleMenuActionClick_ = function (evt) {
  var action = evt.detail.action;

  switch (action) {
    case 'move':
      if (!this.translate_) {
        throw new Error('Missing translate');
      }

      this.translate_.setActive(true);
      this.scope_.$apply();
      break;

    case 'rotate':
      if (!this.rotate_) {
        throw new Error('Missing rotate');
      }

      this.rotate_.setActive(true);
      this.scope_.$apply();
      break;

    default:
      break;
  }
};

Controller.prototype.handleMenuVertexActionClick_ = function (evt) {
  var action = evt.detail.action;

  switch (action) {
    case 'delete':
      if (!this.feature) {
        throw new Error('Missing feature');
      }

      if (!this.vertexInfo_) {
        throw new Error('Missing vertexInfo');
      }

      var feature = this.feature;
      var vertexInfo = this.vertexInfo_;
      this.ngeoFeatureHelper_.removeVertex(feature, vertexInfo);
      this.scope_.$apply();
      break;

    default:
      break;
  }
};

Controller.prototype.handleTranslateEnd_ = function (evt) {
  if (!this.translate_) {
    throw new Error('Missing translate');
  }

  this.translate_.setActive(false);
  this.scope_.$apply();
};

Controller.prototype.handleRotateEnd_ = function (evt) {
  if (!this.rotate_) {
    throw new Error('Missing rotate');
  }

  this.rotate_.setActive(false);
  this.scope_.$apply();
};

Controller.prototype.handleDestroy_ = function () {
  if (!this.features) {
    throw new Error('Missing features');
  }

  this.features.clear();
  this.handleFeatureChange_(null, this.feature);
  this.feature = null;
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_24__["getUid"])(this);
  this.ngeoEventHelper_.clearListenerKey(uid);
  this.toggle_(false);
  this.handleMapSelectActiveChange_(false);
  this.unregisterInteractions_();
};

module.controller('GmfEditfeatureController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/editing/editFeatureSelectorComponent.html":
/*!********************************************************************!*\
  !*** ./contribs/gmf/src/editing/editFeatureSelectorComponent.html ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n    ng-switch="efsCtrl.selectedEditableTreeCtrl">\n\n  <div ng-switch-when="null">\n    <select\n        class="form-control"\n        ng-model="efsCtrl.selectedEditableTreeCtrl"\n        ng-show="efsCtrl.editableTreeCtrls.length > 0"\n        ng-options="treeCtrl.node.name | translate for treeCtrl in efsCtrl.editableTreeCtrls">\n      <option value="" translate>-- Choose a layer --</option>\n    </select>\n    <span\n      ng-show="efsCtrl.editableTreeCtrls.length == 0"\n      translate>No editable layer available!</span>\n  </div>\n\n  <div ng-switch-default>\n    <div class="row">\n      <div class="col-sm-12">\n        <span translate>Currently editing: </span>\n        <b>{{ efsCtrl.selectedEditableTreeCtrl.node.name | translate }}</b>\n        <span class="fa fa-edit"></span>\n        <br>\n        <button\n            ng-click="efsCtrl.stopEditing()"\n            class="btn btn-link btn-sm pull-right">\n          <span class="fa fa-times"></span>\n          {{\'Stop editing\' | translate}}\n        </button>\n      </div>\n    </div>\n\n    <gmf-editfeature\n        gmf-editfeature-dirty="efsCtrl.dirty"\n        gmf-editfeature-editabletreectrl="::efsCtrl.selectedEditableTreeCtrl"\n        gmf-editfeature-map="::efsCtrl.map"\n        gmf-editfeature-state="efsCtrl.state"\n        gmf-editfeature-tolerance="::efsCtrl.tolerance"\n        gmf-editfeature-vector="::efsCtrl.vectorLayer"\n        gmf-editfeature-closeaftersave="::efsCtrl.closeAfterSave">\n    </gmf-editfeature>\n\n  </div>\n\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/editing/editFeatureSelectorComponent.js":
/*!******************************************************************!*\
  !*** ./contribs/gmf/src/editing/editFeatureSelectorComponent.js ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/editing/editFeatureComponent.js */ "./contribs/gmf/src/editing/editFeatureComponent.js");
/* harmony import */ var gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/layertree/TreeManager.js */ "./contribs/gmf/src/layertree/TreeManager.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
Controller.$inject = ["$scope", "$timeout", "gmfThemes", "gmfTreeManager"];




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('GmfEditingFeatureSelectorComponent', [gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/editing/editFeatureSelectorComponent', __webpack_require__(/*! ./editFeatureSelectorComponent.html */ "./contribs/gmf/src/editing/editFeatureSelectorComponent.html"));
}]);

function editingEditFeatureComponent() {
  return {
    controller: 'GmfEditfeatureselectorController as efsCtrl',
    scope: {
      'active': '=gmfEditfeatureselectorActive',
      'map': '<gmfEditfeatureselectorMap',
      'tolerance': '<?gmfEditfeatureselectorTolerance',
      'vectorLayer': '<gmfEditfeatureselectorVector',
      'selectedEditableTreeCtrl': '=?gmfEditfeatureselectorTree',
      'closeAfterSave': '=?gmfEditfeatureselectorCloseaftersave'
    },
    bindToController: true,
    templateUrl: 'gmf/editing/editFeatureSelectorComponent'
  };
}

module.directive('gmfEditfeatureselector', editingEditFeatureComponent);

function Controller($scope, $timeout, gmfThemes, gmfTreeManager) {
  var _this = this;

  this.active = this.active === true;
  $scope.$watch(function () {
    return _this.active;
  }, this.handleActiveChange_.bind(this));
  this.map = null;
  this.tolerance = null;
  this.vectorLayer = null;
  this.closeAfterSave = false;
  this.scope_ = $scope;
  this.$timeout_ = $timeout;
  this.gmfThemes_ = gmfThemes;
  this.gmfTreeManager_ = gmfTreeManager;

  var updateEditableTreeCtrls = function updateEditableTreeCtrls(value) {
    _this.$timeout_(function () {
      if (value) {
        var editables = _this.editableTreeCtrls;
        editables.length = 0;

        if (_this.gmfTreeManager_.rootCtrl) {
          _this.gmfTreeManager_.rootCtrl.traverseDepthFirst(function (treeCtrl) {
            var gmfLayer = treeCtrl.node;

            if (gmfLayer.editable) {
              editables.push(treeCtrl);
            }
          });
        }
      }
    }, 0);
  };

  this.treeCtrlsWatcherUnregister_ = $scope.$watchCollection(function () {
    if (gmfTreeManager.rootCtrl) {
      return gmfTreeManager.rootCtrl.children;
    }

    return [];
  }, updateEditableTreeCtrls);
  this.dirty = false;
  this.editableTreeCtrls = [];
  this.selectedEditableTreeCtrl = null;
  $scope.$watch(function () {
    return _this.selectedEditableTreeCtrl;
  }, function (newValue, oldValue) {
    _this.dirty = false;
    _this.state = gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__["EditingState"].IDLE;
  });
  this.state = gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__["EditingState"].IDLE;
  $scope.$watch(function () {
    return _this.state;
  }, function (newValue, oldValue) {
    if (newValue === gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__["EditingState"].STOP_EDITING_EXECUTE || newValue === gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__["EditingState"].DEACTIVATE_EXECUTE) {
      _this.selectedEditableTreeCtrl = null;
    }

    if (newValue === gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__["EditingState"].DEACTIVATE_EXECUTE) {
      _this.active = false;
    }
  });
  $scope.$on('$destroy', this.handleDestroy_.bind(this));
}

Controller.prototype.stopEditing = function () {
  this.state = gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_1__["EditingState"].STOP_EDITING_PENDING;
};

Controller.prototype.handleActiveChange_ = function (active) {
  var _this2 = this;

  if (!active) {
    if (!this.dirty) {
      this.stopEditing();
    } else {
      this.$timeout_(function () {
        _this2.active = true;

        _this2.stopEditing();
      });
    }
  }
};

Controller.prototype.handleDestroy_ = function () {
  this.treeCtrlsWatcherUnregister_();
};

module.controller('GmfEditfeatureselectorController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/editing/module.js":
/*!********************************************!*\
  !*** ./contribs/gmf/src/editing/module.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_editing_EditFeature_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/editing/EditFeature.js */ "./contribs/gmf/src/editing/EditFeature.js");
/* harmony import */ var gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/editing/editFeatureComponent.js */ "./contribs/gmf/src/editing/editFeatureComponent.js");
/* harmony import */ var gmf_editing_editFeatureSelectorComponent_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/editing/editFeatureSelectorComponent.js */ "./contribs/gmf/src/editing/editFeatureSelectorComponent.js");
/* harmony import */ var gmf_editing_EnumerateAttribute_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/editing/EnumerateAttribute.js */ "./contribs/gmf/src/editing/EnumerateAttribute.js");
/* harmony import */ var gmf_editing_Snapping_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/editing/Snapping.js */ "./contribs/gmf/src/editing/Snapping.js");
/* harmony import */ var gmf_editing_XSDAttributes_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! gmf/editing/XSDAttributes.js */ "./contribs/gmf/src/editing/XSDAttributes.js");







/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfEditingModule', [gmf_editing_EditFeature_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_editing_editFeatureComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_editing_editFeatureSelectorComponent_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, gmf_editing_EnumerateAttribute_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, gmf_editing_Snapping_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, gmf_editing_XSDAttributes_js__WEBPACK_IMPORTED_MODULE_6__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/filters/SavedFilters.js":
/*!**************************************************!*\
  !*** ./contribs/gmf/src/filters/SavedFilters.js ***!
  \**************************************************/
/*! exports provided: SavedFilter, SavedFilterItem, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SavedFilter", function() { return SavedFilter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SavedFilterItem", function() { return SavedFilterItem; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }



var SavedFilter = function () {
  SavedFilter.$inject = ["$rootScope"];

  function SavedFilter($rootScope) {
    var _this = this;

    this.rootScope_ = $rootScope;
    this.currentDataSourceId_ = null;
    this.currentDataSourceItems_ = [];
    this.localStorageKey_ = 'gmf_savedfilters';
    this.useLocalStorage_ = true;

    try {
      if ('localStorage' in window) {
        window.localStorage['test'] = '';
        delete window.localStorage['test'];
      } else {
        this.useLocalStorage_ = false;
      }
    } catch (err) {
      console.error(err);
      this.useLocalStorage_ = false;
    }

    this.items_ = [];
    this.rootScope_.$watchCollection(function () {
      return _this.items;
    }, function () {
      _this.rePopulateCurrentDataSourceItems_();
    });

    if (this.useLocalStorage_) {
      this.loadItemsFromLocalStorage_();
    }
  }

  var _proto = SavedFilter.prototype;

  _proto.loadItemsFromLocalStorage_ = function loadItemsFromLocalStorage_() {
    if (window.localStorage[this.localStorageKey_]) {
      var items = JSON.parse(window.localStorage[this.localStorageKey_]);

      if (!Array.isArray(items)) {
        throw new Error('Wrong items type');
      }

      this.items_ = items;
    }
  };

  _proto.indexOfItem = function indexOfItem(name, id) {
    var item;
    var idx = -1;

    for (var i = 0, ii = this.items_.length; i < ii; i++) {
      item = this.items[i];

      if (item.dataSourceId === id && item.name === name) {
        idx = i;
        break;
      }
    }

    return idx;
  };

  _proto.save = function save(item) {
    var idx = this.indexOfItem(item.name, item.dataSourceId);

    if (idx !== -1) {
      this.items[idx] = item;
    } else {
      this.items.push(item);
    }

    if (this.useLocalStorage_) {
      this.saveItemsInLocalStorage_();
    }
  };

  _proto.remove = function remove(item) {
    var found = Object(ol_array_js__WEBPACK_IMPORTED_MODULE_1__["remove"])(this.items, item);

    if (found && this.useLocalStorage_) {
      this.saveItemsInLocalStorage_();
    }
  };

  _proto.saveItemsInLocalStorage_ = function saveItemsInLocalStorage_() {
    window.localStorage[this.localStorageKey_] = JSON.stringify(this.items);
  };

  _proto.rePopulateCurrentDataSourceItems_ = function rePopulateCurrentDataSourceItems_() {
    this.currentDataSourceItems_.length = 0;

    if (this.currentDataSourceId_ !== null) {
      for (var _iterator = this.items, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
        var _ref;

        if (_isArray) {
          if (_i >= _iterator.length) break;
          _ref = _iterator[_i++];
        } else {
          _i = _iterator.next();
          if (_i.done) break;
          _ref = _i.value;
        }

        var item = _ref;

        if (item.dataSourceId === this.currentDataSourceId_) {
          this.currentDataSourceItems_.push(item);
        }
      }
    }
  };

  _createClass(SavedFilter, [{
    key: "currentDataSourceItems",
    get: function get() {
      return this.currentDataSourceItems_;
    }
  }, {
    key: "currentDataSourceId",
    set: function set(id) {
      this.currentDataSourceId_ = id;
      this.rePopulateCurrentDataSourceItems_();
    }
  }, {
    key: "items",
    get: function get() {
      return this.items_;
    }
  }]);

  return SavedFilter;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfSavedFilters', []);
module.service('gmfSavedFilters', SavedFilter);
function SavedFilterItem() {}
SavedFilterItem.prototype.condition;
SavedFilterItem.prototype.customRules;
SavedFilterItem.prototype.dataSourceId;
SavedFilterItem.prototype.directedRules;
SavedFilterItem.prototype.name;
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/filters/filterselectorComponent.js":
/*!*************************************************************!*\
  !*** ./contribs/gmf/src/filters/filterselectorComponent.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/authentication/Service.js */ "./contribs/gmf/src/authentication/Service.js");
/* harmony import */ var gmf_datasource_DataSourceBeingFiltered_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/datasource/DataSourceBeingFiltered.js */ "./contribs/gmf/src/datasource/DataSourceBeingFiltered.js");
/* harmony import */ var gmf_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/datasource/Helper.js */ "./contribs/gmf/src/datasource/Helper.js");
/* harmony import */ var gmf_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/datasource/OGC.js */ "./contribs/gmf/src/datasource/OGC.js");
/* harmony import */ var gmf_filters_SavedFilters_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! gmf/filters/SavedFilters.js */ "./contribs/gmf/src/filters/SavedFilters.js");
/* harmony import */ var ngeo_message_modalComponent_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/message/modalComponent.js */ "./src/message/modalComponent.js");
/* harmony import */ var ngeo_message_Notification_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/message/Notification.js */ "./src/message/Notification.js");
/* harmony import */ var ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/message/Message.js */ "./src/message/Message.js");
/* harmony import */ var ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/filter/RuleHelper.js */ "./src/filter/RuleHelper.js");
/* harmony import */ var ngeo_filter_component_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/filter/component.js */ "./src/filter/component.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");
















var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfFilterselector', [gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_datasource_DataSourceBeingFiltered_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, gmf_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_14__["default"].name, ngeo_message_Notification_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, ngeo_message_modalComponent_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_10__["default"].name, ngeo_filter_component_js__WEBPACK_IMPORTED_MODULE_11__["default"].name, gmf_filters_SavedFilters_js__WEBPACK_IMPORTED_MODULE_6__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/filters/filterselectorcomponent', __webpack_require__(/*! ./filterselectorcomponent.html */ "./contribs/gmf/src/filters/filterselectorcomponent.html"));
}]);
module.value('gmfFilterselectorTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.gmfFilterselectorTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'gmf/filters/filterselectorcomponent';
});
gmfFilterselectorTemplateUrl.$inject = ["$attrs", "gmfFilterselectorTemplateUrl"];

function gmfFilterselectorTemplateUrl($attrs, gmfFilterselectorTemplateUrl) {
  return gmfFilterselectorTemplateUrl($attrs);
}

var FilterSelectorController = function () {
  FilterSelectorController.$inject = ["$scope", "$timeout", "gettextCatalog", "gmfDataSourceBeingFiltered", "gmfDataSourcesHelper", "gmfSavedFilters", "gmfUser", "ngeoNotification", "ngeoFeatureOverlayMgr", "ngeoRuleHelper"];

  function FilterSelectorController($scope, $timeout, gettextCatalog, gmfDataSourceBeingFiltered, gmfDataSourcesHelper, gmfSavedFilters, gmfUser, ngeoNotification, ngeoFeatureOverlayMgr, ngeoRuleHelper) {
    var _this = this;

    this.active = false;
    this.map = null;
    this.toolGroup = null;
    this.timeout_ = $timeout;
    this.gettextCatalog_ = gettextCatalog;
    this.gmfDataSourceBeingFiltered = gmfDataSourceBeingFiltered;
    $scope.$watch(function () {
      return _this.gmfDataSourceBeingFiltered.dataSource;
    }, this.handleSelectedDataSourceChange_.bind(this));
    this.gmfDataSourcesHelper_ = gmfDataSourcesHelper;
    this.gmfSavedFilters = gmfSavedFilters;
    $scope.$watchCollection(function () {
      return _this.gmfSavedFilters.currentDataSourceItems;
    }, function () {
      if (_this.gmfSavedFilters.currentDataSourceItems.length === 0 && _this.saveFilterManageModalShown) {
        _this.saveFilterManageModalShown = false;
      }
    });
    this.gmfUser_ = gmfUser;
    $scope.$watch(function () {
      return _this.gmfUser_.functionalities;
    }, this.handleGmfUserFunctionalitiesChange_.bind(this));
    this.ngeoNotification_ = ngeoNotification;
    this.featureOverlay = ngeoFeatureOverlayMgr.getFeatureOverlay();
    this.ngeoRuleHelper_ = ngeoRuleHelper;
    this.aRuleIsActive = false;
    this.customRules = null;
    this.directedRules = null;
    this.filtrableDataSources = [];
    this.filtrableLayerNodeNames_ = null;
    this.gmfDataSources_ = gmfDataSourcesHelper.collection;
    this.listenerKeys_ = [];
    this.readyDataSource = null;
    this.ruleCache_ = {};
    this.saveFilterSaveModalShown = false;
    $scope.$watch(function () {
      return _this.saveFilterSaveModalShown;
    }, function () {
      _this.saveFilterName = '';
    });
    this.saveFilterName = '';
    this.saveFilterManageModalShown = false;
    this.enableDataSourceRegistration_ = false;
    $scope.$watch(function () {
      return _this.enableDataSourceRegistration_;
    }, this.handleEnableDataSourceRegistrationChange_.bind(this));
    this.defaultFiltrableDataSourceName_ = null;
    this.toggleDataSourceRegistration_();
  }

  var _proto = FilterSelectorController.prototype;

  _proto.handleGmfUserFunctionalitiesChange_ = function handleGmfUserFunctionalitiesChange_() {
    var usrFunc = this.gmfUser_.functionalities;

    if (usrFunc && usrFunc.filterable_layers) {
      this.filtrableLayerNodeNames_ = usrFunc.filterable_layers;
    } else {
      this.filtrableLayerNodeNames_ = null;
    }

    if (usrFunc && usrFunc.preset_layer_filter && usrFunc.preset_layer_filter[0]) {
      this.defaultFiltrableDataSourceName_ = usrFunc.preset_layer_filter[0];
    } else {
      this.defaultFiltrableDataSourceName_ = null;
    }

    this.toggleDataSourceRegistration_();
  };

  _proto.toggleDataSourceRegistration_ = function toggleDataSourceRegistration_() {
    var newDataSourceRegistration = !!this.filtrableLayerNodeNames_;

    if (this.enableDataSourceRegistration_ !== newDataSourceRegistration) {
      this.enableDataSourceRegistration_ = newDataSourceRegistration;
    }
  };

  _proto.handleEnableDataSourceRegistrationChange_ = function handleEnableDataSourceRegistrationChange_(register) {
    var keys = this.listenerKeys_;

    if (register) {
      keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_12__["listen"])(this.gmfDataSources_, 'add', this.handleDataSourcesAdd_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_12__["listen"])(this.gmfDataSources_, 'remove', this.handleDataSourcesRemove_, this));
      this.gmfDataSources_.forEach(this.registerDataSource_.bind(this));
    } else {
      keys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_12__["unlistenByKey"]);
      keys.length = 0;
      this.filtrableDataSources.length = 0;
    }
  };

  _proto.handleDataSourcesAdd_ = function handleDataSourcesAdd_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__["CollectionEvent"]) {
      var dataSource = evt.element;

      if (dataSource instanceof gmf_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
        this.registerDataSource_(dataSource);
      }
    }
  };

  _proto.handleDataSourcesRemove_ = function handleDataSourcesRemove_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__["CollectionEvent"]) {
      var dataSource = evt.element;

      if (dataSource instanceof gmf_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
        this.unregisterDataSource_(dataSource);
      }
    }
  };

  _proto.registerDataSource_ = function registerDataSource_(dataSource) {
    if (dataSource.filtrable === null) {
      dataSource.filtrable = this.isDataSourceFiltrable_(dataSource);
    }

    if (dataSource.filtrable) {
      this.filtrableDataSources.push(dataSource);

      if (this.defaultFiltrableDataSourceName_ !== undefined && dataSource.name === this.defaultFiltrableDataSourceName_) {
        this.gmfDataSourceBeingFiltered.dataSource = dataSource;
      }
    }
  };

  _proto.unregisterDataSource_ = function unregisterDataSource_(dataSource) {
    if (dataSource.filtrable) {
      Object(ol_array_js__WEBPACK_IMPORTED_MODULE_13__["remove"])(this.filtrableDataSources, dataSource);

      if (this.gmfDataSourceBeingFiltered.dataSource === dataSource) {
        this.gmfDataSourceBeingFiltered.dataSource = null;
      }
    }
  };

  _proto.isDataSourceFiltrable_ = function isDataSourceFiltrable_(dataSource, opt_notify) {
    if (!this.filtrableLayerNodeNames_) {
      throw new Error('Missing filtrableLayerNodeNames');
    }

    var filtrable = true;
    var gettext = this.gettextCatalog_;
    var notify = opt_notify !== false;
    var names = this.filtrableLayerNodeNames_;
    var msgs = [];

    if (names.includes(dataSource.name)) {
      if (!dataSource.supportsWFS) {
        msgs.push(gettext.getString('The data source doesn\'t support WFS, which is required ' + 'to fetch the attributes to build the filter rules.'));
      }

      if (!dataSource.wfsLayers || !dataSource.wfsLayers.length) {
        msgs.push(gettext.getString('The data source must have only 1 wfsLayer defined.'));
      } else if (!dataSource.wfsLayers[0].queryable) {
        msgs.push(gettext.getString('The wfsLayer within the data source must be queryable.'));
      }

      filtrable = !msgs.length;

      if (notify && !filtrable) {
        var p1 = gettext.getString("The following data source is marked as being filtrable,\n          but is missing some requirements: ");
        var p2 = dataSource.name + " (" + dataSource.id + ").";
        var p3 = gettext.getString("Please, contact your administrator about this.\n          Here are the reasons: ");
        msgs.unshift(p1 + " " + p2 + " " + p3);
        console.warn(msgs.join(' '));
        this.ngeoNotification_.notify({
          msg: msgs.join(' '),
          type: ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_9__["MessageType"].WARNING
        });
      }
    } else {
      filtrable = false;
    }

    return filtrable;
  };

  _proto.handleSelectedDataSourceChange_ = function handleSelectedDataSourceChange_(dataSource) {
    var _this2 = this;

    this.aRuleIsActive = false;
    this.customRules = null;
    this.directedRules = null;
    this.readyDataSource = null;
    this.gmfSavedFilters.currentDataSourceId = null;

    if (!dataSource) {
      return;
    }

    if (!this.active) {
      this.active = true;
    }

    this.gmfDataSourcesHelper_.prepareFiltrableDataSource(dataSource).then(function (dataSource) {
      var item = _this2.getRuleCacheItem_(dataSource);

      if (!item) {
        item = {
          customRules: [],
          directedRules: []
        };

        _this2.setRuleCacheItem_(dataSource, item);

        if (dataSource.gmfLayer.metadata && dataSource.gmfLayer.metadata.directedFilterAttributes && dataSource.gmfLayer.metadata.directedFilterAttributes.length) {
          var directedAttributes = dataSource.gmfLayer.metadata.directedFilterAttributes;
          var attributes = dataSource.attributes;

          for (var _iterator = attributes, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
            var _ref;

            if (_isArray) {
              if (_i >= _iterator.length) break;
              _ref = _iterator[_i++];
            } else {
              _i = _iterator.next();
              if (_i.done) break;
              _ref = _i.value;
            }

            var attribute = _ref;

            if (directedAttributes.includes(attribute.name)) {
              item.directedRules.push(_this2.ngeoRuleHelper_.createRuleFromAttribute(attribute));
            }
          }
        }
      }

      _this2.customRules = item.customRules;
      _this2.directedRules = item.directedRules;
      _this2.readyDataSource = dataSource;
      _this2.gmfSavedFilters.currentDataSourceId = dataSource.id;
    });
  };

  _proto.getRuleCacheItem_ = function getRuleCacheItem_(dataSource) {
    return this.ruleCache_[dataSource.id] || null;
  };

  _proto.setRuleCacheItem_ = function setRuleCacheItem_(dataSource, item) {
    this.ruleCache_[dataSource.id] = item;
  };

  _proto.saveFilterShowModal = function saveFilterShowModal() {
    this.saveFilterSaveModalShown = true;
  };

  _proto.saveFilterSave = function saveFilterSave() {
    if (!this.readyDataSource) {
      throw new Error('Missing readyDataSource');
    }

    var name = this.saveFilterName;
    var dataSource = this.readyDataSource;
    var dataSourceId = dataSource.id;
    var alreadyExist = this.gmfSavedFilters.indexOfItem(name, dataSourceId) !== -1;
    var condition = dataSource.filterCondition;
    var msg = this.gettextCatalog_.getString("A filter with the same name already exists.\n      Do you want to overwrite it?");

    if (!alreadyExist || confirm(msg)) {
      var customRules = this.customRules ? this.ngeoRuleHelper_.serializeRules(this.customRules) : [];
      var directedRules = this.directedRules ? this.ngeoRuleHelper_.serializeRules(this.directedRules) : [];
      var item = {
        condition: condition,
        customRules: customRules,
        dataSourceId: dataSourceId,
        directedRules: directedRules,
        name: name
      };
      this.gmfSavedFilters.save(item);
      this.saveFilterSaveModalShown = false;
    }
  };

  _proto.saveFilterLoadItem = function saveFilterLoadItem(filterItem) {
    var _this3 = this;

    if (!this.readyDataSource) {
      throw new Error('Missing readyDataSource');
    }

    var dataSource = this.readyDataSource;
    this.customRules = null;
    this.directedRules = null;
    var customRules = this.ngeoRuleHelper_.createRules(filterItem.customRules);
    var directedRules = this.ngeoRuleHelper_.createRules(filterItem.directedRules);
    this.timeout_(function () {
      _this3.customRules = customRules;
      _this3.directedRules = directedRules;
      dataSource.filterCondition = filterItem.condition;

      var cacheItem = _this3.getRuleCacheItem_(dataSource);

      if (!cacheItem) {
        throw new Error('Missing cacheItem');
      }

      cacheItem.customRules = customRules;
      cacheItem.directedRules = directedRules;
    });
  };

  _proto.saveFilterManage = function saveFilterManage() {
    this.saveFilterManageModalShown = true;
  };

  _proto.saveFilterRemoveItem = function saveFilterRemoveItem(item) {
    this.gmfSavedFilters.remove(item);
  };

  return FilterSelectorController;
}();

module.component('gmfFilterselector', {
  bindings: {
    active: '=',
    map: '<',
    toolGroup: '<',
    filterIsApplied: '='
  },
  controller: FilterSelectorController,
  templateUrl: gmfFilterselectorTemplateUrl
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/filters/filterselectorcomponent.html":
/*!***************************************************************!*\
  !*** ./contribs/gmf/src/filters/filterselectorcomponent.html ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n    class="form-group"\n    ng-switch="$ctrl.filtrableDataSources.length">\n  <span ng-switch-when="0" translate>No filtrable layer available!</span>\n  <select\n      class="form-control"\n      ng-disabled="$ctrl.aRuleIsActive"\n      ng-switch-default\n      ng-model="$ctrl.gmfDataSourceBeingFiltered.dataSource"\n      ng-options="dataSource.name | translate for dataSource in $ctrl.filtrableDataSources">\n    <option value="" translate>-- Layer to filter --</option>\n  </select>\n\n  <div ng-if="$ctrl.customRules && $ctrl.directedRules && $ctrl.readyDataSource">\n    <hr class="gmf-filterselector-separator" />\n\n    <div class="dropdown gmf-filterselector-savedfilters">\n      <button\n          class="btn btn-link dropdown-toggle ngeo-filter-condition-button"\n          ng-class="{disabled: $ctrl.aRuleIsActive || $ctrl.gmfSavedFilters.currentDataSourceItems.length === 0}"\n          type="button"\n          data-toggle="dropdown"\n          ng-disabled="$ctrl.aRuleIsActive || $ctrl.gmfSavedFilters.currentDataSourceItems.length === 0">\n        <span translate>Saved</span>\n      </button>\n      <ul class="dropdown-menu">\n        <li ng-repeat="item in $ctrl.gmfSavedFilters.currentDataSourceItems">\n          <a\n              href\n              ng-click="$ctrl.saveFilterLoadItem(item)">\n            <span>{{::item.name}}</span>\n          </a>\n        </li>\n        <li role="separator" class="divider"></li>\n        <li>\n          <a\n              href\n              ng-click="$ctrl.saveFilterManage()">\n            <span translate>Manage saved filters</span>\n          </a>\n        </li>\n      </ul>\n    </div>\n\n    <ngeo-filter\n        a-rule-is-active="$ctrl.aRuleIsActive"\n        custom-rules="$ctrl.customRules"\n        datasource="$ctrl.readyDataSource"\n        directed-rules="$ctrl.directedRules"\n        feature-overlay="$ctrl.featureOverlay"\n        filter-is-applied="$ctrl.filterIsApplied"\n        map="$ctrl.map"\n        tool-group="$ctrl.toolGroup">\n    </ngeo-filter>\n\n    <div>\n      <button\n          class="btn btn-link gmf-filterselector-savebtn"\n          type="button"\n          ng-click="!$ctrl.aRuleIsActive && $ctrl.saveFilterShowModal()"\n          ng-disabled="$ctrl.aRuleIsActive">\n        <span class="fa fa-save"></span>\n        <span translate>Save</span>\n      </button>\n    </div>\n  </div>\n\n  <ngeo-modal ng-model="$ctrl.saveFilterSaveModalShown">\n    <div class="modal-header ui-draggable-handle">\n      <h4 class="modal-title">{{\'Save filter\' | translate}}</h4>\n      <button\n          type="button"\n          class="close"\n          data-dismiss="modal"\n          aria-label="{{\'Close\' | translate}}">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    <div class="modal-body">\n      <p class="gmf-filterselector-savefilter-desc" translate>\n        You can save the filter that you created to re-load it later.\n      </p>\n      <input\n          type="text"\n          class="form-control"\n          name="name"\n          ng-model="$ctrl.saveFilterName"\n          placeholder="{{\'Filter name\' | translate}}" />\n    </div>\n    <div class="modal-footer">\n      <button\n          type="button"\n          class="btn btn-default"\n          data-dismiss="modal">{{\'Cancel\' | translate}}</button>\n      <button\n          type="button"\n          ng-click="$ctrl.saveFilterSave()"\n          ng-disabled="$ctrl.saveFilterName === \'\'"\n          class="btn prime">{{\'Save\' | translate}}</button>\n    </div>\n  </ngeo-modal>\n\n  <ngeo-modal ng-model="$ctrl.saveFilterManageModalShown">\n    <div class="gmf-filterselector-managefilter-modal">\n      <div class="modal-header ui-draggable-handle">\n        <h4 class="modal-title">{{\'Manage filters\' | translate}}</h4>\n        <button\n            type="button"\n            class="close"\n            data-dismiss="modal"\n            aria-label="{{\'Close\' | translate}}">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <ul>\n          <li ng-repeat="item in $ctrl.gmfSavedFilters.currentDataSourceItems">\n            <span>{{::item.name}}</span>\n            <a\n                href\n                ng-click="$ctrl.saveFilterRemoveItem(item)">\n                {{ \'Delete\' | translate }}\n            </a>\n            <div class="gmf-eol"></div>\n          </li>\n        </ul>\n      </div>\n      <div class="modal-footer">\n        <button\n            type="button"\n            class="btn btn-default"\n            data-dismiss="modal">{{\'Close\' | translate}}</button>\n      </div>\n    </div>\n  </ngeo-modal>\n\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/filters/module.js":
/*!********************************************!*\
  !*** ./contribs/gmf/src/filters/module.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_filters_filterselectorComponent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/filters/filterselectorComponent.js */ "./contribs/gmf/src/filters/filterselectorComponent.js");
/* harmony import */ var gmf_filters_SavedFilters_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/filters/SavedFilters.js */ "./contribs/gmf/src/filters/SavedFilters.js");



/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfFiltersModule', [gmf_filters_filterselectorComponent_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_filters_SavedFilters_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/icons/circle.svg":
/*!*******************************************!*\
  !*** ./contribs/gmf/src/icons/circle.svg ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"><path d=\"M1.14 8c0-1.242.308-2.383.92-3.432a6.837 6.837 0 012.496-2.496 6.684 6.684 0 013.432-.92c1.242 0 2.383.308 3.432.92a6.837 6.837 0 012.496 2.496c.612 1.049.92 2.19.92 3.432a6.68 6.68 0 01-.577 2.746c.409.444.651 1.039.593 1.653-.06 1.064-.956 2.022-2.028 2.09a2.254 2.254 0 01-1.591-.467 6.682 6.682 0 01-3.245.826 6.684 6.684 0 01-3.432-.92 6.837 6.837 0 01-2.496-2.496A6.684 6.684 0 011.14 8zm1.138 0c0 .772.15 1.51.453 2.215a5.707 5.707 0 001.216 1.81 5.816 5.816 0 001.826 1.217 5.533 5.533 0 002.215.468c.773-.001 1.51-.166 2.215-.468.11-.048.222-.104.328-.156-.003-.007-.014-.01-.016-.016a2.211 2.211 0 01-.156-.874c-.008-1.26 1.23-2.349 2.48-2.184.145.014.285.05.422.094.004.001.01-.002.015 0 .274-.67.421-1.373.421-2.106 0-.773-.164-1.511-.468-2.215a5.801 5.801 0 00-1.216-1.825 5.711 5.711 0 00-1.81-1.217 5.553 5.553 0 00-2.215-.453 5.53 5.53 0 00-2.215.453A5.805 5.805 0 003.947 3.96a5.786 5.786 0 00-1.216 1.825A5.543 5.543 0 002.278 8zm9.438 4.243a.784.784 0 00.11.421.97.97 0 00.046.078.873.873 0 00.203.203c.017.013.03.035.047.047.01.007.021.01.031.016a.779.779 0 00.811.062c.37-.159.579-.595.515-.983v-.015a.751.751 0 00-.172-.36.792.792 0 00-.156-.155c-.02-.015-.04-.018-.062-.031a.931.931 0 00-.11-.063c-.04-.017-.081-.035-.124-.047-.026-.007-.051-.01-.078-.015a1.078 1.078 0 00-.218-.016c.004-.006.011-.01.015-.015a.8.8 0 00-.561.234.874.874 0 00-.297.64z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/circle.svg?viewbox&height=1em":
/*!**************************************************************!*\
  !*** ./contribs/gmf/src/icons/circle.svg?viewbox&height=1em ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M1.14 8c0-1.242.308-2.383.92-3.432a6.837 6.837 0 012.496-2.496 6.684 6.684 0 013.432-.92c1.242 0 2.383.308 3.432.92a6.837 6.837 0 012.496 2.496c.612 1.049.92 2.19.92 3.432a6.68 6.68 0 01-.577 2.746c.409.444.651 1.039.593 1.653-.06 1.064-.956 2.022-2.028 2.09a2.254 2.254 0 01-1.591-.467 6.682 6.682 0 01-3.245.826 6.684 6.684 0 01-3.432-.92 6.837 6.837 0 01-2.496-2.496A6.684 6.684 0 011.14 8zm1.138 0c0 .772.15 1.51.453 2.215a5.707 5.707 0 001.216 1.81 5.816 5.816 0 001.826 1.217 5.533 5.533 0 002.215.468c.773-.001 1.51-.166 2.215-.468.11-.048.222-.104.328-.156-.003-.007-.014-.01-.016-.016a2.211 2.211 0 01-.156-.874c-.008-1.26 1.23-2.349 2.48-2.184.145.014.285.05.422.094.004.001.01-.002.015 0 .274-.67.421-1.373.421-2.106 0-.773-.164-1.511-.468-2.215a5.801 5.801 0 00-1.216-1.825 5.711 5.711 0 00-1.81-1.217 5.553 5.553 0 00-2.215-.453 5.53 5.53 0 00-2.215.453A5.805 5.805 0 003.947 3.96a5.786 5.786 0 00-1.216 1.825A5.543 5.543 0 002.278 8zm9.438 4.243a.784.784 0 00.11.421.97.97 0 00.046.078.873.873 0 00.203.203c.017.013.03.035.047.047.01.007.021.01.031.016a.779.779 0 00.811.062c.37-.159.579-.595.515-.983v-.015a.751.751 0 00-.172-.36.792.792 0 00-.156-.155c-.02-.015-.04-.018-.062-.031a.931.931 0 00-.11-.063c-.04-.017-.081-.035-.124-.047-.026-.007-.051-.01-.078-.015a1.078 1.078 0 00-.218-.016c.004-.006.011-.01.015-.015a.8.8 0 00-.561.234.874.874 0 00-.297.64z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/dot.svg?viewbox&height=1em":
/*!***********************************************************!*\
  !*** ./contribs/gmf/src/icons/dot.svg?viewbox&height=1em ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 13 13\" width=\"1em\" height=\"1em\"><path d=\"M6.458 9.63c-1.521.01-2.925-1.246-3.072-2.758-.156-1.27.533-2.603 1.689-3.162.984-.506 2.248-.454 3.16.184.962.642 1.542 1.84 1.371 2.998-.14 1.121-.921 2.14-1.986 2.53-.369.143-.765.217-1.162.209zm-.024-1.102c.997.052 1.949-.748 2.075-1.736.123-.849-.344-1.756-1.124-2.12-.811-.395-1.892-.181-2.453.538-.607.722-.619 1.88.011 2.592.366.433.921.715 1.491.726z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/layers.svg?viewbox&height=1em":
/*!**************************************************************!*\
  !*** ./contribs/gmf/src/icons/layers.svg?viewbox&height=1em ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" width=\"1em\" height=\"1em\"><path d=\"M19.984 6.256L10 1.264.016 6.256 10 11.248l9.984-4.992zM10 2.921l6.67 3.335L10 9.591 3.33 6.256 10 2.921zM17.984 9l2 .999L10 14.992.016 10l2-1L10 12.992zm0 3.743l2 1L10 18.736.016 13.744l2-1L10 16.736z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/line.svg":
/*!*****************************************!*\
  !*** ./contribs/gmf/src/icons/line.svg ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"><path d=\"M6.626.267C5.366.26 4.27 1.498 4.436 2.75c.109 1.153 1.216 2.129 2.384 2.017 1.064-.06 2.031-.96 2.1-2.031.1-.975-.497-1.977-1.424-2.313a2.198 2.198 0 00-.87-.155zm.046 1.364c.605-.03 1.095.7.819 1.244-.215.498-.93.71-1.353.344-.392-.3-.473-.94-.112-1.293.16-.18.4-.294.645-.295zM3.916 8.397c-1.256-.007-2.353 1.225-2.19 2.475.104 1.16 1.223 2.142 2.397 2.023 1.062-.066 2.019-.962 2.087-2.036.093-.932-.446-1.892-1.312-2.259a2.192 2.192 0 00-.983-.203zm.048 1.363c.612-.028 1.104.716.807 1.266-.228.493-.94.682-1.355.313-.377-.3-.457-.923-.106-1.276a.889.889 0 01.654-.303zm8.05 1.467c-1.25-.023-2.353 1.178-2.224 2.422.075 1.165 1.179 2.174 2.358 2.078 1.07-.043 2.05-.936 2.13-2.016.103-.936-.434-1.905-1.301-2.278-.301-.14-.631-.214-.963-.207zm.008 1.364c.615-.037 1.115.708.821 1.26-.217.478-.906.684-1.322.344-.424-.297-.5-.976-.113-1.332a.879.879 0 01.615-.272zm-6.81-2.163c-.143.417-.282.832-.434 1.245 1.92.67 3.84 1.333 5.755 2.011.153-.432.296-.863.455-1.293-1.92-.67-3.841-1.335-5.759-2.011l-.017.048zm.426-6.874C4.973 5.436 4.313 7.32 3.642 9.2c.432.15.863.302 1.292.458.668-1.899 1.336-3.798 2.012-5.694-.432-.15-.862-.301-1.29-.458l-.018.047z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/line.svg?viewbox&height=1em":
/*!************************************************************!*\
  !*** ./contribs/gmf/src/icons/line.svg?viewbox&height=1em ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M6.626.267C5.366.26 4.27 1.498 4.436 2.75c.109 1.153 1.216 2.129 2.384 2.017 1.064-.06 2.031-.96 2.1-2.031.1-.975-.497-1.977-1.424-2.313a2.198 2.198 0 00-.87-.155zm.046 1.364c.605-.03 1.095.7.819 1.244-.215.498-.93.71-1.353.344-.392-.3-.473-.94-.112-1.293.16-.18.4-.294.645-.295zM3.916 8.397c-1.256-.007-2.353 1.225-2.19 2.475.104 1.16 1.223 2.142 2.397 2.023 1.062-.066 2.019-.962 2.087-2.036.093-.932-.446-1.892-1.312-2.259a2.192 2.192 0 00-.983-.203zm.048 1.363c.612-.028 1.104.716.807 1.266-.228.493-.94.682-1.355.313-.377-.3-.457-.923-.106-1.276a.889.889 0 01.654-.303zm8.05 1.467c-1.25-.023-2.353 1.178-2.224 2.422.075 1.165 1.179 2.174 2.358 2.078 1.07-.043 2.05-.936 2.13-2.016.103-.936-.434-1.905-1.301-2.278-.301-.14-.631-.214-.963-.207zm.008 1.364c.615-.037 1.115.708.821 1.26-.217.478-.906.684-1.322.344-.424-.297-.5-.976-.113-1.332a.879.879 0 01.615-.272zm-6.81-2.163c-.143.417-.282.832-.434 1.245 1.92.67 3.84 1.333 5.755 2.011.153-.432.296-.863.455-1.293-1.92-.67-3.841-1.335-5.759-2.011l-.017.048zm.426-6.874C4.973 5.436 4.313 7.32 3.642 9.2c.432.15.863.302 1.292.458.668-1.899 1.336-3.798 2.012-5.694-.432-.15-.862-.301-1.29-.458l-.018.047z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/point.svg":
/*!******************************************!*\
  !*** ./contribs/gmf/src/icons/point.svg ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"><path d=\"M7.948 10.25c-1.26.009-2.349-1.23-2.184-2.48.11-1.153 1.218-2.124 2.387-2.013 1.064.06 2.022.956 2.09 2.028.1.975-.492 1.973-1.42 2.31a2.211 2.211 0 01-.873.155zm.047-1.357c.606.03 1.103-.703.827-1.248-.215-.499-.934-.709-1.357-.343-.393.3-.47.941-.11 1.295.16.18.395.295.64.296z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/point.svg?viewbox&height=1em":
/*!*************************************************************!*\
  !*** ./contribs/gmf/src/icons/point.svg?viewbox&height=1em ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M7.948 10.25c-1.26.009-2.349-1.23-2.184-2.48.11-1.153 1.218-2.124 2.387-2.013 1.064.06 2.022.956 2.09 2.028.1.975-.492 1.973-1.42 2.31a2.211 2.211 0 01-.873.155zm.047-1.357c.606.03 1.103-.703.827-1.248-.215-.499-.934-.709-1.357-.343-.393.3-.47.941-.11 1.295.16.18.395.295.64.296z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/polygon.svg":
/*!********************************************!*\
  !*** ./contribs/gmf/src/icons/polygon.svg ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"><path d=\"M5.045-.029c-1.26-.008-2.35 1.23-2.184 2.48.06.632.43 1.202.936 1.576-.479 1.358-.968 2.714-1.45 4.072-1.257-.008-2.363 1.23-2.2 2.48.105 1.16 1.228 2.13 2.402 2.012a2.295 2.295 0 001.45-.67c1.273.53 2.553 1.056 3.823 1.59a1.992 1.992 0 000 .438c.074 1.165 1.176 2.17 2.355 2.074 1.07-.042 2.057-.932 2.138-2.012a2.295 2.295 0 00-.453-1.607c.435-.593.873-1.186 1.31-1.778.186.04.369.047.562.031 1.067-.047 2.04-.935 2.122-2.012.11-.964-.464-1.959-1.373-2.31a2.202 2.202 0 00-.343-.108 444.27 444.27 0 01-.125-1.857c.743-.313 1.326-1.036 1.388-1.856.11-.964-.463-1.958-1.372-2.309a2.196 2.196 0 00-.92-.172c-.08 0-.158-.008-.235 0-.841.098-1.565.75-1.84 1.545-1.26-.004-2.53-.009-3.791-.016C7.045.918 6.564.361 5.919.127a2.211 2.211 0 00-.874-.156zm.047 1.357c.605-.03 1.103.704.827 1.248-.215.499-.934.71-1.358.343-.392-.299-.47-.94-.109-1.294a.874.874 0 01.64-.297zm8.08.063c.62-.026 1.099.719.796 1.263-.232.498-.967.692-1.373.297-.361-.308-.431-.939-.078-1.28a.899.899 0 01.656-.28zM7.246 2.919c1.257.005 2.517.024 3.775.032a2.333 2.333 0 001.622 1.513c.043.624.084 1.248.125 1.872-.877.376-1.511 1.322-1.388 2.293.042.482.267.94.592 1.295-.416.567-.826 1.136-1.248 1.7a2.045 2.045 0 00-.67-.109v.016c-.632-.012-1.235.287-1.654.748-1.26-.525-2.517-1.063-3.775-1.59.005-.043.013-.083.015-.126a2.274 2.274 0 00-.967-2.074c.472-1.342.944-2.685 1.42-4.025.052 0 .104.005.156 0 .898-.05 1.72-.7 1.997-1.545zm6.38 4.602c.62-.025 1.098.72.796 1.264-.233.497-.967.691-1.373.296-.362-.308-.432-.938-.078-1.279a.899.899 0 01.655-.28zM2.393 9.456c.612-.028 1.109.729.811 1.28-.228.493-.942.68-1.357.311-.377-.3-.46-.926-.11-1.28a.9.9 0 01.656-.311zm7.66 3.432c.615-.037 1.12.711.826 1.263-.217.48-.91.684-1.326.344-.423-.297-.495-.986-.109-1.342a.857.857 0 01.609-.265z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/polygon.svg?viewbox&height=1em":
/*!***************************************************************!*\
  !*** ./contribs/gmf/src/icons/polygon.svg?viewbox&height=1em ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M5.045-.029c-1.26-.008-2.35 1.23-2.184 2.48.06.632.43 1.202.936 1.576-.479 1.358-.968 2.714-1.45 4.072-1.257-.008-2.363 1.23-2.2 2.48.105 1.16 1.228 2.13 2.402 2.012a2.295 2.295 0 001.45-.67c1.273.53 2.553 1.056 3.823 1.59a1.992 1.992 0 000 .438c.074 1.165 1.176 2.17 2.355 2.074 1.07-.042 2.057-.932 2.138-2.012a2.295 2.295 0 00-.453-1.607c.435-.593.873-1.186 1.31-1.778.186.04.369.047.562.031 1.067-.047 2.04-.935 2.122-2.012.11-.964-.464-1.959-1.373-2.31a2.202 2.202 0 00-.343-.108 444.27 444.27 0 01-.125-1.857c.743-.313 1.326-1.036 1.388-1.856.11-.964-.463-1.958-1.372-2.309a2.196 2.196 0 00-.92-.172c-.08 0-.158-.008-.235 0-.841.098-1.565.75-1.84 1.545-1.26-.004-2.53-.009-3.791-.016C7.045.918 6.564.361 5.919.127a2.211 2.211 0 00-.874-.156zm.047 1.357c.605-.03 1.103.704.827 1.248-.215.499-.934.71-1.358.343-.392-.299-.47-.94-.109-1.294a.874.874 0 01.64-.297zm8.08.063c.62-.026 1.099.719.796 1.263-.232.498-.967.692-1.373.297-.361-.308-.431-.939-.078-1.28a.899.899 0 01.656-.28zM7.246 2.919c1.257.005 2.517.024 3.775.032a2.333 2.333 0 001.622 1.513c.043.624.084 1.248.125 1.872-.877.376-1.511 1.322-1.388 2.293.042.482.267.94.592 1.295-.416.567-.826 1.136-1.248 1.7a2.045 2.045 0 00-.67-.109v.016c-.632-.012-1.235.287-1.654.748-1.26-.525-2.517-1.063-3.775-1.59.005-.043.013-.083.015-.126a2.274 2.274 0 00-.967-2.074c.472-1.342.944-2.685 1.42-4.025.052 0 .104.005.156 0 .898-.05 1.72-.7 1.997-1.545zm6.38 4.602c.62-.025 1.098.72.796 1.264-.233.497-.967.691-1.373.296-.362-.308-.432-.938-.078-1.279a.899.899 0 01.655-.28zM2.393 9.456c.612-.028 1.109.729.811 1.28-.228.493-.942.68-1.357.311-.377-.3-.46-.926-.11-1.28a.9.9 0 01.656-.311zm7.66 3.432c.615-.037 1.12.711.826 1.263-.217.48-.91.684-1.326.344-.423-.297-.495-.986-.109-1.342a.857.857 0 01.609-.265z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/rectangle.svg":
/*!**********************************************!*\
  !*** ./contribs/gmf/src/icons/rectangle.svg ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"><path d=\"M2.317 14.491a2.203 2.203 0 01-.874-.156C.257 13.91-.343 12.38.242 11.262a2.265 2.265 0 011.28-1.139l-.016-4.258c-.02-.008-.042-.008-.063-.016C.258 5.424-.343 3.894.243 2.776.74 1.731 2.115 1.194 3.174 1.7c.572.246 1.007.747 1.217 1.326L11.6 3.01c.028-.077.055-.16.093-.234.5-1.045 1.874-1.582 2.933-1.076.979.422 1.584 1.59 1.28 2.62a2.302 2.302 0 01-1.467 1.576l.016 4.228c.057.02.115.035.171.062.979.422 1.584 1.59 1.28 2.621-.24.95-1.151 1.688-2.137 1.685a2.203 2.203 0 01-.874-.156c-.625-.224-1.083-.757-1.295-1.373l-7.207.015c-.302.864-1.151 1.516-2.075 1.513zm-.14-1.357c.508.052 1.045-.42.982-.951-.03-.542-.63-.978-1.154-.78-.472.146-.764.713-.547 1.17.089.223.27.413.5.499a.79.79 0 00.218.062zm11.45 0c.509.052 1.045-.42.982-.951-.03-.542-.63-.978-1.154-.78-.472.146-.764.713-.546 1.17.088.223.27.413.499.499a.79.79 0 00.218.062zM4.39 11.527l7.192-.015c.03-.084.067-.17.109-.25.259-.542.747-.944 1.31-1.139V5.88c-.036-.012-.073-.017-.109-.031-.628-.225-1.085-.768-1.295-1.388H4.407a2.334 2.334 0 01-1.42 1.435l.015 4.227c.056.02.118.037.172.063.576.248 1.009.757 1.217 1.342zm-2.215-6.88c.51.052 1.046-.42.983-.95-.03-.543-.63-.979-1.154-.781-.472.146-.764.714-.547 1.17.089.224.27.414.5.5a.79.79 0 00.218.062zm11.45 0c.51.052 1.046-.42.983-.95-.03-.543-.63-.979-1.154-.781-.472.146-.764.714-.546 1.17.088.224.27.414.499.5a.79.79 0 00.218.062z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/rectangle.svg?viewbox&height=1em":
/*!*****************************************************************!*\
  !*** ./contribs/gmf/src/icons/rectangle.svg?viewbox&height=1em ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M2.317 14.491a2.203 2.203 0 01-.874-.156C.257 13.91-.343 12.38.242 11.262a2.265 2.265 0 011.28-1.139l-.016-4.258c-.02-.008-.042-.008-.063-.016C.258 5.424-.343 3.894.243 2.776.74 1.731 2.115 1.194 3.174 1.7c.572.246 1.007.747 1.217 1.326L11.6 3.01c.028-.077.055-.16.093-.234.5-1.045 1.874-1.582 2.933-1.076.979.422 1.584 1.59 1.28 2.62a2.302 2.302 0 01-1.467 1.576l.016 4.228c.057.02.115.035.171.062.979.422 1.584 1.59 1.28 2.621-.24.95-1.151 1.688-2.137 1.685a2.203 2.203 0 01-.874-.156c-.625-.224-1.083-.757-1.295-1.373l-7.207.015c-.302.864-1.151 1.516-2.075 1.513zm-.14-1.357c.508.052 1.045-.42.982-.951-.03-.542-.63-.978-1.154-.78-.472.146-.764.713-.547 1.17.089.223.27.413.5.499a.79.79 0 00.218.062zm11.45 0c.509.052 1.045-.42.982-.951-.03-.542-.63-.978-1.154-.78-.472.146-.764.713-.546 1.17.088.223.27.413.499.499a.79.79 0 00.218.062zM4.39 11.527l7.192-.015c.03-.084.067-.17.109-.25.259-.542.747-.944 1.31-1.139V5.88c-.036-.012-.073-.017-.109-.031-.628-.225-1.085-.768-1.295-1.388H4.407a2.334 2.334 0 01-1.42 1.435l.015 4.227c.056.02.118.037.172.063.576.248 1.009.757 1.217 1.342zm-2.215-6.88c.51.052 1.046-.42.983-.95-.03-.543-.63-.979-1.154-.781-.472.146-.764.714-.547 1.17.089.224.27.414.5.5a.79.79 0 00.218.062zm11.45 0c.51.052 1.046-.42.983-.95-.03-.543-.63-.979-1.154-.781-.472.146-.764.714-.546 1.17.088.224.27.414.499.5a.79.79 0 00.218.062z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/search-go.svg?viewbox&height=1em":
/*!*****************************************************************!*\
  !*** ./contribs/gmf/src/icons/search-go.svg?viewbox&height=1em ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 15 15\" width=\"1em\" height=\"1em\"><path d=\"M5.111 0c-.692 0-1.358.138-1.99.407a5.076 5.076 0 00-1.625 1.089c-.458.457-.82.994-1.09 1.626A5.045 5.045 0 000 5.112C0 5.802.138 6.468.407 7.1a5.076 5.076 0 001.089 1.627c.457.457.994.82 1.626 1.089a5.045 5.045 0 001.99.406c1.064 0 2.022-.3 2.889-.9l2.497 2.483a.862.862 0 00.654.276c.251 0 .469-.092.653-.276a.893.893 0 00.276-.653.883.883 0 00-.261-.654L9.322 8.001c.324-.468.563-.956.712-1.481-.003-.034-.015-.07-.015-.102 0-.104.037-.211.058-.32h-.334c-.417 0-.941-.247-1.205-.551-.065-.075-.135-.154-.189-.247a3.103 3.103 0 01-.944 2.105c-.636.637-1.399.958-2.294.959-.895 0-1.657-.322-2.294-.959s-.958-1.399-.958-2.294.321-1.657.958-2.294 1.399-.959 2.294-.958c.895 0 1.658.322 2.294.958.315.315.567.653.726 1.03.024-.378.18-.769.407-1.03a1.78 1.78 0 01.857-.508 5.006 5.006 0 00-.668-.813A5.076 5.076 0 007.1.406 5.045 5.045 0 005.111 0zM15 4.182q0 .21-.143.353l-2.524 2.524q-.152.143-.353.143-.198 0-.35-.143l-.29-.291q-.147-.148-.147-.353t.147-.353l1.136-1.136h-2.73q-.2 0-.327-.145-.126-.146-.126-.351v-.496q0-.206.126-.351.126-.146.328-.146h2.729l-1.136-1.14q-.147-.139-.147-.348 0-.21.147-.35l.29-.29q.148-.147.35-.147.205 0 .353.147l2.524 2.524q.143.136.143.349z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/stack-indeterminate.svg?viewbox&height=1em":
/*!***************************************************************************!*\
  !*** ./contribs/gmf/src/icons/stack-indeterminate.svg?viewbox&height=1em ***!
  \***************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 13 13\" width=\"1em\" height=\"1em\"><path d=\"M6.513.614l-6.5 3.25 6.5 3.25 6.5-3.25-6.5-3.25zm0 1.078l4.342 2.172-4.342 2.172L2.17 3.864l4.343-2.172zm5.198 6.396l1.302.65-6.5 3.25-6.5-3.25 1.302-.65 5.198 2.6zM1.315 5.65l-1.302.651 2.114 1.057 1.3-.65zm10.396 0L9.599 6.708l1.302.651 2.112-1.058zM8.127 7.443l-1.614.807-1.136-.568-1.302.65 2.438 1.22 2.437-1.22-1.3-.65z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/icons/text.svg?viewbox&height=1em":
/*!************************************************************!*\
  !*** ./contribs/gmf/src/icons/text.svg?viewbox&height=1em ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M14.334 6.347v1.996h-1.997v4.649h-1.996V8.343H8.344V6.347h5.99zM1.666 3.008h8.674v1.997H7v7.987H5.004V5.005H1.666V3.008z\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/import/import.scss":
/*!*********************************************!*\
  !*** ./contribs/gmf/src/import/import.scss ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/import/importdatasourceComponent.html":
/*!****************************************************************!*\
  !*** ./contribs/gmf/src/import/importdatasourceComponent.html ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="form-group">\n  <select\n    class="form-control"\n    ng-model="$ctrl.mode"\n    ng-options="mode | translate for mode in $ctrl.modes"\n    ng-click="$ctrl.hasError = false">\n  </select>\n</div>\n\n<div>\n\n  <form\n    name="idsl_form"\n    novalidate\n    ng-show="$ctrl.mode === \'Local\'">\n    <div class="form-group">\n      <div class="input-group">\n        <div class="custom-file">\n          <input type="file" class="custom-file-input" required>\n          <label class="custom-file-label" translate>No file</label>\n        </div>\n      </div>\n    </div>\n    <div class="form-group">\n      <button\n        class="btn prime form-control"\n        ng-class="{\'has-error\': $ctrl.hasError}"\n        title="{{\'Load a file from local\' | translate}}"\n        type="submit"\n        ng-click="idsl_form.$valid && $ctrl.load()"\n        ng-disabled="$ctrl.file === undefined || $ctrl.hasError"\n      >\n        <span ng-if="!$ctrl.hasError">{{\'Load local file\' | translate}}</span>\n        <span ng-if="$ctrl.hasError">{{\'Unable to load the file\' | translate}}</span>\n      </button>\n    </div>\n  </form>\n\n  <form\n    name="idsc_form"\n    novalidate\n    ng-show="$ctrl.mode === \'Online\'">\n    <div class="form-group gmf-importdatasource-url-form-group">\n      <input\n        autocomplete="off"\n        class="form-control"\n        name="url"\n        placeholder="{{\'Choose or enter online resource URL\' | translate}}"\n        required\n        type="url"\n        ng-disabled="$ctrl.pending"\n        ng-model="$ctrl.url"\n      />\n    </div>\n    <div class="form-group">\n      <button\n        class="btn prime form-control gmf-importdatasource-connect-btn"\n        ng-class="{\'has-error\': $ctrl.hasError}"\n        title="{{\'Connect to online resource\' | translate}}"\n        type="submit"\n        ng-click="idsc_form.$valid && $ctrl.connect()"\n        ng-disabled="idsc_form.$invalid || $ctrl.pending"\n      >\n        <span\n          ng-if="$ctrl.pending"\n        >{{\'Connecting, please wait...\' | translate}}</span>\n        <span\n          ng-if="!$ctrl.pending && $ctrl.hasError"\n        >{{\'Failed to connect\' | translate}}</span>\n        <span\n          ng-if="!$ctrl.pending && !$ctrl.hasError"\n        >{{\'Connect\' | translate}}</span>\n      </button>\n    </div>\n  </form>\n\n</div>\n\n<div\n  class="gmf-importdatasource-layers"\n  ng-if="$ctrl.wmsCapabilities !== null || $ctrl.wmtsCapabilities !== null">\n  <hr />\n  <input\n    class="form-control"\n    placeholder="{{\'Search\' | translate}}"\n    ng-disabled="$ctrl.pending"\n    ng-model="$ctrl.searchText"\n    ng-model-options="{ debounce: 250 }"\n    ng-change="$ctrl.search()"\n  />\n  <gmf-wmscapabilitylayertreenode\n    capabilities="::$ctrl.wmsCapabilities"\n    layer="::$ctrl.wmsCapabilities.Capability.Layer"\n    url="::$ctrl.url"\n    ng-if="$ctrl.wmsCapabilities !== null">\n  </gmf-wmscapabilitylayertreenode>\n  <gmf-wmtscapabilitylayertree\n    capabilities="::$ctrl.wmtsCapabilities"\n    layers="::$ctrl.wmtsCapabilities.Contents.Layer"\n    url="::$ctrl.url"\n    ng-if="$ctrl.wmtsCapabilities !== null">\n  </gmf-wmtscapabilitylayertree>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/import/importdatasourceComponent.js":
/*!**************************************************************!*\
  !*** ./contribs/gmf/src/import/importdatasourceComponent.js ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/datasource/ExternalDataSourcesManager.js */ "./contribs/gmf/src/datasource/ExternalDataSourcesManager.js");
/* harmony import */ var gmf_import_wmsCapabilityLayertreeComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/import/wmsCapabilityLayertreeComponent.js */ "./contribs/gmf/src/import/wmsCapabilityLayertreeComponent.js");
/* harmony import */ var gmf_import_wmtsCapabilityLayertreeComponent_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/import/wmtsCapabilityLayertreeComponent.js */ "./contribs/gmf/src/import/wmtsCapabilityLayertreeComponent.js");
/* harmony import */ var ngeo_query_Querent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/query/Querent.js */ "./src/query/Querent.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }







var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfImportdatasource', [gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_import_wmsCapabilityLayertreeComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_import_wmtsCapabilityLayertreeComponent_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_query_Querent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/import/importdatasourceComponent', __webpack_require__(/*! ./importdatasourceComponent.html */ "./contribs/gmf/src/import/importdatasourceComponent.html"));
}]);
module.value('gmfImportdatasourceTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.gmfImportdatasourceTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'gmf/import/importdatasourceComponent';
});
gmfImportdatasourceTemplateUrl.$inject = ["$attrs", "gmfImportdatasourceTemplateUrl"];

function gmfImportdatasourceTemplateUrl($attrs, gmfImportdatasourceTemplateUrl) {
  return gmfImportdatasourceTemplateUrl($attrs);
}

var Mode = {
  LOCAL: 'Local',
  ONLINE: 'Online'
};

var Controller = function () {
  Controller.$inject = ["$element", "$filter", "$injector", "$scope", "$timeout", "gmfExternalDataSourcesManager", "ngeoQuerent"];

  function Controller($element, $filter, $injector, $scope, $timeout, gmfExternalDataSourcesManager, ngeoQuerent) {
    var _this = this;

    this.map = null;
    this.element_ = $element;
    this.scope_ = $scope;
    this.timeout_ = $timeout;
    this.gmfExternalDataSourcesManager_ = gmfExternalDataSourcesManager;
    this.ngeoQuerent_ = ngeoQuerent;
    this.file = null;
    this.searchText = null;
    this.url = null;
    this.fileInput_ = $element.find('input[type=file]');
    this.hasError = false;
    this.hasErrorPromise_ = null;
    this.mode = Mode.ONLINE;
    this.modes = [Mode.LOCAL, Mode.ONLINE];
    var gettextCatalog = $injector.get('gettextCatalog');
    gettextCatalog.getString('Local');
    gettextCatalog.getString('Online');
    this.pending = false;
    this.unitPrefixFormat_ = $filter('ngeoUnitPrefix');
    this.wmsCapabilities = null;
    this.wmtsCapabilities = null;
    this.serversEngine_ = null;
    var servers = $injector.has('gmfExternalOGCServers') ? $injector.get('gmfExternalOGCServers') : null;

    if (servers) {
      var serverUrls = servers.map(function (server) {
        return server.url;
      });
      this.serversEngine_ = new Bloodhound({
        datumTokenizer: function datumTokenizer(datum) {
          if (typeof datum != 'string') {
            throw new Error('Wrong datum type');
          }

          var originalDatumTokenizers = Bloodhound.tokenizers.whitespace(datum);

          if (!originalDatumTokenizers) {
            throw new Error('Missing originalDatumTokenizers');
          }

          var datumTokenizers = [];

          for (var _iterator = originalDatumTokenizers, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
            var _ref;

            if (_isArray) {
              if (_i >= _iterator.length) break;
              _ref = _iterator[_i++];
            } else {
              _i = _iterator.next();
              if (_i.done) break;
              _ref = _i.value;
            }

            var originalDatumTokenizer = _ref;
            var i = 0;

            while (i + 1 < originalDatumTokenizer.length) {
              datumTokenizers.push(originalDatumTokenizer.substr(i, originalDatumTokenizer.length));
              i++;
            }
          }

          return datumTokenizers;
        },
        queryTokenizer: Bloodhound.tokenizers.whitespace,
        local: serverUrls
      });
    }

    this.fileInput_.on('change', function () {
      var fileInput = _this.fileInput_[0];
      var files = fileInput.files;
      _this.file = files && files[0] ? files[0] : null;

      if (_this.file) {
        _this.hasError = false;
        $(fileInput).next('.custom-file-label').html(_this.fileNameAndSize);
      }

      _this.scope_.$apply();
    });
  }

  var _proto = Controller.prototype;

  _proto.$onInit = function $onInit() {
    var _this2 = this;

    this.gmfExternalDataSourcesManager_.map = this.map;

    if (this.serversEngine_) {
      var serversEngineWithDefaults = function serversEngineWithDefaults(query, sync) {
        if (!_this2.serversEngine_) {
          throw new Error('Missing serversEngine');
        }

        if (query === '') {
          sync(_this2.serversEngine_.all());
        } else {
          _this2.serversEngine_.search(query, sync);
        }
      };

      this.timeout_(function () {
        var $urlInput = _this2.element_.find('input[name=url]');

        var $connectBtn = _this2.element_.find('button.gmf-importdatasource-connect-btn');

        $urlInput.typeahead({
          hint: true,
          highlight: true,
          minLength: 0
        }, {
          name: 'url',
          source: serversEngineWithDefaults
        }).bind('typeahead:select', function (ev, suggestion) {
          _this2.timeout_(function () {
            _this2.url = suggestion;

            _this2.scope_.$apply();

            $connectBtn.focus();
          });
        });
      });
    }
  };

  _proto.connect = function connect() {
    var _this3 = this;

    if (!this.url) {
      throw new Error('Missing url');
    }

    var url = this.url;
    var serviceType = Object(ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_5__["guessServiceTypeByUrl"])(url);
    this.startWorking_();

    if (serviceType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_5__["Type"].WMS) {
      this.ngeoQuerent_.wmsGetCapabilities(url).then(function (wmsCapabilities) {
        _this3.wmsCapabilities = wmsCapabilities;

        _this3.stopWorking_();

        _this3.search();
      }, function () {
        _this3.stopWorking_(true);
      });
    } else if (serviceType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_5__["Type"].WMTS) {
      this.ngeoQuerent_.wmtsGetCapabilities(url).then(function (wmtsCapabilities) {
        _this3.wmtsCapabilities = wmtsCapabilities;

        _this3.stopWorking_();

        _this3.search();
      }, function () {
        _this3.stopWorking_(true);
      });
    } else {
      this.timeout_(function () {
        _this3.stopWorking_(true);
      });
    }
  };

  _proto.load = function load() {
    var _this4 = this;

    if (!this.file) {
      throw new Error('Missing file');
    }

    var file = this.file;
    this.gmfExternalDataSourcesManager_.createAndAddDataSourceFromFile(file, function (success) {
      if (!success) {
        _this4.hasError = true;
      }
    });
  };

  _proto.search = function search() {
    if (this.wmsCapabilities !== null) {
      this.filterLayer(this.wmsCapabilities.Capability.Layer);
    }

    if (this.wmtsCapabilities !== null) {
      for (var _iterator2 = this.wmtsCapabilities.Contents.Layer, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
        var _ref2;

        if (_isArray2) {
          if (_i2 >= _iterator2.length) break;
          _ref2 = _iterator2[_i2++];
        } else {
          _i2 = _iterator2.next();
          if (_i2.done) break;
          _ref2 = _i2.value;
        }

        var layer = _ref2;
        this.filterLayer(layer);
      }
    }
  };

  _proto.filterLayer = function filterLayer(layer, visible) {
    if (visible === void 0) {
      visible = false;
    }

    layer._visible = visible;
    layer._searchMatch = null;
    layer._expanded = false;

    if (!this.searchText) {
      layer._visible = true;
    } else {
      var index = layer.Title.toLowerCase().indexOf(this.searchText.toLowerCase());

      if (index >= 0) {
        layer._searchPrefix = layer.Title.substring(0, index);
        layer._searchMatch = layer.Title.substring(index, index + this.searchText.length);
        layer._searchSuffix = layer.Title.substring(index + this.searchText.length);
        layer._visible = true;
      }
    }

    var childVisible = false;

    if (layer.Layer !== undefined) {
      for (var _iterator3 = layer.Layer, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
        var _ref3;

        if (_isArray3) {
          if (_i3 >= _iterator3.length) break;
          _ref3 = _iterator3[_i3++];
        } else {
          _i3 = _iterator3.next();
          if (_i3.done) break;
          _ref3 = _i3.value;
        }

        var child = _ref3;
        this.filterLayer(child, layer._visible);

        if (child._visible) {
          childVisible = true;
        }

        if (child._expanded || child._searchMatch) {
          layer._expanded = true;
        }
      }
    }

    if (childVisible) {
      layer._visible = true;
    }
  };

  _proto.startWorking_ = function startWorking_() {
    this.pending = true;
    this.hasError = false;
    this.wmsCapabilities = null;
    this.wmtsCapabilities = null;
  };

  _proto.stopWorking_ = function stopWorking_(opt_hasError) {
    var _this5 = this;

    if (opt_hasError === void 0) {
      opt_hasError = false;
    }

    this.pending = false;

    if (opt_hasError) {
      this.hasError = true;

      if (this.hasErrorPromise_) {
        this.timeout_.cancel(this.hasErrorPromise_);
      }

      this.hasErrorPromise_ = this.timeout_(function () {
        _this5.hasError = false;
        _this5.hasErrorPromise_ = null;
      }, 3000);
    }
  };

  _createClass(Controller, [{
    key: "fileNameAndSize",
    get: function get() {
      if (!this.file) {
        return '';
      }

      var nameAndSize = '';
      var file = this.file;

      if (file !== undefined) {
        var fileSize = this.unitPrefixFormat_(file.size, 'o');
        nameAndSize = file.name + ", " + fileSize;
      }

      return nameAndSize;
    }
  }]);

  return Controller;
}();

module.component('gmfImportdatasource', {
  bindings: {
    'map': '<'
  },
  controller: Controller,
  templateUrl: gmfImportdatasourceTemplateUrl
});
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/import/module.js":
/*!*******************************************!*\
  !*** ./contribs/gmf/src/import/module.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_import_importdatasourceComponent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/import/importdatasourceComponent.js */ "./contribs/gmf/src/import/importdatasourceComponent.js");
/* harmony import */ var gmf_import_wmsCapabilityLayertreeComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/import/wmsCapabilityLayertreeComponent.js */ "./contribs/gmf/src/import/wmsCapabilityLayertreeComponent.js");
/* harmony import */ var gmf_import_wmtsCapabilityLayertreeComponent_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/import/wmtsCapabilityLayertreeComponent.js */ "./contribs/gmf/src/import/wmtsCapabilityLayertreeComponent.js");
/* harmony import */ var _import_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./import.scss */ "./contribs/gmf/src/import/import.scss");
/* harmony import */ var _import_scss__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_import_scss__WEBPACK_IMPORTED_MODULE_4__);





/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfImportModule', [gmf_import_importdatasourceComponent_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_import_wmsCapabilityLayertreeComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_import_wmtsCapabilityLayertreeComponent_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/import/wmsCapabilityLayertreeComponent.html":
/*!**********************************************************************!*\
  !*** ./contribs/gmf/src/import/wmsCapabilityLayertreeComponent.html ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<ul>\n  <li\n    ng-repeat="layer in ::$ctrl.layer.Layer"\n    ng-show="layer._visible"\n  >\n\n    <div\n      class="gmf-wmscapabilitylayertreenode-header"\n    >\n\n    <span\n      class="gmf-wmscapabilitylayertreenode-popover-container"\n      ng-if="::(layer.Name !== undefined || layer.Abstract !== undefined)"\n      ngeo-popover\n      ngeo-popover-dismiss=".content"\n      ngeo-popover-placement="left"\n    >\n\n      <span\n        ngeo-popover-anchor\n        class="fa fa-cog gmf-wmscapabilitylayertreenode-actions">\n      </span>\n\n      <div\n        class="gmf-wmscapabilitylayertreenode-popover-content"\n        ngeo-popover-content>\n        <ul>\n          <li\n              ng-if="::(layer.Name !== undefined)">\n            <i class="fa fa-plus fa-fw"></i>\n            <a\n              href=""\n              ng-click="$ctrl.createAndAddDataSource(layer); popoverCtrl.dismissPopover()"\n            >\n              <span translate>Add layer</span>\n            </a>\n          </li>\n          <li\n              ng-if="::(layer.Abstract !== undefined)">\n            <i class="fa fa-th-list fa-fw"></i>\n            <a\n              aria-expanded="false"\n              data-toggle="collapse"\n              href="#gmf-wmscapabilitylayertreenode-description-{{::$ctrl.getUid(layer)}}"\n              ng-click="popoverCtrl.dismissPopover()"\n            >\n              <span translate>Open/Close description</span>\n            </a>\n          </li>\n        </ul>\n      </div>\n    </span>\n\n    <a\n      aria-expanded="{{ layer._expanded }}"\n      class="fa gmf-wmscapabilitylayertreenode-expand-node fa-fw"\n      data-toggle="collapse"\n      href="#gmf-wmscapabilitylayertreenode-children-{{::$ctrl.getUid(layer)}}"\n      ng-if="::(layer.Layer !== undefined && layer.Layer.length)"\n    ></a>\n\n    <span\n      ng-if="::(layer.Layer !== undefined && layer.Layer.length)"\n      class="fa fa-fw gmf-wmscapabilitylayertreenode-group"\n    >' +
((__t = (__webpack_require__(/*! gmf/icons/layers.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/layers.svg?viewbox&height=1em"))) == null ? '' : __t) +
'</span>\n\n    <a\n      class="fa fa-circle-thin gmf-wmscapabilitylayertreenode-no-icon fa-fw "\n      ng-if="::(layer.Layer === undefined || layer.Layer.length === 0)"\n    ></a>\n\n    <span\n      class="gmf-wmscapabilitylayertreenode-title"\n      ng-if="!layer._searchMatch"\n    >{{ ::layer.Title }}</span>\n    <span\n      class="gmf-wmscapabilitylayertreenode-title"\n      ng-if="layer._searchMatch"\n    >{{ layer._searchPrefix }}<span class=highlight>{{ layer._searchMatch }}</span>{{ layer._searchSuffix }}</span>\n\n    <div\n      class="collapse gmf-wmscapabilitylayertreenode-description"\n      id="gmf-wmscapabilitylayertreenode-description-{{::$ctrl.getUid(layer)}}"\n      ng-if="::(layer.Abstract !== undefined)"\n    >\n      <a\n        aria-expanded="false"\n        class="gmf-wmscapabilitylayertreenode-description-toggle"\n        data-toggle="collapse"\n        href="#gmf-wmscapabilitylayertreenode-description-{{::$ctrl.getUid(layer)}}"\n        >\n        <span translate>Hide description</span>\n      </a>\n      <span\n        class="gmf-wmscapabilitylayertreenode-description-content"\n      >{{ ::layer.Abstract }}</span>\n    </div>\n\n    </div>\n\n    <gmf-wmscapabilitylayertreenode\n        class="collapse"\n        ng-class="layer._expanded ? \'show\' : \'\'"\n        id="gmf-wmscapabilitylayertreenode-children-{{::$ctrl.getUid(layer)}}"\n        capabilities="::$ctrl.capabilities"\n        layer="::layer"\n        ng-if="::(layer.Layer !== undefined)">\n    </gmf-wmscapabilitylayertreenode>\n  </li>\n</ul>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/import/wmsCapabilityLayertreeComponent.js":
/*!********************************************************************!*\
  !*** ./contribs/gmf/src/import/wmsCapabilityLayertreeComponent.js ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/datasource/ExternalDataSourcesManager.js */ "./contribs/gmf/src/datasource/ExternalDataSourcesManager.js");
/* harmony import */ var ngeo_message_Popup_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/message/Popup.js */ "./src/message/Popup.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var bootstrap_js_src_collapse_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! bootstrap/js/src/collapse.js */ "./node_modules/bootstrap/js/src/collapse.js");





var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfWmscapabilitylayertreenode', [gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_message_Popup_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/import/wmsCapabilityLayertreeComponent', __webpack_require__(/*! ./wmsCapabilityLayertreeComponent.html */ "./contribs/gmf/src/import/wmsCapabilityLayertreeComponent.html"));
}]);
module.value('gmfWmscapabilitylayertreenodeTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.gmfWmscapabilitylayertreenodeTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'gmf/import/wmsCapabilityLayertreeComponent';
});
gmfWmscapabilitylayertreenodeTemplateUrl.$inject = ["$attrs", "gmfWmscapabilitylayertreenodeTemplateUrl"];

function gmfWmscapabilitylayertreenodeTemplateUrl($attrs, gmfWmscapabilitylayertreenodeTemplateUrl) {
  return gmfWmscapabilitylayertreenodeTemplateUrl($attrs);
}

var Controller = function () {
  Controller.$inject = ["gmfExternalDataSourcesManager"];

  function Controller(gmfExternalDataSourcesManager) {
    this.capabilities = {};
    this.layer = {};
    this.url = null;
    this.gmfExternalDataSourcesManager_ = gmfExternalDataSourcesManager;
  }

  var _proto = Controller.prototype;

  _proto.createAndAddDataSource = function createAndAddDataSource(layer) {
    if (!this.url) {
      throw new Error('Missing url');
    }

    this.gmfExternalDataSourcesManager_.createAndAddDataSourceFromWMSCapability(layer, this.capabilities, this.url);
  };

  _proto.getUid = function getUid(layer) {
    return Object(ol_util_js__WEBPACK_IMPORTED_MODULE_3__["getUid"])(layer);
  };

  return Controller;
}();

module.component('gmfWmscapabilitylayertreenode', {
  bindings: {
    'capabilities': '<',
    'layer': '<',
    'url': '<'
  },
  controller: Controller,
  templateUrl: gmfWmscapabilitylayertreenodeTemplateUrl
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/import/wmtsCapabilityLayertreeComponent.html":
/*!***********************************************************************!*\
  !*** ./contribs/gmf/src/import/wmtsCapabilityLayertreeComponent.html ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<ul>\n  <li\n    ng-repeat="layer in ::$ctrl.layers"\n    ng-show="layer._visible"\n  >\n    <div\n      class="gmf-wmscapabilitylayertreenode-header"\n    >\n\n      <span\n        class="gmf-wmscapabilitylayertreenode-popover-container"\n        ngeo-popover\n        ngeo-popover-dismiss=".content"\n        ngeo-popover-placement="left"\n      >\n        <span\n          ngeo-popover-anchor\n          class="fa fa-cog gmf-wmscapabilitylayertreenode-actions">\n        </span>\n\n        <div\n          class="gmf-wmscapabilitylayertreenode-popover-content"\n          ngeo-popover-content\n        >\n          <ul>\n            <li>\n              <i class="fa fa-plus fa-fw"></i>\n              <a\n                href=""\n                ng-click="$ctrl.createAndAddDataSource(layer); popoverCtrl.dismissPopover()"\n              >\n                <span translate>Add layer</span>\n              </a>\n            </li>\n            <li\n              ng-if="::(layer.Abstract !== undefined)">\n              <i class="fa fa-th-list fa-fw"></i>\n              <a\n                aria-expanded="false"\n                data-toggle="collapse"\n                href="#gmf-wmscapabilitylayertreenode-description-{{::$ctrl.getUid(layer)}}"\n                ng-click="popoverCtrl.dismissPopover()"\n              >\n                <span translate>Open/Close description</span>\n              </a>\n            </li>\n          </ul>\n        </div>\n      </span>\n\n      <a class="fa fa-circle-thin gmf-wmscapabilitylayertreenode-no-icon fa-fw"></a>\n      <span\n        class="gmf-wmscapabilitylayertreenode-title"\n        ng-if="!layer._searchMatch"\n      >{{ ::layer.Title }}</span>\n      <span\n        class="gmf-wmscapabilitylayertreenode-title"\n        ng-if="layer._searchMatch"\n      >{{ layer._searchPrefix }}<span class=highlight>{{ layer._searchMatch }}</span>{{ layer._searchSuffix }}</span>\n\n      <div\n        class="collapse gmf-wmscapabilitylayertreenode-description"\n        id="gmf-wmscapabilitylayertreenode-description-{{::$ctrl.getUid(layer)}}"\n        ng-if="::(layer.Abstract !== undefined)"\n      >\n        <a\n          aria-expanded="false"\n          class="gmf-wmscapabilitylayertreenode-description-toggle"\n          data-toggle="collapse"\n          href="#gmf-wmscapabilitylayertreenode-description-{{::$ctrl.getUid(layer)}}"\n        >\n          <span translate>Hide description</span>\n        </a>\n        <span\n          class="gmf-wmscapabilitylayertreenode-description-content"\n        >{{ ::layer.Abstract }}</span>\n\n      </div>\n    </div>\n  </li>\n</ul>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/import/wmtsCapabilityLayertreeComponent.js":
/*!*********************************************************************!*\
  !*** ./contribs/gmf/src/import/wmtsCapabilityLayertreeComponent.js ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/datasource/ExternalDataSourcesManager.js */ "./contribs/gmf/src/datasource/ExternalDataSourcesManager.js");
/* harmony import */ var ngeo_message_Popup_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/message/Popup.js */ "./src/message/Popup.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfWmtscapabilitylayertree', [gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_message_Popup_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/import/wmtsCapabilityLayertreeComponent', __webpack_require__(/*! ./wmtsCapabilityLayertreeComponent.html */ "./contribs/gmf/src/import/wmtsCapabilityLayertreeComponent.html"));
}]);
module.value('gmfWmtscapabilitylayertreTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.gmfWmtscapabilitylayertreTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'ngeo/import/wmtsCapabilityLayertreeComponent';
});
gmfWmtscapabilitylayertreTemplateUrl.$inject = ["$attrs", "gmfWmtscapabilitylayertreTemplateUrl"];

function gmfWmtscapabilitylayertreTemplateUrl($attrs, gmfWmtscapabilitylayertreTemplateUrl) {
  return gmfWmtscapabilitylayertreTemplateUrl($attrs);
}

var Controller = function () {
  Controller.$inject = ["gmfExternalDataSourcesManager"];

  function Controller(gmfExternalDataSourcesManager) {
    this.capabilities = {};
    this.layers = [];
    this.url = null;
    this.gmfExternalDataSourcesManager_ = gmfExternalDataSourcesManager;
  }

  var _proto = Controller.prototype;

  _proto.createAndAddDataSource = function createAndAddDataSource(layer) {
    if (!this.url) {
      throw new Error('Missing url');
    }

    var manager = this.gmfExternalDataSourcesManager_;
    manager.createAndAddDataSourceFromWMTSCapability(layer, this.capabilities, this.url);
  };

  _proto.getUid = function getUid(layer) {
    return Object(ol_util_js__WEBPACK_IMPORTED_MODULE_3__["getUid"])(layer);
  };

  return Controller;
}();

module.component('gmfWmtscapabilitylayertree', {
  bindings: {
    'capabilities': '<',
    'layers': '<',
    'url': '<'
  },
  controller: Controller,
  templateUrl: gmfWmtscapabilitylayertreTemplateUrl
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/index.js":
/*!***********************************!*\
  !*** ./contribs/gmf/src/index.js ***!
  \***********************************/
/*! exports provided: DATALAYERGROUP_NAME, EXTERNALLAYERGROUP_NAME, COORDINATES_LAYER_NAME, PermalinkParam */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DATALAYERGROUP_NAME", function() { return DATALAYERGROUP_NAME; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EXTERNALLAYERGROUP_NAME", function() { return EXTERNALLAYERGROUP_NAME; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "COORDINATES_LAYER_NAME", function() { return COORDINATES_LAYER_NAME; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PermalinkParam", function() { return PermalinkParam; });
var DATALAYERGROUP_NAME = 'data';
var EXTERNALLAYERGROUP_NAME = 'external';
var COORDINATES_LAYER_NAME = 'gmfCoordinatesLayerName';
var PermalinkParam = {
  BG_LAYER: 'baselayer_ref',
  BG_LAYER_OPACITY: 'baselayer_opacity',
  EXTERNAL_DATASOURCES_NAMES: 'eds_n',
  EXTERNAL_DATASOURCES_URLS: 'eds_u',
  FEATURES: 'rl_features',
  MAP_CROSSHAIR: 'map_crosshair',
  MAP_SWIPE: 'map_swipe',
  MAP_SWIPE_VALUE: 'map_swipe_value',
  MAP_TOOLTIP: 'map_tooltip',
  MAP_X: 'map_x',
  MAP_Y: 'map_y',
  MAP_Z: 'map_zoom',
  TREE_GROUPS: 'tree_groups',
  WFS_LAYER: 'wfs_layer',
  WFS_NGROUPS: 'wfs_ngroups',
  WFS_SHOW_FEATURES: 'wfs_showFeatures'
};

/***/ }),

/***/ "./contribs/gmf/src/layertree/SyncLayertreeMap.js":
/*!********************************************************!*\
  !*** ./contribs/gmf/src/layertree/SyncLayertreeMap.js ***!
  \********************************************************/
/*! exports provided: SyncLayertreeMap, getLayer, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SyncLayertreeMap", function() { return SyncLayertreeMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getLayer", function() { return getLayer; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/layertree/Controller.js */ "./src/layertree/Controller.js");
/* harmony import */ var ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/misc/WMSTime.js */ "./src/misc/WMSTime.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/layer/Image.js */ "./node_modules/ol/layer/Image.js");
/* harmony import */ var ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/layer/Tile.js */ "./node_modules/ol/layer/Tile.js");
/* harmony import */ var ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/layer/Group.js */ "./node_modules/ol/layer/Group.js");
SyncLayertreeMap.$inject = ["$rootScope", "ngeoLayerHelper", "ngeoWMSTime", "gmfThemes"];








function SyncLayertreeMap($rootScope, ngeoLayerHelper, ngeoWMSTime, gmfThemes) {
  var _this = this;

  this.layerHelper_ = ngeoLayerHelper;
  this.ngeoWMSTime_ = ngeoWMSTime;
  this.ogcServersObject_ = null;
  gmfThemes.getOgcServersObject().then(function (ogcServersObject) {
    _this.ogcServersObject_ = ogcServersObject;
  });
  $rootScope.$on('ngeo-layertree-state', function (map, treeCtrl, firstParent) {
    _this.sync_(firstParent);
  });
}

SyncLayertreeMap.prototype.createLayer = function (treeCtrl, map, dataLayerGroup, opt_position) {
  var layer = null;
  var gmfGroup = treeCtrl.node;
  var gmfParentGroup = treeCtrl.parent.node;

  if (gmfGroup.children !== undefined && gmfGroup.mixed) {
    layer = this.createGroup_(treeCtrl, map, dataLayerGroup, opt_position);
  } else if (gmfGroup.children === undefined && gmfParentGroup.mixed) {
    layer = this.createLeafInAMixedGroup_(treeCtrl, map);
  } else if (gmfGroup.children === undefined) {
    this.initGmfLayerInANotMixedGroup_(treeCtrl, map);
  } else if (treeCtrl.depth === 1 && !gmfGroup.mixed) {
    layer = this.createGroup_(treeCtrl, map, dataLayerGroup, opt_position);
  }

  if (layer && treeCtrl.node.metadata.opacity) {
    layer.setOpacity(treeCtrl.node.metadata.opacity);
  }

  return layer;
};

SyncLayertreeMap.prototype.sync_ = function (treeCtrl) {
  var _this2 = this;

  treeCtrl.traverseDepthFirst(function (treeCtrl) {
    var gmfGroup = treeCtrl.node;

    if (treeCtrl.layer && !gmfGroup.mixed) {
      _this2.updateLayerState_(treeCtrl.layer, treeCtrl);

      return ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_2__["LayertreeVisitorDecision"].DESCEND;
    }
  });
};

SyncLayertreeMap.prototype.updateLayerState_ = function (layer, treeCtrl) {
  var gmfGroup = treeCtrl.node;
  var gmfLayer = treeCtrl.node;
  var active = treeCtrl.getState() === 'on';

  if (gmfLayer.type === 'WMTS') {
    layer.setVisible(active);
  } else if (!gmfGroup.mixed && treeCtrl.depth === 1) {
    if (!(layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_5__["default"])) {
      throw new Error('Wrong dataSource type');
    }

    var names = [];
    var styles = [];
    treeCtrl.traverseDepthFirst(function (treeCtrl) {
      var gmfGroup = treeCtrl.node;

      if (gmfGroup.children === undefined && treeCtrl.getState() === 'on') {
        var gmfLayerWMS = treeCtrl.node;
        names.push(gmfLayerWMS.layers);
        var style = gmfLayerWMS.style !== undefined ? gmfLayerWMS.style : '';
        styles.push(style);
        return ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_2__["LayertreeVisitorDecision"].DESCEND;
      }
    });

    if (names.length === 0) {
      layer.setVisible(false);
    }

    layer.getSource().updateParams({
      'LAYERS': names.reverse().join(','),
      'STYLES': styles.reverse().join(',')
    });

    if (names.length !== 0) {
      layer.setVisible(true);
    }
  } else {
    if (!(layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_5__["default"])) {
      throw new Error('Wrong dataSource type');
    }

    layer.setVisible(active);
  }
};

SyncLayertreeMap.prototype.createGroup_ = function (treeCtrl, map, dataLayerGroup, opt_position) {
  var groupNode = treeCtrl.node;
  var layer = null;
  var isFirstLevelGroup = treeCtrl.parent.isRoot;
  var printNativeAngle = true;

  if (groupNode.metadata.printNativeAngle !== undefined) {
    printNativeAngle = groupNode.metadata.printNativeAngle;
  }

  if (isFirstLevelGroup) {
    layer = this.createLayerFromGroup_(treeCtrl, !!groupNode.mixed);
    var position = opt_position || 0;
    dataLayerGroup.getLayers().insertAt(position, layer);
  } else {
    var inAMixedGroup = !this.isOneParentNotMixed_(treeCtrl);

    if (inAMixedGroup) {
      layer = this.createLayerFromGroup_(treeCtrl, true);
      var layerGroup = getLayer(treeCtrl.parent);

      if (!(layerGroup instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_7__["default"])) {
        throw new Error('Wrong layerGroup type');
      }

      layerGroup.getLayers().insertAt(0, layer);
    }
  }

  if (!layer) {
    throw new Error('Missing layer');
  }

  layer.set('printNativeAngle', printNativeAngle);
  return layer;
};

SyncLayertreeMap.prototype.createLayerFromGroup_ = function (treeCtrl, mixed) {
  var _this3 = this;

  var layer;
  var groupNode = treeCtrl.node;

  if (mixed) {
    layer = this.layerHelper_.createBasicGroup();
  } else {
    if (!this.ogcServersObject_) {
      throw new Error('Missing ogcServersObject');
    }

    var timeParam = this.getTimeParam_(treeCtrl);
    var ogcServer = this.ogcServersObject_[groupNode.ogcServer || ''];

    if (!ogcServer) {
      throw new Error('Missing ogcServer');
    }

    if (!ogcServer.url) {
      throw new Error('Missing ogcServer.url');
    }

    if (!ogcServer.type) {
      throw new Error('Missing ogcServer.type');
    }

    if (!ogcServer.imageType) {
      throw new Error('Missing ogcServer.imageType');
    }

    layer = this.layerHelper_.createBasicWMSLayer(ogcServer.url, '', ogcServer.imageType, ogcServer.type, timeParam, undefined, ogcServer.credential ? 'use-credentials' : 'anonymous');
    layer.set('dataSourceId', groupNode.id);
    var hasActiveChildren = false;
    treeCtrl.traverseDepthFirst(function (ctrl) {
      _this3.updateLayerReferences_(ctrl.node, layer);

      if (ctrl.node.metadata.isChecked) {
        ctrl.setState('on', false);

        _this3.updateLayerState_(layer, ctrl);

        hasActiveChildren = true;
        return ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_2__["LayertreeVisitorDecision"].DESCEND;
      }
    });
    layer.setVisible(hasActiveChildren);
    layer.set('layerNodeName', groupNode.name);
  }

  return layer;
};

SyncLayertreeMap.prototype.createLeafInAMixedGroup_ = function (treeCtrl, map) {
  var gmfLayer = treeCtrl.node;
  var layer;

  if (gmfLayer.type === 'WMTS') {
    layer = this.createWMTSLayer_(gmfLayer);
  } else {
    if (!this.ogcServersObject_) {
      throw new Error('Missing ogcServersObject');
    }

    var gmfLayerWMS = gmfLayer;
    var timeParam = this.getTimeParam_(treeCtrl);
    var ogcServer = this.ogcServersObject_[gmfLayerWMS.ogcServer];

    if (!ogcServer) {
      throw new Error('Missing ogcServer');
    }

    if (!ogcServer.url) {
      throw new Error('Missing ogcServer.url');
    }

    if (!ogcServer.type) {
      throw new Error('Missing ogcServer.type');
    }

    if (!ogcServer.imageType) {
      throw new Error('Missing ogcServer.imageType');
    }

    if (!gmfLayerWMS.layers) {
      throw new Error('Missing gmfLayerWMS.layers');
    }

    var opt_params = {
      STYLES: gmfLayerWMS.style
    };
    layer = this.layerHelper_.createBasicWMSLayer(ogcServer.url, gmfLayerWMS.layers, ogcServer.imageType, ogcServer.type, timeParam, opt_params, ogcServer.credential ? 'use-credentials' : 'anonymous');
  }

  layer.set('dataSourceId', gmfLayer.id);
  layer.set('layerNodeName', gmfLayer.name);
  this.updateLayerReferences_(gmfLayer, layer);
  var checked = gmfLayer.metadata.isChecked === true;

  if (checked) {
    treeCtrl.setState('on', false);
  }

  layer.setVisible(checked);
  var layerGroup = getLayer(treeCtrl.parent);
  layerGroup.getLayers().insertAt(0, layer);
  return layer;
};

SyncLayertreeMap.prototype.initGmfLayerInANotMixedGroup_ = function (treeCtrl, map) {
  var leafNode = treeCtrl.node;
  var firstLevelGroup = this.getFirstLevelGroupCtrl_(treeCtrl);

  if (!firstLevelGroup) {
    throw new Error('Missing firstLevelGroup');
  }

  var layer = firstLevelGroup.layer;

  if (!(layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_5__["default"])) {
    throw new Error('Wrong layer type');
  }

  if (!(layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_5__["default"])) {
    throw new Error('Wrong dataSource type');
  }

  this.updateLayerReferences_(leafNode, layer);

  if (leafNode.metadata.isChecked) {
    treeCtrl.setState('on', false);
    this.updateLayerState_(layer, firstLevelGroup);
  } else {
    treeCtrl.parent.refreshState();
  }
};

SyncLayertreeMap.prototype.createWMTSLayer_ = function (gmfLayerWMTS) {
  var newLayer = new ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_6__["default"]();

  if (!gmfLayerWMTS.url) {
    throw new Error('Missing gmfLayerWMTS.url');
  }

  if (!gmfLayerWMTS.layer) {
    throw new Error('Missing gmfLayerWMTS.layer');
  }

  var minResolution = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_1__["getNodeMinResolution"])(gmfLayerWMTS);
  var maxResolution = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_1__["getNodeMaxResolution"])(gmfLayerWMTS);
  this.layerHelper_.createWMTSLayerFromCapabilitites(gmfLayerWMTS.url, gmfLayerWMTS.layer, gmfLayerWMTS.matrixSet, gmfLayerWMTS.dimensions, undefined, minResolution, maxResolution).then(function (layer) {
    newLayer.setProperties(layer.getProperties());
  });
  return newLayer;
};

SyncLayertreeMap.prototype.updateLayerReferences_ = function (leafNode, layer) {
  var id = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_4__["getUid"])(leafNode);
  var querySourceIds = layer.get('querySourceIds') || [];
  querySourceIds.push(id);
  layer.set('querySourceIds', querySourceIds);
  var disclaimer = leafNode.metadata.disclaimer;

  if (disclaimer) {
    var disclaimers = layer.get('disclaimers') || {};
    var layers = 'all';

    if ('layers' in leafNode) {
      layers = leafNode.layers;
    }

    disclaimers[layers] = leafNode.metadata.disclaimer;
    layer.set('disclaimers', disclaimers);
  }
};

SyncLayertreeMap.prototype.getTimeParam_ = function (treeCtrl) {
  var wmsTime;
  var timeParam;
  var node = treeCtrl.node;

  if (node.time) {
    wmsTime = node.time;
  } else if (node.children) {
    treeCtrl.traverseDepthFirst(function (treeCtrl) {
      var node = treeCtrl.node;

      if (node.children === undefined && node.time) {
        wmsTime = node.time;
        return ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_2__["LayertreeVisitorDecision"].STOP;
      }
    });
  }

  if (wmsTime) {
    var options = this.ngeoWMSTime_.getOptions(wmsTime);
    var timeValue = options.values;
    var timeValues = options.values;
    timeParam = this.ngeoWMSTime_.formatWMSTimeParam(wmsTime, {
      start: timeValues[0] || timeValue,
      end: timeValues[1]
    });
  }

  return timeParam;
};

SyncLayertreeMap.prototype.isOneParentNotMixed_ = function (treeCtrl) {
  var tree = treeCtrl.parent;
  var isOneParentNotMix = false;

  do {
    var gmfGroup = tree.node;
    isOneParentNotMix = gmfGroup.mixed === false;
    tree = tree.parent;
  } while (tree.parent && !isOneParentNotMix);

  return isOneParentNotMix;
};

SyncLayertreeMap.prototype.getFirstLevelGroupCtrl_ = function (treeCtrl) {
  var tree = treeCtrl;

  while (!tree.parent.isRoot) {
    tree = tree.parent;
  }

  return tree;
};

function getLayer(treeCtrl) {
  var tree = treeCtrl;
  var layer = null;

  while (!tree.isRoot && layer === null) {
    if (tree.layer) {
      layer = tree.layer;
    }

    tree = tree.parent;
  }

  if (!layer) {
    throw new Error('Missing layer');
  }

  return layer;
}
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfSyncLayertreeMap', [gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]);
module.service('gmfSyncLayertreeMap', SyncLayertreeMap);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/layertree/TreeManager.js":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/layertree/TreeManager.js ***!
  \***************************************************/
/*! exports provided: LayertreeTreeManager, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayertreeTreeManager", function() { return LayertreeTreeManager; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/index.js */ "./contribs/gmf/src/index.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/layertree/Controller.js */ "./src/layertree/Controller.js");
/* harmony import */ var ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/message/Message.js */ "./src/message/Message.js");
/* harmony import */ var ngeo_message_Notification_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/message/Notification.js */ "./src/message/Notification.js");
/* harmony import */ var ngeo_statemanager_Service_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/statemanager/Service.js */ "./src/statemanager/Service.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
LayertreeTreeManager.$inject = ["$timeout", "$injector", "gettextCatalog", "ngeoLayerHelper", "ngeoNotification", "gmfThemes", "ngeoStateManager"];








function LayertreeTreeManager($timeout, $injector, gettextCatalog, ngeoLayerHelper, ngeoNotification, gmfThemes, ngeoStateManager) {
  this.$timeout_ = $timeout;
  this.$injector_ = $injector;
  this.gettextCatalog_ = gettextCatalog;
  this.layerHelper_ = ngeoLayerHelper;
  this.ngeoNotification_ = ngeoNotification;
  this.gmfThemes_ = gmfThemes;
  this.root = {
    children: []
  };
  this.rootCtrl = null;
  this.numberOfGroupsToAddInThisDigestLoop = 0;
  this.groupsToAddInThisDigestLoop_ = [];
  this.promiseForGroupsToAddInThisDigestLoop_ = null;
  this.ngeoStateManager_ = ngeoStateManager;
  this.initialLevelFirstGroups_ = undefined;
  this.ogcServers_ = null;
  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_7__["listen"])(this.gmfThemes_, 'change', this.handleThemesChange_, this);
}

LayertreeTreeManager.prototype.handleThemesChange_ = function () {
  var _this = this;

  this.gmfThemes_.getOgcServersObject().then(function (ogcServers) {
    _this.ogcServers_ = ogcServers;
  });

  if (this.rootCtrl && this.rootCtrl.children) {
    this.gmfThemes_.getThemesObject().then(function (themes) {
      _this.refreshFirstLevelGroups_(themes);
    });
  }
};

LayertreeTreeManager.prototype.setFirstLevelGroups = function (firstLevelGroups) {
  this.root.children.length = 0;
  this.ngeoStateManager_.deleteParam(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].TREE_GROUPS);
  return this.addFirstLevelGroups(firstLevelGroups);
};

LayertreeTreeManager.prototype.addFirstLevelGroups = function (firstLevelGroups, opt_add, opt_silent) {
  var _this2 = this;

  var groupNotAdded = [];
  firstLevelGroups.slice().reverse().forEach(function (group) {
    if (!_this2.addFirstLevelGroup_(group)) {
      groupNotAdded.push(group);
    }
  });

  if (groupNotAdded.length > 0 && !opt_silent) {
    this.notifyCantAddGroups_(groupNotAdded);
  }

  return groupNotAdded.length === 0;
};

LayertreeTreeManager.prototype.setInitialFirstLevelGroups = function (firstGroups) {
  this.initialLevelFirstGroups_ = firstGroups;
};

LayertreeTreeManager.prototype.reorderChild_ = function (array, old_index, new_index) {
  array.splice(new_index, 0, array.splice(old_index, 1)[0]);
};

LayertreeTreeManager.prototype.updateTreeGroupsState_ = function (groups) {
  var treeGroupsParam = {};
  treeGroupsParam[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].TREE_GROUPS] = groups.map(function (node) {
    return node.name;
  }).join(',');
  this.ngeoStateManager_.updateState(treeGroupsParam);

  if (this.$injector_.has('gmfPermalink')) {
    this.$injector_.get('gmfPermalink').cleanParams(groups);
  }
};

LayertreeTreeManager.prototype.addFirstLevelGroup_ = function (group) {
  var _this3 = this;

  var alreadyAdded = false;
  var groupID = group.id;
  this.root.children.some(function (rootChild) {
    if (groupID === rootChild.id) {
      alreadyAdded = true;
      return true;
    }

    return false;
  }, this);
  this.groupsToAddInThisDigestLoop_.some(function (grp) {
    if (groupID === grp.id) {
      alreadyAdded = true;
      return true;
    }

    return false;
  }, this);

  if (alreadyAdded) {
    return false;
  }

  this.groupsToAddInThisDigestLoop_.push(group);
  this.numberOfGroupsToAddInThisDigestLoop = 0;

  if (this.promiseForGroupsToAddInThisDigestLoop_ !== null) {
    this.$timeout_.cancel(this.promiseForGroupsToAddInThisDigestLoop_);
  }

  this.promiseForGroupsToAddInThisDigestLoop_ = this.$timeout_(function () {
    _this3.numberOfGroupsToAddInThisDigestLoop = _this3.groupsToAddInThisDigestLoop_.length;

    _this3.groupsToAddInThisDigestLoop_.forEach(function (grp) {
      _this3.root.children.unshift(grp);

      _this3.root.children.forEach(function (group, old_index) {
        if (_this3.initialLevelFirstGroups_ !== undefined) {
          var new_index = _this3.initialLevelFirstGroups_.findIndex(function (firstLevelGroup) {
            return firstLevelGroup.id === group.id;
          });

          if (new_index !== -1 && new_index !== old_index) {
            _this3.reorderChild_(_this3.root.children, old_index, new_index);
          }
        }
      });
    });

    _this3.initialLevelFirstGroups_ = undefined;

    _this3.updateTreeGroupsState_(_this3.root.children);

    _this3.groupsToAddInThisDigestLoop_.length = 0;
    _this3.promiseForGroupsToAddInThisDigestLoop_ = null;
  });
  return true;
};

LayertreeTreeManager.prototype.addGroupByName = function (groupName, opt_add) {
  var _this4 = this;

  this.gmfThemes_.getThemesObject().then(function (themes) {
    var group = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["findGroupByName"])(themes, groupName);

    if (group) {
      _this4.addFirstLevelGroups([group], opt_add, false);
    }
  });
};

LayertreeTreeManager.prototype.addGroupByLayerName = function (layerName, opt_add, opt_silent) {
  var _this5 = this;

  this.gmfThemes_.getThemesObject().then(function (themes) {
    var group = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["findGroupByLayerNodeName"])(themes, layerName);

    if (group) {
      var groupAdded = _this5.addFirstLevelGroups([group], opt_add, opt_silent);

      _this5.$timeout_(function () {
        var treeCtrl = _this5.getTreeCtrlByNodeId(group.id);

        if (!treeCtrl) {
          console.warn('Tree controller not found, unable to add the group');
          return;
        }

        var treeCtrlToActive = null;
        treeCtrl.traverseDepthFirst(function (treeCtrl) {
          if (treeCtrl.node.name === layerName) {
            treeCtrlToActive = treeCtrl;
            return ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_3__["LayertreeVisitorDecision"].STOP;
          }
        });

        if (groupAdded) {
          treeCtrl.setState('off');
        }

        if (treeCtrlToActive instanceof ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_3__["LayertreeController"]) {
          treeCtrlToActive.setState('on');
        }
      });
    }
  });
};

LayertreeTreeManager.prototype.removeGroup = function (group) {
  var children = this.root.children;
  var index = 0,
      found = false;
  children.some(function (child) {
    if (child.name === group.name) {
      return found = true;
    }

    index++;
    return false;
  });

  if (found) {
    children.splice(index, 1);
    this.updateTreeGroupsState_(children);
  }
};

LayertreeTreeManager.prototype.removeAll = function () {
  while (this.root.children.length) {
    this.removeGroup(this.root.children[0]);
  }
};

LayertreeTreeManager.prototype.cloneGroupNode_ = function (group, names) {
  var clone = Object.assign({}, group);
  this.toggleNodeCheck_(clone, names);
  return clone;
};

LayertreeTreeManager.prototype.toggleNodeCheck_ = function (node, names) {
  var _this6 = this;

  var groupNode = node;

  if (!groupNode.children) {
    return;
  }

  groupNode.children.forEach(function (childNode) {
    var childGroupNode = childNode;

    if (childGroupNode.children) {
      _this6.toggleNodeCheck_(childGroupNode, names);
    } else if (childNode.metadata) {
      childNode.metadata.isChecked = names.includes(childNode.name);
    }
  });
};

LayertreeTreeManager.prototype.notifyCantAddGroups_ = function (groups) {
  var names = [];
  var gettextCatalog = this.gettextCatalog_;
  groups.forEach(function (group) {
    names.push(gettextCatalog.getString(group.name));
  });
  var msg = names.length < 2 ? gettextCatalog.getString('group is already loaded.') : gettextCatalog.getString('groups are already loaded.');
  this.ngeoNotification_.notify({
    msg: names.join(', ') + " " + msg,
    type: ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_4__["MessageType"].INFORMATION
  });
};

LayertreeTreeManager.prototype.getTreeCtrlByNodeId = function (id) {
  var correspondingTreeCtrl = null;

  if (this.rootCtrl && this.rootCtrl.traverseDepthFirst) {
    this.rootCtrl.traverseDepthFirst(function (treeCtrl) {
      if (treeCtrl.node.id === id) {
        correspondingTreeCtrl = treeCtrl;
        return ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_3__["LayertreeVisitorDecision"].STOP;
      }
    });
  }

  return correspondingTreeCtrl;
};

LayertreeTreeManager.prototype.getOgcServer = function (treeCtrl) {
  if (!this.ogcServers_) {
    throw new Error('Missing ogcServers');
  }

  var gmfParentGroup = treeCtrl.parent.node;

  if (gmfParentGroup.mixed) {
    var gmfLayerWMS = treeCtrl.node;

    if (!gmfLayerWMS.ogcServer) {
      throw new Error('Missing gmfLayerWMS.ogcServer');
    }

    return this.ogcServers_[gmfLayerWMS.ogcServer];
  } else {
    var firstLevelGroupCtrl = treeCtrl;

    while (!firstLevelGroupCtrl.parent.isRoot) {
      firstLevelGroupCtrl = firstLevelGroupCtrl.parent;
    }

    var gmfGroup = firstLevelGroupCtrl.node;

    if (!gmfGroup.ogcServer) {
      throw new Error('Missing gmfGroup.ogcServer');
    }

    return this.ogcServers_[gmfGroup.ogcServer];
  }
};

LayertreeTreeManager.prototype.refreshFirstLevelGroups_ = function (themes) {
  var _this7 = this;

  if (!this.rootCtrl) {
    throw new Error('Missing rootCtrl');
  }

  var firstLevelGroupsFullState = {};
  this.rootCtrl.children.map(function (treeCtrl) {
    var name = treeCtrl.node.name;
    firstLevelGroupsFullState[name] = _this7.getFirstLevelGroupFullState_(treeCtrl);
  });
  var nodesToRestore = [];
  this.root.children.map(function (node) {
    var name = node.name;
    var nodeToRestore = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["findGroupByName"])(themes, name);

    if (nodeToRestore) {
      var fullState = firstLevelGroupsFullState[name];

      if (fullState) {
        _this7.setNodeMetadataFromFullState_(nodeToRestore, fullState);
      }

      nodesToRestore.push(nodeToRestore);
    }
  });
  this.setFirstLevelGroups(nodesToRestore);
  this.$timeout_(function () {
    _this7.updateTreeGroupsState_(_this7.root.children);
  });
};

LayertreeTreeManager.prototype.getFirstLevelGroupFullState_ = function (treeCtrl) {
  var _this8 = this;

  var children = {};
  treeCtrl.children.map(function (child) {
    children[child.node.name] = _this8.getFirstLevelGroupFullState_(child);
  });
  var isChecked, isExpanded, isLegendExpanded;

  if (treeCtrl.children.length > 0) {
    var nodeElement = $("#gmf-layertree-layer-group-" + treeCtrl.uid);

    if (nodeElement) {
      isExpanded = nodeElement.hasClass('show');
    }
  } else {
    isChecked = treeCtrl.getState();

    if (isChecked === 'on') {
      isChecked = true;
    } else if (isChecked === 'off') {
      isChecked = false;
    } else {
      isChecked = undefined;
    }

    var legendElement = $("#gmf-layertree-node-" + treeCtrl.uid + "-legend");

    if (legendElement) {
      isLegendExpanded = legendElement.is(':visible');
    }
  }

  return {
    children: children,
    isChecked: isChecked,
    isExpanded: isExpanded,
    isLegendExpanded: isLegendExpanded
  };
};

LayertreeTreeManager.prototype.setNodeMetadataFromFullState_ = function (node, fullState) {
  var _this9 = this;

  if (!fullState) {
    return node;
  }

  var groupNode = node;

  if (groupNode.children) {
    groupNode.children.map(function (child) {
      _this9.setNodeMetadataFromFullState_(child, fullState.children[child.name]);
    });
  }

  var metadata = node.metadata;
  metadata.isChecked = fullState.isChecked;
  metadata.isExpanded = fullState.isExpanded;
  metadata.isLegendExpanded = fullState.isLegendExpanded;
  return node;
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfTreeManager', [gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_message_Notification_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_statemanager_Service_js__WEBPACK_IMPORTED_MODULE_6__["default"].name]);
module.service('gmfTreeManager', LayertreeTreeManager);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/layertree/common.scss":
/*!************************************************!*\
  !*** ./contribs/gmf/src/layertree/common.scss ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/layertree/component.html":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/layertree/component.html ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n   class="gmf-layertree-root-tools"\n   ng-if="layertreeCtrl.isRoot">\n  <a\n     href\n     ng-if="gmfLayertreeCtrl.nodesCount() > 0"\n     ng-click="gmfLayertreeCtrl.removeAllNodes()">\n    <span class="fa fa-trash"></span> {{\'Clear all\' | translate}}\n  </a>\n</div>\n<div\n  ng-if="::!layertreeCtrl.isRoot"\n  id="gmf-layertree-node-{{::layertreeCtrl.uid}}"\n  ng-class="[layertreeCtrl.node.children ? \'gmf-layertree-group\' : \'gmf-layertree-leaf\', \'gmf-layertree-depth-\' + layertreeCtrl.depth, gmfLayertreeCtrl.getResolutionStyle(layertreeCtrl.node), gmfLayertreeCtrl.getNodeState(layertreeCtrl)]">\n\n  <div\n    class="ngeo-sortable-handle"\n    ng-show="layertreeCtrl.depth === 1 && layertreeCtrl.parent.children.length > 1">\n    <i class="gmf-layertree-sortable-handle-icon fa fa-ellipsis-v"></i>\n  </div>\n\n  <a\n    ng-if="::layertreeCtrl.node.children"\n    data-toggle="collapse"\n    href="#gmf-layertree-layer-group-{{::layertreeCtrl.uid}}"\n    aria-expanded="{{::layertreeCtrl.node.metadata.isExpanded}}"\n    class="fa gmf-layertree-expand-node fa-fw">\n  </a>\n\n  <a\n    href\n    ng-click="::gmfLayertreeCtrl.toggleActive(layertreeCtrl)"\n    ng-if="::!layertreeCtrl.node.children && gmfLayertreeCtrl.getLegendIconURL(layertreeCtrl)"\n    class="gmf-layertree-layer-icon"\n  >\n    <div><!--This div is required for flex issues with IE11-->\n      <img\n        ng-if="::(legendIconUrl=gmfLayertreeCtrl.getLegendIconURL(layertreeCtrl))"\n        ng-src="{{::legendIconUrl}}">\n      </img>\n    </div>\n  </a>\n  <a\n    href\n    ng-click="::gmfLayertreeCtrl.toggleActive(layertreeCtrl)"\n    ng-if="::!layertreeCtrl.node.children && !gmfLayertreeCtrl.getLegendIconURL(layertreeCtrl)"\n    class="gmf-layertree-layer-icon gmf-layertree-no-layer-icon"\n  >' +
((__t = (__webpack_require__(/*! gmf/icons/dot.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/dot.svg?viewbox&height=1em"))) == null ? '' : __t) +
'</a>\n\n  <a\n    href\n    ng-click="::gmfLayertreeCtrl.toggleActive(layertreeCtrl)"\n    ng-if="layertreeCtrl.node.children && layertreeCtrl.layer.loading"\n    class="fa fa-fw fa-refresh fa-sync fa-spin"\n  ></a>\n  <a\n    href\n    ng-click="::gmfLayertreeCtrl.toggleActive(layertreeCtrl)"\n    ng-if="layertreeCtrl.node.children && !layertreeCtrl.layer.loading"\n    class="gmf-layertree-state gmf-not-intermediate"\n  >' +
((__t = (__webpack_require__(/*! gmf/icons/layers.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/layers.svg?viewbox&height=1em"))) == null ? '' : __t) +
'</a>\n  <a\n    href\n    ng-click="::gmfLayertreeCtrl.toggleActive(layertreeCtrl)"\n    ng-if="layertreeCtrl.node.children && !layertreeCtrl.layer.loading"\n    class="gmf-layertree-state gmf-intermediate"\n  >' +
((__t = (__webpack_require__(/*! gmf/icons/stack-indeterminate.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/stack-indeterminate.svg?viewbox&height=1em"))) == null ? '' : __t) +
'</a>\n\n  <a\n    href\n    data-sentry="id:{{layertreeCtrl.node.id}}"\n    ng-click="::gmfLayertreeCtrl.toggleActive(layertreeCtrl)"\n    class="gmf-layertree-name"\n    data-toggle="tooltip"\n    data-placement="top"\n    title="{{layertreeCtrl.node.name | translate}}">\n\n    {{layertreeCtrl.node.name | translate}}\n\n    <i ng-if="gmfLayertreeCtrl.gmfLayerBeingSwipe.layer && gmfLayertreeCtrl.gmfLayerBeingSwipe.layer === layertreeCtrl.layer">\n      ' +
((__t = (__webpack_require__(/*! ngeo/icons/swipe.svg?viewbox&width=1em */ "./src/icons/swipe.svg?viewbox&width=1em"))) == null ? '' : __t) +
'\n    </i>\n\n    <i\n      class="gmf-layertree-zoom"\n      data-toggle="tooltip"\n      data-placement="bottom"\n      data-title="{{\'Not visible at current scale. Click to zoom.\'|translate}}"\n      ng-click="::gmfLayertreeCtrl.zoomToResolution(layertreeCtrl); $event.preventDefault(); $event.stopPropagation();"\n      ng-if="gmfLayertreeCtrl.getNodeState(layertreeCtrl) == \'on\'"\n    >' +
((__t = (__webpack_require__(/*! gmf/icons/search-go.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/search-go.svg?viewbox&height=1em"))) == null ? '' : __t) +
'</i>\n\n    <span\n      ngeo-popover\n      ngeo-popover-dismiss=".content"\n      ng-if="gmfLayertreeCtrl.getNodeState(layertreeCtrl) !== \'off\' && layertreeCtrl.node.time && layertreeCtrl.node.time.mode !== \'disabled\'">\n\n      <span\n        ngeo-popover-anchor\n        class="far fa-clock"\n        ng-click="$event.preventDefault(); $event.stopPropagation()">\n      </span>\n\n      <div ngeo-popover-content>\n        <ngeo-date-picker\n          ng-if="::layertreeCtrl.node.time.widget === \'datepicker\'"\n          time="layertreeCtrl.node.time"\n          on-date-selected="gmfLayertreeCtrl.updateWMSTimeLayerState(layertreeCtrl, time)">\n        </ngeo-date-picker>\n\n        <gmf-time-slider\n          ng-if="::layertreeCtrl.node.time.widget === \'slider\'"\n          gmf-time-slider-time="layertreeCtrl.node.time"\n          gmf-time-slider-on-date-selected="gmfLayertreeCtrl.updateWMSTimeLayerState(layertreeCtrl, time)">\n        </gmf-time-slider>\n      </div>\n    </span>\n\n    <span\n      class="fa fa-edit"\n      data-toggle="tooltip"\n      data-placement="right"\n      title="{{\'Currently editing this layer\'|translate}}"\n      ng-if="layertreeCtrl.properties.editing">\n    </span>\n\n    <span\n      class="fas fa-magnet"\n      ng-if="layertreeCtrl.node.metadata.snappingConfig"\n      ng-class="gmfLayertreeCtrl.isSnappingActivated(layertreeCtrl) ? \'on\' : \'off\'"\n      ng-click="gmfLayertreeCtrl.toggleSnapping(layertreeCtrl); $event.preventDefault(); $event.stopPropagation();"\n    >\n    </span>\n  </a>\n\n  <span class="gmf-layertree-right-buttons">\n    <a\n      href=""\n      ng-if="::layertreeCtrl.depth == 1"\n      ng-click="gmfLayertreeCtrl.removeNode(layertreeCtrl.node)">\n      <span class="fa fa-trash"></span>\n    </a>\n\n    <a\n      class="gmf-layertree-node-menu-btn"\n      href=""\n      ng-if="::gmfLayertreeCtrl.supportsCustomization(layertreeCtrl)"\n      ng-click="::gmfLayertreeCtrl.toggleNodeLegend(\'#gmf-layertree-node-menu-\' + layertreeCtrl.uid)">\n      <span class="fa fa-cog"></span>\n    </a>\n\n    <span\n      ngeo-popover\n      ng-if="::(layertreeCtrl.depth === 1 && !layertreeCtrl.node.mixed) || (layertreeCtrl.depth > 1 && layertreeCtrl.parent.node.mixed && !layertreeCtrl.node.children) || (gmfLayertreeCtrl.getLegendsObject(layertreeCtrl) && layertreeCtrl.node.metadata.legend) || layertreeCtrl.getDataSource().filtrable" ngeo-popover-dismiss=".content">\n\n      <span\n        ngeo-popover-anchor\n        class="extra-actions fa fa-cog">\n      </span>\n\n      <div ngeo-popover-content>\n        <ul>\n          <li ng-if="::(layertreeCtrl.depth === 1 && !layertreeCtrl.node.mixed) || (layertreeCtrl.depth > 1 && layertreeCtrl.parent.node.mixed)">\n            <i class="fa fa-tint fa-fw"></i>\n            <span>{{\'Opacity\'|translate}}</span>\n            <input\n              class="input-action"\n              type="range"\n              min="0"\n              max="1"\n              step="0.01"\n              ng-model="layertreeCtrl.layer.opacity" />\n          </li>\n          <li ng-if="::gmfLayertreeCtrl.getLegendsObject(layertreeCtrl) && layertreeCtrl.node.metadata.legend">\n            <i class="fa fa-th-list fa-fw"></i>\n            <a\n              ng-click="::gmfLayertreeCtrl.toggleNodeLegend(\'#gmf-layertree-node-\' + layertreeCtrl.uid + \'-legend\'); popoverCtrl.dismissPopover()"\n              href="">\n              {{\'Show/hide legend\'|translate}}\n            </a>\n          </li>\n          <li ng-if="::gmfLayertreeCtrl.supportsOpacityChange(layertreeCtrl)">\n            <i>' +
((__t = (__webpack_require__(/*! ngeo/icons/swipe.svg?viewbox&height=1em */ "./src/icons/swipe.svg?viewbox&height=1em"))) == null ? '' : __t) +
'</i>\n            <a\n              ng-click="::gmfLayertreeCtrl.toggleSwipeLayer(layertreeCtrl); popoverCtrl.dismissPopover()"\n              href=""\n              ng-model="layertreeCtrl.layer"\n              >\n              {{\'Swipe with this layer\'| translate}}\n            </a>\n          </li>\n          <li ng-if="layertreeCtrl.getDataSource() && layertreeCtrl.getDataSource().filtrable">\n            <i class="fa fa-filter fa-fw"></i>\n            <a\n              ng-click="gmfLayertreeCtrl.toggleFiltrableDataSource(layertreeCtrl.getDataSource())"\n              href="">\n              {{\'Filter\'|translate}}\n            </a>\n          </li>\n        </ul>\n      </div>\n    </span>\n\n    <span\n      class="gmf-layertree-metadata"\n      ng-if="::layertreeCtrl.node.metadata.metadataUrl">\n\n      <span ng-if="::gmfLayertreeCtrl.openLinksInNewWindow === true">\n        <a\n          title="{{\'More information\'|translate}}"\n          href="{{::layertreeCtrl.node.metadata.metadataUrl}}"\n          target="blank_">\n        </a>\n      </span>\n\n      <span ng-if="::gmfLayertreeCtrl.openLinksInNewWindow !== true">\n        <a\n          title="{{\'More information\'|translate}}"\n          href="" ng-click="gmfLayertreeCtrl.displayMetadata(layertreeCtrl)">\n        </a>\n      </span>\n    </span>\n  </span>\n</div>\n\n<div\n  class="gmf-layertree-node-menu"\n  id="gmf-layertree-node-menu-{{::layertreeCtrl.uid}}"\n  style="display:none;"\n  ng-if="::gmfLayertreeCtrl.supportsCustomization(layertreeCtrl)">\n\n  <div ng-if="::gmfLayertreeCtrl.supportsOpacityChange(layertreeCtrl)">\n    <i class="fa fa-tint fa-fw"></i>\n    <span>{{\'Opacity\'|translate}}</span>\n    <input\n        class="input-action"\n        type="range"\n        min="0"\n        max="1"\n        step="0.01"\n        ng-model="layertreeCtrl.layer.opacity" />\n  </div>\n\n  <a\n    class="gmf-layertree-node-menu-togglelegend"\n    ng-if="::gmfLayertreeCtrl.supportsLegend(layertreeCtrl)"\n    ng-click="::gmfLayertreeCtrl.toggleNodeLegend(\'#gmf-layertree-node-\' + layertreeCtrl.uid + \'-legend\')"\n    href="">\n    <span\n        class="fa fa-th-list">\n    </span>\n    {{\'Show/hide legend\'|translate}}\n  </a>\n</div>\n<div\n  ng-if="::!layertreeCtrl.isRoot && gmfLayertreeCtrl.getLegendsObject(layertreeCtrl) && layertreeCtrl.node.metadata.legend" id="gmf-layertree-node-{{::layertreeCtrl.uid}}-legend"\n  class="gmf-layertree-legend"\n  ng-class="[gmfLayertreeCtrl.getNodeState(layertreeCtrl), layertreeCtrl.node.metadata.isLegendExpanded ? \'show\' : \'\']">\n\n  <a\n    title="{{\'Hide legend\'|translate}}"\n    ng-click="::gmfLayertreeCtrl.toggleNodeLegend(\'#gmf-layertree-node-\' + layertreeCtrl.uid + \'-legend\')"\n    href="">\n    {{\'Hide legend\'|translate}}\n  </a>\n  <div ng-if="gmfLayertreeCtrl.isNodeLegendVisible(\'#gmf-layertree-node-\' + layertreeCtrl.uid + \'-legend\')">\n    <div ng-repeat="(title, url) in gmfLayertreeCtrl.getLegendsObject(layertreeCtrl)">\n      <p ng-if="gmfLayertreeCtrl.getNumberOfLegendsObject(layertreeCtrl) > 1">{{title|translate}}</p>\n      <img ng-src="{{url}}"></img>\n    </div>\n  </div>\n</div>\n\n<ul\n   class="gmf-layertree-root-external-datasources"\n   ng-if="layertreeCtrl.isRoot && (gmfLayertreeCtrl.gmfExternalDataSourcesManager.wmsGroups.length || gmfLayertreeCtrl.gmfExternalDataSourcesManager.wmtsGroups.length || gmfLayertreeCtrl.gmfExternalDataSourcesManager.fileGroup.dataSources.length)">\n  <gmf-datasourcegrouptree\n    class="gmf-layertree-node gmf-layertree-depth-1"\n    ng-repeat="wmtsGroup in gmfLayertreeCtrl.gmfExternalDataSourcesManager.wmtsGroups"\n    group="wmtsGroup"\n  >\n  </gmf-datasourcegrouptree>\n  <gmf-datasourcegrouptree\n    class="gmf-layertree-node gmf-layertree-depth-1"\n    ng-repeat="wmsGroup in gmfLayertreeCtrl.gmfExternalDataSourcesManager.wmsGroups"\n    group="wmsGroup"\n  >\n  </gmf-datasourcegrouptree>\n  <gmf-datasourcegrouptree\n    class="gmf-layertree-node gmf-layertree-depth-1"\n    ng-if="gmfLayertreeCtrl.gmfExternalDataSourcesManager.fileGroup.dataSources.length"\n    group="gmfLayertreeCtrl.gmfExternalDataSourcesManager.fileGroup"\n  >\n  </gmf-datasourcegrouptree>\n</ul>\n\n<ul\n  id="gmf-layertree-layer-group-{{::layertreeCtrl.uid}}"\n  ng-if="::layertreeCtrl.node.children"\n  ng-class="{collapse: !layertreeCtrl.isRoot, show: layertreeCtrl.node.metadata.isExpanded}"\n  ngeo-sortable="::layertreeCtrl.isRoot && layertreeCtrl.node.children"\n  ngeo-sortable-options="{handleClassName: \'ngeo-sortable-handle\', draggerClassName: \'gmf-layertree-dragger\', placeholderClassName : \'gmf-layertree-curr-drag-item\'}"\n  ngeo-sortable-callback="::gmfLayertreeCtrl.afterReorder"\n  ngeo-sortable-callback-ctx="::gmfLayertreeCtrl">\n\n  <li\n    class="gmf-layertree-node"\n    ng-repeat="node in layertreeCtrl.node.children"\n    ng-class="\'gmf-layertree-depth-\' + layertreeCtrl.depth"\n    ngeo-layertree="node"\n    ngeo-layertree-notroot\n    ngeo-layertree-map="layertreeCtrl.map"\n    ngeo-layertree-nodelayerexpr="layertreeCtrl.nodelayerExpr"\n    ngeo-layertree-listenersexpr="layertreeCtrl.listenersExpr">\n  </li>\n</ul>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/layertree/component.js":
/*!*************************************************!*\
  !*** ./contribs/gmf/src/layertree/component.js ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/index.js */ "./contribs/gmf/src/index.js");
/* harmony import */ var gmf_datasource_DataSourceBeingFiltered_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/datasource/DataSourceBeingFiltered.js */ "./contribs/gmf/src/datasource/DataSourceBeingFiltered.js");
/* harmony import */ var gmf_datasource_LayerBeingSwipe_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/datasource/LayerBeingSwipe.js */ "./contribs/gmf/src/datasource/LayerBeingSwipe.js");
/* harmony import */ var gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/datasource/ExternalDataSourcesManager.js */ "./contribs/gmf/src/datasource/ExternalDataSourcesManager.js");
/* harmony import */ var gmf_permalink_Permalink_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/permalink/Permalink.js */ "./contribs/gmf/src/permalink/Permalink.js");
/* harmony import */ var gmf_layertree_datasourceGroupTreeComponent_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! gmf/layertree/datasourceGroupTreeComponent.js */ "./contribs/gmf/src/layertree/datasourceGroupTreeComponent.js");
/* harmony import */ var gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! gmf/layertree/SyncLayertreeMap.js */ "./contribs/gmf/src/layertree/SyncLayertreeMap.js");
/* harmony import */ var gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! gmf/layertree/TreeManager.js */ "./contribs/gmf/src/layertree/TreeManager.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
/* harmony import */ var ngeo_layertree_component_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/layertree/component.js */ "./src/layertree/component.js");
/* harmony import */ var ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/layertree/Controller.js */ "./src/layertree/Controller.js");
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
/* harmony import */ var ngeo_misc_syncArrays_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ngeo/misc/syncArrays.js */ "./src/misc/syncArrays.js");
/* harmony import */ var ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ngeo/misc/WMSTime.js */ "./src/misc/WMSTime.js");
/* harmony import */ var ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/layer/Tile.js */ "./node_modules/ol/layer/Tile.js");
/* harmony import */ var ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/layer/Layer.js */ "./node_modules/ol/layer/Layer.js");
/* harmony import */ var ol_obj_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/obj.js */ "./node_modules/ol/obj.js");
/* harmony import */ var ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ol/source/ImageWMS.js */ "./node_modules/ol/source/ImageWMS.js");
/* harmony import */ var ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ol/source/TileWMS.js */ "./node_modules/ol/source/TileWMS.js");
/* harmony import */ var ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ol/source/WMTS.js */ "./node_modules/ol/source/WMTS.js");
/* harmony import */ var ol_layer_Base_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ol/layer/Base.js */ "./node_modules/ol/layer/Base.js");
/* harmony import */ var bootstrap_js_src_collapse_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! bootstrap/js/src/collapse.js */ "./node_modules/bootstrap/js/src/collapse.js");
Controller.$inject = ["$element", "$scope", "ngeoLayerHelper", "gmfLayerBeingSwipe", "gmfDataSourceBeingFiltered", "gmfExternalDataSourcesManager", "gmfPermalink", "gmfTreeManager", "gmfSyncLayertreeMap", "ngeoWMSTime", "gmfThemes", "$timeout"];
























var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfLayertreeComponent', [gmf_datasource_DataSourceBeingFiltered_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_datasource_ExternalDataSourcesManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, gmf_permalink_Permalink_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, gmf_layertree_datasourceGroupTreeComponent_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, ngeo_layertree_component_js__WEBPACK_IMPORTED_MODULE_11__["default"].name, ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_12__["default"].name, ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_13__["default"].name, ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_15__["default"].name, gmf_datasource_LayerBeingSwipe_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]);
module.value('ngeoLayertreeTemplateUrl', function (element, attrs) {
  return 'gmf/layertree';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/layertree', __webpack_require__(/*! ./component.html */ "./contribs/gmf/src/layertree/component.html"));
}]);
module.value('gmfLayertreeTemplate', function ($element, $attrs) {
  var subTemplateUrl = 'gmf/layertree';
  return '<div ngeo-layertree="gmfLayertreeCtrl.root" ' + 'ngeo-layertree-map="gmfLayertreeCtrl.map" ' + 'ngeo-layertree-nodelayer="gmfLayertreeCtrl.getLayer(treeCtrl)" ' + 'ngeo-layertree-listeners="gmfLayertreeCtrl.listeners(treeScope, treeCtrl)" ' + ("ngeo-layertree-templateurl=\"" + subTemplateUrl + "\">") + '</div>';
});
gmfLayertreeTemplate.$inject = ["$element", "$attrs", "gmfLayertreeTemplate"];

function gmfLayertreeTemplate($element, $attrs, gmfLayertreeTemplate) {
  return gmfLayertreeTemplate($element, $attrs);
}

var layertreeComponent = {
  controller: 'GmfLayertreeController as gmfLayertreeCtrl',
  bindings: {
    'map': '=gmfLayertreeMap',
    'dimensions': '=?gmfLayertreeDimensions',
    'openLinksInNewWindow': '<?gmfLayertreeOpenlinksinnewwindow'
  },
  template: gmfLayertreeTemplate
};
module.component('gmfLayertree', layertreeComponent);

function Controller($element, $scope, ngeoLayerHelper, gmfLayerBeingSwipe, gmfDataSourceBeingFiltered, gmfExternalDataSourcesManager, gmfPermalink, gmfTreeManager, gmfSyncLayertreeMap, ngeoWMSTime, gmfThemes, $timeout) {
  var _this = this;

  this.map;
  this.dimensions = null;
  this.scope_ = $scope;
  this.layerHelper_ = ngeoLayerHelper;
  this.gmfLayerBeingSwipe = gmfLayerBeingSwipe;
  this.gmfDataSourceBeingFiltered = gmfDataSourceBeingFiltered;
  this.gmfExternalDataSourcesManager = gmfExternalDataSourcesManager;
  this.gmfPermalink_ = gmfPermalink;
  this.gmfTreeManager_ = gmfTreeManager;
  var root = gmfTreeManager.root;

  if (!root) {
    throw new Error('Missing root');
  }

  this.root = root;
  this.gmfSyncLayertreeMap_ = gmfSyncLayertreeMap;
  this.ngeoWMSTime_ = ngeoWMSTime;
  this.groupNodeStates_ = {};
  this.openLinksInNewWindow = null;
  this.dataLayerGroup_ = null;
  this.layers = [];
  this.gmfThemes_ = gmfThemes;
  this.$timeout_ = $timeout;
  $element.on('shown.bs.collapse', function () {
    _this.scope_.$apply();
  });
}

Controller.prototype.$onInit = function () {
  var _this2 = this;

  this.openLinksInNewWindow = this.openLinksInNewWindow === true;
  this.dataLayerGroup_ = this.layerHelper_.getGroupFromMap(this.map, gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["DATALAYERGROUP_NAME"]);
  Object(ngeo_misc_syncArrays_js__WEBPACK_IMPORTED_MODULE_14__["default"])(this.dataLayerGroup_.getLayers().getArray(), this.layers, true, this.scope_, function () {
    return true;
  });
  this.scope_.$watchCollection(function () {
    return _this2.layers;
  }, function () {
    _this2.map.render();

    if (_this2.gmfLayerBeingSwipe.layer && !_this2.layers.includes(_this2.gmfLayerBeingSwipe.layer)) {
      _this2.gmfLayerBeingSwipe.layer = null;
    }
  });
  this.scope_.$watchCollection(function () {
    if (_this2.gmfTreeManager_.rootCtrl) {
      return _this2.dimensions;
    }
  }, function (dimensions) {
    if (dimensions) {
      if (!_this2.gmfTreeManager_.rootCtrl) {
        throw new Error('Missing gmfTreeManager_.rootCtrl');
      }

      _this2.updateDimensions_(_this2.gmfTreeManager_.rootCtrl);
    }
  });
};

Controller.prototype.updateDimensions_ = function (treeCtrl) {
  var _this3 = this;

  treeCtrl.traverseDepthFirst(function (ctrl) {
    if (ctrl.node.dimensions) {
      var layer = ctrl.layer;

      if (!(layer instanceof ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_17__["default"])) {
        throw new Error('Wrong feature type');
      }

      _this3.updateLayerDimensions_(layer, ctrl.node);

      return ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_12__["LayertreeVisitorDecision"].DESCEND;
    }
  });
};

Controller.prototype.updateLayerDimensions_ = function (layer, node) {
  var _this4 = this;

  if (this.dimensions && node.dimensions) {
    var dimensions = {};

    for (var key in node.dimensions) {
      if (node.dimensions[key] === null) {
        var value = this.dimensions[key];

        if (value !== undefined) {
          dimensions[key] = value;
        }
      } else {
        dimensions[key] = node.dimensions[key];
      }
    }

    if (!Object(ol_obj_js__WEBPACK_IMPORTED_MODULE_18__["isEmpty"])(dimensions)) {
      var source = layer.getSource();

      if (source instanceof ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_21__["default"]) {
        source.updateDimensions(dimensions);
      } else if (source instanceof ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_20__["default"] || source instanceof ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_19__["default"]) {
        source.updateParams(dimensions);
      } else {
        layer.once('change:source', function () {
          if (!(layer instanceof ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_17__["default"])) {
            throw new Error('Wrong feature type');
          }

          _this4.updateLayerDimensions_(layer, node);
        });
      }
    }
  }
};

Controller.prototype.getLayer = function (treeCtrl) {
  if (!this.dataLayerGroup_) {
    throw new Error('Missing dataLayerGroup');
  }

  var opt_position;

  if (treeCtrl.parent.isRoot) {
    this.gmfTreeManager_.rootCtrl = treeCtrl.parent;
    opt_position = this.gmfTreeManager_.root.children.length - this.gmfTreeManager_.numberOfGroupsToAddInThisDigestLoop || 0;
  }

  var layer = this.gmfSyncLayertreeMap_.createLayer(treeCtrl, this.map, this.dataLayerGroup_, opt_position);

  if (layer instanceof ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_17__["default"]) {
    var node = treeCtrl.node;
    this.updateLayerDimensions_(layer, node);
  }

  return layer;
};

Controller.prototype.listeners = function (scope, treeCtrl) {
  if (!this.dataLayerGroup_) {
    throw new Error('Missing dataLayerGroup');
  }

  var dataLayerGroup = this.dataLayerGroup_;
  scope.$on('$destroy', function () {
    if (treeCtrl.layer) {
      dataLayerGroup.getLayers().remove(treeCtrl.layer);
    }
  });
};

Controller.prototype.toggleActive = function (treeCtrl) {
  var state = treeCtrl.getState();

  if (treeCtrl.node.metadata && treeCtrl.node.metadata.exclusiveGroup) {
    treeCtrl.setState(state === 'off' ? 'on' : 'off');
  } else {
    treeCtrl.setState(state === 'on' ? 'off' : 'on');
  }
};

Controller.prototype.getNodeState = function (treeCtrl) {
  return treeCtrl.getState();
};

Controller.prototype.updateWMSTimeLayerState = function (layertreeCtrl, time) {
  if (!time) {
    return;
  }

  var dataSource = layertreeCtrl.getDataSource();

  if (dataSource) {
    if (!(dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_10__["default"])) {
      throw new Error('Wrong dataSource type');
    }

    dataSource.timeRangeValue = time;
  } else if (layertreeCtrl.children) {
    for (var i = 0, ii = layertreeCtrl.children.length; i < ii; i++) {
      this.updateWMSTimeLayerState(layertreeCtrl.children[i], time);
    }
  }
};

Controller.prototype.getLegendIconURL = function (treeCtrl) {
  var iconUrl = treeCtrl.node.metadata.iconUrl;

  if (iconUrl !== undefined) {
    return iconUrl;
  }

  var gmfGroup = treeCtrl.node;

  if (gmfGroup.children !== undefined) {
    return undefined;
  }

  var gmfLayer = treeCtrl.node;

  if (gmfLayer.type !== 'WMS') {
    return undefined;
  }

  var gmfLayerWMS = gmfLayer;
  var legendRule = gmfLayerWMS.metadata.legendRule;

  if (legendRule === undefined) {
    return undefined;
  }

  var layerName = gmfLayerWMS.layers.split(',')[0];
  var gmfOgcServer = this.gmfTreeManager_.getOgcServer(treeCtrl);
  return this.layerHelper_.getWMSLegendURL(gmfOgcServer.url, layerName, undefined, legendRule, 20, 20);
};

Controller.prototype.getLegendsObject = function (treeCtrl) {
  var _this5 = this;

  var legendsObject = {};

  if (treeCtrl.node.children !== undefined) {
    return null;
  }

  var gmfLayer = treeCtrl.node;
  var gmfLayerDefaultName = gmfLayer.name;

  if (gmfLayer.metadata.legendImage) {
    legendsObject[gmfLayerDefaultName] = gmfLayer.metadata.legendImage;
    return legendsObject;
  }

  var layer = treeCtrl.layer;

  if (gmfLayer.type === 'WMTS') {
    if (!(layer instanceof ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_16__["default"])) {
      throw new Error('Wrong layer');
    }

    var wmtsLegendURL = this.layerHelper_.getWMTSLegendURL(layer);

    if (wmtsLegendURL !== undefined) {
      legendsObject[gmfLayerDefaultName] = wmtsLegendURL;
    }

    return wmtsLegendURL ? legendsObject : null;
  } else {
    var gmfLayerWMS = gmfLayer;
    var layersNames = gmfLayerWMS.layers;
    var gmfOgcServer = this.gmfTreeManager_.getOgcServer(treeCtrl);
    var scale = this.getScale_();

    if (gmfOgcServer.type !== ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_10__["ServerType"].QGISSERVER) {
      var layerNamesList = layersNames.split(',');
      layerNamesList.forEach(function (layerName) {
        var wmtsLegendURL = _this5.layerHelper_.getWMSLegendURL(gmfOgcServer.url, layerName, scale);

        if (!wmtsLegendURL) {
          throw new Error('Missing wmtsLegendURL');
        }

        legendsObject[layerName] = wmtsLegendURL;
      });
    }

    return legendsObject;
  }
};

Controller.prototype.getNumberOfLegendsObject = function (treeCtrl) {
  var legendsObject = this.getLegendsObject(treeCtrl);
  return legendsObject ? Object.keys(legendsObject).length : 0;
};

Controller.prototype.getScale_ = function () {
  var view = this.map.getView();
  var resolution = view.getResolution();

  if (resolution === undefined) {
    throw new Error('Missing resolution');
  }

  var mpu = view.getProjection().getMetersPerUnit();

  if (!mpu) {
    throw new Error('Missing mpu');
  }

  var dpi = 25.4 / 0.28;
  return resolution * mpu * 39.37 * dpi;
};

Controller.prototype.isSnappingActivated = function (treeCtrl) {
  if (treeCtrl.properties.snapping !== undefined) {
    if (typeof treeCtrl.properties.snapping !== 'boolean') {
      throw new Error('Wrong snappingActive type');
    }

    return treeCtrl.properties.snapping;
  }

  var node = treeCtrl.node;
  var config = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_9__["getSnappingConfig"])(node);
  return config !== null && config.activated;
};

Controller.prototype.toggleSnapping = function (treeCtrl) {
  treeCtrl.properties.snapping = !this.isSnappingActivated(treeCtrl);
};

Controller.prototype.displayMetadata = function (treeCtrl) {
  var node = treeCtrl.node;
  var metadataURL = node.metadata.metadataUrl;

  if (metadataURL !== undefined) {
    var gmfx = window.gmfx;

    if (gmfx.openIframePopup) {
      gmfx.openIframePopup(metadataURL, node.name, undefined, undefined, false);
    }
  }
};

Controller.prototype.afterReorder = function () {
  var _this6 = this;

  if (!this.gmfTreeManager_.rootCtrl) {
    throw new Error('Missing gmfTreeManager_.rootCtrl');
  }

  var gmfRootGroup = this.gmfTreeManager_.rootCtrl.node;
  var groupNodes = gmfRootGroup.children;
  var currentTreeCtrls = this.gmfTreeManager_.rootCtrl.children;
  var treeCtrls = [];
  groupNodes.forEach(function (node) {
    currentTreeCtrls.some(function (treeCtrl) {
      if (treeCtrl.node === node) {
        treeCtrls.push(treeCtrl);
        return false;
      }

      return false;
    });
  });
  this.gmfTreeManager_.rootCtrl.children = treeCtrls;
  this.layers.length = 0;
  this.gmfTreeManager_.rootCtrl.children.forEach(function (child) {
    if (!(child.layer instanceof ol_layer_Base_js__WEBPACK_IMPORTED_MODULE_22__["default"])) {
      throw new Error('Wrong child.layer');
    }

    _this6.layers.push(child.layer);
  });
  this.gmfPermalink_.refreshFirstLevelGroups();
};

Controller.prototype.removeNode = function (node) {
  this.gmfTreeManager_.removeGroup(node);
};

Controller.prototype.removeAllNodes = function () {
  this.gmfTreeManager_.removeAll();
};

Controller.prototype.nodesCount = function () {
  return this.gmfTreeManager_.root.children.length;
};

Controller.prototype.getResolutionStyle = function (gmfLayer) {
  var resolution = this.map.getView().getResolution();

  if (resolution === undefined) {
    throw new Error('Missing resolution');
  }

  var minResolution = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_9__["getNodeMinResolution"])(gmfLayer);

  if (minResolution !== undefined && resolution < minResolution) {
    return 'out-of-resolution';
  }

  var maxResolution = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_9__["getNodeMaxResolution"])(gmfLayer);

  if (maxResolution !== undefined && resolution > maxResolution) {
    return 'out-of-resolution';
  }

  return undefined;
};

Controller.prototype.zoomToResolution = function (treeCtrl) {
  var gmfLayer = treeCtrl.node;
  var view = this.map.getView();
  var resolution = view.getResolution();

  if (resolution === undefined) {
    throw new Error('Missing resolution');
  }

  var minResolution = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_9__["getNodeMinResolution"])(gmfLayer);
  var constrainResolution = view.getConstraints().resolution;
  var size = this.map.getSize();

  if (size === undefined) {
    throw new Error('Missing size');
  }

  if (minResolution !== undefined && resolution < minResolution) {
    view.setResolution(constrainResolution(minResolution, 1, size));
  } else {
    var maxResolution = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_9__["getNodeMaxResolution"])(gmfLayer);

    if (maxResolution !== undefined && resolution > maxResolution) {
      view.setResolution(constrainResolution(maxResolution, -1, size));
    }
  }
};

Controller.prototype.toggleSwipeLayer = function (treeCtrl) {
  var _this7 = this;

  if (!treeCtrl.layer) {
    console.error('No layer');
  } else if (this.gmfLayerBeingSwipe.layer === treeCtrl.layer) {
    this.gmfLayerBeingSwipe.layer = null;
    this.map.render();
  } else {
    this.gmfLayerBeingSwipe.layer = null;
    this.$timeout_(function () {
      _this7.gmfLayerBeingSwipe.layer = treeCtrl.layer;

      _this7.map.render();
    }, 0);
  }
};

Controller.prototype.toggleNodeLegend = function (legendNodeId) {
  var div = document.querySelector(legendNodeId);

  if (div) {
    div.classList.toggle('show');
  }
};

Controller.prototype.toggleFiltrableDataSource = function (ds) {
  this.gmfDataSourceBeingFiltered.dataSource = ds;
};

Controller.prototype.isNodeLegendVisible = function (legendNodeId) {
  return $(legendNodeId).is(':visible');
};

Controller.prototype.supportsCustomization = function (treeCtrl) {
  return !treeCtrl.isRoot && (this.supportsLegend(treeCtrl) || this.supportsOpacityChange(treeCtrl));
};

Controller.prototype.supportsLegend = function (treeCtrl) {
  var node = treeCtrl.node;
  return !!node.metadata && !!node.metadata.legend && !!this.getLegendsObject(treeCtrl);
};

Controller.prototype.supportsOpacityChange = function (treeCtrl) {
  var node = treeCtrl.node;
  var parentNode = treeCtrl.parent.node;
  return !!treeCtrl.layer && (treeCtrl.depth === 1 && !node.mixed || treeCtrl.depth > 1 && parentNode.mixed);
};

module.controller('GmfLayertreeController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/layertree/datasourceGroupTreeComponent.html":
/*!**********************************************************************!*\
  !*** ./contribs/gmf/src/layertree/datasourceGroupTreeComponent.html ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n  class="gmf-layertree-group gmf-layertree-depth-1 {{$ctrl.group.visibilityState}}"\n>\n  <a\n    data-toggle="collapse"\n    href="#gmf-layertree-layer-group-{{::$ctrl.getGroupUid()}}"\n    aria-expanded="true"\n    class="fa gmf-layertree-expand-node fa-fw">\n  </a>\n\n  <a\n    class="fa fa-fw gmf-layertree-state"\n    href\n    ng-click="$ctrl.toggle()"\n  >' +
((__t = (__webpack_require__(/*! gmf/icons/layers.svg?viewbox&height=1em */ "./contribs/gmf/src/icons/layers.svg?viewbox&height=1em"))) == null ? '' : __t) +
'</a>\n\n  <a\n    class="gmf-layertree-name"\n    href\n    ng-click="$ctrl.toggle()"\n  >\n    <span>{{$ctrl.group.title | translate}}</span>\n  </a>\n\n  <span class="gmf-layertree-right-buttons">\n    <a\n      href=""\n      ng-click="$ctrl.remove()">\n      <span class="fa fa-trash"></span>\n    </a>\n  </span>\n</div>\n\n<ul\n  id="gmf-layertree-layer-group-{{::$ctrl.getGroupUid()}}"\n  class="collapse in"\n>\n  <li\n    class="gmf-layertree-node gmf-layertree-depth-2"\n    ng-class="[dataSource.visible ? \'on\' : \'off\']"\n    ng-repeat="dataSource in $ctrl.group.dataSources"\n  >\n    <div class="gmf-layertree-leaf">\n      <a\n        href\n        ng-click="$ctrl.toggleDataSource(dataSource)"\n        class="gmf-layertree-layer-icon gmf-layertree-no-layer-icon"\n      >\n      </a>\n      <a\n        class="gmf-layertree-name"\n        href\n        ng-click="$ctrl.toggleDataSource(dataSource)"\n      >\n        <span>{{dataSource.name | translate}}</span>\n      </a>\n\n      <span class="gmf-layertree-right-buttons">\n        <a\n          href=""\n          ng-click="$ctrl.removeDataSource(dataSource)">\n          <span class="fa fa-trash"></span>\n        </a>\n      </span>\n    </div>\n  </li>\n</ul>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/layertree/datasourceGroupTreeComponent.js":
/*!********************************************************************!*\
  !*** ./contribs/gmf/src/layertree/datasourceGroupTreeComponent.js ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/datasource/DataSources.js */ "./src/datasource/DataSources.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");



var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfLayertreeDatasourceGroupTreeComponent', [ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/layertree/datasourceGroupTreeComponent', __webpack_require__(/*! ./datasourceGroupTreeComponent.html */ "./contribs/gmf/src/layertree/datasourceGroupTreeComponent.html"));
}]);
module.value('gmfLayertreeDatasourceGroupTreeTemplateUrl', function ($attrs) {
  var templateUrl = $attrs['gmfLayertreeDatasourceGroupTreeTemplateUrl'];
  return templateUrl !== undefined ? templateUrl : 'gmf/layertree/datasourceGroupTreeComponent';
});
gmfLayertreeDatasourceGroupTreeTemplateUrl.$inject = ["$attrs", "gmfLayertreeDatasourceGroupTreeTemplateUrl"];

function gmfLayertreeDatasourceGroupTreeTemplateUrl($attrs, gmfLayertreeDatasourceGroupTreeTemplateUrl) {
  return gmfLayertreeDatasourceGroupTreeTemplateUrl($attrs);
}

var Controller = function () {
  Controller.$inject = ["$scope", "ngeoDataSources"];

  function Controller($scope, ngeoDataSources) {
    this.group = null;
    this.scope_ = $scope;
    this.dataSources_ = ngeoDataSources.collection;
  }

  var _proto = Controller.prototype;

  _proto.getGroupUid = function getGroupUid() {
    return "datasourcegrouptree-" + Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(this.group);
  };

  _proto.toggle = function toggle() {
    if (!this.group) {
      throw new Error('Missing group');
    }

    this.group.toggleVisibilityState();
  };

  _proto.toggleDataSource = function toggleDataSource(dataSource) {
    dataSource.visible = !dataSource.visible;
  };

  _proto.remove = function remove() {
    if (!this.group) {
      throw new Error('Missing group');
    }

    for (var i = this.group.dataSources.length - 1, ii = 0; i >= ii; i--) {
      this.dataSources_.remove(this.group.dataSources[i]);
    }
  };

  _proto.removeDataSource = function removeDataSource(dataSource) {
    this.dataSources_.remove(dataSource);
  };

  return Controller;
}();

module.component('gmfDatasourcegrouptree', {
  bindings: {
    'group': '<'
  },
  controller: Controller,
  templateUrl: gmfLayertreeDatasourceGroupTreeTemplateUrl
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/layertree/module.js":
/*!**********************************************!*\
  !*** ./contribs/gmf/src/layertree/module.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_layertree_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/layertree/component.js */ "./contribs/gmf/src/layertree/component.js");
/* harmony import */ var gmf_layertree_datasourceGroupTreeComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/layertree/datasourceGroupTreeComponent.js */ "./contribs/gmf/src/layertree/datasourceGroupTreeComponent.js");
/* harmony import */ var gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/layertree/SyncLayertreeMap.js */ "./contribs/gmf/src/layertree/SyncLayertreeMap.js");
/* harmony import */ var gmf_layertree_timeSliderComponent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/layertree/timeSliderComponent.js */ "./contribs/gmf/src/layertree/timeSliderComponent.js");
/* harmony import */ var gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/layertree/TreeManager.js */ "./contribs/gmf/src/layertree/TreeManager.js");
/* harmony import */ var _common_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./common.scss */ "./contribs/gmf/src/layertree/common.scss");
/* harmony import */ var _common_scss__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_common_scss__WEBPACK_IMPORTED_MODULE_6__);







/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfLayertreeModule', [gmf_layertree_component_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_layertree_datasourceGroupTreeComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_layertree_SyncLayertreeMap_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, gmf_layertree_timeSliderComponent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_5__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/layertree/timeSliderComponent.js":
/*!***********************************************************!*\
  !*** ./contribs/gmf/src/layertree/timeSliderComponent.js ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/WMSTime.js */ "./src/misc/WMSTime.js");
/* harmony import */ var ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/misc/debounce.js */ "./src/misc/debounce.js");
/* harmony import */ var jquery_ui_ui_widgets_slider_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jquery-ui/ui/widgets/slider.js */ "./node_modules/jquery-ui/ui/widgets/slider.js");
/* harmony import */ var jquery_ui_ui_widgets_slider_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_slider_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/sass/jquery-ui.scss */ "./src/sass/jquery-ui.scss");
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var angular_ui_slider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! angular-ui-slider */ "./node_modules/angular-ui-slider/src/index.js");
/* harmony import */ var angular_ui_slider__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(angular_ui_slider__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _timeslider_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./timeslider.scss */ "./contribs/gmf/src/layertree/timeslider.scss");
/* harmony import */ var _timeslider_scss__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_timeslider_scss__WEBPACK_IMPORTED_MODULE_6__);
Controller.$inject = ["ngeoWMSTime", "ngeoDebounce"];







var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfLayertreeTimeSliderComponent', [ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, 'ui.slider']);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/layertree/timesliderComponent', __webpack_require__(/*! ./timesliderComponent.html */ "./contribs/gmf/src/layertree/timesliderComponent.html"));
}]);

function layertreeTimeSliderComponent() {
  return {
    scope: {
      onDateSelected: '&gmfTimeSliderOnDateSelected',
      time: '=gmfTimeSliderTime'
    },
    bindToController: true,
    controller: 'gmfTimeSliderController as sliderCtrl',
    restrict: 'AE',
    templateUrl: 'gmf/layertree/timesliderComponent',
    link: {
      pre: function preLink(scope, element, attrs, ctrl) {
        if (!ctrl) {
          throw new Error('Missing ctrl');
        }

        ctrl.init();
        ctrl.sliderOptions.stop = onSliderReleased_;
        ctrl.sliderOptions.slide = ctrl.ngeoDebounce_(onSliderReleased_, 300, true);

        function onSliderReleased_(e, sliderUi) {
          if (!ctrl) {
            throw new Error('Missing ctrl');
          }

          ctrl.onDateSelected({
            time: computeDates_(e, sliderUi)
          });
          scope.$apply();
        }

        function computeDates_(e, sliderUi) {
          if (!ctrl) {
            throw new Error('Missing ctrl');
          }

          var sDate, eDate, wmstime;

          if (sliderUi.values) {
            sDate = new Date(ctrl.getClosestValue_(sliderUi.values[0]));
            eDate = new Date(ctrl.getClosestValue_(sliderUi.values[1]));
            ctrl.dates = [sDate, eDate];
            wmstime = {
              start: sDate.getTime(),
              end: eDate.getTime()
            };
          } else {
            sDate = new Date(ctrl.getClosestValue_(sliderUi.value));
            ctrl.dates = sDate;
            wmstime = {
              start: sDate.getTime()
            };
          }

          scope.$apply();
          return wmstime;
        }
      }
    }
  };
}

module.directive('gmfTimeSlider', layertreeTimeSliderComponent);

function Controller(ngeoWMSTime, ngeoDebounce) {
  this.ngeoWMSTime_ = ngeoWMSTime;
  this.ngeoDebounce_ = ngeoDebounce;

  this.onDateSelected = function () {
    return undefined;
  };

  this.time = null;
  this.isModeRange = false;
  this.minValue = -1;
  this.maxValue = 999999;
  this.timeValueList = null;
  this.sliderOptions = null;
  this.dates = [];
}

Controller.prototype.init = function () {
  if (!this.time) {
    throw new Error('Missing time');
  }

  var initialOptions_ = this.ngeoWMSTime_.getOptions(this.time);
  this.isModeRange = this.time.mode === 'range';
  this.minValue = initialOptions_.minDate;
  this.maxValue = initialOptions_.maxDate;
  var values = initialOptions_.values;

  if (this.isModeRange) {
    if (!Array.isArray(values)) {
      throw new Error('Wrong Options values');
    }

    this.dates = [values[0], values[1]];
  } else {
    this.dates = initialOptions_.values;
  }

  this.timeValueList = this.getTimeValueList_();
  this.sliderOptions = {
    range: this.isModeRange,
    min: this.minValue,
    max: this.maxValue
  };
};

Controller.prototype.getTimeValueList_ = function () {
  if (!this.time) {
    throw new Error('Missing time');
  }

  var wmsTime = this.time;
  var timeValueList = [];
  var minDate = new Date(this.minValue);
  var maxDate = new Date(this.maxValue);

  if (wmsTime.values) {
    timeValueList = [];
    wmsTime.values.forEach(function (date) {
      timeValueList.push(new Date(date).getTime());
    });
  } else {
    var maxNbValues = 1024;
    var endDate = new Date(minDate.getTime());
    endDate.setFullYear(minDate.getFullYear() + maxNbValues * wmsTime.interval[0]);
    endDate.setMonth(minDate.getMonth() + maxNbValues * wmsTime.interval[1], minDate.getDate() + maxNbValues * wmsTime.interval[2]);
    endDate.setSeconds(minDate.getSeconds() + maxNbValues * wmsTime.interval[3]);

    if (endDate > maxDate) {
      timeValueList = [];

      for (var i = 0;; i++) {
        var nextDate = new Date(minDate.getTime());
        nextDate.setFullYear(minDate.getFullYear() + i * wmsTime.interval[0]);
        nextDate.setMonth(minDate.getMonth() + i * wmsTime.interval[1], minDate.getDate() + i * wmsTime.interval[2]);
        nextDate.setSeconds(minDate.getSeconds() + i * wmsTime.interval[3]);

        if (nextDate <= maxDate) {
          timeValueList.push(nextDate.getTime());
        } else {
          break;
        }
      }
    }
  }

  return timeValueList;
};

Controller.prototype.getClosestValue_ = function (timestamp) {
  if (!this.time) {
    throw new Error('Missing time');
  }

  if (timestamp <= this.minValue) {
    return this.minValue;
  }

  if (timestamp >= this.maxValue) {
    return this.maxValue;
  }

  if (this.timeValueList) {
    var index;
    var leftIndex = 0;
    var rightIndex = this.timeValueList.length - 1;

    while (rightIndex - leftIndex > 1) {
      index = Math.floor((leftIndex + rightIndex) / 2);

      if (this.timeValueList[index] >= timestamp) {
        rightIndex = index;
      } else {
        leftIndex = index;
      }
    }

    var leftDistance = Math.abs(this.timeValueList[leftIndex] - timestamp);
    var rightDistance = Math.abs(this.timeValueList[rightIndex] - timestamp);
    return this.timeValueList[leftDistance < rightDistance ? leftIndex : rightIndex];
  } else {
    var targetDate = new Date(timestamp);
    var startDate = new Date(this.minValue);
    var bestDate = new Date(this.minValue);
    var maxDate = new Date(this.maxValue);
    var bestDistance = Math.abs(targetDate.getTime() - bestDate.getTime());

    for (var i = 1;; i++) {
      var next = new Date(startDate.getTime());
      next.setFullYear(startDate.getFullYear() + i * this.time.interval[0]);
      next.setMonth(startDate.getMonth() + i * this.time.interval[1], startDate.getDate() + i * this.time.interval[2]);
      next.setSeconds(startDate.getSeconds() + i * this.time.interval[3]);

      if (next > maxDate) {
        break;
      }

      var distance = Math.abs(targetDate.getTime() - next.getTime());

      if (distance <= bestDistance) {
        bestDate = next;
        bestDistance = distance;
      } else {
        break;
      }
    }

    return bestDate.getTime();
  }
};

Controller.prototype.getLocalizedDate = function (time) {
  if (!this.time) {
    throw new Error('Missing time');
  }

  return this.ngeoWMSTime_.formatTimeValue(time, this.time.resolution);
};

module.controller('gmfTimeSliderController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/layertree/timeslider.scss":
/*!****************************************************!*\
  !*** ./contribs/gmf/src/layertree/timeslider.scss ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/layertree/timesliderComponent.html":
/*!*************************************************************!*\
  !*** ./contribs/gmf/src/layertree/timesliderComponent.html ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="gmf-time-slider">\n\n  <div\n    ui-slider="sliderCtrl.sliderOptions"\n    ng-model="sliderCtrl.dates">\n    <span\n      class="ui-slider-handle ui-state-default ui-corner-all"\n      tabindex="0"\n      data-toggle="tooltip"\n      title="">\n    </span>\n  </div>\n\n  <div class="gmf-time-slider-displayed-dates">\n    <div\n      class="gmf-time-slider-start-date"\n      ng-if="::sliderCtrl.time.mode === \'range\'">\n      <span>{{sliderCtrl.getLocalizedDate(sliderCtrl.dates[0])}}</span>\n    </div>\n\n    <div\n      class="gmf-time-slider-start-date"\n      ng-if="::sliderCtrl.time.mode === \'value\'">\n      <span>{{sliderCtrl.getLocalizedDate(sliderCtrl.dates)}}</span>\n    </div>\n\n    <div\n      class="gmf-time-slider-end-date"\n      ng-if="::sliderCtrl.time.mode === \'range\'">\n      <span>{{sliderCtrl.getLocalizedDate(sliderCtrl.dates[1])}}</span>\n    </div>\n  </div>\n\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/map/component.html":
/*!*********************************************!*\
  !*** ./contribs/gmf/src/map/component.html ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n    ngeo-map="ctrl.map"\n    ngeo-map-manage-resize="ctrl.manageResize"\n    ngeo-map-resize-transition="ctrl.resizeTransition">\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/map/component.js":
/*!*******************************************!*\
  !*** ./contribs/gmf/src/map/component.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_permalink_module_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/permalink/module.js */ "./contribs/gmf/src/permalink/module.js");
/* harmony import */ var gmf_editing_Snapping_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/editing/Snapping.js */ "./contribs/gmf/src/editing/Snapping.js");
/* harmony import */ var ngeo_map_module_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/map/module.js */ "./src/map/module.js");
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
Controller.$inject = ["ngeoFeatureOverlayMgr", "gmfPermalink", "gmfSnapping"];





var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfMapComponent', [gmf_permalink_module_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_editing_Snapping_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_map_module_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_4__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/map', __webpack_require__(/*! ./component.html */ "./contribs/gmf/src/map/component.html"));
}]);

function gmfMapComponent() {
  return {
    scope: {
      'map': '<gmfMapMap',
      'manageResize': '<gmfMapManageResize',
      'resizeTransition': '<gmfMapResizeTransition'
    },
    controller: 'GmfMapController as ctrl',
    bindToController: true,
    templateUrl: 'gmf/map'
  };
}

module.directive('gmfMap', gmfMapComponent);

function Controller(ngeoFeatureOverlayMgr, gmfPermalink, gmfSnapping) {
  this.map = null;
  this.manageResize = null;
  this.resizeTransition = null;
  this.ngeoFeatureOverlayMgr_ = ngeoFeatureOverlayMgr;
  this.gmfPermalink_ = gmfPermalink;
  this.gmfSnapping_ = gmfSnapping;
}

Controller.prototype.$onInit = function () {
  if (!this.map) {
    throw new Error('Missing map');
  }

  this.ngeoFeatureOverlayMgr_.init(this.map);
  this.gmfPermalink_.setMap(this.map);
  this.gmfSnapping_.setMap(this.map);
};

module.controller('GmfMapController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/map/module.js":
/*!****************************************!*\
  !*** ./contribs/gmf/src/map/module.js ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_map_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/map/component.js */ "./contribs/gmf/src/map/component.js");
/* harmony import */ var gmf_map_mousepositionComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/map/mousepositionComponent.js */ "./contribs/gmf/src/map/mousepositionComponent.js");



/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfMapModule', [gmf_map_component_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_map_mousepositionComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/map/mousepositionComponent.html":
/*!**********************************************************!*\
  !*** ./contribs/gmf/src/map/mousepositionComponent.html ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="btn-group dropup">\n  <button class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">\n    <span class="gmf-mouseposition-control-target"></span>\n  </button>\n  <ul class="dropdown-menu dropdown-menu-right" role="menu">\n    <li class="dropdown-header" translate>Coordinate systems</li>\n    <li ng-repeat="projitem in ::ctrl.projections">\n      <a href ng-click="ctrl.setProjection(projitem)">\n        <span class="fa fa-fw" ng-class="{\'fa-check\': ctrl.projection == projitem}"></span>\n        {{::projitem.label}}\n      </a>\n    </li>\n  </ul>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/map/mousepositionComponent.js":
/*!********************************************************!*\
  !*** ./contribs/gmf/src/map/mousepositionComponent.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/filters.js */ "./src/misc/filters.js");
/* harmony import */ var ol_control_MousePosition_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/control/MousePosition.js */ "./node_modules/ol/control/MousePosition.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");
Controller.$inject = ["$element", "$filter", "$scope", "gettextCatalog"];




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfMapMouseposition', [ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/map/mousepositionComponent', __webpack_require__(/*! ./mousepositionComponent.html */ "./contribs/gmf/src/map/mousepositionComponent.html"));
}]);
module.value('gmfMapMousepositionTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.gmfMapMousepositionTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'gmf/map/mousepositionComponent';
});
gmfMapMousepositionTemplateUrl.$inject = ["$attrs", "gmfMapMousepositionTemplateUrl"];

function gmfMapMousepositionTemplateUrl($attrs, gmfMapMousepositionTemplateUrl) {
  return gmfMapMousepositionTemplateUrl($attrs);
}

var mapMousepositionComponent = {
  controller: 'gmfMousepositionController as ctrl',
  bindings: {
    'map': '<gmfMousepositionMap',
    'projections': '<gmfMousepositionProjections'
  },
  templateUrl: gmfMapMousepositionTemplateUrl
};
module.component('gmfMouseposition', mapMousepositionComponent);

function Controller($element, $filter, $scope, gettextCatalog) {
  this.map = null;
  this.projections = [];
  this.projection = null;
  this.$scope_ = $scope;
  this.gettextCatalog_ = gettextCatalog;
  this.$element_ = $element;
  this.$filter_ = $filter;
  this.control_ = null;
}

Controller.prototype.$onInit = function () {
  var _this = this;

  this.$scope_.$on('gettextLanguageChanged', function () {
    _this.initOlControl_();
  });
  this.initOlControl_();
};

Controller.prototype.initOlControl_ = function () {
  var _this2 = this;

  if (!this.map) {
    throw new Error('Missing map');
  }

  if (this.control_ !== null) {
    this.map.removeControl(this.control_);
  }

  var formatFn = function formatFn(coordinates) {
    if (!_this2.projection) {
      throw new Error('Missing projection');
    }

    var filterAndArgs = _this2.projection.filter.split(':');

    var shiftedFilterAndArgs = filterAndArgs.shift();

    if (!shiftedFilterAndArgs) {
      throw new Error('Missing shiftedFilterAndArgs');
    }

    var filter = _this2.$filter_(shiftedFilterAndArgs);

    if (typeof filter != 'function') {
      throw new Error('Wrong filter type');
    }

    var args = filterAndArgs;
    args.unshift(coordinates);
    return filter.apply(_this2, args);
  };

  var gettextCatalog = this.gettextCatalog_;
  this.control_ = new ol_control_MousePosition_js__WEBPACK_IMPORTED_MODULE_2__["default"]({
    className: 'gmf-mouseposition-control',
    coordinateFormat: formatFn,
    target: this.$element_.find('.gmf-mouseposition-control-target').get(0),
    undefinedHTML: gettextCatalog.getString('Coordinates')
  });
  this.setProjection(this.projections[0]);
  this.map.addControl(this.control_);
};

Controller.prototype.setProjection = function (projection) {
  if (!this.control_) {
    throw new Error('Missing control');
  }

  this.control_.setProjection(projection.code);
  this.projection = projection;
};

module.controller('gmfMousepositionController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/permalink/Permalink.js":
/*!*************************************************!*\
  !*** ./contribs/gmf/src/permalink/Permalink.js ***!
  \*************************************************/
/*! exports provided: OpenLayersLayerProperties, PermalinkService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OpenLayersLayerProperties", function() { return OpenLayersLayerProperties; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PermalinkService", function() { return PermalinkService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/index.js */ "./contribs/gmf/src/index.js");
/* harmony import */ var gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/authentication/Service.js */ "./contribs/gmf/src/authentication/Service.js");
/* harmony import */ var gmf_datasource_LayerBeingSwipe_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/datasource/LayerBeingSwipe.js */ "./contribs/gmf/src/datasource/LayerBeingSwipe.js");
/* harmony import */ var gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/theme/Manager.js */ "./contribs/gmf/src/theme/Manager.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_Popover_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/Popover.js */ "./src/Popover.js");
/* harmony import */ var ngeo_draw_features_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/draw/features.js */ "./src/draw/features.js");
/* harmony import */ var ngeo_datasource_Group_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/datasource/Group.js */ "./src/datasource/Group.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
/* harmony import */ var ngeo_olcs_constants_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/olcs/constants.js */ "./src/olcs/constants.js");
/* harmony import */ var ngeo_format_FeatureHash_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/format/FeatureHash.js */ "./src/format/FeatureHash.js");
/* harmony import */ var ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/format/FeatureProperties.js */ "./src/format/FeatureProperties.js");
/* harmony import */ var ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ngeo/misc/debounce.js */ "./src/misc/debounce.js");
/* harmony import */ var ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ngeo/misc/EventHelper.js */ "./src/misc/EventHelper.js");
/* harmony import */ var ngeo_statemanager_module_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ngeo/statemanager/module.js */ "./src/statemanager/module.js");
/* harmony import */ var ngeo_statemanager_Service_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ngeo/statemanager/Service.js */ "./src/statemanager/Service.js");
/* harmony import */ var ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ngeo/layertree/Controller.js */ "./src/layertree/Controller.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ol/geom/MultiPoint.js */ "./node_modules/ol/geom/MultiPoint.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_style_Icon_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ol/style/Icon.js */ "./node_modules/ol/style/Icon.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ol/layer/Group.js */ "./node_modules/ol/layer/Group.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
PermalinkService.$inject = ["$q", "$timeout", "$rootScope", "$injector", "ngeoDebounce", "gettextCatalog", "ngeoEventHelper", "ngeoStateManager", "ngeoLocation", "gmfLayerBeingSwipe"];



























var OpenLayersLayerProperties = {
  OPACITY: 'opacity'
};
var ExtDSSeparator = {
  LIST: ',',
  NAMES: ';'
};
var ParamPrefix = {
  DIMENSIONS: 'dim_',
  TREE_ENABLE: 'tree_enable_',
  TREE_GROUP_LAYERS: 'tree_group_layers_',
  TREE_GROUP_OPACITY: 'tree_group_opacity_',
  TREE_OPACITY: 'tree_opacity_',
  WFS: 'wfs_'
};
function PermalinkService($q, $timeout, $rootScope, $injector, ngeoDebounce, gettextCatalog, ngeoEventHelper, ngeoStateManager, ngeoLocation, gmfLayerBeingSwipe) {
  var _this = this;

  this.q_ = $q;
  this.rootScope_ = $rootScope;
  this.$timeout_ = $timeout;
  this.mapViewPropertyChangeEventKey_ = null;
  this.ngeoDebounce_ = ngeoDebounce;
  this.ngeoEventHelper_ = ngeoEventHelper;
  this.ngeoStateManager_ = ngeoStateManager;
  this.ngeoFeatures_ = $injector.has('ngeoFeatures') ? $injector.get('ngeoFeatures') : null;
  this.ngeoBackgroundLayerMgr_ = $injector.has('ngeoBackgroundLayerMgr') ? $injector.get('ngeoBackgroundLayerMgr') : null;
  this.gmfLayerBeingSwipe_ = gmfLayerBeingSwipe;
  var ngeoFeatureOverlayMgr = $injector.has('ngeoFeatureOverlayMgr') ? $injector.get('ngeoFeatureOverlayMgr') : null;
  this.featureOverlay_ = ngeoFeatureOverlayMgr ? ngeoFeatureOverlayMgr.getFeatureOverlay() : null;
  this.featureHelper_ = $injector.has('ngeoFeatureHelper') ? $injector.get('ngeoFeatureHelper') : null;
  this.ngeoQuerent_ = $injector.has('ngeoQuerent') ? $injector.get('ngeoQuerent') : null;
  var gmfPermalinkOptions = $injector.has('gmfPermalinkOptions') ? $injector.get('gmfPermalinkOptions') : {};

  if (gmfPermalinkOptions.useLocalStorage === true) {
    this.ngeoStateManager_.setUseLocalStorage(true);
  }

  this.crosshairEnabledByDefault_ = !!gmfPermalinkOptions.crosshairEnabledByDefault;
  this.pointRecenterZoom_ = gmfPermalinkOptions.pointRecenterZoom;
  this.gmfExternalDataSourcesManager_ = $injector.has('gmfExternalDataSourcesManager') ? $injector.get('gmfExternalDataSourcesManager') : null;
  this.gmfThemes_ = $injector.has('gmfThemes') ? $injector.get('gmfThemes') : null;
  this.gmfObjectEditingManager_ = $injector.has('gmfObjectEditingManager') ? $injector.get('gmfObjectEditingManager') : null;
  this.gmfThemeManager_ = $injector.has('gmfThemeManager') ? $injector.get('gmfThemeManager') : null;
  this.defaultTheme_ = $injector.has('defaultTheme') ? $injector.get('defaultTheme') : undefined;
  this.gmfTreeManager_ = $injector.has('gmfTreeManager') ? $injector.get('gmfTreeManager') : null;
  this.ngeoLocation_ = ngeoLocation;
  this.ngeoWfsPermalink_ = $injector.has('ngeoWfsPermalink') ? $injector.get('ngeoWfsPermalink') : null;
  this.gmfUser_ = $injector.has('gmfUser') ? $injector.get('gmfUser') : null;
  this.map_ = null;
  this.ngeoAutoProjection_ = $injector.has('ngeoAutoProjection') ? $injector.get('ngeoAutoProjection') : null;
  this.listenerKeys_ = [];
  this.sourceProjections_ = null;

  if (gmfPermalinkOptions.projectionCodes !== undefined && this.ngeoAutoProjection_) {
    var projections = this.ngeoAutoProjection_.getProjectionList(gmfPermalinkOptions.projectionCodes);

    if (projections.length > 0) {
      this.sourceProjections_ = projections;
    }
  }

  this.crosshairFeature_ = null;
  this.crosshairStyle_ = [];

  if (gmfPermalinkOptions.crosshairStyle !== undefined) {
    this.crosshairStyle_ = gmfPermalinkOptions.crosshairStyle;
  } else {
    this.crosshairStyle_ = [new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_24__["default"]({
      image: new ol_style_Icon_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        src: 'data:image/svg+xml;base64,' + btoa(__webpack_require__(/*! gmf/permalink/crosshair.svg */ "./contribs/gmf/src/permalink/crosshair.svg"))
      })
    })];
  }

  this.mapTooltip_ = null;
  this.featureHashFormat_ = new ngeo_format_FeatureHash_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
    setStyle: false,
    encodeStyles: false,
    propertiesType: {
      'fillColor': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].COLOR,
      'fillOpacity': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].OPACITY,
      'fontColor': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].COLOR,
      'fontSize': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].SIZE,
      'isBox': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].IS_RECTANGLE,
      'isCircle': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].IS_CIRCLE,
      'isLabel': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].IS_TEXT,
      'name': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].NAME,
      'pointRadius': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].SIZE,
      'showLabel': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].SHOW_LABEL,
      'showMeasure': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].SHOW_MEASURE,
      'strokeColor': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].COLOR,
      'strokeWidth': ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_12__["default"].STROKE
    },
    defaultValues: {
      'name': function name(feature) {
        var geometry = feature.getGeometry();

        if (!geometry) {
          throw new Error('Missing geometry');
        }

        return gettextCatalog.getString(geometry.getType());
      },
      'fillOpacity': function fillOpacity() {
        return 0.5;
      },
      'showLabel': function showLabel() {
        return false;
      },
      'showMeasure': function showMeasure() {
        return false;
      }
    }
  });

  if (this.ngeoBackgroundLayerMgr_) {
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(this.ngeoBackgroundLayerMgr_, 'change', this.handleBackgroundLayerManagerChange_, this);
  }

  this.rootScope_.$on('ngeo-layertree-state', function (event, treeCtrl, firstParent) {
    var newState = {};

    if (firstParent.node.mixed) {
      var state = treeCtrl.getState();

      if (state !== 'on' && state !== 'off') {
        throw new Error('Wrong state');
      }

      var visible = state === 'on';
      treeCtrl.traverseDepthFirst(function (ctrl) {
        var groupNode = ctrl.node;

        if (groupNode.children === undefined) {
          var param = ParamPrefix.TREE_ENABLE + ctrl.node.name;
          newState[param] = "" + visible;
        }
      });
    } else {
      var gmfLayerNames = [];
      firstParent.traverseDepthFirst(function (ctrl) {
        var groupNode = treeCtrl.node;

        if (groupNode.children === undefined && ctrl.getState() === 'on') {
          gmfLayerNames.push(ctrl.node.name);
        }
      });
      newState["" + ParamPrefix.TREE_GROUP_LAYERS + firstParent.node.name] = gmfLayerNames.join(',');
    }

    _this.ngeoStateManager_.updateState(newState);
  });
  this.rootScope_.$on('ngeo-layertree-opacity', function (event, treeCtrl) {
    var newState = {};
    var opacity = treeCtrl.layer.getOpacity();
    var stateName = "" + (treeCtrl.parent.node.mixed ? ParamPrefix.TREE_OPACITY : ParamPrefix.TREE_GROUP_OPACITY) + treeCtrl.node.name;
    newState[stateName] = opacity;

    _this.ngeoStateManager_.updateState(newState);
  });
  var features = this.getFeatures();

  if (this.ngeoFeatures_) {
    features.forEach(function (feature) {
      if (_this.featureHelper_) {
        _this.featureHelper_.setStyle(feature);
      }

      _this.addNgeoFeature_(feature);
    });
    this.ngeoFeatures_.extend(features);
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(this.ngeoFeatures_, 'add', this.handleNgeoFeaturesAdd_, this);
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(this.ngeoFeatures_, 'remove', this.handleNgeoFeaturesRemove_, this);
  }

  if (this.featureHelper_) {
    this.rootScope_.$on('$localeChangeSuccess', function () {
      features.forEach(function (feature) {
        if (!_this.featureHelper_) {
          throw new Error('Missing featureHelper');
        }

        _this.featureHelper_.setStyle(feature);
      });
    });
  }

  if (this.gmfThemeManager_) {
    this.rootScope_.$on(gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_4__["ThemeEventType"].THEME_NAME_SET, function (event, name) {
      _this.setThemeInUrl_(name);
    });
  }

  this.rootScope_.$watch(function () {
    return _this.gmfLayerBeingSwipe_.layer;
  }, this.handleLayerBeingSwipeChange_.bind(this));
  this.rootScope_.$watch(function () {
    return _this.gmfLayerBeingSwipe_.swipeValue;
  }, this.handleMapSwipeValue_.bind(this));
  this.setExternalDataSourcesStatePromise_ = null;

  if (this.ngeoQuerent_ && this.gmfExternalDataSourcesManager_) {
    this.initExternalDataSources_().then(function () {
      if (!_this.gmfExternalDataSourcesManager_) {
        throw new Error('Missing gmfExternalDataSourcesManager');
      }

      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(_this.gmfExternalDataSourcesManager_.wmsGroupsCollection, 'add', _this.handleExternalDSGroupCollectionAdd_, _this);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(_this.gmfExternalDataSourcesManager_.wmsGroupsCollection, 'remove', _this.handleExternalDSGroupCollectionRemove_, _this);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(_this.gmfExternalDataSourcesManager_.wmtsGroupsCollection, 'add', _this.handleExternalDSGroupCollectionAdd_, _this);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(_this.gmfExternalDataSourcesManager_.wmtsGroupsCollection, 'remove', _this.handleExternalDSGroupCollectionRemove_, _this);

      for (var _iterator = _this.gmfExternalDataSourcesManager_.wmsGroups, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
        var _ref;

        if (_isArray) {
          if (_i >= _iterator.length) break;
          _ref = _iterator[_i++];
        } else {
          _i = _iterator.next();
          if (_i.done) break;
          _ref = _i.value;
        }

        var wmsGroup = _ref;

        _this.registerExternalDSGroup_(wmsGroup);
      }

      for (var _iterator2 = _this.gmfExternalDataSourcesManager_.wmtsGroups, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
        var _ref2;

        if (_isArray2) {
          if (_i2 >= _iterator2.length) break;
          _ref2 = _iterator2[_i2++];
        } else {
          _i2 = _iterator2.next();
          if (_i2.done) break;
          _ref2 = _i2.value;
        }

        var wmtsGroup = _ref2;

        _this.registerExternalDSGroup_(wmtsGroup);
      }
    });
  }

  this.initLayers_();
}

PermalinkService.prototype.handleLayerBeingSwipeChange_ = function (layer, oldLayer) {
  if (layer === oldLayer) {
    return;
  }

  if (layer) {
    var object = {};
    var mapSwipeValue = this.gmfLayerBeingSwipe_.swipeValue;

    if (mapSwipeValue === null) {
      this.gmfLayerBeingSwipe_.swipeValue = 0.5;
    }

    var dataSourceId = layer.get('dataSourceId');
    object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_SWIPE] = dataSourceId;
    object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_SWIPE_VALUE] = mapSwipeValue;
    this.ngeoStateManager_.updateState(object);
  } else {
    this.ngeoStateManager_.deleteParam(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_SWIPE);
    this.ngeoStateManager_.deleteParam(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_SWIPE_VALUE);
  }
};

PermalinkService.prototype.handleMapSwipeValue_ = function () {
  var mapSwipeValue = this.gmfLayerBeingSwipe_.swipeValue;
  var object = {};

  if (mapSwipeValue && mapSwipeValue !== null && mapSwipeValue !== undefined) {
    object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_SWIPE_VALUE] = mapSwipeValue;
    this.ngeoStateManager_.updateState(object);
  }
};

PermalinkService.prototype.getMapCenter = function () {
  if (!this.map_) {
    throw new Error('Missing map');
  }

  var x = this.ngeoStateManager_.getInitialNumberValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_X);
  var y = this.ngeoStateManager_.getInitialNumberValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_Y);

  if (x !== undefined && y !== undefined && !isNaN(x) && !isNaN(y)) {
    var center = [x, y];

    if (this.sourceProjections_ !== null && this.ngeoAutoProjection_) {
      var targetProjection = this.map_.getView().getProjection();
      var reprojectedCenter = this.ngeoAutoProjection_.tryProjectionsWithInversion(center, targetProjection.getExtent(), targetProjection, this.sourceProjections_);

      if (reprojectedCenter) {
        return reprojectedCenter;
      }
    }

    return center;
  }

  return null;
};

PermalinkService.prototype.getMapZoom = function () {
  var zoom = this.ngeoStateManager_.getInitialNumberValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_Z);
  return zoom !== undefined && isNaN(zoom) ? undefined : zoom;
};

PermalinkService.prototype.getMapCrosshair = function () {
  var crosshair = this.ngeoStateManager_.getInitialBooleanValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_CROSSHAIR);
  return crosshair === undefined ? this.crosshairEnabledByDefault_ : crosshair;
};

PermalinkService.prototype.setMapCrosshair = function (opt_center) {
  if (!this.map_) {
    throw new Error('Missing map');
  }

  if (!this.featureOverlay_) {
    throw new Error('Missing featureOverlay');
  }

  var crosshairCoordinate;

  if (opt_center) {
    crosshairCoordinate = opt_center;
  } else {
    crosshairCoordinate = this.map_.getView().getCenter();
  }

  if (!Array.isArray(crosshairCoordinate)) {
    throw new Error('Wrong crosshairCoordinate');
  }

  if (this.crosshairFeature_) {
    this.featureOverlay_.removeFeature(this.crosshairFeature_);
  }

  this.crosshairFeature_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_20__["default"](new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_22__["default"](crosshairCoordinate));
  this.crosshairFeature_.setStyle(this.crosshairStyle_);
  this.featureOverlay_.addFeature(this.crosshairFeature_);
};

PermalinkService.prototype.getMapTooltip = function () {
  return this.ngeoStateManager_.getInitialStringValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_TOOLTIP);
};

PermalinkService.prototype.setMapTooltip = function (tooltipText, opt_center) {
  if (!this.map_) {
    throw new Error('Missing map');
  }

  var tooltipPosition;

  if (opt_center) {
    tooltipPosition = opt_center;
  } else {
    var center = this.map_.getView().getCenter();

    if (!center) {
      throw new Error('Missing center');
    }

    tooltipPosition = center;
  }

  if (!Array.isArray(tooltipPosition)) {
    throw new Error('Wrong tooltipPosition type');
  }

  var div = $('<div/>', {
    'class': 'gmf-permalink-tooltip',
    'text': tooltipText
  })[0];

  if (this.mapTooltip_ !== null) {
    this.map_.removeOverlay(this.mapTooltip_);
  }

  this.mapTooltip_ = new ngeo_Popover_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
    element: div,
    position: tooltipPosition
  });
  this.map_.addOverlay(this.mapTooltip_);
};

PermalinkService.prototype.getFeatures = function () {
  var f = this.ngeoStateManager_.getInitialStringValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].FEATURES);

  if (f !== undefined && f !== '') {
    return this.featureHashFormat_.readFeatures(f);
  }

  return [];
};

PermalinkService.prototype.setDimensions = function (dimensions) {
  var _this2 = this;

  var keys = this.ngeoLocation_.getParamKeysWithPrefix(ParamPrefix.DIMENSIONS);

  for (var _iterator3 = keys, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
    var _ref3;

    if (_isArray3) {
      if (_i3 >= _iterator3.length) break;
      _ref3 = _iterator3[_i3++];
    } else {
      _i3 = _iterator3.next();
      if (_i3.done) break;
      _ref3 = _i3.value;
    }

    var key = _ref3;
    var value = this.ngeoLocation_.getParam(key);

    if (!value) {
      throw new Error('Missing value');
    }

    dimensions[key.slice(ParamPrefix.DIMENSIONS.length)] = value;
  }

  this.rootScope_.$watchCollection(function () {
    return dimensions;
  }, function (dimensions) {
    var params = {};

    for (var key in dimensions) {
      params[ParamPrefix.DIMENSIONS + key] = dimensions[key];
    }

    _this2.ngeoLocation_.updateParams(params);
  });
};

PermalinkService.prototype.setMap = function (map) {
  var _this3 = this;

  if (map === this.map_) {
    return;
  }

  if (this.map_) {
    this.unregisterMap_();
    this.map_ = null;
  }

  if (map) {
    this.map_ = map;

    if (this.gmfObjectEditingManager_) {
      this.gmfObjectEditingManager_.getFeature().then(function (feature) {
        _this3.registerMap_(map, feature);
      });
    } else {
      this.registerMap_(map, null);
    }
  }
};

PermalinkService.prototype.registerMap_ = function (map, oeFeature) {
  var _this4 = this;

  var view = map.getView();
  var center;
  var geom = typeof oeFeature !== 'undefined' && oeFeature !== null ? oeFeature.getGeometry() : undefined;

  if (geom) {
    var size = map.getSize();

    if (!size) {
      throw new Error('Missing size');
    }

    var maxZoom;

    if (geom instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_22__["default"] || geom instanceof ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_21__["default"]) {
      maxZoom = this.pointRecenterZoom_;
    }

    var options = {
      size: size
    };

    if (maxZoom) {
      options.maxZoom = maxZoom;
    }

    view.fit(geom.getExtent(), options);
  } else {
    var enabled3d = this.ngeoStateManager_.getInitialBooleanValue(ngeo_olcs_constants_js__WEBPACK_IMPORTED_MODULE_10__["Permalink3dParam"].ENABLED);

    if (!enabled3d) {
      center = this.getMapCenter();

      if (center) {
        view.setCenter(center);
      }

      var zoom = this.getMapZoom();

      if (zoom !== undefined) {
        view.setZoom(zoom);
      }
    }
  }

  this.mapViewPropertyChangeEventKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(view, 'propertychange', this.ngeoDebounce_(function () {
    var center = view.getCenter();

    if (!center) {
      throw new Error('Missing center');
    }

    var zoom = view.getZoom();
    var object = {};
    object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_X] = "" + Math.round(center[0]);
    object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_Y] = "" + Math.round(center[1]);
    object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_Z] = "" + zoom;

    _this4.ngeoStateManager_.updateState(object);
  }, 300, true), this);

  if (this.getMapCrosshair() && this.featureOverlay_) {
    this.setMapCrosshair(center);
  }

  var tooltipText = this.getMapTooltip();

  if (tooltipText) {
    this.setMapTooltip(tooltipText, center);
  }

  var wfsPermalinkData = this.getWfsPermalinkData_();

  if (wfsPermalinkData !== null && this.ngeoWfsPermalink_) {
    this.ngeoWfsPermalink_.issue(wfsPermalinkData, map);
  }
};

PermalinkService.prototype.unregisterMap_ = function () {
  if (!this.mapViewPropertyChangeEventKey_) {
    throw new Error('Missing mapViewPropertyChangeEventKey');
  }

  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["unlistenByKey"])(this.mapViewPropertyChangeEventKey_);
  this.mapViewPropertyChangeEventKey_ = null;
};

PermalinkService.prototype.getBackgroundLayer = function (layers) {
  var layerName = this.ngeoStateManager_.getInitialStringValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].BG_LAYER);

  if (layerName !== undefined) {
    for (var _iterator4 = layers, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {
      var _ref4;

      if (_isArray4) {
        if (_i4 >= _iterator4.length) break;
        _ref4 = _iterator4[_i4++];
      } else {
        _i4 = _iterator4.next();
        if (_i4.done) break;
        _ref4 = _i4.value;
      }

      var layer = _ref4;

      if (layer.get('label') === layerName) {
        return layer;
      }
    }
  }

  return null;
};

PermalinkService.prototype.getBackgroundLayerOpacity = function () {
  var opacity_ = this.ngeoStateManager_.getInitialNumberValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].BG_LAYER_OPACITY);
  return opacity_ === undefined ? null : opacity_ / 100;
};

PermalinkService.prototype.handleBackgroundLayerManagerChange_ = function () {
  var _this5 = this;

  if (!this.map_ || !this.ngeoBackgroundLayerMgr_) {
    return;
  }

  var layer = this.ngeoBackgroundLayerMgr_.get(this.map_);

  if (!layer) {
    throw new Error('Missing layer');
  }

  var layerName = layer.get('label');

  if (typeof layerName != 'string') {
    throw new Error('Wrong layerName type');
  }

  var object = {};
  object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].BG_LAYER] = layerName;
  this.ngeoStateManager_.updateState(object);
  var backgroundLayer = this.ngeoBackgroundLayerMgr_.getOpacityBgLayer(this.map_);

  if (backgroundLayer) {
    var opacity = this.getBackgroundLayerOpacity();

    if (opacity !== null) {
      backgroundLayer.setOpacity(opacity);
    } else {
      var _opacity = backgroundLayer.getOpacity();

      var _object = {};
      _object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].BG_LAYER_OPACITY] = "" + _opacity * 100;
      this.ngeoStateManager_.updateState(_object);
    }

    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(backgroundLayer, 'change:opacity', function () {
      var opacity = backgroundLayer.getOpacity();
      var object = {};
      object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].BG_LAYER_OPACITY] = "" + opacity * 100;

      _this5.ngeoStateManager_.updateState(object);
    });
  }
};

PermalinkService.prototype.refreshFirstLevelGroups = function () {
  if (!this.gmfTreeManager_) {
    return;
  }

  if (!this.gmfTreeManager_.rootCtrl) {
    throw new Error('Missing gmfTreeManager_.rootCtrl');
  }

  var groupNode = this.gmfTreeManager_.rootCtrl.node;
  var groupNodes = groupNode.children;
  var orderedNames = groupNodes ? groupNodes.map(function (node) {
    return node.name;
  }) : [];
  var object = {};
  object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].TREE_GROUPS] = orderedNames.join(',');
  this.ngeoStateManager_.updateState(object);
};

PermalinkService.prototype.themeInUrl_ = function (pathElements) {
  var indexOfTheme = pathElements.indexOf('theme');
  return indexOfTheme != -1 && indexOfTheme == pathElements.length - 2;
};

PermalinkService.prototype.setThemeInUrl_ = function (themeName) {
  var path = this.ngeoLocation_.getPath();

  if (!path) {
    throw new Error('Missing path');
  }

  if (themeName) {
    var pathElements = path.split('/');

    if (pathElements.length <= 1) {
      throw new Error('Wrong pathElements');
    }

    if (pathElements[pathElements.length - 1] === '') {
      pathElements.splice(pathElements.length - 1);
    }

    if (this.themeInUrl_(pathElements)) {
      pathElements[pathElements.length - 1] = themeName;
    } else {
      pathElements.push('theme', themeName);
    }

    this.ngeoLocation_.setPath(pathElements.join('/'));
  }
};

PermalinkService.prototype.defaultThemeName = function () {
  var path = this.ngeoLocation_.getPath();

  if (!path) {
    throw new Error('Missing path');
  }

  var pathElements = path.split('/');

  if (this.themeInUrl_(pathElements)) {
    return decodeURI(pathElements[pathElements.length - 1]);
  }

  var tn = this.ngeoStateManager_.getInitialStringValue('theme');

  if (tn) {
    return tn;
  }

  var defaultTheme = this.defaultThemeNameFromFunctionalities();

  if (defaultTheme !== null) {
    return defaultTheme;
  }

  if (this.defaultTheme_) {
    return this.defaultTheme_;
  }

  return null;
};

PermalinkService.prototype.defaultThemeNameFromFunctionalities = function () {
  if (!this.gmfUser_) {
    return null;
  }

  var functionalities = this.gmfUser_.functionalities;

  if (functionalities && 'default_theme' in functionalities) {
    var defaultTheme = functionalities.default_theme;

    if (defaultTheme.length > 0) {
      return defaultTheme[0];
    }
  }

  return null;
};

PermalinkService.prototype.initLayers_ = function () {
  var _this6 = this;

  var initialUri = window.location.href;
  var authenticationRequired = false;

  if (!this.gmfThemes_) {
    return;
  }

  this.gmfThemes_.getThemesObject().then(function (themes) {
    var themeName = _this6.defaultThemeName();

    if (_this6.gmfThemeManager_) {
      _this6.gmfThemeManager_.setThemeName(_this6.gmfThemeManager_.modeFlush ? themeName : '');
    }

    var firstLevelGroups = [];
    var theme;

    var groupsNames = _this6.ngeoLocation_.getParam(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].TREE_GROUPS);

    if (groupsNames === undefined) {
      theme = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_5__["findThemeByName"])(themes, themeName);

      if (theme) {
        firstLevelGroups = theme.children;
      }
    } else {
      groupsNames.split(',').forEach(function (groupName) {
        var group = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_5__["findGroupByName"])(themes, groupName);

        if (group) {
          firstLevelGroups.push(group);
        } else {
          authenticationRequired = true;
        }
      });
    }

    if (_this6.gmfTreeManager_) {
      _this6.gmfTreeManager_.setFirstLevelGroups(firstLevelGroups);
    }

    _this6.$timeout_(function () {
      if (!_this6.gmfTreeManager_ || !_this6.gmfTreeManager_.rootCtrl) {
        if (authenticationRequired && _this6.gmfUser_ && _this6.gmfUser_.roles === null) {
          _this6.rootScope_.$broadcast('authenticationrequired', {
            url: initialUri
          });
        }

        return;
      }

      var layerBeingSwipeValue = _this6.ngeoStateManager_.getInitialNumberValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_SWIPE);

      var mapSwipeValue = _this6.ngeoStateManager_.getInitialNumberValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].MAP_SWIPE_VALUE);

      var visitor = function visitor(treeCtrl) {
        if (treeCtrl.isRoot) {
          return undefined;
        }

        var groupNode = treeCtrl.node;
        var parentGroupNode = treeCtrl.parent.node;

        var opacity = _this6.ngeoStateManager_.getInitialNumberValue((parentGroupNode.mixed ? ParamPrefix.TREE_OPACITY : ParamPrefix.TREE_GROUP_OPACITY) + treeCtrl.node.name);

        if (treeCtrl.layer) {
          if (opacity !== undefined) {
            treeCtrl.layer.setOpacity(opacity);
          }

          if (layerBeingSwipeValue !== null && layerBeingSwipeValue !== undefined && treeCtrl.layer.get('dataSourceId') === layerBeingSwipeValue) {
            if (mapSwipeValue !== null && mapSwipeValue !== undefined) {
              _this6.gmfLayerBeingSwipe_.swipeValue = mapSwipeValue;
            }

            _this6.gmfLayerBeingSwipe_.layer = treeCtrl.layer;
          }
        }

        if (treeCtrl.parent.node && parentGroupNode.mixed && groupNode.children == undefined) {
          var enable = _this6.ngeoStateManager_.getInitialBooleanValue(ParamPrefix.TREE_ENABLE + treeCtrl.node.name);

          if (enable !== undefined) {
            treeCtrl.setState(enable ? 'on' : 'off', false);
          }
        } else if (!groupNode.mixed && treeCtrl.depth == 1) {
          var groupLayers = _this6.ngeoStateManager_.getInitialStringValue(ParamPrefix.TREE_GROUP_LAYERS + treeCtrl.node.name);

          if (groupLayers !== undefined) {
            var groupLayersArray = groupLayers == '' ? [] : groupLayers.split(',');

            var _visitor = function _visitor(treeCtrl) {
              var groupNode = treeCtrl.node;

              if (groupNode.children === undefined) {
                var _enable = groupLayersArray.includes(treeCtrl.node.name);

                if (_enable) {
                  groupLayersArray.splice(groupLayersArray.indexOf(treeCtrl.node.name), 1);
                }

                treeCtrl.setState(_enable ? 'on' : 'off', false);
              }

              return undefined;
            };

            treeCtrl.traverseDepthFirst(_visitor);

            if (groupLayersArray.length > 0) {
              authenticationRequired = true;
            }
          }
        }
      };

      _this6.gmfTreeManager_.rootCtrl.traverseDepthFirst(visitor);

      var firstParents = _this6.gmfTreeManager_.rootCtrl.children;
      firstParents.forEach(function (firstParent) {
        firstParent.traverseDepthFirst(function (treeCtrl) {
          if (treeCtrl.getState() !== 'indeterminate') {
            _this6.rootScope_.$broadcast('ngeo-layertree-state', treeCtrl, firstParent);

            return ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_17__["LayertreeVisitorDecision"].STOP;
          }
        });
      });

      if (authenticationRequired && _this6.gmfUser_ && _this6.gmfUser_.roles === null) {
        _this6.rootScope_.$broadcast('authenticationrequired', {
          url: initialUri
        });
      }
    });
  });
};

PermalinkService.prototype.handleNgeoFeaturesAdd_ = function (event) {
  if (event instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_26__["CollectionEvent"]) {
    var feature = event.element;

    if (!(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_20__["default"])) {
      throw new Error('Wrong feature type');
    }

    this.addNgeoFeature_(feature);
  }
};

PermalinkService.prototype.handleNgeoFeaturesRemove_ = function (event) {
  if (event instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_26__["CollectionEvent"]) {
    var feature = event.element;

    if (!(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_20__["default"])) {
      throw new Error('Wrong feature type');
    }

    this.removeNgeoFeature_(feature);
  }
};

PermalinkService.prototype.addNgeoFeature_ = function (feature) {
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_18__["getUid"])(feature);
  this.ngeoEventHelper_.addListenerKey(uid, Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(feature, 'change', this.ngeoDebounce_(this.handleNgeoFeaturesChange_, 250, true), this));
};

PermalinkService.prototype.removeNgeoFeature_ = function (feature) {
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_18__["getUid"])(feature);
  this.ngeoEventHelper_.clearListenerKey(uid);
  this.handleNgeoFeaturesChange_();
};

PermalinkService.prototype.handleNgeoFeaturesChange_ = function () {
  if (!this.ngeoFeatures_) {
    return;
  }

  var features = this.ngeoFeatures_.getArray();
  var data = this.featureHashFormat_.writeFeatures(features);
  var object = {};
  object[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].FEATURES] = data;
  this.ngeoStateManager_.updateState(object);
};

PermalinkService.prototype.getWfsPermalinkData_ = function () {
  var wfsLayer = this.ngeoLocation_.getParam(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].WFS_LAYER);

  if (!wfsLayer) {
    return null;
  }

  var numGroups = this.ngeoLocation_.getParamAsInt(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].WFS_NGROUPS);
  var paramKeys = this.ngeoLocation_.getParamKeysWithPrefix(ParamPrefix.WFS);
  var filterGroups = [];
  var filterGroup;

  if (numGroups === undefined) {
    filterGroup = this.createFilterGroup_(ParamPrefix.WFS, paramKeys);

    if (filterGroup !== null) {
      filterGroups.push(filterGroup);
    }
  } else {
    for (var i = 0; i < numGroups; i++) {
      filterGroup = this.createFilterGroup_("" + ParamPrefix.WFS + i + "_", paramKeys);

      if (filterGroup !== null) {
        filterGroups.push(filterGroup);
      }
    }
  }

  if (filterGroups.length == 0) {
    return null;
  }

  var showFeaturesParam = this.ngeoLocation_.getParam(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].WFS_SHOW_FEATURES);
  var showFeatures = !(showFeaturesParam === '0' || showFeaturesParam === 'false');
  return {
    wfsType: wfsLayer,
    showFeatures: showFeatures,
    filterGroups: filterGroups
  };
};

PermalinkService.prototype.createFilterGroup_ = function (prefix, paramKeys) {
  var _this7 = this;

  var filters = [];
  paramKeys.forEach(function (paramKey) {
    if (paramKey == gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].WFS_LAYER || paramKey == gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].WFS_SHOW_FEATURES || paramKey == gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].WFS_NGROUPS || !paramKey.startsWith(prefix)) {
      return;
    }

    var value = _this7.ngeoLocation_.getParam(paramKey);

    if (!value) {
      return;
    }

    var condition = value.split(',');
    var filter = {
      property: paramKey.replace(prefix, ''),
      condition: condition
    };
    filters.push(filter);
  });
  return filters.length > 0 ? {
    filters: filters
  } : null;
};

PermalinkService.prototype.initExternalDataSources_ = function () {
  var _this8 = this;

  if (!this.ngeoQuerent_) {
    throw new Error('Missing ngeoQuerent');
  }

  if (!this.gmfExternalDataSourcesManager_) {
    throw new Error('Missing gmfExternalDataSourcesManager');
  }

  var ngeoQuerent = this.ngeoQuerent_;
  var gmfExtDSManager = this.gmfExternalDataSourcesManager_;
  var promises = [];
  var layerNamesString = this.ngeoStateManager_.getInitialStringValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].EXTERNAL_DATASOURCES_NAMES);
  var urlsString = this.ngeoStateManager_.getInitialStringValue(gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].EXTERNAL_DATASOURCES_URLS);

  if (layerNamesString && urlsString) {
    var layerNames = layerNamesString.split(ExtDSSeparator.LIST);
    var urls = urlsString.split(ExtDSSeparator.LIST);

    var _loop = function _loop(i, ii) {
      var groupLayerNamesString = layerNames[i];

      if (!groupLayerNamesString) {
        return "break";
      }

      var groupLayerNames = groupLayerNamesString.split(ExtDSSeparator.NAMES);
      var url = urls[i];
      var serviceType = Object(ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_9__["guessServiceTypeByUrl"])(url);

      var getCapabilitiesDefer = _this8.q_.defer();

      promises.push(getCapabilitiesDefer.promise);

      if (serviceType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_9__["Type"].WMS) {
        ngeoQuerent.wmsGetCapabilities(url).then(function (capabilities) {
          getCapabilitiesDefer.resolve({
            capabilities: capabilities,
            groupLayerNames: groupLayerNames,
            serviceType: serviceType,
            url: url
          });
        }, function () {
          getCapabilitiesDefer.reject({
            groupLayerNames: groupLayerNames,
            serviceType: serviceType,
            url: url
          });
        });
      } else if (serviceType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_9__["Type"].WMTS) {
        ngeoQuerent.wmtsGetCapabilities(url).then(function (capabilities) {
          getCapabilitiesDefer.resolve({
            capabilities: capabilities,
            groupLayerNames: groupLayerNames,
            serviceType: serviceType,
            url: url
          });
        }, function () {
          getCapabilitiesDefer.reject({
            groupLayerNames: groupLayerNames,
            serviceType: serviceType,
            url: url
          });
        });
      } else {
        getCapabilitiesDefer.reject({
          groupLayerNames: groupLayerNames,
          serviceType: serviceType,
          url: url
        });
      }
    };

    for (var i = 0, ii = urls.length; i < ii; i++) {
      var _ret = _loop(i, ii);

      if (_ret === "break") break;
    }
  }

  return this.q_.all(promises).then(function (responses) {
    for (var _iterator5 = responses, _isArray5 = Array.isArray(_iterator5), _i5 = 0, _iterator5 = _isArray5 ? _iterator5 : _iterator5[Symbol.iterator]();;) {
      var _ref5;

      if (_isArray5) {
        if (_i5 >= _iterator5.length) break;
        _ref5 = _iterator5[_i5++];
      } else {
        _i5 = _iterator5.next();
        if (_i5.done) break;
        _ref5 = _i5.value;
      }

      var response = _ref5;

      if (response.serviceType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_9__["Type"].WMS) {
        for (var _iterator6 = response.groupLayerNames, _isArray6 = Array.isArray(_iterator6), _i6 = 0, _iterator6 = _isArray6 ? _iterator6 : _iterator6[Symbol.iterator]();;) {
          var _ref6;

          if (_isArray6) {
            if (_i6 >= _iterator6.length) break;
            _ref6 = _iterator6[_i6++];
          } else {
            _i6 = _iterator6.next();
            if (_i6.done) break;
            _ref6 = _i6.value;
          }

          var layerName = _ref6;
          var layerCap = ngeoQuerent.wmsFindLayerCapability(response.capabilities.Capability.Layer.Layer, layerName);

          if (layerCap) {
            gmfExtDSManager.createAndAddDataSourceFromWMSCapability(layerCap, response.capabilities, response.url);
          } else {}
        }
      } else if (response.serviceType === ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_9__["Type"].WMTS) {
        for (var _iterator7 = response.groupLayerNames, _isArray7 = Array.isArray(_iterator7), _i7 = 0, _iterator7 = _isArray7 ? _iterator7 : _iterator7[Symbol.iterator]();;) {
          var _ref7;

          if (_isArray7) {
            if (_i7 >= _iterator7.length) break;
            _ref7 = _iterator7[_i7++];
          } else {
            _i7 = _iterator7.next();
            if (_i7.done) break;
            _ref7 = _i7.value;
          }

          var _layerName = _ref7;

          var _layerCap = ngeoQuerent.wmtsFindLayerCapability(response.capabilities.Contents.Layer, _layerName);

          if (_layerCap) {
            gmfExtDSManager.createAndAddDataSourceFromWMTSCapability(_layerCap, response.capabilities, response.url);
          } else {}
        }
      }
    }
  }, function (rejections) {});
};

PermalinkService.prototype.handleExternalDSGroupCollectionAdd_ = function (evt) {
  if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_26__["CollectionEvent"]) {
    var group = evt.element;

    if (!(group instanceof ngeo_datasource_Group_js__WEBPACK_IMPORTED_MODULE_8__["default"])) {
      throw new Error('Wrong group type');
    }

    this.registerExternalDSGroup_(group);
    this.setExternalDataSourcesState_();
  }
};

PermalinkService.prototype.registerExternalDSGroup_ = function (group) {
  this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(group.dataSourcesCollection, 'add', this.setExternalDataSourcesState_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(group.dataSourcesCollection, 'remove', this.setExternalDataSourcesState_, this));
};

PermalinkService.prototype.containsLayerName = function (layer, name) {
  if (layer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_25__["default"]) {
    for (var _iterator8 = layer.getLayers().getArray(), _isArray8 = Array.isArray(_iterator8), _i8 = 0, _iterator8 = _isArray8 ? _iterator8 : _iterator8[Symbol.iterator]();;) {
      var _ref8;

      if (_isArray8) {
        if (_i8 >= _iterator8.length) break;
        _ref8 = _iterator8[_i8++];
      } else {
        _i8 = _iterator8.next();
        if (_i8.done) break;
        _ref8 = _i8.value;
      }

      var l = _ref8;

      if (!l) {
        throw new Error('Missing layer');
      }

      if (this.containsLayerName(l, name)) {
        return true;
      }
    }

    return false;
  } else {
    return layer.get('layerNodeName') == name;
  }
};

PermalinkService.prototype.handleExternalDSGroupCollectionRemove_ = function (evt) {
  if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_26__["CollectionEvent"]) {
    var group = evt.element;

    if (!(group instanceof ngeo_datasource_Group_js__WEBPACK_IMPORTED_MODULE_8__["default"])) {
      throw new Error('Wrong group type');
    }

    this.unregisterExternalDSGroup_(group);
    this.setExternalDataSourcesState_();
  }
};

PermalinkService.prototype.unregisterExternalDSGroup_ = function (group) {
  this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["unlistenByKey"]);
};

PermalinkService.prototype.setExternalDataSourcesState_ = function () {
  var _this9 = this;

  if (this.setExternalDataSourcesStatePromise_) {
    this.$timeout_.cancel(this.setExternalDataSourcesStatePromise_);
  }

  this.setExternalDataSourcesStatePromise_ = this.$timeout_(function () {
    var _this9$ngeoStateManag;

    if (!_this9.gmfExternalDataSourcesManager_) {
      throw new Error('Missing gmfExternalDataSourcesManager');
    }

    var names = [];
    var urls = [];

    for (var _iterator9 = _this9.gmfExternalDataSourcesManager_.wmsGroups, _isArray9 = Array.isArray(_iterator9), _i9 = 0, _iterator9 = _isArray9 ? _iterator9 : _iterator9[Symbol.iterator]();;) {
      var _ref9;

      if (_isArray9) {
        if (_i9 >= _iterator9.length) break;
        _ref9 = _iterator9[_i9++];
      } else {
        _i9 = _iterator9.next();
        if (_i9.done) break;
        _ref9 = _i9.value;
      }

      var wmsGroup = _ref9;
      urls.push(wmsGroup.url);
      var wmsGroupLayerNames = [];

      for (var _iterator11 = wmsGroup.dataSources, _isArray11 = Array.isArray(_iterator11), _i11 = 0, _iterator11 = _isArray11 ? _iterator11 : _iterator11[Symbol.iterator]();;) {
        var _ref11;

        if (_isArray11) {
          if (_i11 >= _iterator11.length) break;
          _ref11 = _iterator11[_i11++];
        } else {
          _i11 = _iterator11.next();
          if (_i11.done) break;
          _ref11 = _i11.value;
        }

        var wmsDataSource = _ref11;

        if (wmsDataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_9__["default"]) {
          var layerName = wmsDataSource.getWFSLayerNames()[0];
          wmsGroupLayerNames.push(layerName);
        }
      }

      names.push(wmsGroupLayerNames.join(ExtDSSeparator.NAMES));
    }

    for (var _iterator10 = _this9.gmfExternalDataSourcesManager_.wmtsGroups, _isArray10 = Array.isArray(_iterator10), _i10 = 0, _iterator10 = _isArray10 ? _iterator10 : _iterator10[Symbol.iterator]();;) {
      var _ref10;

      if (_isArray10) {
        if (_i10 >= _iterator10.length) break;
        _ref10 = _iterator10[_i10++];
      } else {
        _i10 = _iterator10.next();
        if (_i10.done) break;
        _ref10 = _i10.value;
      }

      var wmtsGroup = _ref10;
      urls.push(wmtsGroup.url);
      var wmtsGroupLayerNames = [];

      for (var _iterator12 = wmtsGroup.dataSources, _isArray12 = Array.isArray(_iterator12), _i12 = 0, _iterator12 = _isArray12 ? _iterator12 : _iterator12[Symbol.iterator]();;) {
        var _ref12;

        if (_isArray12) {
          if (_i12 >= _iterator12.length) break;
          _ref12 = _iterator12[_i12++];
        } else {
          _i12 = _iterator12.next();
          if (_i12.done) break;
          _ref12 = _i12.value;
        }

        var wmtsDataSource = _ref12;

        if (!wmtsDataSource.wmtsLayer) {
          throw new Error('Missing wmtsDataSource.wmtsLayer');
        }

        wmtsGroupLayerNames.push(wmtsDataSource.wmtsLayer);
      }

      names.push(wmtsGroupLayerNames.join(ExtDSSeparator.NAMES));
    }

    _this9.ngeoStateManager_.updateState((_this9$ngeoStateManag = {}, _this9$ngeoStateManag[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].EXTERNAL_DATASOURCES_NAMES] = names.join(ExtDSSeparator.LIST), _this9$ngeoStateManag[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"].EXTERNAL_DATASOURCES_URLS] = urls.join(ExtDSSeparator.LIST), _this9$ngeoStateManag));

    _this9.setExternalDataSourcesStatePromise_ = null;
  });
};

PermalinkService.prototype.cleanParams = function (groups) {
  var _this10 = this;

  var keys = this.ngeoLocation_.getParamKeys();

  for (var _iterator13 = keys, _isArray13 = Array.isArray(_iterator13), _i13 = 0, _iterator13 = _isArray13 ? _iterator13 : _iterator13[Symbol.iterator]();;) {
    var _ref13;

    if (_isArray13) {
      if (_i13 >= _iterator13.length) break;
      _ref13 = _iterator13[_i13++];
    } else {
      _i13 = _iterator13.next();
      if (_i13.done) break;
      _ref13 = _i13.value;
    }

    var key = _ref13;

    if (key.startsWith(ParamPrefix.TREE_GROUP_LAYERS)) {
      var value = key.substring(ParamPrefix.TREE_GROUP_LAYERS.length);

      for (var _iterator15 = groups, _isArray15 = Array.isArray(_iterator15), _i15 = 0, _iterator15 = _isArray15 ? _iterator15 : _iterator15[Symbol.iterator]();;) {
        var _ref15;

        if (_isArray15) {
          if (_i15 >= _iterator15.length) break;
          _ref15 = _iterator15[_i15++];
        } else {
          _i15 = _iterator15.next();
          if (_i15.done) break;
          _ref15 = _i15.value;
        }

        var group = _ref15;

        if (group.name == value) {
          this.ngeoStateManager_.deleteParam(key);
          break;
        }
      }
    }

    if (key.startsWith(ParamPrefix.TREE_GROUP_OPACITY)) {
      var _value2 = key.substring(ParamPrefix.TREE_GROUP_OPACITY.length);

      for (var _iterator16 = groups, _isArray16 = Array.isArray(_iterator16), _i16 = 0, _iterator16 = _isArray16 ? _iterator16 : _iterator16[Symbol.iterator]();;) {
        var _ref16;

        if (_isArray16) {
          if (_i16 >= _iterator16.length) break;
          _ref16 = _iterator16[_i16++];
        } else {
          _i16 = _iterator16.next();
          if (_i16.done) break;
          _ref16 = _i16.value;
        }

        var _group = _ref16;

        if (_group.name == _value2) {
          this.ngeoStateManager_.deleteParam(key);
          break;
        }
      }
    }
  }

  this.$timeout_(function () {
    if (!_this10.map_) {
      return;
    }

    var layer = _this10.map_.getLayerGroup();

    if (!layer) {
      throw new Error('Missing layer');
    }

    for (var _iterator14 = keys, _isArray14 = Array.isArray(_iterator14), _i14 = 0, _iterator14 = _isArray14 ? _iterator14 : _iterator14[Symbol.iterator]();;) {
      var _ref14;

      if (_isArray14) {
        if (_i14 >= _iterator14.length) break;
        _ref14 = _iterator14[_i14++];
      } else {
        _i14 = _iterator14.next();
        if (_i14.done) break;
        _ref14 = _i14.value;
      }

      var key = _ref14;

      if (key.startsWith(ParamPrefix.TREE_ENABLE)) {
        var value = key.substring(ParamPrefix.TREE_ENABLE.length);

        if (!_this10.containsLayerName(layer, value)) {
          _this10.ngeoStateManager_.deleteParam(key);
        }
      }

      if (key.startsWith(ParamPrefix.TREE_OPACITY)) {
        var _value = key.substring(ParamPrefix.TREE_OPACITY.length);

        if (!_this10.containsLayerName(layer, _value)) {
          _this10.ngeoStateManager_.deleteParam(key);
        }
      }
    }
  });
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfPermalink', [gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_draw_features_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, gmf_datasource_LayerBeingSwipe_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_17__["default"].name, ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_13__["default"].name, ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_14__["default"].name, ngeo_statemanager_module_js__WEBPACK_IMPORTED_MODULE_15__["default"].name]);
module.service('gmfPermalink', PermalinkService);
module.value('gmfPermalinkOptions', {});

(function () {
  var regexp = [];

  for (var key1 in ParamPrefix) {
    regexp.push(new RegExp(ParamPrefix[key1] + ".*"));
  }

  for (var key2 in gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["PermalinkParam"]) {
    regexp.push(new RegExp(ParamPrefix[key2]));
  }

  ngeo_statemanager_Service_js__WEBPACK_IMPORTED_MODULE_16__["default"].value('ngeoUsedKeyRegexp', regexp);
})();

/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/permalink/ShareService.js":
/*!****************************************************!*\
  !*** ./contribs/gmf/src/permalink/ShareService.js ***!
  \****************************************************/
/*! exports provided: PermalinkShareService, URL_MAX_LEN, URL_PATH_MAX_LEN, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PermalinkShareService", function() { return PermalinkShareService; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "URL_MAX_LEN", function() { return URL_MAX_LEN; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "URL_PATH_MAX_LEN", function() { return URL_PATH_MAX_LEN; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
PermalinkShareService.$inject = ["$http", "gmfShortenerCreateUrl"];

function PermalinkShareService($http, gmfShortenerCreateUrl) {
  this.$http_ = $http;
  this.gmfShortenerCreateUrl_ = gmfShortenerCreateUrl;
}

PermalinkShareService.prototype.getShortUrl = function (url) {
  var params = {
    url: url
  };

  if (!this.gmfShortenerCreateUrl_) {
    return {
      data: {
        short_url: url
      },
      status: 200
    };
  }

  return this.postShortUrl_(params);
};

PermalinkShareService.prototype.sendShortUrl = function (shortUrl, email, opt_message) {
  var params = {
    url: shortUrl,
    email: email
  };

  if (opt_message) {
    params['message'] = opt_message;
  }

  return this.postShortUrl_(params);
};

PermalinkShareService.prototype.postShortUrl_ = function (params) {
  return this.$http_.post(this.gmfShortenerCreateUrl_, $.param(params), {
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    }
  });
};

var URL_MAX_LEN = 2083;
var URL_PATH_MAX_LEN = 2048;
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfShareService', []);
module.service('gmfShareService', PermalinkShareService);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/permalink/crosshair.svg":
/*!**************************************************!*\
  !*** ./contribs/gmf/src/permalink/crosshair.svg ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" height=\"22\"><path style=\"line-height:normal;text-indent:0;text-align:start;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000;text-transform:none;block-progression:tb;white-space:normal;isolation:auto;mix-blend-mode:normal;solid-color:#000;solid-opacity:1\" d=\"M10.963.413A2.5 2.5 0 008.5 2.948v5.55H2.95a2.5 2.5 0 100 5H8.5v5.554a2.5 2.5 0 105 0v-5.553h5.55a2.5 2.5 0 100-5H13.5v-5.55A2.5 2.5 0 0010.963.412z\" color=\"#000\" font-weight=\"400\" font-family=\"sans-serif\" overflow=\"visible\" fill=\"#fff\" fill-opacity=\".8\" fill-rule=\"evenodd\"></path><path d=\"M11 2.949V19.05M19.051 11H2.95\" fill=\"none\" stroke=\"red\" stroke-width=\"2\" stroke-linecap=\"round\"></path></svg>"

/***/ }),

/***/ "./contribs/gmf/src/permalink/module.js":
/*!**********************************************!*\
  !*** ./contribs/gmf/src/permalink/module.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_permalink_Permalink_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/permalink/Permalink.js */ "./contribs/gmf/src/permalink/Permalink.js");
/* harmony import */ var gmf_permalink_ShareService_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/permalink/ShareService.js */ "./contribs/gmf/src/permalink/ShareService.js");
/* harmony import */ var gmf_permalink_shareComponent_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/permalink/shareComponent.js */ "./contribs/gmf/src/permalink/shareComponent.js");
/* harmony import */ var _share_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./share.scss */ "./contribs/gmf/src/permalink/share.scss");
/* harmony import */ var _share_scss__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_share_scss__WEBPACK_IMPORTED_MODULE_4__);





/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfPermalinkModule', [gmf_permalink_Permalink_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_permalink_ShareService_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_permalink_shareComponent_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/permalink/share.scss":
/*!***********************************************!*\
  !*** ./contribs/gmf/src/permalink/share.scss ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/permalink/shareComponent.html":
/*!********************************************************!*\
  !*** ./contribs/gmf/src/permalink/shareComponent.html ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="modal-header ui-draggable-handle">\n  <h4 class="modal-title" translate>Share this map</h4>\n  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n</div>\n<div class="modal-body">\n  <form role="form" name="gmfShareForm" novalidate>\n    <div class="form-group">\n      <label for="gmfShareInputShortLink-{{::$ctrl.uid}}" translate>Permalink</label>\n      <input type="text" class="form-control" id="gmfShareInputShortLink-{{::$ctrl.uid}}" onclick="this.select()" ng-model="$ctrl.shortLink" readonly="True">\n      <p class="help-block" translate>Copy this link to share it.</p>\n      <p class="text-danger" ng-if="$ctrl.showLengthWarning">\n        <span class="fa fa-exclamation-triangle"></span>\n        {{\'You have a lot of drawn elements in this map. The above link may not be correctly supported by some browsers.\' | translate}}\n      </p>\n      <p class="text-danger" ng-if="$ctrl.errorOnGetShortUrl">\n        <span class="fa fa-exclamation"></span>\n        {{\'Error, cannot get the shortened URL.\' | translate}}\n      </p>\n    </div>\n    <hr ng-if="::$ctrl.enableEmail">\n    <div class="gmf-share-email" ng-if="::$ctrl.enableEmail">\n      <div class="form-group">\n        <label for="gmfShareInputEmail-{{::$ctrl.uid}}" translate>Send this link to</label>\n        <input type="email" class="form-control"  name="inputEmail" id="gmfShareInputEmail-{{::$ctrl.uid}}" placeholder="E-mail" ng-model="$ctrl.email" required>\n        <span ng-show="gmfShareForm.$submitted || gmfShareForm.inputEmail.$touched">\n          <span class="text-danger" ng-show="gmfShareForm.inputEmail.$error.email || gmfShareForm.inputEmail.$error.required">\n            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>\n            {{\'Invalid email.\' | translate}}</span>\n        </span>\n      </div>\n      <div class="form-group">\n        <textarea class="form-control" ng-attr-placeholder="{{\'Message (optional)\' | translate }}" ng-model="$ctrl.message"></textarea>\n      </div>\n      <span class="text-success" ng-if="$ctrl.successfullySent">\n        <i class="fa fa-check" aria-hidden="true"></i>\n          {{ \'Link successfully sent.\' | translate }}\n      </span>\n      <span class="text-danger" ng-if="$ctrl.errorOnsend">\n        <i class="fa fa-exclamation" aria-hidden="true"></i>\n          {{ \'Error, the link has not been sent.\' | translate }}\n      </span>\n    </div>\n    <div class="text-right">\n      <button type="button" class="btn btn-default" data-dismiss="modal" translate>Close</button>\n      <button ng-if="::$ctrl.enableEmail"\n        type="submit" class="btn prime"\n        ng-click="$ctrl.sendShortUrl()"\n        ng-disabled="!gmfShareForm.$valid"\n        translate>Send\n      </button>\n    </div>\n  </form>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/permalink/shareComponent.js":
/*!******************************************************!*\
  !*** ./contribs/gmf/src/permalink/shareComponent.js ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_permalink_ShareService_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/permalink/ShareService.js */ "./contribs/gmf/src/permalink/ShareService.js");
/* harmony import */ var ngeo_statemanager_Location_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/statemanager/Location.js */ "./src/statemanager/Location.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfPermalinkShareComponent', [gmf_permalink_ShareService_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_statemanager_Location_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/permalink/shareComponent', __webpack_require__(/*! ./shareComponent.html */ "./contribs/gmf/src/permalink/shareComponent.html"));
}]);
module.value('gmfPermalinkShareTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.gmfPermalinkShareTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'gmf/permalink/shareComponent';
});
gmfPermalinkShareTemplateUrl.$inject = ["$attrs", "gmfPermalinkShareTemplateUrl"];

function gmfPermalinkShareTemplateUrl($attrs, gmfPermalinkShareTemplateUrl) {
  return gmfPermalinkShareTemplateUrl($attrs);
}

var permalinkShareComponent = {
  bindings: {
    'enableEmail': '<gmfShareEmail'
  },
  controller: 'GmfShareController',
  templateUrl: gmfPermalinkShareTemplateUrl
};
module.component('gmfShare', permalinkShareComponent);

var ShareComponentController = function () {
  ShareComponentController.$inject = ["$scope", "ngeoLocation", "gmfShareService", "$q", "$attrs"];

  function ShareComponentController($scope, ngeoLocation, gmfShareService, $q, $attrs) {
    this.uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_3__["getUid"])(this);
    this.$scope_ = $scope;
    this.gmfShareService_ = gmfShareService;
    this.$q_ = $q;
    this.ngeoLocation_ = ngeoLocation;
    this.enableEmail = false;
    this.shortLink = '';
    this.email = '';
    this.message = '';
    this.permalink_ = this.ngeoLocation_.getUriString();
    var path = ngeoLocation.getPath();

    if (!path) {
      throw new Error('Missing path');
    }

    this.showLengthWarning = this.permalink_.length > gmf_permalink_ShareService_js__WEBPACK_IMPORTED_MODULE_1__["URL_MAX_LEN"] || path.length > gmf_permalink_ShareService_js__WEBPACK_IMPORTED_MODULE_1__["URL_PATH_MAX_LEN"];
    this.successfullySent = false;
    this.errorOnsend = false;
    this.errorOnGetShortUrl = false;
    this.getShortUrl();
  }

  var _proto = ShareComponentController.prototype;

  _proto.getShortUrl = function getShortUrl() {
    var _this = this;

    this.$q_.when(this.gmfShareService_.getShortUrl(this.permalink_)).then(function (resp) {
      _this.shortLink = resp.data.short_url;
      _this.errorOnGetShortUrl = false;
    }, function (resp) {
      _this.shortLink = _this.permalink_;
      _this.errorOnGetShortUrl = true;
    });
  };

  _proto.sendShortUrl = function sendShortUrl() {
    var _this2 = this;

    if (this.$scope_.gmfShareForm.$valid) {
      this.$q_.when(this.gmfShareService_.sendShortUrl(this.permalink_, this.email, this.message)).then(function (resp) {
        _this2.successfullySent = true;
      }, function (resp) {
        _this2.errorOnsend = true;
      });
    }
  };

  return ShareComponentController;
}();

module.controller('GmfShareController', ShareComponentController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/print/component.html":
/*!***********************************************!*\
  !*** ./contribs/gmf/src/print/component.html ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="gmf-print">\n  <div ng-show="$ctrl.isState(\'CAPABILITIES_NOT_LOADED\') !== true && $ctrl.isState(\'ERROR_ON_GETCAPABILITIES\') !== true">\n    <div class="gmf-print-layout-selector"><ng-transclude /></div>\n    <div\n      ng-repeat="attribute in $ctrl.layoutInfo.simpleAttributes"\n      class="gmf-print-layoutinfo form-group">\n      <div ng-if="$ctrl.hiddenAttributeNames === undefined || $ctrl.hiddenAttributeNames.indexOf(attribute.name) < 0">\n        <input\n          ng-if="attribute.type === \'number\'"\n          ng-model="attribute.value"\n          class="form-control"\n          type="number"\n          ng-attr-placeholder="{{attribute.name | translate}}">\n\n        <input\n          ng-if="attribute.type === \'text\'"\n          ng-model="attribute.value"\n          class="form-control"\n          type="text"\n          ng-attr-placeholder="{{attribute.name | translate}}">\n\n        <textarea\n          ng-if="attribute.type === \'textarea\'"\n          ng-model="attribute.value"\n          class="form-control"\n          row="3"\n          ng-attr-placeholder="{{attribute.name | translate}}"></textarea>\n\n        <div\n          ng-if="attribute.type === \'checkbox\'"\n          class="form-check">\n          <label class="form-check-label">\n            <input\n              class="form-check-input"\n              ng-model="attribute.value"\n              type="checkbox">\n            <span>{{attribute.name | translate}}</span>\n          </label>\n        </div>\n      </div>\n    </div>\n\n    <div\n      ng-show="$ctrl.layoutInfo.legend !== undefined"\n      class="gmf-print-legend checkbox">\n      <label>\n        <input\n          ng-model="$ctrl.layoutInfo.legend"\n          type="checkbox">\n        <span translate>Legend</span>\n      </label>\n    </div>\n\n    <div class="gmf-print-layout-selector">\n      <div\n        ng-show="$ctrl.layoutInfo.layouts.length !== 1"\n        class="form-group row">\n\n        <label\n          class="col-form-label col-md-5"\n          translate>Layout</label>\n\n        <div class="col-md-7">\n          <div class="btn-group btn-block">\n            <button\n              type="button"\n              class="btn btn-default form-control dropdown-toggle"\n              data-toggle="dropdown">\n              <span>{{$ctrl.layoutInfo.layout | translate}}&nbsp;</span>\n            </button>\n            <ul\n              class="dropdown-menu dropdown-menu-right btn-block"\n              role="menu">\n              <li ng-repeat="layout in $ctrl.layoutInfo.layouts">\n                <a\n                  ng-click="$ctrl.setLayout(layout)"\n                  href="">{{layout | translate}}</a>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      <div\n        ng-show="$ctrl.layoutInfo.scales.length !== 1"\n        class="gmf-print-scale-selector form-group row">\n\n        <label\n          class="col-form-label col-md-5"\n          translate>Scale</label>\n\n        <div class="col-md-7">\n          <div class="btn-group btn-block">\n            <button\n              type="button"\n              class="btn btn-default form-control dropdown-toggle"\n              data-toggle="dropdown"\n              aria-expanded="false">\n              <span>{{$ctrl.layoutInfo.scale | ngeoScalify}}&nbsp;</span>\n            </button>\n            <ul\n              class="dropdown-menu dropdown-menu-right btn-block"\n              role="menu">\n              <li ng-repeat="scale in $ctrl.layoutInfo.scales">\n                <a\n                  ng-click="$ctrl.getSetScale(scale)"\n                  href="">{{scale | ngeoScalify}}</a>\n              </li>\n              <span ng-if="$ctrl.scaleInput">\n                <li class="dropdown-header" translate>Manual entry</li>\n                <li>\n                  <div class="gmf-print-custom-scale">\n                    1 : <input class="gmf-print-custom-scale-input" type="number" min="1" ng-model="$ctrl.getSetScale" ng-model-options="{getterSetter: true}">\n                  </div>\n                </li>\n              </span>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      <div\n        ng-show="$ctrl.layoutInfo.dpis.length !== 1"\n        class="gmf-print-dpi-selector form-group row">\n\n        <label\n          class="col-form-label col-md-3"\n          translate>DPI</label>\n\n        <div class="col-md-5">\n          <div class="btn-group btn-block">\n            <button\n              type="button"\n              class="btn btn-default form-control dropdown-toggle"\n              data-toggle="dropdown"\n              aria-expanded="false">\n              <span>{{$ctrl.layoutInfo.dpi}}&nbsp;</span>\n            </button>\n            <ul\n              class="dropdown-menu dropdown-menu-right btn-block"\n              role="menu">\n              <li ng-repeat="dpi in $ctrl.layoutInfo.dpis">\n                <a href="" ng-click="$ctrl.setDpi(dpi)">{{dpi}}</a>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      <div class="gmf-print-rotation-selector form-group row">\n        <label\n          class="col-form-label col-md-3"\n          translate>Rotation</label>\n\n        <div class="col-md-5">\n          <input\n            class="form-control gmf-print-rotation-input"\n            type="range"\n            value="0"\n            min="-180"\n            max="180"\n            data-toggle="tooltip"\n            title="{{\'You can also use Alt+Shift on the map\' | translate}}">\n        </div>\n\n        <div class="col-md-4">\n          <input\n            class="form-control gmf-print-rotation-input"\n            type="number"\n            min="-180"\n            max="180"\n            value="0">\n        </div>\n      </div>\n\n    </div>\n\n    <div\n      ng-show="$ctrl.smtpSupported && $ctrl.smtpEmail"\n      class="gmf-print-smtp checkbox">\n      <label>\n        <input\n          ng-disabled="$ctrl.isState(\'PRINTING\')"\n          ng-model="$ctrl.smtpEnabled"\n          type="checkbox">\n        <span translate>Send file by email</span>\n      </label>\n    </div>\n\n    <div class="gmf-print-actions form-group pull-right">\n      <span ng-show="$ctrl.isState(\'PRINTING\')">\n        <i class="fa fa-refresh fa-spinner fa-spin"></i>\n      </span>\n\n      <a\n        ng-show="$ctrl.isState(\'PRINTING\')"\n        class="gmf-print-cancel btn btn-link"\n        href=""\n        ng-click="$ctrl.cancel()"\n        translate>Abort</a>\n\n      <button\n        ng-show="$ctrl.layoutInfo.formats.png"\n        class="gmf-print-image btn prime"\n        ng-disabled="$ctrl.isState(\'PRINTING\')"\n        ng-click="$ctrl.print(\'png\')" translate>Image</button>\n\n      <button\n        ng-show="$ctrl.layoutInfo.formats.pdf"\n        class="gmf-print-pdf btn prime"\n        ng-disabled="$ctrl.isState(\'PRINTING\')"\n        ng-click="$ctrl.print(\'pdf\')" translate>PDF</button>\n    </div>\n\n    <div\n      ng-show="$ctrl.isState(\'ERROR_ON_REPORT\')"\n      class="gmf-print-error-report form-group pull-left text-danger">\n      <p>{{\'Error during the print, please try again.\' | translate}}</p>\n    </div>\n  </div>\n\n  <div\n    ng-show="$ctrl.isState(\'CAPABILITIES_NOT_LOADED\')"\n    class="gmf-print-wait form-group pull-left">\n    <p>{{\'Connecting to the print server, please wait.\' | translate}}</p>\n  </div>\n\n  <div\n    ng-show="$ctrl.isState(\'ERROR_ON_GETCAPABILITIES\')"\n    class="gmf-print-error-capabilities form-group pull-left text-danger">\n    <p>{{\'The print server is unavailable. Please, try later.\' | translate}}</p>\n  </div>\n\n  <div\n    ng-show="$ctrl.smtpMessage"\n    class="gmf-print-smtp-message form-group pull-left">\n    <button\n      class="btn prime"\n      ng-click="$ctrl.closeSmtpMessage()" translate>Close</button>\n    <p>{{\'The file will be sent to your email when ready.\' | translate}}</p>\n  </div>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/print/component.js":
/*!*********************************************!*\
  !*** ./contribs/gmf/src/print/component.js ***!
  \*********************************************/
/*! exports provided: PrintController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PrintController", function() { return PrintController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/index.js */ "./contribs/gmf/src/index.js");
/* harmony import */ var gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/authentication/Service.js */ "./contribs/gmf/src/authentication/Service.js");
/* harmony import */ var ngeo_print_Mask_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/print/Mask.js */ "./src/print/Mask.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ngeo_print_Service_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/print/Service.js */ "./src/print/Service.js");
/* harmony import */ var ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/print/Utils.js */ "./src/print/Utils.js");
/* harmony import */ var ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/query/MapQuerent.js */ "./src/query/MapQuerent.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/layer/Image.js */ "./node_modules/ol/layer/Image.js");
/* harmony import */ var ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/layer/Tile.js */ "./node_modules/ol/layer/Tile.js");
/* harmony import */ var ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ol/layer/Group.js */ "./node_modules/ol/layer/Group.js");
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
/* harmony import */ var ol_math_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/math.js */ "./node_modules/ol/math.js");
/* harmony import */ var ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/source/ImageWMS.js */ "./node_modules/ol/source/ImageWMS.js");
/* harmony import */ var ol_MapBrowserPointerEvent_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/MapBrowserPointerEvent.js */ "./node_modules/ol/MapBrowserPointerEvent.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");




















var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfPrintComponent', [gmf_authentication_Service_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, ngeo_print_Service_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_10__["default"].name]);
module.value('gmfPrintTemplateUrl', function (element, attrs) {
  var templateUrl = attrs.gmfPrintTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'gmf/print';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/print', __webpack_require__(/*! ./component.html */ "./contribs/gmf/src/print/component.html"));
}]);
var PrintStateEnum = {
  NOT_IN_USE: 'notInUse',
  PRINTING: 'printing',
  ERROR_ON_REPORT: 'errorOnReport',
  CAPABILITIES_NOT_LOADED: 'capabilitiesNotLoaded',
  ERROR_ON_GETCAPABILITIES: 'errorOnGetCapabilities'
};
module.value('gmfPrintState', {
  state: PrintStateEnum.CAPABILITIES_NOT_LOADED
});
gmfPrintTemplateUrl.$inject = ["$element", "$attrs", "gmfPrintTemplateUrl"];

function gmfPrintTemplateUrl($element, $attrs, gmfPrintTemplateUrl) {
  return gmfPrintTemplateUrl($element, $attrs);
}

var printComponent = {
  bindings: {
    'map': '<gmfPrintMap',
    'active': '=gmfPrintActive',
    'rotateMask': '<?gmfPrintRotatemask',
    'fieldValues': '<?gmfPrintFieldvalues',
    'hiddenAttributeNames': '<?gmfPrintHiddenattributes',
    'attributesOut': '=?gmfPrintAttributesOut'
  },
  controller: 'GmfPrintController',
  templateUrl: gmfPrintTemplateUrl,
  transclude: true
};
module.component('gmfPrint', printComponent);
var PrintController = function () {
  PrintController.$inject = ["$element", "$rootScope", "$scope", "$timeout", "$q", "$injector", "gettextCatalog", "ngeoLayerHelper", "ngeoFeatureOverlayMgr", "ngeoPrintUtils", "ngeoCreatePrint", "gmfPrintUrl", "gmfAuthenticationService", "ngeoQueryResult", "$filter", "gmfPrintState", "gmfThemes"];

  function PrintController($element, $rootScope, $scope, $timeout, $q, $injector, gettextCatalog, ngeoLayerHelper, ngeoFeatureOverlayMgr, ngeoPrintUtils, ngeoCreatePrint, gmfPrintUrl, gmfAuthenticationService, ngeoQueryResult, $filter, gmfPrintState, gmfThemes) {
    var _this = this;

    this.gmfPrintState_ = gmfPrintState;
    this.translate_ = $filter('translate');
    this.map = null;
    this.maskLayer_ = new ngeo_print_Mask_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    this.active = false;
    this.rotateMask = false;
    this.fieldValues = {};
    this.attributesOut = [];
    this.$rootScope_ = $rootScope;
    this.$scope_ = $scope;
    this.$timeout_ = $timeout;
    this.$q_ = $q;
    this.gettextCatalog_ = gettextCatalog;
    this.ngeoLayerHelper_ = ngeoLayerHelper;
    this.featureOverlayLayer_ = ngeoFeatureOverlayMgr.getLayer();
    this.ngeoPrintUtils_ = ngeoPrintUtils;
    this.ngeoPrint_ = ngeoCreatePrint(gmfPrintUrl);
    this.ngeoQueryResult_ = ngeoQueryResult;
    this.gmfAuthenticationService_ = gmfAuthenticationService;
    this.gmfThemes_ = gmfThemes;
    this.cacheVersion_ = '0';

    if ($injector.has('cacheVersion')) {
      this.cacheVersion_ = $injector.get('cacheVersion');
    }

    this.scaleInput = false;
    this.gmfLegendOptions_ = {
      useBbox: true,
      label: {},
      params: {}
    };

    if ($injector.has('gmfPrintOptions')) {
      var options = $injector.get('gmfPrintOptions');

      if (options.scaleInput) {
        this.scaleInput = options.scaleInput;
      }

      if (options.legend) {
        Object.assign(this.gmfLegendOptions_, options.legend);
      }
    }

    this.requestCanceler_ = null;
    this.statusTimeoutPromise_ = null;
    this.onDragPreviousMousePosition_ = null;
    this.rotationTimeoutPromise_ = null;
    this.pointerDragListenerKey_ = null;
    this.mapViewResolutionChangeKey_ = null;
    this.curRef_ = '';
    this.formats_ = [];
    this.layouts_ = [];
    this.layout_ = null;
    this.paperSize_ = [];
    this.layoutInfo = {};
    this.rotation = 0;
    this.smtpEmail = null;
    this.smtpEnabled = false;
    this.smtpMessage = false;
    this.smtpSupported = false;
    this.hiddenAttributeNames = [];
    this.scaleManuallySelected_ = false;
    this.rotationInput_ = $element.find('.gmf-print-rotation-input');
    this.rotationInput_.on('input change', function (event) {
      var rotation = $(event.target).val();

      if (typeof rotation == 'string') {
        _this.setRotation(parseFloat(rotation));
      }
    });

    this.postcomposeListener_ = function (e) {
      return false;
    };

    this.capabilities_ = null;
    this.ogcServers_ = null;
    this.currentThemes_ = [];
  }

  var _proto = PrintController.prototype;

  _proto.$onInit = function $onInit() {
    var _this2 = this;

    if (!this.map) {
      throw new Error('Missing map');
    }

    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_11__["listen"])(this.map.getView(), 'change:rotation', function (event) {
      _this2.updateRotation_(Math.round(ol_math_js__WEBPACK_IMPORTED_MODULE_16__["toDegrees"](event.target.getRotation())));
    });
    this.$scope_.$watch(function () {
      return _this2.gmfAuthenticationService_.getRolesIds().join(',');
    }, function () {
      _this2.gmfPrintState_.state = PrintStateEnum.CAPABILITIES_NOT_LOADED;
      _this2.capabilities_ = null;
    });
    this.$scope_.$watch(function () {
      return _this2.gmfAuthenticationService_.getEmail();
    }, function (newValue) {
      _this2.smtpEmail = newValue;
    });
    this.$scope_.$watch(function () {
      return _this2.active;
    }, function (active) {
      _this2.togglePrintPanel_(active);
    });
    this.$rootScope_.$on('gmfStartPrint', function (event, format) {
      _this2.print("" + format);
    });
    this.$rootScope_.$on('gmfCancelPrint', function () {
      _this2.cancel();
    });
    this.gmfThemes_.getOgcServersObject().then(function (ogcServersObject) {
      _this2.ogcServers_ = ogcServersObject;
    });
    this.gmfThemes_.getThemesObject().then(function (currentThemes) {
      _this2.currentThemes_ = currentThemes;
    });

    var getSizeFn = function getSizeFn() {
      return _this2.paperSize_;
    };

    var getRotationFn;

    if (this.rotateMask) {
      getRotationFn = function getRotationFn() {
        return _this2.rotation;
      };
    }

    this.maskLayer_.getSize = getSizeFn;
    this.maskLayer_.getScale = this.getScaleFn.bind(this);
    this.maskLayer_.getRotation = getRotationFn;
  };

  _proto.getScaleFn = function getScaleFn(frameState) {
    if (this.layoutInfo.scale === undefined) {
      throw new Error('Missing layoutInfo.scale');
    }

    if (!this.layoutInfo.scales) {
      throw new Error('Missing layoutInfo.scales');
    }

    if (!this.scaleManuallySelected_ && (this.layoutInfo.scale === -1 || this.layoutInfo.scales.includes(this.layoutInfo.scale))) {
      var mapSize = frameState.size;
      var viewResolution = frameState.viewState.resolution;
      this.layoutInfo.scale = this.getOptimalScale_(mapSize, viewResolution);
    }

    return this.layoutInfo.scale;
  };

  _proto.togglePrintPanel_ = function togglePrintPanel_(active) {
    var _this3 = this;

    if (active) {
      if (!this.capabilities_) {
        this.getCapabilities_(this.gmfAuthenticationService_.getRolesIds().join(','));
      }

      if (!this.capabilities_) {
        throw new Error('Missing capabilities');
      }

      this.capabilities_.then(function (resp) {
        if (!_this3.map) {
          throw new Error('Missing map');
        }

        if (!_this3.active) {
          return;
        }

        _this3.gmfPrintState_.state = PrintStateEnum.NOT_IN_USE;

        _this3.parseCapabilities_(resp);

        _this3.map.addLayer(_this3.maskLayer_);

        _this3.pointerDragListenerKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_11__["listen"])(_this3.map, 'pointerdrag', _this3.onPointerDrag_, _this3);
        _this3.mapViewResolutionChangeKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_11__["listen"])(_this3.map.getView(), 'change:resolution', function () {
          _this3.scaleManuallySelected_ = false;
        });

        _this3.map.render();
      }, function (resp) {
        _this3.gmfPrintState_.state = PrintStateEnum.ERROR_ON_GETCAPABILITIES;
        _this3.capabilities_ = null;
      });
    } else {
      if (!this.map) {
        throw new Error('Missing map');
      }

      this.map.removeLayer(this.maskLayer_);

      if (this.pointerDragListenerKey_) {
        Object(ol_events_js__WEBPACK_IMPORTED_MODULE_11__["unlistenByKey"])(this.pointerDragListenerKey_);
      }

      if (this.mapViewResolutionChangeKey_) {
        Object(ol_events_js__WEBPACK_IMPORTED_MODULE_11__["unlistenByKey"])(this.mapViewResolutionChangeKey_);
      }

      this.setRotation(0);
      this.map.render();
    }
  };

  _proto.getCapabilities_ = function getCapabilities_(roleId) {
    this.capabilities_ = this.ngeoPrint_.getCapabilities({
      withCredentials: true,
      params: {
        'role': roleId,
        'cache_version': this.cacheVersion_
      }
    });
  };

  _proto.parseCapabilities_ = function parseCapabilities_(resp) {
    var _this4 = this;

    var data = resp.data;
    this.formats_ = data.formats || [];
    this.layouts_ = data.layouts;
    this.layout_ = data.layouts[0];
    this.layoutInfo.layouts = [];
    this.layouts_.forEach(function (layout) {
      _this4.layoutInfo.layouts.push(layout.name);
    });
    this.smtpSupported = data.smtp && data.smtp.enabled;
    this.updateFields_();
  };

  _proto.updateFields_ = function updateFields_() {
    var _this5 = this;

    if (!this.map) {
      throw new Error('Missing map');
    }

    if (!this.layout_) {
      throw new Error('Missing layout');
    }

    this.layoutInfo.layout = this.layout_.name;
    var mapInfo = this.isAttributeInCurrentLayout_('map');

    if (!mapInfo) {
      throw new Error('Missing mapInfo');
    }

    var clientInfo = mapInfo.clientInfo;

    if (!clientInfo) {
      throw new Error('Missing clientInfo');
    }

    this.paperSize_ = [clientInfo.width, clientInfo.height];
    this.updateCustomFields_();
    var hasLegend = this.layoutInfo.attributes.includes('legend');

    if (hasLegend) {
      this.fieldValues.legend = this.fieldValues.legend;
    } else {
      delete this.fieldValues.legend;
    }

    this.layoutInfo.scales = clientInfo.scales || [];
    this.layoutInfo.dpis = clientInfo.dpiSuggestions || [];
    var mapSize = this.map.getSize();
    var viewResolution = this.map.getView().getResolution();
    this.layoutInfo.scale = this.getOptimalScale_(mapSize, viewResolution);
    this.layoutInfo.dpi = this.layoutInfo.dpi && this.layoutInfo.dpis.indexOf(this.layoutInfo.dpi) > 0 ? this.layoutInfo.dpi : this.layoutInfo.dpis[0];
    this.layoutInfo.formats = {};
    this.formats_.forEach(function (format) {
      _this5.layoutInfo.formats[format] = true;
    });
    this.attributesOut = this.layoutInfo.simpleAttributes;
    this.map.render();
  };

  _proto.updateCustomFields_ = function updateCustomFields_() {
    var _this6 = this;

    if (!this.layout_) {
      throw new Error('Missing layout');
    }

    if (!this.layoutInfo.simpleAttributes) {
      this.layoutInfo.simpleAttributes = [];
    }

    this.layoutInfo.attributes = [];
    var simpleAttributes = this.layoutInfo.simpleAttributes;
    var previousAttributes = simpleAttributes.splice(0, simpleAttributes.length);
    this.layout_.attributes.forEach(function (attribute) {
      _this6.layoutInfo.attributes.push(attribute.name);

      if (!attribute.clientParams) {
        var name = "" + attribute.name;
        var defaultValue = attribute.default;
        var value = defaultValue !== undefined && defaultValue !== '' ? "" + defaultValue : name in _this6.fieldValues ? "" + _this6.fieldValues[name] : '';
        var rawType = "" + attribute.type;
        var type;

        switch (rawType) {
          case 'String':
            type = name === 'comments' ? 'textarea' : 'text';
            break;

          case 'Boolean':
            type = 'checkbox';
            break;

          case 'Number':
            type = 'number';
            var numberValue = parseFloat(value);
            value = isNaN(numberValue) ? '0' : "" + value;
            break;

          default:
            type = rawType;
        }

        previousAttributes.forEach(function (c) {
          if (c.name === name && c.type === type) {
            value = c.value;
            return value;
          }
        });

        _this6.layoutInfo.simpleAttributes.push({
          name: name,
          type: type,
          value: value
        });
      }
    });
  };

  _proto.isAttributeInCurrentLayout_ = function isAttributeInCurrentLayout_(name) {
    if (!this.layout_) {
      throw new Error('Missing layout');
    }

    var attr = null;
    this.layout_.attributes.forEach(function (attribute) {
      if (attribute.name === name) {
        attr = attribute;
        return attribute;
      }
    });
    return attr;
  };

  _proto.setRotation = function setRotation(rotation) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    this.updateRotation_(rotation);

    if (this.rotateMask) {
      this.map.render();
    } else {
      this.map.getView().setRotation(ol_math_js__WEBPACK_IMPORTED_MODULE_16__["toRadians"](this.rotation));
    }
  };

  _proto.updateRotation_ = function updateRotation_(rotation) {
    this.rotation = ol_math_js__WEBPACK_IMPORTED_MODULE_16__["clamp"](rotation, -180, 180);
    this.rotationInput_.val(this.rotation.toString());
  };

  _proto.onPointerDrag_ = function onPointerDrag_(e) {
    var _this7 = this;

    if (e instanceof ol_MapBrowserPointerEvent_js__WEBPACK_IMPORTED_MODULE_18__["default"] && this.onDragPreviousMousePosition_ && this.map) {
      var originalEvent = e.originalEvent;

      if (originalEvent instanceof KeyboardEvent) {
        var mapCenter = this.map.getView().getCenter();

        if (this.active && originalEvent.altKey && originalEvent.shiftKey && mapCenter) {
          var center = this.map.getPixelFromCoordinate(mapCenter);
          var pixel = e.pixel;

          if (this.rotationTimeoutPromise_ === null) {
            this.onDragPreviousMousePosition_ = null;
          } else {
            this.$timeout_.cancel(this.rotationTimeoutPromise_);
            var p0x = this.onDragPreviousMousePosition_[0] - center[0];
            var p0y = this.onDragPreviousMousePosition_[1] - center[1];
            var p1x = pixel[0] - center[0];
            var p1y = pixel[1] - center[1];
            var centerToP0 = Math.sqrt(Math.pow(p0x, 2) + Math.pow(p0y, 2));
            var centerToP1 = Math.sqrt(Math.pow(p1x, 2) + Math.pow(p1y, 2));
            var sense = p0x * p1y - p0y * p1x > 0 ? 1 : -1;
            var angle = (p0x * p1x + p0y * p1y) / (centerToP0 * centerToP1);
            angle = angle <= 1 ? sense * Math.acos(angle) : 0;
            var boost = centerToP1 / 200;
            var increment = Math.round(ol_math_js__WEBPACK_IMPORTED_MODULE_16__["toDegrees"](angle) * boost);
            this.setRotation(this.rotation + increment);
            this.$scope_.$digest();
          }

          this.rotationTimeoutPromise_ = this.$timeout_(function () {
            _this7.rotationTimeoutPromise_ = null;
          }, 500);
          this.onDragPreviousMousePosition_ = pixel;
        }
      }
    }
  };

  _proto.print = function print(format) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    if (!this.ogcServers_) {
      throw new Error('Missing ogcServers_');
    }

    if (this.gmfPrintState_.state === PrintStateEnum.PRINTING) {
      return;
    }

    this.requestCanceler_ = this.$q_.defer();
    this.gmfPrintState_.state = PrintStateEnum.PRINTING;
    var mapSize = this.map.getSize();
    var viewResolution = this.map.getView().getResolution() || 0;
    var scale = this.layoutInfo.scale || this.getOptimalScale_(mapSize, viewResolution);
    var datasource = this.getDataSource_();
    var customAttributes = {};

    if (this.layoutInfo.attributes.includes('datasource')) {
      customAttributes.datasource = datasource;
    }

    if (this.layoutInfo.simpleAttributes) {
      this.layoutInfo.simpleAttributes.forEach(function (field) {
        customAttributes[field.name] = field.value;
      });
    }

    if (this.layoutInfo.legend) {
      var center = this.map.getView().getCenter();

      if (!center) {
        throw new Error('Missing center');
      }

      var deltaX = this.paperSize_[0] * scale / 2 / ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_9__["INCHES_PER_METER"] / ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_9__["DOTS_PER_INCH"];
      var deltaY = this.paperSize_[1] * scale / 2 / ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_9__["INCHES_PER_METER"] / ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_9__["DOTS_PER_INCH"];
      var bbox = [center[0] - deltaX, center[1] - deltaY, center[0] + deltaX, center[1] + deltaY];
      var legend = this.getLegend_(scale, this.layoutInfo.dpi, bbox);

      if (legend !== null) {
        customAttributes.legend = legend;
      }
    }

    if (typeof this.layoutInfo.dpi != 'number') {
      throw new Error('Wrong layoutInfo.dpi type');
    }

    if (typeof this.layoutInfo.layout != 'string') {
      throw new Error('Wrong layoutInfo.layout type');
    }

    var map = new ol_Map_js__WEBPACK_IMPORTED_MODULE_15__["default"]({});
    map.setView(this.map.getView());
    var ol_layers = this.ngeoLayerHelper_.getFlatLayers(this.map.getLayerGroup());
    var new_ol_layers = [];
    var print_native_angle = true;

    for (var i = 0, ii = ol_layers.length; i < ii; i++) {
      var layer = ol_layers[i];
      var metadata = layer.get('metadata');

      if (metadata) {
        var server_name = metadata.ogcServer;
        var layer_names = metadata.printLayers || metadata.layers;

        if (server_name && layer_names) {
          var server = this.ogcServers_[server_name];

          if (server) {
            layer = this.ngeoLayerHelper_.createBasicWMSLayer(server.url, layer_names, server.imageType, server.type, undefined, undefined, undefined, undefined, {
              opacity: layer.get('opacity')
            });
            layer.setZIndex(-200);
          } else {
            console.error('Missing ogcServer:', server_name);
          }
        }
      }

      if (layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_12__["default"] && layer.get('printNativeAngle') === false) {
        print_native_angle = false;
      }

      new_ol_layers.push(layer);
    }

    var group = new ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_14__["default"]({
      layers: new_ol_layers
    });
    group.set('printNativeAngle', print_native_angle);
    map.setLayerGroup(group);
    var email = this.smtpSupported && this.smtpEmail && this.smtpEnabled ? this.smtpEmail : undefined;
    var spec = this.ngeoPrint_.createSpec(map, scale, this.layoutInfo.dpi, this.layoutInfo.layout, format, customAttributes, email);
    var layers = [];
    this.ngeoPrint_.encodeLayer(layers, this.featureOverlayLayer_, viewResolution);

    if (layers.length > 0) {
      spec.attributes.map.layers.unshift(layers[0]);
    }

    this.ngeoPrint_.createReport(spec, {
      timeout: this.requestCanceler_.promise
    }).then(this.handleCreateReportSuccess_.bind(this), this.handleCreateReportError_.bind(this));
    map.setTarget('');
  };

  _proto.cancel = function cancel() {
    if (this.requestCanceler_ !== null) {
      this.requestCanceler_.resolve();
    }

    if (this.statusTimeoutPromise_ !== null) {
      this.$timeout_.cancel(this.statusTimeoutPromise_);
    }

    if (this.curRef_.length > 0) {
      this.ngeoPrint_.cancel(this.curRef_);
    }

    this.resetPrintStates_();
  };

  _proto.resetPrintStates_ = function resetPrintStates_(opt_printState) {
    this.gmfPrintState_.state = opt_printState || PrintStateEnum.NOT_IN_USE;
    this.curRef_ = '';
  };

  _proto.getDataSource_ = function getDataSource_() {
    var _this8 = this;

    var datasourceArr = [];
    var sources = this.ngeoQueryResult_.sources;
    sources.forEach(function (source) {
      var data = [];
      var columns = [];
      source.features.forEach(function (feature, i) {
        if (!feature) {
          throw new Error('Missing feature');
        }

        var properties = Object(ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_7__["getFilteredFeatureValues"])(feature);

        if (i === 0) {
          columns = Object.keys(properties).map(function (prop) {
            return _this8.translate_(prop);
          });
        }

        data.push(Object.keys(properties).map(function (key) {
          return properties[key];
        }));
      });

      if (columns.length) {
        var datasourceObj = {
          title: _this8.translate_(source.label),
          table: {
            columns: columns,
            data: data
          }
        };
        datasourceArr.push(datasourceObj);
      }
    });
    return datasourceArr;
  };

  _proto.getOptimalScale_ = function getOptimalScale_(mapSize, viewResolution) {
    var scales = this.layoutInfo.scales.slice();

    if (mapSize !== undefined && viewResolution !== undefined) {
      var scale = this.ngeoPrintUtils_.getOptimalScale(mapSize, viewResolution, this.paperSize_, scales.reverse());

      if (scale > 0) {
        return scale;
      }
    }

    return this.layoutInfo.scales[this.layoutInfo.scales.length - 1];
  };

  _proto.handleCreateReportSuccess_ = function handleCreateReportSuccess_(resp) {
    if (this.smtpSupported && this.smtpEmail && this.smtpEnabled) {
      this.smtpMessage = true;
      this.resetPrintStates_();
    } else {
      var ref = resp.data.ref;

      if (!ref.length) {
        throw new Error('Wrong ref');
      }

      this.curRef_ = ref;
      this.getStatus_(ref);
    }
  };

  _proto.getStatus_ = function getStatus_(ref) {
    this.requestCanceler_ = this.$q_.defer();
    this.ngeoPrint_.getStatus(ref, {
      timeout: this.requestCanceler_.promise
    }).then(this.handleGetStatusSuccess_.bind(this, ref), this.handleCreateReportError_.bind(this));
  };

  _proto.handleGetStatusSuccess_ = function handleGetStatusSuccess_(ref, resp) {
    var _this9 = this;

    var mfResp = resp.data;
    var done = mfResp.done;

    if (done) {
      if (mfResp.status != 'error') {
        window.location.href = this.ngeoPrint_.getReportUrl(ref);
        this.resetPrintStates_();
      } else {
        console.error(mfResp.error);
        this.handleCreateReportError_();
      }
    } else {
      this.statusTimeoutPromise_ = this.$timeout_(function () {
        _this9.getStatus_(ref);
      }, 1000, false);
    }
  };

  _proto.handleCreateReportError_ = function handleCreateReportError_() {
    this.resetPrintStates_(PrintStateEnum.ERROR_ON_REPORT);
  };

  _proto.getLegend_ = function getLegend_(scale, dpi, bbox) {
    var _this10 = this;

    if (!this.map) {
      throw new Error('Missing map');
    }

    var legend = {
      classes: []
    };
    var gettextCatalog = this.gettextCatalog_;
    var dataLayerGroup = this.ngeoLayerHelper_.getGroupFromMap(this.map, gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["DATALAYERGROUP_NAME"]);
    var layers = this.ngeoLayerHelper_.getFlatLayers(dataLayerGroup);
    layers.reverse().forEach(function (layer) {
      if (!_this10.map) {
        throw new Error('Missing map');
      }

      var classes = [];

      if (layer.getVisible() && layer.getSource()) {
        if (layer instanceof ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_13__["default"]) {
          var layerName = "" + layer.get('layerNodeName');

          var icon_dpi = _this10.getMetadataLegendImage_(layerName, dpi);

          if (!icon_dpi) {
            var url = _this10.ngeoLayerHelper_.getWMTSLegendURL(layer);

            if (url) {
              icon_dpi = {
                url: url,
                dpi: 72
              };
            }
          }

          if (icon_dpi) {
            classes.push({
              name: gettextCatalog.getString(layerName),
              icons: [icon_dpi.url]
            });
          }
        } else {
          var source = layer.getSource();

          if (!(source instanceof ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_17__["default"])) {
            throw new Error('Wrong source type');
          }

          var layerNames = source.getParams().LAYERS.split(',');
          layerNames.forEach(function (name) {
            if (!_this10.map) {
              throw new Error('Missing map');
            }

            if (!source.serverType_) {
              throw new Error('Missing source.serverType_');
            }

            var icon_dpi = _this10.getMetadataLegendImage_(name, dpi);

            var type = icon_dpi ? 'image' : source.serverType_;

            if (!icon_dpi) {
              var _url = _this10.ngeoLayerHelper_.getWMSLegendURL(source.getUrl(), name, scale, undefined, undefined, undefined, source.serverType_, dpi, _this10.gmfLegendOptions_.useBbox ? bbox : undefined, _this10.map.getView().getProjection().getCode(), _this10.gmfLegendOptions_.params[source.serverType_]);

              if (!_url) {
                throw new Error('Missing url');
              }

              icon_dpi = {
                url: _url,
                dpi: type === 'qgis' ? dpi : 72
              };
            }

            if (icon_dpi && name.length !== 0) {
              classes.push(Object.assign({
                name: _this10.gmfLegendOptions_.label[type] === false ? '' : gettextCatalog.getString(name),
                icons: [icon_dpi.url]
              }, icon_dpi.dpi != 72 ? {
                dpi: icon_dpi.dpi
              } : {}));
            }
          });
        }
      }

      if (classes.length > 0) {
        legend.classes = legend.classes.concat(classes);
      }
    });
    return legend.classes.length > 0 ? legend : null;
  };

  _proto.getMetadataLegendImage_ = function getMetadataLegendImage_(layerName, dpi) {
    if (dpi === void 0) {
      dpi = 72;
    }

    var groupNode = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_4__["findGroupByLayerNodeName"])(this.currentThemes_, layerName);
    var found_dpi = dpi;
    var node;

    if (groupNode && groupNode.children) {
      node = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_4__["findObjectByName"])(groupNode.children, layerName);
    }

    var legendImage;
    var hiDPILegendImages;

    if (node && node.metadata) {
      legendImage = node.metadata.legendImage;
      hiDPILegendImages = node.metadata.hiDPILegendImages;
    }

    var dist = Number.MAX_VALUE;

    if (legendImage) {
      dist = Math.abs(Math.log(72 / dpi));
      found_dpi = 72;
    }

    if (hiDPILegendImages) {
      for (var str_dpi in hiDPILegendImages) {
        var new_dpi = parseFloat(str_dpi);
        var new_dist = Math.abs(Math.log(new_dpi / dpi));

        if (new_dist < dist) {
          dist = new_dist;
          found_dpi = new_dpi;
          legendImage = hiDPILegendImages[str_dpi];
        }
      }
    }

    if (legendImage) {
      return {
        url: legendImage,
        dpi: found_dpi
      };
    }
  };

  _proto.setLayout = function setLayout(layoutName) {
    var layout = null;
    this.layouts_.forEach(function (l) {
      if (l.name === layoutName) {
        layout = l;
        return true;
      }
    });
    this.layout_ = layout;
    this.updateFields_();
  };

  _proto.getSetScale = function getSetScale(opt_scale) {
    if (opt_scale !== undefined) {
      if (!this.map) {
        throw new Error('Missing map');
      }

      var mapSize = this.map.getSize() || [0, 0];
      this.layoutInfo.scale = opt_scale;
      var res = this.ngeoPrintUtils_.getOptimalResolution(mapSize, this.paperSize_, opt_scale);
      var view = this.map.getView();
      var contrainRes = view.getConstraints().resolution(res, 1, mapSize);
      view.setResolution(contrainRes);
      this.map.render();
      this.scaleManuallySelected_ = true;
    }

    return this.layoutInfo.scale;
  };

  _proto.setDpi = function setDpi(dpi) {
    this.layoutInfo.dpi = dpi;
  };

  _proto.isState = function isState(stateEnumKey) {
    return this.gmfPrintState_.state === PrintStateEnum[stateEnumKey];
  };

  _proto.closeSmtpMessage = function closeSmtpMessage() {
    this.smtpMessage = false;
  };

  return PrintController;
}();
module.controller('GmfPrintController', PrintController);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/print/module.js":
/*!******************************************!*\
  !*** ./contribs/gmf/src/print/module.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_print_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/print/component.js */ "./contribs/gmf/src/print/component.js");
/* harmony import */ var _print_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./print.scss */ "./contribs/gmf/src/print/print.scss");
/* harmony import */ var _print_scss__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_print_scss__WEBPACK_IMPORTED_MODULE_2__);



/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfPrintModule', [gmf_print_component_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/print/print.scss":
/*!*******************************************!*\
  !*** ./contribs/gmf/src/print/print.scss ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/profile/component.html":
/*!*************************************************!*\
  !*** ./contribs/gmf/src/profile/component.html ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n  class="gmf-profile-container panel"\n  ng-show="ctrl.active">\n\n  <div\n    class="ngeo-profile"\n    ng-show="!ctrl.isErrored"\n    ngeo-profile="ctrl.profileData"\n    ngeo-profile-highlight="ctrl.profileHighlight"\n    ngeo-profile-options="::ctrl.profileOptions">\n  </div>\n\n  <ul\n    class="gmf-profile-legend"\n    ng-show="!ctrl.isErrored">\n\n    <li ng-repeat="name in ::ctrl.getLayersNames()">\n      <i\n        class="fa fa-minus"\n        ng-style="ctrl.getStyle(name)"></i>\n      {{name | translate}}\n      <span ng-if="ctrl.currentPoint.elevations[name] != null">\n      {{ctrl.currentPoint.elevations[name]}}&nbsp;{{ctrl.currentPoint.yUnits}}\n      </span>\n    </li>\n  </ul>\n\n  <div\n    class="gmf-profile-export btn-group dropup"\n    ng-show="!ctrl.isErrored">\n\n    <a\n      class="dropdown-toggle"\n      href=""\n      ng-show="ctrl.profileData.length !== 0"\n      data-toggle="dropdown"\n      aria-expanded="false">\n      {{\'Export\' | translate}}\n    </a>\n\n    <ul\n      class="dropdown-menu dropdown-menu-right"\n      role="menu">\n\n      <li>\n      <a\n        href=""\n        ng-click="::ctrl.downloadCsv()">\n        <i class="fa fa-table"></i>&nbsp;{{\'Download CSV\' | translate}}</a>\n      </li>\n    </ul>\n  </div>\n\n  <div\n    class="gmf-profile-error"\n    ng-show="ctrl.isErrored">\n\n    <p>{{\'The profile service does not respond, please try later.\' | translate}}</p>\n  </div>\n  <div\n    class="close"\n    ng-click="ctrl.line = null">&times;</div>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/profile/component.js":
/*!***********************************************!*\
  !*** ./contribs/gmf/src/profile/component.js ***!
  \***********************************************/
/*! exports provided: ProfileController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProfileController", function() { return ProfileController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_Overlay_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/Overlay.js */ "./node_modules/ol/Overlay.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/style/Circle.js */ "./node_modules/ol/style/Circle.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ngeo_download_Csv_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/download/Csv.js */ "./src/download/Csv.js");
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var ngeo_profile_elevationComponent_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/profile/elevationComponent.js */ "./src/profile/elevationComponent.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");
ProfileController.$inject = ["$scope", "$http", "$element", "$filter", "gettextCatalog", "ngeoFeatureOverlayMgr", "gmfProfileJsonUrl", "ngeoCsvDownload"];













var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfProfile', [ngeo_download_Csv_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_10__["default"].name, ngeo_profile_elevationComponent_js__WEBPACK_IMPORTED_MODULE_11__["default"].name]);
module.value('gmfProfileTemplateUrl', function ($element, $attrs) {
  var templateUrl = $attrs.gmfProfileTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'gmf/profile';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/profile', __webpack_require__(/*! ./component.html */ "./contribs/gmf/src/profile/component.html"));
}]);
gmfProfileTemplateUrl.$inject = ["$element", "$attrs", "gmfProfileTemplateUrl"];

function gmfProfileTemplateUrl($element, $attrs, gmfProfileTemplateUrl) {
  return gmfProfileTemplateUrl($element, $attrs);
}

var profileComponent = {
  controller: 'GmfProfileController as ctrl',
  bindings: {
    'active': '=gmfProfileActive',
    'line': '=gmfProfileLine',
    'getMapFn': '&?gmfProfileMap',
    'getLinesConfigurationFn': '&gmfProfileLinesconfiguration',
    'getHoverPointStyleFn': '&?gmfProfileHoverpointstyle',
    'getNbPointsFn': '&?gmfProfileNumberofpoints',
    'getOptionsFn': '&?gmfProfileOptions'
  },
  templateUrl: gmfProfileTemplateUrl
};
module.component('gmfProfile', profileComponent);
function ProfileController($scope, $http, $element, $filter, gettextCatalog, ngeoFeatureOverlayMgr, gmfProfileJsonUrl, ngeoCsvDownload) {
  var _this = this;

  this.$scope_ = $scope;
  this.$http_ = $http;
  this.$element_ = $element;
  this.$filter_ = $filter;
  this.gettextCatalog_ = gettextCatalog;
  this.pointHoverOverlay_ = ngeoFeatureOverlayMgr.getFeatureOverlay();
  this.gmfProfileJsonUrl_ = gmfProfileJsonUrl;
  this.ngeoCsvDownload_ = ngeoCsvDownload;
  this.map_ = null;
  this.linesConfiguration_ = null;
  this.layersNames_ = [];
  this.nbPoints_ = 100;
  this.line = null;
  this.profileData = [];
  this.currentPoint = {
    elevations: {}
  };
  this.profileHighlight = -1;
  this.measureTooltip_ = null;
  this.measureTooltipElement_ = null;
  this.snappedPoint_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]();
  this.pointHoverOverlay_.addFeature(this.snappedPoint_);
  this.profileLabels_ = {
    xAxis: gettextCatalog.getString('Distance'),
    yAxis: gettextCatalog.getString('Elevation')
  };
  this.profileOptions = null;
  this.active = false;
  this.pointerMoveKey_ = null;
  this.isErrored = false;

  this.getMapFn = function () {
    return null;
  };

  this.getNbPointsFn = function () {
    return 100;
  };

  this.getHoverPointStyleFn = null;

  this.getLinesConfigurationFn = function () {
    return {};
  };

  this.getOptionsFn = function () {
    return {};
  };

  $scope.$watch(function () {
    return _this.active;
  }, function (newValue, oldValue) {
    if (oldValue !== newValue) {
      _this.updateEventsListening_();
    }
  });
  $scope.$watch(function () {
    return _this.line;
  }, function (newLine, oldLine) {
    if (oldLine !== newLine) {
      _this.update_();
    }
  });
  this.updateEventsListening_();
}

ProfileController.prototype.$onInit = function () {
  this.map_ = this.getMapFn();
  this.nbPoints_ = this.getNbPointsFn();
  var hoverPointStyle;
  var hoverPointStyleFn = this.getHoverPointStyleFn;

  if (hoverPointStyleFn) {
    hoverPointStyle = hoverPointStyleFn();

    if (!(hoverPointStyle instanceof ol_style_Style_js__WEBPACK_IMPORTED_MODULE_8__["default"])) {
      throw new Error('Wrong hoverPointStyle type');
    }
  } else {
    hoverPointStyle = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
      image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
          color: '#ffffff'
        }),
        radius: 3
      })
    });
  }

  this.pointHoverOverlay_.setStyle(hoverPointStyle);
  this.linesConfiguration_ = this.getLinesConfigurationFn();

  for (var name in this.linesConfiguration_) {
    this.layersNames_.push(name);
    var lineConfig = this.linesConfiguration_[name];

    if (!lineConfig.zExtractor) {
      this.linesConfiguration_[name].zExtractor = this.getZFactory_(name);
    }
  }

  this.profileOptions = {
    linesConfiguration: this.linesConfiguration_,
    distanceExtractor: this.getDist_,
    hoverCallback: this.hoverCallback_.bind(this),
    outCallback: this.outCallback_.bind(this),
    i18n: this.profileLabels_
  };
  var optionsFn = this.getOptionsFn;

  if (optionsFn) {
    var options = optionsFn();

    if (!options) {
      throw new Error('Missing options');
    }

    Object.assign(this.profileOptions, options);
  }
};

ProfileController.prototype.update_ = function () {
  this.isErrored = false;

  if (this.line) {
    this.getJsonProfile_();
  } else {
    this.profileData = [];
  }

  this.active = !!this.line;
};

ProfileController.prototype.updateEventsListening_ = function () {
  var _this2 = this;

  if (this.active && this.map_ !== null) {
    this.pointerMoveKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(this.map_, 'pointermove', function (event) {
      var e = event;

      if (!_this2.map_) {
        throw new Error('Missing map');
      }

      if (e.dragging || !_this2.line) {
        return;
      }

      var coordinate = _this2.map_.getEventCoordinate(e.originalEvent);

      var closestPoint = _this2.line.getClosestPoint(coordinate);

      var eventToLine = new ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_4__["default"]([closestPoint, coordinate]);

      var resolution = _this2.map_.getView().getResolution();

      if (resolution === undefined) {
        throw new Error('Missing resolution');
      }

      var pixelDist = eventToLine.getLength() / resolution;

      if (pixelDist < 16) {
        _this2.profileHighlight = _this2.getDistanceOnALine_(closestPoint);
      } else {
        _this2.profileHighlight = -1;
      }

      _this2.$scope_.$apply();
    });
  } else {
    if (this.pointerMoveKey_) {
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["unlistenByKey"])(this.pointerMoveKey_);
    }
  }
};

ProfileController.prototype.getDistanceOnALine_ = function (pointOnLine) {
  if (!this.line) {
    throw new Error('Missing line');
  }

  var segment;
  var distOnLine = 0;
  var fakeExtent = [pointOnLine[0] - 0.5, pointOnLine[1] - 0.5, pointOnLine[0] + 0.5, pointOnLine[1] + 0.5];
  this.line.forEachSegment(function (firstPoint, lastPoint) {
    segment = new ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_4__["default"]([firstPoint, lastPoint]);

    if (segment.intersectsExtent(fakeExtent)) {
      segment.setCoordinates([firstPoint, pointOnLine]);
      return distOnLine += segment.getLength();
    } else {
      distOnLine += segment.getLength();
    }
  });
  return distOnLine;
};

ProfileController.prototype.hoverCallback_ = function (point, dist, xUnits, elevationsRef, yUnits) {
  if (this.measureTooltipElement_ && this.measureTooltip_) {
    var coordinate = [point.x, point.y];
    this.currentPoint.elevations = elevationsRef;
    this.currentPoint.distance = dist;
    this.currentPoint.xUnits = xUnits;
    this.currentPoint.yUnits = yUnits;
    this.currentPoint.coordinate = coordinate;
    var geom = new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__["default"](coordinate);
    this.createMeasureTooltip_();
    this.measureTooltipElement_.innerHTML = this.getTooltipHTML_();
    this.measureTooltip_.setPosition(coordinate);
    this.snappedPoint_.setGeometry(geom);
  }
};

ProfileController.prototype.outCallback_ = function () {
  delete this.currentPoint.coordinate;
  delete this.currentPoint.distance;
  this.currentPoint.elevations = {};
  delete this.currentPoint.xUnits;
  delete this.currentPoint.yUnits;
  this.removeMeasureTooltip_();
  this.snappedPoint_.setGeometry(undefined);
};

ProfileController.prototype.getTooltipHTML_ = function () {
  var gettextCatalog = this.gettextCatalog_;
  var separator = '&nbsp;: ';
  var elevationName, translatedElevationName;
  var innerHTML = [];
  var number = this.$filter_('number');
  var DistDecimal = this.currentPoint.xUnits === 'm' ? 0 : 2;
  var value = number(this.currentPoint.distance, DistDecimal);
  innerHTML.push(this.profileLabels_.xAxis + " " + separator + " " + value + "&nbsp;" + this.currentPoint.xUnits);

  for (elevationName in this.currentPoint.elevations) {
    translatedElevationName = gettextCatalog.getString(elevationName);
    var intValue = this.currentPoint.elevations[elevationName];

    var _value = intValue === null ? gettextCatalog.getString('no value') : number(intValue, 0) + "&nbsp;" + this.currentPoint.yUnits;

    innerHTML.push(translatedElevationName + " " + separator + " " + _value);
  }

  return innerHTML.join('</br>');
};

ProfileController.prototype.createMeasureTooltip_ = function () {
  if (!this.map_) {
    throw new Error('Missing map');
  }

  this.removeMeasureTooltip_();
  this.measureTooltipElement_ = document.createElement('div');
  this.measureTooltipElement_.className += 'tooltip ngeo-tooltip-measure';
  this.measureTooltip_ = new ol_Overlay_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
    element: this.measureTooltipElement_,
    offset: [0, -15],
    positioning: 'bottom-center'
  });
  this.map_.addOverlay(this.measureTooltip_);
};

ProfileController.prototype.removeMeasureTooltip_ = function () {
  if (this.measureTooltipElement_ !== null) {
    if (!this.map_) {
      throw new Error('Missing map');
    }

    if (!this.measureTooltip_) {
      throw new Error('Missing measureTooltip_');
    }

    if (!this.measureTooltipElement_.parentNode) {
      throw new Error('Missing measureTooltipElement_.parentNode');
    }

    this.measureTooltipElement_.parentNode.removeChild(this.measureTooltipElement_);
    this.measureTooltipElement_ = null;
    this.map_.removeOverlay(this.measureTooltip_);
  }
};

ProfileController.prototype.getStyle = function (layerName) {
  if (!this.linesConfiguration_) {
    throw new Error('Missing linesConfiguration');
  }

  var lineConfiguration = this.linesConfiguration_[layerName];

  if (!lineConfiguration) {
    return {};
  }

  return {
    'color': lineConfiguration.color || '#F00'
  };
};

ProfileController.prototype.getLayersNames = function () {
  return this.layersNames_.slice(0);
};

ProfileController.prototype.getZFactory_ = function (layerName) {
  var getZFn = function getZFn(item) {
    if ('values' in item && layerName in item.values && item.values[layerName]) {
      return parseFloat(item.values[layerName]);
    }

    return Number.NaN;
  };

  return getZFn;
};

ProfileController.prototype.getDist_ = function (item) {
  if ('dist' in item) {
    return item.dist;
  }

  return 0;
};

ProfileController.prototype.getJsonProfile_ = function () {
  if (!this.line) {
    throw new Error('Missing line');
  }

  var geom = {
    'type': 'LineString',
    'coordinates': this.line.getCoordinates()
  };
  var params = {
    'layers': this.layersNames_.join(','),
    'geom': JSON.stringify(geom),
    'nbPoints': this.nbPoints_
  };
  this.$http_({
    url: this.gmfProfileJsonUrl_,
    method: 'POST',
    params: params,
    paramSerializer: '$httpParamSerializerJQLike',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    }
  }).then(this.getProfileDataSuccess_.bind(this), this.getProfileDataError_.bind(this));
};

ProfileController.prototype.getProfileDataSuccess_ = function (resp) {
  var profileData = resp.data.profile;

  if (profileData instanceof Array) {
    this.profileData = profileData;
  }
};

ProfileController.prototype.getProfileDataError_ = function (resp) {
  this.isErrored = true;
  console.error('Can not get JSON profile.');
};

ProfileController.prototype.downloadCsv = function () {
  if (this.profileData.length === 0) {
    return;
  }

  var headers = [];
  var hasDistance = false;
  var firstPoint = this.profileData[0];

  if ('dist' in firstPoint) {
    headers.push({
      name: 'distance'
    });
    hasDistance = true;
  }

  var layers = [];

  for (var layer in firstPoint.values) {
    headers.push({
      'name': layer
    });
    layers.push(layer);
  }

  headers.push({
    name: 'x'
  });
  headers.push({
    name: 'y'
  });
  var rows = this.profileData.map(function (point) {
    var row = {};

    if (hasDistance) {
      row.distance = point.dist;
    }

    layers.forEach(function (layer) {
      row[layer] = point.values[layer];
    });
    row.x = point.x;
    row.y = point.y;
    return row;
  });
  this.ngeoCsvDownload_.startDownload(rows, headers, 'profile.csv');
};

module.controller('GmfProfileController', ProfileController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/profile/drawLineComponent.js":
/*!*******************************************************!*\
  !*** ./contribs/gmf/src/profile/drawLineComponent.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/misc/decorate.js */ "./src/misc/decorate.js");
Controller.$inject = ["$scope", "$timeout", "ngeoFeatureOverlayMgr"];








var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfDrawProfileLine', [ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_6__["default"].name]);

function profileDarwLineComponent() {
  return {
    scope: true,
    controller: 'GmfDrawprofilelineController as ctrl',
    restrict: 'A',
    bindToController: {
      'getMapFn': '&gmfDrawprofilelineMap',
      'line': '=gmfDrawprofilelineLine',
      'active': '=gmfDrawprofilelineActive',
      'getStyleFn': '&?gmfDrawprofilelineStyle'
    }
  };
}

module.directive('gmfDrawprofileline', profileDarwLineComponent);

function Controller($scope, $timeout, ngeoFeatureOverlayMgr) {
  var _this = this;

  this.line = null;
  this.map_ = null;
  this.active = false;
  this.features_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__["default"]();
  this.getMapFn = null;
  this.getStyleFn = null;
  var overlay = ngeoFeatureOverlayMgr.getFeatureOverlay();
  overlay.setFeatures(this.features_);
  var style = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_4__["default"]({
    stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_5__["default"]({
      color: '#ffcc33',
      width: 2
    })
  });
  overlay.setStyle(style);
  this.interaction = new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_2__["default"]({
    type: 'LineString',
    features: this.features_
  });
  Object(ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_7__["interactionDecoration"])(this.interaction);
  this.interaction.on('change:active', function () {
    if (_this.interaction.getActive()) {
      _this.clear_();
    }
  });
  this.interaction.on('drawend', function (event) {
    _this.line = event.feature.getGeometry();
    $timeout(function () {
      _this.interaction.setActive(false);
    }, 0);
  });
  $scope.$watch(function () {
    return _this.line;
  }, function (newLine, oldLine) {
    if (newLine === null) {
      _this.clear_();
    }
  });
  $scope.$watch(function () {
    return _this.active;
  }, function (newValue) {
    if (newValue === false) {
      _this.clear_();
    }

    _this.interaction.setActive(_this.active);
  });
}

Controller.prototype.$onInit = function () {
  if (!this.getMapFn) {
    throw new Error('Missing getMapFn');
  }

  var map = this.getMapFn();

  if (!(map instanceof ol_Map_js__WEBPACK_IMPORTED_MODULE_3__["default"])) {
    throw 'Wrong map';
  }

  this.map_ = map;
  this.map_.addInteraction(this.interaction);
};

Controller.prototype.clear_ = function () {
  this.features_.clear();
  this.line = null;
};

module.controller('GmfDrawprofilelineController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/profile/module.js":
/*!********************************************!*\
  !*** ./contribs/gmf/src/profile/module.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_profile_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/profile/component.js */ "./contribs/gmf/src/profile/component.js");
/* harmony import */ var gmf_profile_drawLineComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/profile/drawLineComponent.js */ "./contribs/gmf/src/profile/drawLineComponent.js");
/* harmony import */ var _profile_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./profile.scss */ "./contribs/gmf/src/profile/profile.scss");
/* harmony import */ var _profile_scss__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_profile_scss__WEBPACK_IMPORTED_MODULE_3__);




/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfProfileModule', [gmf_profile_component_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_profile_drawLineComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/profile/profile.scss":
/*!***********************************************!*\
  !*** ./contribs/gmf/src/profile/profile.scss ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/query/extraModule.js":
/*!***********************************************!*\
  !*** ./contribs/gmf/src/query/extraModule.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_query_gridComponent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/query/gridComponent.js */ "./contribs/gmf/src/query/gridComponent.js");
/* harmony import */ var gmf_query_windowComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/query/windowComponent.js */ "./contribs/gmf/src/query/windowComponent.js");
/* harmony import */ var _grid_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./grid.scss */ "./contribs/gmf/src/query/grid.scss");
/* harmony import */ var _grid_scss__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_grid_scss__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _window_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./window.scss */ "./contribs/gmf/src/query/window.scss");
/* harmony import */ var _window_scss__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_window_scss__WEBPACK_IMPORTED_MODULE_4__);





/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfQueryExtraModule', [gmf_query_gridComponent_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_query_windowComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/query/grid.scss":
/*!******************************************!*\
  !*** ./contribs/gmf/src/query/grid.scss ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/query/gridComponent.html":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/query/gridComponent.html ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="gmf-displayquerygrid panel" ng-show="ctrl.active">\n  <div\n    class="close"\n    ng-click="ctrl.clear()">\n    &times;\n  </div>\n\n  <ul\n    class="nav nav-pills"\n    role="tablist">\n\n    <li\n      class="nav-item"\n      ng-repeat="gridSource in ctrl.getGridSources() track by gridSource.source.label"\n      role="presentation"\n      ng-click="ctrl.selectTab(gridSource)">\n\n      <a\n        class="nav-link"\n        href="#{{ctrl.escapeValue(gridSource.source.label)}}"\n        ng-class="{\'active\' : ctrl.isSelected(gridSource)}"\n        data-target="#{{ctrl.escapeValue(gridSource.source.label)}}"\n        aria-controls="{{ctrl.escapeValue(gridSource.source.label)}}"\n        role="tab"\n        data-toggle="tab">\n\n        <span ng-if="gridSource.source.tooManyResults !== true">\n          {{gridSource.source.label | translate}} ({{gridSource.source.features.length}})\n        </span>\n        <span ng-if="gridSource.source.tooManyResults === true">\n          {{gridSource.source.label | translate}} ({{gridSource.source.totalFeatureCount}}*)\n        </span>\n      </a>\n    </li>\n  </ul>\n\n  <div class="tab-content">\n    <div\n      ng-repeat="gridSource in ctrl.getGridSources() track by gridSource.source.label"\n      role="tabpanel"\n      class="tab-pane"\n      ng-class="{\'active\' : ctrl.isSelected(gridSource)}"\n      id="{{ctrl.escapeValue(gridSource.source.label)}}">\n\n      <ngeo-grid\n        ngeo-grid-configuration="gridSource.configuration"\n        ng-if="gridSource.source.tooManyResults !== true">\n      </ngeo-grid>\n\n      <div ng-if="gridSource.source.tooManyResults === true">\n        <div class="gmf-displayquerygrid-message alert alert-warning">\n          <p><span translate>The results can not be displayed because the maximum number has been reached</span> ({{gridSource.source.limit}}).</p>\n          <p translate>Please refine your query.</p>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div ng-show="!ctrl.pending && ctrl.getActiveGridSource() && ctrl.getActiveGridSource().configuration !== null">\n\n    <ul class="nav justify-content-end">\n\n      <li\n        class="ng-hide"\n        ng-show="ctrl.isOneSelected()">\n        <div class="btn btn-sm ng-binding">\n          {{ctrl.getSelectedRowCount()}} <span translate>selected element(s)</span>\n        </div>\n      </li>\n\n      <li\n        ng-show="ctrl.isOneSelected()"\n        class="ng-hide">\n        <button\n          class="btn btn-link btn-sm"\n          title="{{\'Zoom to selection\' | translate}}"\n          ng-click="ctrl.zoomToSelection()">\n          <i class="fa fa-search-plus"></i> <span translate>Zoom to</span>\n        </button>\n      </li>\n\n      <li\n        ng-show="ctrl.isOneSelected()"\n        class="ng-hide">\n        <button\n          class="btn btn-link btn-sm"\n          title="{{\'Export selection as CSV\' | translate}}"\n          ng-click="ctrl.downloadCsv()">\n          <i class="fa fa-download"></i> <span translate>Export as CSV</span>\n        </button>\n      </li>\n\n      <li class="dropdown">\n        <button\n          type="button"\n          class="dropup btn btn-default btn-sm dropdown-toggle"\n          data-toggle="dropdown"\n          aria-haspopup="true"\n          aria-expanded="false">\n          <span translate>Select</span>\n        </button>\n        <ul\n          class="dropdown-menu"\n          aria-labelledby="dLabel">\n          <li>\n            <a\n              href=""\n              ng-click="ctrl.selectAll()" translate>All</a>\n          </li>\n          <li>\n            <a\n              href=""\n              ng-click="ctrl.unselectAll()" translate>None</a>\n          </li>\n          <li>\n            <a\n              href=""\n              ng-click="ctrl.invertSelection()" translate>Reverse selection</a>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </div>\n\n  <div\n    ng-show="ctrl.pending"\n    class="gmf-displayquerygrid-pending">\n    <span class="fa fa-spinner fa-spin"></span>\n  </div>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/query/gridComponent.js":
/*!*************************************************!*\
  !*** ./contribs/gmf/src/query/gridComponent.js ***!
  \*************************************************/
/*! exports provided: QueryGridController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QueryGridController", function() { return QueryGridController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_download_Csv_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/download/Csv.js */ "./src/download/Csv.js");
/* harmony import */ var ngeo_download_service_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/download/service.js */ "./src/download/service.js");
/* harmony import */ var ngeo_grid_component_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/grid/component.js */ "./src/grid/component.js");
/* harmony import */ var ngeo_grid_Config_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/grid/Config.js */ "./src/grid/Config.js");
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/query/MapQuerent.js */ "./src/query/MapQuerent.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
/* harmony import */ var ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/style/Circle.js */ "./node_modules/ol/style/Circle.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");
QueryGridController.$inject = ["$injector", "$scope", "ngeoQueryResult", "ngeoMapQuerent", "ngeoFeatureOverlayMgr", "$timeout", "ngeoCsvDownload", "$element"];















var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfQueryGridComponent', [ngeo_download_Csv_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_download_service_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_grid_component_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_6__["default"].name]);
module.value('gmfDisplayquerygridTemplateUrl', function ($element, $attrs) {
  var templateUrl = $attrs.gmfDisplayquerygridTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'gmf/query/gridComponent';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/query/gridComponent', __webpack_require__(/*! ./gridComponent.html */ "./contribs/gmf/src/query/gridComponent.html"));
}]);
gmfDisplayquerygridTemplateUrl.$inject = ["$element", "$attrs", "gmfDisplayquerygridTemplateUrl"];

function gmfDisplayquerygridTemplateUrl($element, $attrs, gmfDisplayquerygridTemplateUrl) {
  return gmfDisplayquerygridTemplateUrl($element, $attrs);
}

var queryGridComponent = {
  controller: 'GmfDisplayquerygridController as ctrl',
  bindings: {
    'active': '=?gmfDisplayquerygridActive',
    'featuresStyleFn': '&gmfDisplayquerygridFeaturesstyle',
    'selectedFeatureStyleFn': '&gmfDisplayquerygridSelectedfeaturestyle',
    'getMapFn': '&gmfDisplayquerygridMap',
    'removeEmptyColumnsFn': '&?gmfDisplayquerygridRemoveemptycolumns',
    'maxResultsFn': '&?gmfDisplayquerygridMaxresults',
    'maxRecenterZoomFn': '&?gmfDisplayquerygridMaxrecenterzoom',
    'mergeTabs': '<?gmfDisplayquerygridMergetabs'
  },
  templateUrl: gmfDisplayquerygridTemplateUrl
};
module.component('gmfDisplayquerygrid', queryGridComponent);
function QueryGridController($injector, $scope, ngeoQueryResult, ngeoMapQuerent, ngeoFeatureOverlayMgr, $timeout, ngeoCsvDownload, $element) {
  var _this = this;

  var queryOptions = $injector.has('ngeoQueryOptions') ? $injector.get('ngeoQueryOptions') : {};
  this.$scope_ = $scope;
  this.$timeout_ = $timeout;
  this.ngeoQueryResult = ngeoQueryResult;
  this.ngeoMapQuerent_ = ngeoMapQuerent;
  this.ngeoCsvDownload_ = ngeoCsvDownload;
  this.$element_ = $element;
  this.maxResults = queryOptions.limit !== undefined ? queryOptions.limit : 50;
  this.active = false;
  this.pending = false;
  this.gridSources = {};
  this.loadedGridSources = [];
  this.selectedTab = null;
  this.removeEmptyColumns_ = false;
  this.maxRecenterZoom = null;
  this.mergeTabs = {};
  this.featuresForSources_ = {};
  this.features_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__["default"]();
  this.ngeoFeatureOverlayMgr_ = ngeoFeatureOverlayMgr;
  this.highlightFeatures_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__["default"]();
  this.filename_ = $injector.has('gmfCsvFilename') ? $injector.get('gmfCsvFilename') : 'query-results.csv';
  this.map_ = null;
  this.$scope_.$watchCollection(function () {
    return ngeoQueryResult;
  }, function (newQueryResult, oldQueryResult) {
    if (newQueryResult !== oldQueryResult) {
      _this.updateData_();
    }
  });
  this.unregisterSelectWatcher_ = null;

  this.removeEmptyColumnsFn = function () {
    return false;
  };

  this.maxRecenterZoomFn = function () {
    return null;
  };

  this.featuresStyleFn = null;
  this.selectedFeatureStyleFn = null;
  this.getMapFn = null;
}

QueryGridController.prototype.$onInit = function () {
  if (!this.getMapFn) {
    throw new Error('Missing getMapFn');
  }

  if (!this.featuresStyleFn) {
    throw new Error('Missing featuresStyleFn');
  }

  if (!this.selectedFeatureStyleFn) {
    throw new Error('Missing selectedFeatureStyleFn');
  }

  this.removeEmptyColumns_ = this.removeEmptyColumnsFn();
  this.maxRecenterZoom = this.maxRecenterZoomFn();
  var featuresOverlay = this.ngeoFeatureOverlayMgr_.getFeatureOverlay();
  featuresOverlay.setFeatures(this.features_);
  var featuresStyle = this.featuresStyleFn();

  if (featuresStyle !== undefined) {
    if (!(featuresStyle instanceof ol_style_Style_js__WEBPACK_IMPORTED_MODULE_13__["default"])) {
      throw new Error('Wrong featuresStyle type');
    }

    featuresOverlay.setStyle(featuresStyle);
  }

  var highlightFeaturesOverlay = this.ngeoFeatureOverlayMgr_.getFeatureOverlay();
  highlightFeaturesOverlay.setFeatures(this.highlightFeatures_);
  var highlightFeatureStyle = this.selectedFeatureStyleFn();

  if (highlightFeatureStyle !== undefined) {
    if (!(highlightFeatureStyle instanceof ol_style_Style_js__WEBPACK_IMPORTED_MODULE_13__["default"])) {
      throw new Error('Wrong highlightFeatureStyle type');
    }
  } else {
    var fill = new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
      color: [255, 0, 0, 0.6]
    });
    var stroke = new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_12__["default"]({
      color: [255, 0, 0, 1],
      width: 2
    });
    highlightFeatureStyle = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_13__["default"]({
      fill: fill,
      image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
        fill: fill,
        radius: 5,
        stroke: stroke
      }),
      stroke: stroke,
      zIndex: 10
    });
  }

  highlightFeaturesOverlay.setStyle(highlightFeatureStyle);
  var mapFn = this.getMapFn;

  if (mapFn) {
    var map = mapFn();

    if (!(map instanceof ol_Map_js__WEBPACK_IMPORTED_MODULE_9__["default"])) {
      throw new Error('Wrong map type');
    }

    this.map_ = map;
  }
};

QueryGridController.prototype.getGridSources = function () {
  var _this2 = this;

  return this.loadedGridSources.map(function (sourceLabel) {
    return _this2.gridSources[sourceLabel];
  });
};

QueryGridController.prototype.updateData_ = function () {
  var _this3 = this;

  if ((this.ngeoQueryResult.pending || this.ngeoQueryResult.total === 0) && !this.hasOneWithTooManyResults_()) {
    var oldActive = this.active;
    this.clear();

    if (oldActive) {
      this.active = this.ngeoQueryResult.pending;
      this.pending = this.ngeoQueryResult.pending;
    }

    return;
  }

  this.active = true;
  this.pending = false;
  var sources = this.ngeoQueryResult.sources;

  if (Object.keys(this.mergeTabs).length > 0) {
    sources = this.getMergedSources_(sources);
  }

  sources.forEach(function (source) {
    if (source.tooManyResults) {
      _this3.makeGrid_(null, source);
    } else {
      source.id = _this3.escapeValue(source.id);
      var features = source.features;

      if (features.length > 0) {
        _this3.collectData_(source);
      }
    }
  });

  if (this.loadedGridSources.length === 0) {
    this.active = false;
    return;
  }

  if (this.selectedTab === null || !("" + this.selectedTab in this.gridSources)) {
    this.$timeout_(function () {
      var firstSourceId = _this3.loadedGridSources[0];

      _this3.selectTab(_this3.gridSources[firstSourceId]);
    }, 0);
  }
};

QueryGridController.prototype.hasOneWithTooManyResults_ = function () {
  return this.ngeoQueryResult.sources.some(function (source) {
    return source.tooManyResults;
  });
};

QueryGridController.prototype.escapeValue = function (value) {
  if (typeof value == 'number') {
    return value;
  } else {
    var toEscape = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\ |]/g;

    if (value.match(toEscape) !== null) {
      return value.replace(toEscape, '_');
    } else {
      return value;
    }
  }
};

QueryGridController.prototype.isSelected = function (gridSource) {
  return this.selectedTab === gridSource.source.label;
};

QueryGridController.prototype.getMergedSources_ = function (sources) {
  var _this4 = this;

  var allSources = [];
  var mergedSources = {};
  sources.forEach(function (source) {
    var mergedSource = _this4.getMergedSource_(source, mergedSources);

    if (mergedSource === null) {
      allSources.push(source);
    }
  });

  for (var mergedSourceId in mergedSources) {
    allSources.push(mergedSources[mergedSourceId]);
  }

  return allSources;
};

QueryGridController.prototype.getMergedSource_ = function (source, mergedSources) {
  var mergeSourceId = null;

  for (var currentMergeSourceId in this.mergeTabs) {
    var sourceLabels = this.mergeTabs[currentMergeSourceId];
    var containsSource = sourceLabels.some(function (sourceLabel) {
      return sourceLabel == source.label;
    });

    if (containsSource) {
      mergeSourceId = currentMergeSourceId;
      break;
    }
  }

  if (mergeSourceId === null) {
    return null;
  }

  var mergeSource;

  if (mergeSourceId in mergedSources) {
    mergeSource = mergedSources[mergeSourceId];
  } else {
    mergeSource = {
      features: [],
      id: mergeSourceId,
      label: mergeSourceId,
      limit: this.maxResults,
      pending: false,
      queried: true,
      tooManyResults: false
    };
    mergedSources[mergeSourceId] = mergeSource;
  }

  source.features.forEach(function (feature) {
    mergeSource.features.push(feature);
  });
  mergeSource.tooManyResults = mergeSource.tooManyResults || source.tooManyResults;

  if (mergeSource.tooManyResults) {
    mergeSource.totalFeatureCount = mergeSource.totalFeatureCount !== undefined ? mergeSource.totalFeatureCount + mergeSource.features.length : mergeSource.features.length;
    mergeSource.features = [];
  }

  if (source.totalFeatureCount !== undefined) {
    mergeSource.totalFeatureCount = mergeSource.totalFeatureCount !== undefined ? mergeSource.totalFeatureCount + source.totalFeatureCount : source.totalFeatureCount;
  }

  return mergeSource;
};

QueryGridController.prototype.collectData_ = function (source) {
  var features = source.features;
  var allProperties = [];
  var featureGeometriesNames = [];
  var featuresForSource = {};
  var properties, featureGeometryName;
  features.forEach(function (feature) {
    properties = feature.getProperties();

    if (properties !== undefined) {
      featureGeometryName = feature.getGeometryName();

      if (!featureGeometriesNames.includes(featureGeometryName)) {
        featureGeometriesNames.push(featureGeometryName);
      }

      allProperties.push(properties);
      featuresForSource[Object(ngeo_grid_Config_js__WEBPACK_IMPORTED_MODULE_4__["getRowUid"])(properties)] = feature;
    }
  });
  this.cleanProperties_(allProperties, featureGeometriesNames);

  if (allProperties.length > 0) {
    var gridCreated = this.makeGrid_(allProperties, source);

    if (gridCreated) {
      this.featuresForSources_["" + source.label] = featuresForSource;
    }
  }
};

QueryGridController.prototype.cleanProperties_ = function (allProperties, featureGeometriesNames) {
  allProperties.forEach(function (properties) {
    featureGeometriesNames.forEach(function (featureGeometryName) {
      delete properties[featureGeometryName];
    });
    delete properties.boundedBy;
    delete properties.ngeo_feature_type_;
  });

  if (this.removeEmptyColumns_ === true) {
    this.removeEmptyColumnsFn_(allProperties);
  }
};

QueryGridController.prototype.removeEmptyColumnsFn_ = function (allProperties) {
  var keysToKeep = [];
  var i, key;

  for (key in allProperties[0]) {
    for (i = 0; i < allProperties.length; i++) {
      if (allProperties[i][key] !== undefined) {
        keysToKeep.push(key);
        break;
      }
    }
  }

  var keyToRemove;
  allProperties.forEach(function (properties) {
    keyToRemove = [];

    for (key in properties) {
      if (!keysToKeep.includes(key)) {
        keyToRemove.push(key);
      }
    }

    keyToRemove.forEach(function (key) {
      delete properties[key];
    });
  });
};

QueryGridController.prototype.makeGrid_ = function (data, source) {
  var sourceLabel = "" + source.label;
  var gridConfig = null;

  if (data !== null) {
    gridConfig = this.getGridConfiguration_(data);

    if (gridConfig === null) {
      return false;
    }
  }

  if (!this.loadedGridSources.includes(sourceLabel)) {
    this.loadedGridSources.push(sourceLabel);
  }

  this.gridSources[sourceLabel] = {
    source: source
  };

  if (gridConfig) {
    this.gridSources[sourceLabel].configuration = gridConfig;
  }

  return true;
};

QueryGridController.prototype.getGridConfiguration_ = function (data) {
  if (!data.length) {
    throw new Error('Missing data');
  }

  var clone = {};
  Object.assign(clone, data[0]);
  delete clone.ol_uid;
  var columns = Object.keys(clone);
  var columnDefs = [];
  columns.forEach(function (column) {
    columnDefs.push({
      name: column
    });
  });

  if (columnDefs.length > 0) {
    return new ngeo_grid_Config_js__WEBPACK_IMPORTED_MODULE_4__["default"](data, columnDefs);
  } else {
    return null;
  }
};

QueryGridController.prototype.clear = function () {
  this.active = false;
  this.pending = false;
  this.gridSources = {};
  this.loadedGridSources = [];
  this.selectedTab = null;
  this.tooManyResults = false;
  this.features_.clear();
  this.highlightFeatures_.clear();
  this.ngeoMapQuerent_.clear();
  this.featuresForSources_ = {};

  if (this.unregisterSelectWatcher_) {
    this.unregisterSelectWatcher_();
  }
};

QueryGridController.prototype.selectTab = function (gridSource) {
  var _this5 = this;

  var source = gridSource.source;
  this.selectedTab = source.label;

  if (this.unregisterSelectWatcher_) {
    this.unregisterSelectWatcher_();
    this.unregisterSelectWatcher_ = null;
  }

  if (gridSource.configuration !== undefined) {
    this.unregisterSelectWatcher_ = this.$scope_.$watchCollection(function () {
      return gridSource.configuration.selectedRows;
    }, function (newSelected, oldSelectedRows) {
      if (Object.keys(newSelected) !== Object.keys(oldSelectedRows)) {
        _this5.onSelectionChanged_();
      }
    });
  }

  this.updateFeatures_(gridSource);
  this.reflowGrid_();
};

QueryGridController.prototype.reflowGrid_ = function () {
  var id = this.escapeValue(this.selectedTab || '');
  var activePane = this.$element_.find("div.tab-pane#" + id);
  activePane.removeClass('active').addClass('active');
  this.$timeout_(function () {
    activePane.find('div.ngeo-grid-table-container table').trigger('reflow');
  });
};

QueryGridController.prototype.onSelectionChanged_ = function () {
  if (this.selectedTab === null) {
    return;
  }

  var gridSource = this.gridSources["" + this.selectedTab];
  this.updateFeatures_(gridSource);
};

QueryGridController.prototype.updateFeatures_ = function (gridSource) {
  this.features_.clear();
  this.highlightFeatures_.clear();

  if (!gridSource.configuration) {
    return;
  }

  var sourceLabel = "" + gridSource.source.label;
  var featuresForSource = this.featuresForSources_[sourceLabel];
  var selectedRows = gridSource.configuration.selectedRows;

  for (var rowId in featuresForSource) {
    var feature = featuresForSource[rowId];

    if (rowId in selectedRows) {
      this.highlightFeatures_.push(feature);
    } else {
      this.features_.push(feature);
    }
  }
};

QueryGridController.prototype.getActiveGridSource = function () {
  if (this.selectedTab === null) {
    return null;
  } else {
    return this.gridSources["" + this.selectedTab];
  }
};

QueryGridController.prototype.isOneSelected = function () {
  var source = this.getActiveGridSource();

  if (source === null || source.configuration === null) {
    return false;
  } else {
    return source.configuration.getSelectedCount() > 0;
  }
};

QueryGridController.prototype.getSelectedRowCount = function () {
  var source = this.getActiveGridSource();

  if (source === null || source.configuration === null) {
    return 0;
  } else {
    return source.configuration.getSelectedCount();
  }
};

QueryGridController.prototype.selectAll = function () {
  var source = this.getActiveGridSource();

  if (source !== null) {
    source.configuration.selectAll();
  }
};

QueryGridController.prototype.unselectAll = function () {
  var source = this.getActiveGridSource();

  if (source !== null) {
    source.configuration.unselectAll();
  }
};

QueryGridController.prototype.invertSelection = function () {
  var source = this.getActiveGridSource();

  if (source !== null) {
    source.configuration.invertSelection();
  }
};

QueryGridController.prototype.zoomToSelection = function () {
  if (!this.map_) {
    throw new Error('Missing map');
  }

  var source = this.getActiveGridSource();

  if (source !== null) {
    var extent = ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["createEmpty"]();
    this.highlightFeatures_.forEach(function (feature) {
      var geometry = feature.getGeometry();

      if (!geometry) {
        throw new Error('Missing geometry');
      }

      ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["extend"](extent, geometry.getExtent());
    });
    var size = this.map_.getSize();

    if (!size) {
      throw new Error('Missing size');
    }

    if (this.maxRecenterZoom === null) {
      throw new Error('Missing maxRecenterZoom');
    }

    this.map_.getView().fit(extent, {
      size: size,
      maxZoom: this.maxRecenterZoom
    });
  }
};

QueryGridController.prototype.downloadCsv = function () {
  var source = this.getActiveGridSource();

  if (source !== null) {
    var columnDefs = source.configuration.columnDefs;

    if (!columnDefs) {
      throw new Error('Missing columnDefs');
    }

    var selectedRows = source.configuration.getSelectedRows();
    this.ngeoCsvDownload_.startDownload(selectedRows, columnDefs, this.filename_);
  }
};

module.controller('GmfDisplayquerygridController', QueryGridController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/query/window.scss":
/*!********************************************!*\
  !*** ./contribs/gmf/src/query/window.scss ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/query/windowComponent.html":
/*!*****************************************************!*\
  !*** ./contribs/gmf/src/query/windowComponent.html ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n  class="gmf-displayquerywindow"\n  ng-class="{\'desktop\': ctrl.desktop, \'mobile\': !ctrl.desktop}"\n  ng-show="ctrl.open">\n\n  <button\n    class="collapse-button"\n    type="button"\n    ng-show="::!ctrl.desktop"\n    ngeo-swipe-up="ctrl.collapsed = false"\n    ngeo-swipe-down="ctrl.collapsed = true"\n    ngeo-swipe-disable-mouse\n    ng-click="ctrl.collapsed = !ctrl.collapsed"\n    ng-class="[ctrl.collapsed ? \'collapse-button-up\' : \'collapse-button-down\']">\n  </button>\n\n  <div\n  class="windowcontainer"\n  ng-swipe-disable-mouse\n  ng-swipe-left="ctrl.next()"\n  ng-swipe-right="ctrl.previous()">\n\n    <button\n      type="button"\n      class="btn fa-times close"\n      ng-click="ctrl.close()">\n    </button>\n\n    <div\n      class="animation-container"\n      ng-class="[ctrl.collapsed ? \'\' : \'animation-container-detailed\', ctrl.isNext ? \'next\' : \'previous\']">\n\n      <div\n        ng-animate-swap="ctrl.animate"\n        class="slide-animation gmf-animatable">\n\n        <div class="header ui-draggable-handle">\n          <p\n            class="title"\n            >{{ctrl.source.label | translate}}</p>\n          <p\n            class="subtitle"\n            >{{ctrl.getFeatureValues()[ctrl.source.identifierAttributeField]}}</p>\n        </div>\n\n        <div class="details">\n          <table>\n            <tr\n              ng-repeat="(key, value) in ctrl.getFeatureValues()"\n              ng-if="value !== undefined">\n              <td\n                class="details-key"\n                ng-bind-html="key | translate | ngeoTrustHtml"\n                ></td>\n              <td\n                class="details-value"\n                ng-bind-html="value | removeCDATA | ngeoTrustHtmlAuto"\n                ></td>\n            </tr>\n          </table>\n        </div>\n      </div>\n    </div>\n\n    <div class="navigate">\n\n      <div class="placeholder">\n        <button\n          type="button"\n          class="previous btn"\n          ng-disabled="ctrl.isFirst()"\n          ng-show="ctrl.getResultLength() > 1"\n          ng-click="ctrl.previous()">\n          <span ng-show="::ctrl.desktop">{{\'Prev.\' | translate}}</span>\n        </button>\n      </div>\n\n      <div class="results">\n        <span ng-show="::!ctrl.desktop">{{\'Result\' | translate}}</span>\n        <span>{{ctrl.currentResult + 1}}</span>\n        <span>/</span>\n        <span>{{ctrl.getResultLength()}}</span>\n        <div\n          ng-show="::ctrl.desktop"\n          class="dropup">\n\n          <button\n            type="button"\n            class="btn btn-default dropdown-toggle"\n            data-toggle="dropdown"\n            aria-expanded="false">\n            <span class="fa fa-filter"></span>\n          </button>\n\n          <ul\n            class="dropdown-menu dropdown-menu-right"\n            role="menu">\n\n            <li>\n              <a\n                href="#"\n                ng-click="ctrl.setSelectedSource(null)">\n                <i\n                  class="fa fa-fw"\n                  ng-class="{\'fa-check\': ctrl.selectedSource === null}">\n                </i>\n                <span>{{\'All layers\' | translate}} ({{ctrl.ngeoQueryResult.total}})</span>\n              </a>\n            </li>\n\n            <li\n              role="separator"\n              class="divider">\n            </li>\n\n            <li\n              ng-repeat-start="source in ctrl.ngeoQueryResult.sources | filter: ctrl.sourcesFilter" ng-repeat-end\n              ng-class="{\'disabled\': source.features.length <= 0}">\n              <a\n                href="#"\n                ng-click="ctrl.setSelectedSource(source)">\n                <i\n                  class="fa fa-fw"\n                  ng-class="{\'fa-check\': ctrl.selectedSource === source}">\n                </i>\n                <span>{{source.label | translate}} ({{source.features.length}})</span>\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n\n      <div class="placeholder">\n        <button\n          type="button"\n          class="next btn"\n          ng-disabled="ctrl.isLast()"\n          ng-show="ctrl.getResultLength() > 1"\n          ng-click="ctrl.next()">\n          <span ng-show="::ctrl.desktop">{{\'Next\' | translate}}</span>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/query/windowComponent.js":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/query/windowComponent.js ***!
  \***************************************************/
/*! exports provided: QueryWindowController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QueryWindowController", function() { return QueryWindowController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ngeo_misc_swipe_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/misc/swipe.js */ "./src/misc/swipe.js");
/* harmony import */ var ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/query/MapQuerent.js */ "./src/query/MapQuerent.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_obj_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/obj.js */ "./node_modules/ol/obj.js");
/* harmony import */ var ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/style/Circle.js */ "./node_modules/ol/style/Circle.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var jquery_ui_ui_widgets_resizable_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! jquery-ui/ui/widgets/resizable.js */ "./node_modules/jquery-ui/ui/widgets/resizable.js");
/* harmony import */ var jquery_ui_ui_widgets_resizable_js__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_resizable_js__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/sass/jquery-ui.scss */ "./src/sass/jquery-ui.scss");
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var angular_animate__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! angular-animate */ "./node_modules/angular-animate/index.js");
/* harmony import */ var angular_animate__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(angular_animate__WEBPACK_IMPORTED_MODULE_13__);
/* harmony import */ var angular_touch__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! angular-touch */ "./node_modules/angular-touch/index.js");
/* harmony import */ var angular_touch__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(angular_touch__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var bootstrap_js_src_collapse_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! bootstrap/js/src/collapse.js */ "./node_modules/bootstrap/js/src/collapse.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");
QueryWindowController.$inject = ["$element", "$scope", "ngeoQueryResult", "ngeoMapQuerent", "ngeoFeatureOverlayMgr"];

















var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfQueryWindowComponent', [ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_misc_swipe_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, 'ngAnimate', 'ngTouch']);
module.config(['$animateProvider', function ($animateProvider) {
  $animateProvider.classNameFilter(/gmf-animatable/);
}]);
module.value('gmfDisplayquerywindowTemplateUrl', function ($element, $attrs) {
  var templateUrl = $attrs.gmfDisplayquerywindowTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'gmf/query/windowComponent';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/query/windowComponent', __webpack_require__(/*! ./windowComponent.html */ "./contribs/gmf/src/query/windowComponent.html"));
}]);
gmfDisplayquerywindowTemplateUrl.$inject = ["$element", "$attrs", "gmfDisplayquerywindowTemplateUrl"];

function gmfDisplayquerywindowTemplateUrl($element, $attrs, gmfDisplayquerywindowTemplateUrl) {
  return gmfDisplayquerywindowTemplateUrl($element, $attrs);
}

var queryWindowComponent = {
  controller: 'GmfDisplayquerywindowController as ctrl',
  bindings: {
    'draggableContainment': '<?gmfDisplayquerywindowDraggableContainment',
    'featuresStyleFn': '&gmfDisplayquerywindowFeaturesstyle',
    'selectedFeatureStyleFn': '&gmfDisplayquerywindowSelectedfeaturestyle',
    'defaultCollapsedFn': '&?gmfDisplayquerywindowDefaultcollapsed',
    'desktop': '=gmfDisplayquerywindowDesktop',
    'showUnqueriedLayers': '=gmfDisplayquerywindowShowunqueriedlayers'
  },
  templateUrl: gmfDisplayquerywindowTemplateUrl
};
module.component('gmfDisplayquerywindow', queryWindowComponent);
function QueryWindowController($element, $scope, ngeoQueryResult, ngeoMapQuerent, ngeoFeatureOverlayMgr) {
  var _this = this;

  this.draggableContainment = '';
  this.desktop = false;
  this.collapsed = !this.desktop;
  this.showUnqueriedLayers_ = false;
  this.sourcesFilter = {
    'queried': true
  };
  this.ngeoQueryResult = {
    sources: [],
    total: 0,
    pending: false
  };
  this.ngeoMapQuerent_ = ngeoMapQuerent;
  this.selectedSource = null;
  this.features_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_5__["default"]();
  this.ngeoFeatureOverlayMgr_ = ngeoFeatureOverlayMgr;
  this.highlightFeatures_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_5__["default"]();
  this.source = null;
  this.feature = null;
  this.currentResult = -1;
  this.isNext = true;
  this.animate = 0;
  this.open = false;
  this.element_ = $element;

  this.defaultCollapsedFn = function () {
    return !_this.desktop;
  };

  this.showUnqueriedLayers = false;
  this.featuresStyleFn = null;
  this.selectedFeatureStyleFn = null;
  $scope.$watchCollection(function () {
    return ngeoQueryResult;
  }, function (newQueryResult, oldQueryResult) {
    _this.updateQueryResult_(newQueryResult);

    if (newQueryResult.total > 0) {
      _this.show();
    } else if (oldQueryResult !== newQueryResult) {
      _this.open = false;

      _this.clear();
    }
  });
}

QueryWindowController.prototype.$onInit = function () {
  if (!this.featuresStyleFn) {
    throw new Error('Missing featuresStyleFn');
  }

  if (!this.selectedFeatureStyleFn) {
    throw new Error('Missing selectedFeatureStyleFn');
  }

  this.draggableContainment = this.draggableContainment || 'document';
  this.desktop = this.desktop;
  this.collapsed = this.defaultCollapsedFn();
  this.showUnqueriedLayers_ = this.showUnqueriedLayers;
  this.sourcesFilter = this.showUnqueriedLayers_ ? {} : {
    'queried': true
  };
  var featuresOverlay = this.ngeoFeatureOverlayMgr_.getFeatureOverlay();
  featuresOverlay.setFeatures(this.features_);
  var featuresStyle = this.featuresStyleFn();

  if (featuresStyle !== undefined) {
    if (!(featuresStyle instanceof ol_style_Style_js__WEBPACK_IMPORTED_MODULE_10__["default"])) {
      throw new Error('Wrong featuresStyle type');
    }

    featuresOverlay.setStyle(featuresStyle);
  }

  var highlightFeaturesOverlay = this.ngeoFeatureOverlayMgr_.getFeatureOverlay();
  highlightFeaturesOverlay.setFeatures(this.highlightFeatures_);
  var highlightFeatureStyle = this.selectedFeatureStyleFn();

  if (highlightFeatureStyle !== undefined) {
    if (!(highlightFeatureStyle instanceof ol_style_Style_js__WEBPACK_IMPORTED_MODULE_10__["default"])) {
      throw new Error('Wrong highlightFeatureStyle type');
    }
  } else {
    var fill = new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
      color: [255, 0, 0, 0.6]
    });
    var stroke = new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
      color: [255, 0, 0, 1],
      width: 2
    });
    highlightFeatureStyle = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
      fill: fill,
      image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
        fill: fill,
        radius: 5,
        stroke: stroke
      }),
      stroke: stroke
    });
  }

  highlightFeaturesOverlay.setStyle(highlightFeatureStyle);
  var windowContainer = this.element_.find('.gmf-displayquerywindow .windowcontainer');

  if (this.desktop) {
    windowContainer.draggable({
      handle: '.header',
      containment: this.draggableContainment
    });
    windowContainer.resizable({
      handles: 'all',
      minHeight: 240,
      minWidth: 240
    });
  }
};

QueryWindowController.prototype.show = function () {
  this.clear();
  this.updateFeatures_();
};

QueryWindowController.prototype.updateFeatures_ = function () {
  this.setCurrentResult_(0, false);

  if (this.source !== null) {
    this.collectFeatures_();
    this.highlightCurrentFeature_();
    this.open = true;
  }
};

QueryWindowController.prototype.setCurrentResult_ = function (position, setHighlight) {
  var hasChanged = false;

  if (position !== this.currentResult) {
    var i, source, features;
    var lastFeature = this.feature;
    var sources = this.ngeoQueryResult.sources;
    this.currentResult = position;

    for (i = 0; i < sources.length; i++) {
      source = sources[i];

      if (this.selectedSource !== null && this.selectedSource !== source) {
        continue;
      }

      features = source.features;

      if (position >= features.length) {
        position -= features.length;
      } else {
        this.source = source;
        this.feature = source.features[position];
        hasChanged = true;
        break;
      }
    }

    if (setHighlight) {
      this.highlightCurrentFeature_(lastFeature || undefined);
    }
  }

  return hasChanged;
};

QueryWindowController.prototype.previous = function () {
  var position = this.currentResult - 1;

  if (position < 0) {
    position = this.getResultLength() - 1;
  }

  var hasChanged = this.setCurrentResult_(position, true);

  if (hasChanged) {
    this.animate_(false);
  }
};

QueryWindowController.prototype.next = function () {
  var position = this.currentResult + 1;
  var positionMax = this.getResultLength() - 1;

  if (position > positionMax) {
    position = 0;
  }

  var hasChanged = this.setCurrentResult_(position, true);

  if (hasChanged) {
    this.animate_(true);
  }
};

QueryWindowController.prototype.updateQueryResult_ = function (queryResult) {
  this.ngeoQueryResult.total = 0;
  this.ngeoQueryResult.sources.length = 0;

  for (var _iterator = queryResult.sources, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
    var _ref;

    if (_isArray) {
      if (_i >= _iterator.length) break;
      _ref = _iterator[_i++];
    } else {
      _i = _iterator.next();
      if (_i.done) break;
      _ref = _i.value;
    }

    var source = _ref;
    source.features = source.features.filter(function (feature) {
      if (!feature) {
        throw new Error('Missing feature');
      }

      return !Object(ol_obj_js__WEBPACK_IMPORTED_MODULE_6__["isEmpty"])(Object(ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_2__["getFilteredFeatureValues"])(feature));
    });
    this.ngeoQueryResult.sources.push(source);
    this.ngeoQueryResult.total += source.features.length;
  }
};

QueryWindowController.prototype.getResultLength = function () {
  if (this.selectedSource === null) {
    return this.ngeoQueryResult.total;
  } else {
    return this.selectedSource.features.length;
  }
};

QueryWindowController.prototype.isFirst = function () {
  return this.currentResult == 0;
};

QueryWindowController.prototype.isLast = function () {
  return this.currentResult == this.getResultLength() - 1;
};

QueryWindowController.prototype.getFeatureValues = function () {
  if (!this.feature) {
    return null;
  }

  return Object(ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_2__["getFilteredFeatureValues"])(this.feature);
};

QueryWindowController.prototype.animate_ = function (isNext) {
  this.isNext = isNext;
  this.animate++;
};

QueryWindowController.prototype.collectFeatures_ = function () {
  var sources = this.ngeoQueryResult.sources;
  this.features_.clear();

  for (var _iterator2 = sources, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
    var _ref2;

    if (_isArray2) {
      if (_i2 >= _iterator2.length) break;
      _ref2 = _iterator2[_i2++];
    } else {
      _i2 = _iterator2.next();
      if (_i2.done) break;
      _ref2 = _i2.value;
    }

    var source = _ref2;

    if (this.selectedSource !== null && this.selectedSource !== source) {
      continue;
    }

    var features = source.features;

    for (var _iterator3 = features, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
      var _ref3;

      if (_isArray3) {
        if (_i3 >= _iterator3.length) break;
        _ref3 = _iterator3[_i3++];
      } else {
        _i3 = _iterator3.next();
        if (_i3.done) break;
        _ref3 = _i3.value;
      }

      var feature = _ref3;
      this.features_.push(feature);
    }
  }
};

QueryWindowController.prototype.highlightCurrentFeature_ = function (opt_lastFeature) {
  if (!this.feature) {
    throw new Error('Missing feature');
  }

  this.highlightFeatures_.clear();
  this.features_.remove(this.feature);
  this.highlightFeatures_.push(this.feature);

  if (opt_lastFeature !== undefined) {
    this.features_.push(opt_lastFeature);
  }
};

QueryWindowController.prototype.close = function () {
  this.open = false;
  this.clear();
  this.ngeoMapQuerent_.clear();
};

QueryWindowController.prototype.clear = function () {
  this.feature = null;
  this.source = null;
  this.currentResult = -1;
  this.features_.clear();
  this.highlightFeatures_.clear();
  this.selectedSource = null;
};

QueryWindowController.prototype.setSelectedSource = function (source) {
  if (source !== null && source.features.length <= 0) {
    return;
  }

  this.clear();
  this.selectedSource = source;
  this.updateFeatures_();
};

module.controller('GmfDisplayquerywindowController', QueryWindowController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/raster/RasterService.js":
/*!**************************************************!*\
  !*** ./contribs/gmf/src/raster/RasterService.js ***!
  \**************************************************/
/*! exports provided: RasterService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RasterService", function() { return RasterService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
RasterService.$inject = ["$http", "gmfRasterUrl"];

function RasterService($http, gmfRasterUrl) {
  this.$http_ = $http;
  this.url_ = gmfRasterUrl;
}
var Param = {
  X: 'lon',
  Y: 'lat'
};

RasterService.prototype.getRaster = function (coordinate, opt_params) {
  var params = opt_params || {};
  params[Param.X] = coordinate[0];
  params[Param.Y] = coordinate[1];
  return this.$http_.get(this.url_, {
    params: params
  }).then(function (resp) {
    return resp.data;
  });
};

RasterService.prototype.handleGetRaster_ = function (resp) {
  return resp.data;
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfRaster', []);
module.service('gmfRaster', RasterService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/raster/component.js":
/*!**********************************************!*\
  !*** ./contribs/gmf/src/raster/component.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_raster_RasterService_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/raster/RasterService.js */ "./contribs/gmf/src/raster/RasterService.js");
/* harmony import */ var ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/misc/debounce.js */ "./src/misc/debounce.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/MapBrowserEvent.js */ "./node_modules/ol/MapBrowserEvent.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");
Controller.$inject = ["$scope", "$filter", "ngeoDebounce", "gmfRaster", "gettextCatalog"];






var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfRasterComponent', [gmf_raster_RasterService_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/raster/widgetComponent', __webpack_require__(/*! ./widgetComponent.html */ "./contribs/gmf/src/raster/widgetComponent.html"));
}]);
module.value('gmfElevationwidgetTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.gmfElevationwidgetTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'gmf/raster/widgetComponent';
});
gmfElevationwidgetTemplateUrl.$inject = ["$attrs", "gmfElevationwidgetTemplateUrl"];

function gmfElevationwidgetTemplateUrl($attrs, gmfElevationwidgetTemplateUrl) {
  return gmfElevationwidgetTemplateUrl($attrs);
}

function rasterComponent() {
  return {
    restrict: 'A',
    controller: 'GmfElevationController as ctrl',
    bindToController: true,
    scope: {
      'active': '<gmfElevationActive',
      'elevation': '=gmfElevationElevation',
      'layersconfig': '=gmfElevationLayersconfig',
      'loading': '=?gmfElevationLoading',
      'layer': '<gmfElevationLayer',
      'map': '=gmfElevationMap'
    },
    link: function link(scope, element, attr) {
      var ctrl = scope.ctrl;
      scope.$watch(function () {
        return ctrl.active;
      }, function (active) {
        ctrl.toggleActive_(active);
      });
      scope.$watch(function () {
        return ctrl.layer;
      }, function (layer) {
        ctrl.layer = layer;
        ctrl.elevation = null;
      });
    }
  };
}

module.directive('gmfElevation', rasterComponent);

function Controller($scope, $filter, ngeoDebounce, gmfRaster, gettextCatalog) {
  this.filter_ = $filter;
  this.ngeoDebounce_ = ngeoDebounce;
  this.gmfRaster_ = gmfRaster;
  this.gettextCatalog = gettextCatalog;
  this.layersconfig = {};
  this.active = false;
  this.elevation = null;
  this.layer = '';
  this.map = null;
  this.listenerKeys_ = [];
  this.scope_ = $scope;
  this.inViewport_ = false;
  this.loading = false;
}

Controller.prototype.toggleActive_ = function (active) {
  var _this = this;

  this.elevation = null;

  if (active) {
    if (this.listenerKeys_.length) {
      throw new Error('Unexpexted listenerKeys');
    }

    if (!this.map) {
      throw new Error('Missing map');
    }

    var listener = function listener(event) {
      _this.scope_.$apply(function () {
        _this.inViewport_ = true;
        _this.elevation = null;
        _this.loading = false;
      });
    };

    this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(this.map, 'pointermove', listener));
    this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(this.map, 'pointermove', this.ngeoDebounce_(function (e) {
      if (_this.inViewport_ && e instanceof ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"]) {
        _this.loading = true;
        var params = {
          'layers': _this.layer
        };

        _this.gmfRaster_.getRaster(e.coordinate, params).then(_this.getRasterSuccess_.bind(_this), _this.getRasterError_.bind(_this));
      }
    }, 500, true)));
    this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(this.map.getViewport(), 'mouseout', function () {
      _this.scope_.$apply(function () {
        _this.elevation = null;
        _this.inViewport_ = false;
        _this.loading = false;
      });
    }));
  } else {
    this.elevation = null;
    this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["unlistenByKey"]);
    this.listenerKeys_.length = 0;
  }
};

Controller.prototype.getRasterSuccess_ = function (resp) {
  if (this.layer === undefined) {
    throw new Error('Missing layer');
  }

  var value = resp[this.layer];

  if (value !== undefined && value !== null) {
    var options = this.layersconfig[this.layer] || {};
    var filter = options.filter || 'number';
    var custom_args = options.args || [];
    var postfix = options.hasOwnProperty('postfix') ? options.postfix : 'm';
    var separator = postfix.length > 0 ? options.hasOwnProperty('separator') ? options.separator : "\xA0" : '';
    var args = Array.prototype.concat([value], custom_args);
    var elevation = this.filter_(filter).apply(void 0, args);

    if (typeof elevation != 'string') {
      throw new Error('Wrong elevation type');
    }

    this.elevation = elevation + separator + postfix;
  } else {
    var gettextCatalog = this.gettextCatalog;
    this.elevation = gettextCatalog.getString('No value');
  }

  this.loading = false;
};

Controller.prototype.getRasterError_ = function () {
  console.error('Error on getting the raster.');
  this.elevation = null;
  this.loading = false;
};

module.controller('GmfElevationController', Controller);
var rasterWidgetComponent = {
  controller: 'gmfElevationwidgetController as ctrl',
  bindings: {
    'map': '<gmfElevationwidgetMap',
    'layers': '<gmfElevationwidgetLayers',
    'layersconfig': '=gmfElevationwidgetLayersconfig',
    'active': '<gmfElevationwidgetActive'
  },
  templateUrl: gmfElevationwidgetTemplateUrl
};
module.component('gmfElevationwidget', rasterWidgetComponent);

function WidgetController() {
  this.map = null;
  this.layers = [];
  this.layersconfig = {};
  this.active = false;
  this.selectedElevationLayer = '';
}

WidgetController.prototype.$onInit = function () {
  this.selectedElevationLayer = this.layers[0];
};

module.controller('gmfElevationwidgetController', WidgetController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/raster/widgetComponent.html":
/*!******************************************************!*\
  !*** ./contribs/gmf/src/raster/widgetComponent.html ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="text-center btn-group dropup"\n    gmf-elevation\n    gmf-elevation-active="ctrl.active"\n    gmf-elevation-elevation="ctrl.elevationValue"\n    gmf-elevation-loading="ctrl.elevationLoading"\n    gmf-elevation-layer="ctrl.selectedElevationLayer"\n    gmf-elevation-layersconfig="ctrl.layersconfig"\n    gmf-elevation-map="::ctrl.map">\n  <a class="btn btn-default" aria-expanded="false"\n    ng-class="::{\'dropdown-toggle\': ctrl.layers.length > 1}"\n    ng-attr-data-toggle="{{::(ctrl.layers.length > 1) ? \'dropdown\' : \'\'}}"\n    >\n    <span class="gmf-elevationwidget-value">\n      {{ctrl.elevationValue}}\n      <span ng-show="ctrl.elevationLoading" class="fa fa-spinner"></span>\n      <span ng-show="!ctrl.elevationValue && !ctrl.elevationLoading" translate>Elevation…</span>\n    </span><span class="caret" ng-if="::ctrl.layers.length > 1"></span>\n  </a>\n  <ul class="dropdown-menu dropdown-menu-right" role="menu"\n      ng-if="::ctrl.layers.length > 1">\n    <li class="dropdown-header" translate>Elevation data sources</li>\n    <li ng-repeat="elevationItem in ::ctrl.layers">\n      <a href ng-click="ctrl.selectedElevationLayer = elevationItem">\n        <span class="fa fa-fw" ng-class="{\'fa-check\': ctrl.selectedElevationLayer === elevationItem}"></span>\n        {{elevationItem | translate}}\n      </a>\n    </li>\n  </ul>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/search/FulltextSearch.js":
/*!***************************************************!*\
  !*** ./contribs/gmf/src/search/FulltextSearch.js ***!
  \***************************************************/
/*! exports provided: FulltextSearchService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FulltextSearchService", function() { return FulltextSearchService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
FulltextSearchService.$inject = ["$injector", "$http"];


function FulltextSearchService($injector, $http) {
  this.$http_ = $http;
  this.url_ = $injector.get('fulltextsearchUrl');
  var url = this.url_.split('?');
  this.baseUrl_ = url[0];
  var queryString = url.length == 2 ? "?" + url[1] : '';
  this.defaultParams_ = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["decodeQueryString"])(queryString);
}

FulltextSearchService.prototype.search = function (query, params) {
  var _this = this;

  var queryParams = Object.assign({}, this.defaultParams_, params);
  queryParams['query'] = query;
  var url = this.baseUrl_ + "?" + Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["encodeQueryString"])(queryParams);
  return new Promise(function (resolve, reject) {
    _this.$http_.get(url).then(function (resp) {
      return resolve(resp['data']);
    }).catch(reject);
  });
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfSearchFulltextSearch', []);
module.service('gmfSearchFulltextSearch', FulltextSearchService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/search/component.html":
/*!************************************************!*\
  !*** ./contribs/gmf/src/search/component.html ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="gmf-search">\n  <input type="text" ng-attr-placeholder="{{$ctrl.placeholder|translate}}"\n    class="form-control"\n    ng-model="$ctrl.inputValue"\n    ngeo-search="$ctrl.options"\n    ngeo-search-datasets="$ctrl.datasets"\n    ngeo-search-listeners="$ctrl.listeners">\n  <span class="gmf-clear-button ng-hide"\n    ng-hide="!$ctrl.clearButton || $ctrl.inputValue == \'\'"\n    ng-click="$ctrl.onClearButton()">\n  </span>\n</div>\n<span ng-if="$ctrl.colorChooser">\n  <span ng-show="$ctrl.displayColorPicker" ngeo-popover ngeo-popover-placement="bottom">\n    <button class="gmf-color-button fa fa-tint" ngeo-popover-anchor\n            data-original-title="{{\'Change the color of the search result\'|translate}}"></button>\n    <div ngeo-popover-content>\n      <div ngeo-colorpicker ngeo-colorpicker-color="$ctrl.color"></div>\n    </div>\n  </span>\n</span>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/search/component.js":
/*!**********************************************!*\
  !*** ./contribs/gmf/src/search/component.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/index.js */ "./contribs/gmf/src/index.js");
/* harmony import */ var gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/layertree/TreeManager.js */ "./contribs/gmf/src/layertree/TreeManager.js");
/* harmony import */ var gmf_search_FulltextSearch_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/search/FulltextSearch.js */ "./contribs/gmf/src/search/FulltextSearch.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var ngeo_misc_AutoProjection_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/misc/AutoProjection.js */ "./src/misc/AutoProjection.js");
/* harmony import */ var ngeo_misc_colorpickerComponent_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/misc/colorpickerComponent.js */ "./src/misc/colorpickerComponent.js");
/* harmony import */ var ngeo_message_popoverComponent_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/message/popoverComponent.js */ "./src/message/popoverComponent.js");
/* harmony import */ var ngeo_search_module_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/search/module.js */ "./src/search/module.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_color_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/color.js */ "./node_modules/ol/color.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/format/GeoJSON.js */ "./node_modules/ol/format/GeoJSON.js");
/* harmony import */ var ol_proj_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ol/proj.js */ "./node_modules/ol/proj.js");
/* harmony import */ var ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/style/Circle.js */ "./node_modules/ol/style/Circle.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_RegularShape_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/style/RegularShape.js */ "./node_modules/ol/style/RegularShape.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_uri_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ol/uri.js */ "./node_modules/ol/uri.js");
/* harmony import */ var ol_geom_SimpleGeometry_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ol/geom/SimpleGeometry.js */ "./node_modules/ol/geom/SimpleGeometry.js");






















var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfSearch', [gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_search_FulltextSearch_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_misc_AutoProjection_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, ngeo_misc_colorpickerComponent_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, ngeo_search_module_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_message_popoverComponent_js__WEBPACK_IMPORTED_MODULE_8__["default"].name]);

function gmfSearchTemplateUrl_(element, attrs) {
  var templateUrl = attrs.gmfSearchTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'gmf/search';
}

module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/search', __webpack_require__(/*! ./component.html */ "./contribs/gmf/src/search/component.html"));
}]);
gmfSearchTemplateUrl.$inject = ["$element", "$attrs", "gmfSearchTemplateUrl"];

function gmfSearchTemplateUrl($element, $attrs, gmfSearchTemplateUrl) {
  return gmfSearchTemplateUrl($element, $attrs);
}

var searchComponent = {
  bindings: {
    'inputValue': '=?gmfSearchInputValue',
    'placeholder': '@?gmfSearchPlaceholder',
    'map': '<gmfSearchMap',
    'datasources': '<gmfSearchDatasources',
    'typeaheadOptions': '<?gmfSearchOptions',
    'featuresStyles': '<?gmfSearchStyles',
    'clearButton': '=?gmfSearchClearbutton',
    'colorChooser': '<?gmfSearchColorchooser',
    'coordinatesProjections': '<?gmfSearchCoordinatesprojections',
    'additionalListeners': '<gmfSearchListeners',
    'maxZoom': '<?gmfSearchMaxzoom',
    'delay': '<?gmfSearchDelay',
    'onInitCallback': '<?gmfSearchOnInit'
  },
  controller: 'gmfSearchController',
  templateUrl: gmfSearchTemplateUrl
};
module.value('gmfSearchTemplateUrl', gmfSearchTemplateUrl_);
module.component('gmfSearch', searchComponent);

var SearchController = function () {
  SearchController.$inject = ["$element", "$scope", "$compile", "$timeout", "$injector", "gettextCatalog", "ngeoAutoProjection", "ngeoSearchCreateGeoJSONBloodhound", "ngeoFeatureOverlayMgr", "gmfThemes", "gmfTreeManager", "gmfSearchFulltextSearch"];

  function SearchController($element, $scope, $compile, $timeout, $injector, gettextCatalog, ngeoAutoProjection, ngeoSearchCreateGeoJSONBloodhound, ngeoFeatureOverlayMgr, gmfThemes, gmfTreeManager, gmfSearchFulltextSearch) {
    this.element_ = $element;
    this.scope_ = $scope;
    this.compile_ = $compile;
    this.timeout_ = $timeout;
    this.gettextCatalog_ = gettextCatalog;
    this.gmfThemes_ = gmfThemes;
    this.gmfTreeManager_ = gmfTreeManager;
    this.fullTextSearch_ = gmfSearchFulltextSearch;
    this.ngeoSearchCreateGeoJSONBloodhound_ = ngeoSearchCreateGeoJSONBloodhound;
    this.ngeoFeatureOverlayMgr = ngeoFeatureOverlayMgr;
    this.ngeoLocation_;

    if ($injector.has('ngeoLocation')) {
      this.ngeoLocation_ = $injector.get('ngeoLocation');
    }

    this.ngeoAutoProjection_ = ngeoAutoProjection;
    this.map = null;
    this.styles_ = {};
    this.onInitCallback = null;
    this.clearButton = false;
    this.colorChooser = false;
    this.placeholder = '';
    this.delay = 0;
    this.maxZoom = 16;
    this.coordinatesProjections = [];
    this.coordinatesProjectionsInstances = [];
    this.featureOverlay_ = ngeoFeatureOverlayMgr.getFeatureOverlay();
    this.datasources = [];
    this.typeaheadOptions = null;
    this.options = {
      highlight: true
    };
    this.featuresStyles = {};
    this.datasets = [];
    this.inputValue = '';
    this.color = '';
    this.displayColorPicker = false;
    this.listeners = null;
    this.additionalListeners = {};
  }

  var _proto = SearchController.prototype;

  _proto.$onInit = function $onInit() {
    var _this = this;

    if (!this.map) {
      throw new Error('Missing map');
    }

    if (!this.ngeoLocation_) {
      throw new Error('Missing ngeoLocation');
    }

    var gettextCatalog = this.gettextCatalog_;
    this.clearButton = this.clearButton !== false;
    this.colorChooser = this.colorChooser === true;

    if (this.delay === undefined) {
      this.delay = 50;
    }

    this.placeholder = this.placeholder !== undefined ? this.placeholder : gettextCatalog.getString('Search…');
    this.coordinatesProjectionsInstances = this.coordinatesProjections === undefined ? [this.map.getView().getProjection()] : this.ngeoAutoProjection_.getProjectionList(this.coordinatesProjections);

    if (!this.clearButton) {
      this.element_.find('input').on('focus blur', function () {
        _this.clear();
      });
    }

    if (this.onInitCallback) {
      this.onInitCallback();
    }

    this.initStyles_();
    this.featureOverlay_.setStyle(this.getSearchStyle_.bind(this));

    if (this.typeaheadOptions) {
      Object.assign(this.options, this.typeaheadOptions);
    }

    this.initDatasets_();
    this.scope_.$watch(function () {
      return _this.color;
    }, this.setStyleColor.bind(this));
    this.listeners = this.mergeListeners_(this.additionalListeners, {
      select: this.select_.bind(this),
      change: this.handleChange_.bind(this),
      close: this.close_.bind(this),
      datasetsempty: this.datasetsempty_.bind(this)
    });

    if (this.ngeoLocation_) {
      var searchQuery = this.ngeoLocation_.getParam('search');

      if (searchQuery) {
        var resultIndex = 1;

        if (this.ngeoLocation_.getParam('search-select-index')) {
          resultIndex = parseInt(this.ngeoLocation_.getParam('search-select-index') || '', 10);
        }

        var mapZoom;

        if (this.ngeoLocation_.getParam('search-maxzoom')) {
          mapZoom = parseInt(this.ngeoLocation_.getParam('search-maxzoom') || '', 10);
        } else if (this.ngeoLocation_.getParam('map_zoom')) {
          mapZoom = parseInt(this.ngeoLocation_.getParam('map_zoom') || '', 10);
        }

        this.fulltextsearch_(searchQuery, resultIndex, mapZoom);
      }
    }
  };

  _proto.mergeListeners_ = function mergeListeners_(additionalListeners, listeners) {
    if (additionalListeners === undefined) {
      return listeners;
    }

    return {
      open: additionalListeners.open,
      close: additionalListeners.close === undefined ? listeners.close : function () {
        listeners.close();
        additionalListeners.close();
      },
      change: additionalListeners.change,
      cursorchange: additionalListeners.cursorchange,
      datasetsempty: additionalListeners.datasetsempty,
      select: additionalListeners.select === undefined ? listeners.select : function (evt, obj, dataset) {
        listeners.select(evt, obj, dataset);
        additionalListeners.select(evt, obj, dataset);
      },
      autocomplete: additionalListeners.autocomplete
    };
  };

  _proto.initDatasets_ = function initDatasets_() {
    var _this2 = this;

    if (!this.map) {
      throw new Error('Missing map');
    }

    var gettextCatalog = this.gettextCatalog_;

    var _loop = function _loop() {
      if (_isArray) {
        if (_i >= _iterator.length) return "break";
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) return "break";
        _ref = _i.value;
      }

      var datasource = _ref;
      var groupValues = datasource.groupValues !== undefined ? datasource.groupValues : [];
      var groupActions = datasource.groupActions ? datasource.groupActions : [];
      var filters = [];

      if (groupValues.length === 0) {
        filters.push({
          'title': '',
          'filter': _this2.filterLayername_()
        });
      } else {
        groupValues.forEach(function (layerName) {
          filters.push({
            'title': layerName,
            'filter': _this2.filterLayername_(layerName)
          });
        });
      }

      groupActions.forEach(function (action) {
        filters.push({
          'title': gettextCatalog.getString(action.title),
          'filter': _this2.filterAction_(action.action)
        });
      });
      filters.forEach(function (filter) {
        _this2.datasets.push(_this2.createDataset_({
          bloodhoundOptions: datasource.bloodhoundOptions,
          datasetTitle: filter.title,
          labelKey: datasource.labelKey,
          projection: datasource.projection,
          typeaheadDatasetOptions: datasource.typeaheadDatasetOptions,
          url: datasource.url
        }, filter.filter));
      });
    };

    for (var _iterator = this.datasources, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      var _ret = _loop();

      if (_ret === "break") break;
    }

    this.datasets.push({
      source: this.createSearchCoordinates_(this.map.getView()),
      name: 'coordinates',
      display: 'label',
      templates: {
        header: function header() {
          var header = gettextCatalog.getString('Recenter to');
          return "<div class=\"gmf-search-header\" translate>" + header + "</div>";
        },
        suggestion: function suggestion(_suggestion) {
          var coordinates = _suggestion.label;
          var html = "<p class=\"gmf-search-label\">" + coordinates + "</p>";
          html = "<div class=\"gmf-search-datum\">" + html + "</div>";
          return html;
        }
      }
    });
  };

  _proto.createDataset_ = function createDataset_(config, opt_filter) {
    var gettextCatalog = this.gettextCatalog_;
    var componentScope = this.scope_;
    var compile = this.compile_;
    var bloodhoundEngine = this.createAndInitBloodhound_(config, opt_filter);
    var typeaheadDataset = {
      limit: Infinity,
      source: bloodhoundEngine.ttAdapter(),
      display: function display(suggestion) {
        return suggestion.get(config.labelKey);
      },
      templates: {
        header: function header() {
          if (!config.datasetTitle) {
            return '';
          } else {
            var header = gettextCatalog.getString(config.datasetTitle);
            return "<div class=\"gmf-search-header\">" + header + "</div>";
          }
        },
        suggestion: function suggestion(_suggestion2) {
          var scope = componentScope.$new(true);
          scope.feature = _suggestion2;
          var html = "<p class=\"gmf-search-label\" translate>" + _suggestion2.get(config.labelKey) + "</p>";
          html += "<p class=\"gmf-search-group\" translate>" + (_suggestion2.get('layer_name') || config.datasetTitle) + "</p>";
          html = "<div class=\"gmf-search-datum\">" + html + "</div>";
          return compile(html)(scope).html();
        }
      }
    };

    if (config.typeaheadDatasetOptions) {
      Object.assign(typeaheadDataset, config.typeaheadDatasetOptions);
    }

    return typeaheadDataset;
  };

  _proto.filterAction_ = function filterAction_(action) {
    return function (feature) {
      var properties = feature.properties || {};

      if (properties.actions) {
        return !properties.layer_name && properties.actions.some(function (act) {
          return act.action === action;
        });
      } else {
        return false;
      }
    };
  };

  _proto.filterLayername_ = function filterLayername_(opt_layerName) {
    return function (feature) {
      var featureLayerName = (feature.properties || {}).layer_name;

      if (featureLayerName === undefined) {
        return false;
      }

      if (opt_layerName === undefined) {
        return true;
      }

      return featureLayerName === opt_layerName;
    };
  };

  _proto.createAndInitBloodhound_ = function createAndInitBloodhound_(config, opt_filter) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    var mapProjectionCode = this.map.getView().getProjection().getCode();
    var remoteOptions = this.getBloodhoudRemoteOptions_();
    var bloodhound = this.ngeoSearchCreateGeoJSONBloodhound_(config.url, opt_filter, ol_proj_js__WEBPACK_IMPORTED_MODULE_14__["get"](mapProjectionCode), ol_proj_js__WEBPACK_IMPORTED_MODULE_14__["get"](config.projection), config.bloodhoundOptions, remoteOptions);
    bloodhound.initialize();
    return bloodhound;
  };

  _proto.getBloodhoudRemoteOptions_ = function getBloodhoudRemoteOptions_() {
    var gettextCatalog = this.gettextCatalog_;
    return {
      rateLimitWait: this.delay,
      prepare: function prepare(query, settings) {
        var url = settings.url;

        if (!url) {
          throw new Error('Missing URL');
        }

        var lang = gettextCatalog.getCurrentLanguage();
        settings.xhrFields = {
          withCredentials: true
        };
        settings.url = Object(ol_uri_js__WEBPACK_IMPORTED_MODULE_20__["appendParams"])(url, {
          query: query,
          lang: lang
        });
        return settings;
      }
    };
  };

  _proto.createSearchCoordinates_ = function createSearchCoordinates_(view) {
    var _this3 = this;

    var viewProjection = view.getProjection();
    var extent = viewProjection.getExtent();
    return function (query, callback) {
      var suggestions = [];

      var coordinates = _this3.ngeoAutoProjection_.stringToCoordinates(query);

      if (coordinates === null) {
        return;
      }

      var position = _this3.ngeoAutoProjection_.tryProjectionsWithInversion(coordinates, extent, viewProjection, _this3.coordinatesProjections);

      if (position === null) {
        return;
      }

      suggestions.push({
        label: coordinates.join(' '),
        position: position,
        tt_source: 'coordinates'
      });
      callback(suggestions);
    };
  };

  _proto.initStyles_ = function initStyles_() {
    this.styles_[gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["COORDINATES_LAYER_NAME"]] = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_19__["default"]({
      image: new ol_style_RegularShape_js__WEBPACK_IMPORTED_MODULE_17__["default"]({
        stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_18__["default"]({
          color: [0, 0, 0, 0.7],
          width: 2
        }),
        points: 4,
        radius: 8,
        radius2: 0,
        angle: 0
      })
    });
    var fill = new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_16__["default"]({
      color: [65, 134, 240, 0.5]
    });
    var stroke = new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_18__["default"]({
      color: [65, 134, 240, 1],
      width: 2
    });
    this.styles_['default'] = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_19__["default"]({
      fill: fill,
      image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_15__["default"]({
        fill: fill,
        radius: 5,
        stroke: stroke
      }),
      stroke: stroke
    });
    var customStyles = this.featuresStyles || {};
    Object.assign(this.styles_, customStyles);
  };

  _proto.getSearchStyle_ = function getSearchStyle_(feature, resolution) {
    if (!feature) {
      throw new Error('Missing feature');
    }

    var style = this.styles_[feature.get('layer_name')] || this.styles_['default'];

    if (this.color) {
      var color = Object(ol_color_js__WEBPACK_IMPORTED_MODULE_11__["asArray"])(this.color);
      var strokeColor = color.slice();
      strokeColor[3] = 1;
      var fillColor = color.slice();
      fillColor[3] = 0.5;
      var strokeStyle = style.getStroke();

      if (strokeStyle) {
        strokeStyle.setColor(strokeColor);
      }

      var fillStyle = style.getFill();

      if (fillStyle) {
        fillStyle.setColor(fillColor);
      }

      var imageStyle = style.getImage();

      if (imageStyle) {
        imageStyle = imageStyle.clone();
        var imageStrokeStyle = imageStyle.getStroke();

        if (imageStrokeStyle) {
          imageStrokeStyle.setColor(strokeColor);
        }

        var imageFillStyle = imageStyle.getFill();

        if (imageFillStyle) {
          imageFillStyle.setColor(fillColor);
        }

        style.setImage(imageStyle);
      }
    }

    return style;
  };

  _proto.setStyleColor = function setStyleColor(color) {
    if (color) {
      this.color = color;
      this.ngeoFeatureOverlayMgr.getLayer().changed();
    }
  };

  _proto.setTTDropdownVisibility_ = function setTTDropdownVisibility_() {
    if (this.clearButton) {
      var ttDropdown = this.element_.find('.twitter-typeahead .tt-menu');
      this.inputValue ? ttDropdown.show() : ttDropdown.hide();
    }
  };

  _proto.onClearButton = function onClearButton() {
    this.featureOverlay_.clear();
    this.clear();
  };

  _proto.clear = function clear() {
    var typeahead = this.element_.find('.twitter-typeahead');
    var ttmenu = typeahead.children('.tt-menu');
    var inputs = typeahead.children('input');
    this.inputValue = '';
    $(inputs[1]).typeahead('val', '');
    ttmenu.children('.tt-dataset').empty();
    this.setTTDropdownVisibility_();
    this.displayColorPicker = false;
  };

  _proto.blur = function blur() {
    var typeahead = this.element_.find('.twitter-typeahead');
    var inputs = typeahead.children('input');
    this.timeout_(function () {
      $(inputs[1]).blur();
    });
  };

  _proto.select_ = function select_(event, suggestion, dataset) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    if (suggestion.tt_source === 'coordinates') {
      var geom = new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__["default"](suggestion.position);
      this.featureOverlay_.clear();
      this.featureOverlay_.addFeature(new ol_Feature_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
        geometry: geom,
        'layer_name': gmf_index_js__WEBPACK_IMPORTED_MODULE_1__["COORDINATES_LAYER_NAME"]
      }));
      this.map.getView().setCenter(suggestion.position);
      this.leaveSearch_();
    } else {
      if (!(suggestion instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_10__["default"])) {
        throw new Error('Wrong suggestion type');
      }

      this.selectFromGMF_(event, suggestion, dataset);
    }
  };

  _proto.selectFromGMF_ = function selectFromGMF_(event, feature, dataset) {
    var _this4 = this;

    if (!this.map) {
      throw new Error('Missing map');
    }

    var actions = feature.get('actions');
    var featureGeometry = feature.getGeometry();

    if (actions) {
      var _loop2 = function _loop2(i, ii) {
        var action = actions[i];
        var actionName = action.action;
        var actionData = action.data;

        if (actionName == 'add_theme') {
          _this4.gmfThemes_.getThemesObject().then(function (themes) {
            var theme = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_4__["findThemeByName"])(themes, actionData);

            if (theme) {
              _this4.gmfTreeManager_.addFirstLevelGroups(theme.children);
            }
          });
        } else if (actionName == 'add_group') {
          _this4.gmfTreeManager_.addGroupByName(actionData, true);
        } else if (actionName == 'add_layer') {
          var groupActions = _this4.datasources[0].groupActions;
          var datasourcesActionsHaveAddLayer;
          groupActions.forEach(function (groupAction) {
            if (groupAction.action === 'add_layer') {
              datasourcesActionsHaveAddLayer = true;
              return true;
            }
          });

          if (datasourcesActionsHaveAddLayer) {
            var silent = !!featureGeometry;

            _this4.gmfTreeManager_.addGroupByLayerName(actionData, true, silent);
          }
        }
      };

      for (var i = 0, ii = actions.length; i < ii; i++) {
        _loop2(i, ii);
      }
    }

    var size = this.map.getSize();

    if (featureGeometry instanceof ol_geom_SimpleGeometry_js__WEBPACK_IMPORTED_MODULE_21__["default"] && size) {
      var view = this.map.getView();
      this.featureOverlay_.clear();
      this.featureOverlay_.addFeature(feature);
      this.displayColorPicker = true;
      var fitArray = featureGeometry.getType() === 'GeometryCollection' ? featureGeometry.getExtent() : featureGeometry;
      view.fit(fitArray, {
        size: size,
        maxZoom: this.maxZoom
      });
    }

    this.leaveSearch_();
  };

  _proto.leaveSearch_ = function leaveSearch_() {
    if (!this.clearButton) {
      this.clear();
    }

    this.blur();
  };

  _proto.close_ = function close_(event) {
    if (!this.clearButton) {
      this.setTTDropdownVisibility_();
    }
  };

  _proto.datasetsempty_ = function datasetsempty_(event, query, empty) {
    var menu = this.element_.find('.twitter-typeahead .tt-menu');
    var message = menu.children('.gmf-search-no-results');

    if (message.length == 0) {
      var gettextCatalog = this.gettextCatalog_;
      var innerHTML = gettextCatalog.getString('No result found');
      var div = $("<div class=\"gmf-search-no-results\" translate>" + innerHTML + "</div>");
      menu.append(div);
    }

    if (empty) {
      message.show();
      menu.addClass('gmf-search-no-results');
    } else {
      menu.removeClass('gmf-search-no-results');
      message.hide();
    }
  };

  _proto.fulltextsearch_ = function fulltextsearch_(query, resultIndex, opt_zoom) {
    var _this5 = this;

    if (resultIndex < 1) {
      resultIndex = 1;
    }

    this.fullTextSearch_.search(query, {
      limit: "" + resultIndex
    }).then(function (data) {
      if (!_this5.map) {
        throw new Error('Missing map');
      }

      if (data && data.features[resultIndex - 1]) {
        var format = new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_13__["default"]();
        var feature = format.readFeature(data.features[resultIndex - 1]);

        _this5.featureOverlay_.addFeature(feature);

        var fitOptions = {};

        if (opt_zoom !== undefined) {
          fitOptions.maxZoom = opt_zoom;
          fitOptions.size = _this5.map.getSize() || [];
        }

        var geometry = feature.getGeometry();

        if (!geometry) {
          throw new Error('Missing geometry');
        }

        _this5.map.getView().fit(geometry.getExtent(), fitOptions);

        _this5.inputValue = feature.get('label');
      }
    });
  };

  _proto.handleChange_ = function handleChange_(event, query) {
    if (query) {
      return;
    }

    this.datasetsempty_(event, query, false);
  };

  return SearchController;
}();

module.controller('gmfSearchController', SearchController);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./contribs/gmf/src/search/module.js":
/*!*******************************************!*\
  !*** ./contribs/gmf/src/search/module.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_search_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/search/component.js */ "./contribs/gmf/src/search/component.js");
/* harmony import */ var gmf_search_FulltextSearch_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/search/FulltextSearch.js */ "./contribs/gmf/src/search/FulltextSearch.js");
/* harmony import */ var _search_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./search.scss */ "./contribs/gmf/src/search/search.scss");
/* harmony import */ var _search_scss__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_search_scss__WEBPACK_IMPORTED_MODULE_3__);




/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfSearchModule', [gmf_search_component_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_search_FulltextSearch_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/search/search.scss":
/*!*********************************************!*\
  !*** ./contribs/gmf/src/search/search.scss ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./contribs/gmf/src/theme/Manager.js":
/*!*******************************************!*\
  !*** ./contribs/gmf/src/theme/Manager.js ***!
  \*******************************************/
/*! exports provided: ThemeEventType, ThemeManagerService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ThemeEventType", function() { return ThemeEventType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ThemeManagerService", function() { return ThemeManagerService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/layertree/TreeManager.js */ "./contribs/gmf/src/layertree/TreeManager.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ngeo_statemanager_Service_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/statemanager/Service.js */ "./src/statemanager/Service.js");
ThemeManagerService.$inject = ["$rootScope", "gmfThemes", "gmfTreeManagerModeFlush", "gmfTreeManager", "ngeoStateManager"];




var ThemeEventType = {
  THEME_NAME_SET: 'gmf-thememanager-theme_name_set'
};
function ThemeManagerService($rootScope, gmfThemes, gmfTreeManagerModeFlush, gmfTreeManager, ngeoStateManager) {
  this.$rootScope_ = $rootScope;
  this.gmfThemes_ = gmfThemes;
  this.modeFlush = gmfTreeManagerModeFlush;
  this.gmfTreeManager_ = gmfTreeManager;
  this.ngeoStateManager_ = ngeoStateManager;
  this.themeName_ = '';
}

ThemeManagerService.prototype.addTheme = function (theme, opt_silent) {
  if (this.modeFlush) {
    this.ngeoStateManager_.updateState({
      'theme': theme.name
    });
    this.setThemeName(theme.name);
    this.gmfTreeManager_.setFirstLevelGroups(theme.children);
  } else {
    this.gmfTreeManager_.addFirstLevelGroups(theme.children, false, opt_silent);
  }
};

ThemeManagerService.prototype.getThemeName = function () {
  return this.themeName_;
};

ThemeManagerService.prototype.isLoading = function () {
  return !this.gmfThemes_.loaded;
};

ThemeManagerService.prototype.updateCurrentTheme = function (themeName, fallbackThemeName, opt_silent) {
  var _this = this;

  this.gmfThemes_.getThemesObject().then(function (themes) {
    if (!themeName && _this.modeFlush) {
      var fallbackTheme = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["findThemeByName"])(themes, fallbackThemeName);

      if (fallbackTheme) {
        _this.gmfTreeManager_.setInitialFirstLevelGroups(fallbackTheme.children);

        _this.gmfTreeManager_.addFirstLevelGroups(fallbackTheme.children, false, opt_silent);
      }
    }

    if (themeName) {
      var theme = Object(gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["findThemeByName"])(themes, themeName);

      if (theme) {
        _this.addTheme(theme, true);
      }
    } else {
      _this.setThemeName(fallbackThemeName);
    }
  });
};

ThemeManagerService.prototype.setThemeName = function (name, opt_silent) {
  this.themeName_ = name;

  if (!opt_silent) {
    this.$rootScope_.$emit(ThemeEventType.THEME_NAME_SET, name);
  }
};

ThemeManagerService.prototype.removeAll = function () {
  this.gmfTreeManager_.removeAll();
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfThemeManager', [gmf_layertree_TreeManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_statemanager_Service_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]);
module.value('gmfTreeManagerModeFlush', true);
module.service('gmfThemeManager', ThemeManagerService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/theme/Themes.js":
/*!******************************************!*\
  !*** ./contribs/gmf/src/theme/Themes.js ***!
  \******************************************/
/*! exports provided: ThemesService, findGroupByLayerNodeName, findGroupByName, findObjectByName, findThemeByName, getFlatNodes, getSnappingConfig, getNodeMaxResolution, getNodeMinResolution, ThemeNodeType, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ThemesService", function() { return ThemesService; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findGroupByLayerNodeName", function() { return findGroupByLayerNodeName; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findGroupByName", function() { return findGroupByName; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findObjectByName", function() { return findObjectByName; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findThemeByName", function() { return findThemeByName; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFlatNodes", function() { return getFlatNodes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSnappingConfig", function() { return getSnappingConfig; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getNodeMaxResolution", function() { return getNodeMaxResolution; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getNodeMinResolution", function() { return getNodeMinResolution; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ThemeNodeType", function() { return ThemeNodeType; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_events_Target_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/events/Target.js */ "./node_modules/ol/events/Target.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }









var ThemesService = function (_olEventsEventTarget) {
  ThemesService.$inject = ["$http", "$injector", "$q", "ngeoLayerHelper", "gettextCatalog", "gmfThemesOptions"];

  _inheritsLoose(ThemesService, _olEventsEventTarget);

  function ThemesService($http, $injector, $q, ngeoLayerHelper, gettextCatalog, gmfThemesOptions) {
    var _this;

    _this = _olEventsEventTarget.call(this) || this;
    _this.addBlankBackgroundLayer_ = true;

    if (gmfThemesOptions.addBlankBackgroundLayer !== undefined) {
      _this.addBlankBackgroundLayer_ = gmfThemesOptions.addBlankBackgroundLayer;
    }

    _this.$q_ = $q;
    _this.$http_ = $http;
    _this.treeUrl_ = undefined;

    if ($injector.has('gmfTreeUrl')) {
      _this.treeUrl_ = $injector.get('gmfTreeUrl');
    }

    _this.ngeoLocation_ = null;

    if ($injector.has('ngeoLocation')) {
      _this.ngeoLocation_ = $injector.get('ngeoLocation');
    }

    _this.layerHelper_ = ngeoLayerHelper;
    _this.gettextCatalog = gettextCatalog;
    _this.deferred_ = $q.defer();
    _this.promise_ = _this.deferred_.promise;
    _this.loaded = false;
    _this.bgLayerPromise_ = null;
    return _this;
  }

  var _proto = ThemesService.prototype;

  _proto.getBgLayers = function getBgLayers() {
    var _this2 = this;

    var gettextCatalog = this.gettextCatalog;

    if (this.bgLayerPromise_) {
      return this.bgLayerPromise_;
    }

    var $q = this.$q_;
    var layerHelper = this.layerHelper_;

    var getIds = function getIds(item, array) {
      array.push(Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(item));
      var groupItem = item;
      var children = groupItem.children || [];
      children.forEach(function (child) {
        getIds(child, array);
      });
    };

    var callback = function callback(item, layer) {
      layer.set('label', item.name);
      layer.set('metadata', item.metadata);
      layer.set('dimensions', item.dimensions);
      var ids = [];
      getIds(item, ids);
      layer.set('querySourceIds', ids);
      layer.set('dataSourceId', item.id);
      return layer;
    };

    var layerLayerCreationFn = function layerLayerCreationFn(ogcServers, gmfLayer) {
      if (gmfLayer.type === 'WMTS') {
        var gmfLayerWMTS = gmfLayer;

        if (!gmfLayerWMTS.url) {
          throw 'Layer URL is required';
        }

        var minResolution = getNodeMinResolution(gmfLayerWMTS);
        var maxResolution = getNodeMaxResolution(gmfLayerWMTS);
        var layer = layerHelper.createWMTSLayerFromCapabilitites(gmfLayerWMTS.url, gmfLayerWMTS.layer || '', gmfLayerWMTS.matrixSet, gmfLayer.dimensions, gmfLayerWMTS.metadata.customOpenLayersOptions, minResolution, maxResolution).then(callback.bind(null, gmfLayer)).then(null, function (response) {
          var message = "Unable to build layer \"" + gmfLayerWMTS.layer + "\" " + ("from WMTSCapabilities: " + gmfLayerWMTS.url + "\n");
          message += "OpenLayers error is \"" + response.message;
          console.error(message);
          return $q.resolve(undefined);
        });
        return layer;
      } else if (gmfLayer.type === 'WMS') {
        var gmfLayerWMS = gmfLayer;

        if (!gmfLayerWMS.ogcServer) {
          throw new Error('Missing gmfLayerWMS.ogcServer');
        }

        var server = ogcServers[gmfLayerWMS.ogcServer];

        if (!server) {
          throw new Error('Missing server');
        }

        if (!server.url) {
          throw new Error('Missing server.url');
        }

        if (!server.imageType) {
          throw new Error('Missing server.imageType');
        }

        var opt_params = {
          STYLES: gmfLayerWMS.style
        };

        if (gmfLayer.dimensions) {
          for (var _i = 0, _Object$entries = Object.entries(gmfLayer.dimensions); _i < _Object$entries.length; _i++) {
            var _Object$entries$_i = _Object$entries[_i],
                key = _Object$entries$_i[0],
                value = _Object$entries$_i[1];

            if (value !== null) {
              opt_params[key] = value;
            }
          }
        }

        return callback(gmfLayer, layerHelper.createBasicWMSLayer(server.url, gmfLayerWMS.layers || '', server.imageType, server.type, undefined, opt_params, server.credential ? 'use-credentials' : 'anonymous', gmfLayerWMS.metadata.customOpenLayersOptions));
      }

      throw "Unsupported type: " + gmfLayer.type;
    };

    var layerGroupCreationFn = function layerGroupCreationFn(ogcServers, item) {
      var orderedChildren = item.children.map(function (x) {
        return x;
      }).reverse();
      var promises = orderedChildren.map(function (item) {
        return layerLayerCreationFn(ogcServers, item);
      });
      return $q.all(promises).then(function (layers) {
        var collection;

        if (layers) {
          layers = layers.filter(function (l) {
            return l;
          });
          collection = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_4__["default"](layers);
        }

        var group = layerHelper.createBasicGroup(collection);
        callback(item, group);
        return group;
      });
    };

    var promiseSuccessFn = function promiseSuccessFn(data) {
      var promises = data.background_layers.map(function (item) {
        var itemLayer = item;
        var itemGroup = item;
        var itemType = itemLayer.type;

        if (itemType === 'WMTS' || itemType === 'WMS') {
          return layerLayerCreationFn(data.ogcServers, itemLayer);
        } else if (itemGroup.children) {
          return layerGroupCreationFn(data.ogcServers, itemGroup);
        } else {
          return undefined;
        }
      });
      return $q.all(promises);
    };

    this.bgLayerPromise_ = this.promise_.then(promiseSuccessFn).then(function (values) {
      var layers = [];

      if (_this2.addBlankBackgroundLayer_) {
        gettextCatalog.getString('blank');
        var layer = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
          source: new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_7__["default"]()
        });
        layer.set('label', 'blank');
        layer.set('metadata', {
          thumbnail: ''
        });
        layers.push(layer);
      }

      values.forEach(function (layer) {
        if (layer) {
          layers.push(layer);
        }
      });
      return layers;
    });
    return this.bgLayerPromise_;
  };

  _proto.getThemeObject = function getThemeObject(themeName) {
    return this.promise_.then(function (data) {
      return findThemeByName(data.themes, themeName);
    });
  };

  _proto.getThemesObject = function getThemesObject() {
    return this.promise_.then(function (data) {
      return data.themes;
    });
  };

  _proto.getBackgroundLayersObject = function getBackgroundLayersObject() {
    if (this.promise_ === null) {
      throw new Error('Missing promise');
    }

    return this.promise_.then(function (data) {
      return data.background_layers;
    });
  };

  _proto.getOgcServersObject = function getOgcServersObject() {
    if (this.promise_ === null) {
      throw new Error('Missing promise');
    }

    return this.promise_.then(function (data) {
      return data.ogcServers;
    });
  };

  _proto.hasEditableLayers = function hasEditableLayers() {
    if (this.promise_ === null) {
      throw new Error('Missing promise');
    }

    return this.promise_.then(this.hasEditableLayers_.bind(this));
  };

  _proto.hasEditableLayers_ = function hasEditableLayers_(data) {
    var _this3 = this;

    return data.themes.some(function (theme) {
      var hasEditableLayers = theme.children.some(_this3.hasNodeEditableLayers_.bind(_this3));
      return hasEditableLayers;
    });
  };

  _proto.hasNodeEditableLayers_ = function hasNodeEditableLayers_(node) {
    if (node.editable) {
      return true;
    }

    var hasEditableLayers = false;
    var children = node.children;

    if (children && children.length) {
      hasEditableLayers = children.some(this.hasNodeEditableLayers_.bind(this));
    }

    return hasEditableLayers;
  };

  _proto.loadThemes = function loadThemes(opt_roleId) {
    var _this4 = this;

    if (!this.treeUrl_) {
      throw 'gmfTreeUrl should be defined.';
    }

    if (this.loaded) {
      this.deferred_ = this.$q_.defer();
      this.promise_ = this.deferred_.promise;
      this.bgLayerPromise_ = null;
      this.loaded = false;
    }

    this.$http_.get(this.treeUrl_, {
      params: opt_roleId !== undefined ? {
        'role': opt_roleId
      } : {},
      cache: false,
      withCredentials: true
    }).then(function (response) {
      if (response.data.errors.length != 0) {
        var message = "The themes contain some errors:\n" + response.data.errors.join('\n');
        console.error(message);

        if (_this4.ngeoLocation_ !== null && _this4.ngeoLocation_.hasParam('debug')) {
          window.alert(message);
        }
      }

      Object.values(response.data.ogcServers).forEach(function (server) {
        server.geometryName = server.geometryName || 'geometry';
      });

      _this4.deferred_.resolve(response.data);

      _this4.dispatchEvent('change');

      _this4.loaded = true;
    }, function (response) {
      _this4.deferred_.reject(response);
    });
  };

  return ThemesService;
}(ol_events_Target_js__WEBPACK_IMPORTED_MODULE_5__["default"]);
function findGroupByLayerNodeName(themes, name) {
  for (var i = 0, ii = themes.length; i < ii; i++) {
    var theme = themes[i];

    for (var j = 0, jj = theme.children.length; j < jj; j++) {
      var group = theme.children[j];
      var childNodes = [];
      getFlatNodes(group, childNodes);

      if (findObjectByName(childNodes, name)) {
        return group;
      }
    }
  }

  return null;
}
function findGroupByName(themes, name) {
  for (var i = 0, ii = themes.length; i < ii; i++) {
    var theme = themes[i];

    for (var j = 0, jj = theme.children.length; j < jj; j++) {
      var group = theme.children[j];
      var internalNodes = [];
      getFlatInternalNodes(group, internalNodes);

      if (findObjectByName(internalNodes, name)) {
        return group;
      }
    }
  }

  return null;
}
function findObjectByName(objects, objectName) {
  return ol_array_js__WEBPACK_IMPORTED_MODULE_3__["find"](objects, function (object) {
    return object.name === objectName;
  });
}
function findThemeByName(themes, themeName) {
  return findObjectByName(themes, themeName);
}

function getFlatInternalNodes(node, nodes) {
  var children = node.children;

  if (children !== undefined) {
    nodes.push(node);

    for (var _iterator = children, _isArray = Array.isArray(_iterator), _i2 = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i2 >= _iterator.length) break;
        _ref = _iterator[_i2++];
      } else {
        _i2 = _iterator.next();
        if (_i2.done) break;
        _ref = _i2.value;
      }

      var child = _ref;
      getFlatInternalNodes(child, nodes);
    }
  }
}

function getFlatNodes(node, nodes) {
  var children = node.children;

  if (children !== undefined) {
    for (var _iterator2 = children, _isArray2 = Array.isArray(_iterator2), _i3 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
      var _ref2;

      if (_isArray2) {
        if (_i3 >= _iterator2.length) break;
        _ref2 = _iterator2[_i3++];
      } else {
        _i3 = _iterator2.next();
        if (_i3.done) break;
        _ref2 = _i3.value;
      }

      var child = _ref2;
      getFlatNodes(child, nodes);
    }
  } else {
    nodes.push(node);
  }
}
function getSnappingConfig(node) {
  var config = node.metadata && node.metadata.snappingConfig !== undefined ? node.metadata.snappingConfig : null;

  if (config && config.activated === undefined) {
    config.activated = true;
  }

  return config;
}
function getNodeMaxResolution(gmfLayer) {
  var metadata = gmfLayer.metadata;
  var maxResolution = gmfLayer.maxResolutionHint;

  if (maxResolution === undefined && metadata !== undefined) {
    maxResolution = metadata.maxResolution;
  }

  return maxResolution;
}
function getNodeMinResolution(gmfLayer) {
  var metadata = gmfLayer.metadata;
  var minResolution = gmfLayer.minResolutionHint;

  if (minResolution === undefined && metadata !== undefined) {
    minResolution = metadata.minResolution;
  }

  return minResolution;
}
var ThemeNodeType = {
  MIXED_GROUP: 'MixedGroup',
  NOT_MIXED_GROUP: 'NotMixedGroup',
  WMTS: 'WMTS',
  WMS: 'WMS'
};
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfThemes', [ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.value('gmfThemesOptions', {});
module.service('gmfThemes', ThemesService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./contribs/gmf/src/theme/module.js":
/*!******************************************!*\
  !*** ./contribs/gmf/src/theme/module.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/theme/Manager.js */ "./contribs/gmf/src/theme/Manager.js");
/* harmony import */ var gmf_theme_selectorComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/theme/selectorComponent.js */ "./contribs/gmf/src/theme/selectorComponent.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");




/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfThemeModule', [gmf_theme_selectorComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]));

/***/ }),

/***/ "./contribs/gmf/src/theme/selectorComponent.html":
/*!*******************************************************!*\
  !*** ./contribs/gmf/src/theme/selectorComponent.html ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<ul class="gmf-theme-selector">\n  <li\n      ng-repeat="theme in $ctrl.themes"\n      ng-click="$ctrl.setTheme(theme)"\n      ng-class="{\'gmf-theme-selector-active\': $ctrl.gmfThemeManager.getThemeName() == theme.name}">\n    <img class="gmf-thumb"\n         ng-src="{{::theme.icon}}" />\n    <span class="gmf-text">{{theme.name | translate}}</span>\n  </li>\n</ul>\n';

}
return __p
}

/***/ }),

/***/ "./contribs/gmf/src/theme/selectorComponent.js":
/*!*****************************************************!*\
  !*** ./contribs/gmf/src/theme/selectorComponent.js ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gmf/theme/Manager.js */ "./contribs/gmf/src/theme/Manager.js");
/* harmony import */ var gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gmf/theme/Themes.js */ "./contribs/gmf/src/theme/Themes.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");
Controller.$inject = ["$scope", "gmfThemeManager", "gmfThemes"];





var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('gmfThemeSelectorComponent', [gmf_theme_Manager_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, gmf_theme_Themes_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('gmf/theme/selectorComponent', __webpack_require__(/*! ./selectorComponent.html */ "./contribs/gmf/src/theme/selectorComponent.html"));
}]);
module.value('gmfThemeSelectorTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.gmfThemeSelectorTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'gmf/theme/selectorComponent';
});
gmfThemeSelectorTemplateUrl.$inject = ["$attrs", "gmfThemeSelectorTemplateUrl"];

function gmfThemeSelectorTemplateUrl($attrs, gmfThemeSelectorTemplateUrl) {
  return gmfThemeSelectorTemplateUrl($attrs);
}

var themeSelectorComponent = {
  bindings: {
    'filter': '<gmfThemeselectorFilter'
  },
  controller: 'gmfThemeselectorController',
  templateUrl: gmfThemeSelectorTemplateUrl
};
module.component('gmfThemeselector', themeSelectorComponent);

function Controller($scope, gmfThemeManager, gmfThemes) {
  this.gmfThemeManager = gmfThemeManager;
  this.gmfThemes_ = gmfThemes;
  this.themes = [];

  this.filter = function (theme) {
    return undefined;
  };

  this.listenerKeys_ = [];
  this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(this.gmfThemes_, 'change', this.setThemes_, this));
  $scope.$on('$destroy', this.handleDestroy_.bind(this));
}

Controller.prototype.setThemes_ = function () {
  var _this = this;

  this.gmfThemes_.getThemesObject().then(function (themes) {
    _this.themes = _this.filter ? themes.filter(_this.filter) : themes;
  });
};

Controller.prototype.setTheme = function (theme, opt_silent) {
  if (theme) {
    this.gmfThemeManager.addTheme(theme, opt_silent);
  }
};

Controller.prototype.handleDestroy_ = function () {
  this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["unlistenByKey"]);
  this.listenerKeys_.length = 0;
};

module.controller('gmfThemeselectorController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./node_modules/@geoblocks/proj/src/EPSG_2056.js":
/*!*******************************************************!*\
  !*** ./node_modules/@geoblocks/proj/src/EPSG_2056.js ***!
  \*******************************************************/
/*! exports provided: code, proj, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "code", function() { return code; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "proj", function() { return proj; });
/* harmony import */ var _somerc_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./somerc.js */ "./node_modules/@geoblocks/proj/src/somerc.js");
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils.js */ "./node_modules/@geoblocks/proj/src/utils.js");


var code = 'EPSG:2056';
var def = "\n  +proj=" + _somerc_js__WEBPACK_IMPORTED_MODULE_0__["default"] + "\n  +lat_0=46.95240555555556\n  +lon_0=7.439583333333333\n  +k_0=1\n  +x_0=2600000\n  +y_0=1200000\n  +ellps=bessel\n  +towgs84=674.374,15.056,405.346,0,0,0,0\n  +units=m\n  +no_defs\n";
var extent = [2420000, 1030000, 2900000, 1350000];
var proj = Object(_utils_js__WEBPACK_IMPORTED_MODULE_1__["create"])(code, def, extent);
/* harmony default export */ __webpack_exports__["default"] = (code);

/***/ }),

/***/ "./node_modules/@geoblocks/proj/src/EPSG_21781.js":
/*!********************************************************************************************!*\
  !*** delegated ./node_modules/@geoblocks/proj/src/EPSG_21781.js from dll-reference vendor ***!
  \********************************************************************************************/
/*! exports provided: code, proj, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(989);

/***/ }),

/***/ "./node_modules/@geoblocks/proj/src/somerc.js":
/*!****************************************************************************************!*\
  !*** delegated ./node_modules/@geoblocks/proj/src/somerc.js from dll-reference vendor ***!
  \****************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(794);

/***/ }),

/***/ "./node_modules/@geoblocks/proj/src/utils.js":
/*!***************************************************************************************!*\
  !*** delegated ./node_modules/@geoblocks/proj/src/utils.js from dll-reference vendor ***!
  \***************************************************************************************/
/*! exports provided: create */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(841);

/***/ }),

/***/ "./node_modules/@sentry/browser/esm/index.js":
/*!***************************************************************************************!*\
  !*** delegated ./node_modules/@sentry/browser/esm/index.js from dll-reference vendor ***!
  \***************************************************************************************/
/*! exports provided: Severity, Status, addGlobalEventProcessor, addBreadcrumb, captureException, captureEvent, captureMessage, configureScope, getHubFromCarrier, getCurrentHub, Hub, Scope, setContext, setExtra, setExtras, setTag, setTags, setUser, Span, withScope, BrowserClient, defaultIntegrations, forceLoad, init, lastEventId, onLoad, showReportDialog, flush, close, wrap, SDK_NAME, SDK_VERSION, Integrations, Transports */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(990);

/***/ }),

/***/ "./node_modules/angular-animate/index.js":
/*!***********************************************************************************!*\
  !*** delegated ./node_modules/angular-animate/index.js from dll-reference vendor ***!
  \***********************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(994);

/***/ }),

/***/ "./node_modules/angular-dynamic-locale/src/tmhDynamicLocale.js":
/*!*********************************************************************************************************!*\
  !*** delegated ./node_modules/angular-dynamic-locale/src/tmhDynamicLocale.js from dll-reference vendor ***!
  \*********************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(996);

/***/ }),

/***/ "./node_modules/angular-float-thead/angular-floatThead.js":
/*!****************************************************************!*\
  !*** ./node_modules/angular-float-thead/angular-floatThead.js ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {/**
 * floatThead wrapper for AngularJS
 * @version v0.1.0 - 2015-10-25
 * @link https://github.com/brandon-barker/angular-floatThead
 * @author Brandon Barker
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
(function () {
  'use strict';

  angular.module('floatThead', []).directive('floatThead', ['$timeout', '$log', floatThead]);

  function floatThead($timeout, $log) {
    var directive = {
      require: '?ngModel',
      scope: {
        floatThead: '=?',
        floatTheadEnabled: '=?'
      },
      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {
        if (!$attrs.hasOwnProperty('floatTheadEnabled')) {
          $scope.floatTheadEnabled = $attrs.floatTheadEnabled = true;
        }

        if (!$attrs.hasOwnProperty('floatThead') || $attrs.floatThead === '') {
          $scope.floatThead = $attrs.floatThead = {};
        }
      }],
      link: link,
      restrict: 'A'
    };
    return directive;

    function link($scope, $element, $attrs, ngModel) {
      $scope.$watch('floatTheadEnabled', function (newVal) {
        if (newVal === true) {
          if (angular.isObject($scope.floatThead)) {
            jQuery($element).floatThead($scope.floatThead);
          }
        } else {
          jQuery($element).floatThead('destroy');
        }
      });
      $scope.$watch('floatThead', function (newVal, oldVal) {
        if (newVal === oldVal || !$scope.floatTheadEnabled) {
          return;
        }

        jQuery($element).floatThead('destroy');

        if (angular.isObject(newVal)) {
          jQuery($element).floatThead(newVal);
        }
      }, true);

      if (ngModel) {
        ngModel.$formatters.push(function () {
          if ($scope.floatTheadEnabled && angular.isObject($scope.floatThead)) {
            $timeout(function () {
              jQuery($element).floatThead('reflow');
            });
          }
        });
      } else {
        $log.info('floatThead: ngModel not provided!');
      }

      $element.bind('update', function () {
        $timeout(function () {
          jQuery($element).floatThead('reflow');
        }, 0);
      });
      $element.bind('$destroy', function () {
        jQuery($element).floatThead('destroy');
      });
    }
  }
})();
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./node_modules/angular-gettext/index.js":
/*!***********************************************************************************!*\
  !*** delegated ./node_modules/angular-gettext/index.js from dll-reference vendor ***!
  \***********************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(997);

/***/ }),

/***/ "./node_modules/angular-sanitize/index.js":
/*!************************************************************************************!*\
  !*** delegated ./node_modules/angular-sanitize/index.js from dll-reference vendor ***!
  \************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(999);

/***/ }),

/***/ "./node_modules/angular-touch/index.js":
/*!*********************************************************************************!*\
  !*** delegated ./node_modules/angular-touch/index.js from dll-reference vendor ***!
  \*********************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1001);

/***/ }),

/***/ "./node_modules/angular-ui-date/dist/date.js":
/*!***************************************************************************************!*\
  !*** delegated ./node_modules/angular-ui-date/dist/date.js from dll-reference vendor ***!
  \***************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1003);

/***/ }),

/***/ "./node_modules/angular-ui-slider/src/index.js":
/*!*****************************************************************************************!*\
  !*** delegated ./node_modules/angular-ui-slider/src/index.js from dll-reference vendor ***!
  \*****************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1004);

/***/ }),

/***/ "./node_modules/angular/index.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/angular/index.js from dll-reference vendor ***!
  \***************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(621);

/***/ }),

/***/ "./node_modules/babel-loader/lib/index.js?!./node_modules/corejs-typeahead/dist/typeahead.bundle.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib??ref--10!./node_modules/corejs-typeahead/dist/typeahead.bundle.js ***!
  \*********************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(setImmediate) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (root, factory) {
  if (true) {
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")], __WEBPACK_AMD_DEFINE_RESULT__ = (function (a0) {
      return root["Bloodhound"] = factory(a0);
    }).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else {}
})(this, function ($) {
  var _ = function () {
    "use strict";

    return {
      isMsie: function isMsie() {
        return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2] : false;
      },
      isBlankString: function isBlankString(str) {
        return !str || /^\s*$/.test(str);
      },
      escapeRegExChars: function escapeRegExChars(str) {
        return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
      },
      isString: function isString(obj) {
        return typeof obj === "string";
      },
      isNumber: function isNumber(obj) {
        return typeof obj === "number";
      },
      isArray: $.isArray,
      isFunction: $.isFunction,
      isObject: $.isPlainObject,
      isUndefined: function isUndefined(obj) {
        return typeof obj === "undefined";
      },
      isElement: function isElement(obj) {
        return !!(obj && obj.nodeType === 1);
      },
      isJQuery: function isJQuery(obj) {
        return obj instanceof $;
      },
      toStr: function toStr(s) {
        return _.isUndefined(s) || s === null ? "" : s + "";
      },
      bind: $.proxy,
      each: function each(collection, cb) {
        $.each(collection, reverseArgs);

        function reverseArgs(index, value) {
          return cb(value, index);
        }
      },
      map: $.map,
      filter: $.grep,
      every: function every(obj, test) {
        var result = true;

        if (!obj) {
          return result;
        }

        $.each(obj, function (key, val) {
          if (!(result = test.call(null, val, key, obj))) {
            return false;
          }
        });
        return !!result;
      },
      some: function some(obj, test) {
        var result = false;

        if (!obj) {
          return result;
        }

        $.each(obj, function (key, val) {
          if (result = test.call(null, val, key, obj)) {
            return false;
          }
        });
        return !!result;
      },
      mixin: $.extend,
      identity: function identity(x) {
        return x;
      },
      clone: function clone(obj) {
        return $.extend(true, {}, obj);
      },
      getIdGenerator: function getIdGenerator() {
        var counter = 0;
        return function () {
          return counter++;
        };
      },
      templatify: function templatify(obj) {
        return $.isFunction(obj) ? obj : template;

        function template() {
          return String(obj);
        }
      },
      defer: function defer(fn) {
        setTimeout(fn, 0);
      },
      debounce: function debounce(func, wait, immediate) {
        var timeout, result;
        return function () {
          var context = this,
              args = arguments,
              later,
              callNow;

          later = function later() {
            timeout = null;

            if (!immediate) {
              result = func.apply(context, args);
            }
          };

          callNow = immediate && !timeout;
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);

          if (callNow) {
            result = func.apply(context, args);
          }

          return result;
        };
      },
      throttle: function throttle(func, wait) {
        var context, args, timeout, result, previous, later;
        previous = 0;

        later = function later() {
          previous = new Date();
          timeout = null;
          result = func.apply(context, args);
        };

        return function () {
          var now = new Date(),
              remaining = wait - (now - previous);
          context = this;
          args = arguments;

          if (remaining <= 0) {
            clearTimeout(timeout);
            timeout = null;
            previous = now;
            result = func.apply(context, args);
          } else if (!timeout) {
            timeout = setTimeout(later, remaining);
          }

          return result;
        };
      },
      stringify: function stringify(val) {
        return _.isString(val) ? val : JSON.stringify(val);
      },
      guid: function guid() {
        function _p8(s) {
          var p = (Math.random().toString(16) + "000000000").substr(2, 8);
          return s ? "-" + p.substr(0, 4) + "-" + p.substr(4, 4) : p;
        }

        return "tt-" + _p8() + _p8(true) + _p8(true) + _p8();
      },
      noop: function noop() {}
    };
  }();

  var VERSION = "1.3.0";

  var tokenizers = function () {
    "use strict";

    return {
      nonword: nonword,
      whitespace: whitespace,
      ngram: ngram,
      obj: {
        nonword: getObjTokenizer(nonword),
        whitespace: getObjTokenizer(whitespace),
        ngram: getObjTokenizer(ngram)
      }
    };

    function whitespace(str) {
      str = _.toStr(str);
      return str ? str.split(/\s+/) : [];
    }

    function nonword(str) {
      str = _.toStr(str);
      return str ? str.split(/\W+/) : [];
    }

    function ngram(str) {
      str = _.toStr(str);
      var tokens = [],
          word = "";

      _.each(str.split(""), function (char) {
        if (char.match(/\s+/)) {
          word = "";
        } else {
          tokens.push(word + char);
          word += char;
        }
      });

      return tokens;
    }

    function getObjTokenizer(tokenizer) {
      return function setKey(keys) {
        keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);
        return function tokenize(o) {
          var tokens = [];

          _.each(keys, function (k) {
            tokens = tokens.concat(tokenizer(_.toStr(o[k])));
          });

          return tokens;
        };
      };
    }
  }();

  var LruCache = function () {
    "use strict";

    function LruCache(maxSize) {
      this.maxSize = _.isNumber(maxSize) ? maxSize : 100;
      this.reset();

      if (this.maxSize <= 0) {
        this.set = this.get = $.noop;
      }
    }

    _.mixin(LruCache.prototype, {
      set: function set(key, val) {
        var tailItem = this.list.tail,
            node;

        if (this.size >= this.maxSize) {
          this.list.remove(tailItem);
          delete this.hash[tailItem.key];
          this.size--;
        }

        if (node = this.hash[key]) {
          node.val = val;
          this.list.moveToFront(node);
        } else {
          node = new Node(key, val);
          this.list.add(node);
          this.hash[key] = node;
          this.size++;
        }
      },
      get: function get(key) {
        var node = this.hash[key];

        if (node) {
          this.list.moveToFront(node);
          return node.val;
        }
      },
      reset: function reset() {
        this.size = 0;
        this.hash = {};
        this.list = new List();
      }
    });

    function List() {
      this.head = this.tail = null;
    }

    _.mixin(List.prototype, {
      add: function add(node) {
        if (this.head) {
          node.next = this.head;
          this.head.prev = node;
        }

        this.head = node;
        this.tail = this.tail || node;
      },
      remove: function remove(node) {
        node.prev ? node.prev.next = node.next : this.head = node.next;
        node.next ? node.next.prev = node.prev : this.tail = node.prev;
      },
      moveToFront: function moveToFront(node) {
        this.remove(node);
        this.add(node);
      }
    });

    function Node(key, val) {
      this.key = key;
      this.val = val;
      this.prev = this.next = null;
    }

    return LruCache;
  }();

  var PersistentStorage = function () {
    "use strict";

    var LOCAL_STORAGE;

    try {
      LOCAL_STORAGE = window.localStorage;
      LOCAL_STORAGE.setItem("~~~", "!");
      LOCAL_STORAGE.removeItem("~~~");
    } catch (err) {
      LOCAL_STORAGE = null;
    }

    function PersistentStorage(namespace, override) {
      this.prefix = ["__", namespace, "__"].join("");
      this.ttlKey = "__ttl__";
      this.keyMatcher = new RegExp("^" + _.escapeRegExChars(this.prefix));
      this.ls = override || LOCAL_STORAGE;
      !this.ls && this._noop();
    }

    _.mixin(PersistentStorage.prototype, {
      _prefix: function _prefix(key) {
        return this.prefix + key;
      },
      _ttlKey: function _ttlKey(key) {
        return this._prefix(key) + this.ttlKey;
      },
      _noop: function _noop() {
        this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;
      },
      _safeSet: function _safeSet(key, val) {
        try {
          this.ls.setItem(key, val);
        } catch (err) {
          if (err.name === "QuotaExceededError") {
            this.clear();

            this._noop();
          }
        }
      },
      get: function get(key) {
        if (this.isExpired(key)) {
          this.remove(key);
        }

        return decode(this.ls.getItem(this._prefix(key)));
      },
      set: function set(key, val, ttl) {
        if (_.isNumber(ttl)) {
          this._safeSet(this._ttlKey(key), encode(now() + ttl));
        } else {
          this.ls.removeItem(this._ttlKey(key));
        }

        return this._safeSet(this._prefix(key), encode(val));
      },
      remove: function remove(key) {
        this.ls.removeItem(this._ttlKey(key));
        this.ls.removeItem(this._prefix(key));
        return this;
      },
      clear: function clear() {
        var i,
            keys = gatherMatchingKeys(this.keyMatcher);

        for (i = keys.length; i--;) {
          this.remove(keys[i]);
        }

        return this;
      },
      isExpired: function isExpired(key) {
        var ttl = decode(this.ls.getItem(this._ttlKey(key)));
        return _.isNumber(ttl) && now() > ttl ? true : false;
      }
    });

    return PersistentStorage;

    function now() {
      return new Date().getTime();
    }

    function encode(val) {
      return JSON.stringify(_.isUndefined(val) ? null : val);
    }

    function decode(val) {
      return $.parseJSON(val);
    }

    function gatherMatchingKeys(keyMatcher) {
      var i,
          key,
          keys = [],
          len = LOCAL_STORAGE.length;

      for (i = 0; i < len; i++) {
        if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {
          keys.push(key.replace(keyMatcher, ""));
        }
      }

      return keys;
    }
  }();

  var Transport = function () {
    "use strict";

    var pendingRequestsCount = 0,
        pendingRequests = {},
        sharedCache = new LruCache(10);

    function Transport(o) {
      o = o || {};
      this.maxPendingRequests = o.maxPendingRequests || 6;
      this.cancelled = false;
      this.lastReq = null;
      this._send = o.transport;
      this._get = o.limiter ? o.limiter(this._get) : this._get;
      this._cache = o.cache === false ? new LruCache(0) : sharedCache;
    }

    Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {
      this.maxPendingRequests = num;
    };

    Transport.resetCache = function resetCache() {
      sharedCache.reset();
    };

    _.mixin(Transport.prototype, {
      _fingerprint: function fingerprint(o) {
        o = o || {};
        return o.url + o.type + $.param(o.data || {});
      },
      _get: function _get(o, cb) {
        var that = this,
            fingerprint,
            jqXhr;
        fingerprint = this._fingerprint(o);

        if (this.cancelled || fingerprint !== this.lastReq) {
          return;
        }

        if (jqXhr = pendingRequests[fingerprint]) {
          jqXhr.done(done).fail(fail);
        } else if (pendingRequestsCount < this.maxPendingRequests) {
          pendingRequestsCount++;
          pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);
        } else {
          this.onDeckRequestArgs = [].slice.call(arguments, 0);
        }

        function done(resp) {
          cb(null, resp);

          that._cache.set(fingerprint, resp);
        }

        function fail() {
          cb(true);
        }

        function always() {
          pendingRequestsCount--;
          delete pendingRequests[fingerprint];

          if (that.onDeckRequestArgs) {
            that._get.apply(that, that.onDeckRequestArgs);

            that.onDeckRequestArgs = null;
          }
        }
      },
      get: function get(o, cb) {
        var resp, fingerprint;
        cb = cb || $.noop;
        o = _.isString(o) ? {
          url: o
        } : o || {};
        fingerprint = this._fingerprint(o);
        this.cancelled = false;
        this.lastReq = fingerprint;

        if (resp = this._cache.get(fingerprint)) {
          cb(null, resp);
        } else {
          this._get(o, cb);
        }
      },
      cancel: function cancel() {
        this.cancelled = true;
      }
    });

    return Transport;
  }();

  var SearchIndex = window.SearchIndex = function () {
    "use strict";

    var CHILDREN = "c",
        IDS = "i";

    function SearchIndex(o) {
      o = o || {};

      if (!o.datumTokenizer || !o.queryTokenizer) {
        $.error("datumTokenizer and queryTokenizer are both required");
      }

      this.identify = o.identify || _.stringify;
      this.datumTokenizer = o.datumTokenizer;
      this.queryTokenizer = o.queryTokenizer;
      this.matchAnyQueryToken = o.matchAnyQueryToken;
      this.reset();
    }

    _.mixin(SearchIndex.prototype, {
      bootstrap: function bootstrap(o) {
        this.datums = o.datums;
        this.trie = o.trie;
      },
      add: function add(data) {
        var that = this;
        data = _.isArray(data) ? data : [data];

        _.each(data, function (datum) {
          var id, tokens;
          that.datums[id = that.identify(datum)] = datum;
          tokens = normalizeTokens(that.datumTokenizer(datum));

          _.each(tokens, function (token) {
            var node, chars, ch;
            node = that.trie;
            chars = token.split("");

            while (ch = chars.shift()) {
              node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());
              node[IDS].push(id);
            }
          });
        });
      },
      get: function get(ids) {
        var that = this;
        return _.map(ids, function (id) {
          return that.datums[id];
        });
      },
      search: function search(query) {
        var that = this,
            tokens,
            matches;
        tokens = normalizeTokens(this.queryTokenizer(query));

        _.each(tokens, function (token) {
          var node, chars, ch, ids;

          if (matches && matches.length === 0 && !that.matchAnyQueryToken) {
            return false;
          }

          node = that.trie;
          chars = token.split("");

          while (node && (ch = chars.shift())) {
            node = node[CHILDREN][ch];
          }

          if (node && chars.length === 0) {
            ids = node[IDS].slice(0);
            matches = matches ? getIntersection(matches, ids) : ids;
          } else {
            if (!that.matchAnyQueryToken) {
              matches = [];
              return false;
            }
          }
        });

        return matches ? _.map(unique(matches), function (id) {
          return that.datums[id];
        }) : [];
      },
      all: function all() {
        var values = [];

        for (var key in this.datums) {
          values.push(this.datums[key]);
        }

        return values;
      },
      reset: function reset() {
        this.datums = {};
        this.trie = newNode();
      },
      serialize: function serialize() {
        return {
          datums: this.datums,
          trie: this.trie
        };
      }
    });

    return SearchIndex;

    function normalizeTokens(tokens) {
      tokens = _.filter(tokens, function (token) {
        return !!token;
      });
      tokens = _.map(tokens, function (token) {
        return token.toLowerCase();
      });
      return tokens;
    }

    function newNode() {
      var node = {};
      node[IDS] = [];
      node[CHILDREN] = {};
      return node;
    }

    function unique(array) {
      var seen = {},
          uniques = [];

      for (var i = 0, len = array.length; i < len; i++) {
        if (!seen[array[i]]) {
          seen[array[i]] = true;
          uniques.push(array[i]);
        }
      }

      return uniques;
    }

    function getIntersection(arrayA, arrayB) {
      var ai = 0,
          bi = 0,
          intersection = [];
      arrayA = arrayA.sort();
      arrayB = arrayB.sort();
      var lenArrayA = arrayA.length,
          lenArrayB = arrayB.length;

      while (ai < lenArrayA && bi < lenArrayB) {
        if (arrayA[ai] < arrayB[bi]) {
          ai++;
        } else if (arrayA[ai] > arrayB[bi]) {
          bi++;
        } else {
          intersection.push(arrayA[ai]);
          ai++;
          bi++;
        }
      }

      return intersection;
    }
  }();

  var Prefetch = function () {
    "use strict";

    var keys;
    keys = {
      data: "data",
      protocol: "protocol",
      thumbprint: "thumbprint"
    };

    function Prefetch(o) {
      this.url = o.url;
      this.ttl = o.ttl;
      this.cache = o.cache;
      this.prepare = o.prepare;
      this.transform = o.transform;
      this.transport = o.transport;
      this.thumbprint = o.thumbprint;
      this.storage = new PersistentStorage(o.cacheKey);
    }

    _.mixin(Prefetch.prototype, {
      _settings: function settings() {
        return {
          url: this.url,
          type: "GET",
          dataType: "json"
        };
      },
      store: function store(data) {
        if (!this.cache) {
          return;
        }

        this.storage.set(keys.data, data, this.ttl);
        this.storage.set(keys.protocol, location.protocol, this.ttl);
        this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);
      },
      fromCache: function fromCache() {
        var stored = {},
            isExpired;

        if (!this.cache) {
          return null;
        }

        stored.data = this.storage.get(keys.data);
        stored.protocol = this.storage.get(keys.protocol);
        stored.thumbprint = this.storage.get(keys.thumbprint);
        isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;
        return stored.data && !isExpired ? stored.data : null;
      },
      fromNetwork: function fromNetwork(cb) {
        var that = this,
            settings;

        if (!cb) {
          return;
        }

        settings = this.prepare(this._settings());
        this.transport(settings).fail(onError).done(onResponse);

        function onError() {
          cb(true);
        }

        function onResponse(resp) {
          cb(null, that.transform(resp));
        }
      },
      clear: function clear() {
        this.storage.clear();
        return this;
      }
    });

    return Prefetch;
  }();

  var Remote = function () {
    "use strict";

    function Remote(o) {
      this.url = o.url;
      this.prepare = o.prepare;
      this.transform = o.transform;
      this.indexResponse = o.indexResponse;
      this.transport = new Transport({
        cache: o.cache,
        limiter: o.limiter,
        transport: o.transport,
        maxPendingRequests: o.maxPendingRequests
      });
    }

    _.mixin(Remote.prototype, {
      _settings: function settings() {
        return {
          url: this.url,
          type: "GET",
          dataType: "json"
        };
      },
      get: function get(query, cb) {
        var that = this,
            settings;

        if (!cb) {
          return;
        }

        query = query || "";
        settings = this.prepare(query, this._settings());
        return this.transport.get(settings, onResponse);

        function onResponse(err, resp) {
          err ? cb([]) : cb(that.transform(resp));
        }
      },
      cancelLastRequest: function cancelLastRequest() {
        this.transport.cancel();
      }
    });

    return Remote;
  }();

  var oParser = function () {
    "use strict";

    return function parse(o) {
      var defaults, sorter;
      defaults = {
        initialize: true,
        identify: _.stringify,
        datumTokenizer: null,
        queryTokenizer: null,
        matchAnyQueryToken: false,
        sufficient: 5,
        indexRemote: false,
        sorter: null,
        local: [],
        prefetch: null,
        remote: null
      };
      o = _.mixin(defaults, o || {});
      !o.datumTokenizer && $.error("datumTokenizer is required");
      !o.queryTokenizer && $.error("queryTokenizer is required");
      sorter = o.sorter;
      o.sorter = sorter ? function (x) {
        return x.sort(sorter);
      } : _.identity;
      o.local = _.isFunction(o.local) ? o.local() : o.local;
      o.prefetch = parsePrefetch(o.prefetch);
      o.remote = parseRemote(o.remote);
      return o;
    };

    function parsePrefetch(o) {
      var defaults;

      if (!o) {
        return null;
      }

      defaults = {
        url: null,
        ttl: 24 * 60 * 60 * 1e3,
        cache: true,
        cacheKey: null,
        thumbprint: "",
        prepare: _.identity,
        transform: _.identity,
        transport: null
      };
      o = _.isString(o) ? {
        url: o
      } : o;
      o = _.mixin(defaults, o);
      !o.url && $.error("prefetch requires url to be set");
      o.transform = o.filter || o.transform;
      o.cacheKey = o.cacheKey || o.url;
      o.thumbprint = VERSION + o.thumbprint;
      o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;
      return o;
    }

    function parseRemote(o) {
      var defaults;

      if (!o) {
        return;
      }

      defaults = {
        url: null,
        cache: true,
        prepare: null,
        replace: null,
        wildcard: null,
        limiter: null,
        rateLimitBy: "debounce",
        rateLimitWait: 300,
        transform: _.identity,
        transport: null
      };
      o = _.isString(o) ? {
        url: o
      } : o;
      o = _.mixin(defaults, o);
      !o.url && $.error("remote requires url to be set");
      o.transform = o.filter || o.transform;
      o.prepare = toRemotePrepare(o);
      o.limiter = toLimiter(o);
      o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;
      delete o.replace;
      delete o.wildcard;
      delete o.rateLimitBy;
      delete o.rateLimitWait;
      return o;
    }

    function toRemotePrepare(o) {
      var prepare, replace, wildcard;
      prepare = o.prepare;
      replace = o.replace;
      wildcard = o.wildcard;

      if (prepare) {
        return prepare;
      }

      if (replace) {
        prepare = prepareByReplace;
      } else if (o.wildcard) {
        prepare = prepareByWildcard;
      } else {
        prepare = identityPrepare;
      }

      return prepare;

      function prepareByReplace(query, settings) {
        settings.url = replace(settings.url, query);
        return settings;
      }

      function prepareByWildcard(query, settings) {
        settings.url = settings.url.replace(wildcard, encodeURIComponent(query));
        return settings;
      }

      function identityPrepare(query, settings) {
        return settings;
      }
    }

    function toLimiter(o) {
      var limiter, method, wait;
      limiter = o.limiter;
      method = o.rateLimitBy;
      wait = o.rateLimitWait;

      if (!limiter) {
        limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);
      }

      return limiter;

      function debounce(wait) {
        return function debounce(fn) {
          return _.debounce(fn, wait);
        };
      }

      function throttle(wait) {
        return function throttle(fn) {
          return _.throttle(fn, wait);
        };
      }
    }

    function callbackToDeferred(fn) {
      return function wrapper(o) {
        var deferred = $.Deferred();
        fn(o, onSuccess, onError);
        return deferred;

        function onSuccess(resp) {
          _.defer(function () {
            deferred.resolve(resp);
          });
        }

        function onError(err) {
          _.defer(function () {
            deferred.reject(err);
          });
        }
      };
    }
  }();

  var Bloodhound = function () {
    "use strict";

    var old;
    old = window && window.Bloodhound;

    function Bloodhound(o) {
      o = oParser(o);
      this.sorter = o.sorter;
      this.identify = o.identify;
      this.sufficient = o.sufficient;
      this.indexRemote = o.indexRemote;
      this.local = o.local;
      this.remote = o.remote ? new Remote(o.remote) : null;
      this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;
      this.index = new SearchIndex({
        identify: this.identify,
        datumTokenizer: o.datumTokenizer,
        queryTokenizer: o.queryTokenizer
      });
      o.initialize !== false && this.initialize();
    }

    Bloodhound.noConflict = function noConflict() {
      window && (window.Bloodhound = old);
      return Bloodhound;
    };

    Bloodhound.tokenizers = tokenizers;

    _.mixin(Bloodhound.prototype, {
      __ttAdapter: function ttAdapter() {
        var that = this;
        return this.remote ? withAsync : withoutAsync;

        function withAsync(query, sync, async) {
          return that.search(query, sync, async);
        }

        function withoutAsync(query, sync) {
          return that.search(query, sync);
        }
      },
      _loadPrefetch: function loadPrefetch() {
        var that = this,
            deferred,
            serialized;
        deferred = $.Deferred();

        if (!this.prefetch) {
          deferred.resolve();
        } else if (serialized = this.prefetch.fromCache()) {
          this.index.bootstrap(serialized);
          deferred.resolve();
        } else {
          this.prefetch.fromNetwork(done);
        }

        return deferred.promise();

        function done(err, data) {
          if (err) {
            return deferred.reject();
          }

          that.add(data);
          that.prefetch.store(that.index.serialize());
          deferred.resolve();
        }
      },
      _initialize: function initialize() {
        var that = this,
            deferred;
        this.clear();

        (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);

        return this.initPromise;

        function addLocalToIndex() {
          that.add(that.local);
        }
      },
      initialize: function initialize(force) {
        return !this.initPromise || force ? this._initialize() : this.initPromise;
      },
      add: function add(data) {
        this.index.add(data);
        return this;
      },
      get: function get(ids) {
        ids = _.isArray(ids) ? ids : [].slice.call(arguments);
        return this.index.get(ids);
      },
      search: function search(query, sync, async) {
        var that = this,
            local;
        sync = sync || _.noop;
        async = async || _.noop;
        local = this.sorter(this.index.search(query));
        sync(this.remote ? local.slice() : local);

        if (this.remote && local.length < this.sufficient) {
          this.remote.get(query, processRemote);
        } else if (this.remote) {
          this.remote.cancelLastRequest();
        }

        return this;

        function processRemote(remote) {
          var nonDuplicates = [];

          _.each(remote, function (r) {
            !_.some(local, function (l) {
              return that.identify(r) === that.identify(l);
            }) && nonDuplicates.push(r);
          });

          that.indexRemote && that.add(nonDuplicates);
          async(nonDuplicates);
        }
      },
      all: function all() {
        return this.index.all();
      },
      clear: function clear() {
        this.index.reset();
        return this;
      },
      clearPrefetchCache: function clearPrefetchCache() {
        this.prefetch && this.prefetch.clear();
        return this;
      },
      clearRemoteCache: function clearRemoteCache() {
        Transport.resetCache();
        return this;
      },
      ttAdapter: function ttAdapter() {
        return this.__ttAdapter();
      }
    });

    return Bloodhound;
  }();

  return Bloodhound;
});

(function (root, factory) {
  if (true) {
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")], __WEBPACK_AMD_DEFINE_RESULT__ = (function (a0) {
      return factory(a0);
    }).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else {}
})(this, function ($) {
  var _ = function () {
    "use strict";

    return {
      isMsie: function isMsie() {
        return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2] : false;
      },
      isBlankString: function isBlankString(str) {
        return !str || /^\s*$/.test(str);
      },
      escapeRegExChars: function escapeRegExChars(str) {
        return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
      },
      isString: function isString(obj) {
        return typeof obj === "string";
      },
      isNumber: function isNumber(obj) {
        return typeof obj === "number";
      },
      isArray: $.isArray,
      isFunction: $.isFunction,
      isObject: $.isPlainObject,
      isUndefined: function isUndefined(obj) {
        return typeof obj === "undefined";
      },
      isElement: function isElement(obj) {
        return !!(obj && obj.nodeType === 1);
      },
      isJQuery: function isJQuery(obj) {
        return obj instanceof $;
      },
      toStr: function toStr(s) {
        return _.isUndefined(s) || s === null ? "" : s + "";
      },
      bind: $.proxy,
      each: function each(collection, cb) {
        $.each(collection, reverseArgs);

        function reverseArgs(index, value) {
          return cb(value, index);
        }
      },
      map: $.map,
      filter: $.grep,
      every: function every(obj, test) {
        var result = true;

        if (!obj) {
          return result;
        }

        $.each(obj, function (key, val) {
          if (!(result = test.call(null, val, key, obj))) {
            return false;
          }
        });
        return !!result;
      },
      some: function some(obj, test) {
        var result = false;

        if (!obj) {
          return result;
        }

        $.each(obj, function (key, val) {
          if (result = test.call(null, val, key, obj)) {
            return false;
          }
        });
        return !!result;
      },
      mixin: $.extend,
      identity: function identity(x) {
        return x;
      },
      clone: function clone(obj) {
        return $.extend(true, {}, obj);
      },
      getIdGenerator: function getIdGenerator() {
        var counter = 0;
        return function () {
          return counter++;
        };
      },
      templatify: function templatify(obj) {
        return $.isFunction(obj) ? obj : template;

        function template() {
          return String(obj);
        }
      },
      defer: function defer(fn) {
        setTimeout(fn, 0);
      },
      debounce: function debounce(func, wait, immediate) {
        var timeout, result;
        return function () {
          var context = this,
              args = arguments,
              later,
              callNow;

          later = function later() {
            timeout = null;

            if (!immediate) {
              result = func.apply(context, args);
            }
          };

          callNow = immediate && !timeout;
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);

          if (callNow) {
            result = func.apply(context, args);
          }

          return result;
        };
      },
      throttle: function throttle(func, wait) {
        var context, args, timeout, result, previous, later;
        previous = 0;

        later = function later() {
          previous = new Date();
          timeout = null;
          result = func.apply(context, args);
        };

        return function () {
          var now = new Date(),
              remaining = wait - (now - previous);
          context = this;
          args = arguments;

          if (remaining <= 0) {
            clearTimeout(timeout);
            timeout = null;
            previous = now;
            result = func.apply(context, args);
          } else if (!timeout) {
            timeout = setTimeout(later, remaining);
          }

          return result;
        };
      },
      stringify: function stringify(val) {
        return _.isString(val) ? val : JSON.stringify(val);
      },
      guid: function guid() {
        function _p8(s) {
          var p = (Math.random().toString(16) + "000000000").substr(2, 8);
          return s ? "-" + p.substr(0, 4) + "-" + p.substr(4, 4) : p;
        }

        return "tt-" + _p8() + _p8(true) + _p8(true) + _p8();
      },
      noop: function noop() {}
    };
  }();

  var WWW = function () {
    "use strict";

    var defaultClassNames = {
      wrapper: "twitter-typeahead",
      input: "tt-input",
      hint: "tt-hint",
      menu: "tt-menu",
      dataset: "tt-dataset",
      suggestion: "tt-suggestion",
      selectable: "tt-selectable",
      empty: "tt-empty",
      open: "tt-open",
      cursor: "tt-cursor",
      highlight: "tt-highlight"
    };
    return build;

    function build(o) {
      var www, classes;
      classes = _.mixin({}, defaultClassNames, o);
      www = {
        css: buildCss(),
        classes: classes,
        html: buildHtml(classes),
        selectors: buildSelectors(classes)
      };
      return {
        css: www.css,
        html: www.html,
        classes: www.classes,
        selectors: www.selectors,
        mixin: function mixin(o) {
          _.mixin(o, www);
        }
      };
    }

    function buildHtml(c) {
      return {
        wrapper: '<span class="' + c.wrapper + '"></span>',
        menu: '<div role="listbox" class="' + c.menu + '"></div>'
      };
    }

    function buildSelectors(classes) {
      var selectors = {};

      _.each(classes, function (v, k) {
        selectors[k] = "." + v;
      });

      return selectors;
    }

    function buildCss() {
      var css = {
        wrapper: {
          position: "relative",
          display: "inline-block"
        },
        hint: {
          position: "absolute",
          top: "0",
          left: "0",
          borderColor: "transparent",
          boxShadow: "none",
          opacity: "1"
        },
        input: {
          position: "relative",
          verticalAlign: "top",
          backgroundColor: "transparent"
        },
        inputWithNoHint: {
          position: "relative",
          verticalAlign: "top"
        },
        menu: {
          position: "absolute",
          top: "100%",
          left: "0",
          zIndex: "100",
          display: "none"
        },
        ltr: {
          left: "0",
          right: "auto"
        },
        rtl: {
          left: "auto",
          right: " 0"
        }
      };

      if (_.isMsie()) {
        _.mixin(css.input, {
          backgroundImage: "url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"
        });
      }

      return css;
    }
  }();

  var EventBus = function () {
    "use strict";

    var namespace, deprecationMap;
    namespace = "typeahead:";
    deprecationMap = {
      render: "rendered",
      cursorchange: "cursorchanged",
      select: "selected",
      autocomplete: "autocompleted"
    };

    function EventBus(o) {
      if (!o || !o.el) {
        $.error("EventBus initialized without el");
      }

      this.$el = $(o.el);
    }

    _.mixin(EventBus.prototype, {
      _trigger: function _trigger(type, args) {
        var $e = $.Event(namespace + type);
        this.$el.trigger.call(this.$el, $e, args || []);
        return $e;
      },
      before: function before(type) {
        var args, $e;
        args = [].slice.call(arguments, 1);
        $e = this._trigger("before" + type, args);
        return $e.isDefaultPrevented();
      },
      trigger: function trigger(type) {
        var deprecatedType;

        this._trigger(type, [].slice.call(arguments, 1));

        if (deprecatedType = deprecationMap[type]) {
          this._trigger(deprecatedType, [].slice.call(arguments, 1));
        }
      }
    });

    return EventBus;
  }();

  var EventEmitter = function () {
    "use strict";

    var splitter = /\s+/,
        nextTick = getNextTick();
    return {
      onSync: onSync,
      onAsync: onAsync,
      off: off,
      trigger: trigger
    };

    function on(method, types, cb, context) {
      var type;

      if (!cb) {
        return this;
      }

      types = types.split(splitter);
      cb = context ? bindContext(cb, context) : cb;
      this._callbacks = this._callbacks || {};

      while (type = types.shift()) {
        this._callbacks[type] = this._callbacks[type] || {
          sync: [],
          async: []
        };

        this._callbacks[type][method].push(cb);
      }

      return this;
    }

    function onAsync(types, cb, context) {
      return on.call(this, "async", types, cb, context);
    }

    function onSync(types, cb, context) {
      return on.call(this, "sync", types, cb, context);
    }

    function off(types) {
      var type;

      if (!this._callbacks) {
        return this;
      }

      types = types.split(splitter);

      while (type = types.shift()) {
        delete this._callbacks[type];
      }

      return this;
    }

    function trigger(types) {
      var type, callbacks, args, syncFlush, asyncFlush;

      if (!this._callbacks) {
        return this;
      }

      types = types.split(splitter);
      args = [].slice.call(arguments, 1);

      while ((type = types.shift()) && (callbacks = this._callbacks[type])) {
        syncFlush = getFlush(callbacks.sync, this, [type].concat(args));
        asyncFlush = getFlush(callbacks.async, this, [type].concat(args));
        syncFlush() && nextTick(asyncFlush);
      }

      return this;
    }

    function getFlush(callbacks, context, args) {
      return flush;

      function flush() {
        var cancelled;

        for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {
          cancelled = callbacks[i].apply(context, args) === false;
        }

        return !cancelled;
      }
    }

    function getNextTick() {
      var nextTickFn;

      if (window.setImmediate) {
        nextTickFn = function nextTickSetImmediate(fn) {
          setImmediate(function () {
            fn();
          });
        };
      } else {
        nextTickFn = function nextTickSetTimeout(fn) {
          setTimeout(function () {
            fn();
          }, 0);
        };
      }

      return nextTickFn;
    }

    function bindContext(fn, context) {
      return fn.bind ? fn.bind(context) : function () {
        fn.apply(context, [].slice.call(arguments, 0));
      };
    }
  }();

  var highlight = function (doc) {
    "use strict";

    var defaults = {
      node: null,
      pattern: null,
      tagName: "strong",
      className: null,
      wordsOnly: false,
      caseSensitive: false,
      diacriticInsensitive: false
    };
    var accented = {
      A: "[AaªÀ-Åà-åĀ-ąǍǎȀ-ȃȦȧᴬᵃḀḁẚẠ-ảₐ℀℁℻⒜Ⓐⓐ㍱-㍴㎀-㎄㎈㎉㎩-㎯㏂㏊㏟㏿Ａａ]",
      B: "[BbᴮᵇḂ-ḇℬ⒝Ⓑⓑ㍴㎅-㎇㏃㏈㏔㏝Ｂｂ]",
      C: "[CcÇçĆ-čᶜ℀ℂ℃℅℆ℭⅭⅽ⒞Ⓒⓒ㍶㎈㎉㎝㎠㎤㏄-㏇Ｃｃ]",
      D: "[DdĎďǄ-ǆǱ-ǳᴰᵈḊ-ḓⅅⅆⅮⅾ⒟Ⓓⓓ㋏㍲㍷-㍹㎗㎭-㎯㏅㏈Ｄｄ]",
      E: "[EeÈ-Ëè-ëĒ-ěȄ-ȇȨȩᴱᵉḘ-ḛẸ-ẽₑ℡ℯℰⅇ⒠Ⓔⓔ㉐㋍㋎Ｅｅ]",
      F: "[FfᶠḞḟ℉ℱ℻⒡Ⓕⓕ㎊-㎌㎙ﬀ-ﬄＦｆ]",
      G: "[GgĜ-ģǦǧǴǵᴳᵍḠḡℊ⒢Ⓖⓖ㋌㋍㎇㎍-㎏㎓㎬㏆㏉㏒㏿Ｇｇ]",
      H: "[HhĤĥȞȟʰᴴḢ-ḫẖℋ-ℎ⒣Ⓗⓗ㋌㍱㎐-㎔㏊㏋㏗Ｈｈ]",
      I: "[IiÌ-Ïì-ïĨ-İĲĳǏǐȈ-ȋᴵᵢḬḭỈ-ịⁱℐℑℹⅈⅠ-ⅣⅥ-ⅨⅪⅫⅰ-ⅳⅵ-ⅸⅺⅻ⒤Ⓘⓘ㍺㏌㏕ﬁﬃＩｉ]",
      J: "[JjĲ-ĵǇ-ǌǰʲᴶⅉ⒥ⒿⓙⱼＪｊ]",
      K: "[KkĶķǨǩᴷᵏḰ-ḵK⒦Ⓚⓚ㎄㎅㎉㎏㎑㎘㎞㎢㎦㎪㎸㎾㏀㏆㏍-㏏Ｋｋ]",
      L: "[LlĹ-ŀǇ-ǉˡᴸḶḷḺ-ḽℒℓ℡Ⅼⅼ⒧Ⓛⓛ㋏㎈㎉㏐-㏓㏕㏖㏿ﬂﬄＬｌ]",
      M: "[MmᴹᵐḾ-ṃ℠™ℳⅯⅿ⒨Ⓜⓜ㍷-㍹㎃㎆㎎㎒㎖㎙-㎨㎫㎳㎷㎹㎽㎿㏁㏂㏎㏐㏔-㏖㏘㏙㏞㏟Ｍｍ]",
      N: "[NnÑñŃ-ŉǊ-ǌǸǹᴺṄ-ṋⁿℕ№⒩Ⓝⓝ㎁㎋㎚㎱㎵㎻㏌㏑Ｎｎ]",
      O: "[OoºÒ-Öò-öŌ-őƠơǑǒǪǫȌ-ȏȮȯᴼᵒỌ-ỏₒ℅№ℴ⒪Ⓞⓞ㍵㏇㏒㏖Ｏｏ]",
      P: "[PpᴾᵖṔ-ṗℙ⒫Ⓟⓟ㉐㍱㍶㎀㎊㎩-㎬㎰㎴㎺㏋㏗-㏚Ｐｐ]",
      Q: "[Qqℚ⒬Ⓠⓠ㏃Ｑｑ]",
      R: "[RrŔ-řȐ-ȓʳᴿᵣṘ-ṛṞṟ₨ℛ-ℝ⒭Ⓡⓡ㋍㍴㎭-㎯㏚㏛Ｒｒ]",
      S: "[SsŚ-šſȘșˢṠ-ṣ₨℁℠⒮Ⓢⓢ㎧㎨㎮-㎳㏛㏜ﬆＳｓ]",
      T: "[TtŢ-ťȚțᵀᵗṪ-ṱẗ℡™⒯Ⓣⓣ㉐㋏㎔㏏ﬅﬆＴｔ]",
      U: "[UuÙ-Üù-üŨ-ųƯưǓǔȔ-ȗᵁᵘᵤṲ-ṷỤ-ủ℆⒰Ⓤⓤ㍳㍺Ｕｕ]",
      V: "[VvᵛᵥṼ-ṿⅣ-Ⅷⅳ-ⅷ⒱Ⓥⓥⱽ㋎㍵㎴-㎹㏜㏞Ｖｖ]",
      W: "[WwŴŵʷᵂẀ-ẉẘ⒲Ⓦⓦ㎺-㎿㏝Ｗｗ]",
      X: "[XxˣẊ-ẍₓ℻Ⅸ-Ⅻⅸ-ⅻ⒳Ⓧⓧ㏓Ｘｘ]",
      Y: "[YyÝýÿŶ-ŸȲȳʸẎẏẙỲ-ỹ⒴Ⓨⓨ㏉Ｙｙ]",
      Z: "[ZzŹ-žǱ-ǳᶻẐ-ẕℤℨ⒵Ⓩⓩ㎐-㎔Ｚｚ]"
    };
    return function hightlight(o) {
      var regex;
      o = _.mixin({}, defaults, o);

      if (!o.node || !o.pattern) {
        return;
      }

      o.pattern = _.isArray(o.pattern) ? o.pattern : [o.pattern];
      regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly, o.diacriticInsensitive);
      traverse(o.node, hightlightTextNode);

      function hightlightTextNode(textNode) {
        var match, patternNode, wrapperNode;

        if (match = regex.exec(textNode.data)) {
          wrapperNode = doc.createElement(o.tagName);
          o.className && (wrapperNode.className = o.className);
          patternNode = textNode.splitText(match.index);
          patternNode.splitText(match[0].length);
          wrapperNode.appendChild(patternNode.cloneNode(true));
          textNode.parentNode.replaceChild(wrapperNode, patternNode);
        }

        return !!match;
      }

      function traverse(el, hightlightTextNode) {
        var childNode,
            TEXT_NODE_TYPE = 3;

        for (var i = 0; i < el.childNodes.length; i++) {
          childNode = el.childNodes[i];

          if (childNode.nodeType === TEXT_NODE_TYPE) {
            i += hightlightTextNode(childNode) ? 1 : 0;
          } else {
            traverse(childNode, hightlightTextNode);
          }
        }
      }
    };

    function accent_replacer(chr) {
      return accented[chr.toUpperCase()] || chr;
    }

    function getRegex(patterns, caseSensitive, wordsOnly, diacriticInsensitive) {
      var escapedPatterns = [],
          regexStr;

      for (var i = 0, len = patterns.length; i < len; i++) {
        var escapedWord = _.escapeRegExChars(patterns[i]);

        if (diacriticInsensitive) {
          escapedWord = escapedWord.replace(/\S/g, accent_replacer);
        }

        escapedPatterns.push(escapedWord);
      }

      regexStr = wordsOnly ? "\\b(" + escapedPatterns.join("|") + ")\\b" : "(" + escapedPatterns.join("|") + ")";
      return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, "i");
    }
  }(window.document);

  var Input = function () {
    "use strict";

    var specialKeyCodeMap;
    specialKeyCodeMap = {
      9: "tab",
      27: "esc",
      37: "left",
      39: "right",
      13: "enter",
      38: "up",
      40: "down"
    };

    function Input(o, www) {
      o = o || {};

      if (!o.input) {
        $.error("input is missing");
      }

      www.mixin(this);
      this.$hint = $(o.hint);
      this.$input = $(o.input);
      this.$input.attr({
        "aria-activedescendant": "",
        "aria-owns": this.$input.attr("id") + "_listbox",
        role: "combobox",
        "aria-readonly": "true",
        "aria-autocomplete": "list"
      });
      $(www.menu).attr("id", this.$input.attr("id") + "_listbox");
      this.query = this.$input.val();
      this.queryWhenFocused = this.hasFocus() ? this.query : null;
      this.$overflowHelper = buildOverflowHelper(this.$input);

      this._checkLanguageDirection();

      if (this.$hint.length === 0) {
        this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;
      }

      this.onSync("cursorchange", this._updateDescendent);
    }

    Input.normalizeQuery = function (str) {
      return _.toStr(str).replace(/^\s*/g, "").replace(/\s{2,}/g, " ");
    };

    _.mixin(Input.prototype, EventEmitter, {
      _onBlur: function onBlur() {
        this.resetInputValue();
        this.trigger("blurred");
      },
      _onFocus: function onFocus() {
        this.queryWhenFocused = this.query;
        this.trigger("focused");
      },
      _onKeydown: function onKeydown($e) {
        var keyName = specialKeyCodeMap[$e.which || $e.keyCode];

        this._managePreventDefault(keyName, $e);

        if (keyName && this._shouldTrigger(keyName, $e)) {
          this.trigger(keyName + "Keyed", $e);
        }
      },
      _onInput: function onInput() {
        this._setQuery(this.getInputValue());

        this.clearHintIfInvalid();

        this._checkLanguageDirection();
      },
      _managePreventDefault: function managePreventDefault(keyName, $e) {
        var preventDefault;

        switch (keyName) {
          case "up":
          case "down":
            preventDefault = !withModifier($e);
            break;

          default:
            preventDefault = false;
        }

        preventDefault && $e.preventDefault();
      },
      _shouldTrigger: function shouldTrigger(keyName, $e) {
        var trigger;

        switch (keyName) {
          case "tab":
            trigger = !withModifier($e);
            break;

          default:
            trigger = true;
        }

        return trigger;
      },
      _checkLanguageDirection: function checkLanguageDirection() {
        var dir = (this.$input.css("direction") || "ltr").toLowerCase();

        if (this.dir !== dir) {
          this.dir = dir;
          this.$hint.attr("dir", dir);
          this.trigger("langDirChanged", dir);
        }
      },
      _setQuery: function setQuery(val, silent) {
        var areEquivalent, hasDifferentWhitespace;
        areEquivalent = areQueriesEquivalent(val, this.query);
        hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;
        this.query = val;

        if (!silent && !areEquivalent) {
          this.trigger("queryChanged", this.query);
        } else if (!silent && hasDifferentWhitespace) {
          this.trigger("whitespaceChanged", this.query);
        }
      },
      _updateDescendent: function updateDescendent(event, id) {
        this.$input.attr("aria-activedescendant", id);
      },
      bind: function bind() {
        var that = this,
            onBlur,
            onFocus,
            onKeydown,
            onInput;
        onBlur = _.bind(this._onBlur, this);
        onFocus = _.bind(this._onFocus, this);
        onKeydown = _.bind(this._onKeydown, this);
        onInput = _.bind(this._onInput, this);
        this.$input.on("blur.tt", onBlur).on("focus.tt", onFocus).on("keydown.tt", onKeydown);

        if (!_.isMsie() || _.isMsie() > 9) {
          this.$input.on("input.tt", onInput);
        } else {
          this.$input.on("keydown.tt keypress.tt cut.tt paste.tt", function ($e) {
            if (specialKeyCodeMap[$e.which || $e.keyCode]) {
              return;
            }

            _.defer(_.bind(that._onInput, that, $e));
          });
        }

        return this;
      },
      focus: function focus() {
        this.$input.focus();
      },
      blur: function blur() {
        this.$input.blur();
      },
      getLangDir: function getLangDir() {
        return this.dir;
      },
      getQuery: function getQuery() {
        return this.query || "";
      },
      setQuery: function setQuery(val, silent) {
        this.setInputValue(val);

        this._setQuery(val, silent);
      },
      hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {
        return this.query !== this.queryWhenFocused;
      },
      getInputValue: function getInputValue() {
        return this.$input.val();
      },
      setInputValue: function setInputValue(value) {
        this.$input.val(value);
        this.clearHintIfInvalid();

        this._checkLanguageDirection();
      },
      resetInputValue: function resetInputValue() {
        this.setInputValue(this.query);
      },
      getHint: function getHint() {
        return this.$hint.val();
      },
      setHint: function setHint(value) {
        this.$hint.val(value);
      },
      clearHint: function clearHint() {
        this.setHint("");
      },
      clearHintIfInvalid: function clearHintIfInvalid() {
        var val, hint, valIsPrefixOfHint, isValid;
        val = this.getInputValue();
        hint = this.getHint();
        valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;
        isValid = val !== "" && valIsPrefixOfHint && !this.hasOverflow();
        !isValid && this.clearHint();
      },
      hasFocus: function hasFocus() {
        return this.$input.is(":focus");
      },
      hasOverflow: function hasOverflow() {
        var constraint = this.$input.width() - 2;
        this.$overflowHelper.text(this.getInputValue());
        return this.$overflowHelper.width() >= constraint;
      },
      isCursorAtEnd: function isCursorAtEnd() {
        var valueLength, selectionStart, range;
        valueLength = this.$input.val().length;
        selectionStart = this.$input[0].selectionStart;

        if (_.isNumber(selectionStart)) {
          return selectionStart === valueLength;
        } else if (document.selection) {
          range = document.selection.createRange();
          range.moveStart("character", -valueLength);
          return valueLength === range.text.length;
        }

        return true;
      },
      destroy: function destroy() {
        this.$hint.off(".tt");
        this.$input.off(".tt");
        this.$overflowHelper.remove();
        this.$hint = this.$input = this.$overflowHelper = $("<div>");
      }
    });

    return Input;

    function buildOverflowHelper($input) {
      return $('<pre aria-hidden="true"></pre>').css({
        position: "absolute",
        visibility: "hidden",
        whiteSpace: "pre",
        fontFamily: $input.css("font-family"),
        fontSize: $input.css("font-size"),
        fontStyle: $input.css("font-style"),
        fontVariant: $input.css("font-variant"),
        fontWeight: $input.css("font-weight"),
        wordSpacing: $input.css("word-spacing"),
        letterSpacing: $input.css("letter-spacing"),
        textIndent: $input.css("text-indent"),
        textRendering: $input.css("text-rendering"),
        textTransform: $input.css("text-transform")
      }).insertAfter($input);
    }

    function areQueriesEquivalent(a, b) {
      return Input.normalizeQuery(a) === Input.normalizeQuery(b);
    }

    function withModifier($e) {
      return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;
    }
  }();

  var Dataset = function () {
    "use strict";

    var keys, nameGenerator;
    keys = {
      dataset: "tt-selectable-dataset",
      val: "tt-selectable-display",
      obj: "tt-selectable-object"
    };
    nameGenerator = _.getIdGenerator();

    function Dataset(o, www) {
      o = o || {};
      o.templates = o.templates || {};
      o.templates.notFound = o.templates.notFound || o.templates.empty;

      if (!o.source) {
        $.error("missing source");
      }

      if (!o.node) {
        $.error("missing node");
      }

      if (o.name && !isValidName(o.name)) {
        $.error("invalid dataset name: " + o.name);
      }

      www.mixin(this);
      this.highlight = !!o.highlight;
      this.name = _.toStr(o.name || nameGenerator());
      this.limit = o.limit || 5;
      this.displayFn = getDisplayFn(o.display || o.displayKey);
      this.templates = getTemplates(o.templates, this.displayFn);
      this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;
      this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;

      this._resetLastSuggestion();

      this.$el = $(o.node).attr("role", "presentation").addClass(this.classes.dataset).addClass(this.classes.dataset + "-" + this.name);
    }

    Dataset.extractData = function extractData(el) {
      var $el = $(el);

      if ($el.data(keys.obj)) {
        return {
          dataset: $el.data(keys.dataset) || "",
          val: $el.data(keys.val) || "",
          obj: $el.data(keys.obj) || null
        };
      }

      return null;
    };

    _.mixin(Dataset.prototype, EventEmitter, {
      _overwrite: function overwrite(query, suggestions) {
        suggestions = suggestions || [];

        if (suggestions.length) {
          this._renderSuggestions(query, suggestions);
        } else if (this.async && this.templates.pending) {
          this._renderPending(query);
        } else if (!this.async && this.templates.notFound) {
          this._renderNotFound(query);
        } else {
          this._empty();
        }

        this.trigger("rendered", suggestions, false, this.name);
      },
      _append: function append(query, suggestions) {
        suggestions = suggestions || [];

        if (suggestions.length && this.$lastSuggestion.length) {
          this._appendSuggestions(query, suggestions);
        } else if (suggestions.length) {
          this._renderSuggestions(query, suggestions);
        } else if (!this.$lastSuggestion.length && this.templates.notFound) {
          this._renderNotFound(query);
        }

        this.trigger("rendered", suggestions, true, this.name);
      },
      _renderSuggestions: function renderSuggestions(query, suggestions) {
        var $fragment;
        $fragment = this._getSuggestionsFragment(query, suggestions);
        this.$lastSuggestion = $fragment.children().last();
        this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));
      },
      _appendSuggestions: function appendSuggestions(query, suggestions) {
        var $fragment, $lastSuggestion;
        $fragment = this._getSuggestionsFragment(query, suggestions);
        $lastSuggestion = $fragment.children().last();
        this.$lastSuggestion.after($fragment);
        this.$lastSuggestion = $lastSuggestion;
      },
      _renderPending: function renderPending(query) {
        var template = this.templates.pending;

        this._resetLastSuggestion();

        template && this.$el.html(template({
          query: query,
          dataset: this.name
        }));
      },
      _renderNotFound: function renderNotFound(query) {
        var template = this.templates.notFound;

        this._resetLastSuggestion();

        template && this.$el.html(template({
          query: query,
          dataset: this.name
        }));
      },
      _empty: function empty() {
        this.$el.empty();

        this._resetLastSuggestion();
      },
      _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {
        var that = this,
            fragment;
        fragment = document.createDocumentFragment();

        _.each(suggestions, function getSuggestionNode(suggestion) {
          var $el, context;
          context = that._injectQuery(query, suggestion);
          $el = $(that.templates.suggestion(context)).data(keys.dataset, that.name).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + " " + that.classes.selectable);
          fragment.appendChild($el[0]);
        });

        this.highlight && highlight({
          className: this.classes.highlight,
          node: fragment,
          pattern: query
        });
        return $(fragment);
      },
      _getFooter: function getFooter(query, suggestions) {
        return this.templates.footer ? this.templates.footer({
          query: query,
          suggestions: suggestions,
          dataset: this.name
        }) : null;
      },
      _getHeader: function getHeader(query, suggestions) {
        return this.templates.header ? this.templates.header({
          query: query,
          suggestions: suggestions,
          dataset: this.name
        }) : null;
      },
      _resetLastSuggestion: function resetLastSuggestion() {
        this.$lastSuggestion = $();
      },
      _injectQuery: function injectQuery(query, obj) {
        return _.isObject(obj) ? _.mixin({
          _query: query
        }, obj) : obj;
      },
      update: function update(query) {
        var that = this,
            canceled = false,
            syncCalled = false,
            rendered = 0;
        this.cancel();

        this.cancel = function cancel() {
          canceled = true;
          that.cancel = $.noop;
          that.async && that.trigger("asyncCanceled", query, that.name);
        };

        this.source(query, sync, async);
        !syncCalled && sync([]);

        function sync(suggestions) {
          if (syncCalled) {
            return;
          }

          syncCalled = true;
          suggestions = (suggestions || []).slice(0, that.limit);
          rendered = suggestions.length;

          that._overwrite(query, suggestions);

          if (rendered < that.limit && that.async) {
            that.trigger("asyncRequested", query, that.name);
          }
        }

        function async(suggestions) {
          suggestions = suggestions || [];

          if (!canceled && rendered < that.limit) {
            that.cancel = $.noop;
            var idx = Math.abs(rendered - that.limit);
            rendered += idx;

            that._append(query, suggestions.slice(0, idx));

            that.async && that.trigger("asyncReceived", query, that.name);
          }
        }
      },
      cancel: $.noop,
      clear: function clear() {
        this._empty();

        this.cancel();
        this.trigger("cleared");
      },
      isEmpty: function isEmpty() {
        return this.$el.is(":empty");
      },
      destroy: function destroy() {
        this.$el = $("<div>");
      }
    });

    return Dataset;

    function getDisplayFn(display) {
      display = display || _.stringify;
      return _.isFunction(display) ? display : displayFn;

      function displayFn(obj) {
        return obj[display];
      }
    }

    function getTemplates(templates, displayFn) {
      return {
        notFound: templates.notFound && _.templatify(templates.notFound),
        pending: templates.pending && _.templatify(templates.pending),
        header: templates.header && _.templatify(templates.header),
        footer: templates.footer && _.templatify(templates.footer),
        suggestion: templates.suggestion ? userSuggestionTemplate : suggestionTemplate
      };

      function userSuggestionTemplate(context) {
        var template = templates.suggestion;
        return $(template(context)).attr("id", _.guid());
      }

      function suggestionTemplate(context) {
        return $('<div role="option">').attr("id", _.guid()).text(displayFn(context));
      }
    }

    function isValidName(str) {
      return /^[_a-zA-Z0-9-]+$/.test(str);
    }
  }();

  var Menu = function () {
    "use strict";

    function Menu(o, www) {
      var that = this;
      o = o || {};

      if (!o.node) {
        $.error("node is required");
      }

      www.mixin(this);
      this.$node = $(o.node);
      this.query = null;
      this.datasets = _.map(o.datasets, initializeDataset);

      function initializeDataset(oDataset) {
        var node = that.$node.find(oDataset.node).first();
        oDataset.node = node.length ? node : $("<div>").appendTo(that.$node);
        return new Dataset(oDataset, www);
      }
    }

    _.mixin(Menu.prototype, EventEmitter, {
      _onSelectableClick: function onSelectableClick($e) {
        this.trigger("selectableClicked", $($e.currentTarget));
      },
      _onRendered: function onRendered(type, dataset, suggestions, async) {
        this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());
        this.trigger("datasetRendered", dataset, suggestions, async);
      },
      _onCleared: function onCleared() {
        this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());
        this.trigger("datasetCleared");
      },
      _propagate: function propagate() {
        this.trigger.apply(this, arguments);
      },
      _allDatasetsEmpty: function allDatasetsEmpty() {
        return _.every(this.datasets, _.bind(function isDatasetEmpty(dataset) {
          var isEmpty = dataset.isEmpty();
          this.$node.attr("aria-expanded", !isEmpty);
          return isEmpty;
        }, this));
      },
      _getSelectables: function getSelectables() {
        return this.$node.find(this.selectors.selectable);
      },
      _removeCursor: function _removeCursor() {
        var $selectable = this.getActiveSelectable();
        $selectable && $selectable.removeClass(this.classes.cursor);
      },
      _ensureVisible: function ensureVisible($el) {
        var elTop, elBottom, nodeScrollTop, nodeHeight;
        elTop = $el.position().top;
        elBottom = elTop + $el.outerHeight(true);
        nodeScrollTop = this.$node.scrollTop();
        nodeHeight = this.$node.height() + parseInt(this.$node.css("paddingTop"), 10) + parseInt(this.$node.css("paddingBottom"), 10);

        if (elTop < 0) {
          this.$node.scrollTop(nodeScrollTop + elTop);
        } else if (nodeHeight < elBottom) {
          this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));
        }
      },
      bind: function bind() {
        var that = this,
            onSelectableClick;
        onSelectableClick = _.bind(this._onSelectableClick, this);
        this.$node.on("click.tt", this.selectors.selectable, onSelectableClick);
        this.$node.on("mouseover", this.selectors.selectable, function () {
          that.setCursor($(this));
        });
        this.$node.on("mouseleave", function () {
          that._removeCursor();
        });

        _.each(this.datasets, function (dataset) {
          dataset.onSync("asyncRequested", that._propagate, that).onSync("asyncCanceled", that._propagate, that).onSync("asyncReceived", that._propagate, that).onSync("rendered", that._onRendered, that).onSync("cleared", that._onCleared, that);
        });

        return this;
      },
      isOpen: function isOpen() {
        return this.$node.hasClass(this.classes.open);
      },
      open: function open() {
        this.$node.scrollTop(0);
        this.$node.addClass(this.classes.open);
      },
      close: function close() {
        this.$node.attr("aria-expanded", false);
        this.$node.removeClass(this.classes.open);

        this._removeCursor();
      },
      setLanguageDirection: function setLanguageDirection(dir) {
        this.$node.attr("dir", dir);
      },
      selectableRelativeToCursor: function selectableRelativeToCursor(delta) {
        var $selectables, $oldCursor, oldIndex, newIndex;
        $oldCursor = this.getActiveSelectable();
        $selectables = this._getSelectables();
        oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;
        newIndex = oldIndex + delta;
        newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;
        newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;
        return newIndex === -1 ? null : $selectables.eq(newIndex);
      },
      setCursor: function setCursor($selectable) {
        this._removeCursor();

        if ($selectable = $selectable && $selectable.first()) {
          $selectable.addClass(this.classes.cursor);

          this._ensureVisible($selectable);
        }
      },
      getSelectableData: function getSelectableData($el) {
        return $el && $el.length ? Dataset.extractData($el) : null;
      },
      getActiveSelectable: function getActiveSelectable() {
        var $selectable = this._getSelectables().filter(this.selectors.cursor).first();

        return $selectable.length ? $selectable : null;
      },
      getTopSelectable: function getTopSelectable() {
        var $selectable = this._getSelectables().first();

        return $selectable.length ? $selectable : null;
      },
      update: function update(query) {
        var isValidUpdate = query !== this.query;

        if (isValidUpdate) {
          this.query = query;

          _.each(this.datasets, updateDataset);
        }

        return isValidUpdate;

        function updateDataset(dataset) {
          dataset.update(query);
        }
      },
      empty: function empty() {
        _.each(this.datasets, clearDataset);

        this.query = null;
        this.$node.addClass(this.classes.empty);

        function clearDataset(dataset) {
          dataset.clear();
        }
      },
      destroy: function destroy() {
        this.$node.off(".tt");
        this.$node = $("<div>");

        _.each(this.datasets, destroyDataset);

        function destroyDataset(dataset) {
          dataset.destroy();
        }
      }
    });

    return Menu;
  }();

  var Status = function () {
    "use strict";

    function Status(options) {
      this.$el = $("<span></span>", {
        role: "status",
        "aria-live": "polite"
      }).css({
        position: "absolute",
        padding: "0",
        border: "0",
        height: "1px",
        width: "1px",
        "margin-bottom": "-1px",
        "margin-right": "-1px",
        overflow: "hidden",
        clip: "rect(0 0 0 0)",
        "white-space": "nowrap"
      });
      options.$input.after(this.$el);

      _.each(options.menu.datasets, _.bind(function (dataset) {
        if (dataset.onSync) {
          dataset.onSync("rendered", _.bind(this.update, this));
          dataset.onSync("cleared", _.bind(this.cleared, this));
        }
      }, this));
    }

    _.mixin(Status.prototype, {
      update: function update(event, suggestions) {
        var length = suggestions.length;
        var words;

        if (length === 1) {
          words = {
            result: "result",
            is: "is"
          };
        } else {
          words = {
            result: "results",
            is: "are"
          };
        }

        this.$el.text(length + " " + words.result + " " + words.is + " available, use up and down arrow keys to navigate.");
      },
      cleared: function cleared() {
        this.$el.text("");
      }
    });

    return Status;
  }();

  var DefaultMenu = function () {
    "use strict";

    var s = Menu.prototype;

    function DefaultMenu() {
      Menu.apply(this, [].slice.call(arguments, 0));
    }

    _.mixin(DefaultMenu.prototype, Menu.prototype, {
      open: function open() {
        !this._allDatasetsEmpty() && this._show();
        return s.open.apply(this, [].slice.call(arguments, 0));
      },
      close: function close() {
        this._hide();

        return s.close.apply(this, [].slice.call(arguments, 0));
      },
      _onRendered: function onRendered() {
        if (this._allDatasetsEmpty()) {
          this._hide();
        } else {
          this.isOpen() && this._show();
        }

        return s._onRendered.apply(this, [].slice.call(arguments, 0));
      },
      _onCleared: function onCleared() {
        if (this._allDatasetsEmpty()) {
          this._hide();
        } else {
          this.isOpen() && this._show();
        }

        return s._onCleared.apply(this, [].slice.call(arguments, 0));
      },
      setLanguageDirection: function setLanguageDirection(dir) {
        this.$node.css(dir === "ltr" ? this.css.ltr : this.css.rtl);
        return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));
      },
      _hide: function hide() {
        this.$node.hide();
      },
      _show: function show() {
        this.$node.css("display", "block");
      }
    });

    return DefaultMenu;
  }();

  var Typeahead = function () {
    "use strict";

    function Typeahead(o, www) {
      var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;
      o = o || {};

      if (!o.input) {
        $.error("missing input");
      }

      if (!o.menu) {
        $.error("missing menu");
      }

      if (!o.eventBus) {
        $.error("missing event bus");
      }

      www.mixin(this);
      this.eventBus = o.eventBus;
      this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;
      this.input = o.input;
      this.menu = o.menu;
      this.enabled = true;
      this.autoselect = !!o.autoselect;
      this.active = false;
      this.input.hasFocus() && this.activate();
      this.dir = this.input.getLangDir();

      this._hacks();

      this.menu.bind().onSync("selectableClicked", this._onSelectableClicked, this).onSync("asyncRequested", this._onAsyncRequested, this).onSync("asyncCanceled", this._onAsyncCanceled, this).onSync("asyncReceived", this._onAsyncReceived, this).onSync("datasetRendered", this._onDatasetRendered, this).onSync("datasetCleared", this._onDatasetCleared, this);
      onFocused = c(this, "activate", "open", "_onFocused");
      onBlurred = c(this, "deactivate", "_onBlurred");
      onEnterKeyed = c(this, "isActive", "isOpen", "_onEnterKeyed");
      onTabKeyed = c(this, "isActive", "isOpen", "_onTabKeyed");
      onEscKeyed = c(this, "isActive", "_onEscKeyed");
      onUpKeyed = c(this, "isActive", "open", "_onUpKeyed");
      onDownKeyed = c(this, "isActive", "open", "_onDownKeyed");
      onLeftKeyed = c(this, "isActive", "isOpen", "_onLeftKeyed");
      onRightKeyed = c(this, "isActive", "isOpen", "_onRightKeyed");
      onQueryChanged = c(this, "_openIfActive", "_onQueryChanged");
      onWhitespaceChanged = c(this, "_openIfActive", "_onWhitespaceChanged");
      this.input.bind().onSync("focused", onFocused, this).onSync("blurred", onBlurred, this).onSync("enterKeyed", onEnterKeyed, this).onSync("tabKeyed", onTabKeyed, this).onSync("escKeyed", onEscKeyed, this).onSync("upKeyed", onUpKeyed, this).onSync("downKeyed", onDownKeyed, this).onSync("leftKeyed", onLeftKeyed, this).onSync("rightKeyed", onRightKeyed, this).onSync("queryChanged", onQueryChanged, this).onSync("whitespaceChanged", onWhitespaceChanged, this).onSync("langDirChanged", this._onLangDirChanged, this);
    }

    _.mixin(Typeahead.prototype, {
      _hacks: function hacks() {
        var $input, $menu;
        $input = this.input.$input || $("<div>");
        $menu = this.menu.$node || $("<div>");
        $input.on("blur.tt", function ($e) {
          var active, isActive, hasActive;
          active = document.activeElement;
          isActive = $menu.is(active);
          hasActive = $menu.has(active).length > 0;

          if (_.isMsie() && (isActive || hasActive)) {
            $e.preventDefault();
            $e.stopImmediatePropagation();

            _.defer(function () {
              $input.focus();
            });
          }
        });
        $menu.on("mousedown.tt", function ($e) {
          $e.preventDefault();
        });
      },
      _onSelectableClicked: function onSelectableClicked(type, $el) {
        this.select($el);
      },
      _onDatasetCleared: function onDatasetCleared() {
        this._updateHint();
      },
      _onDatasetRendered: function onDatasetRendered(type, suggestions, async, dataset) {
        this._updateHint();

        if (this.autoselect) {
          var cursorClass = this.selectors.cursor.substr(1);
          this.menu.$node.find(this.selectors.suggestion).first().addClass(cursorClass);
        }

        this.eventBus.trigger("render", suggestions, async, dataset);
      },
      _onAsyncRequested: function onAsyncRequested(type, dataset, query) {
        this.eventBus.trigger("asyncrequest", query, dataset);
      },
      _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {
        this.eventBus.trigger("asynccancel", query, dataset);
      },
      _onAsyncReceived: function onAsyncReceived(type, dataset, query) {
        this.eventBus.trigger("asyncreceive", query, dataset);
      },
      _onFocused: function onFocused() {
        this._minLengthMet() && this.menu.update(this.input.getQuery());
      },
      _onBlurred: function onBlurred() {
        if (this.input.hasQueryChangedSinceLastFocus()) {
          this.eventBus.trigger("change", this.input.getQuery());
        }
      },
      _onEnterKeyed: function onEnterKeyed(type, $e) {
        var $selectable;

        if ($selectable = this.menu.getActiveSelectable()) {
          if (this.select($selectable)) {
            $e.preventDefault();
            $e.stopPropagation();
          }
        } else if (this.autoselect) {
          if (this.select(this.menu.getTopSelectable())) {
            $e.preventDefault();
            $e.stopPropagation();
          }
        }
      },
      _onTabKeyed: function onTabKeyed(type, $e) {
        var $selectable;

        if ($selectable = this.menu.getActiveSelectable()) {
          this.select($selectable) && $e.preventDefault();
        } else if (this.autoselect) {
          if ($selectable = this.menu.getTopSelectable()) {
            this.autocomplete($selectable) && $e.preventDefault();
          }
        }
      },
      _onEscKeyed: function onEscKeyed() {
        this.close();
      },
      _onUpKeyed: function onUpKeyed() {
        this.moveCursor(-1);
      },
      _onDownKeyed: function onDownKeyed() {
        this.moveCursor(+1);
      },
      _onLeftKeyed: function onLeftKeyed() {
        if (this.dir === "rtl" && this.input.isCursorAtEnd()) {
          this.autocomplete(this.menu.getActiveSelectable() || this.menu.getTopSelectable());
        }
      },
      _onRightKeyed: function onRightKeyed() {
        if (this.dir === "ltr" && this.input.isCursorAtEnd()) {
          this.autocomplete(this.menu.getActiveSelectable() || this.menu.getTopSelectable());
        }
      },
      _onQueryChanged: function onQueryChanged(e, query) {
        this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();
      },
      _onWhitespaceChanged: function onWhitespaceChanged() {
        this._updateHint();
      },
      _onLangDirChanged: function onLangDirChanged(e, dir) {
        if (this.dir !== dir) {
          this.dir = dir;
          this.menu.setLanguageDirection(dir);
        }
      },
      _openIfActive: function openIfActive() {
        this.isActive() && this.open();
      },
      _minLengthMet: function minLengthMet(query) {
        query = _.isString(query) ? query : this.input.getQuery() || "";
        return query.length >= this.minLength;
      },
      _updateHint: function updateHint() {
        var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;
        $selectable = this.menu.getTopSelectable();
        data = this.menu.getSelectableData($selectable);
        val = this.input.getInputValue();

        if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {
          query = Input.normalizeQuery(val);
          escapedQuery = _.escapeRegExChars(query);
          frontMatchRegEx = new RegExp("^(?:" + escapedQuery + ")(.+$)", "i");
          match = frontMatchRegEx.exec(data.val);
          match && this.input.setHint(val + match[1]);
        } else {
          this.input.clearHint();
        }
      },
      isEnabled: function isEnabled() {
        return this.enabled;
      },
      enable: function enable() {
        this.enabled = true;
      },
      disable: function disable() {
        this.enabled = false;
      },
      isActive: function isActive() {
        return this.active;
      },
      activate: function activate() {
        if (this.isActive()) {
          return true;
        } else if (!this.isEnabled() || this.eventBus.before("active")) {
          return false;
        } else {
          this.active = true;
          this.eventBus.trigger("active");
          return true;
        }
      },
      deactivate: function deactivate() {
        if (!this.isActive()) {
          return true;
        } else if (this.eventBus.before("idle")) {
          return false;
        } else {
          this.active = false;
          this.close();
          this.eventBus.trigger("idle");
          return true;
        }
      },
      isOpen: function isOpen() {
        return this.menu.isOpen();
      },
      open: function open() {
        if (!this.isOpen() && !this.eventBus.before("open")) {
          this.menu.open();

          this._updateHint();

          this.eventBus.trigger("open");
        }

        return this.isOpen();
      },
      close: function close() {
        if (this.isOpen() && !this.eventBus.before("close")) {
          this.menu.close();
          this.input.clearHint();
          this.input.resetInputValue();
          this.eventBus.trigger("close");
        }

        return !this.isOpen();
      },
      setVal: function setVal(val) {
        this.input.setQuery(_.toStr(val));
      },
      getVal: function getVal() {
        return this.input.getQuery();
      },
      select: function select($selectable) {
        var data = this.menu.getSelectableData($selectable);

        if (data && !this.eventBus.before("select", data.obj, data.dataset)) {
          this.input.setQuery(data.val, true);
          this.eventBus.trigger("select", data.obj, data.dataset);
          this.close();
          return true;
        }

        return false;
      },
      autocomplete: function autocomplete($selectable) {
        var query, data, isValid;
        query = this.input.getQuery();
        data = this.menu.getSelectableData($selectable);
        isValid = data && query !== data.val;

        if (isValid && !this.eventBus.before("autocomplete", data.obj, data.dataset)) {
          this.input.setQuery(data.val);
          this.eventBus.trigger("autocomplete", data.obj, data.dataset);
          return true;
        }

        return false;
      },
      moveCursor: function moveCursor(delta) {
        var query, $candidate, data, suggestion, datasetName, cancelMove, id;
        query = this.input.getQuery();
        $candidate = this.menu.selectableRelativeToCursor(delta);
        data = this.menu.getSelectableData($candidate);
        suggestion = data ? data.obj : null;
        datasetName = data ? data.dataset : null;
        id = $candidate ? $candidate.attr("id") : null;
        this.input.trigger("cursorchange", id);
        cancelMove = this._minLengthMet() && this.menu.update(query);

        if (!cancelMove && !this.eventBus.before("cursorchange", suggestion, datasetName)) {
          this.menu.setCursor($candidate);

          if (data) {
            if (typeof data.val === "string") {
              this.input.setInputValue(data.val);
            }
          } else {
            this.input.resetInputValue();

            this._updateHint();
          }

          this.eventBus.trigger("cursorchange", suggestion, datasetName);
          return true;
        }

        return false;
      },
      destroy: function destroy() {
        this.input.destroy();
        this.menu.destroy();
      }
    });

    return Typeahead;

    function c(ctx) {
      var methods = [].slice.call(arguments, 1);
      return function () {
        var args = [].slice.call(arguments);

        _.each(methods, function (method) {
          return ctx[method].apply(ctx, args);
        });
      };
    }
  }();

  (function () {
    "use strict";

    var old, keys, methods;
    old = $.fn.typeahead;
    keys = {
      www: "tt-www",
      attrs: "tt-attrs",
      typeahead: "tt-typeahead"
    };
    methods = {
      initialize: function initialize(o, datasets) {
        var www;
        datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);
        o = o || {};
        www = WWW(o.classNames);
        return this.each(attach);

        function attach() {
          var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, status, typeahead, MenuConstructor;

          _.each(datasets, function (d) {
            d.highlight = !!o.highlight;
          });

          $input = $(this);
          $wrapper = $(www.html.wrapper);
          $hint = $elOrNull(o.hint);
          $menu = $elOrNull(o.menu);
          defaultHint = o.hint !== false && !$hint;
          defaultMenu = o.menu !== false && !$menu;
          defaultHint && ($hint = buildHintFromInput($input, www));
          defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));
          $hint && $hint.val("");
          $input = prepInput($input, www);

          if (defaultHint || defaultMenu) {
            $wrapper.css(www.css.wrapper);
            $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);
            $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);
          }

          MenuConstructor = defaultMenu ? DefaultMenu : Menu;
          eventBus = new EventBus({
            el: $input
          });
          input = new Input({
            hint: $hint,
            input: $input
          }, www);
          menu = new MenuConstructor({
            node: $menu,
            datasets: datasets
          }, www);
          status = new Status({
            $input: $input,
            menu: menu
          });
          typeahead = new Typeahead({
            input: input,
            menu: menu,
            eventBus: eventBus,
            minLength: o.minLength,
            autoselect: o.autoselect
          }, www);
          $input.data(keys.www, www);
          $input.data(keys.typeahead, typeahead);
        }
      },
      isEnabled: function isEnabled() {
        var enabled;
        ttEach(this.first(), function (t) {
          enabled = t.isEnabled();
        });
        return enabled;
      },
      enable: function enable() {
        ttEach(this, function (t) {
          t.enable();
        });
        return this;
      },
      disable: function disable() {
        ttEach(this, function (t) {
          t.disable();
        });
        return this;
      },
      isActive: function isActive() {
        var active;
        ttEach(this.first(), function (t) {
          active = t.isActive();
        });
        return active;
      },
      activate: function activate() {
        ttEach(this, function (t) {
          t.activate();
        });
        return this;
      },
      deactivate: function deactivate() {
        ttEach(this, function (t) {
          t.deactivate();
        });
        return this;
      },
      isOpen: function isOpen() {
        var open;
        ttEach(this.first(), function (t) {
          open = t.isOpen();
        });
        return open;
      },
      open: function open() {
        ttEach(this, function (t) {
          t.open();
        });
        return this;
      },
      close: function close() {
        ttEach(this, function (t) {
          t.close();
        });
        return this;
      },
      select: function select(el) {
        var success = false,
            $el = $(el);
        ttEach(this.first(), function (t) {
          success = t.select($el);
        });
        return success;
      },
      autocomplete: function autocomplete(el) {
        var success = false,
            $el = $(el);
        ttEach(this.first(), function (t) {
          success = t.autocomplete($el);
        });
        return success;
      },
      moveCursor: function moveCursoe(delta) {
        var success = false;
        ttEach(this.first(), function (t) {
          success = t.moveCursor(delta);
        });
        return success;
      },
      val: function val(newVal) {
        var query;

        if (!arguments.length) {
          ttEach(this.first(), function (t) {
            query = t.getVal();
          });
          return query;
        } else {
          ttEach(this, function (t) {
            t.setVal(_.toStr(newVal));
          });
          return this;
        }
      },
      destroy: function destroy() {
        ttEach(this, function (typeahead, $input) {
          revert($input);
          typeahead.destroy();
        });
        return this;
      }
    };

    $.fn.typeahead = function (method) {
      if (methods[method]) {
        return methods[method].apply(this, [].slice.call(arguments, 1));
      } else {
        return methods.initialize.apply(this, arguments);
      }
    };

    $.fn.typeahead.noConflict = function noConflict() {
      $.fn.typeahead = old;
      return this;
    };

    function ttEach($els, fn) {
      $els.each(function () {
        var $input = $(this),
            typeahead;
        (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);
      });
    }

    function buildHintFromInput($input, www) {
      return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop({
        readonly: true,
        required: false
      }).removeAttr("id name placeholder").removeClass("required").attr({
        spellcheck: "false",
        tabindex: -1
      });
    }

    function prepInput($input, www) {
      $input.data(keys.attrs, {
        dir: $input.attr("dir"),
        autocomplete: $input.attr("autocomplete"),
        spellcheck: $input.attr("spellcheck"),
        style: $input.attr("style")
      });
      $input.addClass(www.classes.input).attr({
        spellcheck: false
      });

      try {
        !$input.attr("dir") && $input.attr("dir", "auto");
      } catch (e) {}

      return $input;
    }

    function getBackgroundStyles($el) {
      return {
        backgroundAttachment: $el.css("background-attachment"),
        backgroundClip: $el.css("background-clip"),
        backgroundColor: $el.css("background-color"),
        backgroundImage: $el.css("background-image"),
        backgroundOrigin: $el.css("background-origin"),
        backgroundPosition: $el.css("background-position"),
        backgroundRepeat: $el.css("background-repeat"),
        backgroundSize: $el.css("background-size")
      };
    }

    function revert($input) {
      var www, $wrapper;
      www = $input.data(keys.www);
      $wrapper = $input.parent().filter(www.selectors.wrapper);

      _.each($input.data(keys.attrs), function (val, key) {
        _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);
      });

      $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);

      if ($wrapper.length) {
        $input.detach().insertAfter($wrapper);
        $wrapper.remove();
      }
    }

    function $elOrNull(obj) {
      var isValid, $el;
      isValid = _.isJQuery(obj) || _.isElement(obj);
      $el = isValid ? $(obj).first() : [];
      return $el.length ? $el : null;
    }
  })();
});
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../timers-browserify/main.js */ "./node_modules/timers-browserify/main.js").setImmediate))

/***/ }),

/***/ "./node_modules/bootstrap/js/src/alert.js":
/*!************************************************************************************!*\
  !*** delegated ./node_modules/bootstrap/js/src/alert.js from dll-reference vendor ***!
  \************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1006);

/***/ }),

/***/ "./node_modules/bootstrap/js/src/collapse.js":
/*!***************************************************************************************!*\
  !*** delegated ./node_modules/bootstrap/js/src/collapse.js from dll-reference vendor ***!
  \***************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1007);

/***/ }),

/***/ "./node_modules/bootstrap/js/src/dropdown.js":
/*!***************************************************************************************!*\
  !*** delegated ./node_modules/bootstrap/js/src/dropdown.js from dll-reference vendor ***!
  \***************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1008);

/***/ }),

/***/ "./node_modules/bootstrap/js/src/modal.js":
/*!************************************************************************************!*\
  !*** delegated ./node_modules/bootstrap/js/src/modal.js from dll-reference vendor ***!
  \************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1009);

/***/ }),

/***/ "./node_modules/bootstrap/js/src/popover.js":
/*!**************************************************************************************!*\
  !*** delegated ./node_modules/bootstrap/js/src/popover.js from dll-reference vendor ***!
  \**************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1010);

/***/ }),

/***/ "./node_modules/bootstrap/js/src/tooltip.js":
/*!**************************************************************************************!*\
  !*** delegated ./node_modules/bootstrap/js/src/tooltip.js from dll-reference vendor ***!
  \**************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(367);

/***/ }),

/***/ "./node_modules/corejs-typeahead/dist/typeahead.bundle.js-exposed":
/*!************************************************************************!*\
  !*** ./node_modules/corejs-typeahead/dist/typeahead.bundle.js-exposed ***!
  \************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {module.exports = global["Bloodhound"] = __webpack_require__(/*! -!./node_modules/babel-loader/lib??ref--10!./typeahead.bundle.js */ "./node_modules/babel-loader/lib/index.js?!./node_modules/corejs-typeahead/dist/typeahead.bundle.js");
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./node_modules/d3/index.js":
/*!**********************************************************************!*\
  !*** delegated ./node_modules/d3/index.js from dll-reference vendor ***!
  \**********************************************************************/
/*! exports provided: version, bisect, bisectRight, bisectLeft, ascending, bisector, cross, descending, deviation, extent, histogram, thresholdFreedmanDiaconis, thresholdScott, thresholdSturges, max, mean, median, merge, min, pairs, permute, quantile, range, scan, shuffle, sum, ticks, tickIncrement, tickStep, transpose, variance, zip, axisTop, axisRight, axisBottom, axisLeft, brush, brushX, brushY, brushSelection, chord, ribbon, nest, set, map, keys, values, entries, color, rgb, hsl, lab, hcl, lch, gray, cubehelix, contours, contourDensity, dispatch, drag, dragDisable, dragEnable, dsvFormat, csvParse, csvParseRows, csvFormat, csvFormatBody, csvFormatRows, csvFormatRow, csvFormatValue, tsvParse, tsvParseRows, tsvFormat, tsvFormatBody, tsvFormatRows, tsvFormatRow, tsvFormatValue, autoType, easeLinear, easeQuad, easeQuadIn, easeQuadOut, easeQuadInOut, easeCubic, easeCubicIn, easeCubicOut, easeCubicInOut, easePoly, easePolyIn, easePolyOut, easePolyInOut, easeSin, easeSinIn, easeSinOut, easeSinInOut, easeExp, easeExpIn, easeExpOut, easeExpInOut, easeCircle, easeCircleIn, easeCircleOut, easeCircleInOut, easeBounce, easeBounceIn, easeBounceOut, easeBounceInOut, easeBack, easeBackIn, easeBackOut, easeBackInOut, easeElastic, easeElasticIn, easeElasticOut, easeElasticInOut, blob, buffer, dsv, csv, tsv, image, json, text, xml, html, svg, forceCenter, forceCollide, forceLink, forceManyBody, forceRadial, forceSimulation, forceX, forceY, formatDefaultLocale, format, formatPrefix, formatLocale, formatSpecifier, FormatSpecifier, precisionFixed, precisionPrefix, precisionRound, geoArea, geoBounds, geoCentroid, geoCircle, geoClipAntimeridian, geoClipCircle, geoClipExtent, geoClipRectangle, geoContains, geoDistance, geoGraticule, geoGraticule10, geoInterpolate, geoLength, geoPath, geoAlbers, geoAlbersUsa, geoAzimuthalEqualArea, geoAzimuthalEqualAreaRaw, geoAzimuthalEquidistant, geoAzimuthalEquidistantRaw, geoConicConformal, geoConicConformalRaw, geoConicEqualArea, geoConicEqualAreaRaw, geoConicEquidistant, geoConicEquidistantRaw, geoEqualEarth, geoEqualEarthRaw, geoEquirectangular, geoEquirectangularRaw, geoGnomonic, geoGnomonicRaw, geoIdentity, geoProjection, geoProjectionMutator, geoMercator, geoMercatorRaw, geoNaturalEarth1, geoNaturalEarth1Raw, geoOrthographic, geoOrthographicRaw, geoStereographic, geoStereographicRaw, geoTransverseMercator, geoTransverseMercatorRaw, geoRotation, geoStream, geoTransform, cluster, hierarchy, pack, packSiblings, packEnclose, partition, stratify, tree, treemap, treemapBinary, treemapDice, treemapSlice, treemapSliceDice, treemapSquarify, treemapResquarify, interpolate, interpolateArray, interpolateBasis, interpolateBasisClosed, interpolateDate, interpolateDiscrete, interpolateHue, interpolateNumber, interpolateNumberArray, interpolateObject, interpolateRound, interpolateString, interpolateTransformCss, interpolateTransformSvg, interpolateZoom, interpolateRgb, interpolateRgbBasis, interpolateRgbBasisClosed, interpolateHsl, interpolateHslLong, interpolateLab, interpolateHcl, interpolateHclLong, interpolateCubehelix, interpolateCubehelixLong, piecewise, quantize, path, polygonArea, polygonCentroid, polygonHull, polygonContains, polygonLength, quadtree, randomUniform, randomNormal, randomLogNormal, randomBates, randomIrwinHall, randomExponential, scaleBand, scalePoint, scaleIdentity, scaleLinear, scaleLog, scaleSymlog, scaleOrdinal, scaleImplicit, scalePow, scaleSqrt, scaleQuantile, scaleQuantize, scaleThreshold, scaleTime, scaleUtc, scaleSequential, scaleSequentialLog, scaleSequentialPow, scaleSequentialSqrt, scaleSequentialSymlog, scaleSequentialQuantile, scaleDiverging, scaleDivergingLog, scaleDivergingPow, scaleDivergingSqrt, scaleDivergingSymlog, tickFormat, schemeCategory10, schemeAccent, schemeDark2, schemePaired, schemePastel1, schemePastel2, schemeSet1, schemeSet2, schemeSet3, schemeTableau10, interpolateBrBG, schemeBrBG, interpolatePRGn, schemePRGn, interpolatePiYG, schemePiYG, interpolatePuOr, schemePuOr, interpolateRdBu, schemeRdBu, interpolateRdGy, schemeRdGy, interpolateRdYlBu, schemeRdYlBu, interpolateRdYlGn, schemeRdYlGn, interpolateSpectral, schemeSpectral, interpolateBuGn, schemeBuGn, interpolateBuPu, schemeBuPu, interpolateGnBu, schemeGnBu, interpolateOrRd, schemeOrRd, interpolatePuBuGn, schemePuBuGn, interpolatePuBu, schemePuBu, interpolatePuRd, schemePuRd, interpolateRdPu, schemeRdPu, interpolateYlGnBu, schemeYlGnBu, interpolateYlGn, schemeYlGn, interpolateYlOrBr, schemeYlOrBr, interpolateYlOrRd, schemeYlOrRd, interpolateBlues, schemeBlues, interpolateGreens, schemeGreens, interpolateGreys, schemeGreys, interpolatePurples, schemePurples, interpolateReds, schemeReds, interpolateOranges, schemeOranges, interpolateCividis, interpolateCubehelixDefault, interpolateRainbow, interpolateWarm, interpolateCool, interpolateSinebow, interpolateTurbo, interpolateViridis, interpolateMagma, interpolateInferno, interpolatePlasma, create, creator, local, matcher, mouse, namespace, namespaces, clientPoint, select, selectAll, selection, selector, selectorAll, style, touch, touches, window, event, customEvent, arc, area, line, pie, areaRadial, radialArea, lineRadial, radialLine, pointRadial, linkHorizontal, linkVertical, linkRadial, symbol, symbols, symbolCircle, symbolCross, symbolDiamond, symbolSquare, symbolStar, symbolTriangle, symbolWye, curveBasisClosed, curveBasisOpen, curveBasis, curveBundle, curveCardinalClosed, curveCardinalOpen, curveCardinal, curveCatmullRomClosed, curveCatmullRomOpen, curveCatmullRom, curveLinearClosed, curveLinear, curveMonotoneX, curveMonotoneY, curveNatural, curveStep, curveStepAfter, curveStepBefore, stack, stackOffsetExpand, stackOffsetDiverging, stackOffsetNone, stackOffsetSilhouette, stackOffsetWiggle, stackOrderAppearance, stackOrderAscending, stackOrderDescending, stackOrderInsideOut, stackOrderNone, stackOrderReverse, timeInterval, timeMillisecond, timeMilliseconds, utcMillisecond, utcMilliseconds, timeSecond, timeSeconds, utcSecond, utcSeconds, timeMinute, timeMinutes, timeHour, timeHours, timeDay, timeDays, timeWeek, timeWeeks, timeSunday, timeSundays, timeMonday, timeMondays, timeTuesday, timeTuesdays, timeWednesday, timeWednesdays, timeThursday, timeThursdays, timeFriday, timeFridays, timeSaturday, timeSaturdays, timeMonth, timeMonths, timeYear, timeYears, utcMinute, utcMinutes, utcHour, utcHours, utcDay, utcDays, utcWeek, utcWeeks, utcSunday, utcSundays, utcMonday, utcMondays, utcTuesday, utcTuesdays, utcWednesday, utcWednesdays, utcThursday, utcThursdays, utcFriday, utcFridays, utcSaturday, utcSaturdays, utcMonth, utcMonths, utcYear, utcYears, timeFormatDefaultLocale, timeFormat, timeParse, utcFormat, utcParse, timeFormatLocale, isoFormat, isoParse, now, timer, timerFlush, timeout, interval, transition, active, interrupt, voronoi, zoom, zoomTransform, zoomIdentity */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1011);

/***/ }),

/***/ "./node_modules/file-saver/dist/FileSaver.min.js":
/*!*******************************************************************************************!*\
  !*** delegated ./node_modules/file-saver/dist/FileSaver.min.js from dll-reference vendor ***!
  \*******************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1013);

/***/ }),

/***/ "./node_modules/floatthead/dist/jquery.floatThead.min.js":
/*!***************************************************************************************************!*\
  !*** delegated ./node_modules/floatthead/dist/jquery.floatThead.min.js from dll-reference vendor ***!
  \***************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1014);

/***/ }),

/***/ "./node_modules/jquery-datetimepicker/jquery.datetimepicker.css":
/*!**********************************************************************!*\
  !*** ./node_modules/jquery-datetimepicker/jquery.datetimepicker.css ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./node_modules/jquery-datetimepicker/jquery.datetimepicker.js":
/*!*********************************************************************************************************!*\
  !*** delegated ./node_modules/jquery-datetimepicker/jquery.datetimepicker.js from dll-reference vendor ***!
  \*********************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1015);

/***/ }),

/***/ "./node_modules/jquery-ui-touch-punch/jquery.ui.touch-punch.js":
/*!*********************************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui-touch-punch/jquery.ui.touch-punch.js from dll-reference vendor ***!
  \*********************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1017);

/***/ }),

/***/ "./node_modules/jquery-ui/ui/i18n/datepicker-de.js":
/*!*********************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui/ui/i18n/datepicker-de.js from dll-reference vendor ***!
  \*********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1018);

/***/ }),

/***/ "./node_modules/jquery-ui/ui/i18n/datepicker-en-GB.js":
/*!************************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui/ui/i18n/datepicker-en-GB.js from dll-reference vendor ***!
  \************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1019);

/***/ }),

/***/ "./node_modules/jquery-ui/ui/i18n/datepicker-fr.js":
/*!*********************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui/ui/i18n/datepicker-fr.js from dll-reference vendor ***!
  \*********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1020);

/***/ }),

/***/ "./node_modules/jquery-ui/ui/i18n/datepicker-it.js":
/*!*********************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui/ui/i18n/datepicker-it.js from dll-reference vendor ***!
  \*********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1021);

/***/ }),

/***/ "./node_modules/jquery-ui/ui/widgets/draggable.js":
/*!********************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui/ui/widgets/draggable.js from dll-reference vendor ***!
  \********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1022);

/***/ }),

/***/ "./node_modules/jquery-ui/ui/widgets/resizable.js":
/*!********************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui/ui/widgets/resizable.js from dll-reference vendor ***!
  \********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1025);

/***/ }),

/***/ "./node_modules/jquery-ui/ui/widgets/slider.js":
/*!*****************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui/ui/widgets/slider.js from dll-reference vendor ***!
  \*****************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1027);

/***/ }),

/***/ "./node_modules/jquery-ui/ui/widgets/sortable.js":
/*!*******************************************************************************************!*\
  !*** delegated ./node_modules/jquery-ui/ui/widgets/sortable.js from dll-reference vendor ***!
  \*******************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1028);

/***/ }),

/***/ "./node_modules/jquery/dist/jquery.js":
/*!********************************************************************************!*\
  !*** delegated ./node_modules/jquery/dist/jquery.js from dll-reference vendor ***!
  \********************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(4);

/***/ }),

/***/ "./node_modules/moment/src/lib/create/check-overflow.js":
/*!**************************************************************!*\
  !*** ./node_modules/moment/src/lib/create/check-overflow.js ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return checkOverflow; });
/* harmony import */ var _units_month__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../units/month */ "./node_modules/moment/src/lib/units/month.js");
/* harmony import */ var _units_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../units/constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");



function checkOverflow(m) {
  var overflow;
  var a = m._a;

  if (a && Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(m).overflow === -2) {
    overflow = a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MONTH"]] < 0 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MONTH"]] > 11 ? _units_constants__WEBPACK_IMPORTED_MODULE_1__["MONTH"] : a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["DATE"]] < 1 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["DATE"]] > Object(_units_month__WEBPACK_IMPORTED_MODULE_0__["daysInMonth"])(a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["YEAR"]], a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MONTH"]]) ? _units_constants__WEBPACK_IMPORTED_MODULE_1__["DATE"] : a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["HOUR"]] < 0 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["HOUR"]] > 24 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["HOUR"]] === 24 && (a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MINUTE"]] !== 0 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["SECOND"]] !== 0 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MILLISECOND"]] !== 0) ? _units_constants__WEBPACK_IMPORTED_MODULE_1__["HOUR"] : a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MINUTE"]] < 0 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MINUTE"]] > 59 ? _units_constants__WEBPACK_IMPORTED_MODULE_1__["MINUTE"] : a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["SECOND"]] < 0 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["SECOND"]] > 59 ? _units_constants__WEBPACK_IMPORTED_MODULE_1__["SECOND"] : a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MILLISECOND"]] < 0 || a[_units_constants__WEBPACK_IMPORTED_MODULE_1__["MILLISECOND"]] > 999 ? _units_constants__WEBPACK_IMPORTED_MODULE_1__["MILLISECOND"] : -1;

    if (Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(m)._overflowDayOfYear && (overflow < _units_constants__WEBPACK_IMPORTED_MODULE_1__["YEAR"] || overflow > _units_constants__WEBPACK_IMPORTED_MODULE_1__["DATE"])) {
      overflow = _units_constants__WEBPACK_IMPORTED_MODULE_1__["DATE"];
    }

    if (Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(m)._overflowWeeks && overflow === -1) {
      overflow = _units_constants__WEBPACK_IMPORTED_MODULE_1__["WEEK"];
    }

    if (Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(m)._overflowWeekday && overflow === -1) {
      overflow = _units_constants__WEBPACK_IMPORTED_MODULE_1__["WEEKDAY"];
    }

    Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(m).overflow = overflow;
  }

  return m;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/date-from-array.js":
/*!***************************************************************!*\
  !*** ./node_modules/moment/src/lib/create/date-from-array.js ***!
  \***************************************************************/
/*! exports provided: createDate, createUTCDate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createDate", function() { return createDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUTCDate", function() { return createUTCDate; });
function createDate(y, m, d, h, M, s, ms) {
  var date;

  if (y < 100 && y >= 0) {
    date = new Date(y + 400, m, d, h, M, s, ms);

    if (isFinite(date.getFullYear())) {
      date.setFullYear(y);
    }
  } else {
    date = new Date(y, m, d, h, M, s, ms);
  }

  return date;
}
function createUTCDate(y) {
  var date;

  if (y < 100 && y >= 0) {
    var args = Array.prototype.slice.call(arguments);
    args[0] = y + 400;
    date = new Date(Date.UTC.apply(null, args));

    if (isFinite(date.getUTCFullYear())) {
      date.setUTCFullYear(y);
    }
  } else {
    date = new Date(Date.UTC.apply(null, arguments));
  }

  return date;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/from-anything.js":
/*!*************************************************************!*\
  !*** ./node_modules/moment/src/lib/create/from-anything.js ***!
  \*************************************************************/
/*! exports provided: prepareConfig, createLocalOrUTC */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prepareConfig", function() { return prepareConfig; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createLocalOrUTC", function() { return createLocalOrUTC; });
/* harmony import */ var _utils_is_array__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/is-array */ "./node_modules/moment/src/lib/utils/is-array.js");
/* harmony import */ var _utils_is_object__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/is-object */ "./node_modules/moment/src/lib/utils/is-object.js");
/* harmony import */ var _utils_is_object_empty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/is-object-empty */ "./node_modules/moment/src/lib/utils/is-object-empty.js");
/* harmony import */ var _utils_is_undefined__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/is-undefined */ "./node_modules/moment/src/lib/utils/is-undefined.js");
/* harmony import */ var _utils_is_number__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/is-number */ "./node_modules/moment/src/lib/utils/is-number.js");
/* harmony import */ var _utils_is_date__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/is-date */ "./node_modules/moment/src/lib/utils/is-date.js");
/* harmony import */ var _utils_map__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/map */ "./node_modules/moment/src/lib/utils/map.js");
/* harmony import */ var _valid__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./valid */ "./node_modules/moment/src/lib/create/valid.js");
/* harmony import */ var _moment_constructor__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../moment/constructor */ "./node_modules/moment/src/lib/moment/constructor.js");
/* harmony import */ var _locale_locales__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../locale/locales */ "./node_modules/moment/src/lib/locale/locales.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _check_overflow__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./check-overflow */ "./node_modules/moment/src/lib/create/check-overflow.js");
/* harmony import */ var _from_string_and_array__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./from-string-and-array */ "./node_modules/moment/src/lib/create/from-string-and-array.js");
/* harmony import */ var _from_string_and_format__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./from-string-and-format */ "./node_modules/moment/src/lib/create/from-string-and-format.js");
/* harmony import */ var _from_string__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./from-string */ "./node_modules/moment/src/lib/create/from-string.js");
/* harmony import */ var _from_array__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./from-array */ "./node_modules/moment/src/lib/create/from-array.js");
/* harmony import */ var _from_object__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./from-object */ "./node_modules/moment/src/lib/create/from-object.js");



















function createFromConfig(config) {
  var res = new _moment_constructor__WEBPACK_IMPORTED_MODULE_8__["Moment"](Object(_check_overflow__WEBPACK_IMPORTED_MODULE_11__["default"])(prepareConfig(config)));

  if (res._nextDay) {
    res.add(1, 'd');
    res._nextDay = undefined;
  }

  return res;
}

function prepareConfig(config) {
  var input = config._i,
      format = config._f;
  config._locale = config._locale || Object(_locale_locales__WEBPACK_IMPORTED_MODULE_9__["getLocale"])(config._l);

  if (input === null || format === undefined && input === '') {
    return Object(_valid__WEBPACK_IMPORTED_MODULE_7__["createInvalid"])({
      nullInput: true
    });
  }

  if (typeof input === 'string') {
    config._i = input = config._locale.preparse(input);
  }

  if (Object(_moment_constructor__WEBPACK_IMPORTED_MODULE_8__["isMoment"])(input)) {
    return new _moment_constructor__WEBPACK_IMPORTED_MODULE_8__["Moment"](Object(_check_overflow__WEBPACK_IMPORTED_MODULE_11__["default"])(input));
  } else if (Object(_utils_is_date__WEBPACK_IMPORTED_MODULE_5__["default"])(input)) {
    config._d = input;
  } else if (Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_0__["default"])(format)) {
    Object(_from_string_and_array__WEBPACK_IMPORTED_MODULE_12__["configFromStringAndArray"])(config);
  } else if (format) {
    Object(_from_string_and_format__WEBPACK_IMPORTED_MODULE_13__["configFromStringAndFormat"])(config);
  } else {
    configFromInput(config);
  }

  if (!Object(_valid__WEBPACK_IMPORTED_MODULE_7__["isValid"])(config)) {
    config._d = null;
  }

  return config;
}

function configFromInput(config) {
  var input = config._i;

  if (Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_3__["default"])(input)) {
    config._d = new Date(_utils_hooks__WEBPACK_IMPORTED_MODULE_10__["hooks"].now());
  } else if (Object(_utils_is_date__WEBPACK_IMPORTED_MODULE_5__["default"])(input)) {
    config._d = new Date(input.valueOf());
  } else if (typeof input === 'string') {
    Object(_from_string__WEBPACK_IMPORTED_MODULE_14__["configFromString"])(config);
  } else if (Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_0__["default"])(input)) {
    config._a = Object(_utils_map__WEBPACK_IMPORTED_MODULE_6__["default"])(input.slice(0), function (obj) {
      return parseInt(obj, 10);
    });
    Object(_from_array__WEBPACK_IMPORTED_MODULE_15__["configFromArray"])(config);
  } else if (Object(_utils_is_object__WEBPACK_IMPORTED_MODULE_1__["default"])(input)) {
    Object(_from_object__WEBPACK_IMPORTED_MODULE_16__["configFromObject"])(config);
  } else if (Object(_utils_is_number__WEBPACK_IMPORTED_MODULE_4__["default"])(input)) {
    config._d = new Date(input);
  } else {
    _utils_hooks__WEBPACK_IMPORTED_MODULE_10__["hooks"].createFromInputFallback(config);
  }
}

function createLocalOrUTC(input, format, locale, strict, isUTC) {
  var c = {};

  if (locale === true || locale === false) {
    strict = locale;
    locale = undefined;
  }

  if (Object(_utils_is_object__WEBPACK_IMPORTED_MODULE_1__["default"])(input) && Object(_utils_is_object_empty__WEBPACK_IMPORTED_MODULE_2__["default"])(input) || Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_0__["default"])(input) && input.length === 0) {
    input = undefined;
  }

  c._isAMomentObject = true;
  c._useUTC = c._isUTC = isUTC;
  c._l = locale;
  c._i = input;
  c._f = format;
  c._strict = strict;
  return createFromConfig(c);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/from-array.js":
/*!**********************************************************!*\
  !*** ./node_modules/moment/src/lib/create/from-array.js ***!
  \**********************************************************/
/*! exports provided: configFromArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "configFromArray", function() { return configFromArray; });
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _date_from_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./date-from-array */ "./node_modules/moment/src/lib/create/date-from-array.js");
/* harmony import */ var _units_year__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../units/year */ "./node_modules/moment/src/lib/units/year.js");
/* harmony import */ var _units_week_calendar_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../units/week-calendar-utils */ "./node_modules/moment/src/lib/units/week-calendar-utils.js");
/* harmony import */ var _units_constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../units/constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _local__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _utils_defaults__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/defaults */ "./node_modules/moment/src/lib/utils/defaults.js");
/* harmony import */ var _parsing_flags__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");









function currentDateArray(config) {
  var nowValue = new Date(_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].now());

  if (config._useUTC) {
    return [nowValue.getUTCFullYear(), nowValue.getUTCMonth(), nowValue.getUTCDate()];
  }

  return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];
}

function configFromArray(config) {
  var i,
      date,
      input = [],
      currentDate,
      expectedWeekday,
      yearToUse;

  if (config._d) {
    return;
  }

  currentDate = currentDateArray(config);

  if (config._w && config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["DATE"]] == null && config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["MONTH"]] == null) {
    dayOfYearFromWeekInfo(config);
  }

  if (config._dayOfYear != null) {
    yearToUse = Object(_utils_defaults__WEBPACK_IMPORTED_MODULE_6__["default"])(config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["YEAR"]], currentDate[_units_constants__WEBPACK_IMPORTED_MODULE_4__["YEAR"]]);

    if (config._dayOfYear > Object(_units_year__WEBPACK_IMPORTED_MODULE_2__["daysInYear"])(yearToUse) || config._dayOfYear === 0) {
      Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_7__["default"])(config)._overflowDayOfYear = true;
    }

    date = Object(_date_from_array__WEBPACK_IMPORTED_MODULE_1__["createUTCDate"])(yearToUse, 0, config._dayOfYear);
    config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["MONTH"]] = date.getUTCMonth();
    config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["DATE"]] = date.getUTCDate();
  }

  for (i = 0; i < 3 && config._a[i] == null; ++i) {
    config._a[i] = input[i] = currentDate[i];
  }

  for (; i < 7; i++) {
    config._a[i] = input[i] = config._a[i] == null ? i === 2 ? 1 : 0 : config._a[i];
  }

  if (config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["HOUR"]] === 24 && config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["MINUTE"]] === 0 && config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["SECOND"]] === 0 && config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["MILLISECOND"]] === 0) {
    config._nextDay = true;
    config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["HOUR"]] = 0;
  }

  config._d = (config._useUTC ? _date_from_array__WEBPACK_IMPORTED_MODULE_1__["createUTCDate"] : _date_from_array__WEBPACK_IMPORTED_MODULE_1__["createDate"]).apply(null, input);
  expectedWeekday = config._useUTC ? config._d.getUTCDay() : config._d.getDay();

  if (config._tzm != null) {
    config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
  }

  if (config._nextDay) {
    config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["HOUR"]] = 24;
  }

  if (config._w && typeof config._w.d !== 'undefined' && config._w.d !== expectedWeekday) {
    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_7__["default"])(config).weekdayMismatch = true;
  }
}

function dayOfYearFromWeekInfo(config) {
  var w, weekYear, week, weekday, dow, doy, temp, weekdayOverflow;
  w = config._w;

  if (w.GG != null || w.W != null || w.E != null) {
    dow = 1;
    doy = 4;
    weekYear = Object(_utils_defaults__WEBPACK_IMPORTED_MODULE_6__["default"])(w.GG, config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["YEAR"]], Object(_units_week_calendar_utils__WEBPACK_IMPORTED_MODULE_3__["weekOfYear"])(Object(_local__WEBPACK_IMPORTED_MODULE_5__["createLocal"])(), 1, 4).year);
    week = Object(_utils_defaults__WEBPACK_IMPORTED_MODULE_6__["default"])(w.W, 1);
    weekday = Object(_utils_defaults__WEBPACK_IMPORTED_MODULE_6__["default"])(w.E, 1);

    if (weekday < 1 || weekday > 7) {
      weekdayOverflow = true;
    }
  } else {
    dow = config._locale._week.dow;
    doy = config._locale._week.doy;
    var curWeek = Object(_units_week_calendar_utils__WEBPACK_IMPORTED_MODULE_3__["weekOfYear"])(Object(_local__WEBPACK_IMPORTED_MODULE_5__["createLocal"])(), dow, doy);
    weekYear = Object(_utils_defaults__WEBPACK_IMPORTED_MODULE_6__["default"])(w.gg, config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["YEAR"]], curWeek.year);
    week = Object(_utils_defaults__WEBPACK_IMPORTED_MODULE_6__["default"])(w.w, curWeek.week);

    if (w.d != null) {
      weekday = w.d;

      if (weekday < 0 || weekday > 6) {
        weekdayOverflow = true;
      }
    } else if (w.e != null) {
      weekday = w.e + dow;

      if (w.e < 0 || w.e > 6) {
        weekdayOverflow = true;
      }
    } else {
      weekday = dow;
    }
  }

  if (week < 1 || week > Object(_units_week_calendar_utils__WEBPACK_IMPORTED_MODULE_3__["weeksInYear"])(weekYear, dow, doy)) {
    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_7__["default"])(config)._overflowWeeks = true;
  } else if (weekdayOverflow != null) {
    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_7__["default"])(config)._overflowWeekday = true;
  } else {
    temp = Object(_units_week_calendar_utils__WEBPACK_IMPORTED_MODULE_3__["dayOfYearFromWeeks"])(weekYear, week, weekday, dow, doy);
    config._a[_units_constants__WEBPACK_IMPORTED_MODULE_4__["YEAR"]] = temp.year;
    config._dayOfYear = temp.dayOfYear;
  }
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/from-object.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/create/from-object.js ***!
  \***********************************************************/
/*! exports provided: configFromObject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "configFromObject", function() { return configFromObject; });
/* harmony import */ var _units_aliases__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../units/aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _from_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./from-array */ "./node_modules/moment/src/lib/create/from-array.js");
/* harmony import */ var _utils_map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/map */ "./node_modules/moment/src/lib/utils/map.js");



function configFromObject(config) {
  if (config._d) {
    return;
  }

  var i = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_0__["normalizeObjectUnits"])(config._i);
  config._a = Object(_utils_map__WEBPACK_IMPORTED_MODULE_2__["default"])([i.year, i.month, i.day || i.date, i.hour, i.minute, i.second, i.millisecond], function (obj) {
    return obj && parseInt(obj, 10);
  });
  Object(_from_array__WEBPACK_IMPORTED_MODULE_1__["configFromArray"])(config);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/from-string-and-array.js":
/*!*********************************************************************!*\
  !*** ./node_modules/moment/src/lib/create/from-string-and-array.js ***!
  \*********************************************************************/
/*! exports provided: configFromStringAndArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "configFromStringAndArray", function() { return configFromStringAndArray; });
/* harmony import */ var _moment_constructor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../moment/constructor */ "./node_modules/moment/src/lib/moment/constructor.js");
/* harmony import */ var _from_string_and_format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./from-string-and-format */ "./node_modules/moment/src/lib/create/from-string-and-format.js");
/* harmony import */ var _parsing_flags__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");
/* harmony import */ var _valid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./valid */ "./node_modules/moment/src/lib/create/valid.js");
/* harmony import */ var _utils_extend__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/extend */ "./node_modules/moment/src/lib/utils/extend.js");





function configFromStringAndArray(config) {
  var tempConfig, bestMoment, scoreToBeat, i, currentScore;

  if (config._f.length === 0) {
    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(config).invalidFormat = true;
    config._d = new Date(NaN);
    return;
  }

  for (i = 0; i < config._f.length; i++) {
    currentScore = 0;
    tempConfig = Object(_moment_constructor__WEBPACK_IMPORTED_MODULE_0__["copyConfig"])({}, config);

    if (config._useUTC != null) {
      tempConfig._useUTC = config._useUTC;
    }

    tempConfig._f = config._f[i];
    Object(_from_string_and_format__WEBPACK_IMPORTED_MODULE_1__["configFromStringAndFormat"])(tempConfig);

    if (!Object(_valid__WEBPACK_IMPORTED_MODULE_3__["isValid"])(tempConfig)) {
      continue;
    }

    currentScore += Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(tempConfig).charsLeftOver;
    currentScore += Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(tempConfig).unusedTokens.length * 10;
    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(tempConfig).score = currentScore;

    if (scoreToBeat == null || currentScore < scoreToBeat) {
      scoreToBeat = currentScore;
      bestMoment = tempConfig;
    }
  }

  Object(_utils_extend__WEBPACK_IMPORTED_MODULE_4__["default"])(config, bestMoment || tempConfig);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/from-string-and-format.js":
/*!**********************************************************************!*\
  !*** ./node_modules/moment/src/lib/create/from-string-and-format.js ***!
  \**********************************************************************/
/*! exports provided: configFromStringAndFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "configFromStringAndFormat", function() { return configFromStringAndFormat; });
/* harmony import */ var _from_string__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./from-string */ "./node_modules/moment/src/lib/create/from-string.js");
/* harmony import */ var _from_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./from-array */ "./node_modules/moment/src/lib/create/from-array.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _check_overflow__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./check-overflow */ "./node_modules/moment/src/lib/create/check-overflow.js");
/* harmony import */ var _units_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../units/constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _parsing_flags__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");










_utils_hooks__WEBPACK_IMPORTED_MODULE_7__["hooks"].ISO_8601 = function () {};

_utils_hooks__WEBPACK_IMPORTED_MODULE_7__["hooks"].RFC_2822 = function () {};

function configFromStringAndFormat(config) {
  if (config._f === _utils_hooks__WEBPACK_IMPORTED_MODULE_7__["hooks"].ISO_8601) {
    Object(_from_string__WEBPACK_IMPORTED_MODULE_0__["configFromISO"])(config);
    return;
  }

  if (config._f === _utils_hooks__WEBPACK_IMPORTED_MODULE_7__["hooks"].RFC_2822) {
    Object(_from_string__WEBPACK_IMPORTED_MODULE_0__["configFromRFC2822"])(config);
    return;
  }

  config._a = [];
  Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).empty = true;
  var string = '' + config._i,
      i,
      parsedInput,
      tokens,
      token,
      skipped,
      stringLength = string.length,
      totalParsedInputLength = 0;
  tokens = Object(_format_format__WEBPACK_IMPORTED_MODULE_4__["expandFormat"])(config._f, config._locale).match(_format_format__WEBPACK_IMPORTED_MODULE_4__["formattingTokens"]) || [];

  for (i = 0; i < tokens.length; i++) {
    token = tokens[i];
    parsedInput = (string.match(Object(_parse_regex__WEBPACK_IMPORTED_MODULE_2__["getParseRegexForToken"])(token, config)) || [])[0];

    if (parsedInput) {
      skipped = string.substr(0, string.indexOf(parsedInput));

      if (skipped.length > 0) {
        Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).unusedInput.push(skipped);
      }

      string = string.slice(string.indexOf(parsedInput) + parsedInput.length);
      totalParsedInputLength += parsedInput.length;
    }

    if (_format_format__WEBPACK_IMPORTED_MODULE_4__["formatTokenFunctions"][token]) {
      if (parsedInput) {
        Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).empty = false;
      } else {
        Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).unusedTokens.push(token);
      }

      Object(_parse_token__WEBPACK_IMPORTED_MODULE_3__["addTimeToArrayFromToken"])(token, parsedInput, config);
    } else if (config._strict && !parsedInput) {
      Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).unusedTokens.push(token);
    }
  }

  Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).charsLeftOver = stringLength - totalParsedInputLength;

  if (string.length > 0) {
    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).unusedInput.push(string);
  }

  if (config._a[_units_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] <= 12 && Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).bigHour === true && config._a[_units_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] > 0) {
    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).bigHour = undefined;
  }

  Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).parsedDateParts = config._a.slice(0);
  Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_8__["default"])(config).meridiem = config._meridiem;
  config._a[_units_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] = meridiemFixWrap(config._locale, config._a[_units_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]], config._meridiem);
  Object(_from_array__WEBPACK_IMPORTED_MODULE_1__["configFromArray"])(config);
  Object(_check_overflow__WEBPACK_IMPORTED_MODULE_5__["default"])(config);
}

function meridiemFixWrap(locale, hour, meridiem) {
  var isPm;

  if (meridiem == null) {
    return hour;
  }

  if (locale.meridiemHour != null) {
    return locale.meridiemHour(hour, meridiem);
  } else if (locale.isPM != null) {
    isPm = locale.isPM(meridiem);

    if (isPm && hour < 12) {
      hour += 12;
    }

    if (!isPm && hour === 12) {
      hour = 0;
    }

    return hour;
  } else {
    return hour;
  }
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/from-string.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/create/from-string.js ***!
  \***********************************************************/
/*! exports provided: configFromISO, configFromRFC2822, configFromString */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "configFromISO", function() { return configFromISO; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "configFromRFC2822", function() { return configFromRFC2822; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "configFromString", function() { return configFromString; });
/* harmony import */ var _from_string_and_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./from-string-and-format */ "./node_modules/moment/src/lib/create/from-string-and-format.js");
/* harmony import */ var _date_from_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./date-from-array */ "./node_modules/moment/src/lib/create/date-from-array.js");
/* harmony import */ var _from_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./from-array */ "./node_modules/moment/src/lib/create/from-array.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _utils_deprecate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/deprecate */ "./node_modules/moment/src/lib/utils/deprecate.js");
/* harmony import */ var _parsing_flags__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");
/* harmony import */ var _units_month__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../units/month */ "./node_modules/moment/src/lib/units/month.js");
/* harmony import */ var _units_day_of_week__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../units/day-of-week */ "./node_modules/moment/src/lib/units/day-of-week.js");








var extendedIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;
var basicIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;
var tzRegex = /Z|[+-]\d\d(?::?\d\d)?/;
var isoDates = [['YYYYYY-MM-DD', /[+-]\d{6}-\d\d-\d\d/], ['YYYY-MM-DD', /\d{4}-\d\d-\d\d/], ['GGGG-[W]WW-E', /\d{4}-W\d\d-\d/], ['GGGG-[W]WW', /\d{4}-W\d\d/, false], ['YYYY-DDD', /\d{4}-\d{3}/], ['YYYY-MM', /\d{4}-\d\d/, false], ['YYYYYYMMDD', /[+-]\d{10}/], ['YYYYMMDD', /\d{8}/], ['GGGG[W]WWE', /\d{4}W\d{3}/], ['GGGG[W]WW', /\d{4}W\d{2}/, false], ['YYYYDDD', /\d{7}/]];
var isoTimes = [['HH:mm:ss.SSSS', /\d\d:\d\d:\d\d\.\d+/], ['HH:mm:ss,SSSS', /\d\d:\d\d:\d\d,\d+/], ['HH:mm:ss', /\d\d:\d\d:\d\d/], ['HH:mm', /\d\d:\d\d/], ['HHmmss.SSSS', /\d\d\d\d\d\d\.\d+/], ['HHmmss,SSSS', /\d\d\d\d\d\d,\d+/], ['HHmmss', /\d\d\d\d\d\d/], ['HHmm', /\d\d\d\d/], ['HH', /\d\d/]];
var aspNetJsonRegex = /^\/?Date\((\-?\d+)/i;
function configFromISO(config) {
  var i,
      l,
      string = config._i,
      match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string),
      allowTime,
      dateFormat,
      timeFormat,
      tzFormat;

  if (match) {
    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_5__["default"])(config).iso = true;

    for (i = 0, l = isoDates.length; i < l; i++) {
      if (isoDates[i][1].exec(match[1])) {
        dateFormat = isoDates[i][0];
        allowTime = isoDates[i][2] !== false;
        break;
      }
    }

    if (dateFormat == null) {
      config._isValid = false;
      return;
    }

    if (match[3]) {
      for (i = 0, l = isoTimes.length; i < l; i++) {
        if (isoTimes[i][1].exec(match[3])) {
          timeFormat = (match[2] || ' ') + isoTimes[i][0];
          break;
        }
      }

      if (timeFormat == null) {
        config._isValid = false;
        return;
      }
    }

    if (!allowTime && timeFormat != null) {
      config._isValid = false;
      return;
    }

    if (match[4]) {
      if (tzRegex.exec(match[4])) {
        tzFormat = 'Z';
      } else {
        config._isValid = false;
        return;
      }
    }

    config._f = dateFormat + (timeFormat || '') + (tzFormat || '');
    Object(_from_string_and_format__WEBPACK_IMPORTED_MODULE_0__["configFromStringAndFormat"])(config);
  } else {
    config._isValid = false;
  }
}
var rfc2822 = /^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;

function extractFromRFC2822Strings(yearStr, monthStr, dayStr, hourStr, minuteStr, secondStr) {
  var result = [untruncateYear(yearStr), _units_month__WEBPACK_IMPORTED_MODULE_6__["defaultLocaleMonthsShort"].indexOf(monthStr), parseInt(dayStr, 10), parseInt(hourStr, 10), parseInt(minuteStr, 10)];

  if (secondStr) {
    result.push(parseInt(secondStr, 10));
  }

  return result;
}

function untruncateYear(yearStr) {
  var year = parseInt(yearStr, 10);

  if (year <= 49) {
    return 2000 + year;
  } else if (year <= 999) {
    return 1900 + year;
  }

  return year;
}

function preprocessRFC2822(s) {
  return s.replace(/\([^)]*\)|[\n\t]/g, ' ').replace(/(\s\s+)/g, ' ').replace(/^\s\s*/, '').replace(/\s\s*$/, '');
}

function checkWeekday(weekdayStr, parsedInput, config) {
  if (weekdayStr) {
    var weekdayProvided = _units_day_of_week__WEBPACK_IMPORTED_MODULE_7__["defaultLocaleWeekdaysShort"].indexOf(weekdayStr),
        weekdayActual = new Date(parsedInput[0], parsedInput[1], parsedInput[2]).getDay();

    if (weekdayProvided !== weekdayActual) {
      Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_5__["default"])(config).weekdayMismatch = true;
      config._isValid = false;
      return false;
    }
  }

  return true;
}

var obsOffsets = {
  UT: 0,
  GMT: 0,
  EDT: -4 * 60,
  EST: -5 * 60,
  CDT: -5 * 60,
  CST: -6 * 60,
  MDT: -6 * 60,
  MST: -7 * 60,
  PDT: -7 * 60,
  PST: -8 * 60
};

function calculateOffset(obsOffset, militaryOffset, numOffset) {
  if (obsOffset) {
    return obsOffsets[obsOffset];
  } else if (militaryOffset) {
    return 0;
  } else {
    var hm = parseInt(numOffset, 10);
    var m = hm % 100,
        h = (hm - m) / 100;
    return h * 60 + m;
  }
}

function configFromRFC2822(config) {
  var match = rfc2822.exec(preprocessRFC2822(config._i));

  if (match) {
    var parsedArray = extractFromRFC2822Strings(match[4], match[3], match[2], match[5], match[6], match[7]);

    if (!checkWeekday(match[1], parsedArray, config)) {
      return;
    }

    config._a = parsedArray;
    config._tzm = calculateOffset(match[8], match[9], match[10]);
    config._d = _date_from_array__WEBPACK_IMPORTED_MODULE_1__["createUTCDate"].apply(null, config._a);

    config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);

    Object(_parsing_flags__WEBPACK_IMPORTED_MODULE_5__["default"])(config).rfc2822 = true;
  } else {
    config._isValid = false;
  }
}
function configFromString(config) {
  var matched = aspNetJsonRegex.exec(config._i);

  if (matched !== null) {
    config._d = new Date(+matched[1]);
    return;
  }

  configFromISO(config);

  if (config._isValid === false) {
    delete config._isValid;
  } else {
    return;
  }

  configFromRFC2822(config);

  if (config._isValid === false) {
    delete config._isValid;
  } else {
    return;
  }

  _utils_hooks__WEBPACK_IMPORTED_MODULE_3__["hooks"].createFromInputFallback(config);
}
_utils_hooks__WEBPACK_IMPORTED_MODULE_3__["hooks"].createFromInputFallback = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_4__["deprecate"])('value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), ' + 'which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are ' + 'discouraged and will be removed in an upcoming major release. Please refer to ' + 'http://momentjs.com/guides/#/warnings/js-date/ for more info.', function (config) {
  config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));
});

/***/ }),

/***/ "./node_modules/moment/src/lib/create/local.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/create/local.js ***!
  \*****************************************************/
/*! exports provided: createLocal */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createLocal", function() { return createLocal; });
/* harmony import */ var _from_anything__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./from-anything */ "./node_modules/moment/src/lib/create/from-anything.js");

function createLocal(input, format, locale, strict) {
  return Object(_from_anything__WEBPACK_IMPORTED_MODULE_0__["createLocalOrUTC"])(input, format, locale, strict, false);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/parsing-flags.js":
/*!*************************************************************!*\
  !*** ./node_modules/moment/src/lib/create/parsing-flags.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getParsingFlags; });
function defaultParsingFlags() {
  return {
    empty: false,
    unusedTokens: [],
    unusedInput: [],
    overflow: -2,
    charsLeftOver: 0,
    nullInput: false,
    invalidMonth: null,
    invalidFormat: false,
    userInvalidated: false,
    iso: false,
    parsedDateParts: [],
    meridiem: null,
    rfc2822: false,
    weekdayMismatch: false
  };
}

function getParsingFlags(m) {
  if (m._pf == null) {
    m._pf = defaultParsingFlags();
  }

  return m._pf;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/utc.js":
/*!***************************************************!*\
  !*** ./node_modules/moment/src/lib/create/utc.js ***!
  \***************************************************/
/*! exports provided: createUTC */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUTC", function() { return createUTC; });
/* harmony import */ var _from_anything__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./from-anything */ "./node_modules/moment/src/lib/create/from-anything.js");

function createUTC(input, format, locale, strict) {
  return Object(_from_anything__WEBPACK_IMPORTED_MODULE_0__["createLocalOrUTC"])(input, format, locale, strict, true).utc();
}

/***/ }),

/***/ "./node_modules/moment/src/lib/create/valid.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/create/valid.js ***!
  \*****************************************************/
/*! exports provided: isValid, createInvalid */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isValid", function() { return isValid; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createInvalid", function() { return createInvalid; });
/* harmony import */ var _utils_extend__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/extend */ "./node_modules/moment/src/lib/utils/extend.js");
/* harmony import */ var _utc__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utc */ "./node_modules/moment/src/lib/create/utc.js");
/* harmony import */ var _create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");
/* harmony import */ var _utils_some__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/some */ "./node_modules/moment/src/lib/utils/some.js");




function isValid(m) {
  if (m._isValid == null) {
    var flags = Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(m);
    var parsedParts = _utils_some__WEBPACK_IMPORTED_MODULE_3__["default"].call(flags.parsedDateParts, function (i) {
      return i != null;
    });
    var isNowValid = !isNaN(m._d.getTime()) && flags.overflow < 0 && !flags.empty && !flags.invalidMonth && !flags.invalidWeekday && !flags.weekdayMismatch && !flags.nullInput && !flags.invalidFormat && !flags.userInvalidated && (!flags.meridiem || flags.meridiem && parsedParts);

    if (m._strict) {
      isNowValid = isNowValid && flags.charsLeftOver === 0 && flags.unusedTokens.length === 0 && flags.bigHour === undefined;
    }

    if (Object.isFrozen == null || !Object.isFrozen(m)) {
      m._isValid = isNowValid;
    } else {
      return isNowValid;
    }
  }

  return m._isValid;
}
function createInvalid(flags) {
  var m = Object(_utc__WEBPACK_IMPORTED_MODULE_1__["createUTC"])(NaN);

  if (flags != null) {
    Object(_utils_extend__WEBPACK_IMPORTED_MODULE_0__["default"])(Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(m), flags);
  } else {
    Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(m).userInvalidated = true;
  }

  return m;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/abs.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/abs.js ***!
  \*****************************************************/
/*! exports provided: abs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "abs", function() { return abs; });
var mathAbs = Math.abs;
function abs() {
  var data = this._data;
  this._milliseconds = mathAbs(this._milliseconds);
  this._days = mathAbs(this._days);
  this._months = mathAbs(this._months);
  data.milliseconds = mathAbs(data.milliseconds);
  data.seconds = mathAbs(data.seconds);
  data.minutes = mathAbs(data.minutes);
  data.hours = mathAbs(data.hours);
  data.months = mathAbs(data.months);
  data.years = mathAbs(data.years);
  return this;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/add-subtract.js":
/*!**************************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/add-subtract.js ***!
  \**************************************************************/
/*! exports provided: add, subtract */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "add", function() { return add; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subtract", function() { return subtract; });
/* harmony import */ var _create__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./create */ "./node_modules/moment/src/lib/duration/create.js");


function addSubtract(duration, input, value, direction) {
  var other = Object(_create__WEBPACK_IMPORTED_MODULE_0__["createDuration"])(input, value);
  duration._milliseconds += direction * other._milliseconds;
  duration._days += direction * other._days;
  duration._months += direction * other._months;
  return duration._bubble();
}

function add(input, value) {
  return addSubtract(this, input, value, 1);
}
function subtract(input, value) {
  return addSubtract(this, input, value, -1);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/as.js":
/*!****************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/as.js ***!
  \****************************************************/
/*! exports provided: as, valueOf, asMilliseconds, asSeconds, asMinutes, asHours, asDays, asWeeks, asMonths, asQuarters, asYears */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "as", function() { return as; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "valueOf", function() { return valueOf; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asMilliseconds", function() { return asMilliseconds; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asSeconds", function() { return asSeconds; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asMinutes", function() { return asMinutes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asHours", function() { return asHours; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asDays", function() { return asDays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asWeeks", function() { return asWeeks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asMonths", function() { return asMonths; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asQuarters", function() { return asQuarters; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asYears", function() { return asYears; });
/* harmony import */ var _bubble__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bubble */ "./node_modules/moment/src/lib/duration/bubble.js");
/* harmony import */ var _units_aliases__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../units/aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");



function as(units) {
  if (!this.isValid()) {
    return NaN;
  }

  var days;
  var months;
  var milliseconds = this._milliseconds;
  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_1__["normalizeUnits"])(units);

  if (units === 'month' || units === 'quarter' || units === 'year') {
    days = this._days + milliseconds / 864e5;
    months = this._months + Object(_bubble__WEBPACK_IMPORTED_MODULE_0__["daysToMonths"])(days);

    switch (units) {
      case 'month':
        return months;

      case 'quarter':
        return months / 3;

      case 'year':
        return months / 12;
    }
  } else {
    days = this._days + Math.round(Object(_bubble__WEBPACK_IMPORTED_MODULE_0__["monthsToDays"])(this._months));

    switch (units) {
      case 'week':
        return days / 7 + milliseconds / 6048e5;

      case 'day':
        return days + milliseconds / 864e5;

      case 'hour':
        return days * 24 + milliseconds / 36e5;

      case 'minute':
        return days * 1440 + milliseconds / 6e4;

      case 'second':
        return days * 86400 + milliseconds / 1000;

      case 'millisecond':
        return Math.floor(days * 864e5) + milliseconds;

      default:
        throw new Error('Unknown unit ' + units);
    }
  }
}
function valueOf() {
  if (!this.isValid()) {
    return NaN;
  }

  return this._milliseconds + this._days * 864e5 + this._months % 12 * 2592e6 + Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_2__["default"])(this._months / 12) * 31536e6;
}

function makeAs(alias) {
  return function () {
    return this.as(alias);
  };
}

var asMilliseconds = makeAs('ms');
var asSeconds = makeAs('s');
var asMinutes = makeAs('m');
var asHours = makeAs('h');
var asDays = makeAs('d');
var asWeeks = makeAs('w');
var asMonths = makeAs('M');
var asQuarters = makeAs('Q');
var asYears = makeAs('y');

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/bubble.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/bubble.js ***!
  \********************************************************/
/*! exports provided: bubble, daysToMonths, monthsToDays */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "bubble", function() { return bubble; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "daysToMonths", function() { return daysToMonths; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "monthsToDays", function() { return monthsToDays; });
/* harmony import */ var _utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/abs-floor */ "./node_modules/moment/src/lib/utils/abs-floor.js");
/* harmony import */ var _utils_abs_ceil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/abs-ceil */ "./node_modules/moment/src/lib/utils/abs-ceil.js");
/* harmony import */ var _create_date_from_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/date-from-array */ "./node_modules/moment/src/lib/create/date-from-array.js");



function bubble() {
  var milliseconds = this._milliseconds;
  var days = this._days;
  var months = this._months;
  var data = this._data;
  var seconds, minutes, hours, years, monthsFromDays;

  if (!(milliseconds >= 0 && days >= 0 && months >= 0 || milliseconds <= 0 && days <= 0 && months <= 0)) {
    milliseconds += Object(_utils_abs_ceil__WEBPACK_IMPORTED_MODULE_1__["default"])(monthsToDays(months) + days) * 864e5;
    days = 0;
    months = 0;
  }

  data.milliseconds = milliseconds % 1000;
  seconds = Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(milliseconds / 1000);
  data.seconds = seconds % 60;
  minutes = Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(seconds / 60);
  data.minutes = minutes % 60;
  hours = Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(minutes / 60);
  data.hours = hours % 24;
  days += Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(hours / 24);
  monthsFromDays = Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(daysToMonths(days));
  months += monthsFromDays;
  days -= Object(_utils_abs_ceil__WEBPACK_IMPORTED_MODULE_1__["default"])(monthsToDays(monthsFromDays));
  years = Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(months / 12);
  months %= 12;
  data.days = days;
  data.months = months;
  data.years = years;
  return this;
}
function daysToMonths(days) {
  return days * 4800 / 146097;
}
function monthsToDays(months) {
  return months * 146097 / 4800;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/clone.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/clone.js ***!
  \*******************************************************/
/*! exports provided: clone */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony import */ var _create__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./create */ "./node_modules/moment/src/lib/duration/create.js");

function clone() {
  return Object(_create__WEBPACK_IMPORTED_MODULE_0__["createDuration"])(this);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/constructor.js":
/*!*************************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/constructor.js ***!
  \*************************************************************/
/*! exports provided: Duration, isDuration */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Duration", function() { return Duration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isDuration", function() { return isDuration; });
/* harmony import */ var _units_aliases__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../units/aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _locale_locales__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../locale/locales */ "./node_modules/moment/src/lib/locale/locales.js");
/* harmony import */ var _valid_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./valid.js */ "./node_modules/moment/src/lib/duration/valid.js");



function Duration(duration) {
  var normalizedInput = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_0__["normalizeObjectUnits"])(duration),
      years = normalizedInput.year || 0,
      quarters = normalizedInput.quarter || 0,
      months = normalizedInput.month || 0,
      weeks = normalizedInput.week || normalizedInput.isoWeek || 0,
      days = normalizedInput.day || 0,
      hours = normalizedInput.hour || 0,
      minutes = normalizedInput.minute || 0,
      seconds = normalizedInput.second || 0,
      milliseconds = normalizedInput.millisecond || 0;
  this._isValid = Object(_valid_js__WEBPACK_IMPORTED_MODULE_2__["default"])(normalizedInput);
  this._milliseconds = +milliseconds + seconds * 1e3 + minutes * 6e4 + hours * 1000 * 60 * 60;
  this._days = +days + weeks * 7;
  this._months = +months + quarters * 3 + years * 12;
  this._data = {};
  this._locale = Object(_locale_locales__WEBPACK_IMPORTED_MODULE_1__["getLocale"])();

  this._bubble();
}
function isDuration(obj) {
  return obj instanceof Duration;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/create.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/create.js ***!
  \********************************************************/
/*! exports provided: createDuration */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createDuration", function() { return createDuration; });
/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/duration/constructor.js");
/* harmony import */ var _utils_is_number__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/is-number */ "./node_modules/moment/src/lib/utils/is-number.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");
/* harmony import */ var _utils_abs_round__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/abs-round */ "./node_modules/moment/src/lib/utils/abs-round.js");
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");
/* harmony import */ var _units_constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../units/constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _units_offset__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../units/offset */ "./node_modules/moment/src/lib/units/offset.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _valid__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./valid */ "./node_modules/moment/src/lib/duration/valid.js");









var aspNetRegex = /^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;
var isoRegex = /^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;
function createDuration(input, key) {
  var duration = input,
      match = null,
      sign,
      ret,
      diffRes;

  if (Object(_constructor__WEBPACK_IMPORTED_MODULE_0__["isDuration"])(input)) {
    duration = {
      ms: input._milliseconds,
      d: input._days,
      M: input._months
    };
  } else if (Object(_utils_is_number__WEBPACK_IMPORTED_MODULE_1__["default"])(input)) {
    duration = {};

    if (key) {
      duration[key] = input;
    } else {
      duration.milliseconds = input;
    }
  } else if (!!(match = aspNetRegex.exec(input))) {
    sign = match[1] === '-' ? -1 : 1;
    duration = {
      y: 0,
      d: Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_2__["default"])(match[_units_constants__WEBPACK_IMPORTED_MODULE_5__["DATE"]]) * sign,
      h: Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_2__["default"])(match[_units_constants__WEBPACK_IMPORTED_MODULE_5__["HOUR"]]) * sign,
      m: Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_2__["default"])(match[_units_constants__WEBPACK_IMPORTED_MODULE_5__["MINUTE"]]) * sign,
      s: Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_2__["default"])(match[_units_constants__WEBPACK_IMPORTED_MODULE_5__["SECOND"]]) * sign,
      ms: Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_2__["default"])(Object(_utils_abs_round__WEBPACK_IMPORTED_MODULE_3__["default"])(match[_units_constants__WEBPACK_IMPORTED_MODULE_5__["MILLISECOND"]] * 1000)) * sign
    };
  } else if (!!(match = isoRegex.exec(input))) {
    sign = match[1] === '-' ? -1 : 1;
    duration = {
      y: parseIso(match[2], sign),
      M: parseIso(match[3], sign),
      w: parseIso(match[4], sign),
      d: parseIso(match[5], sign),
      h: parseIso(match[6], sign),
      m: parseIso(match[7], sign),
      s: parseIso(match[8], sign)
    };
  } else if (duration == null) {
    duration = {};
  } else if (typeof duration === 'object' && ('from' in duration || 'to' in duration)) {
    diffRes = momentsDifference(Object(_create_local__WEBPACK_IMPORTED_MODULE_7__["createLocal"])(duration.from), Object(_create_local__WEBPACK_IMPORTED_MODULE_7__["createLocal"])(duration.to));
    duration = {};
    duration.ms = diffRes.milliseconds;
    duration.M = diffRes.months;
  }

  ret = new _constructor__WEBPACK_IMPORTED_MODULE_0__["Duration"](duration);

  if (Object(_constructor__WEBPACK_IMPORTED_MODULE_0__["isDuration"])(input) && Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_4__["default"])(input, '_locale')) {
    ret._locale = input._locale;
  }

  return ret;
}
createDuration.fn = _constructor__WEBPACK_IMPORTED_MODULE_0__["Duration"].prototype;
createDuration.invalid = _valid__WEBPACK_IMPORTED_MODULE_8__["createInvalid"];

function parseIso(inp, sign) {
  var res = inp && parseFloat(inp.replace(',', '.'));
  return (isNaN(res) ? 0 : res) * sign;
}

function positiveMomentsDifference(base, other) {
  var res = {};
  res.months = other.month() - base.month() + (other.year() - base.year()) * 12;

  if (base.clone().add(res.months, 'M').isAfter(other)) {
    --res.months;
  }

  res.milliseconds = +other - +base.clone().add(res.months, 'M');
  return res;
}

function momentsDifference(base, other) {
  var res;

  if (!(base.isValid() && other.isValid())) {
    return {
      milliseconds: 0,
      months: 0
    };
  }

  other = Object(_units_offset__WEBPACK_IMPORTED_MODULE_6__["cloneWithOffset"])(other, base);

  if (base.isBefore(other)) {
    res = positiveMomentsDifference(base, other);
  } else {
    res = positiveMomentsDifference(other, base);
    res.milliseconds = -res.milliseconds;
    res.months = -res.months;
  }

  return res;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/duration.js":
/*!**********************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/duration.js ***!
  \**********************************************************/
/*! exports provided: createDuration, isDuration, getSetRelativeTimeRounding, getSetRelativeTimeThreshold */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _prototype__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prototype */ "./node_modules/moment/src/lib/duration/prototype.js");
/* harmony import */ var _create__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./create */ "./node_modules/moment/src/lib/duration/create.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createDuration", function() { return _create__WEBPACK_IMPORTED_MODULE_1__["createDuration"]; });

/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/duration/constructor.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isDuration", function() { return _constructor__WEBPACK_IMPORTED_MODULE_2__["isDuration"]; });

/* harmony import */ var _humanize__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./humanize */ "./node_modules/moment/src/lib/duration/humanize.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getSetRelativeTimeRounding", function() { return _humanize__WEBPACK_IMPORTED_MODULE_3__["getSetRelativeTimeRounding"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getSetRelativeTimeThreshold", function() { return _humanize__WEBPACK_IMPORTED_MODULE_3__["getSetRelativeTimeThreshold"]; });







/***/ }),

/***/ "./node_modules/moment/src/lib/duration/get.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/get.js ***!
  \*****************************************************/
/*! exports provided: get, milliseconds, seconds, minutes, hours, days, months, years, weeks */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "get", function() { return get; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "milliseconds", function() { return milliseconds; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "seconds", function() { return seconds; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "minutes", function() { return minutes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hours", function() { return hours; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "days", function() { return days; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "months", function() { return months; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "years", function() { return years; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "weeks", function() { return weeks; });
/* harmony import */ var _units_aliases__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../units/aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _utils_abs_floor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/abs-floor */ "./node_modules/moment/src/lib/utils/abs-floor.js");


function get(units) {
  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_0__["normalizeUnits"])(units);
  return this.isValid() ? this[units + 's']() : NaN;
}

function makeGetter(name) {
  return function () {
    return this.isValid() ? this._data[name] : NaN;
  };
}

var milliseconds = makeGetter('milliseconds');
var seconds = makeGetter('seconds');
var minutes = makeGetter('minutes');
var hours = makeGetter('hours');
var days = makeGetter('days');
var months = makeGetter('months');
var years = makeGetter('years');
function weeks() {
  return Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_1__["default"])(this.days() / 7);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/humanize.js":
/*!**********************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/humanize.js ***!
  \**********************************************************/
/*! exports provided: getSetRelativeTimeRounding, getSetRelativeTimeThreshold, humanize */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetRelativeTimeRounding", function() { return getSetRelativeTimeRounding; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetRelativeTimeThreshold", function() { return getSetRelativeTimeThreshold; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "humanize", function() { return humanize; });
/* harmony import */ var _create__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./create */ "./node_modules/moment/src/lib/duration/create.js");

var round = Math.round;
var thresholds = {
  ss: 44,
  s: 45,
  m: 45,
  h: 22,
  d: 26,
  M: 11
};

function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {
  return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);
}

function relativeTime(posNegDuration, withoutSuffix, locale) {
  var duration = Object(_create__WEBPACK_IMPORTED_MODULE_0__["createDuration"])(posNegDuration).abs();
  var seconds = round(duration.as('s'));
  var minutes = round(duration.as('m'));
  var hours = round(duration.as('h'));
  var days = round(duration.as('d'));
  var months = round(duration.as('M'));
  var years = round(duration.as('y'));
  var a = seconds <= thresholds.ss && ['s', seconds] || seconds < thresholds.s && ['ss', seconds] || minutes <= 1 && ['m'] || minutes < thresholds.m && ['mm', minutes] || hours <= 1 && ['h'] || hours < thresholds.h && ['hh', hours] || days <= 1 && ['d'] || days < thresholds.d && ['dd', days] || months <= 1 && ['M'] || months < thresholds.M && ['MM', months] || years <= 1 && ['y'] || ['yy', years];
  a[2] = withoutSuffix;
  a[3] = +posNegDuration > 0;
  a[4] = locale;
  return substituteTimeAgo.apply(null, a);
}

function getSetRelativeTimeRounding(roundingFunction) {
  if (roundingFunction === undefined) {
    return round;
  }

  if (typeof roundingFunction === 'function') {
    round = roundingFunction;
    return true;
  }

  return false;
}
function getSetRelativeTimeThreshold(threshold, limit) {
  if (thresholds[threshold] === undefined) {
    return false;
  }

  if (limit === undefined) {
    return thresholds[threshold];
  }

  thresholds[threshold] = limit;

  if (threshold === 's') {
    thresholds.ss = limit - 1;
  }

  return true;
}
function humanize(withSuffix) {
  if (!this.isValid()) {
    return this.localeData().invalidDate();
  }

  var locale = this.localeData();
  var output = relativeTime(this, !withSuffix, locale);

  if (withSuffix) {
    output = locale.pastFuture(+this, output);
  }

  return locale.postformat(output);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/iso-string.js":
/*!************************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/iso-string.js ***!
  \************************************************************/
/*! exports provided: toISOString */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toISOString", function() { return toISOString; });
/* harmony import */ var _utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/abs-floor */ "./node_modules/moment/src/lib/utils/abs-floor.js");

var abs = Math.abs;

function sign(x) {
  return (x > 0) - (x < 0) || +x;
}

function toISOString() {
  if (!this.isValid()) {
    return this.localeData().invalidDate();
  }

  var seconds = abs(this._milliseconds) / 1000;
  var days = abs(this._days);
  var months = abs(this._months);
  var minutes, hours, years;
  minutes = Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(seconds / 60);
  hours = Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(minutes / 60);
  seconds %= 60;
  minutes %= 60;
  years = Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(months / 12);
  months %= 12;
  var Y = years;
  var M = months;
  var D = days;
  var h = hours;
  var m = minutes;
  var s = seconds ? seconds.toFixed(3).replace(/\.?0+$/, '') : '';
  var total = this.asSeconds();

  if (!total) {
    return 'P0D';
  }

  var totalSign = total < 0 ? '-' : '';
  var ymSign = sign(this._months) !== sign(total) ? '-' : '';
  var daysSign = sign(this._days) !== sign(total) ? '-' : '';
  var hmsSign = sign(this._milliseconds) !== sign(total) ? '-' : '';
  return totalSign + 'P' + (Y ? ymSign + Y + 'Y' : '') + (M ? ymSign + M + 'M' : '') + (D ? daysSign + D + 'D' : '') + (h || m || s ? 'T' : '') + (h ? hmsSign + h + 'H' : '') + (m ? hmsSign + m + 'M' : '') + (s ? hmsSign + s + 'S' : '');
}

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/prototype.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/prototype.js ***!
  \***********************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/duration/constructor.js");
/* harmony import */ var _abs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./abs */ "./node_modules/moment/src/lib/duration/abs.js");
/* harmony import */ var _add_subtract__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./add-subtract */ "./node_modules/moment/src/lib/duration/add-subtract.js");
/* harmony import */ var _as__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./as */ "./node_modules/moment/src/lib/duration/as.js");
/* harmony import */ var _bubble__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./bubble */ "./node_modules/moment/src/lib/duration/bubble.js");
/* harmony import */ var _clone__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./clone */ "./node_modules/moment/src/lib/duration/clone.js");
/* harmony import */ var _get__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./get */ "./node_modules/moment/src/lib/duration/get.js");
/* harmony import */ var _humanize__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./humanize */ "./node_modules/moment/src/lib/duration/humanize.js");
/* harmony import */ var _iso_string__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./iso-string */ "./node_modules/moment/src/lib/duration/iso-string.js");
/* harmony import */ var _moment_locale__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../moment/locale */ "./node_modules/moment/src/lib/moment/locale.js");
/* harmony import */ var _valid__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./valid */ "./node_modules/moment/src/lib/duration/valid.js");
/* harmony import */ var _utils_deprecate__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../utils/deprecate */ "./node_modules/moment/src/lib/utils/deprecate.js");

var proto = _constructor__WEBPACK_IMPORTED_MODULE_0__["Duration"].prototype;










proto.isValid = _valid__WEBPACK_IMPORTED_MODULE_10__["isValid"];
proto.abs = _abs__WEBPACK_IMPORTED_MODULE_1__["abs"];
proto.add = _add_subtract__WEBPACK_IMPORTED_MODULE_2__["add"];
proto.subtract = _add_subtract__WEBPACK_IMPORTED_MODULE_2__["subtract"];
proto.as = _as__WEBPACK_IMPORTED_MODULE_3__["as"];
proto.asMilliseconds = _as__WEBPACK_IMPORTED_MODULE_3__["asMilliseconds"];
proto.asSeconds = _as__WEBPACK_IMPORTED_MODULE_3__["asSeconds"];
proto.asMinutes = _as__WEBPACK_IMPORTED_MODULE_3__["asMinutes"];
proto.asHours = _as__WEBPACK_IMPORTED_MODULE_3__["asHours"];
proto.asDays = _as__WEBPACK_IMPORTED_MODULE_3__["asDays"];
proto.asWeeks = _as__WEBPACK_IMPORTED_MODULE_3__["asWeeks"];
proto.asMonths = _as__WEBPACK_IMPORTED_MODULE_3__["asMonths"];
proto.asQuarters = _as__WEBPACK_IMPORTED_MODULE_3__["asQuarters"];
proto.asYears = _as__WEBPACK_IMPORTED_MODULE_3__["asYears"];
proto.valueOf = _as__WEBPACK_IMPORTED_MODULE_3__["valueOf"];
proto._bubble = _bubble__WEBPACK_IMPORTED_MODULE_4__["bubble"];
proto.clone = _clone__WEBPACK_IMPORTED_MODULE_5__["clone"];
proto.get = _get__WEBPACK_IMPORTED_MODULE_6__["get"];
proto.milliseconds = _get__WEBPACK_IMPORTED_MODULE_6__["milliseconds"];
proto.seconds = _get__WEBPACK_IMPORTED_MODULE_6__["seconds"];
proto.minutes = _get__WEBPACK_IMPORTED_MODULE_6__["minutes"];
proto.hours = _get__WEBPACK_IMPORTED_MODULE_6__["hours"];
proto.days = _get__WEBPACK_IMPORTED_MODULE_6__["days"];
proto.weeks = _get__WEBPACK_IMPORTED_MODULE_6__["weeks"];
proto.months = _get__WEBPACK_IMPORTED_MODULE_6__["months"];
proto.years = _get__WEBPACK_IMPORTED_MODULE_6__["years"];
proto.humanize = _humanize__WEBPACK_IMPORTED_MODULE_7__["humanize"];
proto.toISOString = _iso_string__WEBPACK_IMPORTED_MODULE_8__["toISOString"];
proto.toString = _iso_string__WEBPACK_IMPORTED_MODULE_8__["toISOString"];
proto.toJSON = _iso_string__WEBPACK_IMPORTED_MODULE_8__["toISOString"];
proto.locale = _moment_locale__WEBPACK_IMPORTED_MODULE_9__["locale"];
proto.localeData = _moment_locale__WEBPACK_IMPORTED_MODULE_9__["localeData"];

proto.toIsoString = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_11__["deprecate"])('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)', _iso_string__WEBPACK_IMPORTED_MODULE_8__["toISOString"]);
proto.lang = _moment_locale__WEBPACK_IMPORTED_MODULE_9__["lang"];

/***/ }),

/***/ "./node_modules/moment/src/lib/duration/valid.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/duration/valid.js ***!
  \*******************************************************/
/*! exports provided: default, isValid, createInvalid */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return isDurationValid; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isValid", function() { return isValid; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createInvalid", function() { return createInvalid; });
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");
/* harmony import */ var _utils_index_of__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/index-of */ "./node_modules/moment/src/lib/utils/index-of.js");
/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/duration/constructor.js");
/* harmony import */ var _create__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./create */ "./node_modules/moment/src/lib/duration/create.js");




var ordering = ['year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second', 'millisecond'];
function isDurationValid(m) {
  for (var key in m) {
    if (!(_utils_index_of__WEBPACK_IMPORTED_MODULE_1__["default"].call(ordering, key) !== -1 && (m[key] == null || !isNaN(m[key])))) {
      return false;
    }
  }

  var unitHasDecimal = false;

  for (var i = 0; i < ordering.length; ++i) {
    if (m[ordering[i]]) {
      if (unitHasDecimal) {
        return false;
      }

      if (parseFloat(m[ordering[i]]) !== Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_0__["default"])(m[ordering[i]])) {
        unitHasDecimal = true;
      }
    }
  }

  return true;
}
function isValid() {
  return this._isValid;
}
function createInvalid() {
  return Object(_create__WEBPACK_IMPORTED_MODULE_3__["createDuration"])(NaN);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/format/format.js":
/*!******************************************************!*\
  !*** ./node_modules/moment/src/lib/format/format.js ***!
  \******************************************************/
/*! exports provided: formattingTokens, formatTokenFunctions, addFormatToken, formatMoment, expandFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "formattingTokens", function() { return formattingTokens; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "formatTokenFunctions", function() { return formatTokenFunctions; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addFormatToken", function() { return addFormatToken; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "formatMoment", function() { return formatMoment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "expandFormat", function() { return expandFormat; });
/* harmony import */ var _utils_zero_fill__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/zero-fill */ "./node_modules/moment/src/lib/utils/zero-fill.js");
/* harmony import */ var _utils_is_function__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/is-function */ "./node_modules/moment/src/lib/utils/is-function.js");


var formattingTokens = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;
var localFormattingTokens = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;
var formatFunctions = {};
var formatTokenFunctions = {};
function addFormatToken(token, padded, ordinal, callback) {
  var func = callback;

  if (typeof callback === 'string') {
    func = function func() {
      return this[callback]();
    };
  }

  if (token) {
    formatTokenFunctions[token] = func;
  }

  if (padded) {
    formatTokenFunctions[padded[0]] = function () {
      return Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_0__["default"])(func.apply(this, arguments), padded[1], padded[2]);
    };
  }

  if (ordinal) {
    formatTokenFunctions[ordinal] = function () {
      return this.localeData().ordinal(func.apply(this, arguments), token);
    };
  }
}

function removeFormattingTokens(input) {
  if (input.match(/\[[\s\S]/)) {
    return input.replace(/^\[|\]$/g, '');
  }

  return input.replace(/\\/g, '');
}

function makeFormatFunction(format) {
  var array = format.match(formattingTokens),
      i,
      length;

  for (i = 0, length = array.length; i < length; i++) {
    if (formatTokenFunctions[array[i]]) {
      array[i] = formatTokenFunctions[array[i]];
    } else {
      array[i] = removeFormattingTokens(array[i]);
    }
  }

  return function (mom) {
    var output = '',
        i;

    for (i = 0; i < length; i++) {
      output += Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_1__["default"])(array[i]) ? array[i].call(mom, format) : array[i];
    }

    return output;
  };
}

function formatMoment(m, format) {
  if (!m.isValid()) {
    return m.localeData().invalidDate();
  }

  format = expandFormat(format, m.localeData());
  formatFunctions[format] = formatFunctions[format] || makeFormatFunction(format);
  return formatFunctions[format](m);
}
function expandFormat(format, locale) {
  var i = 5;

  function replaceLongDateFormatTokens(input) {
    return locale.longDateFormat(input) || input;
  }

  localFormattingTokens.lastIndex = 0;

  while (i >= 0 && localFormattingTokens.test(format)) {
    format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);
    localFormattingTokens.lastIndex = 0;
    i -= 1;
  }

  return format;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/base-config.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/base-config.js ***!
  \***********************************************************/
/*! exports provided: baseConfig */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "baseConfig", function() { return baseConfig; });
/* harmony import */ var _calendar__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendar */ "./node_modules/moment/src/lib/locale/calendar.js");
/* harmony import */ var _formats__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./formats */ "./node_modules/moment/src/lib/locale/formats.js");
/* harmony import */ var _invalid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./invalid */ "./node_modules/moment/src/lib/locale/invalid.js");
/* harmony import */ var _ordinal__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ordinal */ "./node_modules/moment/src/lib/locale/ordinal.js");
/* harmony import */ var _relative__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./relative */ "./node_modules/moment/src/lib/locale/relative.js");
/* harmony import */ var _units_month__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../units/month */ "./node_modules/moment/src/lib/units/month.js");
/* harmony import */ var _units_week__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../units/week */ "./node_modules/moment/src/lib/units/week.js");
/* harmony import */ var _units_day_of_week__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../units/day-of-week */ "./node_modules/moment/src/lib/units/day-of-week.js");
/* harmony import */ var _units_hour__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../units/hour */ "./node_modules/moment/src/lib/units/hour.js");









var baseConfig = {
  calendar: _calendar__WEBPACK_IMPORTED_MODULE_0__["defaultCalendar"],
  longDateFormat: _formats__WEBPACK_IMPORTED_MODULE_1__["defaultLongDateFormat"],
  invalidDate: _invalid__WEBPACK_IMPORTED_MODULE_2__["defaultInvalidDate"],
  ordinal: _ordinal__WEBPACK_IMPORTED_MODULE_3__["defaultOrdinal"],
  dayOfMonthOrdinalParse: _ordinal__WEBPACK_IMPORTED_MODULE_3__["defaultDayOfMonthOrdinalParse"],
  relativeTime: _relative__WEBPACK_IMPORTED_MODULE_4__["defaultRelativeTime"],
  months: _units_month__WEBPACK_IMPORTED_MODULE_5__["defaultLocaleMonths"],
  monthsShort: _units_month__WEBPACK_IMPORTED_MODULE_5__["defaultLocaleMonthsShort"],
  week: _units_week__WEBPACK_IMPORTED_MODULE_6__["defaultLocaleWeek"],
  weekdays: _units_day_of_week__WEBPACK_IMPORTED_MODULE_7__["defaultLocaleWeekdays"],
  weekdaysMin: _units_day_of_week__WEBPACK_IMPORTED_MODULE_7__["defaultLocaleWeekdaysMin"],
  weekdaysShort: _units_day_of_week__WEBPACK_IMPORTED_MODULE_7__["defaultLocaleWeekdaysShort"],
  meridiemParse: _units_hour__WEBPACK_IMPORTED_MODULE_8__["defaultLocaleMeridiemParse"]
};

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/calendar.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/calendar.js ***!
  \********************************************************/
/*! exports provided: defaultCalendar, calendar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultCalendar", function() { return defaultCalendar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "calendar", function() { return calendar; });
/* harmony import */ var _utils_is_function__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/is-function */ "./node_modules/moment/src/lib/utils/is-function.js");
var defaultCalendar = {
  sameDay: '[Today at] LT',
  nextDay: '[Tomorrow at] LT',
  nextWeek: 'dddd [at] LT',
  lastDay: '[Yesterday at] LT',
  lastWeek: '[Last] dddd [at] LT',
  sameElse: 'L'
};

function calendar(key, mom, now) {
  var output = this._calendar[key] || this._calendar['sameElse'];
  return Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_0__["default"])(output) ? output.call(mom, now) : output;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/constructor.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/constructor.js ***!
  \***********************************************************/
/*! exports provided: Locale */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Locale", function() { return Locale; });
function Locale(config) {
  if (config != null) {
    this.set(config);
  }
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/en.js":
/*!**************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/en.js ***!
  \**************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _prototype__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prototype */ "./node_modules/moment/src/lib/locale/prototype.js");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locales */ "./node_modules/moment/src/lib/locale/locales.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");



Object(_locales__WEBPACK_IMPORTED_MODULE_1__["getSetGlobalLocale"])('en', {
  dayOfMonthOrdinalParse: /\d{1,2}(th|st|nd|rd)/,
  ordinal: function ordinal(number) {
    var b = number % 10,
        output = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_2__["default"])(number % 100 / 10) === 1 ? 'th' : b === 1 ? 'st' : b === 2 ? 'nd' : b === 3 ? 'rd' : 'th';
    return number + output;
  }
});

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/formats.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/formats.js ***!
  \*******************************************************/
/*! exports provided: defaultLongDateFormat, longDateFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultLongDateFormat", function() { return defaultLongDateFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "longDateFormat", function() { return longDateFormat; });
var defaultLongDateFormat = {
  LTS: 'h:mm:ss A',
  LT: 'h:mm A',
  L: 'MM/DD/YYYY',
  LL: 'MMMM D, YYYY',
  LLL: 'MMMM D, YYYY h:mm A',
  LLLL: 'dddd, MMMM D, YYYY h:mm A'
};
function longDateFormat(key) {
  var format = this._longDateFormat[key],
      formatUpper = this._longDateFormat[key.toUpperCase()];

  if (format || !formatUpper) {
    return format;
  }

  this._longDateFormat[key] = formatUpper.replace(/MMMM|MM|DD|dddd/g, function (val) {
    return val.slice(1);
  });
  return this._longDateFormat[key];
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/invalid.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/invalid.js ***!
  \*******************************************************/
/*! exports provided: defaultInvalidDate, invalidDate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultInvalidDate", function() { return defaultInvalidDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "invalidDate", function() { return invalidDate; });
var defaultInvalidDate = 'Invalid date';
function invalidDate() {
  return this._invalidDate;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/lists.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/lists.js ***!
  \*****************************************************/
/*! exports provided: listMonths, listMonthsShort, listWeekdays, listWeekdaysShort, listWeekdaysMin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "listMonths", function() { return listMonths; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "listMonthsShort", function() { return listMonthsShort; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "listWeekdays", function() { return listWeekdays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "listWeekdaysShort", function() { return listWeekdaysShort; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "listWeekdaysMin", function() { return listWeekdaysMin; });
/* harmony import */ var _utils_is_number__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/is-number */ "./node_modules/moment/src/lib/utils/is-number.js");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locales */ "./node_modules/moment/src/lib/locale/locales.js");
/* harmony import */ var _create_utc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/utc */ "./node_modules/moment/src/lib/create/utc.js");




function get(format, index, field, setter) {
  var locale = Object(_locales__WEBPACK_IMPORTED_MODULE_1__["getLocale"])();
  var utc = Object(_create_utc__WEBPACK_IMPORTED_MODULE_2__["createUTC"])().set(setter, index);
  return locale[field](utc, format);
}

function listMonthsImpl(format, index, field) {
  if (Object(_utils_is_number__WEBPACK_IMPORTED_MODULE_0__["default"])(format)) {
    index = format;
    format = undefined;
  }

  format = format || '';

  if (index != null) {
    return get(format, index, field, 'month');
  }

  var i;
  var out = [];

  for (i = 0; i < 12; i++) {
    out[i] = get(format, i, field, 'month');
  }

  return out;
}

function listWeekdaysImpl(localeSorted, format, index, field) {
  if (typeof localeSorted === 'boolean') {
    if (Object(_utils_is_number__WEBPACK_IMPORTED_MODULE_0__["default"])(format)) {
      index = format;
      format = undefined;
    }

    format = format || '';
  } else {
    format = localeSorted;
    index = format;
    localeSorted = false;

    if (Object(_utils_is_number__WEBPACK_IMPORTED_MODULE_0__["default"])(format)) {
      index = format;
      format = undefined;
    }

    format = format || '';
  }

  var locale = Object(_locales__WEBPACK_IMPORTED_MODULE_1__["getLocale"])(),
      shift = localeSorted ? locale._week.dow : 0;

  if (index != null) {
    return get(format, (index + shift) % 7, field, 'day');
  }

  var i;
  var out = [];

  for (i = 0; i < 7; i++) {
    out[i] = get(format, (i + shift) % 7, field, 'day');
  }

  return out;
}

function listMonths(format, index) {
  return listMonthsImpl(format, index, 'months');
}
function listMonthsShort(format, index) {
  return listMonthsImpl(format, index, 'monthsShort');
}
function listWeekdays(localeSorted, format, index) {
  return listWeekdaysImpl(localeSorted, format, index, 'weekdays');
}
function listWeekdaysShort(localeSorted, format, index) {
  return listWeekdaysImpl(localeSorted, format, index, 'weekdaysShort');
}
function listWeekdaysMin(localeSorted, format, index) {
  return listWeekdaysImpl(localeSorted, format, index, 'weekdaysMin');
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/locale.js":
/*!******************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/locale.js ***!
  \******************************************************/
/*! exports provided: getSetGlobalLocale, defineLocale, updateLocale, getLocale, listLocales, listMonths, listMonthsShort, listWeekdays, listWeekdaysShort, listWeekdaysMin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _prototype__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prototype */ "./node_modules/moment/src/lib/locale/prototype.js");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locales */ "./node_modules/moment/src/lib/locale/locales.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getSetGlobalLocale", function() { return _locales__WEBPACK_IMPORTED_MODULE_1__["getSetGlobalLocale"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "defineLocale", function() { return _locales__WEBPACK_IMPORTED_MODULE_1__["defineLocale"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateLocale", function() { return _locales__WEBPACK_IMPORTED_MODULE_1__["updateLocale"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getLocale", function() { return _locales__WEBPACK_IMPORTED_MODULE_1__["getLocale"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "listLocales", function() { return _locales__WEBPACK_IMPORTED_MODULE_1__["listLocales"]; });

/* harmony import */ var _lists__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lists */ "./node_modules/moment/src/lib/locale/lists.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "listMonths", function() { return _lists__WEBPACK_IMPORTED_MODULE_2__["listMonths"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "listMonthsShort", function() { return _lists__WEBPACK_IMPORTED_MODULE_2__["listMonthsShort"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "listWeekdays", function() { return _lists__WEBPACK_IMPORTED_MODULE_2__["listWeekdays"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "listWeekdaysShort", function() { return _lists__WEBPACK_IMPORTED_MODULE_2__["listWeekdaysShort"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "listWeekdaysMin", function() { return _lists__WEBPACK_IMPORTED_MODULE_2__["listWeekdaysMin"]; });

/* harmony import */ var _utils_deprecate__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/deprecate */ "./node_modules/moment/src/lib/utils/deprecate.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _en__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./en */ "./node_modules/moment/src/lib/locale/en.js");






_utils_hooks__WEBPACK_IMPORTED_MODULE_4__["hooks"].lang = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_3__["deprecate"])('moment.lang is deprecated. Use moment.locale instead.', _locales__WEBPACK_IMPORTED_MODULE_1__["getSetGlobalLocale"]);
_utils_hooks__WEBPACK_IMPORTED_MODULE_4__["hooks"].langData = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_3__["deprecate"])('moment.langData is deprecated. Use moment.localeData instead.', _locales__WEBPACK_IMPORTED_MODULE_1__["getLocale"]);


/***/ }),

/***/ "./node_modules/moment/src/lib/locale/locales.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/locales.js ***!
  \*******************************************************/
/*! exports provided: getSetGlobalLocale, defineLocale, updateLocale, getLocale, listLocales */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(module) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetGlobalLocale", function() { return getSetGlobalLocale; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defineLocale", function() { return defineLocale; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateLocale", function() { return updateLocale; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getLocale", function() { return getLocale; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "listLocales", function() { return listLocales; });
/* harmony import */ var _utils_is_array__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/is-array */ "./node_modules/moment/src/lib/utils/is-array.js");
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");
/* harmony import */ var _utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/is-undefined */ "./node_modules/moment/src/lib/utils/is-undefined.js");
/* harmony import */ var _utils_compare_arrays__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/compare-arrays */ "./node_modules/moment/src/lib/utils/compare-arrays.js");
/* harmony import */ var _utils_deprecate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/deprecate */ "./node_modules/moment/src/lib/utils/deprecate.js");
/* harmony import */ var _set__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./set */ "./node_modules/moment/src/lib/locale/set.js");
/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/locale/constructor.js");
/* harmony import */ var _utils_keys__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/keys */ "./node_modules/moment/src/lib/utils/keys.js");
/* harmony import */ var _base_config__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./base-config */ "./node_modules/moment/src/lib/locale/base-config.js");
var require;








var locales = {};
var localeFamilies = {};
var globalLocale;

function normalizeLocale(key) {
  return key ? key.toLowerCase().replace('_', '-') : key;
}

function chooseLocale(names) {
  var i = 0,
      j,
      next,
      locale,
      split;

  while (i < names.length) {
    split = normalizeLocale(names[i]).split('-');
    j = split.length;
    next = normalizeLocale(names[i + 1]);
    next = next ? next.split('-') : null;

    while (j > 0) {
      locale = loadLocale(split.slice(0, j).join('-'));

      if (locale) {
        return locale;
      }

      if (next && next.length >= j && Object(_utils_compare_arrays__WEBPACK_IMPORTED_MODULE_3__["default"])(split, next, true) >= j - 1) {
        break;
      }

      j--;
    }

    i++;
  }

  return globalLocale;
}

function loadLocale(name) {
  var oldLocale = null;

  if (!locales[name] && typeof module !== 'undefined' && module && module.exports) {
    try {
      oldLocale = globalLocale._abbr;
      var aliasedRequire = require;
      !(function webpackMissingModule() { var e = new Error("Cannot find module 'undefined'"); e.code = 'MODULE_NOT_FOUND'; throw e; }());
      getSetGlobalLocale(oldLocale);
    } catch (e) {}
  }

  return locales[name];
}

function getSetGlobalLocale(key, values) {
  var data;

  if (key) {
    if (Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(values)) {
      data = getLocale(key);
    } else {
      data = defineLocale(key, values);
    }

    if (data) {
      globalLocale = data;
    } else {
      if (typeof console !== 'undefined' && console.warn) {
        console.warn('Locale ' + key + ' not found. Did you forget to load it?');
      }
    }
  }

  return globalLocale._abbr;
}
function defineLocale(name, config) {
  if (config !== null) {
    var locale,
        parentConfig = _base_config__WEBPACK_IMPORTED_MODULE_8__["baseConfig"];
    config.abbr = name;

    if (locales[name] != null) {
      Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_4__["deprecateSimple"])('defineLocaleOverride', 'use moment.updateLocale(localeName, config) to change ' + 'an existing locale. moment.defineLocale(localeName, ' + 'config) should only be used for creating a new locale ' + 'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.');
      parentConfig = locales[name]._config;
    } else if (config.parentLocale != null) {
      if (locales[config.parentLocale] != null) {
        parentConfig = locales[config.parentLocale]._config;
      } else {
        locale = loadLocale(config.parentLocale);

        if (locale != null) {
          parentConfig = locale._config;
        } else {
          if (!localeFamilies[config.parentLocale]) {
            localeFamilies[config.parentLocale] = [];
          }

          localeFamilies[config.parentLocale].push({
            name: name,
            config: config
          });
          return null;
        }
      }
    }

    locales[name] = new _constructor__WEBPACK_IMPORTED_MODULE_6__["Locale"](Object(_set__WEBPACK_IMPORTED_MODULE_5__["mergeConfigs"])(parentConfig, config));

    if (localeFamilies[name]) {
      localeFamilies[name].forEach(function (x) {
        defineLocale(x.name, x.config);
      });
    }

    getSetGlobalLocale(name);
    return locales[name];
  } else {
    delete locales[name];
    return null;
  }
}
function updateLocale(name, config) {
  if (config != null) {
    var locale,
        tmpLocale,
        parentConfig = _base_config__WEBPACK_IMPORTED_MODULE_8__["baseConfig"];
    tmpLocale = loadLocale(name);

    if (tmpLocale != null) {
      parentConfig = tmpLocale._config;
    }

    config = Object(_set__WEBPACK_IMPORTED_MODULE_5__["mergeConfigs"])(parentConfig, config);
    locale = new _constructor__WEBPACK_IMPORTED_MODULE_6__["Locale"](config);
    locale.parentLocale = locales[name];
    locales[name] = locale;
    getSetGlobalLocale(name);
  } else {
    if (locales[name] != null) {
      if (locales[name].parentLocale != null) {
        locales[name] = locales[name].parentLocale;
      } else if (locales[name] != null) {
        delete locales[name];
      }
    }
  }

  return locales[name];
}
function getLocale(key) {
  var locale;

  if (key && key._locale && key._locale._abbr) {
    key = key._locale._abbr;
  }

  if (!key) {
    return globalLocale;
  }

  if (!Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_0__["default"])(key)) {
    locale = loadLocale(key);

    if (locale) {
      return locale;
    }

    key = [key];
  }

  return chooseLocale(key);
}
function listLocales() {
  return Object(_utils_keys__WEBPACK_IMPORTED_MODULE_7__["default"])(locales);
}
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../webpack/buildin/harmony-module.js */ "./node_modules/webpack/buildin/harmony-module.js")(module)))

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/ordinal.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/ordinal.js ***!
  \*******************************************************/
/*! exports provided: defaultOrdinal, defaultDayOfMonthOrdinalParse, ordinal */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultOrdinal", function() { return defaultOrdinal; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultDayOfMonthOrdinalParse", function() { return defaultDayOfMonthOrdinalParse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ordinal", function() { return ordinal; });
var defaultOrdinal = '%d';
var defaultDayOfMonthOrdinalParse = /\d{1,2}/;
function ordinal(number) {
  return this._ordinal.replace('%d', number);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/pre-post-format.js":
/*!***************************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/pre-post-format.js ***!
  \***************************************************************/
/*! exports provided: preParsePostFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "preParsePostFormat", function() { return preParsePostFormat; });
function preParsePostFormat(string) {
  return string;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/prototype.js":
/*!*********************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/prototype.js ***!
  \*********************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/locale/constructor.js");
/* harmony import */ var _calendar__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./calendar */ "./node_modules/moment/src/lib/locale/calendar.js");
/* harmony import */ var _formats__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./formats */ "./node_modules/moment/src/lib/locale/formats.js");
/* harmony import */ var _invalid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./invalid */ "./node_modules/moment/src/lib/locale/invalid.js");
/* harmony import */ var _ordinal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ordinal */ "./node_modules/moment/src/lib/locale/ordinal.js");
/* harmony import */ var _pre_post_format__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./pre-post-format */ "./node_modules/moment/src/lib/locale/pre-post-format.js");
/* harmony import */ var _relative__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./relative */ "./node_modules/moment/src/lib/locale/relative.js");
/* harmony import */ var _set__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./set */ "./node_modules/moment/src/lib/locale/set.js");
/* harmony import */ var _units_month__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../units/month */ "./node_modules/moment/src/lib/units/month.js");
/* harmony import */ var _units_week__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../units/week */ "./node_modules/moment/src/lib/units/week.js");
/* harmony import */ var _units_day_of_week__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../units/day-of-week */ "./node_modules/moment/src/lib/units/day-of-week.js");
/* harmony import */ var _units_hour__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../units/hour */ "./node_modules/moment/src/lib/units/hour.js");

var proto = _constructor__WEBPACK_IMPORTED_MODULE_0__["Locale"].prototype;







proto.calendar = _calendar__WEBPACK_IMPORTED_MODULE_1__["calendar"];
proto.longDateFormat = _formats__WEBPACK_IMPORTED_MODULE_2__["longDateFormat"];
proto.invalidDate = _invalid__WEBPACK_IMPORTED_MODULE_3__["invalidDate"];
proto.ordinal = _ordinal__WEBPACK_IMPORTED_MODULE_4__["ordinal"];
proto.preparse = _pre_post_format__WEBPACK_IMPORTED_MODULE_5__["preParsePostFormat"];
proto.postformat = _pre_post_format__WEBPACK_IMPORTED_MODULE_5__["preParsePostFormat"];
proto.relativeTime = _relative__WEBPACK_IMPORTED_MODULE_6__["relativeTime"];
proto.pastFuture = _relative__WEBPACK_IMPORTED_MODULE_6__["pastFuture"];
proto.set = _set__WEBPACK_IMPORTED_MODULE_7__["set"];

proto.months = _units_month__WEBPACK_IMPORTED_MODULE_8__["localeMonths"];
proto.monthsShort = _units_month__WEBPACK_IMPORTED_MODULE_8__["localeMonthsShort"];
proto.monthsParse = _units_month__WEBPACK_IMPORTED_MODULE_8__["localeMonthsParse"];
proto.monthsRegex = _units_month__WEBPACK_IMPORTED_MODULE_8__["monthsRegex"];
proto.monthsShortRegex = _units_month__WEBPACK_IMPORTED_MODULE_8__["monthsShortRegex"];

proto.week = _units_week__WEBPACK_IMPORTED_MODULE_9__["localeWeek"];
proto.firstDayOfYear = _units_week__WEBPACK_IMPORTED_MODULE_9__["localeFirstDayOfYear"];
proto.firstDayOfWeek = _units_week__WEBPACK_IMPORTED_MODULE_9__["localeFirstDayOfWeek"];

proto.weekdays = _units_day_of_week__WEBPACK_IMPORTED_MODULE_10__["localeWeekdays"];
proto.weekdaysMin = _units_day_of_week__WEBPACK_IMPORTED_MODULE_10__["localeWeekdaysMin"];
proto.weekdaysShort = _units_day_of_week__WEBPACK_IMPORTED_MODULE_10__["localeWeekdaysShort"];
proto.weekdaysParse = _units_day_of_week__WEBPACK_IMPORTED_MODULE_10__["localeWeekdaysParse"];
proto.weekdaysRegex = _units_day_of_week__WEBPACK_IMPORTED_MODULE_10__["weekdaysRegex"];
proto.weekdaysShortRegex = _units_day_of_week__WEBPACK_IMPORTED_MODULE_10__["weekdaysShortRegex"];
proto.weekdaysMinRegex = _units_day_of_week__WEBPACK_IMPORTED_MODULE_10__["weekdaysMinRegex"];

proto.isPM = _units_hour__WEBPACK_IMPORTED_MODULE_11__["localeIsPM"];
proto.meridiem = _units_hour__WEBPACK_IMPORTED_MODULE_11__["localeMeridiem"];

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/relative.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/relative.js ***!
  \********************************************************/
/*! exports provided: defaultRelativeTime, relativeTime, pastFuture */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultRelativeTime", function() { return defaultRelativeTime; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "relativeTime", function() { return relativeTime; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "pastFuture", function() { return pastFuture; });
/* harmony import */ var _utils_is_function__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/is-function */ "./node_modules/moment/src/lib/utils/is-function.js");
var defaultRelativeTime = {
  future: 'in %s',
  past: '%s ago',
  s: 'a few seconds',
  ss: '%d seconds',
  m: 'a minute',
  mm: '%d minutes',
  h: 'an hour',
  hh: '%d hours',
  d: 'a day',
  dd: '%d days',
  M: 'a month',
  MM: '%d months',
  y: 'a year',
  yy: '%d years'
};

function relativeTime(number, withoutSuffix, string, isFuture) {
  var output = this._relativeTime[string];
  return Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_0__["default"])(output) ? output(number, withoutSuffix, string, isFuture) : output.replace(/%d/i, number);
}
function pastFuture(diff, output) {
  var format = this._relativeTime[diff > 0 ? 'future' : 'past'];
  return Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_0__["default"])(format) ? format(output) : format.replace(/%s/i, output);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/locale/set.js":
/*!***************************************************!*\
  !*** ./node_modules/moment/src/lib/locale/set.js ***!
  \***************************************************/
/*! exports provided: set, mergeConfigs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "set", function() { return set; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeConfigs", function() { return mergeConfigs; });
/* harmony import */ var _utils_is_function__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/is-function */ "./node_modules/moment/src/lib/utils/is-function.js");
/* harmony import */ var _utils_extend__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/extend */ "./node_modules/moment/src/lib/utils/extend.js");
/* harmony import */ var _utils_is_object__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/is-object */ "./node_modules/moment/src/lib/utils/is-object.js");
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");




function set(config) {
  var prop, i;

  for (i in config) {
    prop = config[i];

    if (Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_0__["default"])(prop)) {
      this[i] = prop;
    } else {
      this['_' + i] = prop;
    }
  }

  this._config = config;
  this._dayOfMonthOrdinalParseLenient = new RegExp((this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) + '|' + /\d{1,2}/.source);
}
function mergeConfigs(parentConfig, childConfig) {
  var res = Object(_utils_extend__WEBPACK_IMPORTED_MODULE_1__["default"])({}, parentConfig),
      prop;

  for (prop in childConfig) {
    if (Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_3__["default"])(childConfig, prop)) {
      if (Object(_utils_is_object__WEBPACK_IMPORTED_MODULE_2__["default"])(parentConfig[prop]) && Object(_utils_is_object__WEBPACK_IMPORTED_MODULE_2__["default"])(childConfig[prop])) {
        res[prop] = {};
        Object(_utils_extend__WEBPACK_IMPORTED_MODULE_1__["default"])(res[prop], parentConfig[prop]);
        Object(_utils_extend__WEBPACK_IMPORTED_MODULE_1__["default"])(res[prop], childConfig[prop]);
      } else if (childConfig[prop] != null) {
        res[prop] = childConfig[prop];
      } else {
        delete res[prop];
      }
    }
  }

  for (prop in parentConfig) {
    if (Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_3__["default"])(parentConfig, prop) && !Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_3__["default"])(childConfig, prop) && Object(_utils_is_object__WEBPACK_IMPORTED_MODULE_2__["default"])(parentConfig[prop])) {
      res[prop] = Object(_utils_extend__WEBPACK_IMPORTED_MODULE_1__["default"])({}, res[prop]);
    }
  }

  return res;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/add-subtract.js":
/*!************************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/add-subtract.js ***!
  \************************************************************/
/*! exports provided: addSubtract, add, subtract */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addSubtract", function() { return addSubtract; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "add", function() { return add; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subtract", function() { return subtract; });
/* harmony import */ var _get_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _units_month__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../units/month */ "./node_modules/moment/src/lib/units/month.js");
/* harmony import */ var _duration_create__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../duration/create */ "./node_modules/moment/src/lib/duration/create.js");
/* harmony import */ var _utils_deprecate__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/deprecate */ "./node_modules/moment/src/lib/utils/deprecate.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _utils_abs_round__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/abs-round */ "./node_modules/moment/src/lib/utils/abs-round.js");







function createAdder(direction, name) {
  return function (val, period) {
    var dur, tmp;

    if (period !== null && !isNaN(+period)) {
      Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_3__["deprecateSimple"])(name, 'moment().' + name + '(period, number) is deprecated. Please use moment().' + name + '(number, period). ' + 'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.');
      tmp = val;
      val = period;
      period = tmp;
    }

    val = typeof val === 'string' ? +val : val;
    dur = Object(_duration_create__WEBPACK_IMPORTED_MODULE_2__["createDuration"])(val, period);
    addSubtract(this, dur, direction);
    return this;
  };
}

function addSubtract(mom, duration, isAdding, updateOffset) {
  var milliseconds = duration._milliseconds,
      days = Object(_utils_abs_round__WEBPACK_IMPORTED_MODULE_5__["default"])(duration._days),
      months = Object(_utils_abs_round__WEBPACK_IMPORTED_MODULE_5__["default"])(duration._months);

  if (!mom.isValid()) {
    return;
  }

  updateOffset = updateOffset == null ? true : updateOffset;

  if (months) {
    Object(_units_month__WEBPACK_IMPORTED_MODULE_1__["setMonth"])(mom, Object(_get_set__WEBPACK_IMPORTED_MODULE_0__["get"])(mom, 'Month') + months * isAdding);
  }

  if (days) {
    Object(_get_set__WEBPACK_IMPORTED_MODULE_0__["set"])(mom, 'Date', Object(_get_set__WEBPACK_IMPORTED_MODULE_0__["get"])(mom, 'Date') + days * isAdding);
  }

  if (milliseconds) {
    mom._d.setTime(mom._d.valueOf() + milliseconds * isAdding);
  }

  if (updateOffset) {
    _utils_hooks__WEBPACK_IMPORTED_MODULE_4__["hooks"].updateOffset(mom, days || months);
  }
}
var add = createAdder(1, 'add');
var subtract = createAdder(-1, 'subtract');

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/calendar.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/calendar.js ***!
  \********************************************************/
/*! exports provided: getCalendarFormat, calendar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCalendarFormat", function() { return getCalendarFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "calendar", function() { return calendar; });
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _units_offset__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../units/offset */ "./node_modules/moment/src/lib/units/offset.js");
/* harmony import */ var _utils_is_function__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/is-function */ "./node_modules/moment/src/lib/utils/is-function.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");




function getCalendarFormat(myMoment, now) {
  var diff = myMoment.diff(now, 'days', true);
  return diff < -6 ? 'sameElse' : diff < -1 ? 'lastWeek' : diff < 0 ? 'lastDay' : diff < 1 ? 'sameDay' : diff < 2 ? 'nextDay' : diff < 7 ? 'nextWeek' : 'sameElse';
}
function calendar(time, formats) {
  var now = time || Object(_create_local__WEBPACK_IMPORTED_MODULE_0__["createLocal"])(),
      sod = Object(_units_offset__WEBPACK_IMPORTED_MODULE_1__["cloneWithOffset"])(now, this).startOf('day'),
      format = _utils_hooks__WEBPACK_IMPORTED_MODULE_3__["hooks"].calendarFormat(this, sod) || 'sameElse';
  var output = formats && (Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_2__["default"])(formats[format]) ? formats[format].call(this, now) : formats[format]);
  return this.format(output || this.localeData().calendar(format, this, Object(_create_local__WEBPACK_IMPORTED_MODULE_0__["createLocal"])(now)));
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/clone.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/clone.js ***!
  \*****************************************************/
/*! exports provided: clone */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/moment/constructor.js");

function clone() {
  return new _constructor__WEBPACK_IMPORTED_MODULE_0__["Moment"](this);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/compare.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/compare.js ***!
  \*******************************************************/
/*! exports provided: isAfter, isBefore, isBetween, isSame, isSameOrAfter, isSameOrBefore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAfter", function() { return isAfter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isBefore", function() { return isBefore; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isBetween", function() { return isBetween; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isSame", function() { return isSame; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isSameOrAfter", function() { return isSameOrAfter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isSameOrBefore", function() { return isSameOrBefore; });
/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/moment/constructor.js");
/* harmony import */ var _units_aliases__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../units/aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");



function isAfter(input, units) {
  var localInput = Object(_constructor__WEBPACK_IMPORTED_MODULE_0__["isMoment"])(input) ? input : Object(_create_local__WEBPACK_IMPORTED_MODULE_2__["createLocal"])(input);

  if (!(this.isValid() && localInput.isValid())) {
    return false;
  }

  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_1__["normalizeUnits"])(units) || 'millisecond';

  if (units === 'millisecond') {
    return this.valueOf() > localInput.valueOf();
  } else {
    return localInput.valueOf() < this.clone().startOf(units).valueOf();
  }
}
function isBefore(input, units) {
  var localInput = Object(_constructor__WEBPACK_IMPORTED_MODULE_0__["isMoment"])(input) ? input : Object(_create_local__WEBPACK_IMPORTED_MODULE_2__["createLocal"])(input);

  if (!(this.isValid() && localInput.isValid())) {
    return false;
  }

  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_1__["normalizeUnits"])(units) || 'millisecond';

  if (units === 'millisecond') {
    return this.valueOf() < localInput.valueOf();
  } else {
    return this.clone().endOf(units).valueOf() < localInput.valueOf();
  }
}
function isBetween(from, to, units, inclusivity) {
  var localFrom = Object(_constructor__WEBPACK_IMPORTED_MODULE_0__["isMoment"])(from) ? from : Object(_create_local__WEBPACK_IMPORTED_MODULE_2__["createLocal"])(from),
      localTo = Object(_constructor__WEBPACK_IMPORTED_MODULE_0__["isMoment"])(to) ? to : Object(_create_local__WEBPACK_IMPORTED_MODULE_2__["createLocal"])(to);

  if (!(this.isValid() && localFrom.isValid() && localTo.isValid())) {
    return false;
  }

  inclusivity = inclusivity || '()';
  return (inclusivity[0] === '(' ? this.isAfter(localFrom, units) : !this.isBefore(localFrom, units)) && (inclusivity[1] === ')' ? this.isBefore(localTo, units) : !this.isAfter(localTo, units));
}
function isSame(input, units) {
  var localInput = Object(_constructor__WEBPACK_IMPORTED_MODULE_0__["isMoment"])(input) ? input : Object(_create_local__WEBPACK_IMPORTED_MODULE_2__["createLocal"])(input),
      inputMs;

  if (!(this.isValid() && localInput.isValid())) {
    return false;
  }

  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_1__["normalizeUnits"])(units) || 'millisecond';

  if (units === 'millisecond') {
    return this.valueOf() === localInput.valueOf();
  } else {
    inputMs = localInput.valueOf();
    return this.clone().startOf(units).valueOf() <= inputMs && inputMs <= this.clone().endOf(units).valueOf();
  }
}
function isSameOrAfter(input, units) {
  return this.isSame(input, units) || this.isAfter(input, units);
}
function isSameOrBefore(input, units) {
  return this.isSame(input, units) || this.isBefore(input, units);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/constructor.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/constructor.js ***!
  \***********************************************************/
/*! exports provided: copyConfig, Moment, isMoment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "copyConfig", function() { return copyConfig; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Moment", function() { return Moment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isMoment", function() { return isMoment; });
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");
/* harmony import */ var _utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/is-undefined */ "./node_modules/moment/src/lib/utils/is-undefined.js");
/* harmony import */ var _create_parsing_flags__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../create/parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");




var momentProperties = _utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].momentProperties = [];
function copyConfig(to, from) {
  var i, prop, val;

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._isAMomentObject)) {
    to._isAMomentObject = from._isAMomentObject;
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._i)) {
    to._i = from._i;
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._f)) {
    to._f = from._f;
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._l)) {
    to._l = from._l;
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._strict)) {
    to._strict = from._strict;
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._tzm)) {
    to._tzm = from._tzm;
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._isUTC)) {
    to._isUTC = from._isUTC;
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._offset)) {
    to._offset = from._offset;
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._pf)) {
    to._pf = Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_3__["default"])(from);
  }

  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(from._locale)) {
    to._locale = from._locale;
  }

  if (momentProperties.length > 0) {
    for (i = 0; i < momentProperties.length; i++) {
      prop = momentProperties[i];
      val = from[prop];

      if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_2__["default"])(val)) {
        to[prop] = val;
      }
    }
  }

  return to;
}
var updateInProgress = false;
function Moment(config) {
  copyConfig(this, config);
  this._d = new Date(config._d != null ? config._d.getTime() : NaN);

  if (!this.isValid()) {
    this._d = new Date(NaN);
  }

  if (updateInProgress === false) {
    updateInProgress = true;
    _utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].updateOffset(this);
    updateInProgress = false;
  }
}
function isMoment(obj) {
  return obj instanceof Moment || obj != null && obj._isAMomentObject != null;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/creation-data.js":
/*!*************************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/creation-data.js ***!
  \*************************************************************/
/*! exports provided: creationData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "creationData", function() { return creationData; });
function creationData() {
  return {
    input: this._i,
    format: this._f,
    locale: this._locale,
    isUTC: this._isUTC,
    strict: this._strict
  };
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/diff.js":
/*!****************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/diff.js ***!
  \****************************************************/
/*! exports provided: diff */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diff", function() { return diff; });
/* harmony import */ var _utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/abs-floor */ "./node_modules/moment/src/lib/utils/abs-floor.js");
/* harmony import */ var _units_offset__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../units/offset */ "./node_modules/moment/src/lib/units/offset.js");
/* harmony import */ var _units_aliases__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../units/aliases */ "./node_modules/moment/src/lib/units/aliases.js");



function diff(input, units, asFloat) {
  var that, zoneDelta, delta, output;

  if (!this.isValid()) {
    return NaN;
  }

  that = Object(_units_offset__WEBPACK_IMPORTED_MODULE_1__["cloneWithOffset"])(input, this);

  if (!that.isValid()) {
    return NaN;
  }

  zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;
  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_2__["normalizeUnits"])(units);

  switch (units) {
    case 'year':
      output = monthDiff(this, that) / 12;
      break;

    case 'month':
      output = monthDiff(this, that);
      break;

    case 'quarter':
      output = monthDiff(this, that) / 3;
      break;

    case 'second':
      output = (this - that) / 1e3;
      break;

    case 'minute':
      output = (this - that) / 6e4;
      break;

    case 'hour':
      output = (this - that) / 36e5;
      break;

    case 'day':
      output = (this - that - zoneDelta) / 864e5;
      break;

    case 'week':
      output = (this - that - zoneDelta) / 6048e5;
      break;

    default:
      output = this - that;
  }

  return asFloat ? output : Object(_utils_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(output);
}

function monthDiff(a, b) {
  var wholeMonthDiff = (b.year() - a.year()) * 12 + (b.month() - a.month()),
      anchor = a.clone().add(wholeMonthDiff, 'months'),
      anchor2,
      adjust;

  if (b - anchor < 0) {
    anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');
    adjust = (b - anchor) / (anchor - anchor2);
  } else {
    anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');
    adjust = (b - anchor) / (anchor2 - anchor);
  }

  return -(wholeMonthDiff + adjust) || 0;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/format.js":
/*!******************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/format.js ***!
  \******************************************************/
/*! exports provided: toString, toISOString, inspect, format */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toString", function() { return toString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toISOString", function() { return toISOString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "inspect", function() { return inspect; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "format", function() { return format; });
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _utils_is_function__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/is-function */ "./node_modules/moment/src/lib/utils/is-function.js");



_utils_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';
_utils_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].defaultFormatUtc = 'YYYY-MM-DDTHH:mm:ss[Z]';
function toString() {
  return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');
}
function toISOString(keepOffset) {
  if (!this.isValid()) {
    return null;
  }

  var utc = keepOffset !== true;
  var m = utc ? this.clone().utc() : this;

  if (m.year() < 0 || m.year() > 9999) {
    return Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["formatMoment"])(m, utc ? 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]' : 'YYYYYY-MM-DD[T]HH:mm:ss.SSSZ');
  }

  if (Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_2__["default"])(Date.prototype.toISOString)) {
    if (utc) {
      return this.toDate().toISOString();
    } else {
      return new Date(this.valueOf() + this.utcOffset() * 60 * 1000).toISOString().replace('Z', Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["formatMoment"])(m, 'Z'));
    }
  }

  return Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["formatMoment"])(m, utc ? 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]' : 'YYYY-MM-DD[T]HH:mm:ss.SSSZ');
}
function inspect() {
  if (!this.isValid()) {
    return 'moment.invalid(/* ' + this._i + ' */)';
  }

  var func = 'moment';
  var zone = '';

  if (!this.isLocal()) {
    func = this.utcOffset() === 0 ? 'moment.utc' : 'moment.parseZone';
    zone = 'Z';
  }

  var prefix = '[' + func + '("]';
  var year = 0 <= this.year() && this.year() <= 9999 ? 'YYYY' : 'YYYYYY';
  var datetime = '-MM-DD[T]HH:mm:ss.SSS';
  var suffix = zone + '[")]';
  return this.format(prefix + year + datetime + suffix);
}
function format(inputString) {
  if (!inputString) {
    inputString = this.isUtc() ? _utils_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].defaultFormatUtc : _utils_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].defaultFormat;
  }

  var output = Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["formatMoment"])(this, inputString);
  return this.localeData().postformat(output);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/from.js":
/*!****************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/from.js ***!
  \****************************************************/
/*! exports provided: from, fromNow */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "from", function() { return from; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fromNow", function() { return fromNow; });
/* harmony import */ var _duration_create__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../duration/create */ "./node_modules/moment/src/lib/duration/create.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _moment_constructor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../moment/constructor */ "./node_modules/moment/src/lib/moment/constructor.js");



function from(time, withoutSuffix) {
  if (this.isValid() && (Object(_moment_constructor__WEBPACK_IMPORTED_MODULE_2__["isMoment"])(time) && time.isValid() || Object(_create_local__WEBPACK_IMPORTED_MODULE_1__["createLocal"])(time).isValid())) {
    return Object(_duration_create__WEBPACK_IMPORTED_MODULE_0__["createDuration"])({
      to: this,
      from: time
    }).locale(this.locale()).humanize(!withoutSuffix);
  } else {
    return this.localeData().invalidDate();
  }
}
function fromNow(withoutSuffix) {
  return this.from(Object(_create_local__WEBPACK_IMPORTED_MODULE_1__["createLocal"])(), withoutSuffix);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/get-set.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/get-set.js ***!
  \*******************************************************/
/*! exports provided: makeGetSet, get, set, stringGet, stringSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "makeGetSet", function() { return makeGetSet; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "get", function() { return get; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "set", function() { return set; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "stringGet", function() { return stringGet; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "stringSet", function() { return stringSet; });
/* harmony import */ var _units_aliases__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../units/aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _units_priorities__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../units/priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _utils_is_function__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/is-function */ "./node_modules/moment/src/lib/utils/is-function.js");
/* harmony import */ var _units_month__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../units/month */ "./node_modules/moment/src/lib/units/month.js");
/* harmony import */ var _units_year__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../units/year */ "./node_modules/moment/src/lib/units/year.js");






function makeGetSet(unit, keepTime) {
  return function (value) {
    if (value != null) {
      set(this, unit, value);
      _utils_hooks__WEBPACK_IMPORTED_MODULE_2__["hooks"].updateOffset(this, keepTime);
      return this;
    } else {
      return get(this, unit);
    }
  };
}
function get(mom, unit) {
  return mom.isValid() ? mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]() : NaN;
}
function set(mom, unit, value) {
  if (mom.isValid() && !isNaN(value)) {
    if (unit === 'FullYear' && Object(_units_year__WEBPACK_IMPORTED_MODULE_5__["isLeapYear"])(mom.year()) && mom.month() === 1 && mom.date() === 29) {
      mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value, mom.month(), Object(_units_month__WEBPACK_IMPORTED_MODULE_4__["daysInMonth"])(value, mom.month()));
    } else {
      mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);
    }
  }
}
function stringGet(units) {
  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_0__["normalizeUnits"])(units);

  if (Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_3__["default"])(this[units])) {
    return this[units]();
  }

  return this;
}
function stringSet(units, value) {
  if (typeof units === 'object') {
    units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_0__["normalizeObjectUnits"])(units);
    var prioritized = Object(_units_priorities__WEBPACK_IMPORTED_MODULE_1__["getPrioritizedUnits"])(units);

    for (var i = 0; i < prioritized.length; i++) {
      this[prioritized[i].unit](units[prioritized[i].unit]);
    }
  } else {
    units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_0__["normalizeUnits"])(units);

    if (Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_3__["default"])(this[units])) {
      return this[units](value);
    }
  }

  return this;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/locale.js":
/*!******************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/locale.js ***!
  \******************************************************/
/*! exports provided: locale, lang, localeData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "locale", function() { return locale; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "lang", function() { return lang; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeData", function() { return localeData; });
/* harmony import */ var _locale_locales__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../locale/locales */ "./node_modules/moment/src/lib/locale/locales.js");
/* harmony import */ var _utils_deprecate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/deprecate */ "./node_modules/moment/src/lib/utils/deprecate.js");


function locale(key) {
  var newLocaleData;

  if (key === undefined) {
    return this._locale._abbr;
  } else {
    newLocaleData = Object(_locale_locales__WEBPACK_IMPORTED_MODULE_0__["getLocale"])(key);

    if (newLocaleData != null) {
      this._locale = newLocaleData;
    }

    return this;
  }
}
var lang = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_1__["deprecate"])('moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.', function (key) {
  if (key === undefined) {
    return this.localeData();
  } else {
    return this.locale(key);
  }
});
function localeData() {
  return this._locale;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/min-max.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/min-max.js ***!
  \*******************************************************/
/*! exports provided: prototypeMin, prototypeMax, min, max */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prototypeMin", function() { return prototypeMin; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prototypeMax", function() { return prototypeMax; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "min", function() { return min; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "max", function() { return max; });
/* harmony import */ var _utils_deprecate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/deprecate */ "./node_modules/moment/src/lib/utils/deprecate.js");
/* harmony import */ var _utils_is_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/is-array */ "./node_modules/moment/src/lib/utils/is-array.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _create_valid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../create/valid */ "./node_modules/moment/src/lib/create/valid.js");




var prototypeMin = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_0__["deprecate"])('moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/', function () {
  var other = _create_local__WEBPACK_IMPORTED_MODULE_2__["createLocal"].apply(null, arguments);

  if (this.isValid() && other.isValid()) {
    return other < this ? this : other;
  } else {
    return Object(_create_valid__WEBPACK_IMPORTED_MODULE_3__["createInvalid"])();
  }
});
var prototypeMax = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_0__["deprecate"])('moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/', function () {
  var other = _create_local__WEBPACK_IMPORTED_MODULE_2__["createLocal"].apply(null, arguments);

  if (this.isValid() && other.isValid()) {
    return other > this ? this : other;
  } else {
    return Object(_create_valid__WEBPACK_IMPORTED_MODULE_3__["createInvalid"])();
  }
});

function pickBy(fn, moments) {
  var res, i;

  if (moments.length === 1 && Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_1__["default"])(moments[0])) {
    moments = moments[0];
  }

  if (!moments.length) {
    return Object(_create_local__WEBPACK_IMPORTED_MODULE_2__["createLocal"])();
  }

  res = moments[0];

  for (i = 1; i < moments.length; ++i) {
    if (!moments[i].isValid() || moments[i][fn](res)) {
      res = moments[i];
    }
  }

  return res;
}

function min() {
  var args = [].slice.call(arguments, 0);
  return pickBy('isBefore', args);
}
function max() {
  var args = [].slice.call(arguments, 0);
  return pickBy('isAfter', args);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/moment.js":
/*!******************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/moment.js ***!
  \******************************************************/
/*! exports provided: now, min, max, isMoment, createUTC, createUnix, createLocal, createInZone, createInvalid, momentPrototype */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUnix", function() { return createUnix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createInZone", function() { return createInZone; });
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createLocal", function() { return _create_local__WEBPACK_IMPORTED_MODULE_0__["createLocal"]; });

/* harmony import */ var _create_utc__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../create/utc */ "./node_modules/moment/src/lib/create/utc.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUTC", function() { return _create_utc__WEBPACK_IMPORTED_MODULE_1__["createUTC"]; });

/* harmony import */ var _create_valid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/valid */ "./node_modules/moment/src/lib/create/valid.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createInvalid", function() { return _create_valid__WEBPACK_IMPORTED_MODULE_2__["createInvalid"]; });

/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/moment/constructor.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isMoment", function() { return _constructor__WEBPACK_IMPORTED_MODULE_3__["isMoment"]; });

/* harmony import */ var _min_max__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./min-max */ "./node_modules/moment/src/lib/moment/min-max.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "min", function() { return _min_max__WEBPACK_IMPORTED_MODULE_4__["min"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "max", function() { return _min_max__WEBPACK_IMPORTED_MODULE_4__["max"]; });

/* harmony import */ var _now__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./now */ "./node_modules/moment/src/lib/moment/now.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "now", function() { return _now__WEBPACK_IMPORTED_MODULE_5__["now"]; });

/* harmony import */ var _prototype__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./prototype */ "./node_modules/moment/src/lib/moment/prototype.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "momentPrototype", function() { return _prototype__WEBPACK_IMPORTED_MODULE_6__["default"]; });









function createUnix(input) {
  return Object(_create_local__WEBPACK_IMPORTED_MODULE_0__["createLocal"])(input * 1000);
}

function createInZone() {
  return _create_local__WEBPACK_IMPORTED_MODULE_0__["createLocal"].apply(null, arguments).parseZone();
}



/***/ }),

/***/ "./node_modules/moment/src/lib/moment/now.js":
/*!***************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/now.js ***!
  \***************************************************/
/*! exports provided: now */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "now", function() { return now; });
var now = function now() {
  return Date.now ? Date.now() : +new Date();
};

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/prototype.js":
/*!*********************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/prototype.js ***!
  \*********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _constructor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constructor */ "./node_modules/moment/src/lib/moment/constructor.js");
/* harmony import */ var _add_subtract__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-subtract */ "./node_modules/moment/src/lib/moment/add-subtract.js");
/* harmony import */ var _calendar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./calendar */ "./node_modules/moment/src/lib/moment/calendar.js");
/* harmony import */ var _clone__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./clone */ "./node_modules/moment/src/lib/moment/clone.js");
/* harmony import */ var _compare__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./compare */ "./node_modules/moment/src/lib/moment/compare.js");
/* harmony import */ var _diff__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./diff */ "./node_modules/moment/src/lib/moment/diff.js");
/* harmony import */ var _format__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./format */ "./node_modules/moment/src/lib/moment/format.js");
/* harmony import */ var _from__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./from */ "./node_modules/moment/src/lib/moment/from.js");
/* harmony import */ var _to__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./to */ "./node_modules/moment/src/lib/moment/to.js");
/* harmony import */ var _get_set__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _locale__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./locale */ "./node_modules/moment/src/lib/moment/locale.js");
/* harmony import */ var _min_max__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./min-max */ "./node_modules/moment/src/lib/moment/min-max.js");
/* harmony import */ var _start_end_of__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./start-end-of */ "./node_modules/moment/src/lib/moment/start-end-of.js");
/* harmony import */ var _to_type__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./to-type */ "./node_modules/moment/src/lib/moment/to-type.js");
/* harmony import */ var _valid__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./valid */ "./node_modules/moment/src/lib/moment/valid.js");
/* harmony import */ var _creation_data__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./creation-data */ "./node_modules/moment/src/lib/moment/creation-data.js");
/* harmony import */ var _units_year__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../units/year */ "./node_modules/moment/src/lib/units/year.js");
/* harmony import */ var _units_week_year__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../units/week-year */ "./node_modules/moment/src/lib/units/week-year.js");
/* harmony import */ var _units_quarter__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../units/quarter */ "./node_modules/moment/src/lib/units/quarter.js");
/* harmony import */ var _units_month__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../units/month */ "./node_modules/moment/src/lib/units/month.js");
/* harmony import */ var _units_week__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../units/week */ "./node_modules/moment/src/lib/units/week.js");
/* harmony import */ var _units_day_of_month__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../units/day-of-month */ "./node_modules/moment/src/lib/units/day-of-month.js");
/* harmony import */ var _units_day_of_week__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../units/day-of-week */ "./node_modules/moment/src/lib/units/day-of-week.js");
/* harmony import */ var _units_day_of_year__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../units/day-of-year */ "./node_modules/moment/src/lib/units/day-of-year.js");
/* harmony import */ var _units_hour__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../units/hour */ "./node_modules/moment/src/lib/units/hour.js");
/* harmony import */ var _units_minute__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../units/minute */ "./node_modules/moment/src/lib/units/minute.js");
/* harmony import */ var _units_second__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../units/second */ "./node_modules/moment/src/lib/units/second.js");
/* harmony import */ var _units_millisecond__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../units/millisecond */ "./node_modules/moment/src/lib/units/millisecond.js");
/* harmony import */ var _units_offset__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../units/offset */ "./node_modules/moment/src/lib/units/offset.js");
/* harmony import */ var _units_timezone__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../units/timezone */ "./node_modules/moment/src/lib/units/timezone.js");
/* harmony import */ var _utils_deprecate__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../utils/deprecate */ "./node_modules/moment/src/lib/utils/deprecate.js");

var proto = _constructor__WEBPACK_IMPORTED_MODULE_0__["Moment"].prototype;















proto.add = _add_subtract__WEBPACK_IMPORTED_MODULE_1__["add"];
proto.calendar = _calendar__WEBPACK_IMPORTED_MODULE_2__["calendar"];
proto.clone = _clone__WEBPACK_IMPORTED_MODULE_3__["clone"];
proto.diff = _diff__WEBPACK_IMPORTED_MODULE_5__["diff"];
proto.endOf = _start_end_of__WEBPACK_IMPORTED_MODULE_12__["endOf"];
proto.format = _format__WEBPACK_IMPORTED_MODULE_6__["format"];
proto.from = _from__WEBPACK_IMPORTED_MODULE_7__["from"];
proto.fromNow = _from__WEBPACK_IMPORTED_MODULE_7__["fromNow"];
proto.to = _to__WEBPACK_IMPORTED_MODULE_8__["to"];
proto.toNow = _to__WEBPACK_IMPORTED_MODULE_8__["toNow"];
proto.get = _get_set__WEBPACK_IMPORTED_MODULE_9__["stringGet"];
proto.invalidAt = _valid__WEBPACK_IMPORTED_MODULE_14__["invalidAt"];
proto.isAfter = _compare__WEBPACK_IMPORTED_MODULE_4__["isAfter"];
proto.isBefore = _compare__WEBPACK_IMPORTED_MODULE_4__["isBefore"];
proto.isBetween = _compare__WEBPACK_IMPORTED_MODULE_4__["isBetween"];
proto.isSame = _compare__WEBPACK_IMPORTED_MODULE_4__["isSame"];
proto.isSameOrAfter = _compare__WEBPACK_IMPORTED_MODULE_4__["isSameOrAfter"];
proto.isSameOrBefore = _compare__WEBPACK_IMPORTED_MODULE_4__["isSameOrBefore"];
proto.isValid = _valid__WEBPACK_IMPORTED_MODULE_14__["isValid"];
proto.lang = _locale__WEBPACK_IMPORTED_MODULE_10__["lang"];
proto.locale = _locale__WEBPACK_IMPORTED_MODULE_10__["locale"];
proto.localeData = _locale__WEBPACK_IMPORTED_MODULE_10__["localeData"];
proto.max = _min_max__WEBPACK_IMPORTED_MODULE_11__["prototypeMax"];
proto.min = _min_max__WEBPACK_IMPORTED_MODULE_11__["prototypeMin"];
proto.parsingFlags = _valid__WEBPACK_IMPORTED_MODULE_14__["parsingFlags"];
proto.set = _get_set__WEBPACK_IMPORTED_MODULE_9__["stringSet"];
proto.startOf = _start_end_of__WEBPACK_IMPORTED_MODULE_12__["startOf"];
proto.subtract = _add_subtract__WEBPACK_IMPORTED_MODULE_1__["subtract"];
proto.toArray = _to_type__WEBPACK_IMPORTED_MODULE_13__["toArray"];
proto.toObject = _to_type__WEBPACK_IMPORTED_MODULE_13__["toObject"];
proto.toDate = _to_type__WEBPACK_IMPORTED_MODULE_13__["toDate"];
proto.toISOString = _format__WEBPACK_IMPORTED_MODULE_6__["toISOString"];
proto.inspect = _format__WEBPACK_IMPORTED_MODULE_6__["inspect"];
proto.toJSON = _to_type__WEBPACK_IMPORTED_MODULE_13__["toJSON"];
proto.toString = _format__WEBPACK_IMPORTED_MODULE_6__["toString"];
proto.unix = _to_type__WEBPACK_IMPORTED_MODULE_13__["unix"];
proto.valueOf = _to_type__WEBPACK_IMPORTED_MODULE_13__["valueOf"];
proto.creationData = _creation_data__WEBPACK_IMPORTED_MODULE_15__["creationData"];

proto.year = _units_year__WEBPACK_IMPORTED_MODULE_16__["getSetYear"];
proto.isLeapYear = _units_year__WEBPACK_IMPORTED_MODULE_16__["getIsLeapYear"];

proto.weekYear = _units_week_year__WEBPACK_IMPORTED_MODULE_17__["getSetWeekYear"];
proto.isoWeekYear = _units_week_year__WEBPACK_IMPORTED_MODULE_17__["getSetISOWeekYear"];

proto.quarter = proto.quarters = _units_quarter__WEBPACK_IMPORTED_MODULE_18__["getSetQuarter"];

proto.month = _units_month__WEBPACK_IMPORTED_MODULE_19__["getSetMonth"];
proto.daysInMonth = _units_month__WEBPACK_IMPORTED_MODULE_19__["getDaysInMonth"];

proto.week = proto.weeks = _units_week__WEBPACK_IMPORTED_MODULE_20__["getSetWeek"];
proto.isoWeek = proto.isoWeeks = _units_week__WEBPACK_IMPORTED_MODULE_20__["getSetISOWeek"];
proto.weeksInYear = _units_week_year__WEBPACK_IMPORTED_MODULE_17__["getWeeksInYear"];
proto.isoWeeksInYear = _units_week_year__WEBPACK_IMPORTED_MODULE_17__["getISOWeeksInYear"];



proto.date = _units_day_of_month__WEBPACK_IMPORTED_MODULE_21__["getSetDayOfMonth"];
proto.day = proto.days = _units_day_of_week__WEBPACK_IMPORTED_MODULE_22__["getSetDayOfWeek"];
proto.weekday = _units_day_of_week__WEBPACK_IMPORTED_MODULE_22__["getSetLocaleDayOfWeek"];
proto.isoWeekday = _units_day_of_week__WEBPACK_IMPORTED_MODULE_22__["getSetISODayOfWeek"];
proto.dayOfYear = _units_day_of_year__WEBPACK_IMPORTED_MODULE_23__["getSetDayOfYear"];

proto.hour = proto.hours = _units_hour__WEBPACK_IMPORTED_MODULE_24__["getSetHour"];

proto.minute = proto.minutes = _units_minute__WEBPACK_IMPORTED_MODULE_25__["getSetMinute"];

proto.second = proto.seconds = _units_second__WEBPACK_IMPORTED_MODULE_26__["getSetSecond"];

proto.millisecond = proto.milliseconds = _units_millisecond__WEBPACK_IMPORTED_MODULE_27__["getSetMillisecond"];

proto.utcOffset = _units_offset__WEBPACK_IMPORTED_MODULE_28__["getSetOffset"];
proto.utc = _units_offset__WEBPACK_IMPORTED_MODULE_28__["setOffsetToUTC"];
proto.local = _units_offset__WEBPACK_IMPORTED_MODULE_28__["setOffsetToLocal"];
proto.parseZone = _units_offset__WEBPACK_IMPORTED_MODULE_28__["setOffsetToParsedOffset"];
proto.hasAlignedHourOffset = _units_offset__WEBPACK_IMPORTED_MODULE_28__["hasAlignedHourOffset"];
proto.isDST = _units_offset__WEBPACK_IMPORTED_MODULE_28__["isDaylightSavingTime"];
proto.isLocal = _units_offset__WEBPACK_IMPORTED_MODULE_28__["isLocal"];
proto.isUtcOffset = _units_offset__WEBPACK_IMPORTED_MODULE_28__["isUtcOffset"];
proto.isUtc = _units_offset__WEBPACK_IMPORTED_MODULE_28__["isUtc"];
proto.isUTC = _units_offset__WEBPACK_IMPORTED_MODULE_28__["isUtc"];

proto.zoneAbbr = _units_timezone__WEBPACK_IMPORTED_MODULE_29__["getZoneAbbr"];
proto.zoneName = _units_timezone__WEBPACK_IMPORTED_MODULE_29__["getZoneName"];

proto.dates = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_30__["deprecate"])('dates accessor is deprecated. Use date instead.', _units_day_of_month__WEBPACK_IMPORTED_MODULE_21__["getSetDayOfMonth"]);
proto.months = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_30__["deprecate"])('months accessor is deprecated. Use month instead', _units_month__WEBPACK_IMPORTED_MODULE_19__["getSetMonth"]);
proto.years = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_30__["deprecate"])('years accessor is deprecated. Use year instead', _units_year__WEBPACK_IMPORTED_MODULE_16__["getSetYear"]);
proto.zone = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_30__["deprecate"])('moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/', _units_offset__WEBPACK_IMPORTED_MODULE_28__["getSetZone"]);
proto.isDSTShifted = Object(_utils_deprecate__WEBPACK_IMPORTED_MODULE_30__["deprecate"])('isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information', _units_offset__WEBPACK_IMPORTED_MODULE_28__["isDaylightSavingTimeShifted"]);
/* harmony default export */ __webpack_exports__["default"] = (proto);

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/start-end-of.js":
/*!************************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/start-end-of.js ***!
  \************************************************************/
/*! exports provided: startOf, endOf */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "startOf", function() { return startOf; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "endOf", function() { return endOf; });
/* harmony import */ var _units_aliases__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../units/aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");


var MS_PER_SECOND = 1000;
var MS_PER_MINUTE = 60 * MS_PER_SECOND;
var MS_PER_HOUR = 60 * MS_PER_MINUTE;
var MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;

function mod(dividend, divisor) {
  return (dividend % divisor + divisor) % divisor;
}

function localStartOfDate(y, m, d) {
  if (y < 100 && y >= 0) {
    return new Date(y + 400, m, d) - MS_PER_400_YEARS;
  } else {
    return new Date(y, m, d).valueOf();
  }
}

function utcStartOfDate(y, m, d) {
  if (y < 100 && y >= 0) {
    return Date.UTC(y + 400, m, d) - MS_PER_400_YEARS;
  } else {
    return Date.UTC(y, m, d);
  }
}

function startOf(units) {
  var time;
  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_0__["normalizeUnits"])(units);

  if (units === undefined || units === 'millisecond' || !this.isValid()) {
    return this;
  }

  var startOfDate = this._isUTC ? utcStartOfDate : localStartOfDate;

  switch (units) {
    case 'year':
      time = startOfDate(this.year(), 0, 1);
      break;

    case 'quarter':
      time = startOfDate(this.year(), this.month() - this.month() % 3, 1);
      break;

    case 'month':
      time = startOfDate(this.year(), this.month(), 1);
      break;

    case 'week':
      time = startOfDate(this.year(), this.month(), this.date() - this.weekday());
      break;

    case 'isoWeek':
      time = startOfDate(this.year(), this.month(), this.date() - (this.isoWeekday() - 1));
      break;

    case 'day':
    case 'date':
      time = startOfDate(this.year(), this.month(), this.date());
      break;

    case 'hour':
      time = this._d.valueOf();
      time -= mod(time + (this._isUTC ? 0 : this.utcOffset() * MS_PER_MINUTE), MS_PER_HOUR);
      break;

    case 'minute':
      time = this._d.valueOf();
      time -= mod(time, MS_PER_MINUTE);
      break;

    case 'second':
      time = this._d.valueOf();
      time -= mod(time, MS_PER_SECOND);
      break;
  }

  this._d.setTime(time);

  _utils_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].updateOffset(this, true);
  return this;
}
function endOf(units) {
  var time;
  units = Object(_units_aliases__WEBPACK_IMPORTED_MODULE_0__["normalizeUnits"])(units);

  if (units === undefined || units === 'millisecond' || !this.isValid()) {
    return this;
  }

  var startOfDate = this._isUTC ? utcStartOfDate : localStartOfDate;

  switch (units) {
    case 'year':
      time = startOfDate(this.year() + 1, 0, 1) - 1;
      break;

    case 'quarter':
      time = startOfDate(this.year(), this.month() - this.month() % 3 + 3, 1) - 1;
      break;

    case 'month':
      time = startOfDate(this.year(), this.month() + 1, 1) - 1;
      break;

    case 'week':
      time = startOfDate(this.year(), this.month(), this.date() - this.weekday() + 7) - 1;
      break;

    case 'isoWeek':
      time = startOfDate(this.year(), this.month(), this.date() - (this.isoWeekday() - 1) + 7) - 1;
      break;

    case 'day':
    case 'date':
      time = startOfDate(this.year(), this.month(), this.date() + 1) - 1;
      break;

    case 'hour':
      time = this._d.valueOf();
      time += MS_PER_HOUR - mod(time + (this._isUTC ? 0 : this.utcOffset() * MS_PER_MINUTE), MS_PER_HOUR) - 1;
      break;

    case 'minute':
      time = this._d.valueOf();
      time += MS_PER_MINUTE - mod(time, MS_PER_MINUTE) - 1;
      break;

    case 'second':
      time = this._d.valueOf();
      time += MS_PER_SECOND - mod(time, MS_PER_SECOND) - 1;
      break;
  }

  this._d.setTime(time);

  _utils_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].updateOffset(this, true);
  return this;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/to-type.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/to-type.js ***!
  \*******************************************************/
/*! exports provided: valueOf, unix, toDate, toArray, toObject, toJSON */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "valueOf", function() { return valueOf; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "unix", function() { return unix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toDate", function() { return toDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toArray", function() { return toArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toObject", function() { return toObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toJSON", function() { return toJSON; });
function valueOf() {
  return this._d.valueOf() - (this._offset || 0) * 60000;
}
function unix() {
  return Math.floor(this.valueOf() / 1000);
}
function toDate() {
  return new Date(this.valueOf());
}
function toArray() {
  var m = this;
  return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];
}
function toObject() {
  var m = this;
  return {
    years: m.year(),
    months: m.month(),
    date: m.date(),
    hours: m.hours(),
    minutes: m.minutes(),
    seconds: m.seconds(),
    milliseconds: m.milliseconds()
  };
}
function toJSON() {
  return this.isValid() ? this.toISOString() : null;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/to.js":
/*!**************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/to.js ***!
  \**************************************************/
/*! exports provided: to, toNow */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "to", function() { return to; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toNow", function() { return toNow; });
/* harmony import */ var _duration_create__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../duration/create */ "./node_modules/moment/src/lib/duration/create.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _moment_constructor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../moment/constructor */ "./node_modules/moment/src/lib/moment/constructor.js");



function to(time, withoutSuffix) {
  if (this.isValid() && (Object(_moment_constructor__WEBPACK_IMPORTED_MODULE_2__["isMoment"])(time) && time.isValid() || Object(_create_local__WEBPACK_IMPORTED_MODULE_1__["createLocal"])(time).isValid())) {
    return Object(_duration_create__WEBPACK_IMPORTED_MODULE_0__["createDuration"])({
      from: this,
      to: time
    }).locale(this.locale()).humanize(!withoutSuffix);
  } else {
    return this.localeData().invalidDate();
  }
}
function toNow(withoutSuffix) {
  return this.to(Object(_create_local__WEBPACK_IMPORTED_MODULE_1__["createLocal"])(), withoutSuffix);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/moment/valid.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/moment/valid.js ***!
  \*****************************************************/
/*! exports provided: isValid, parsingFlags, invalidAt */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isValid", function() { return isValid; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parsingFlags", function() { return parsingFlags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "invalidAt", function() { return invalidAt; });
/* harmony import */ var _create_valid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../create/valid */ "./node_modules/moment/src/lib/create/valid.js");
/* harmony import */ var _utils_extend__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/extend */ "./node_modules/moment/src/lib/utils/extend.js");
/* harmony import */ var _create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");



function isValid() {
  return Object(_create_valid__WEBPACK_IMPORTED_MODULE_0__["isValid"])(this);
}
function parsingFlags() {
  return Object(_utils_extend__WEBPACK_IMPORTED_MODULE_1__["default"])({}, Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(this));
}
function invalidAt() {
  return Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_2__["default"])(this).overflow;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/parse/regex.js":
/*!****************************************************!*\
  !*** ./node_modules/moment/src/lib/parse/regex.js ***!
  \****************************************************/
/*! exports provided: match1, match2, match3, match4, match6, match1to2, match3to4, match5to6, match1to3, match1to4, match1to6, matchUnsigned, matchSigned, matchOffset, matchShortOffset, matchTimestamp, matchWord, addRegexToken, getParseRegexForToken, regexEscape */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match1", function() { return match1; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match2", function() { return match2; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match3", function() { return match3; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match4", function() { return match4; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match6", function() { return match6; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match1to2", function() { return match1to2; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match3to4", function() { return match3to4; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match5to6", function() { return match5to6; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match1to3", function() { return match1to3; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match1to4", function() { return match1to4; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "match1to6", function() { return match1to6; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "matchUnsigned", function() { return matchUnsigned; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "matchSigned", function() { return matchSigned; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "matchOffset", function() { return matchOffset; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "matchShortOffset", function() { return matchShortOffset; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "matchTimestamp", function() { return matchTimestamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "matchWord", function() { return matchWord; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addRegexToken", function() { return addRegexToken; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getParseRegexForToken", function() { return getParseRegexForToken; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "regexEscape", function() { return regexEscape; });
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");
/* harmony import */ var _utils_is_function__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/is-function */ "./node_modules/moment/src/lib/utils/is-function.js");
var match1 = /\d/;
var match2 = /\d\d/;
var match3 = /\d{3}/;
var match4 = /\d{4}/;
var match6 = /[+-]?\d{6}/;
var match1to2 = /\d\d?/;
var match3to4 = /\d\d\d\d?/;
var match5to6 = /\d\d\d\d\d\d?/;
var match1to3 = /\d{1,3}/;
var match1to4 = /\d{1,4}/;
var match1to6 = /[+-]?\d{1,6}/;
var matchUnsigned = /\d+/;
var matchSigned = /[+-]?\d+/;
var matchOffset = /Z|[+-]\d\d:?\d\d/gi;
var matchShortOffset = /Z|[+-]\d\d(?::?\d\d)?/gi;
var matchTimestamp = /[+-]?\d+(\.\d{1,3})?/;
var matchWord = /[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;


var regexes = {};
function addRegexToken(token, regex, strictRegex) {
  regexes[token] = Object(_utils_is_function__WEBPACK_IMPORTED_MODULE_1__["default"])(regex) ? regex : function (isStrict, localeData) {
    return isStrict && strictRegex ? strictRegex : regex;
  };
}
function getParseRegexForToken(token, config) {
  if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_0__["default"])(regexes, token)) {
    return new RegExp(unescapeFormat(token));
  }

  return regexes[token](config._strict, config._locale);
}

function unescapeFormat(s) {
  return regexEscape(s.replace('\\', '').replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (matched, p1, p2, p3, p4) {
    return p1 || p2 || p3 || p4;
  }));
}

function regexEscape(s) {
  return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
}

/***/ }),

/***/ "./node_modules/moment/src/lib/parse/token.js":
/*!****************************************************!*\
  !*** ./node_modules/moment/src/lib/parse/token.js ***!
  \****************************************************/
/*! exports provided: addParseToken, addWeekParseToken, addTimeToArrayFromToken */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addParseToken", function() { return addParseToken; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addWeekParseToken", function() { return addWeekParseToken; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addTimeToArrayFromToken", function() { return addTimeToArrayFromToken; });
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");
/* harmony import */ var _utils_is_number__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/is-number */ "./node_modules/moment/src/lib/utils/is-number.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");



var tokens = {};
function addParseToken(token, callback) {
  var i,
      func = callback;

  if (typeof token === 'string') {
    token = [token];
  }

  if (Object(_utils_is_number__WEBPACK_IMPORTED_MODULE_1__["default"])(callback)) {
    func = function func(input, array) {
      array[callback] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_2__["default"])(input);
    };
  }

  for (i = 0; i < token.length; i++) {
    tokens[token[i]] = func;
  }
}
function addWeekParseToken(token, callback) {
  addParseToken(token, function (input, array, config, token) {
    config._w = config._w || {};
    callback(input, config._w, config, token);
  });
}
function addTimeToArrayFromToken(token, input, config) {
  if (input != null && Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_0__["default"])(tokens, token)) {
    tokens[token](input, config._a, config, token);
  }
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/aliases.js":
/*!******************************************************!*\
  !*** ./node_modules/moment/src/lib/units/aliases.js ***!
  \******************************************************/
/*! exports provided: addUnitAlias, normalizeUnits, normalizeObjectUnits */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addUnitAlias", function() { return addUnitAlias; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizeUnits", function() { return normalizeUnits; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizeObjectUnits", function() { return normalizeObjectUnits; });
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");

var aliases = {};
function addUnitAlias(unit, shorthand) {
  var lowerCase = unit.toLowerCase();
  aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;
}
function normalizeUnits(units) {
  return typeof units === 'string' ? aliases[units] || aliases[units.toLowerCase()] : undefined;
}
function normalizeObjectUnits(inputObject) {
  var normalizedInput = {},
      normalizedProp,
      prop;

  for (prop in inputObject) {
    if (Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_0__["default"])(inputObject, prop)) {
      normalizedProp = normalizeUnits(prop);

      if (normalizedProp) {
        normalizedInput[normalizedProp] = inputObject[prop];
      }
    }
  }

  return normalizedInput;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/constants.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/units/constants.js ***!
  \********************************************************/
/*! exports provided: YEAR, MONTH, DATE, HOUR, MINUTE, SECOND, MILLISECOND, WEEK, WEEKDAY */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YEAR", function() { return YEAR; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MONTH", function() { return MONTH; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DATE", function() { return DATE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HOUR", function() { return HOUR; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MINUTE", function() { return MINUTE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SECOND", function() { return SECOND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MILLISECOND", function() { return MILLISECOND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WEEK", function() { return WEEK; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WEEKDAY", function() { return WEEKDAY; });
var YEAR = 0;
var MONTH = 1;
var DATE = 2;
var HOUR = 3;
var MINUTE = 4;
var SECOND = 5;
var MILLISECOND = 6;
var WEEK = 7;
var WEEKDAY = 8;

/***/ }),

/***/ "./node_modules/moment/src/lib/units/day-of-month.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/units/day-of-month.js ***!
  \***********************************************************/
/*! exports provided: getSetDayOfMonth */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetDayOfMonth", function() { return getSetDayOfMonth; });
/* harmony import */ var _moment_get_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../moment/get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");








Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('D', ['DD', 2], 'Do', 'date');
Object(_aliases__WEBPACK_IMPORTED_MODULE_2__["addUnitAlias"])('date', 'D');
Object(_priorities__WEBPACK_IMPORTED_MODULE_3__["addUnitPriority"])('date', 9);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('D', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('DD', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('Do', function (isStrict, locale) {
  return isStrict ? locale._dayOfMonthOrdinalParse || locale._ordinalParse : locale._dayOfMonthOrdinalParseLenient;
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(['D', 'DD'], _constants__WEBPACK_IMPORTED_MODULE_6__["DATE"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])('Do', function (input, array) {
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["DATE"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.match(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"])[0]);
});
var getSetDayOfMonth = Object(_moment_get_set__WEBPACK_IMPORTED_MODULE_0__["makeGetSet"])('Date', true);

/***/ }),

/***/ "./node_modules/moment/src/lib/units/day-of-week.js":
/*!**********************************************************!*\
  !*** ./node_modules/moment/src/lib/units/day-of-week.js ***!
  \**********************************************************/
/*! exports provided: defaultLocaleWeekdays, localeWeekdays, defaultLocaleWeekdaysShort, localeWeekdaysShort, defaultLocaleWeekdaysMin, localeWeekdaysMin, localeWeekdaysParse, getSetDayOfWeek, getSetLocaleDayOfWeek, getSetISODayOfWeek, weekdaysRegex, weekdaysShortRegex, weekdaysMinRegex */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultLocaleWeekdays", function() { return defaultLocaleWeekdays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeWeekdays", function() { return localeWeekdays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultLocaleWeekdaysShort", function() { return defaultLocaleWeekdaysShort; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeWeekdaysShort", function() { return localeWeekdaysShort; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultLocaleWeekdaysMin", function() { return defaultLocaleWeekdaysMin; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeWeekdaysMin", function() { return localeWeekdaysMin; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeWeekdaysParse", function() { return localeWeekdaysParse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetDayOfWeek", function() { return getSetDayOfWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetLocaleDayOfWeek", function() { return getSetLocaleDayOfWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetISODayOfWeek", function() { return getSetISODayOfWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "weekdaysRegex", function() { return weekdaysRegex; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "weekdaysShortRegex", function() { return weekdaysShortRegex; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "weekdaysMinRegex", function() { return weekdaysMinRegex; });
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");
/* harmony import */ var _utils_is_array__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/is-array */ "./node_modules/moment/src/lib/utils/is-array.js");
/* harmony import */ var _utils_index_of__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/index-of */ "./node_modules/moment/src/lib/utils/index-of.js");
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");
/* harmony import */ var _create_utc__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../create/utc */ "./node_modules/moment/src/lib/create/utc.js");
/* harmony import */ var _create_parsing_flags__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../create/parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");











Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('d', 0, 'do', 'day');
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('dd', 0, 0, function (format) {
  return this.localeData().weekdaysMin(this, format);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('ddd', 0, 0, function (format) {
  return this.localeData().weekdaysShort(this, format);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('dddd', 0, 0, function (format) {
  return this.localeData().weekdays(this, format);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('e', 0, 0, 'weekday');
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('E', 0, 0, 'isoWeekday');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('day', 'd');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('weekday', 'e');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('isoWeekday', 'E');
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('day', 11);
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('weekday', 11);
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('isoWeekday', 11);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('d', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('e', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('E', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('dd', function (isStrict, locale) {
  return locale.weekdaysMinRegex(isStrict);
});
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('ddd', function (isStrict, locale) {
  return locale.weekdaysShortRegex(isStrict);
});
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('dddd', function (isStrict, locale) {
  return locale.weekdaysRegex(isStrict);
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_4__["addWeekParseToken"])(['dd', 'ddd', 'dddd'], function (input, week, config, token) {
  var weekday = config._locale.weekdaysParse(input, token, config._strict);

  if (weekday != null) {
    week.d = weekday;
  } else {
    Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_10__["default"])(config).invalidWeekday = input;
  }
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_4__["addWeekParseToken"])(['d', 'e', 'E'], function (input, week, config, token) {
  week[token] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_5__["default"])(input);
});

function parseWeekday(input, locale) {
  if (typeof input !== 'string') {
    return input;
  }

  if (!isNaN(input)) {
    return parseInt(input, 10);
  }

  input = locale.weekdaysParse(input);

  if (typeof input === 'number') {
    return input;
  }

  return null;
}

function parseIsoWeekday(input, locale) {
  if (typeof input === 'string') {
    return locale.weekdaysParse(input) % 7 || 7;
  }

  return isNaN(input) ? null : input;
}

function shiftWeekdays(ws, n) {
  return ws.slice(n, 7).concat(ws.slice(0, n));
}

var defaultLocaleWeekdays = 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');
function localeWeekdays(m, format) {
  var weekdays = Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_6__["default"])(this._weekdays) ? this._weekdays : this._weekdays[m && m !== true && this._weekdays.isFormat.test(format) ? 'format' : 'standalone'];
  return m === true ? shiftWeekdays(weekdays, this._week.dow) : m ? weekdays[m.day()] : weekdays;
}
var defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');
function localeWeekdaysShort(m) {
  return m === true ? shiftWeekdays(this._weekdaysShort, this._week.dow) : m ? this._weekdaysShort[m.day()] : this._weekdaysShort;
}
var defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_');
function localeWeekdaysMin(m) {
  return m === true ? shiftWeekdays(this._weekdaysMin, this._week.dow) : m ? this._weekdaysMin[m.day()] : this._weekdaysMin;
}

function handleStrictParse(weekdayName, format, strict) {
  var i,
      ii,
      mom,
      llc = weekdayName.toLocaleLowerCase();

  if (!this._weekdaysParse) {
    this._weekdaysParse = [];
    this._shortWeekdaysParse = [];
    this._minWeekdaysParse = [];

    for (i = 0; i < 7; ++i) {
      mom = Object(_create_utc__WEBPACK_IMPORTED_MODULE_9__["createUTC"])([2000, 1]).day(i);
      this._minWeekdaysParse[i] = this.weekdaysMin(mom, '').toLocaleLowerCase();
      this._shortWeekdaysParse[i] = this.weekdaysShort(mom, '').toLocaleLowerCase();
      this._weekdaysParse[i] = this.weekdays(mom, '').toLocaleLowerCase();
    }
  }

  if (strict) {
    if (format === 'dddd') {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._weekdaysParse, llc);
      return ii !== -1 ? ii : null;
    } else if (format === 'ddd') {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._shortWeekdaysParse, llc);
      return ii !== -1 ? ii : null;
    } else {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._minWeekdaysParse, llc);
      return ii !== -1 ? ii : null;
    }
  } else {
    if (format === 'dddd') {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._weekdaysParse, llc);

      if (ii !== -1) {
        return ii;
      }

      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._shortWeekdaysParse, llc);

      if (ii !== -1) {
        return ii;
      }

      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._minWeekdaysParse, llc);
      return ii !== -1 ? ii : null;
    } else if (format === 'ddd') {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._shortWeekdaysParse, llc);

      if (ii !== -1) {
        return ii;
      }

      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._weekdaysParse, llc);

      if (ii !== -1) {
        return ii;
      }

      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._minWeekdaysParse, llc);
      return ii !== -1 ? ii : null;
    } else {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._minWeekdaysParse, llc);

      if (ii !== -1) {
        return ii;
      }

      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._weekdaysParse, llc);

      if (ii !== -1) {
        return ii;
      }

      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_7__["default"].call(this._shortWeekdaysParse, llc);
      return ii !== -1 ? ii : null;
    }
  }
}

function localeWeekdaysParse(weekdayName, format, strict) {
  var i, mom, regex;

  if (this._weekdaysParseExact) {
    return handleStrictParse.call(this, weekdayName, format, strict);
  }

  if (!this._weekdaysParse) {
    this._weekdaysParse = [];
    this._minWeekdaysParse = [];
    this._shortWeekdaysParse = [];
    this._fullWeekdaysParse = [];
  }

  for (i = 0; i < 7; i++) {
    mom = Object(_create_utc__WEBPACK_IMPORTED_MODULE_9__["createUTC"])([2000, 1]).day(i);

    if (strict && !this._fullWeekdaysParse[i]) {
      this._fullWeekdaysParse[i] = new RegExp('^' + this.weekdays(mom, '').replace('.', '\\.?') + '$', 'i');
      this._shortWeekdaysParse[i] = new RegExp('^' + this.weekdaysShort(mom, '').replace('.', '\\.?') + '$', 'i');
      this._minWeekdaysParse[i] = new RegExp('^' + this.weekdaysMin(mom, '').replace('.', '\\.?') + '$', 'i');
    }

    if (!this._weekdaysParse[i]) {
      regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');
      this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');
    }

    if (strict && format === 'dddd' && this._fullWeekdaysParse[i].test(weekdayName)) {
      return i;
    } else if (strict && format === 'ddd' && this._shortWeekdaysParse[i].test(weekdayName)) {
      return i;
    } else if (strict && format === 'dd' && this._minWeekdaysParse[i].test(weekdayName)) {
      return i;
    } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {
      return i;
    }
  }
}
function getSetDayOfWeek(input) {
  if (!this.isValid()) {
    return input != null ? this : NaN;
  }

  var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();

  if (input != null) {
    input = parseWeekday(input, this.localeData());
    return this.add(input - day, 'd');
  } else {
    return day;
  }
}
function getSetLocaleDayOfWeek(input) {
  if (!this.isValid()) {
    return input != null ? this : NaN;
  }

  var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;
  return input == null ? weekday : this.add(input - weekday, 'd');
}
function getSetISODayOfWeek(input) {
  if (!this.isValid()) {
    return input != null ? this : NaN;
  }

  if (input != null) {
    var weekday = parseIsoWeekday(input, this.localeData());
    return this.day(this.day() % 7 ? weekday : weekday - 7);
  } else {
    return this.day() || 7;
  }
}
var defaultWeekdaysRegex = _parse_regex__WEBPACK_IMPORTED_MODULE_3__["matchWord"];
function weekdaysRegex(isStrict) {
  if (this._weekdaysParseExact) {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_8__["default"])(this, '_weekdaysRegex')) {
      computeWeekdaysParse.call(this);
    }

    if (isStrict) {
      return this._weekdaysStrictRegex;
    } else {
      return this._weekdaysRegex;
    }
  } else {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_8__["default"])(this, '_weekdaysRegex')) {
      this._weekdaysRegex = defaultWeekdaysRegex;
    }

    return this._weekdaysStrictRegex && isStrict ? this._weekdaysStrictRegex : this._weekdaysRegex;
  }
}
var defaultWeekdaysShortRegex = _parse_regex__WEBPACK_IMPORTED_MODULE_3__["matchWord"];
function weekdaysShortRegex(isStrict) {
  if (this._weekdaysParseExact) {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_8__["default"])(this, '_weekdaysRegex')) {
      computeWeekdaysParse.call(this);
    }

    if (isStrict) {
      return this._weekdaysShortStrictRegex;
    } else {
      return this._weekdaysShortRegex;
    }
  } else {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_8__["default"])(this, '_weekdaysShortRegex')) {
      this._weekdaysShortRegex = defaultWeekdaysShortRegex;
    }

    return this._weekdaysShortStrictRegex && isStrict ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex;
  }
}
var defaultWeekdaysMinRegex = _parse_regex__WEBPACK_IMPORTED_MODULE_3__["matchWord"];
function weekdaysMinRegex(isStrict) {
  if (this._weekdaysParseExact) {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_8__["default"])(this, '_weekdaysRegex')) {
      computeWeekdaysParse.call(this);
    }

    if (isStrict) {
      return this._weekdaysMinStrictRegex;
    } else {
      return this._weekdaysMinRegex;
    }
  } else {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_8__["default"])(this, '_weekdaysMinRegex')) {
      this._weekdaysMinRegex = defaultWeekdaysMinRegex;
    }

    return this._weekdaysMinStrictRegex && isStrict ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex;
  }
}

function computeWeekdaysParse() {
  function cmpLenRev(a, b) {
    return b.length - a.length;
  }

  var minPieces = [],
      shortPieces = [],
      longPieces = [],
      mixedPieces = [],
      i,
      mom,
      minp,
      shortp,
      longp;

  for (i = 0; i < 7; i++) {
    mom = Object(_create_utc__WEBPACK_IMPORTED_MODULE_9__["createUTC"])([2000, 1]).day(i);
    minp = this.weekdaysMin(mom, '');
    shortp = this.weekdaysShort(mom, '');
    longp = this.weekdays(mom, '');
    minPieces.push(minp);
    shortPieces.push(shortp);
    longPieces.push(longp);
    mixedPieces.push(minp);
    mixedPieces.push(shortp);
    mixedPieces.push(longp);
  }

  minPieces.sort(cmpLenRev);
  shortPieces.sort(cmpLenRev);
  longPieces.sort(cmpLenRev);
  mixedPieces.sort(cmpLenRev);

  for (i = 0; i < 7; i++) {
    shortPieces[i] = Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["regexEscape"])(shortPieces[i]);
    longPieces[i] = Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["regexEscape"])(longPieces[i]);
    mixedPieces[i] = Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["regexEscape"])(mixedPieces[i]);
  }

  this._weekdaysRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');
  this._weekdaysShortRegex = this._weekdaysRegex;
  this._weekdaysMinRegex = this._weekdaysRegex;
  this._weekdaysStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');
  this._weekdaysShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');
  this._weekdaysMinStrictRegex = new RegExp('^(' + minPieces.join('|') + ')', 'i');
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/day-of-year.js":
/*!**********************************************************!*\
  !*** ./node_modules/moment/src/lib/units/day-of-year.js ***!
  \**********************************************************/
/*! exports provided: getSetDayOfYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetDayOfYear", function() { return getSetDayOfYear; });
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _year__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./year */ "./node_modules/moment/src/lib/units/year.js");
/* harmony import */ var _create_date_from_array__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../create/date-from-array */ "./node_modules/moment/src/lib/create/date-from-array.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");








Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('dayOfYear', 'DDD');
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('dayOfYear', 4);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('DDD', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to3"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('DDDD', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match3"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_6__["addParseToken"])(['DDD', 'DDDD'], function (input, array, config) {
  config._dayOfYear = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input);
});
function getSetDayOfYear(input) {
  var dayOfYear = Math.round((this.clone().startOf('day') - this.clone().startOf('year')) / 864e5) + 1;
  return input == null ? dayOfYear : this.add(input - dayOfYear, 'd');
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/hour.js":
/*!***************************************************!*\
  !*** ./node_modules/moment/src/lib/units/hour.js ***!
  \***************************************************/
/*! exports provided: localeIsPM, defaultLocaleMeridiemParse, localeMeridiem, getSetHour */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeIsPM", function() { return localeIsPM; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultLocaleMeridiemParse", function() { return defaultLocaleMeridiemParse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeMeridiem", function() { return localeMeridiem; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetHour", function() { return getSetHour; });
/* harmony import */ var _moment_get_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../moment/get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");
/* harmony import */ var _utils_zero_fill__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utils/zero-fill */ "./node_modules/moment/src/lib/utils/zero-fill.js");
/* harmony import */ var _create_parsing_flags__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../create/parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");











function hFormat() {
  return this.hours() % 12 || 12;
}

function kFormat() {
  return this.hours() || 24;
}

Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('H', ['HH', 2], 0, 'hour');
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('h', ['hh', 2], 0, hFormat);
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('k', ['kk', 2], 0, kFormat);
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('hmm', 0, 0, function () {
  return '' + hFormat.apply(this) + Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_8__["default"])(this.minutes(), 2);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('hmmss', 0, 0, function () {
  return '' + hFormat.apply(this) + Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_8__["default"])(this.minutes(), 2) + Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_8__["default"])(this.seconds(), 2);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('Hmm', 0, 0, function () {
  return '' + this.hours() + Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_8__["default"])(this.minutes(), 2);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('Hmmss', 0, 0, function () {
  return '' + this.hours() + Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_8__["default"])(this.minutes(), 2) + Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_8__["default"])(this.seconds(), 2);
});

function meridiem(token, lowercase) {
  Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(token, 0, 0, function () {
    return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);
  });
}

meridiem('a', true);
meridiem('A', false);
Object(_aliases__WEBPACK_IMPORTED_MODULE_2__["addUnitAlias"])('hour', 'h');
Object(_priorities__WEBPACK_IMPORTED_MODULE_3__["addUnitPriority"])('hour', 13);

function matchMeridiem(isStrict, locale) {
  return locale._meridiemParse;
}

Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('a', matchMeridiem);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('A', matchMeridiem);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('H', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('h', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('k', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('HH', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('hh', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('kk', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('hmm', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match3to4"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('hmmss', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match5to6"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('Hmm', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match3to4"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('Hmmss', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match5to6"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(['H', 'HH'], _constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(['k', 'kk'], function (input, array, config) {
  var kInput = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input);
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] = kInput === 24 ? 0 : kInput;
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(['a', 'A'], function (input, array, config) {
  config._isPm = config._locale.isPM(input);
  config._meridiem = input;
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(['h', 'hh'], function (input, array, config) {
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input);
  Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_9__["default"])(config).bigHour = true;
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])('hmm', function (input, array, config) {
  var pos = input.length - 2;
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(0, pos));
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["MINUTE"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(pos));
  Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_9__["default"])(config).bigHour = true;
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])('hmmss', function (input, array, config) {
  var pos1 = input.length - 4;
  var pos2 = input.length - 2;
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(0, pos1));
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["MINUTE"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(pos1, 2));
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["SECOND"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(pos2));
  Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_9__["default"])(config).bigHour = true;
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])('Hmm', function (input, array, config) {
  var pos = input.length - 2;
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(0, pos));
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["MINUTE"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(pos));
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])('Hmmss', function (input, array, config) {
  var pos1 = input.length - 4;
  var pos2 = input.length - 2;
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["HOUR"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(0, pos1));
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["MINUTE"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(pos1, 2));
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["SECOND"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(input.substr(pos2));
});
function localeIsPM(input) {
  return (input + '').toLowerCase().charAt(0) === 'p';
}
var defaultLocaleMeridiemParse = /[ap]\.?m?\.?/i;
function localeMeridiem(hours, minutes, isLower) {
  if (hours > 11) {
    return isLower ? 'pm' : 'PM';
  } else {
    return isLower ? 'am' : 'AM';
  }
}
var getSetHour = Object(_moment_get_set__WEBPACK_IMPORTED_MODULE_0__["makeGetSet"])('Hours', true);

/***/ }),

/***/ "./node_modules/moment/src/lib/units/millisecond.js":
/*!**********************************************************!*\
  !*** ./node_modules/moment/src/lib/units/millisecond.js ***!
  \**********************************************************/
/*! exports provided: getSetMillisecond */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetMillisecond", function() { return getSetMillisecond; });
/* harmony import */ var _moment_get_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../moment/get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");








Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('S', 0, 0, function () {
  return ~~(this.millisecond() / 100);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['SS', 2], 0, function () {
  return ~~(this.millisecond() / 10);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['SSS', 3], 0, 'millisecond');
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['SSSS', 4], 0, function () {
  return this.millisecond() * 10;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['SSSSS', 5], 0, function () {
  return this.millisecond() * 100;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['SSSSSS', 6], 0, function () {
  return this.millisecond() * 1000;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['SSSSSSS', 7], 0, function () {
  return this.millisecond() * 10000;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['SSSSSSSS', 8], 0, function () {
  return this.millisecond() * 100000;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['SSSSSSSSS', 9], 0, function () {
  return this.millisecond() * 1000000;
});
Object(_aliases__WEBPACK_IMPORTED_MODULE_2__["addUnitAlias"])('millisecond', 'ms');
Object(_priorities__WEBPACK_IMPORTED_MODULE_3__["addUnitPriority"])('millisecond', 16);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('S', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to3"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('SS', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to3"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('SSS', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to3"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match3"]);
var token;

for (token = 'SSSS'; token.length <= 9; token += 'S') {
  Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])(token, _parse_regex__WEBPACK_IMPORTED_MODULE_4__["matchUnsigned"]);
}

function parseMs(input, array) {
  array[_constants__WEBPACK_IMPORTED_MODULE_6__["MILLISECOND"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_7__["default"])(('0.' + input) * 1000);
}

for (token = 'S'; token.length <= 9; token += 'S') {
  Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(token, parseMs);
}

var getSetMillisecond = Object(_moment_get_set__WEBPACK_IMPORTED_MODULE_0__["makeGetSet"])('Milliseconds', false);

/***/ }),

/***/ "./node_modules/moment/src/lib/units/minute.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/units/minute.js ***!
  \*****************************************************/
/*! exports provided: getSetMinute */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetMinute", function() { return getSetMinute; });
/* harmony import */ var _moment_get_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../moment/get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./constants */ "./node_modules/moment/src/lib/units/constants.js");







Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('m', ['mm', 2], 0, 'minute');
Object(_aliases__WEBPACK_IMPORTED_MODULE_2__["addUnitAlias"])('minute', 'm');
Object(_priorities__WEBPACK_IMPORTED_MODULE_3__["addUnitPriority"])('minute', 14);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('m', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('mm', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match2"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(['m', 'mm'], _constants__WEBPACK_IMPORTED_MODULE_6__["MINUTE"]);
var getSetMinute = Object(_moment_get_set__WEBPACK_IMPORTED_MODULE_0__["makeGetSet"])('Minutes', false);

/***/ }),

/***/ "./node_modules/moment/src/lib/units/month.js":
/*!****************************************************!*\
  !*** ./node_modules/moment/src/lib/units/month.js ***!
  \****************************************************/
/*! exports provided: daysInMonth, defaultLocaleMonths, localeMonths, defaultLocaleMonthsShort, localeMonthsShort, localeMonthsParse, setMonth, getSetMonth, getDaysInMonth, monthsShortRegex, monthsRegex */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "daysInMonth", function() { return daysInMonth; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultLocaleMonths", function() { return defaultLocaleMonths; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeMonths", function() { return localeMonths; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultLocaleMonthsShort", function() { return defaultLocaleMonthsShort; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeMonthsShort", function() { return localeMonthsShort; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeMonthsParse", function() { return localeMonthsParse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setMonth", function() { return setMonth; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetMonth", function() { return getSetMonth; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDaysInMonth", function() { return getDaysInMonth; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "monthsShortRegex", function() { return monthsShortRegex; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "monthsRegex", function() { return monthsRegex; });
/* harmony import */ var _moment_get_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../moment/get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _utils_has_own_prop__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");
/* harmony import */ var _utils_is_array__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../utils/is-array */ "./node_modules/moment/src/lib/utils/is-array.js");
/* harmony import */ var _utils_is_number__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../utils/is-number */ "./node_modules/moment/src/lib/utils/is-number.js");
/* harmony import */ var _utils_mod__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utils/mod */ "./node_modules/moment/src/lib/utils/mod.js");
/* harmony import */ var _utils_index_of__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../utils/index-of */ "./node_modules/moment/src/lib/utils/index-of.js");
/* harmony import */ var _create_utc__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../create/utc */ "./node_modules/moment/src/lib/create/utc.js");
/* harmony import */ var _create_parsing_flags__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../create/parsing-flags */ "./node_modules/moment/src/lib/create/parsing-flags.js");
/* harmony import */ var _units_year__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../units/year */ "./node_modules/moment/src/lib/units/year.js");

















function daysInMonth(year, month) {
  if (isNaN(year) || isNaN(month)) {
    return NaN;
  }

  var modMonth = Object(_utils_mod__WEBPACK_IMPORTED_MODULE_12__["default"])(month, 12);
  year += (month - modMonth) / 12;
  return modMonth === 1 ? Object(_units_year__WEBPACK_IMPORTED_MODULE_16__["isLeapYear"])(year) ? 29 : 28 : 31 - modMonth % 7 % 2;
}
Object(_format_format__WEBPACK_IMPORTED_MODULE_2__["addFormatToken"])('M', ['MM', 2], 'Mo', function () {
  return this.month() + 1;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_2__["addFormatToken"])('MMM', 0, 0, function (format) {
  return this.localeData().monthsShort(this, format);
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_2__["addFormatToken"])('MMMM', 0, 0, function (format) {
  return this.localeData().months(this, format);
});
Object(_aliases__WEBPACK_IMPORTED_MODULE_3__["addUnitAlias"])('month', 'M');
Object(_priorities__WEBPACK_IMPORTED_MODULE_4__["addUnitPriority"])('month', 8);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["addRegexToken"])('M', _parse_regex__WEBPACK_IMPORTED_MODULE_5__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["addRegexToken"])('MM', _parse_regex__WEBPACK_IMPORTED_MODULE_5__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_5__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["addRegexToken"])('MMM', function (isStrict, locale) {
  return locale.monthsShortRegex(isStrict);
});
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["addRegexToken"])('MMMM', function (isStrict, locale) {
  return locale.monthsRegex(isStrict);
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_6__["addParseToken"])(['M', 'MM'], function (input, array) {
  array[_constants__WEBPACK_IMPORTED_MODULE_8__["MONTH"]] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_9__["default"])(input) - 1;
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_6__["addParseToken"])(['MMM', 'MMMM'], function (input, array, config, token) {
  var month = config._locale.monthsParse(input, token, config._strict);

  if (month != null) {
    array[_constants__WEBPACK_IMPORTED_MODULE_8__["MONTH"]] = month;
  } else {
    Object(_create_parsing_flags__WEBPACK_IMPORTED_MODULE_15__["default"])(config).invalidMonth = input;
  }
});
var MONTHS_IN_FORMAT = /D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;
var defaultLocaleMonths = 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_');
function localeMonths(m, format) {
  if (!m) {
    return Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_10__["default"])(this._months) ? this._months : this._months['standalone'];
  }

  return Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_10__["default"])(this._months) ? this._months[m.month()] : this._months[(this._months.isFormat || MONTHS_IN_FORMAT).test(format) ? 'format' : 'standalone'][m.month()];
}
var defaultLocaleMonthsShort = 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');
function localeMonthsShort(m, format) {
  if (!m) {
    return Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_10__["default"])(this._monthsShort) ? this._monthsShort : this._monthsShort['standalone'];
  }

  return Object(_utils_is_array__WEBPACK_IMPORTED_MODULE_10__["default"])(this._monthsShort) ? this._monthsShort[m.month()] : this._monthsShort[MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'][m.month()];
}

function handleStrictParse(monthName, format, strict) {
  var i,
      ii,
      mom,
      llc = monthName.toLocaleLowerCase();

  if (!this._monthsParse) {
    this._monthsParse = [];
    this._longMonthsParse = [];
    this._shortMonthsParse = [];

    for (i = 0; i < 12; ++i) {
      mom = Object(_create_utc__WEBPACK_IMPORTED_MODULE_14__["createUTC"])([2000, i]);
      this._shortMonthsParse[i] = this.monthsShort(mom, '').toLocaleLowerCase();
      this._longMonthsParse[i] = this.months(mom, '').toLocaleLowerCase();
    }
  }

  if (strict) {
    if (format === 'MMM') {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_13__["default"].call(this._shortMonthsParse, llc);
      return ii !== -1 ? ii : null;
    } else {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_13__["default"].call(this._longMonthsParse, llc);
      return ii !== -1 ? ii : null;
    }
  } else {
    if (format === 'MMM') {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_13__["default"].call(this._shortMonthsParse, llc);

      if (ii !== -1) {
        return ii;
      }

      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_13__["default"].call(this._longMonthsParse, llc);
      return ii !== -1 ? ii : null;
    } else {
      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_13__["default"].call(this._longMonthsParse, llc);

      if (ii !== -1) {
        return ii;
      }

      ii = _utils_index_of__WEBPACK_IMPORTED_MODULE_13__["default"].call(this._shortMonthsParse, llc);
      return ii !== -1 ? ii : null;
    }
  }
}

function localeMonthsParse(monthName, format, strict) {
  var i, mom, regex;

  if (this._monthsParseExact) {
    return handleStrictParse.call(this, monthName, format, strict);
  }

  if (!this._monthsParse) {
    this._monthsParse = [];
    this._longMonthsParse = [];
    this._shortMonthsParse = [];
  }

  for (i = 0; i < 12; i++) {
    mom = Object(_create_utc__WEBPACK_IMPORTED_MODULE_14__["createUTC"])([2000, i]);

    if (strict && !this._longMonthsParse[i]) {
      this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');
      this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');
    }

    if (!strict && !this._monthsParse[i]) {
      regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');
      this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');
    }

    if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {
      return i;
    } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {
      return i;
    } else if (!strict && this._monthsParse[i].test(monthName)) {
      return i;
    }
  }
}
function setMonth(mom, value) {
  var dayOfMonth;

  if (!mom.isValid()) {
    return mom;
  }

  if (typeof value === 'string') {
    if (/^\d+$/.test(value)) {
      value = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_9__["default"])(value);
    } else {
      value = mom.localeData().monthsParse(value);

      if (!Object(_utils_is_number__WEBPACK_IMPORTED_MODULE_11__["default"])(value)) {
        return mom;
      }
    }
  }

  dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));

  mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);

  return mom;
}
function getSetMonth(value) {
  if (value != null) {
    setMonth(this, value);
    _utils_hooks__WEBPACK_IMPORTED_MODULE_7__["hooks"].updateOffset(this, true);
    return this;
  } else {
    return Object(_moment_get_set__WEBPACK_IMPORTED_MODULE_0__["get"])(this, 'Month');
  }
}
function getDaysInMonth() {
  return daysInMonth(this.year(), this.month());
}
var defaultMonthsShortRegex = _parse_regex__WEBPACK_IMPORTED_MODULE_5__["matchWord"];
function monthsShortRegex(isStrict) {
  if (this._monthsParseExact) {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_1__["default"])(this, '_monthsRegex')) {
      computeMonthsParse.call(this);
    }

    if (isStrict) {
      return this._monthsShortStrictRegex;
    } else {
      return this._monthsShortRegex;
    }
  } else {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_1__["default"])(this, '_monthsShortRegex')) {
      this._monthsShortRegex = defaultMonthsShortRegex;
    }

    return this._monthsShortStrictRegex && isStrict ? this._monthsShortStrictRegex : this._monthsShortRegex;
  }
}
var defaultMonthsRegex = _parse_regex__WEBPACK_IMPORTED_MODULE_5__["matchWord"];
function monthsRegex(isStrict) {
  if (this._monthsParseExact) {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_1__["default"])(this, '_monthsRegex')) {
      computeMonthsParse.call(this);
    }

    if (isStrict) {
      return this._monthsStrictRegex;
    } else {
      return this._monthsRegex;
    }
  } else {
    if (!Object(_utils_has_own_prop__WEBPACK_IMPORTED_MODULE_1__["default"])(this, '_monthsRegex')) {
      this._monthsRegex = defaultMonthsRegex;
    }

    return this._monthsStrictRegex && isStrict ? this._monthsStrictRegex : this._monthsRegex;
  }
}

function computeMonthsParse() {
  function cmpLenRev(a, b) {
    return b.length - a.length;
  }

  var shortPieces = [],
      longPieces = [],
      mixedPieces = [],
      i,
      mom;

  for (i = 0; i < 12; i++) {
    mom = Object(_create_utc__WEBPACK_IMPORTED_MODULE_14__["createUTC"])([2000, i]);
    shortPieces.push(this.monthsShort(mom, ''));
    longPieces.push(this.months(mom, ''));
    mixedPieces.push(this.months(mom, ''));
    mixedPieces.push(this.monthsShort(mom, ''));
  }

  shortPieces.sort(cmpLenRev);
  longPieces.sort(cmpLenRev);
  mixedPieces.sort(cmpLenRev);

  for (i = 0; i < 12; i++) {
    shortPieces[i] = Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["regexEscape"])(shortPieces[i]);
    longPieces[i] = Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["regexEscape"])(longPieces[i]);
  }

  for (i = 0; i < 24; i++) {
    mixedPieces[i] = Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["regexEscape"])(mixedPieces[i]);
  }

  this._monthsRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');
  this._monthsShortRegex = this._monthsRegex;
  this._monthsStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');
  this._monthsShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/offset.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/units/offset.js ***!
  \*****************************************************/
/*! exports provided: cloneWithOffset, getSetOffset, getSetZone, setOffsetToUTC, setOffsetToLocal, setOffsetToParsedOffset, hasAlignedHourOffset, isDaylightSavingTime, isDaylightSavingTimeShifted, isLocal, isUtcOffset, isUtc */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cloneWithOffset", function() { return cloneWithOffset; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetOffset", function() { return getSetOffset; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetZone", function() { return getSetZone; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setOffsetToUTC", function() { return setOffsetToUTC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setOffsetToLocal", function() { return setOffsetToLocal; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setOffsetToParsedOffset", function() { return setOffsetToParsedOffset; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAlignedHourOffset", function() { return hasAlignedHourOffset; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isDaylightSavingTime", function() { return isDaylightSavingTime; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isDaylightSavingTimeShifted", function() { return isDaylightSavingTimeShifted; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isLocal", function() { return isLocal; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isUtcOffset", function() { return isUtcOffset; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isUtc", function() { return isUtc; });
/* harmony import */ var _utils_zero_fill__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/zero-fill */ "./node_modules/moment/src/lib/utils/zero-fill.js");
/* harmony import */ var _duration_create__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../duration/create */ "./node_modules/moment/src/lib/duration/create.js");
/* harmony import */ var _moment_add_subtract__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../moment/add-subtract */ "./node_modules/moment/src/lib/moment/add-subtract.js");
/* harmony import */ var _moment_constructor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../moment/constructor */ "./node_modules/moment/src/lib/moment/constructor.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _create_from_anything__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../create/from-anything */ "./node_modules/moment/src/lib/create/from-anything.js");
/* harmony import */ var _create_utc__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../create/utc */ "./node_modules/moment/src/lib/create/utc.js");
/* harmony import */ var _utils_is_date__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../utils/is-date */ "./node_modules/moment/src/lib/utils/is-date.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");
/* harmony import */ var _utils_is_undefined__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utils/is-undefined */ "./node_modules/moment/src/lib/utils/is-undefined.js");
/* harmony import */ var _utils_compare_arrays__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../utils/compare-arrays */ "./node_modules/moment/src/lib/utils/compare-arrays.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
















function offset(token, separator) {
  Object(_format_format__WEBPACK_IMPORTED_MODULE_4__["addFormatToken"])(token, 0, 0, function () {
    var offset = this.utcOffset();
    var sign = '+';

    if (offset < 0) {
      offset = -offset;
      sign = '-';
    }

    return sign + Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_0__["default"])(~~(offset / 60), 2) + separator + Object(_utils_zero_fill__WEBPACK_IMPORTED_MODULE_0__["default"])(~~offset % 60, 2);
  });
}

offset('Z', ':');
offset('ZZ', '');
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["addRegexToken"])('Z', _parse_regex__WEBPACK_IMPORTED_MODULE_5__["matchShortOffset"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["addRegexToken"])('ZZ', _parse_regex__WEBPACK_IMPORTED_MODULE_5__["matchShortOffset"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_6__["addParseToken"])(['Z', 'ZZ'], function (input, array, config) {
  config._useUTC = true;
  config._tzm = offsetFromString(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["matchShortOffset"], input);
});
var chunkOffset = /([\+\-]|\d\d)/gi;

function offsetFromString(matcher, string) {
  var matches = (string || '').match(matcher);

  if (matches === null) {
    return null;
  }

  var chunk = matches[matches.length - 1] || [];
  var parts = (chunk + '').match(chunkOffset) || ['-', 0, 0];
  var minutes = +(parts[1] * 60) + Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_11__["default"])(parts[2]);
  return minutes === 0 ? 0 : parts[0] === '+' ? minutes : -minutes;
}

function cloneWithOffset(input, model) {
  var res, diff;

  if (model._isUTC) {
    res = model.clone();
    diff = (Object(_moment_constructor__WEBPACK_IMPORTED_MODULE_3__["isMoment"])(input) || Object(_utils_is_date__WEBPACK_IMPORTED_MODULE_10__["default"])(input) ? input.valueOf() : Object(_create_local__WEBPACK_IMPORTED_MODULE_7__["createLocal"])(input).valueOf()) - res.valueOf();

    res._d.setTime(res._d.valueOf() + diff);

    _utils_hooks__WEBPACK_IMPORTED_MODULE_14__["hooks"].updateOffset(res, false);
    return res;
  } else {
    return Object(_create_local__WEBPACK_IMPORTED_MODULE_7__["createLocal"])(input).local();
  }
}

function getDateOffset(m) {
  return -Math.round(m._d.getTimezoneOffset() / 15) * 15;
}

_utils_hooks__WEBPACK_IMPORTED_MODULE_14__["hooks"].updateOffset = function () {};

function getSetOffset(input, keepLocalTime, keepMinutes) {
  var offset = this._offset || 0,
      localAdjust;

  if (!this.isValid()) {
    return input != null ? this : NaN;
  }

  if (input != null) {
    if (typeof input === 'string') {
      input = offsetFromString(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["matchShortOffset"], input);

      if (input === null) {
        return this;
      }
    } else if (Math.abs(input) < 16 && !keepMinutes) {
      input = input * 60;
    }

    if (!this._isUTC && keepLocalTime) {
      localAdjust = getDateOffset(this);
    }

    this._offset = input;
    this._isUTC = true;

    if (localAdjust != null) {
      this.add(localAdjust, 'm');
    }

    if (offset !== input) {
      if (!keepLocalTime || this._changeInProgress) {
        Object(_moment_add_subtract__WEBPACK_IMPORTED_MODULE_2__["addSubtract"])(this, Object(_duration_create__WEBPACK_IMPORTED_MODULE_1__["createDuration"])(input - offset, 'm'), 1, false);
      } else if (!this._changeInProgress) {
        this._changeInProgress = true;
        _utils_hooks__WEBPACK_IMPORTED_MODULE_14__["hooks"].updateOffset(this, true);
        this._changeInProgress = null;
      }
    }

    return this;
  } else {
    return this._isUTC ? offset : getDateOffset(this);
  }
}
function getSetZone(input, keepLocalTime) {
  if (input != null) {
    if (typeof input !== 'string') {
      input = -input;
    }

    this.utcOffset(input, keepLocalTime);
    return this;
  } else {
    return -this.utcOffset();
  }
}
function setOffsetToUTC(keepLocalTime) {
  return this.utcOffset(0, keepLocalTime);
}
function setOffsetToLocal(keepLocalTime) {
  if (this._isUTC) {
    this.utcOffset(0, keepLocalTime);
    this._isUTC = false;

    if (keepLocalTime) {
      this.subtract(getDateOffset(this), 'm');
    }
  }

  return this;
}
function setOffsetToParsedOffset() {
  if (this._tzm != null) {
    this.utcOffset(this._tzm, false, true);
  } else if (typeof this._i === 'string') {
    var tZone = offsetFromString(_parse_regex__WEBPACK_IMPORTED_MODULE_5__["matchOffset"], this._i);

    if (tZone != null) {
      this.utcOffset(tZone);
    } else {
      this.utcOffset(0, true);
    }
  }

  return this;
}
function hasAlignedHourOffset(input) {
  if (!this.isValid()) {
    return false;
  }

  input = input ? Object(_create_local__WEBPACK_IMPORTED_MODULE_7__["createLocal"])(input).utcOffset() : 0;
  return (this.utcOffset() - input) % 60 === 0;
}
function isDaylightSavingTime() {
  return this.utcOffset() > this.clone().month(0).utcOffset() || this.utcOffset() > this.clone().month(5).utcOffset();
}
function isDaylightSavingTimeShifted() {
  if (!Object(_utils_is_undefined__WEBPACK_IMPORTED_MODULE_12__["default"])(this._isDSTShifted)) {
    return this._isDSTShifted;
  }

  var c = {};
  Object(_moment_constructor__WEBPACK_IMPORTED_MODULE_3__["copyConfig"])(c, this);
  c = Object(_create_from_anything__WEBPACK_IMPORTED_MODULE_8__["prepareConfig"])(c);

  if (c._a) {
    var other = c._isUTC ? Object(_create_utc__WEBPACK_IMPORTED_MODULE_9__["createUTC"])(c._a) : Object(_create_local__WEBPACK_IMPORTED_MODULE_7__["createLocal"])(c._a);
    this._isDSTShifted = this.isValid() && Object(_utils_compare_arrays__WEBPACK_IMPORTED_MODULE_13__["default"])(c._a, other.toArray()) > 0;
  } else {
    this._isDSTShifted = false;
  }

  return this._isDSTShifted;
}
function isLocal() {
  return this.isValid() ? !this._isUTC : false;
}
function isUtcOffset() {
  return this.isValid() ? this._isUTC : false;
}
function isUtc() {
  return this.isValid() ? this._isUTC && this._offset === 0 : false;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/priorities.js":
/*!*********************************************************!*\
  !*** ./node_modules/moment/src/lib/units/priorities.js ***!
  \*********************************************************/
/*! exports provided: addUnitPriority, getPrioritizedUnits */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addUnitPriority", function() { return addUnitPriority; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPrioritizedUnits", function() { return getPrioritizedUnits; });
var priorities = {};
function addUnitPriority(unit, priority) {
  priorities[unit] = priority;
}
function getPrioritizedUnits(unitsObj) {
  var units = [];

  for (var u in unitsObj) {
    units.push({
      unit: u,
      priority: priorities[u]
    });
  }

  units.sort(function (a, b) {
    return a.priority - b.priority;
  });
  return units;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/quarter.js":
/*!******************************************************!*\
  !*** ./node_modules/moment/src/lib/units/quarter.js ***!
  \******************************************************/
/*! exports provided: getSetQuarter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetQuarter", function() { return getSetQuarter; });
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");







Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('Q', 0, 'Qo', 'quarter');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('quarter', 'Q');
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('quarter', 7);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('Q', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_4__["addParseToken"])('Q', function (input, array) {
  array[_constants__WEBPACK_IMPORTED_MODULE_5__["MONTH"]] = (Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_6__["default"])(input) - 1) * 3;
});
function getSetQuarter(input) {
  return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/second.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/units/second.js ***!
  \*****************************************************/
/*! exports provided: getSetSecond */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetSecond", function() { return getSetSecond; });
/* harmony import */ var _moment_get_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../moment/get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./constants */ "./node_modules/moment/src/lib/units/constants.js");







Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('s', ['ss', 2], 0, 'second');
Object(_aliases__WEBPACK_IMPORTED_MODULE_2__["addUnitAlias"])('second', 's');
Object(_priorities__WEBPACK_IMPORTED_MODULE_3__["addUnitPriority"])('second', 15);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('s', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('ss', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match2"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(['s', 'ss'], _constants__WEBPACK_IMPORTED_MODULE_6__["SECOND"]);
var getSetSecond = Object(_moment_get_set__WEBPACK_IMPORTED_MODULE_0__["makeGetSet"])('Seconds', false);

/***/ }),

/***/ "./node_modules/moment/src/lib/units/timestamp.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/units/timestamp.js ***!
  \********************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");




Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('X', 0, 0, 'unix');
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('x', 0, 0, 'valueOf');
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_1__["addRegexToken"])('x', _parse_regex__WEBPACK_IMPORTED_MODULE_1__["matchSigned"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_1__["addRegexToken"])('X', _parse_regex__WEBPACK_IMPORTED_MODULE_1__["matchTimestamp"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_2__["addParseToken"])('X', function (input, array, config) {
  config._d = new Date(parseFloat(input, 10) * 1000);
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_2__["addParseToken"])('x', function (input, array, config) {
  config._d = new Date(Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_3__["default"])(input));
});

/***/ }),

/***/ "./node_modules/moment/src/lib/units/timezone.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/units/timezone.js ***!
  \*******************************************************/
/*! exports provided: getZoneAbbr, getZoneName */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getZoneAbbr", function() { return getZoneAbbr; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getZoneName", function() { return getZoneName; });
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");

Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('z', 0, 0, 'zoneAbbr');
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('zz', 0, 0, 'zoneName');
function getZoneAbbr() {
  return this._isUTC ? 'UTC' : '';
}
function getZoneName() {
  return this._isUTC ? 'Coordinated Universal Time' : '';
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/units.js":
/*!****************************************************!*\
  !*** ./node_modules/moment/src/lib/units/units.js ***!
  \****************************************************/
/*! exports provided: normalizeUnits */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _day_of_month__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./day-of-month */ "./node_modules/moment/src/lib/units/day-of-month.js");
/* harmony import */ var _day_of_week__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./day-of-week */ "./node_modules/moment/src/lib/units/day-of-week.js");
/* harmony import */ var _day_of_year__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./day-of-year */ "./node_modules/moment/src/lib/units/day-of-year.js");
/* harmony import */ var _hour__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./hour */ "./node_modules/moment/src/lib/units/hour.js");
/* harmony import */ var _millisecond__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./millisecond */ "./node_modules/moment/src/lib/units/millisecond.js");
/* harmony import */ var _minute__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./minute */ "./node_modules/moment/src/lib/units/minute.js");
/* harmony import */ var _month__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./month */ "./node_modules/moment/src/lib/units/month.js");
/* harmony import */ var _offset__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./offset */ "./node_modules/moment/src/lib/units/offset.js");
/* harmony import */ var _quarter__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./quarter */ "./node_modules/moment/src/lib/units/quarter.js");
/* harmony import */ var _second__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./second */ "./node_modules/moment/src/lib/units/second.js");
/* harmony import */ var _timestamp__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./timestamp */ "./node_modules/moment/src/lib/units/timestamp.js");
/* harmony import */ var _timezone__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./timezone */ "./node_modules/moment/src/lib/units/timezone.js");
/* harmony import */ var _week_year__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./week-year */ "./node_modules/moment/src/lib/units/week-year.js");
/* harmony import */ var _week__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./week */ "./node_modules/moment/src/lib/units/week.js");
/* harmony import */ var _year__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./year */ "./node_modules/moment/src/lib/units/year.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "normalizeUnits", function() { return _aliases__WEBPACK_IMPORTED_MODULE_15__["normalizeUnits"]; });



















/***/ }),

/***/ "./node_modules/moment/src/lib/units/week-calendar-utils.js":
/*!******************************************************************!*\
  !*** ./node_modules/moment/src/lib/units/week-calendar-utils.js ***!
  \******************************************************************/
/*! exports provided: dayOfYearFromWeeks, weekOfYear, weeksInYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dayOfYearFromWeeks", function() { return dayOfYearFromWeeks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "weekOfYear", function() { return weekOfYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "weeksInYear", function() { return weeksInYear; });
/* harmony import */ var _year__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./year */ "./node_modules/moment/src/lib/units/year.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _create_date_from_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../create/date-from-array */ "./node_modules/moment/src/lib/create/date-from-array.js");




function firstWeekOffset(year, dow, doy) {
  var fwd = 7 + dow - doy,
      fwdlw = (7 + Object(_create_date_from_array__WEBPACK_IMPORTED_MODULE_2__["createUTCDate"])(year, 0, fwd).getUTCDay() - dow) % 7;
  return -fwdlw + fwd - 1;
}

function dayOfYearFromWeeks(year, week, weekday, dow, doy) {
  var localWeekday = (7 + weekday - dow) % 7,
      weekOffset = firstWeekOffset(year, dow, doy),
      dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset,
      resYear,
      resDayOfYear;

  if (dayOfYear <= 0) {
    resYear = year - 1;
    resDayOfYear = Object(_year__WEBPACK_IMPORTED_MODULE_0__["daysInYear"])(resYear) + dayOfYear;
  } else if (dayOfYear > Object(_year__WEBPACK_IMPORTED_MODULE_0__["daysInYear"])(year)) {
    resYear = year + 1;
    resDayOfYear = dayOfYear - Object(_year__WEBPACK_IMPORTED_MODULE_0__["daysInYear"])(year);
  } else {
    resYear = year;
    resDayOfYear = dayOfYear;
  }

  return {
    year: resYear,
    dayOfYear: resDayOfYear
  };
}
function weekOfYear(mom, dow, doy) {
  var weekOffset = firstWeekOffset(mom.year(), dow, doy),
      week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1,
      resWeek,
      resYear;

  if (week < 1) {
    resYear = mom.year() - 1;
    resWeek = week + weeksInYear(resYear, dow, doy);
  } else if (week > weeksInYear(mom.year(), dow, doy)) {
    resWeek = week - weeksInYear(mom.year(), dow, doy);
    resYear = mom.year() + 1;
  } else {
    resYear = mom.year();
    resWeek = week;
  }

  return {
    week: resWeek,
    year: resYear
  };
}
function weeksInYear(year, dow, doy) {
  var weekOffset = firstWeekOffset(year, dow, doy),
      weekOffsetNext = firstWeekOffset(year + 1, dow, doy);
  return (Object(_year__WEBPACK_IMPORTED_MODULE_0__["daysInYear"])(year) - weekOffset + weekOffsetNext) / 7;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/week-year.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/units/week-year.js ***!
  \********************************************************/
/*! exports provided: getSetWeekYear, getSetISOWeekYear, getISOWeeksInYear, getWeeksInYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetWeekYear", function() { return getSetWeekYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetISOWeekYear", function() { return getSetISOWeekYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getISOWeeksInYear", function() { return getISOWeeksInYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getWeeksInYear", function() { return getWeeksInYear; });
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _week_calendar_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./week-calendar-utils */ "./node_modules/moment/src/lib/units/week-calendar-utils.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _create_date_from_array__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../create/date-from-array */ "./node_modules/moment/src/lib/create/date-from-array.js");










Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])(0, ['gg', 2], 0, function () {
  return this.weekYear() % 100;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])(0, ['GG', 2], 0, function () {
  return this.isoWeekYear() % 100;
});

function addWeekYearFormatToken(token, getter) {
  Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])(0, [token, token.length], 0, getter);
}

addWeekYearFormatToken('gggg', 'weekYear');
addWeekYearFormatToken('ggggg', 'weekYear');
addWeekYearFormatToken('GGGG', 'isoWeekYear');
addWeekYearFormatToken('GGGGG', 'isoWeekYear');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('weekYear', 'gg');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('isoWeekYear', 'GG');
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('weekYear', 1);
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('isoWeekYear', 1);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('G', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["matchSigned"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('g', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["matchSigned"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('GG', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('gg', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('GGGG', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to4"], _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match4"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('gggg', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to4"], _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match4"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('GGGGG', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to6"], _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match6"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('ggggg', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to6"], _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match6"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_4__["addWeekParseToken"])(['gggg', 'ggggg', 'GGGG', 'GGGGG'], function (input, week, config, token) {
  week[token.substr(0, 2)] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_6__["default"])(input);
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_4__["addWeekParseToken"])(['gg', 'GG'], function (input, week, config, token) {
  week[token] = _utils_hooks__WEBPACK_IMPORTED_MODULE_7__["hooks"].parseTwoDigitYear(input);
});
function getSetWeekYear(input) {
  return getSetWeekYearHelper.call(this, input, this.week(), this.weekday(), this.localeData()._week.dow, this.localeData()._week.doy);
}
function getSetISOWeekYear(input) {
  return getSetWeekYearHelper.call(this, input, this.isoWeek(), this.isoWeekday(), 1, 4);
}
function getISOWeeksInYear() {
  return Object(_week_calendar_utils__WEBPACK_IMPORTED_MODULE_5__["weeksInYear"])(this.year(), 1, 4);
}
function getWeeksInYear() {
  var weekInfo = this.localeData()._week;

  return Object(_week_calendar_utils__WEBPACK_IMPORTED_MODULE_5__["weeksInYear"])(this.year(), weekInfo.dow, weekInfo.doy);
}

function getSetWeekYearHelper(input, week, weekday, dow, doy) {
  var weeksTarget;

  if (input == null) {
    return Object(_week_calendar_utils__WEBPACK_IMPORTED_MODULE_5__["weekOfYear"])(this, dow, doy).year;
  } else {
    weeksTarget = Object(_week_calendar_utils__WEBPACK_IMPORTED_MODULE_5__["weeksInYear"])(input, dow, doy);

    if (week > weeksTarget) {
      week = weeksTarget;
    }

    return setWeekAll.call(this, input, week, weekday, dow, doy);
  }
}

function setWeekAll(weekYear, week, weekday, dow, doy) {
  var dayOfYearData = Object(_week_calendar_utils__WEBPACK_IMPORTED_MODULE_5__["dayOfYearFromWeeks"])(weekYear, week, weekday, dow, doy),
      date = Object(_create_date_from_array__WEBPACK_IMPORTED_MODULE_9__["createUTCDate"])(dayOfYearData.year, 0, dayOfYearData.dayOfYear);
  this.year(date.getUTCFullYear());
  this.month(date.getUTCMonth());
  this.date(date.getUTCDate());
  return this;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/week.js":
/*!***************************************************!*\
  !*** ./node_modules/moment/src/lib/units/week.js ***!
  \***************************************************/
/*! exports provided: localeWeek, defaultLocaleWeek, localeFirstDayOfWeek, localeFirstDayOfYear, getSetWeek, getSetISOWeek */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeWeek", function() { return localeWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultLocaleWeek", function() { return defaultLocaleWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeFirstDayOfWeek", function() { return localeFirstDayOfWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localeFirstDayOfYear", function() { return localeFirstDayOfYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetWeek", function() { return getSetWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetISOWeek", function() { return getSetISOWeek; });
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");
/* harmony import */ var _create_local__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../create/local */ "./node_modules/moment/src/lib/create/local.js");
/* harmony import */ var _week_calendar_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./week-calendar-utils */ "./node_modules/moment/src/lib/units/week-calendar-utils.js");








Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('w', ['ww', 2], 'wo', 'week');
Object(_format_format__WEBPACK_IMPORTED_MODULE_0__["addFormatToken"])('W', ['WW', 2], 'Wo', 'isoWeek');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('week', 'w');
Object(_aliases__WEBPACK_IMPORTED_MODULE_1__["addUnitAlias"])('isoWeek', 'W');
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('week', 5);
Object(_priorities__WEBPACK_IMPORTED_MODULE_2__["addUnitPriority"])('isoWeek', 5);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('w', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('ww', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('W', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_3__["addRegexToken"])('WW', _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_3__["match2"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_4__["addWeekParseToken"])(['w', 'ww', 'W', 'WW'], function (input, week, config, token) {
  week[token.substr(0, 1)] = Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_5__["default"])(input);
});
function localeWeek(mom) {
  return Object(_week_calendar_utils__WEBPACK_IMPORTED_MODULE_7__["weekOfYear"])(mom, this._week.dow, this._week.doy).week;
}
var defaultLocaleWeek = {
  dow: 0,
  doy: 6
};
function localeFirstDayOfWeek() {
  return this._week.dow;
}
function localeFirstDayOfYear() {
  return this._week.doy;
}
function getSetWeek(input) {
  var week = this.localeData().week(this);
  return input == null ? week : this.add((input - week) * 7, 'd');
}
function getSetISOWeek(input) {
  var week = Object(_week_calendar_utils__WEBPACK_IMPORTED_MODULE_7__["weekOfYear"])(this, 1, 4).week;
  return input == null ? week : this.add((input - week) * 7, 'd');
}

/***/ }),

/***/ "./node_modules/moment/src/lib/units/year.js":
/*!***************************************************!*\
  !*** ./node_modules/moment/src/lib/units/year.js ***!
  \***************************************************/
/*! exports provided: daysInYear, isLeapYear, getSetYear, getIsLeapYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "daysInYear", function() { return daysInYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isLeapYear", function() { return isLeapYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSetYear", function() { return getSetYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getIsLeapYear", function() { return getIsLeapYear; });
/* harmony import */ var _moment_get_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../moment/get-set */ "./node_modules/moment/src/lib/moment/get-set.js");
/* harmony import */ var _format_format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../format/format */ "./node_modules/moment/src/lib/format/format.js");
/* harmony import */ var _aliases__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./aliases */ "./node_modules/moment/src/lib/units/aliases.js");
/* harmony import */ var _priorities__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./priorities */ "./node_modules/moment/src/lib/units/priorities.js");
/* harmony import */ var _parse_regex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../parse/regex */ "./node_modules/moment/src/lib/parse/regex.js");
/* harmony import */ var _parse_token__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../parse/token */ "./node_modules/moment/src/lib/parse/token.js");
/* harmony import */ var _utils_hooks__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./constants */ "./node_modules/moment/src/lib/units/constants.js");
/* harmony import */ var _utils_to_int__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utils/to-int */ "./node_modules/moment/src/lib/utils/to-int.js");









Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])('Y', 0, 0, function () {
  var y = this.year();
  return y <= 9999 ? '' + y : '+' + y;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['YY', 2], 0, function () {
  return this.year() % 100;
});
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['YYYY', 4], 0, 'year');
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['YYYYY', 5], 0, 'year');
Object(_format_format__WEBPACK_IMPORTED_MODULE_1__["addFormatToken"])(0, ['YYYYYY', 6, true], 0, 'year');
Object(_aliases__WEBPACK_IMPORTED_MODULE_2__["addUnitAlias"])('year', 'y');
Object(_priorities__WEBPACK_IMPORTED_MODULE_3__["addUnitPriority"])('year', 1);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('Y', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["matchSigned"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('YY', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to2"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match2"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('YYYY', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to4"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match4"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('YYYYY', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to6"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match6"]);
Object(_parse_regex__WEBPACK_IMPORTED_MODULE_4__["addRegexToken"])('YYYYYY', _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match1to6"], _parse_regex__WEBPACK_IMPORTED_MODULE_4__["match6"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])(['YYYYY', 'YYYYYY'], _constants__WEBPACK_IMPORTED_MODULE_7__["YEAR"]);
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])('YYYY', function (input, array) {
  array[_constants__WEBPACK_IMPORTED_MODULE_7__["YEAR"]] = input.length === 2 ? _utils_hooks__WEBPACK_IMPORTED_MODULE_6__["hooks"].parseTwoDigitYear(input) : Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_8__["default"])(input);
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])('YY', function (input, array) {
  array[_constants__WEBPACK_IMPORTED_MODULE_7__["YEAR"]] = _utils_hooks__WEBPACK_IMPORTED_MODULE_6__["hooks"].parseTwoDigitYear(input);
});
Object(_parse_token__WEBPACK_IMPORTED_MODULE_5__["addParseToken"])('Y', function (input, array) {
  array[_constants__WEBPACK_IMPORTED_MODULE_7__["YEAR"]] = parseInt(input, 10);
});
function daysInYear(year) {
  return isLeapYear(year) ? 366 : 365;
}
function isLeapYear(year) {
  return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
}

_utils_hooks__WEBPACK_IMPORTED_MODULE_6__["hooks"].parseTwoDigitYear = function (input) {
  return Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_8__["default"])(input) + (Object(_utils_to_int__WEBPACK_IMPORTED_MODULE_8__["default"])(input) > 68 ? 1900 : 2000);
};

var getSetYear = Object(_moment_get_set__WEBPACK_IMPORTED_MODULE_0__["makeGetSet"])('FullYear', true);
function getIsLeapYear() {
  return isLeapYear(this.year());
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/abs-ceil.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/abs-ceil.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return absCeil; });
function absCeil(number) {
  if (number < 0) {
    return Math.floor(number);
  } else {
    return Math.ceil(number);
  }
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/abs-floor.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/abs-floor.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return absFloor; });
function absFloor(number) {
  if (number < 0) {
    return Math.ceil(number) || 0;
  } else {
    return Math.floor(number);
  }
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/abs-round.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/abs-round.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return absRound; });
function absRound(number) {
  if (number < 0) {
    return Math.round(-1 * number) * -1;
  } else {
    return Math.round(number);
  }
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/compare-arrays.js":
/*!*************************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/compare-arrays.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return compareArrays; });
/* harmony import */ var _to_int__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./to-int */ "./node_modules/moment/src/lib/utils/to-int.js");

function compareArrays(array1, array2, dontConvert) {
  var len = Math.min(array1.length, array2.length),
      lengthDiff = Math.abs(array1.length - array2.length),
      diffs = 0,
      i;

  for (i = 0; i < len; i++) {
    if (dontConvert && array1[i] !== array2[i] || !dontConvert && Object(_to_int__WEBPACK_IMPORTED_MODULE_0__["default"])(array1[i]) !== Object(_to_int__WEBPACK_IMPORTED_MODULE_0__["default"])(array2[i])) {
      diffs++;
    }
  }

  return diffs + lengthDiff;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/defaults.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/defaults.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return defaults; });
function defaults(a, b, c) {
  if (a != null) {
    return a;
  }

  if (b != null) {
    return b;
  }

  return c;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/deprecate.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/deprecate.js ***!
  \********************************************************/
/*! exports provided: deprecate, deprecateSimple */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deprecate", function() { return deprecate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deprecateSimple", function() { return deprecateSimple; });
/* harmony import */ var _extend__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./extend */ "./node_modules/moment/src/lib/utils/extend.js");
/* harmony import */ var _hooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _is_undefined__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./is-undefined */ "./node_modules/moment/src/lib/utils/is-undefined.js");




function warn(msg) {
  if (_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].suppressDeprecationWarnings === false && typeof console !== 'undefined' && console.warn) {
    console.warn('Deprecation warning: ' + msg);
  }
}

function deprecate(msg, fn) {
  var firstTime = true;
  return Object(_extend__WEBPACK_IMPORTED_MODULE_0__["default"])(function () {
    if (_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].deprecationHandler != null) {
      _hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].deprecationHandler(null, msg);
    }

    if (firstTime) {
      var args = [];
      var arg;

      for (var i = 0; i < arguments.length; i++) {
        arg = '';

        if (typeof arguments[i] === 'object') {
          arg += '\n[' + i + '] ';

          for (var key in arguments[0]) {
            arg += key + ': ' + arguments[0][key] + ', ';
          }

          arg = arg.slice(0, -2);
        } else {
          arg = arguments[i];
        }

        args.push(arg);
      }

      warn(msg + '\nArguments: ' + Array.prototype.slice.call(args).join('') + '\n' + new Error().stack);
      firstTime = false;
    }

    return fn.apply(this, arguments);
  }, fn);
}
var deprecations = {};
function deprecateSimple(name, msg) {
  if (_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].deprecationHandler != null) {
    _hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].deprecationHandler(name, msg);
  }

  if (!deprecations[name]) {
    warn(msg);
    deprecations[name] = true;
  }
}
_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].suppressDeprecationWarnings = false;
_hooks__WEBPACK_IMPORTED_MODULE_1__["hooks"].deprecationHandler = null;

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/extend.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/extend.js ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return extend; });
/* harmony import */ var _has_own_prop__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");

function extend(a, b) {
  for (var i in b) {
    if (Object(_has_own_prop__WEBPACK_IMPORTED_MODULE_0__["default"])(b, i)) {
      a[i] = b[i];
    }
  }

  if (Object(_has_own_prop__WEBPACK_IMPORTED_MODULE_0__["default"])(b, 'toString')) {
    a.toString = b.toString;
  }

  if (Object(_has_own_prop__WEBPACK_IMPORTED_MODULE_0__["default"])(b, 'valueOf')) {
    a.valueOf = b.valueOf;
  }

  return a;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/has-own-prop.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/has-own-prop.js ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return hasOwnProp; });
function hasOwnProp(a, b) {
  return Object.prototype.hasOwnProperty.call(a, b);
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/hooks.js":
/*!****************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/hooks.js ***!
  \****************************************************/
/*! exports provided: hooks, setHookCallback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hooks", function() { return hooks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setHookCallback", function() { return setHookCallback; });

var hookCallback;

function hooks() {
  return hookCallback.apply(null, arguments);
}

function setHookCallback(callback) {
  hookCallback = callback;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/index-of.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/index-of.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return indexOf; });
var indexOf;

if (Array.prototype.indexOf) {
  indexOf = Array.prototype.indexOf;
} else {
  indexOf = function indexOf(o) {
    var i;

    for (i = 0; i < this.length; ++i) {
      if (this[i] === o) {
        return i;
      }
    }

    return -1;
  };
}



/***/ }),

/***/ "./node_modules/moment/src/lib/utils/is-array.js":
/*!*******************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/is-array.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return isArray; });
function isArray(input) {
  return input instanceof Array || Object.prototype.toString.call(input) === '[object Array]';
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/is-date.js":
/*!******************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/is-date.js ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return isDate; });
function isDate(input) {
  return input instanceof Date || Object.prototype.toString.call(input) === '[object Date]';
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/is-function.js":
/*!**********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/is-function.js ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return isFunction; });
function isFunction(input) {
  return input instanceof Function || Object.prototype.toString.call(input) === '[object Function]';
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/is-number.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/is-number.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return isNumber; });
function isNumber(input) {
  return typeof input === 'number' || Object.prototype.toString.call(input) === '[object Number]';
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/is-object-empty.js":
/*!**************************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/is-object-empty.js ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return isObjectEmpty; });
function isObjectEmpty(obj) {
  if (Object.getOwnPropertyNames) {
    return Object.getOwnPropertyNames(obj).length === 0;
  } else {
    var k;

    for (k in obj) {
      if (obj.hasOwnProperty(k)) {
        return false;
      }
    }

    return true;
  }
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/is-object.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/is-object.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return isObject; });
function isObject(input) {
  return input != null && Object.prototype.toString.call(input) === '[object Object]';
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/is-undefined.js":
/*!***********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/is-undefined.js ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return isUndefined; });
function isUndefined(input) {
  return input === void 0;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/keys.js":
/*!***************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/keys.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return keys; });
/* harmony import */ var _has_own_prop__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./has-own-prop */ "./node_modules/moment/src/lib/utils/has-own-prop.js");

var keys;

if (Object.keys) {
  keys = Object.keys;
} else {
  keys = function keys(obj) {
    var i,
        res = [];

    for (i in obj) {
      if (Object(_has_own_prop__WEBPACK_IMPORTED_MODULE_0__["default"])(obj, i)) {
        res.push(i);
      }
    }

    return res;
  };
}



/***/ }),

/***/ "./node_modules/moment/src/lib/utils/map.js":
/*!**************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/map.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return map; });
function map(arr, fn) {
  var res = [],
      i;

  for (i = 0; i < arr.length; ++i) {
    res.push(fn(arr[i], i));
  }

  return res;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/mod.js":
/*!**************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/mod.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return mod; });
function mod(n, x) {
  return (n % x + x) % x;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/some.js":
/*!***************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/some.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return some; });
var some;

if (Array.prototype.some) {
  some = Array.prototype.some;
} else {
  some = function some(fun) {
    var t = Object(this);
    var len = t.length >>> 0;

    for (var i = 0; i < len; i++) {
      if (i in t && fun.call(this, t[i], i, t)) {
        return true;
      }
    }

    return false;
  };
}



/***/ }),

/***/ "./node_modules/moment/src/lib/utils/to-int.js":
/*!*****************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/to-int.js ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return toInt; });
/* harmony import */ var _abs_floor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./abs-floor */ "./node_modules/moment/src/lib/utils/abs-floor.js");

function toInt(argumentForCoercion) {
  var coercedNumber = +argumentForCoercion,
      value = 0;

  if (coercedNumber !== 0 && isFinite(coercedNumber)) {
    value = Object(_abs_floor__WEBPACK_IMPORTED_MODULE_0__["default"])(coercedNumber);
  }

  return value;
}

/***/ }),

/***/ "./node_modules/moment/src/lib/utils/zero-fill.js":
/*!********************************************************!*\
  !*** ./node_modules/moment/src/lib/utils/zero-fill.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return zeroFill; });
function zeroFill(number, targetLength, forceSign) {
  var absNumber = '' + Math.abs(number),
      zerosToFill = targetLength - absNumber.length,
      sign = number >= 0;
  return (sign ? forceSign ? '+' : '' : '-') + Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;
}

/***/ }),

/***/ "./node_modules/moment/src/moment.js":
/*!*******************************************!*\
  !*** ./node_modules/moment/src/moment.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./lib/utils/hooks */ "./node_modules/moment/src/lib/utils/hooks.js");
/* harmony import */ var _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/moment/moment */ "./node_modules/moment/src/lib/moment/moment.js");
/* harmony import */ var _lib_moment_calendar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/moment/calendar */ "./node_modules/moment/src/lib/moment/calendar.js");
/* harmony import */ var _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./lib/locale/locale */ "./node_modules/moment/src/lib/locale/locale.js");
/* harmony import */ var _lib_duration_duration__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lib/duration/duration */ "./node_modules/moment/src/lib/duration/duration.js");
/* harmony import */ var _lib_units_units__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./lib/units/units */ "./node_modules/moment/src/lib/units/units.js");
/* harmony import */ var _lib_utils_is_date__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./lib/utils/is-date */ "./node_modules/moment/src/lib/utils/is-date.js");

_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].version = '2.24.0';






Object(_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["setHookCallback"])(_lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["createLocal"]);
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].fn = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["momentPrototype"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].min = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["min"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].max = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["max"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].now = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["now"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].utc = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["createUTC"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].unix = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["createUnix"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].months = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["listMonths"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].isDate = _lib_utils_is_date__WEBPACK_IMPORTED_MODULE_6__["default"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].locale = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["getSetGlobalLocale"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].invalid = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["createInvalid"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].duration = _lib_duration_duration__WEBPACK_IMPORTED_MODULE_4__["createDuration"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].isMoment = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["isMoment"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].weekdays = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["listWeekdays"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].parseZone = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["createInZone"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].localeData = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["getLocale"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].isDuration = _lib_duration_duration__WEBPACK_IMPORTED_MODULE_4__["isDuration"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].monthsShort = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["listMonthsShort"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].weekdaysMin = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["listWeekdaysMin"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].defineLocale = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["defineLocale"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].updateLocale = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["updateLocale"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].locales = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["listLocales"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].weekdaysShort = _lib_locale_locale__WEBPACK_IMPORTED_MODULE_3__["listWeekdaysShort"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].normalizeUnits = _lib_units_units__WEBPACK_IMPORTED_MODULE_5__["normalizeUnits"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].relativeTimeRounding = _lib_duration_duration__WEBPACK_IMPORTED_MODULE_4__["getSetRelativeTimeRounding"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].relativeTimeThreshold = _lib_duration_duration__WEBPACK_IMPORTED_MODULE_4__["getSetRelativeTimeThreshold"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].calendarFormat = _lib_moment_calendar__WEBPACK_IMPORTED_MODULE_2__["getCalendarFormat"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].prototype = _lib_moment_moment__WEBPACK_IMPORTED_MODULE_1__["momentPrototype"];
_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"].HTML5_FMT = {
  DATETIME_LOCAL: 'YYYY-MM-DDTHH:mm',
  DATETIME_LOCAL_SECONDS: 'YYYY-MM-DDTHH:mm:ss',
  DATETIME_LOCAL_MS: 'YYYY-MM-DDTHH:mm:ss.SSS',
  DATE: 'YYYY-MM-DD',
  TIME: 'HH:mm',
  TIME_SECONDS: 'HH:mm:ss',
  TIME_MS: 'HH:mm:ss.SSS',
  WEEK: 'GGGG-[W]WW',
  MONTH: 'YYYY-MM'
};
/* harmony default export */ __webpack_exports__["default"] = (_lib_utils_hooks__WEBPACK_IMPORTED_MODULE_0__["hooks"]);

/***/ }),

/***/ "./node_modules/ol/Collection.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/Collection.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: CollectionEvent, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(66);

/***/ }),

/***/ "./node_modules/ol/Feature.js":
/*!************************************************************************!*\
  !*** delegated ./node_modules/ol/Feature.js from dll-reference vendor ***!
  \************************************************************************/
/*! exports provided: createStyleFunction, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(69);

/***/ }),

/***/ "./node_modules/ol/Geolocation.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/Geolocation.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1033);

/***/ }),

/***/ "./node_modules/ol/Map.js":
/*!********************************************************************!*\
  !*** delegated ./node_modules/ol/Map.js from dll-reference vendor ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1034);

/***/ }),

/***/ "./node_modules/ol/MapBrowserEvent.js":
/*!********************************************************************************!*\
  !*** delegated ./node_modules/ol/MapBrowserEvent.js from dll-reference vendor ***!
  \********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(359);

/***/ }),

/***/ "./node_modules/ol/MapBrowserPointerEvent.js":
/*!***************************************************************************************!*\
  !*** delegated ./node_modules/ol/MapBrowserPointerEvent.js from dll-reference vendor ***!
  \***************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(167);

/***/ }),

/***/ "./node_modules/ol/Object.js":
/*!***********************************************************************!*\
  !*** delegated ./node_modules/ol/Object.js from dll-reference vendor ***!
  \***********************************************************************/
/*! exports provided: ObjectEvent, getChangeEventType, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(32);

/***/ }),

/***/ "./node_modules/ol/Observable.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/Observable.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: unByKey, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(357);

/***/ }),

/***/ "./node_modules/ol/Overlay.js":
/*!************************************************************************!*\
  !*** delegated ./node_modules/ol/Overlay.js from dll-reference vendor ***!
  \************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(570);

/***/ }),

/***/ "./node_modules/ol/OverlayPositioning.js":
/*!***********************************************************************************!*\
  !*** delegated ./node_modules/ol/OverlayPositioning.js from dll-reference vendor ***!
  \***********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(102);

/***/ }),

/***/ "./node_modules/ol/View.js":
/*!*********************************************************************!*\
  !*** delegated ./node_modules/ol/View.js from dll-reference vendor ***!
  \*********************************************************************/
/*! exports provided: createCenterConstraint, createResolutionConstraint, createRotationConstraint, isNoopAnimation, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(569);

/***/ }),

/***/ "./node_modules/ol/array.js":
/*!**********************************************************************!*\
  !*** delegated ./node_modules/ol/array.js from dll-reference vendor ***!
  \**********************************************************************/
/*! exports provided: binarySearch, numberSafeCompareFunction, includes, linearFindNearest, reverseSubArray, extend, remove, find, equals, stableSort, findIndex, isSorted */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(14);

/***/ }),

/***/ "./node_modules/ol/color.js":
/*!**********************************************************************!*\
  !*** delegated ./node_modules/ol/color.js from dll-reference vendor ***!
  \**********************************************************************/
/*! exports provided: asString, fromString, asArray, normalize, toString, isStringColor */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(157);

/***/ }),

/***/ "./node_modules/ol/control/Control.js":
/*!********************************************************************************!*\
  !*** delegated ./node_modules/ol/control/Control.js from dll-reference vendor ***!
  \********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(75);

/***/ }),

/***/ "./node_modules/ol/control/MousePosition.js":
/*!**************************************************************************************!*\
  !*** delegated ./node_modules/ol/control/MousePosition.js from dll-reference vendor ***!
  \**************************************************************************************/
/*! exports provided: render, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(560);

/***/ }),

/***/ "./node_modules/ol/control/Rotate.js":
/*!*******************************************************************************!*\
  !*** delegated ./node_modules/ol/control/Rotate.js from dll-reference vendor ***!
  \*******************************************************************************/
/*! exports provided: render, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(347);

/***/ }),

/***/ "./node_modules/ol/control/ScaleLine.js":
/*!**********************************************************************************!*\
  !*** delegated ./node_modules/ol/control/ScaleLine.js from dll-reference vendor ***!
  \**********************************************************************************/
/*! exports provided: Units, render, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(561);

/***/ }),

/***/ "./node_modules/ol/control/Zoom.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/ol/control/Zoom.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(348);

/***/ }),

/***/ "./node_modules/ol/coordinate.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/coordinate.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: add, closestOnCircle, closestOnSegment, createStringXY, degreesToStringHDMS, format, equals, rotate, scale, squaredDistance, distance, squaredDistanceToSegment, toStringHDMS, toStringXY */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(35);

/***/ }),

/***/ "./node_modules/ol/dom.js":
/*!********************************************************************!*\
  !*** delegated ./node_modules/ol/dom.js from dll-reference vendor ***!
  \********************************************************************/
/*! exports provided: createCanvasContext2D, outerWidth, outerHeight, replaceNode, removeNode, removeChildren, replaceChildren */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(26);

/***/ }),

/***/ "./node_modules/ol/easing.js":
/*!***********************************************************************!*\
  !*** delegated ./node_modules/ol/easing.js from dll-reference vendor ***!
  \***********************************************************************/
/*! exports provided: easeIn, easeOut, inAndOut, linear, upAndDown */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(78);

/***/ }),

/***/ "./node_modules/ol/events.js":
/*!***********************************************************************!*\
  !*** delegated ./node_modules/ol/events.js from dll-reference vendor ***!
  \***********************************************************************/
/*! exports provided: listen, listenOnce, unlistenByKey */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(10);

/***/ }),

/***/ "./node_modules/ol/events/Event.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/ol/events/Event.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! exports provided: stopPropagation, preventDefault, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(44);

/***/ }),

/***/ "./node_modules/ol/events/Target.js":
/*!******************************************************************************!*\
  !*** delegated ./node_modules/ol/events/Target.js from dll-reference vendor ***!
  \******************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(129);

/***/ }),

/***/ "./node_modules/ol/events/condition.js":
/*!*********************************************************************************!*\
  !*** delegated ./node_modules/ol/events/condition.js from dll-reference vendor ***!
  \*********************************************************************************/
/*! exports provided: altKeyOnly, altShiftKeysOnly, focus, always, click, mouseActionButton, never, pointerMove, singleClick, doubleClick, noModifierKeys, platformModifierKeyOnly, shiftKeyOnly, targetNotEditable, mouseOnly, touchOnly, penOnly, primaryAction */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(38);

/***/ }),

/***/ "./node_modules/ol/extent.js":
/*!***********************************************************************!*\
  !*** delegated ./node_modules/ol/extent.js from dll-reference vendor ***!
  \***********************************************************************/
/*! exports provided: boundingExtent, buffer, clone, closestSquaredDistanceXY, containsCoordinate, containsExtent, containsXY, coordinateRelationship, createEmpty, createOrUpdate, createOrUpdateEmpty, createOrUpdateFromCoordinate, createOrUpdateFromCoordinates, createOrUpdateFromFlatCoordinates, createOrUpdateFromRings, equals, extend, extendCoordinate, extendCoordinates, extendFlatCoordinates, extendRings, extendXY, forEachCorner, getArea, getBottomLeft, getBottomRight, getCenter, getCorner, getEnlargedArea, getForViewAndSize, getHeight, getIntersectionArea, getIntersection, getMargin, getSize, getTopLeft, getTopRight, getWidth, intersects, isEmpty, returnOrUpdate, scaleFromCenter, intersectsSegment, applyTransform */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(2);

/***/ }),

/***/ "./node_modules/ol/format/Feature.js":
/*!*******************************************************************************!*\
  !*** delegated ./node_modules/ol/format/Feature.js from dll-reference vendor ***!
  \*******************************************************************************/
/*! exports provided: default, transformGeometryWithOptions, transformExtentWithOptions */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(58);

/***/ }),

/***/ "./node_modules/ol/format/GML2.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/format/GML2.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(304);

/***/ }),

/***/ "./node_modules/ol/format/GML3.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/format/GML3.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(208);

/***/ }),

/***/ "./node_modules/ol/format/GPX.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/format/GPX.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1035);

/***/ }),

/***/ "./node_modules/ol/format/GeoJSON.js":
/*!*******************************************************************************!*\
  !*** delegated ./node_modules/ol/format/GeoJSON.js from dll-reference vendor ***!
  \*******************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1036);

/***/ }),

/***/ "./node_modules/ol/format/KML.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/format/KML.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: getDefaultFillStyle, getDefaultImageStyle, getDefaultStrokeStyle, getDefaultTextStyle, getDefaultStyle, getDefaultStyleArray, readFlatCoordinates, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1037);

/***/ }),

/***/ "./node_modules/ol/format/TextFeature.js":
/*!***********************************************************************************!*\
  !*** delegated ./node_modules/ol/format/TextFeature.js from dll-reference vendor ***!
  \***********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1038);

/***/ }),

/***/ "./node_modules/ol/format/WFS.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/format/WFS.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: writeFilter, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1039);

/***/ }),

/***/ "./node_modules/ol/format/WMSCapabilities.js":
/*!***************************************************************************************!*\
  !*** delegated ./node_modules/ol/format/WMSCapabilities.js from dll-reference vendor ***!
  \***************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1040);

/***/ }),

/***/ "./node_modules/ol/format/WMSGetFeatureInfo.js":
/*!*****************************************************************************************!*\
  !*** delegated ./node_modules/ol/format/WMSGetFeatureInfo.js from dll-reference vendor ***!
  \*****************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1041);

/***/ }),

/***/ "./node_modules/ol/format/WMTSCapabilities.js":
/*!****************************************************************************************!*\
  !*** delegated ./node_modules/ol/format/WMTSCapabilities.js from dll-reference vendor ***!
  \****************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1042);

/***/ }),

/***/ "./node_modules/ol/format/XML.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/format/XML.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(250);

/***/ }),

/***/ "./node_modules/ol/format/filter.js":
/*!******************************************************************************!*\
  !*** delegated ./node_modules/ol/format/filter.js from dll-reference vendor ***!
  \******************************************************************************/
/*! exports provided: and, or, not, bbox, contains, intersects, within, equalTo, notEqualTo, lessThan, lessThanOrEqualTo, greaterThan, greaterThanOrEqualTo, isNull, between, like, during */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(485);

/***/ }),

/***/ "./node_modules/ol/functions.js":
/*!**************************************************************************!*\
  !*** delegated ./node_modules/ol/functions.js from dll-reference vendor ***!
  \**************************************************************************/
/*! exports provided: TRUE, FALSE, VOID, memoizeOne */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(34);

/***/ }),

/***/ "./node_modules/ol/geom/Circle.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/Circle.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(478);

/***/ }),

/***/ "./node_modules/ol/geom/Geometry.js":
/*!******************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/Geometry.js from dll-reference vendor ***!
  \******************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(358);

/***/ }),

/***/ "./node_modules/ol/geom/GeometryCollection.js":
/*!****************************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/GeometryCollection.js from dll-reference vendor ***!
  \****************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(257);

/***/ }),

/***/ "./node_modules/ol/geom/GeometryLayout.js":
/*!************************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/GeometryLayout.js from dll-reference vendor ***!
  \************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(29);

/***/ }),

/***/ "./node_modules/ol/geom/LineString.js":
/*!********************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/LineString.js from dll-reference vendor ***!
  \********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(85);

/***/ }),

/***/ "./node_modules/ol/geom/MultiLineString.js":
/*!*************************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/MultiLineString.js from dll-reference vendor ***!
  \*************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(119);

/***/ }),

/***/ "./node_modules/ol/geom/MultiPoint.js":
/*!********************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/MultiPoint.js from dll-reference vendor ***!
  \********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(158);

/***/ }),

/***/ "./node_modules/ol/geom/MultiPolygon.js":
/*!**********************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/MultiPolygon.js from dll-reference vendor ***!
  \**********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(159);

/***/ }),

/***/ "./node_modules/ol/geom/Point.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/Point.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(72);

/***/ }),

/***/ "./node_modules/ol/geom/Polygon.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/Polygon.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! exports provided: default, circular, fromExtent, fromCircle, makeRegular */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(49);

/***/ }),

/***/ "./node_modules/ol/geom/SimpleGeometry.js":
/*!************************************************************************************!*\
  !*** delegated ./node_modules/ol/geom/SimpleGeometry.js from dll-reference vendor ***!
  \************************************************************************************/
/*! exports provided: getStrideForLayout, transformGeom2D, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(82);

/***/ }),

/***/ "./node_modules/ol/has.js":
/*!********************************************************************!*\
  !*** delegated ./node_modules/ol/has.js from dll-reference vendor ***!
  \********************************************************************/
/*! exports provided: FIREFOX, SAFARI, WEBKIT, MAC, DEVICE_PIXEL_RATIO, IMAGE_DECODE */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(93);

/***/ }),

/***/ "./node_modules/ol/interaction.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/interaction.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: DoubleClickZoom, DragAndDrop, DragBox, DragPan, DragRotate, DragRotateAndZoom, DragZoom, Draw, Extent, Interaction, KeyboardPan, KeyboardZoom, Modify, MouseWheelZoom, PinchRotate, PinchZoom, Pointer, Select, Snap, Translate, defaults */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(571);

/***/ }),

/***/ "./node_modules/ol/interaction/Draw.js":
/*!*********************************************************************************!*\
  !*** delegated ./node_modules/ol/interaction/Draw.js from dll-reference vendor ***!
  \*********************************************************************************/
/*! exports provided: createRegularPolygon, createBox, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(562);

/***/ }),

/***/ "./node_modules/ol/interaction/Interaction.js":
/*!****************************************************************************************!*\
  !*** delegated ./node_modules/ol/interaction/Interaction.js from dll-reference vendor ***!
  \****************************************************************************************/
/*! exports provided: pan, zoomByDelta, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(76);

/***/ }),

/***/ "./node_modules/ol/interaction/Modify.js":
/*!***********************************************************************************!*\
  !*** delegated ./node_modules/ol/interaction/Modify.js from dll-reference vendor ***!
  \***********************************************************************************/
/*! exports provided: ModifyEvent, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(563);

/***/ }),

/***/ "./node_modules/ol/interaction/Pointer.js":
/*!************************************************************************************!*\
  !*** delegated ./node_modules/ol/interaction/Pointer.js from dll-reference vendor ***!
  \************************************************************************************/
/*! exports provided: centroid, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(60);

/***/ }),

/***/ "./node_modules/ol/interaction/Snap.js":
/*!*********************************************************************************!*\
  !*** delegated ./node_modules/ol/interaction/Snap.js from dll-reference vendor ***!
  \*********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(564);

/***/ }),

/***/ "./node_modules/ol/interaction/Translate.js":
/*!**************************************************************************************!*\
  !*** delegated ./node_modules/ol/interaction/Translate.js from dll-reference vendor ***!
  \**************************************************************************************/
/*! exports provided: TranslateEvent, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(565);

/***/ }),

/***/ "./node_modules/ol/layer.js":
/*!**********************************************************************!*\
  !*** delegated ./node_modules/ol/layer.js from dll-reference vendor ***!
  \**********************************************************************/
/*! exports provided: Group, Heatmap, Image, Layer, Tile, Vector, VectorImage, VectorTile */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1043);

/***/ }),

/***/ "./node_modules/ol/layer/Base.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/layer/Base.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(360);

/***/ }),

/***/ "./node_modules/ol/layer/Group.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/layer/Group.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(346);

/***/ }),

/***/ "./node_modules/ol/layer/Image.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/layer/Image.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(350);

/***/ }),

/***/ "./node_modules/ol/layer/Layer.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/layer/Layer.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: inView, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(103);

/***/ }),

/***/ "./node_modules/ol/layer/Tile.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/layer/Tile.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(351);

/***/ }),

/***/ "./node_modules/ol/layer/Vector.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/ol/layer/Vector.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(135);

/***/ }),

/***/ "./node_modules/ol/math.js":
/*!*********************************************************************!*\
  !*** delegated ./node_modules/ol/math.js from dll-reference vendor ***!
  \*********************************************************************/
/*! exports provided: clamp, cosh, squaredSegmentDistance, squaredDistance, solveLinearSystem, toDegrees, toRadians, modulo, lerp */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(19);

/***/ }),

/***/ "./node_modules/ol/obj.js":
/*!********************************************************************!*\
  !*** delegated ./node_modules/ol/obj.js from dll-reference vendor ***!
  \********************************************************************/
/*! exports provided: assign, clear, getValues, isEmpty */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(13);

/***/ }),

/***/ "./node_modules/ol/proj.js":
/*!*********************************************************************!*\
  !*** delegated ./node_modules/ol/proj.js from dll-reference vendor ***!
  \*********************************************************************/
/*! exports provided: METERS_PER_UNIT, Projection, cloneTransform, identityTransform, addProjection, addProjections, get, getPointResolution, addEquivalentProjections, addEquivalentTransforms, clearAllProjections, createProjection, createTransformFromCoordinateTransform, addCoordinateTransforms, fromLonLat, toLonLat, equivalent, getTransformFromProjections, getTransform, transform, transformExtent, transformWithProjections, setUserProjection, clearUserProjection, getUserProjection, useGeographic, toUserCoordinate, fromUserCoordinate, toUserExtent, fromUserExtent, addCommon */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(7);

/***/ }),

/***/ "./node_modules/ol/render/Event.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/ol/render/Event.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(361);

/***/ }),

/***/ "./node_modules/ol/size.js":
/*!*********************************************************************!*\
  !*** delegated ./node_modules/ol/size.js from dll-reference vendor ***!
  \*********************************************************************/
/*! exports provided: buffer, hasArea, scale, toSize */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(52);

/***/ }),

/***/ "./node_modules/ol/source.js":
/*!***********************************************************************!*\
  !*** delegated ./node_modules/ol/source.js from dll-reference vendor ***!
  \***********************************************************************/
/*! exports provided: BingMaps, CartoDB, Cluster, IIIF, Image, ImageArcGISRest, ImageCanvas, ImageMapGuide, ImageStatic, ImageWMS, OSM, Raster, Source, Stamen, Tile, TileArcGISRest, TileDebug, TileImage, TileJSON, TileWMS, UrlTile, UTFGrid, Vector, VectorTile, WMTS, XYZ, Zoomify */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1044);

/***/ }),

/***/ "./node_modules/ol/source/Image.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/ol/source/Image.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! exports provided: ImageSourceEvent, defaultImageLoadFunction, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(79);

/***/ }),

/***/ "./node_modules/ol/source/ImageWMS.js":
/*!********************************************************************************!*\
  !*** delegated ./node_modules/ol/source/ImageWMS.js from dll-reference vendor ***!
  \********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(566);

/***/ }),

/***/ "./node_modules/ol/source/Tile.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/source/Tile.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: TileSourceEvent, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(174);

/***/ }),

/***/ "./node_modules/ol/source/TileWMS.js":
/*!*******************************************************************************!*\
  !*** delegated ./node_modules/ol/source/TileWMS.js from dll-reference vendor ***!
  \*******************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(567);

/***/ }),

/***/ "./node_modules/ol/source/Vector.js":
/*!******************************************************************************!*\
  !*** delegated ./node_modules/ol/source/Vector.js from dll-reference vendor ***!
  \******************************************************************************/
/*! exports provided: VectorSourceEvent, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(136);

/***/ }),

/***/ "./node_modules/ol/source/WMTS.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/source/WMTS.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: default, optionsFromCapabilities */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(568);

/***/ }),

/***/ "./node_modules/ol/sphere.js":
/*!***********************************************************************!*\
  !*** delegated ./node_modules/ol/sphere.js from dll-reference vendor ***!
  \***********************************************************************/
/*! exports provided: DEFAULT_RADIUS, getDistance, getLength, getArea, offset */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(292);

/***/ }),

/***/ "./node_modules/ol/string.js":
/*!***********************************************************************!*\
  !*** delegated ./node_modules/ol/string.js from dll-reference vendor ***!
  \***********************************************************************/
/*! exports provided: padNumber, compareVersions */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(123);

/***/ }),

/***/ "./node_modules/ol/structs/RBush.js":
/*!******************************************************************************!*\
  !*** delegated ./node_modules/ol/structs/RBush.js from dll-reference vendor ***!
  \******************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(230);

/***/ }),

/***/ "./node_modules/ol/style/Circle.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/ol/style/Circle.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(287);

/***/ }),

/***/ "./node_modules/ol/style/Fill.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/style/Fill.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(130);

/***/ }),

/***/ "./node_modules/ol/style/Icon.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/style/Icon.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(289);

/***/ }),

/***/ "./node_modules/ol/style/RegularShape.js":
/*!***********************************************************************************!*\
  !*** delegated ./node_modules/ol/style/RegularShape.js from dll-reference vendor ***!
  \***********************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(349);

/***/ }),

/***/ "./node_modules/ol/style/Stroke.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/ol/style/Stroke.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(146);

/***/ }),

/***/ "./node_modules/ol/style/Style.js":
/*!****************************************************************************!*\
  !*** delegated ./node_modules/ol/style/Style.js from dll-reference vendor ***!
  \****************************************************************************/
/*! exports provided: toFunction, createDefaultStyle, createEditingStyle, default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(84);

/***/ }),

/***/ "./node_modules/ol/style/Text.js":
/*!***************************************************************************!*\
  !*** delegated ./node_modules/ol/style/Text.js from dll-reference vendor ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(290);

/***/ }),

/***/ "./node_modules/ol/tilegrid/WMTS.js":
/*!******************************************************************************!*\
  !*** delegated ./node_modules/ol/tilegrid/WMTS.js from dll-reference vendor ***!
  \******************************************************************************/
/*! exports provided: default, createFromCapabilitiesMatrixSet */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(572);

/***/ }),

/***/ "./node_modules/ol/uri.js":
/*!********************************************************************!*\
  !*** delegated ./node_modules/ol/uri.js from dll-reference vendor ***!
  \********************************************************************/
/*! exports provided: appendParams */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(106);

/***/ }),

/***/ "./node_modules/ol/util.js":
/*!*********************************************************************!*\
  !*** delegated ./node_modules/ol/util.js from dll-reference vendor ***!
  \*********************************************************************/
/*! exports provided: abstract, getUid, VERSION */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(9);

/***/ }),

/***/ "./node_modules/ol/xml.js":
/*!********************************************************************!*\
  !*** delegated ./node_modules/ol/xml.js from dll-reference vendor ***!
  \********************************************************************/
/*! exports provided: DOCUMENT, XML_SCHEMA_INSTANCE_URI, createElementNS, getAllTextContent, getAllTextContent_, isDocument, getAttributeNS, parse, makeArrayExtender, makeArrayPusher, makeReplacer, makeObjectPropertyPusher, makeObjectPropertySetter, makeChildAppender, makeArraySerializer, makeSimpleNodeFactory, OBJECT_PROPERTY_NODE_FACTORY, makeSequence, makeStructureNS, parseNode, pushParseAndPop, serialize, pushSerializeAndPop */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(0);

/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************************************************!*\
  !*** delegated ./node_modules/process/browser.js from dll-reference vendor ***!
  \*****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(991);

/***/ }),

/***/ "./node_modules/qruri/index.js":
/*!*************************************************************************!*\
  !*** delegated ./node_modules/qruri/index.js from dll-reference vendor ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1047);

/***/ }),

/***/ "./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js":
/*!*************************************************************************************************************!*\
  !*** delegated ./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js from dll-reference vendor ***!
  \*************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(1049);

/***/ }),

/***/ "./node_modules/setimmediate/setImmediate.js":
/*!***************************************************!*\
  !*** ./node_modules/setimmediate/setImmediate.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {(function (global, undefined) {
  "use strict";

  if (global.setImmediate) {
    return;
  }

  var nextHandle = 1;
  var tasksByHandle = {};
  var currentlyRunningATask = false;
  var doc = global.document;
  var registerImmediate;

  function setImmediate(callback) {
    if (typeof callback !== "function") {
      callback = new Function("" + callback);
    }

    var args = new Array(arguments.length - 1);

    for (var i = 0; i < args.length; i++) {
      args[i] = arguments[i + 1];
    }

    var task = {
      callback: callback,
      args: args
    };
    tasksByHandle[nextHandle] = task;
    registerImmediate(nextHandle);
    return nextHandle++;
  }

  function clearImmediate(handle) {
    delete tasksByHandle[handle];
  }

  function run(task) {
    var callback = task.callback;
    var args = task.args;

    switch (args.length) {
      case 0:
        callback();
        break;

      case 1:
        callback(args[0]);
        break;

      case 2:
        callback(args[0], args[1]);
        break;

      case 3:
        callback(args[0], args[1], args[2]);
        break;

      default:
        callback.apply(undefined, args);
        break;
    }
  }

  function runIfPresent(handle) {
    if (currentlyRunningATask) {
      setTimeout(runIfPresent, 0, handle);
    } else {
      var task = tasksByHandle[handle];

      if (task) {
        currentlyRunningATask = true;

        try {
          run(task);
        } finally {
          clearImmediate(handle);
          currentlyRunningATask = false;
        }
      }
    }
  }

  function installNextTickImplementation() {
    registerImmediate = function registerImmediate(handle) {
      process.nextTick(function () {
        runIfPresent(handle);
      });
    };
  }

  function canUsePostMessage() {
    if (global.postMessage && !global.importScripts) {
      var postMessageIsAsynchronous = true;
      var oldOnMessage = global.onmessage;

      global.onmessage = function () {
        postMessageIsAsynchronous = false;
      };

      global.postMessage("", "*");
      global.onmessage = oldOnMessage;
      return postMessageIsAsynchronous;
    }
  }

  function installPostMessageImplementation() {
    var messagePrefix = "setImmediate$" + Math.random() + "$";

    var onGlobalMessage = function onGlobalMessage(event) {
      if (event.source === global && typeof event.data === "string" && event.data.indexOf(messagePrefix) === 0) {
        runIfPresent(+event.data.slice(messagePrefix.length));
      }
    };

    if (global.addEventListener) {
      global.addEventListener("message", onGlobalMessage, false);
    } else {
      global.attachEvent("onmessage", onGlobalMessage);
    }

    registerImmediate = function registerImmediate(handle) {
      global.postMessage(messagePrefix + handle, "*");
    };
  }

  function installMessageChannelImplementation() {
    var channel = new MessageChannel();

    channel.port1.onmessage = function (event) {
      var handle = event.data;
      runIfPresent(handle);
    };

    registerImmediate = function registerImmediate(handle) {
      channel.port2.postMessage(handle);
    };
  }

  function installReadyStateChangeImplementation() {
    var html = doc.documentElement;

    registerImmediate = function registerImmediate(handle) {
      var script = doc.createElement("script");

      script.onreadystatechange = function () {
        runIfPresent(handle);
        script.onreadystatechange = null;
        html.removeChild(script);
        script = null;
      };

      html.appendChild(script);
    };
  }

  function installSetTimeoutImplementation() {
    registerImmediate = function registerImmediate(handle) {
      setTimeout(runIfPresent, 0, handle);
    };
  }

  var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);
  attachTo = attachTo && attachTo.setTimeout ? attachTo : global;

  if ({}.toString.call(global.process) === "[object process]") {
    installNextTickImplementation();
  } else if (canUsePostMessage()) {
    installPostMessageImplementation();
  } else if (global.MessageChannel) {
    installMessageChannelImplementation();
  } else if (doc && "onreadystatechange" in doc.createElement("script")) {
    installReadyStateChangeImplementation();
  } else {
    installSetTimeoutImplementation();
  }

  attachTo.setImmediate = setImmediate;
  attachTo.clearImmediate = clearImmediate;
})(typeof self === "undefined" ? typeof global === "undefined" ? this : global : self);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js"), __webpack_require__(/*! ./../process/browser.js */ "./node_modules/process/browser.js")))

/***/ }),

/***/ "./node_modules/timers-browserify/main.js":
/*!************************************************!*\
  !*** ./node_modules/timers-browserify/main.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var scope = typeof global !== "undefined" && global || typeof self !== "undefined" && self || window;
var apply = Function.prototype.apply;

exports.setTimeout = function () {
  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);
};

exports.setInterval = function () {
  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);
};

exports.clearTimeout = exports.clearInterval = function (timeout) {
  if (timeout) {
    timeout.close();
  }
};

function Timeout(id, clearFn) {
  this._id = id;
  this._clearFn = clearFn;
}

Timeout.prototype.unref = Timeout.prototype.ref = function () {};

Timeout.prototype.close = function () {
  this._clearFn.call(scope, this._id);
};

exports.enroll = function (item, msecs) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = msecs;
};

exports.unenroll = function (item) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = -1;
};

exports._unrefActive = exports.active = function (item) {
  clearTimeout(item._idleTimeoutId);
  var msecs = item._idleTimeout;

  if (msecs >= 0) {
    item._idleTimeoutId = setTimeout(function onTimeout() {
      if (item._onTimeout) item._onTimeout();
    }, msecs);
  }
};

__webpack_require__(/*! setimmediate */ "./node_modules/setimmediate/setImmediate.js");

exports.setImmediate = typeof self !== "undefined" && self.setImmediate || typeof global !== "undefined" && global.setImmediate || this && this.setImmediate;
exports.clearImmediate = typeof self !== "undefined" && self.clearImmediate || typeof global !== "undefined" && global.clearImmediate || this && this.clearImmediate;
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./node_modules/webpack/buildin/global.js":
/*!************************************************************************************!*\
  !*** delegated ./node_modules/webpack/buildin/global.js from dll-reference vendor ***!
  \************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(238);

/***/ }),

/***/ "./node_modules/webpack/buildin/harmony-module.js":
/*!********************************************************************************************!*\
  !*** delegated ./node_modules/webpack/buildin/harmony-module.js from dll-reference vendor ***!
  \********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = (__webpack_require__(/*! dll-reference vendor */ "dll-reference vendor"))(992);

/***/ }),

/***/ "./src/CustomEvent.js":
/*!****************************!*\
  !*** ./src/CustomEvent.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ol_events_Event_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/events/Event.js */ "./node_modules/ol/events/Event.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }



var _default = function (_olEventsEvent) {
  _inheritsLoose(_default, _olEventsEvent);

  function _default(type, detail) {
    var _this;

    if (detail === void 0) {
      detail = {};
    }

    _this = _olEventsEvent.call(this, type) || this;
    _this.detail = detail;
    return _this;
  }

  return _default;
}(ol_events_Event_js__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/GeometryType.js":
/*!*****************************!*\
  !*** ./src/GeometryType.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ({
  CIRCLE: 'Circle',
  LINE_STRING: 'LineString',
  MULTI_LINE_STRING: 'MultiLineString',
  MULTI_POINT: 'MultiPoint',
  MULTI_POLYGON: 'MultiPolygon',
  POINT: 'Point',
  POLYGON: 'Polygon',
  RECTANGLE: 'Rectangle',
  TEXT: 'Text'
});

/***/ }),

/***/ "./src/Menu.js":
/*!*********************!*\
  !*** ./src/Menu.js ***!
  \*********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/CustomEvent.js */ "./src/CustomEvent.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Overlay_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Overlay.js */ "./node_modules/ol/Overlay.js");
/* harmony import */ var ol_OverlayPositioning_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/OverlayPositioning.js */ "./node_modules/ol/OverlayPositioning.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }






var _default = function (_olOverlay) {
  _inheritsLoose(_default, _olOverlay);

  function _default(menuOptions, options) {
    var _this;

    if (options === void 0) {
      options = {};
    }

    options.positioning = ol_OverlayPositioning_js__WEBPACK_IMPORTED_MODULE_3__["default"].TOP_LEFT;

    if (!menuOptions) {
      throw new Error('Missing menuOptions');
    }

    _this = _olOverlay.call(this, options) || this;
    _this.listenerKeys_ = [];
    _this.clickOutListenerKey_ = null;
    var contentEl = $('<div/>', {
      'class': 'panel panel-default'
    });
    _this.autoClose_ = menuOptions.autoClose !== undefined ? menuOptions.autoClose : true;

    if (menuOptions.title) {
      var headerEl = $('<div>', {
        'class': 'panel-heading'
      }).appendTo(contentEl);
      $('<span>', {
        text: menuOptions.title
      }).appendTo(headerEl);
    }

    var actionsEl = $('<div>', {
      'class': 'list-group'
    }).appendTo(contentEl);
    _this.actions_ = [];
    menuOptions.actions.forEach(function (action) {
      _this.actions_.push($('<button>', {
        'class': 'list-group-item btn',
        'data-name': action.name,
        'text': [' ', action.label !== undefined ? action.label : action.name].join('')
      }).appendTo(actionsEl).prepend($('<span>', {
        'class': action.cls !== undefined ? action.cls : ''
      })));
    });

    _this.setElement(contentEl[0]);

    return _this;
  }

  var _proto = _default.prototype;

  _proto.setMap = function setMap(map) {
    var _this2 = this;

    var currentMap = this.getMap();

    if (currentMap) {
      this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["unlistenByKey"]);
      this.listenerKeys_.length = 0;
    }

    ol_Overlay_js__WEBPACK_IMPORTED_MODULE_2__["default"].prototype.setMap.call(this, map);

    if (map) {
      this.actions_.forEach(function (action) {
        var data = action.data();

        _this2.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(action[0], 'click', _this2.handleActionClick_.bind(_this2, data.name)));
      });
      this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(map, 'pointermove', this.handleMapPointerMove_, this));
    }
  };

  _proto.open = function open(coordinate) {
    this.setPosition(coordinate);

    if (!(document.documentElement instanceof EventTarget)) {
      throw new Error('Wrong document element type');
    }

    if (this.autoClose_) {
      this.clickOutListenerKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(document.documentElement, 'mousedown', this.handleClickOut_, this);
    }
  };

  _proto.close = function close() {
    this.setPosition(undefined);

    if (this.clickOutListenerKey_ !== null) {
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["unlistenByKey"])(this.clickOutListenerKey_);
    }
  };

  _proto.handleActionClick_ = function handleActionClick_(action, evt) {
    this.dispatchEvent(new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__["default"]('actionclick', {
      action: action
    }));

    if (this.autoClose_) {
      this.close();
    }

    evt.stopPropagation();
  };

  _proto.handleClickOut_ = function handleClickOut_(evt) {
    var element = this.getElement();

    if (element && $(evt.target).closest(element).length === 0) {
      this.close();
    }
  };

  _proto.handleMapPointerMove_ = function handleMapPointerMove_(evt) {
    var myEvent = evt;
    var target = myEvent.originalEvent.target;
    var element = this.getElement();

    if (target instanceof Element && element instanceof Element && element.contains(target)) {
      myEvent.coordinate = [Infinity, Infinity];
      myEvent.pixel = [Infinity, Infinity];
    }
  };

  return _default;
}(ol_Overlay_js__WEBPACK_IMPORTED_MODULE_2__["default"]);


/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/Popover.js":
/*!************************!*\
  !*** ./src/Popover.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ol_Overlay_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/Overlay.js */ "./node_modules/ol/Overlay.js");
function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }



var _default = function (_olOverlay) {
  _inheritsLoose(_default, _olOverlay);

  function _default(options) {
    var _this;

    if (options === void 0) {
      options = {};
    }

    var originalEl = options.element ? options.element : document.createElement('div');
    options.element = document.createElement('div');
    _this = _olOverlay.call(this, options) || this;
    var closeEl = document.createElement('div');
    closeEl.className = 'close';
    closeEl.innerHTML = '&times;';
    closeEl.addEventListener('click', _this.close.bind(_assertThisInitialized(_this)));
    _this.contentEl_ = document.createElement('div');

    _this.contentEl_.append(closeEl, originalEl);

    return _this;
  }

  var _proto = _default.prototype;

  _proto.close = function close() {
    var map = this.getMap();

    if (map) {
      map.removeOverlay(this);
    }
  };

  _proto.setMap = function setMap(map) {
    var element = this.getElement();

    if (!element) {
      throw new Error('Missing element');
    }

    var currentMap = this.getMap();

    if (currentMap) {
      $(element).popover('dispose');
    }

    _olOverlay.prototype.setMap.call(this, map);

    if (map) {
      var contentEl = this.contentEl_;
      window.setTimeout(function () {
        $(element).popover({
          container: element.parentElement,
          placement: 'top',
          content: contentEl,
          html: true
        });
        $(element).popover('show');
      }, 0);
    }
  };

  return _default;
}(ol_Overlay_js__WEBPACK_IMPORTED_MODULE_0__["default"]);


/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/WFSDescribeFeatureType.js":
/*!***************************************!*\
  !*** ./src/WFSDescribeFeatureType.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var ol_format_XML_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/format/XML.js */ "./node_modules/ol/format/XML.js");
/* harmony import */ var ol_xml_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/xml.js */ "./node_modules/ol/xml.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }



var NAMESPACE_URIS_ = [null, 'http://www.w3.org/2001/XMLSchema'];

function makeStructureNS(namespaceURIs, structure) {
  return ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["makeStructureNS"](namespaceURIs, structure);
}

var PARSERS_ = makeStructureNS(NAMESPACE_URIS_, {
  element: ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["makeObjectPropertyPusher"](readElement_),
  complexType: ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["makeObjectPropertyPusher"](readComplexType_)
});
var COMPLEX_TYPE_PARSERS_ = makeStructureNS(NAMESPACE_URIS_, {
  complexContent: ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["makeObjectPropertySetter"](readComplexContent_)
});
var COMPLEX_CONTENT_PARSERS_ = makeStructureNS(NAMESPACE_URIS_, {
  extension: ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["makeObjectPropertySetter"](readExtension_)
});
var EXTENSION_PARSERS_ = makeStructureNS(NAMESPACE_URIS_, {
  sequence: ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["makeObjectPropertySetter"](readSequence_)
});
var SEQUENCE_PARSERS_ = makeStructureNS(NAMESPACE_URIS_, {
  element: ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["makeObjectPropertyPusher"](readElement_)
});

var WFSDescribeFeatureType = function (_olFormatXML) {
  _inheritsLoose(WFSDescribeFeatureType, _olFormatXML);

  function WFSDescribeFeatureType() {
    return _olFormatXML.apply(this, arguments) || this;
  }

  return WFSDescribeFeatureType;
}(ol_format_XML_js__WEBPACK_IMPORTED_MODULE_0__["default"]);

WFSDescribeFeatureType.prototype.read;

WFSDescribeFeatureType.prototype.readFromDocument = function (doc) {
  var node;

  for (node = doc.firstChild; node; node = node.nextSibling) {
    if (node && node.nodeType == Node.ELEMENT_NODE) {
      return this.readFromNode(node);
    }
  }

  return null;
};

WFSDescribeFeatureType.prototype.readFromNode = function (node) {
  var result = {};
  result = ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["pushParseAndPop"](result, PARSERS_, node, []);
  return result;
};

function readElement_(node, objectStack) {
  var attributes = {};

  for (var i = 0, len = node.attributes.length; i < len; i++) {
    var attribute = node.attributes.item(i);

    if (!attribute) {
      throw new Error('Missing attribute');
    }

    attributes[attribute.name] = attribute.value;
  }

  if (objectStack.length === 1) {
    var _attribute = attributes.type.split(':').pop();

    if (!_attribute) {
      throw new Error('Missing attribute');
    }

    attributes.type = _attribute;
  }

  return attributes;
}

function readComplexType_(node, objectStack) {
  var name = node.getAttribute('name');
  var object = ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["pushParseAndPop"]({
    name: name
  }, COMPLEX_TYPE_PARSERS_, node, objectStack);
  object.complexContent = object.complexContent.extension.sequence.element;
  return object;
}

function readComplexContent_(node, objectStack) {
  return ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["pushParseAndPop"]({}, COMPLEX_CONTENT_PARSERS_, node, objectStack);
}

function readExtension_(node, objectStack) {
  return ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["pushParseAndPop"]({}, EXTENSION_PARSERS_, node, objectStack);
}

function readSequence_(node, objectStack) {
  return ol_xml_js__WEBPACK_IMPORTED_MODULE_1__["pushParseAndPop"]({}, SEQUENCE_PARSERS_, node, objectStack);
}

/* harmony default export */ __webpack_exports__["default"] = (WFSDescribeFeatureType);

/***/ }),

/***/ "./src/array.js":
/*!**********************!*\
  !*** ./src/array.js ***!
  \**********************/
/*! exports provided: pushUnlessIncluded */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "pushUnlessIncluded", function() { return pushUnlessIncluded; });
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");

function pushUnlessIncluded(arr, obj) {
  var ret = false;

  if (!Object(ol_array_js__WEBPACK_IMPORTED_MODULE_0__["includes"])(arr, obj)) {
    arr.push(obj);
    ret = true;
  }

  return ret;
}

/***/ }),

/***/ "./src/datasource/DataSource.js":
/*!**************************************!*\
  !*** ./src/datasource/DataSource.js ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

var DataSource = function () {
  function DataSource(options) {
    this.inRange = options.inRange !== false;
    this.visible = options.visible === true;
    this.attributes = options.attributes || null;
    this.id_ = options.id;
    this.identifierAttribute_ = options.identifierAttribute;
    this.maxResolution_ = options.maxResolution;
    this.minResolution_ = options.minResolution;
    this.name_ = options.name;
  }

  var _proto = DataSource.prototype;

  _proto.getAttributes = function getAttributes() {
    return this.attributes;
  };

  _proto.setAttributes = function setAttributes(attributes) {
    this.attributes = attributes;
  };

  _createClass(DataSource, [{
    key: "id",
    get: function get() {
      return this.id_;
    }
  }, {
    key: "identifierAttribute",
    get: function get() {
      return this.identifierAttribute_;
    }
  }, {
    key: "maxResolution",
    get: function get() {
      return this.maxResolution_;
    }
  }, {
    key: "minResolution",
    get: function get() {
      return this.minResolution_;
    }
  }, {
    key: "name",
    get: function get() {
      return this.name_;
    }
  }, {
    key: "queryable",
    get: function get() {
      return false;
    }
  }, {
    key: "supportsDynamicInRange",
    get: function get() {
      return this.maxResolution !== null || this.minResolution !== null;
    }
  }]);

  return DataSource;
}();

/* harmony default export */ __webpack_exports__["default"] = (DataSource);

/***/ }),

/***/ "./src/datasource/DataSources.js":
/*!***************************************!*\
  !*** ./src/datasource/DataSources.js ***!
  \***************************************/
/*! exports provided: DataSource, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DataSource", function() { return DataSource; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_View_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/View.js */ "./node_modules/ol/View.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }






var DataSource = function () {
  function DataSource() {
    this.collection_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__["default"]();
    this.map_ = null;
    this.listenerKeys_ = [];
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(this.collection_, 'add', this.handleDataSourcesAdd_, this);
  }

  var _proto = DataSource.prototype;

  _proto.bindMap_ = function bindMap_(map) {
    var view = map.getView();
    this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(view, 'change:resolution', this.handleViewResolutionChange_, this));
    var resolution = view.getResolution();

    if (resolution === undefined) {
      throw new Error('Missing resolution');
    }

    this.syncDataSourcesToResolution_(resolution);
  };

  _proto.unbindMap_ = function unbindMap_(map) {
    this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["unlistenByKey"]);
    this.listenerKeys_ = [];
  };

  _proto.handleViewResolutionChange_ = function handleViewResolutionChange_(evt) {
    var view = evt.target;

    if (view instanceof ol_View_js__WEBPACK_IMPORTED_MODULE_3__["default"]) {
      var resolution = view.getResolution();

      if (resolution === undefined) {
        throw new Error('Missing resolution');
      }

      this.syncDataSourcesToResolution_(resolution);
    }
  };

  _proto.syncDataSourcesToResolution_ = function syncDataSourcesToResolution_(resolution) {
    var _this = this;

    this.collection_.forEach(function (dataSource) {
      _this.syncDataSourceToResolution_(dataSource, resolution);
    });
  };

  _proto.syncDataSourceToResolution_ = function syncDataSourceToResolution_(dataSource, resolution) {
    if (!dataSource.supportsDynamicInRange) {
      return;
    }

    var maxResolution = dataSource.maxResolution;
    var minResolution = dataSource.minResolution;
    var inMinRange = minResolution === null || minResolution === undefined || resolution >= minResolution;
    var inMaxRange = maxResolution === null || maxResolution === undefined || resolution <= maxResolution;
    var inRange = inMinRange && inMaxRange;
    dataSource.inRange = inRange;
  };

  _proto.handleDataSourcesAdd_ = function handleDataSourcesAdd_(event) {
    if (event instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__["CollectionEvent"]) {
      var dataSource = event.element;

      if (this.map_) {
        var resolution = this.map_.getView().getResolution();

        if (resolution === undefined) {
          throw new Error('Missing resolution');
        }

        this.syncDataSourceToResolution_(dataSource, resolution);
      }
    }
  };

  _createClass(DataSource, [{
    key: "map",
    set: function set(map) {
      if (this.map_ === map) {
        return;
      }

      if (this.map_) {
        this.unbindMap_(this.map_);
      }

      this.map_ = map;

      if (map) {
        this.bindMap_(map);
      }
    }
  }, {
    key: "collection",
    get: function get() {
      return this.collection_;
    }
  }]);

  return DataSource;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDataSources', []);
module.service('ngeoDataSources', DataSource);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/datasource/File.js":
/*!********************************!*\
  !*** ./src/datasource/File.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_datasource_DataSource_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/datasource/DataSource.js */ "./src/datasource/DataSource.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }






var _default = function (_ngeoDatasourceDataSo) {
  _inheritsLoose(_default, _ngeoDatasourceDataSo);

  function _default(options) {
    var _this;

    _this = _ngeoDatasourceDataSo.call(this, options) || this;
    _this.featuresCollection_ = options.features || new ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__["default"]();
    _this.source_ = new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
      features: _this.featuresCollection_,
      wrapX: false
    });
    _this.layer_ = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_2__["default"]({
      source: _this.source_
    });
    return _this;
  }

  _createClass(_default, [{
    key: "features",
    get: function get() {
      return this.featuresCollection_.getArray();
    }
  }, {
    key: "featuresCollection",
    get: function get() {
      return this.featuresCollection_;
    }
  }, {
    key: "layer",
    get: function get() {
      return this.layer_;
    }
  }, {
    key: "extent",
    get: function get() {
      return this.source_.getExtent();
    }
  }]);

  return _default;
}(ngeo_datasource_DataSource_js__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/datasource/FileGroup.js":
/*!*************************************!*\
  !*** ./src/datasource/FileGroup.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_datasource_File_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/datasource/File.js */ "./src/datasource/File.js");
/* harmony import */ var ngeo_datasource_Group_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/datasource/Group.js */ "./src/datasource/Group.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }




var _default = function (_ngeoDatasourceGroup) {
  _inheritsLoose(_default, _ngeoDatasourceGroup);

  function _default(options) {
    var _this;

    _this = _ngeoDatasourceGroup.call(this, options) || this;
    var injector = options.injector;
    _this.rootScope_ = injector.get('$rootScope');
    _this.unregister_ = {};
    return _this;
  }

  var _proto = _default.prototype;

  _proto.addDataSource = function addDataSource(dataSource) {
    _ngeoDatasourceGroup.prototype.addDataSource.call(this, dataSource);

    if (!(dataSource instanceof ngeo_datasource_File_js__WEBPACK_IMPORTED_MODULE_0__["default"])) {
      throw new Error('Wrong datasource type');
    }

    this.registerDataSource_(dataSource);
  };

  _proto.registerDataSource_ = function registerDataSource_(dataSource) {
    this.unregister_[dataSource.id] = this.rootScope_.$watch(function () {
      return dataSource.visible;
    }, this.handleDataSourceVisibleChange_.bind(this, dataSource));
  };

  _proto.handleDataSourceVisibleChange_ = function handleDataSourceVisibleChange_(dataSource, value, oldValue) {
    if (value !== undefined) {
      dataSource.layer.setVisible(value);
    }
  };

  _proto.removeDataSource = function removeDataSource(dataSource) {
    _ngeoDatasourceGroup.prototype.removeDataSource.call(this, dataSource);

    if (!(dataSource instanceof ngeo_datasource_File_js__WEBPACK_IMPORTED_MODULE_0__["default"])) {
      throw new Error('Wrong datasource type');
    }

    this.unregisterDataSource_(dataSource);
  };

  _proto.unregisterDataSource_ = function unregisterDataSource_(dataSource) {
    this.unregister_[dataSource.id]();
    delete this.unregister_[dataSource.id];
  };

  return _default;
}(ngeo_datasource_Group_js__WEBPACK_IMPORTED_MODULE_1__["default"]);



/***/ }),

/***/ "./src/datasource/Group.js":
/*!*********************************!*\
  !*** ./src/datasource/Group.js ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }


var VisibilityState = {
  INDETERMINATE: 'indeterminate',
  OFF: 'off',
  ON: 'on'
};

var Group = function () {
  function Group(options) {
    this.dataSourcesCollection_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_0__["default"](options.dataSources);
    this.title_ = options.title;
  }

  var _proto = Group.prototype;

  _proto.destroy = function destroy() {
    this.dataSourcesCollection_.clear();
  };

  _proto.getDataSourceState = function getDataSourceState(dataSource) {
    return dataSource.visible ? VisibilityState.ON : VisibilityState.OFF;
  };

  _proto.addDataSource = function addDataSource(dataSource) {
    this.dataSourcesCollection_.push(dataSource);
  };

  _proto.removeDataSource = function removeDataSource(dataSource) {
    this.dataSourcesCollection_.remove(dataSource);
  };

  _proto.toggleVisibilityState = function toggleVisibilityState() {
    var visibleToSet = this.visibilityState !== VisibilityState.ON;

    for (var _iterator = this.dataSources, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var dataSource = _ref;

      if (dataSource.visible !== visibleToSet) {
        dataSource.visible = visibleToSet;
      }
    }
  };

  _createClass(Group, [{
    key: "dataSources",
    get: function get() {
      return this.dataSourcesCollection_.getArray();
    }
  }, {
    key: "dataSourcesCollection",
    get: function get() {
      return this.dataSourcesCollection_;
    }
  }, {
    key: "title",
    get: function get() {
      return this.title_;
    }
  }, {
    key: "visibilityState",
    get: function get() {
      var state;

      for (var _iterator2 = this.dataSources, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
        var _ref2;

        if (_isArray2) {
          if (_i2 >= _iterator2.length) break;
          _ref2 = _iterator2[_i2++];
        } else {
          _i2 = _iterator2.next();
          if (_i2.done) break;
          _ref2 = _i2.value;
        }

        var dataSource = _ref2;

        if (state === undefined) {
          state = this.getDataSourceState(dataSource);
        } else {
          var otherState = this.getDataSourceState(dataSource);

          if (otherState !== state) {
            state = VisibilityState.INDETERMINATE;
          }
        }

        if (state === VisibilityState.INDETERMINATE) {
          break;
        }
      }

      if (typeof state != 'string') {
        throw new Error('missing state');
      }

      return state;
    }
  }]);

  return Group;
}();

/* harmony default export */ __webpack_exports__["default"] = (Group);

/***/ }),

/***/ "./src/datasource/Helper.js":
/*!**********************************!*\
  !*** ./src/datasource/Helper.js ***!
  \**********************************/
/*! exports provided: DatasourceHelper, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DatasourceHelper", function() { return DatasourceHelper; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_datasource_DataSource_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/datasource/DataSource.js */ "./src/datasource/DataSource.js");
/* harmony import */ var ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/datasource/DataSources.js */ "./src/datasource/DataSources.js");
/* harmony import */ var ngeo_format_WFSAttribute_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/format/WFSAttribute.js */ "./src/format/WFSAttribute.js");
/* harmony import */ var ngeo_query_Querent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/query/Querent.js */ "./src/query/Querent.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }








var DatasourceHelper = function () {
  DatasourceHelper.$inject = ["$q", "ngeoDataSources", "ngeoQuerent"];

  function DatasourceHelper($q, ngeoDataSources, ngeoQuerent) {
    this.q_ = $q;
    this.collection_ = ngeoDataSources.collection;
    this.ngeoQuerent_ = ngeoQuerent;
    this.cache_ = {};
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.collection_, 'add', this.handleDataSourcesAdd_, this);
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.collection_, 'remove', this.handleDataSourcesRemove_, this);
    this.collection_.forEach(this.registerDataSource_.bind(this));
  }

  var _proto = DatasourceHelper.prototype;

  _proto.getDataSource = function getDataSource(id) {
    return this.cache_[id] || null;
  };

  _proto.getDataSourceAttributes = function getDataSourceAttributes(dataSource) {
    var wfsDescribeFeatureTypeDefer = this.q_.defer();

    if (dataSource.attributes) {
      wfsDescribeFeatureTypeDefer.resolve(dataSource.attributes);
    } else {
      this.ngeoQuerent_.wfsDescribeFeatureType(dataSource).then(function (featureType_) {
        var ogcLayerName = dataSource.getWFSLayerNames()[0];
        console.assert(typeof ogcLayerName == 'string', 'The data source should have only one ogcLayer.');
        var featureType = featureType_;

        for (var _iterator = featureType.element, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
          var _ref;

          if (_isArray) {
            if (_i >= _iterator.length) break;
            _ref = _iterator[_i++];
          } else {
            _i = _iterator.next();
            if (_i.done) break;
            _ref = _i.value;
          }

          var element = _ref;

          if (element.name === ogcLayerName) {
            for (var _iterator2 = featureType.complexType, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
              var _ref2;

              if (_isArray2) {
                if (_i2 >= _iterator2.length) break;
                _ref2 = _iterator2[_i2++];
              } else {
                _i2 = _iterator2.next();
                if (_i2.done) break;
                _ref2 = _i2.value;
              }

              var type = _ref2;

              if (type.name == element.type) {
                var complexContent = type.complexContent;
                var attributes = new ngeo_format_WFSAttribute_js__WEBPACK_IMPORTED_MODULE_3__["default"]().read(complexContent);
                dataSource.setAttributes(attributes);
                wfsDescribeFeatureTypeDefer.resolve(attributes);
                break;
              }
            }
          }
        }
      });
    }

    return wfsDescribeFeatureTypeDefer.promise;
  };

  _proto.registerDataSource_ = function registerDataSource_(dataSource) {
    this.cache_[dataSource.id] = dataSource;
  };

  _proto.unregisterDataSource_ = function unregisterDataSource_(dataSource) {
    delete this.cache_[dataSource.id];
  };

  _proto.handleDataSourcesAdd_ = function handleDataSourcesAdd_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_6__["CollectionEvent"]) {
      var dataSource = evt.element;
      console.assert(dataSource instanceof ngeo_datasource_DataSource_js__WEBPACK_IMPORTED_MODULE_1__["default"]);
      this.registerDataSource_(dataSource);
    }
  };

  _proto.handleDataSourcesRemove_ = function handleDataSourcesRemove_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_6__["CollectionEvent"]) {
      var dataSource = evt.element;
      this.unregisterDataSource_(dataSource);
    }
  };

  _createClass(DatasourceHelper, [{
    key: "collection",
    get: function get() {
      return this.collection_;
    }
  }]);

  return DatasourceHelper;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDataSourcesHelper', [ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_query_Querent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name]);
module.service('ngeoDataSourcesHelper', DatasourceHelper);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/datasource/OGC.js":
/*!*******************************!*\
  !*** ./src/datasource/OGC.js ***!
  \*******************************/
/*! exports provided: ServerType, Type, WFSOutputFormat, WMSInfoFormat, DEFAULT_GEOMETRY_NAME, guessServiceTypeByUrl, TimePropertyWidgetEnum, TimePropertyModeEnum, TimePropertyResolutionEnum, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerType", function() { return ServerType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Type", function() { return Type; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WFSOutputFormat", function() { return WFSOutputFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WMSInfoFormat", function() { return WMSInfoFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFAULT_GEOMETRY_NAME", function() { return DEFAULT_GEOMETRY_NAME; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "guessServiceTypeByUrl", function() { return guessServiceTypeByUrl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimePropertyWidgetEnum", function() { return TimePropertyWidgetEnum; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimePropertyModeEnum", function() { return TimePropertyModeEnum; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimePropertyResolutionEnum", function() { return TimePropertyResolutionEnum; });
/* harmony import */ var ngeo_array_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/array.js */ "./src/array.js");
/* harmony import */ var ngeo_datasource_DataSource_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/datasource/DataSource.js */ "./src/datasource/DataSource.js");
/* harmony import */ var ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/filter/Condition.js */ "./src/filter/Condition.js");
/* harmony import */ var ngeo_format_ArcGISGeoJSON_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/format/ArcGISGeoJSON.js */ "./src/format/ArcGISGeoJSON.js");
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ol_format_GML2_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/format/GML2.js */ "./node_modules/ol/format/GML2.js");
/* harmony import */ var ol_format_GML3_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/format/GML3.js */ "./node_modules/ol/format/GML3.js");
/* harmony import */ var ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/format/WFS.js */ "./node_modules/ol/format/WFS.js");
/* harmony import */ var ol_format_WMSGetFeatureInfo_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/format/WMSGetFeatureInfo.js */ "./node_modules/ol/format/WMSGetFeatureInfo.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }










var ServerType = {
  ARCGIS: 'arcgis',
  GEOSERVER: 'geoserver',
  MAPSERVER: 'mapserver',
  QGISSERVER: 'qgisserver'
};
var Type = {
  WMS: 'WMS',
  WMTS: 'WMTS'
};
var WFSFeaturePrefix = {
  FEATURE: 'feature'
};
var WFSOutputFormat = {
  GML2: 'GML2',
  GML3: 'GML3'
};
var WMSInfoFormat = {
  GEOJSON: 'application/geojson',
  GML: 'application/vnd.ogc.gml'
};
var DEFAULT_GEOMETRY_NAME = 'geom';

var OGC = function (_ngeoDatasourceDataSo) {
  _inheritsLoose(OGC, _ngeoDatasourceDataSo);

  function OGC(options) {
    var _this;

    _this = _ngeoDatasourceDataSo.call(this, options) || this;
    _this.dimensionsConfig = options.dimensionsConfig || null;
    _this.dimensionsFiltersConfig = options.dimensionsFiltersConfig || null;
    _this.filterCondition_ = options.filterCondition || ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_2__["default"].AND;
    _this.filterRules = options.filterRules || null;
    _this.filtrable = options.filtrable || null;
    _this.copyable_ = options.copyable === true;
    _this.dimensions_ = options.dimensions || null;
    _this.geometryName_ = DEFAULT_GEOMETRY_NAME;
    _this.ogcImageType_ = options.ogcImageType || 'image/png';
    _this.wmsLayers_ = options.wmsLayers || null;
    _this.wfsLayers_ = options.wfsLayers || null;
    _this.ogcServerType_ = options.ogcServerType || ServerType.MAPSERVER;
    _this.ogcType_ = options.ogcType || Type.WMS;
    _this.ogcAttributes_ = options.ogcAttributes;
    _this.snappable_ = options.snappable === true;
    _this.snappingToEdges_ = options.snappingToEdges !== false;
    _this.snappingToVertice_ = options.snappingToVertice !== false;
    _this.snappingTolerance_ = options.snappingTolerance !== undefined ? options.snappingTolerance : 10;
    _this.timeAttributeName_ = options.timeAttributeName;
    _this.timeLowerValue = options.timeLowerValue;
    _this.timeProperty_ = options.timeProperty !== undefined ? options.timeProperty : null;
    _this.timeUpperValue = options.timeUpperValue;
    _this.wfsFeatureNS_ = options.wfsFeatureNS;
    _this.wfsFeaturePrefix_ = options.wfsFeaturePrefix || WFSFeaturePrefix.FEATURE;
    _this.wfsOutputFormat_ = options.wfsOutputFormat || WFSOutputFormat.GML3;
    _this.wfsUrl_ = options.wfsUrl;
    var wmsInfoFormat;

    if (options.wmsInfoFormat) {
      wmsInfoFormat = options.wmsInfoFormat;
    } else {
      if (_this.ogcServerType_ === ServerType.ARCGIS) {
        wmsInfoFormat = WMSInfoFormat.GEOJSON;
      } else {
        wmsInfoFormat = WMSInfoFormat.GML;
      }
    }

    _this.wmsInfoFormat_ = wmsInfoFormat;
    _this.wmsIsSingleTile_ = options.wmsIsSingleTile === true;
    _this.wmsUrl_ = options.wmsUrl;
    _this.wmtsLayer_ = options.wmtsLayer;
    _this.wmtsUrl_ = options.wmtsUrl;
    var wfsLayerNames = [];
    var wmsLayerNames = [];

    if (_this.queryable) {
      var wfsLayers = _this.wfsLayers || [];

      for (var _iterator = wfsLayers, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
        var _ref;

        if (_isArray) {
          if (_i >= _iterator.length) break;
          _ref = _iterator[_i++];
        } else {
          _i = _iterator.next();
          if (_i.done) break;
          _ref = _i.value;
        }

        var wfsLayer = _ref;

        if (wfsLayer.queryable) {
          wfsLayerNames.push(wfsLayer.name);
          wmsLayerNames.push(wfsLayer.name);
        }
      }

      var wmsLayers = _this.wmsLayers || [];

      for (var _iterator2 = wmsLayers, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
        var _ref2;

        if (_isArray2) {
          if (_i2 >= _iterator2.length) break;
          _ref2 = _iterator2[_i2++];
        } else {
          _i2 = _iterator2.next();
          if (_i2.done) break;
          _ref2 = _i2.value;
        }

        var wmsLayer = _ref2;

        if (wmsLayer.queryable) {
          Object(ngeo_array_js__WEBPACK_IMPORTED_MODULE_0__["pushUnlessIncluded"])(wmsLayerNames, wmsLayer.name);
        }
      }
    }

    var wfsFormat = null;

    if (_this.supportsWFS && wfsLayerNames.length) {
      var format;

      if (_this.wfsOutputFormat_ === WFSOutputFormat.GML3) {
        format = new ol_format_GML3_js__WEBPACK_IMPORTED_MODULE_6__["default"]();
      } else if (_this.wfsOutputFormat_ === WFSOutputFormat.GML2) {
        format = new ol_format_GML2_js__WEBPACK_IMPORTED_MODULE_5__["default"]();
      } else {
        throw new Error('Unknown GML output version');
      }

      wfsFormat = new ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
        featureNS: _this.wfsFeatureNS,
        featureType: wfsLayerNames,
        gmlFormat: format
      });
    }

    _this.wfsFormat_ = wfsFormat;
    var wmsFormat = null;

    if (_this.supportsWMS && wmsLayerNames.length) {
      if (_this.wmsInfoFormat === WMSInfoFormat.GML) {
        wmsFormat = new ol_format_WMSGetFeatureInfo_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
          layers: wmsLayerNames
        });
      } else if (_this.wmsInfoFormat === WMSInfoFormat.GEOJSON) {
        if (_this.ogcServerType_ === ServerType.ARCGIS) {
          wmsFormat = new ngeo_format_ArcGISGeoJSON_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
            layers: wmsLayerNames
          });
        }
      }
    }

    _this.wmsFormat_ = wmsFormat;
    return _this;
  }

  var _proto = OGC.prototype;

  _proto.setAttributes = function setAttributes(attributes) {
    _ngeoDatasourceDataSo.prototype.setAttributes.call(this, attributes);

    this.updateGeometryNameFromAttributes_();
  };

  _proto.geometryName = function geometryName(layer) {
    var geometryName = null;

    if (layer && this.ogcAttributes_) {
      var attributes = this.ogcAttributes_[layer];

      for (var attribute in attributes) {
        if (attributes[attribute].namespace == 'http://www.opengis.net/gml') {
          geometryName = attribute;
          break;
        }
      }
    }

    if (!geometryName) {
      geometryName = this.geometryName_;
    }

    return geometryName;
  };

  _proto.combinableWithDataSourceForWFS = function combinableWithDataSourceForWFS(dataSource) {
    return this.combinableForWFS && dataSource.combinableForWFS && this.supportsWFS && dataSource.supportsWFS && this.queryable && dataSource.queryable && this.wfsUrl === dataSource.wfsUrl && this.haveTheSameActiveDimensions(dataSource);
  };

  _proto.combinableWithDataSourceForWMS = function combinableWithDataSourceForWMS(dataSource) {
    return this.combinableForWMS && dataSource.combinableForWMS && this.supportsWMS && dataSource.supportsWMS && this.queryable && dataSource.queryable && this.wmsUrl === dataSource.wmsUrl && this.haveTheSameActiveDimensions(dataSource);
  };

  _proto.isAnyOGCLayerInRange = function isAnyOGCLayerInRange(res, queryableOnly) {
    if (queryableOnly === void 0) {
      queryableOnly = false;
    }

    return !!this.getInRangeWFSLayerNames(res, queryableOnly).length;
  };

  _proto.getWMSLayerNames = function getWMSLayerNames(queryableOnly) {
    if (queryableOnly === void 0) {
      queryableOnly = false;
    }

    var layerNames = [];

    if (this.wmsLayers) {
      for (var _iterator3 = this.wmsLayers, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
        var _ref3;

        if (_isArray3) {
          if (_i3 >= _iterator3.length) break;
          _ref3 = _iterator3[_i3++];
        } else {
          _i3 = _iterator3.next();
          if (_i3.done) break;
          _ref3 = _i3.value;
        }

        var wmsLayer = _ref3;

        if (!queryableOnly || wmsLayer.queryable) {
          layerNames.push(wmsLayer.name);
        }
      }
    }

    return layerNames;
  };

  _proto.getInRangeWFSLayerNames = function getInRangeWFSLayerNames(res, queryableOnly) {
    if (queryableOnly === void 0) {
      queryableOnly = false;
    }

    var layerNames = [];

    if (this.wfsLayers) {
      for (var _iterator4 = this.wfsLayers, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {
        var _ref4;

        if (_isArray4) {
          if (_i4 >= _iterator4.length) break;
          _ref4 = _iterator4[_i4++];
        } else {
          _i4 = _iterator4.next();
          if (_i4.done) break;
          _ref4 = _i4.value;
        }

        var wfsLayer = _ref4;
        var maxRes = wfsLayer.maxResolution;
        var minRes = wfsLayer.minResolution;
        var inMinRange = minRes === undefined || res >= minRes;
        var inMaxRange = maxRes === undefined || res <= maxRes;
        var inRange = inMinRange && inMaxRange;

        if (inRange && (!queryableOnly || wfsLayer.queryable)) {
          layerNames.push(wfsLayer.name);
        }
      }
    }

    return layerNames;
  };

  _proto.getWFSLayerNames = function getWFSLayerNames(queryableOnly) {
    if (queryableOnly === void 0) {
      queryableOnly = false;
    }

    var layerNames = [];

    if (this.wfsLayers) {
      for (var _iterator5 = this.wfsLayers, _isArray5 = Array.isArray(_iterator5), _i5 = 0, _iterator5 = _isArray5 ? _iterator5 : _iterator5[Symbol.iterator]();;) {
        var _ref5;

        if (_isArray5) {
          if (_i5 >= _iterator5.length) break;
          _ref5 = _iterator5[_i5++];
        } else {
          _i5 = _iterator5.next();
          if (_i5.done) break;
          _ref5 = _i5.value;
        }

        var wfsLayer = _ref5;

        if (!queryableOnly || wfsLayer.queryable) {
          layerNames.push(wfsLayer.name);
        }
      }
    }

    return layerNames;
  };

  _proto.getFiltrableWFSLayerName = function getFiltrableWFSLayerName() {
    if (!this.filtrable) {
      throw new Error('Missing filtrable');
    }

    var layerNames = this.getWFSLayerNames();
    console.assert(layerNames.length === 1);
    return layerNames[0];
  };

  _proto.updateGeometryNameFromAttributes_ = function updateGeometryNameFromAttributes_() {
    if (this.attributes) {
      for (var _iterator6 = this.attributes, _isArray6 = Array.isArray(_iterator6), _i6 = 0, _iterator6 = _isArray6 ? _iterator6 : _iterator6[Symbol.iterator]();;) {
        var _ref6;

        if (_isArray6) {
          if (_i6 >= _iterator6.length) break;
          _ref6 = _iterator6[_i6++];
        } else {
          _i6 = _iterator6.next();
          if (_i6.done) break;
          _ref6 = _i6.value;
        }

        var attribute = _ref6;

        if (attribute.type === ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_4__["default"].GEOMETRY) {
          this.geometryName_ = attribute.name;
          break;
        }
      }
    }
  };

  _proto.haveTheSameActiveDimensions = function haveTheSameActiveDimensions(dataSource) {
    var share = true;
    var myActive = this.activeDimensions;
    var itsActive = dataSource.activeDimensions;

    for (var key in myActive) {
      if (myActive[key] !== itsActive[key]) {
        share = false;
        break;
      }
    }

    if (share) {
      for (var _key in itsActive) {
        if (itsActive[_key] !== myActive[_key]) {
          share = false;
          break;
        }
      }
    }

    return share;
  };

  _createClass(OGC, [{
    key: "dimensions",
    get: function get() {
      return this.dimensions_;
    }
  }, {
    key: "filterCondition",
    get: function get() {
      return this.filterCondition_;
    },
    set: function set(filterCondition) {
      this.filterCondition_ = filterCondition;
    }
  }, {
    key: "timeRangeValue",
    get: function get() {
      var range = null;
      var lower = this.timeLowerValue;
      var upper = this.timeUpperValue;

      if (lower !== undefined) {
        range = {
          start: lower
        };

        if (upper != undefined) {
          range.end = upper;
        }
      }

      return range;
    },
    set: function set(range) {
      if (range) {
        this.timeUpperValue = range.end;
        this.timeLowerValue = range.start;
      } else {
        this.timeUpperValue = undefined;
        this.timeLowerValue = undefined;
      }
    }
  }, {
    key: "copyable",
    get: function get() {
      return this.copyable_;
    }
  }, {
    key: "ogcImageType",
    get: function get() {
      return this.ogcImageType_;
    }
  }, {
    key: "wmsLayers",
    get: function get() {
      return this.wmsLayers_;
    }
  }, {
    key: "wfsLayers",
    get: function get() {
      return this.wfsLayers_;
    }
  }, {
    key: "ogcServerType",
    get: function get() {
      return this.ogcServerType_;
    }
  }, {
    key: "ogcType",
    get: function get() {
      return this.ogcType_;
    }
  }, {
    key: "snappable",
    get: function get() {
      return this.snappable_;
    }
  }, {
    key: "snappingToEdges",
    get: function get() {
      return this.snappingToEdges_;
    }
  }, {
    key: "snappingToVertice",
    get: function get() {
      return this.snappingToVertice_;
    }
  }, {
    key: "snappingTolerance",
    get: function get() {
      return this.snappingTolerance_;
    }
  }, {
    key: "timeAttributeName",
    get: function get() {
      return this.timeAttributeName_;
    }
  }, {
    key: "timeProperty",
    get: function get() {
      return this.timeProperty_;
    }
  }, {
    key: "wfsFeatureNS",
    get: function get() {
      return this.wfsFeatureNS_;
    }
  }, {
    key: "wfsFeaturePrefix",
    get: function get() {
      return this.wfsFeaturePrefix_;
    }
  }, {
    key: "wfsOutputFormat",
    get: function get() {
      return this.wfsOutputFormat_;
    }
  }, {
    key: "wfsUrl",
    get: function get() {
      return this.wfsUrl_;
    }
  }, {
    key: "wmsInfoFormat",
    get: function get() {
      return this.wmsInfoFormat_;
    }
  }, {
    key: "wmsIsSingleTile",
    get: function get() {
      return this.wmsIsSingleTile_;
    }
  }, {
    key: "wmsUrl",
    get: function get() {
      return this.wmsUrl_;
    }
  }, {
    key: "wmtsLayer",
    get: function get() {
      return this.wmtsLayer_;
    }
  }, {
    key: "wmtsUrl",
    get: function get() {
      return this.wmtsUrl_;
    }
  }, {
    key: "activeDimensions",
    get: function get() {
      var active = {};
      var dimensions = this.dimensions_ || {};
      var config = this.dimensionsConfig || {};

      for (var key in config) {
        var configValue = config[key];

        if (configValue === null) {
          var value = dimensions[key];

          if (value !== undefined && value !== null) {
            active[key] = value;
          }
        } else {
          active[key] = configValue;
        }
      }

      return active;
    }
  }, {
    key: "combinableForWFS",
    get: function get() {
      return this.filterRules === null && this.timeRangeValue === null;
    }
  }, {
    key: "combinableForWMS",
    get: function get() {
      return this.filterRules === null && this.timeRangeValue === null;
    }
  }, {
    key: "queryable",
    get: function get() {
      var queryable = false;

      if (this.supportsWFS && this.wfsLayers) {
        for (var _iterator7 = this.wfsLayers, _isArray7 = Array.isArray(_iterator7), _i7 = 0, _iterator7 = _isArray7 ? _iterator7 : _iterator7[Symbol.iterator]();;) {
          var _ref7;

          if (_isArray7) {
            if (_i7 >= _iterator7.length) break;
            _ref7 = _iterator7[_i7++];
          } else {
            _i7 = _iterator7.next();
            if (_i7.done) break;
            _ref7 = _i7.value;
          }

          var wfsLayer = _ref7;

          if (wfsLayer.queryable === true) {
            queryable = true;
            break;
          }
        }
      }

      if (this.supportsWMS && this.wmsLayers && this.wmsLayers.length > 0) {
        queryable = true;
      }

      return queryable;
    }
  }, {
    key: "supportsWFS",
    get: function get() {
      return this.wfsUrl !== undefined;
    }
  }, {
    key: "supportsAttributes",
    get: function get() {
      return this.attributes !== null || this.supportsWFS && this.wfsLayers !== null && this.wfsLayers.length === 1 && this.wfsLayers[0].queryable === true;
    }
  }, {
    key: "supportsWMS",
    get: function get() {
      return this.wmsUrl !== undefined;
    }
  }, {
    key: "supportsWMTS",
    get: function get() {
      return this.wmtsUrl !== undefined;
    }
  }, {
    key: "wfsFormat",
    get: function get() {
      return this.wfsFormat_;
    }
  }, {
    key: "wmsFormat",
    get: function get() {
      return this.wmsFormat_;
    }
  }]);

  return OGC;
}(ngeo_datasource_DataSource_js__WEBPACK_IMPORTED_MODULE_1__["default"]);

function guessServiceTypeByUrl(url) {
  var type;

  if (/(wmts)/i.test(url)) {
    type = Type.WMTS;
  } else {
    type = Type.WMS;
  }

  return type;
}
var TimePropertyWidgetEnum = {
  SLIDER: 'slider',
  DATEPICKER: 'datepicker'
};
var TimePropertyModeEnum = {
  RANGE: 'range',
  VALUE: 'value',
  DISABLED: 'disabled'
};
var TimePropertyResolutionEnum = {
  DAY: 'day',
  MONTH: 'month',
  YEAR: 'year',
  SECOND: 'second'
};
/* harmony default export */ __webpack_exports__["default"] = (OGC);

/***/ }),

/***/ "./src/datasource/OGCGroup.js":
/*!************************************!*\
  !*** ./src/datasource/OGCGroup.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_datasource_Group_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/datasource/Group.js */ "./src/datasource/Group.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }



var _default = function (_ngeoDatasourceGroup) {
  _inheritsLoose(_default, _ngeoDatasourceGroup);

  function _default(options) {
    var _this;

    _this = _ngeoDatasourceGroup.call(this, options) || this;
    _this.url_ = options.url;
    return _this;
  }

  _createClass(_default, [{
    key: "url",
    get: function get() {
      return this.url_;
    }
  }]);

  return _default;
}(ngeo_datasource_Group_js__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/datasource/WMSGroup.js":
/*!************************************!*\
  !*** ./src/datasource/WMSGroup.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_datasource_OGCGroup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/datasource/OGCGroup.js */ "./src/datasource/OGCGroup.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





var _default = function (_ngeoDatasourceOGCGro) {
  _inheritsLoose(_default, _ngeoDatasourceOGCGro);

  function _default(options, ngeoLayerHelper) {
    var _this;

    _this = _ngeoDatasourceOGCGro.call(this, options) || this;
    var injector = options.injector;
    _this.layer_ = null;
    _this.ngeoLayerHelper_ = ngeoLayerHelper;
    _this.rootScope_ = injector.get('$rootScope');
    _this.wmsDataSourceUnregister_ = {};

    _this.init_();

    return _this;
  }

  var _proto = _default.prototype;

  _proto.init_ = function init_() {
    if (!this.dataSources.length) {
      throw new Error('Missing dataSources');
    }

    for (var _iterator = this.dataSources, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var dataSource = _ref;

      if (dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"]) {
        this.registerDataSource_(dataSource);
      }
    }
  };

  _proto.destroy = function destroy() {
    for (var _iterator2 = this.dataSources, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
      var _ref2;

      if (_isArray2) {
        if (_i2 >= _iterator2.length) break;
        _ref2 = _iterator2[_i2++];
      } else {
        _i2 = _iterator2.next();
        if (_i2.done) break;
        _ref2 = _i2.value;
      }

      var dataSource = _ref2;

      if (dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"]) {
        this.unregisterDataSource_(dataSource);
      }
    }

    _ngeoDatasourceOGCGro.prototype.destroy.call(this);
  };

  _proto.addDataSource = function addDataSource(dataSource) {
    _ngeoDatasourceOGCGro.prototype.addDataSource.call(this, dataSource);

    if (!(dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"])) {
      throw new Error('Wrong datasource type');
    }

    this.registerDataSource_(dataSource);
  };

  _proto.registerDataSource_ = function registerDataSource_(dataSource) {
    var id = dataSource.id;
    this.wmsDataSourceUnregister_[id] = this.rootScope_.$watch(function () {
      return dataSource.visible;
    }, this.handleDataSourceVisibleChange_.bind(this));

    if (!this.layer_) {
      this.layer_ = this.ngeoLayerHelper_.createBasicWMSLayerFromDataSource(dataSource);
    } else {
      this.layer_.get('querySourceIds').push(id);
      this.updateLayer_();
    }
  };

  _proto.handleDataSourceVisibleChange_ = function handleDataSourceVisibleChange_(value, oldValue) {
    if (value !== undefined && value !== oldValue) {
      this.updateLayer_();
    }
  };

  _proto.updateLayer_ = function updateLayer_() {
    var layer = this.layer;
    var layerNames = [];

    for (var _iterator3 = this.dataSources, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
      var _ref3;

      if (_isArray3) {
        if (_i3 >= _iterator3.length) break;
        _ref3 = _iterator3[_i3++];
      } else {
        _i3 = _iterator3.next();
        if (_i3.done) break;
        _ref3 = _i3.value;
      }

      var dataSource = _ref3;

      if (dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"] && dataSource.visible) {
        layerNames = layerNames.concat(dataSource.getWMSLayerNames());
      }
    }

    this.ngeoLayerHelper_.updateWMSLayerState(layer, layerNames.join(','));
  };

  _proto.removeDataSource = function removeDataSource(dataSource) {
    _ngeoDatasourceOGCGro.prototype.removeDataSource.call(this, dataSource);

    if (dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"]) {
      this.unregisterDataSource_(dataSource);
    }
  };

  _proto.unregisterDataSource_ = function unregisterDataSource_(dataSource) {
    var id = dataSource.id;
    var layer = this.layer;
    var unregister = this.wmsDataSourceUnregister_[id];
    unregister();
    delete this.wmsDataSourceUnregister_[id];
    Object(ol_array_js__WEBPACK_IMPORTED_MODULE_2__["remove"])(this.dataSources, dataSource);
    var ids = this.ngeoLayerHelper_.getQuerySourceIds(layer);

    if (ids) {
      Object(ol_array_js__WEBPACK_IMPORTED_MODULE_2__["remove"])(ids, id);
    }

    if (this.dataSources.length) {
      this.updateLayer_();
    }
  };

  _createClass(_default, [{
    key: "layer",
    get: function get() {
      if (!this.layer_) {
        throw new Error('Missing layer');
      }

      return this.layer_;
    }
  }]);

  return _default;
}(ngeo_datasource_OGCGroup_js__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/download/Csv.js":
/*!*****************************!*\
  !*** ./src/download/Csv.js ***!
  \*****************************/
/*! exports provided: DownloadCsvService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DownloadCsvService", function() { return DownloadCsvService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_download_service_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/download/service.js */ "./src/download/service.js");
DownloadCsvService.$inject = ["$injector", "gettextCatalog"];


function DownloadCsvService($injector, gettextCatalog) {
  this.gettextCatalog_ = gettextCatalog;
  this.encoding_ = $injector.has('ngeoCsvEncoding') ? $injector.get('ngeoCsvEncoding') : 'utf-8';
  this.extension_ = $injector.has('ngeoCsvExtension') ? $injector.get('ngeoCsvExtension') : '.csv';
  this.includeHeader_ = $injector.has('ngeoCsvIncludeHeader') ? $injector.get('ngeoCsvIncludeHeader') : true;
  this.quote_ = $injector.has('ngeoCsvQuote') ? $injector.get('ngeoCsvQuote') : '"';
  this.separator_ = $injector.has('ngeoCsvSeparator') ? $injector.get('ngeoCsvSeparator') : ',';
  this.download_ = $injector.get('ngeoDownload');
}

DownloadCsvService.prototype.generateCsv = function (data, columnDefs) {
  var _this = this;

  if (data.length == 0 || columnDefs.length == 0) {
    return '';
  }

  var translatedColumnHeaders = columnDefs.map(function (columnHeader) {
    return _this.gettextCatalog_.getString(columnHeader.name);
  });
  var header = this.getRow_(translatedColumnHeaders);
  var dataRows = data.map(function (values) {
    var rowValues = columnDefs.map(function (columnHeader) {
      return values[columnHeader.name];
    });
    return _this.getRow_(rowValues);
  });
  return this.includeHeader_ ? header + dataRows.join('') : dataRows.join('');
};

DownloadCsvService.prototype.getRow_ = function (values) {
  var _this2 = this;

  var matchAllQuotesRegex = new RegExp(this.quote_, 'g');
  var doubleQuote = this.quote_ + this.quote_;
  var rowValues = values.map(function (value) {
    if (value !== undefined && value !== null) {
      value = "" + value;
      return "" + _this2.quote_ + value.replace(matchAllQuotesRegex, doubleQuote) + _this2.quote_;
    } else {
      return '';
    }
  });
  return rowValues.join(this.separator_) + "\n";
};

DownloadCsvService.prototype.startDownload = function (data, columnDefs, fileName) {
  var fileContent = this.generateCsv(data, columnDefs);
  this.download_(fileContent, fileName, "text/csv;charset=" + this.encoding_);
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoCsvDownload', [ngeo_download_service_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.service('ngeoCsvDownload', DownloadCsvService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/download/service.js":
/*!*********************************!*\
  !*** ./src/download/service.js ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
/* harmony import */ var file_saver__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! file-saver */ "./node_modules/file-saver/dist/FileSaver.min.js");
/* harmony import */ var file_saver__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(file_saver__WEBPACK_IMPORTED_MODULE_2__);



var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDownload', []);

function factory() {
  function download(content, fileName, opt_fileType) {
    var fileType = opt_fileType !== undefined && !Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["isSafari"])() ? opt_fileType : 'text/plain;charset=utf-8';
    var blob = new Blob([content], {
      type: fileType
    });
    Object(file_saver__WEBPACK_IMPORTED_MODULE_2__["saveAs"])(blob, fileName);
  }

  return download;
}

module.factory('ngeoDownload', factory);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/draw/Controller.js":
/*!********************************!*\
  !*** ./src/draw/Controller.js ***!
  \********************************/
/*! exports provided: DrawController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DrawController", function() { return DrawController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_draw_features_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/draw/features.js */ "./src/draw/features.js");
/* harmony import */ var ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/format/FeatureProperties.js */ "./src/format/FeatureProperties.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_misc_btnComponent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/misc/btnComponent.js */ "./src/misc/btnComponent.js");
/* harmony import */ var ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/misc/decorate.js */ "./src/misc/decorate.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");








var DrawController = function () {
  DrawController.$inject = ["$scope", "gettextCatalog", "ngeoFeatureHelper", "ngeoFeatures"];

  function DrawController($scope, gettextCatalog, ngeoFeatureHelper, ngeoFeatures) {
    var _this = this;

    this.active = false;
    this.features = null;
    this.map = null;
    this.showMeasure = false;
    this.gettextCatalog_ = gettextCatalog;
    gettextCatalog.getString('Point');
    gettextCatalog.getString('LineString');
    gettextCatalog.getString('Polygon');
    gettextCatalog.getString('Circle');
    gettextCatalog.getString('Rectangle');
    gettextCatalog.getString('Text');
    this.featureHelper_ = ngeoFeatureHelper;
    this.ngeoFeatures_ = ngeoFeatures;
    this.interactions_ = [];
    this.drawPoint = null;
    this.measureLength = null;
    this.measureArea = null;
    this.measureAzimut = null;
    this.drawRectangle = null;
    this.drawText = null;
    $scope.$watch(function () {
      return _this.active;
    }, function (newVal) {
      if (newVal === false) {
        _this.interactions_.forEach(function (interaction) {
          interaction.setActive(false);
        });
      }
    });
  }

  var _proto = DrawController.prototype;

  _proto.registerInteraction = function registerInteraction(interaction) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    this.interactions_.push(interaction);
    interaction.setActive(false);
    Object(ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_5__["interactionDecoration"])(interaction);
    this.map.addInteraction(interaction);
  };

  _proto.handleActiveChange = function handleActiveChange(event) {
    this.active = this.interactions_.some(function (interaction) {
      return interaction.getActive();
    }, this);
  };

  _proto.handleDrawEnd = function handleDrawEnd(type, event) {
    var sketch;

    if (event.feature) {
      sketch = event.feature;
    } else {
      sketch = event.detail.feature;
    }

    console.assert(sketch);
    var azimut = sketch.get('azimut');
    var features = this.features || this.ngeoFeatures_;
    var feature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_7__["default"](sketch.getGeometry());
    var prop = ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_2__["default"];

    switch (type) {
      case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__["default"].CIRCLE:
        feature.set(prop.IS_CIRCLE, true);

        if (azimut !== undefined) {
          feature.set(prop.AZIMUT, azimut);
        }

        break;

      case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__["default"].TEXT:
        feature.set(prop.IS_TEXT, true);
        break;

      case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__["default"].RECTANGLE:
        feature.set(prop.IS_RECTANGLE, true);
        break;

      default:
        break;
    }

    var name = this.gettextCatalog_.getString(type);
    feature.set(prop.NAME, name + " " + (features.getLength() + 1));
    var color = type !== ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__["default"].TEXT ? '#DB4436' : '#000000';
    feature.set(prop.COLOR, color);
    feature.set(prop.ANGLE, 0);
    feature.set(prop.OPACITY, 0.2);
    feature.set(prop.SHOW_MEASURE, this.showMeasure ? true : false);
    feature.set(prop.SHOW_LABEL, false);
    feature.set(prop.SIZE, 10);
    feature.set(prop.STROKE, 2);
    this.featureHelper_.setStyle(feature);
    features.push(feature);
  };

  return DrawController;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDrawfeatureController', [ngeo_draw_features_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_misc_btnComponent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_6__["default"].name]);
module.controller('ngeoDrawfeatureController', DrawController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/draw/component.js":
/*!*******************************!*\
  !*** ./src/draw/component.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_draw_Controller_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/draw/Controller.js */ "./src/draw/Controller.js");
/* harmony import */ var ngeo_draw_point_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/draw/point.js */ "./src/draw/point.js");
/* harmony import */ var ngeo_draw_rectangle_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/draw/rectangle.js */ "./src/draw/rectangle.js");
/* harmony import */ var ngeo_draw_text_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/draw/text.js */ "./src/draw/text.js");
/* harmony import */ var ngeo_measure_area_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/measure/area.js */ "./src/measure/area.js");
/* harmony import */ var ngeo_measure_azimut_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/measure/azimut.js */ "./src/measure/azimut.js");
/* harmony import */ var ngeo_measure_length_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/measure/length.js */ "./src/measure/length.js");








var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDrawfeature', [ngeo_draw_Controller_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_draw_point_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_draw_rectangle_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_draw_text_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_measure_area_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_measure_azimut_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, ngeo_measure_length_js__WEBPACK_IMPORTED_MODULE_7__["default"].name]);

function drawComponent() {
  return {
    controller: 'ngeoDrawfeatureController as dfCtrl',
    scope: true,
    bindToController: {
      'active': '=ngeoDrawfeatureActive',
      'features': '=?ngeoDrawfeatureFeatures',
      'map': '=ngeoDrawfeatureMap',
      'showMeasure': '=?ngeoDrawfeatureShowmeasure'
    }
  };
}

module.directive('ngeoDrawfeature', drawComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/draw/features.js":
/*!******************************!*\
  !*** ./src/draw/features.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");


var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoFeatures', []);
module.value('ngeoFeatures', new ol_Collection_js__WEBPACK_IMPORTED_MODULE_1__["default"]());
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/draw/point.js":
/*!***************************!*\
  !*** ./src/draw/point.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDrawpoint', []);

function drawPointComponent() {
  return {
    restrict: 'A',
    require: '^^ngeoDrawfeature',
    link: function link($scope, element, attrs, drawFeatureCtrl) {
      if (!drawFeatureCtrl) {
        throw new Error('Missing drawFeatureCtrl');
      }

      var drawPoint = new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
        type: 'Point'
      });
      drawFeatureCtrl.registerInteraction(drawPoint);
      drawFeatureCtrl.drawPoint = drawPoint;
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(drawPoint, 'drawend', drawFeatureCtrl.handleDrawEnd.bind(drawFeatureCtrl, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_1__["default"].POINT), drawFeatureCtrl);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(drawPoint, 'change:active', drawFeatureCtrl.handleActiveChange, drawFeatureCtrl);
    }
  };
}

module.directive('ngeoDrawpoint', drawPointComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/draw/rectangle.js":
/*!*******************************!*\
  !*** ./src/draw/rectangle.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");





var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDrawrectangle', []);

function drawRectangleComponent() {
  return {
    restrict: 'A',
    require: '^^ngeoDrawfeature',
    link: function link($scope, element, attrs, drawFeatureCtrl) {
      if (!drawFeatureCtrl) {
        throw new Error('Missing drawFeatureCtrl');
      }

      var drawRectangle = new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
        type: 'LineString',
        geometryFunction: function geometryFunction(coordinates, geometry) {
          if (!geometry) {
            geometry = new ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_4__["default"]([]);
          }

          var start = coordinates[0];

          if (!Array.isArray(start)) {
            throw new Error('Wrong coordinates type');
          }

          var end = coordinates[1];

          if (!Array.isArray(end)) {
            throw new Error('Wrong coordinates type');
          }

          geometry.setCoordinates([[start, [start[0], end[1]], end, [end[0], start[1]], start]]);
          return geometry;
        },
        maxPoints: 2
      });
      drawFeatureCtrl.registerInteraction(drawRectangle);
      drawFeatureCtrl.drawRectangle = drawRectangle;
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(drawRectangle, 'drawend', drawFeatureCtrl.handleDrawEnd.bind(drawFeatureCtrl, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_1__["default"].RECTANGLE), drawFeatureCtrl);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(drawRectangle, 'change:active', drawFeatureCtrl.handleActiveChange, drawFeatureCtrl);
    }
  };
}

module.directive('ngeoDrawrectangle', drawRectangleComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/draw/text.js":
/*!**************************!*\
  !*** ./src/draw/text.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDrawtext', []);

function drawTextComponent() {
  return {
    restrict: 'A',
    require: '^^ngeoDrawfeature',
    link: function link($scope, element, attrs, drawFeatureCtrl) {
      if (!drawFeatureCtrl) {
        throw new Error('Missing drawFeatureCtrl');
      }

      var drawText = new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
        type: 'Point'
      });
      drawFeatureCtrl.registerInteraction(drawText);
      drawFeatureCtrl.drawText = drawText;
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(drawText, 'drawend', drawFeatureCtrl.handleDrawEnd.bind(drawFeatureCtrl, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_1__["default"].TEXT), drawFeatureCtrl);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(drawText, 'change:active', drawFeatureCtrl.handleActiveChange, drawFeatureCtrl);
    }
  };
}

module.directive('ngeoDrawtext', drawTextComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/editing/attributesComponent.js":
/*!********************************************!*\
  !*** ./src/editing/attributesComponent.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/misc/EventHelper.js */ "./src/misc/EventHelper.js");
/* harmony import */ var ngeo_misc_datetimepickerComponent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/misc/datetimepickerComponent.js */ "./src/misc/datetimepickerComponent.js");
/* harmony import */ var ol_Object_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/Object.js */ "./node_modules/ol/Object.js");
Controller.$inject = ["$scope", "ngeoEventHelper"];






var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoAttributes', [ngeo_misc_datetimepickerComponent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/editing/attributescomponent', __webpack_require__(/*! ./attributescomponent.html */ "./src/editing/attributescomponent.html"));
}]);
module.value('ngeoAttributesTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.ngeoAttributesTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'ngeo/editing/attributescomponent';
});
ngeoAttributesTemplateUrl.$inject = ["$attrs", "ngeoAttributesTemplateUrl"];

function ngeoAttributesTemplateUrl($attrs, ngeoAttributesTemplateUrl) {
  return ngeoAttributesTemplateUrl($attrs);
}

var editingAttributeComponent = {
  controller: 'ngeoAttributesController as attrCtrl',
  bindings: {
    'attributes': '=ngeoAttributesAttributes',
    'disabled': '<ngeoAttributesDisabled',
    'feature': '=ngeoAttributesFeature'
  },
  require: {
    'form': '^'
  },
  templateUrl: ngeoAttributesTemplateUrl
};
module.component('ngeoAttributes', editingAttributeComponent);

function Controller($scope, ngeoEventHelper) {
  this.attributes = [];
  this.disabled = false;
  this.feature = null;
  this.properties = {};
  this.scope_ = $scope;
  this.ngeoEventHelper_ = ngeoEventHelper;
  this.updating_ = false;
}

Controller.prototype.$onInit = function () {
  if (!this.feature) {
    throw new Error('Missing feature');
  }

  this.properties = this.feature.getProperties();
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(this);
  this.ngeoEventHelper_.addListenerKey(uid, Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(this.feature, 'propertychange', this.handleFeaturePropertyChange_, this));
};

Controller.prototype.handleInputChange = function (name) {
  if (!this.properties) {
    throw new Error('Missing properties');
  }

  if (!this.feature) {
    throw new Error('Missing feature');
  }

  this.updating_ = true;
  var value = this.properties[name];
  this.feature.set(name, value);
  this.updating_ = false;
};

Controller.prototype.$onDestroy = function () {
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(this);
  this.ngeoEventHelper_.clearListenerKey(uid);
};

Controller.prototype.handleFeaturePropertyChange_ = function (evt) {
  if (evt instanceof ol_Object_js__WEBPACK_IMPORTED_MODULE_5__["ObjectEvent"]) {
    if (this.updating_) {
      return;
    }

    this.properties[evt.key] = evt.target.get(evt.key);
    this.scope_.$apply();
  }
};

module.controller('ngeoAttributesController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/editing/attributescomponent.html":
/*!**********************************************!*\
  !*** ./src/editing/attributescomponent.html ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<fieldset ng-disabled="attrCtrl.disabled">\n  <div\n      class="form-group"\n      ng-repeat="attribute in ::attrCtrl.attributes">\n    <div ng-if="attribute.type !== \'geometry\'">\n      <label\n          ng-if="::attribute.type !== \'boolean\'"\n          class="col-form-label">{{ ::attribute.name | translate }} <span class="text-muted">{{::attribute.required ? "*" : ""}}</span>\n      </label>\n\n      <div\n          class="form-control"\n          ng-if="::attribute.readonly"\n          readonly>\n        {{::attrCtrl.properties[attribute.name]}}\n      </div>\n\n      <div\n          ng-if="::!attribute.readonly"\n          ng-switch="::attribute.type">\n\n        <div\n            ng-switch-when="boolean"\n            class="form-check">\n          <label class="form-check-label">\n            <input\n                name="{{::attribute.name}}"\n                class="form-check-input"\n                ng-model="attrCtrl.properties[attribute.name]"\n                ng-change="attrCtrl.handleInputChange(attribute.name);"\n                type="checkbox">\n            </input>\n            <span> {{ ::attribute.name | translate }} <span class="text-muted">{{::attribute.required ? "*" : ""}}</span></span>\n          </label>\n        </div>\n\n        <select\n            name="{{::attribute.name}}"\n            ng-required="attribute.required"\n            ng-switch-when="select"\n            ng-model="attrCtrl.properties[attribute.name]"\n            ng-change="attrCtrl.handleInputChange(attribute.name);"\n            class="form-control"\n            type="text">\n          <option\n              ng-repeat="attribute in ::attribute.choices"\n              value="{{ ::attribute }}">\n            {{ ::attribute | translate }}\n          </option>\n        </select>\n\n        <input\n            name="{{::attribute.name}}"\n            ng-required="attribute.required"\n            ng-switch-when="date"\n            ng-model="attrCtrl.properties[attribute.name]"\n            ng-change="attrCtrl.handleInputChange(attribute.name);"\n            ngeo-datetimepicker\n            ngeo-datetimepicker-options="\'{&quot;timepicker&quot;: false, &quot;format&quot;: &quot;\' + attribute.format + \'&quot;, &quot;allowBlank&quot;: true, &quot;todayButton&quot;: false, &quot;mask&quot;: &quot;\' + attribute.mask + \'&quot;}\'"\n            class="form-control"\n            type="text">\n        </input>\n\n        <input\n            name="{{::attribute.name}}"\n            id="time"\n            ng-required="attribute.required"\n            ng-switch-when="time"\n            ng-model="attrCtrl.properties[attribute.name]"\n            ng-change="attrCtrl.handleInputChange(attribute.name);"\n            ngeo-datetimepicker\n            ngeo-datetimepicker-options="\'{&quot;datepicker&quot;: false, &quot;format&quot;: &quot;\' + attribute.format + \'&quot;, &quot;todayButton&quot;: false, &quot;mask&quot;: &quot;\' + attribute.mask + \'&quot;, &quot;defaultTime&quot;: &quot;00:00&quot;}\'"\n            class="form-control"\n            type="text">\n        </input>\n\n        <input\n            name="{{::attribute.name}}"\n            ng-required="attribute.required"\n            ng-switch-when="datetime"\n            ng-model="attrCtrl.properties[attribute.name]"\n            ng-change="attrCtrl.handleInputChange(attribute.name);"\n            ngeo-datetimepicker\n            ngeo-datetimepicker-options="\'{&quot;scrollTime&quot;: false, &quot;format&quot;: &quot;\' + attribute.format + \'&quot;, &quot;allowBlank&quot;: true, &quot;todayButton&quot;: false, &quot;mask&quot;: &quot;\' + attribute.mask + \'&quot;, &quot;defaultTime&quot;: &quot;00:00&quot;}\'"\n            class="form-control"\n            type="text">\n        </input>\n\n        <div\n            ng-switch-when="number"\n            ng-switch="::attribute.numType">\n          <input\n              name="{{::attribute.name}}"\n              ng-required="attribute.required"\n              ng-switch-when="integer"\n              ng-model="attrCtrl.properties[attribute.name]"\n              ng-change="attrCtrl.handleInputChange(attribute.name);"\n              class="form-control"\n              step="1"\n              type="number">\n          </input>\n          <input\n              name="{{::attribute.name}}"\n              ng-required="attribute.required"\n              ng-switch-default\n              ng-model="attrCtrl.properties[attribute.name]"\n              ng-change="attrCtrl.handleInputChange(attribute.name);"\n              class="form-control"\n              type="number">\n          </input>\n        </div>\n\n        <input\n            name="{{::attribute.name}}"\n            ng-required="attribute.required"\n            ng-switch-default\n            ng-model="attrCtrl.properties[attribute.name]"\n            ng-change="attrCtrl.handleInputChange(attribute.name);"\n            ng-maxlength="attribute.maxLength"\n            class="form-control"\n            type="text">\n        </input>\n\n        <div ng-show="attrCtrl.form.$submitted || attrCtrl.form[attribute.name].$touched">\n          <p class="text-danger"\n             ng-show="attrCtrl.form[attribute.name].$error.required">\n            {{\'This field is required\' | translate}}\n          </p>\n        </div>\n      </div>\n    </div>\n  </div>\n</fieldset>\n';

}
return __p
}

/***/ }),

/***/ "./src/editing/createfeatureComponent.js":
/*!***********************************************!*\
  !*** ./src/editing/createfeatureComponent.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/filters.js */ "./src/misc/filters.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_interaction_MeasureArea_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/interaction/MeasureArea.js */ "./src/interaction/MeasureArea.js");
/* harmony import */ var ngeo_interaction_MeasureLength_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/interaction/MeasureLength.js */ "./src/interaction/MeasureLength.js");
/* harmony import */ var ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/misc/EventHelper.js */ "./src/misc/EventHelper.js");
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
Controller.$inject = ["gettextCatalog", "$compile", "$filter", "$injector", "$scope", "$timeout", "ngeoEventHelper"];













var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoCreatefeature', [ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);

function editingCreateFeatureComponent() {
  return {
    controller: 'ngeoCreatefeatureController',
    bindToController: true,
    scope: {
      'active': '=ngeoCreatefeatureActive',
      'features': '=ngeoCreatefeatureFeatures',
      'geomType': '=ngeoCreatefeatureGeomType',
      'map': '=ngeoCreatefeatureMap'
    }
  };
}

module.directive('ngeoCreatefeature', editingCreateFeatureComponent);

function Controller(gettextCatalog, $compile, $filter, $injector, $scope, $timeout, ngeoEventHelper) {
  var _this = this;

  this.active = false;
  this.features = null;
  this.geomType = '';
  this.map = null;
  this.gettextCatalog_ = gettextCatalog;
  this.compile_ = $compile;
  this.filter_ = $filter;
  this.scope_ = $scope;
  this.timeout_ = $timeout;
  this.ngeoEventHelper_ = ngeoEventHelper;
  this.injector_ = $injector;
  this.interaction_ = null;
  $scope.$watch(function () {
    return _this.active;
  }, function (newVal) {
    if (!_this.interaction_) {
      throw new Error('Missing interaction');
    }

    _this.interaction_.setActive(newVal);
  });
}

Controller.prototype.$onInit = function () {
  this.active = this.active === true;
  var gettextCatalog = this.gettextCatalog_;
  var interaction;

  if (this.geomType === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].POINT || this.geomType === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].MULTI_POINT) {
    interaction = new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
      type: 'Point'
    });
  } else if (this.geomType === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].LINE_STRING || this.geomType === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].MULTI_LINE_STRING) {
    var helpMsg = gettextCatalog.getString('Click to start drawing length');
    var contMsg = gettextCatalog.getString('Click to continue drawing<br/>' + 'Double-click or click last point to finish');
    var options = {
      style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_12__["default"](),
      startMsg: this.compile_("<div translate>" + helpMsg + "</div>")(this.scope_)[0],
      continueMsg: this.compile_("<div translate>" + contMsg + "</div>")(this.scope_)[0]
    };

    if (this.injector_.has('ngeoSnappingTolerance')) {
      options.tolerance = this.injector_.get('ngeoSnappingTolerance');
    }

    if (this.injector_.has('ngeoSnappingSource')) {
      options.source = this.injector_.get('ngeoSnappingSource');
    }

    interaction = new ngeo_interaction_MeasureLength_js__WEBPACK_IMPORTED_MODULE_4__["default"](this.filter_('ngeoUnitPrefix'), gettextCatalog, options);
  } else if (this.geomType === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].POLYGON || this.geomType === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].MULTI_POLYGON) {
    var _helpMsg = gettextCatalog.getString('Click to start drawing area');

    var _contMsg = gettextCatalog.getString('Click to continue drawing<br/>' + 'Double-click or click starting point to finish');

    interaction = new ngeo_interaction_MeasureArea_js__WEBPACK_IMPORTED_MODULE_3__["default"](this.filter_('ngeoUnitPrefix'), gettextCatalog, {
      style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_12__["default"](),
      startMsg: this.compile_("<div translate>" + _helpMsg + "</div>")(this.scope_)[0],
      continueMsg: this.compile_("<div translate>" + _contMsg + "</div>")(this.scope_)[0]
    });
  }

  if (!interaction) {
    throw new Error('Missing interaction');
  }

  if (!this.map) {
    throw new Error('Missing map');
  }

  interaction.setActive(this.active);
  this.interaction_ = interaction;
  this.map.addInteraction(interaction);
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_7__["getUid"])(this);

  if (interaction instanceof ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_11__["default"]) {
    this.ngeoEventHelper_.addListenerKey(uid, Object(ol_events_js__WEBPACK_IMPORTED_MODULE_9__["listen"])(interaction, 'drawend', this.handleDrawEnd_, this));
  } else if (interaction instanceof ngeo_interaction_MeasureLength_js__WEBPACK_IMPORTED_MODULE_4__["default"] || interaction instanceof ngeo_interaction_MeasureArea_js__WEBPACK_IMPORTED_MODULE_3__["default"]) {
    this.ngeoEventHelper_.addListenerKey(uid, Object(ol_events_js__WEBPACK_IMPORTED_MODULE_9__["listen"])(interaction, 'measureend', this.handleDrawEnd_, this));
  }
};

Controller.prototype.handleDrawEnd_ = function (event) {
  var sketch;

  if (event.feature) {
    sketch = event.feature;
  } else {
    sketch = event.detail.feature;
  }

  console.assert(sketch);
  var geometry = sketch.getGeometry();
  var type = geometry.getType();

  if (this.geomType.indexOf('Multi') != type.indexOf('Multi')) {
    geometry = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_6__["toMulti"])(geometry);
  }

  var feature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_10__["default"](geometry);

  if (this.features instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
    this.features.push(feature);
  } else {
    if (!this.features) {
      throw new Error('Missing features');
    }

    this.features.addFeature(feature);
  }
};

Controller.prototype.$onDestroy = function () {
  var _this2 = this;

  this.timeout_(function () {
    if (!_this2.map) {
      throw new Error('Missing map');
    }

    if (!_this2.interaction_) {
      throw new Error('Missing interaction');
    }

    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_7__["getUid"])(_this2);

    _this2.ngeoEventHelper_.clearListenerKey(uid);

    _this2.interaction_.setActive(false);

    _this2.map.removeInteraction(_this2.interaction_);
  }, 0);
};

module.controller('ngeoCreatefeatureController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/editing/exportfeaturesComponent.js":
/*!************************************************!*\
  !*** ./src/editing/exportfeaturesComponent.js ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
Controller.$inject = ["$element", "$injector", "$scope", "ngeoFeatureHelper"];



var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoExportfeatures', [ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);

function editingExportFeaturesComponent() {
  return {
    controller: 'ngeoExportfeaturesController as efCtrl',
    scope: true,
    bindToController: {
      'features': '=ngeoExportfeaturesFeatures'
    }
  };
}

module.directive('ngeoExportfeatures', editingExportFeaturesComponent);

function Controller($element, $injector, $scope, ngeoFeatureHelper) {
  var _this = this;

  this.features = null;
  this.element_ = $element;
  var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(this);
  var id = ['ngeo-exportfeature', uid].join('-');
  this.id_ = id;
  this.featureHelper_ = ngeoFeatureHelper;
  var formats;

  if ($injector.has('ngeoExportFeatureFormats')) {
    formats = $injector.get('ngeoExportFeatureFormats');
  } else {
    formats = [ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_1__["FeatureFormatType"].KML];
  }

  this.menu_ = null;
  this.items_ = [];

  if (formats.length > 1) {
    $element.attr('id', id);
    var $menu = $('<ul />', {
      'class': 'dropdown-menu',
      'aria-labelledby': id
    }).appendTo($element.parent()[0]);
    this.menu_ = $menu;
    var $item;
    formats.forEach(function (format) {
      $item = $('<li />').appendTo($menu).append($('<a />', {
        'href': '#',
        'text': format
      }).on(['click', id].join('.'), _this.handleMenuItemClick_.bind(_this, format)));

      _this.items_.push($item);
    });
  }

  this.formats_ = formats;
  $element.on(['click', id].join('.'), this.handleElementClick_.bind(this));
  $scope.$on('$destroy', this.handleDestroy_.bind(this));
}

Controller.prototype.handleElementClick_ = function () {
  var _this2 = this;

  if (!this.features) {
    throw new Error('Missing features');
  }

  var features = this.features.getArray();

  if (this.formats_.length === 1) {
    this.featureHelper_.export(features, this.formats_[0]);
  } else if (features.length === 1) {
    var feature = features[0];
    var geometry = feature.getGeometry();

    if (!geometry) {
      throw new Error('Missing geometry');
    }

    var geometryType = geometry.getType();
    var $item;
    this.formats_.forEach(function (format, i) {
      $item = _this2.items_[i];

      if (format === ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_1__["FeatureFormatType"].GPX) {
        if (geometryType === 'Point' || geometryType === 'LineString') {
          $item.removeClass('disabled');
        } else {
          $item.addClass('disabled');
        }
      }
    });
  }
};

Controller.prototype.handleMenuItemClick_ = function (format, event) {
  if (!this.features) {
    throw new Error('Missing features');
  }

  if (!event.target.parentElement) {
    throw new Error('Missing event.target.parentElement');
  }

  if (!$(event.target.parentElement).hasClass('disabled')) {
    var features = this.features.getArray();
    this.featureHelper_.export(features, format);
  }
};

Controller.prototype.handleDestroy_ = function () {
  var id = this.id_;
  this.element_.off(['click', id].join('.'));

  if (this.menu_) {
    this.menu_.remove();
    this.items_.forEach(function ($item) {
      $item.off(['click', id].join('.'));
    });
    this.items_.length = 0;
    this.menu_ = null;
  }
};

module.controller('ngeoExportfeaturesController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/events.js":
/*!***********************!*\
  !*** ./src/events.js ***!
  \***********************/
/*! exports provided: unlistenByKeys */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "unlistenByKeys", function() { return unlistenByKeys; });
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");

function unlistenByKeys(keys) {
  for (var _iterator = keys, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
    var _ref;

    if (_isArray) {
      if (_i >= _iterator.length) break;
      _ref = _iterator[_i++];
    } else {
      _i = _iterator.next();
      if (_i.done) break;
      _ref = _i.value;
    }

    var key = _ref;
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_0__["unlistenByKey"])(key);
  }

  keys.length = 0;
}

/***/ }),

/***/ "./src/filter/Condition.js":
/*!*********************************!*\
  !*** ./src/filter/Condition.js ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ({
  AND: '&&',
  NOT: '!',
  OR: '||'
});

/***/ }),

/***/ "./src/filter/RuleHelper.js":
/*!**********************************!*\
  !*** ./src/filter/RuleHelper.js ***!
  \**********************************/
/*! exports provided: RuleHelper, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RuleHelper", function() { return RuleHelper; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/filter/Condition.js */ "./src/filter/Condition.js");
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/misc/WMSTime.js */ "./src/misc/WMSTime.js");
/* harmony import */ var ngeo_rule_Date_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/rule/Date.js */ "./src/rule/Date.js");
/* harmony import */ var ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/rule/Geometry.js */ "./src/rule/Geometry.js");
/* harmony import */ var ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/rule/Rule.js */ "./src/rule/Rule.js");
/* harmony import */ var ngeo_rule_Select_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/rule/Select.js */ "./src/rule/Select.js");
/* harmony import */ var ngeo_rule_Text_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/rule/Text.js */ "./src/rule/Text.js");
/* harmony import */ var ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/format/WFS.js */ "./node_modules/ol/format/WFS.js");
/* harmony import */ var ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/format/filter.js */ "./node_modules/ol/format/filter.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! moment */ "./node_modules/moment/src/moment.js");













var RuleHelper = function () {
  RuleHelper.$inject = ["gettextCatalog", "ngeoFeatureHelper", "ngeoWMSTime"];

  function RuleHelper(gettextCatalog, ngeoFeatureHelper, ngeoWMSTime) {
    this.gettextCatalog_ = gettextCatalog;
    this.ngeoFeatureHelper_ = ngeoFeatureHelper;
    this.ngeoWMSTime_ = ngeoWMSTime;
  }

  var _proto = RuleHelper.prototype;

  _proto.createRulesFromAttributes = function createRulesFromAttributes(attributes, opt_isCustom) {
    var rules = [];

    for (var _iterator = attributes, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var attribute = _ref;
      rules.push(this.createRuleFromAttribute(attribute, opt_isCustom));
    }

    return rules;
  };

  _proto.createRuleFromAttribute = function createRuleFromAttribute(attribute, opt_isCustom) {
    var rule;
    var isCustom = opt_isCustom === true;
    var name = this.gettextCatalog_.getString(attribute.name);

    switch (attribute.type) {
      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].DATE:
      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].DATETIME:
        if (isCustom) {
          rule = new ngeo_rule_Date_js__WEBPACK_IMPORTED_MODULE_5__["default"]({
            name: name,
            operator: ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleTemporalOperatorType"].EQUALS,
            operators: [ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleTemporalOperatorType"].EQUALS, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleTemporalOperatorType"].BEGINS, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleTemporalOperatorType"].ENDS],
            propertyName: attribute.name,
            type: attribute.type
          });
        } else {
          rule = new ngeo_rule_Date_js__WEBPACK_IMPORTED_MODULE_5__["default"]({
            name: name,
            operator: ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleTemporalOperatorType"].DURING,
            propertyName: attribute.name,
            type: attribute.type
          });
        }

        break;

      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].GEOMETRY:
        rule = new ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
          name: name,
          operator: ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleSpatialOperatorType"].INTERSECTS,
          operators: [ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleSpatialOperatorType"].CONTAINS, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleSpatialOperatorType"].INTERSECTS, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleSpatialOperatorType"].WITHIN],
          propertyName: attribute.name,
          type: attribute.type
        });
        break;

      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].NUMBER:
        if (isCustom) {
          rule = new ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
            name: name,
            operator: ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].EQUAL_TO,
            operators: [ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].EQUAL_TO, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].GREATER_THAN, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].GREATER_THAN_OR_EQUAL_TO, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].LESSER_THAN, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].LESSER_THAN_OR_EQUAL_TO, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].NOT_EQUAL_TO],
            propertyName: attribute.name,
            type: ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].NUMBER
          });
        } else {
          rule = new ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
            name: name,
            operator: ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].BETWEEN,
            propertyName: attribute.name,
            type: ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].NUMBER
          });
        }

        break;

      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].SELECT:
        rule = new ngeo_rule_Select_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
          choices: attribute.choices,
          name: name,
          propertyName: attribute.name
        });
        break;

      default:
        if (isCustom) {
          rule = new ngeo_rule_Text_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
            text: '',
            name: name,
            operator: ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].LIKE,
            operators: [ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].LIKE, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].EQUAL_TO, ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].NOT_EQUAL_TO],
            propertyName: attribute.name
          });
        } else {
          rule = new ngeo_rule_Text_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
            text: '',
            name: name,
            operator: ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"].LIKE,
            propertyName: attribute.name
          });
        }

        break;
    }

    return rule;
  };

  _proto.createRules = function createRules(optionsList) {
    var rules = [];

    for (var _iterator2 = optionsList, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
      var _ref2;

      if (_isArray2) {
        if (_i2 >= _iterator2.length) break;
        _ref2 = _iterator2[_i2++];
      } else {
        _i2 = _iterator2.next();
        if (_i2.done) break;
        _ref2 = _i2.value;
      }

      var options = _ref2;
      rules.push(this.createRule(options));
    }

    return rules;
  };

  _proto.createRule = function createRule(options) {
    var rule;

    switch (options.type) {
      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].DATE:
      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].DATETIME:
        rule = new ngeo_rule_Date_js__WEBPACK_IMPORTED_MODULE_5__["default"](options);
        break;

      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].GEOMETRY:
        rule = new ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"](options);
        break;

      case ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_2__["default"].SELECT:
        var selectOptions = options;
        console.assert(selectOptions.choices);
        rule = new ngeo_rule_Select_js__WEBPACK_IMPORTED_MODULE_8__["default"](selectOptions);
        break;

      default:
        rule = new ngeo_rule_Text_js__WEBPACK_IMPORTED_MODULE_9__["default"](options);
        break;
    }

    return rule;
  };

  _proto.cloneRule = function cloneRule(rule) {
    var options = {
      isCustom: rule.isCustom,
      name: rule.name,
      propertyName: rule.propertyName,
      type: rule.type
    };
    var expression = rule.getExpression();

    if (expression !== null) {
      options.expression = expression;
    }

    if (rule.lowerBoundary !== null) {
      options.lowerBoundary = rule.lowerBoundary;
    }

    if (rule.operator) {
      options.operator = rule.operator;
    }

    if (rule.operators) {
      options.operators = rule.operators.slice(0);
    }

    if (rule.upperBoundary !== null) {
      options.upperBoundary = rule.upperBoundary;
    }

    var clone;

    if (rule instanceof ngeo_rule_Date_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
      clone = new ngeo_rule_Date_js__WEBPACK_IMPORTED_MODULE_5__["default"](options);
    } else if (rule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
      clone = new ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"](options);
      clone.feature.setProperties(this.ngeoFeatureHelper_.getNonSpatialProperties(rule.feature));
    } else if (rule instanceof ngeo_rule_Select_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
      var opt = options;
      opt.choices = rule.choices.slice(0);
      clone = new ngeo_rule_Select_js__WEBPACK_IMPORTED_MODULE_8__["default"](opt);
    } else if (rule instanceof ngeo_rule_Text_js__WEBPACK_IMPORTED_MODULE_9__["default"]) {
      var _opt = options;
      clone = new ngeo_rule_Text_js__WEBPACK_IMPORTED_MODULE_9__["default"](_opt);
    } else {
      clone = new ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["default"](options);
    }

    return clone;
  };

  _proto.extendRule = function extendRule(sourceRule, destRule) {
    if (destRule.getExpression() !== sourceRule.getExpression()) {
      destRule.setExpression(sourceRule.getExpression());
    }

    if (destRule.lowerBoundary !== sourceRule.lowerBoundary) {
      destRule.lowerBoundary = sourceRule.lowerBoundary;
    }

    if (destRule.operator !== sourceRule.operator) {
      destRule.operator = sourceRule.operator;
    }

    if (destRule.upperBoundary !== sourceRule.upperBoundary) {
      destRule.upperBoundary = sourceRule.upperBoundary;
    }

    if (sourceRule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"] && destRule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
      this.ngeoFeatureHelper_.clearNonSpatialProperties(destRule.feature);
      destRule.feature.setProperties(this.ngeoFeatureHelper_.getNonSpatialProperties(sourceRule.feature));
    }
  };

  _proto.serializeRules = function serializeRules(rules) {
    var _this = this;

    return rules.map(function (rule) {
      var serializedRule = _this.serializeRule(rule);

      return serializedRule;
    });
  };

  _proto.serializeRule = function serializeRule(rule) {
    var obj = {
      name: rule.name,
      propertyName: rule.propertyName,
      type: rule.type
    };

    if (rule.expression !== null) {
      obj.expression = rule.expression;
    }

    if (rule.lowerBoundary !== null) {
      obj.lowerBoundary = rule.lowerBoundary;
    }

    if (rule.operator !== null) {
      obj.operator = rule.operator;
    }

    if (rule.operators !== null) {
      obj.operators = rule.operators.slice(0);
    }

    if (rule.upperBoundary !== null) {
      obj.upperBoundary = rule.upperBoundary;
    }

    if (rule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
      var opt = obj;
      opt.featureProperties = this.ngeoFeatureHelper_.getNonSpatialProperties(rule.feature);
    }

    if (rule instanceof ngeo_rule_Select_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
      var _opt2 = obj;
      _opt2.choices = rule.choices;
    }

    return obj;
  };

  _proto.createFilter = function createFilter(options) {
    var dataSource = options.dataSource;
    var mainFilter = null;

    if (options.filter) {
      mainFilter = options.filter;
    } else {
      var rules = options.filterRules || dataSource.filterRules;
      var conditions = [];

      if (rules && rules.length) {
        for (var _iterator3 = rules, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
          var _ref3;

          if (_isArray3) {
            if (_i3 >= _iterator3.length) break;
            _ref3 = _iterator3[_i3++];
          } else {
            _i3 = _iterator3.next();
            if (_i3.done) break;
            _ref3 = _i3.value;
          }

          var rule = _ref3;
          var filter = this.createFilterFromRule_(rule, dataSource, options.srsName);

          if (filter) {
            conditions.push(filter);
          }
        }
      }

      var condition = dataSource.filterCondition;

      if (conditions.length === 1) {
        mainFilter = conditions[0];
      } else if (conditions.length >= 2) {
        if (condition === ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_1__["default"].AND) {
          mainFilter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["and"].apply(null, conditions);
        } else if (condition === ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_1__["default"].OR || condition === ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_1__["default"].NOT) {
          mainFilter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["or"].apply(null, conditions);
        }
      }

      if (mainFilter && condition === ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_1__["default"].NOT) {
        mainFilter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["not"](mainFilter);
      }
    }

    if (options.incTime) {
      var timeFilter = this.createTimeFilterFromDataSource_(dataSource);
      mainFilter = this.joinFilters(mainFilter, timeFilter);
    }

    if (options.incDimensions) {
      var dimensionsFilter = this.createDimensionsFilterFromDataSource_(dataSource);
      mainFilter = this.joinFilters(mainFilter, dimensionsFilter);
    }

    return mainFilter;
  };

  _proto.createFilterString = function createFilterString(options) {
    var filterString = null;
    var filter = this.createFilter(options);

    if (filter) {
      var filterNode = Object(ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_10__["writeFilter"])(filter);
      var xmlSerializer = new XMLSerializer();
      filterString = xmlSerializer.serializeToString(filterNode);
    }

    return filterString;
  };

  _proto.joinFilters = function joinFilters(filterA, filterB) {
    var filter = null;

    if (filterA && filterB) {
      filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["and"].apply(null, [filterA, filterB]);
    } else if (filterA) {
      filter = filterA;
    } else if (filterB) {
      filter = filterB;
    }

    return filter;
  };

  _proto.createFilterFromRule_ = function createFilterFromRule_(rule, dataSource, opt_srsName) {
    var filter = null;
    var value = rule.value;

    if (!value) {
      return null;
    }

    var expression = value.expression;
    var lowerBoundary = value.lowerBoundary;
    var operator = value.operator;
    var propertyName = value.propertyName;
    var upperBoundary = value.upperBoundary;
    var rot = ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleOperatorType"];
    var rsot = ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleSpatialOperatorType"];
    var rtot = ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_7__["RuleTemporalOperatorType"];
    var spatialTypes = [rsot.CONTAINS, rsot.INTERSECTS, rsot.WITHIN];
    var numericTypes = [rot.GREATER_THAN, rot.GREATER_THAN_OR_EQUAL_TO, rot.LESSER_THAN, rot.LESSER_THAN_OR_EQUAL_TO];

    if (rule instanceof ngeo_rule_Date_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
      var beginValue;
      var endValue;

      if (operator === rtot.DURING) {
        beginValue = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(lowerBoundary).format('YYYY-MM-DD');
        endValue = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(upperBoundary).format('YYYY-MM-DD');
      } else if (operator === rtot.EQUALS) {
        beginValue = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(expression).format('YYYY-MM-DD');
        endValue = beginValue;
      } else if (operator === rtot.BEGINS) {
        beginValue = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(expression).format('YYYY-MM-DD');
        endValue = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(expression).add(30, 'years').format('YYYY-MM-DD');
      } else if (operator === rtot.ENDS) {
        beginValue = '1970-01-01';
        endValue = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(expression).format('YYYY-MM-DD');
      }

      if (beginValue && endValue) {
        filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["during"](propertyName, beginValue, endValue);
      }
    } else if (rule instanceof ngeo_rule_Select_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
      var selectedChoices = rule.selectedChoices;

      if (selectedChoices.length === 1) {
        filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["equalTo"](propertyName, selectedChoices[0]);
      } else if (selectedChoices.length >= 2) {
        var conditions = [];

        for (var _iterator4 = selectedChoices, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {
          var _ref4;

          if (_isArray4) {
            if (_i4 >= _iterator4.length) break;
            _ref4 = _iterator4[_i4++];
          } else {
            _i4 = _iterator4.next();
            if (_i4.done) break;
            _ref4 = _i4.value;
          }

          var selectedChoice = _ref4;
          conditions.push(ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["equalTo"](propertyName, selectedChoice));
        }

        filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["or"].apply(null, conditions);
      }
    } else if (spatialTypes.includes(operator)) {
      var featureNames = dataSource.getFiltrableWFSLayerName();
      var geometryName = dataSource.geometryName(featureNames ? featureNames[0] : null);

      if (rule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
        var geometry = rule.geometry;

        if (!geometry) {
          throw new Error('Missing geometry');
        }

        if (geometryName === null) {
          throw new Error('Missing geometryName');
        }

        if (operator === rsot.CONTAINS) {
          filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["contains"](geometryName, geometry, opt_srsName);
        } else if (operator === rsot.INTERSECTS) {
          filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["intersects"](geometryName, geometry, opt_srsName);
        } else if (operator === rsot.WITHIN) {
          filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["within"](geometryName, geometry, opt_srsName);
        }
      }
    } else if (numericTypes.includes(operator)) {
      if (typeof expression !== 'number') {
        throw new Error('Wrong expression type');
      }

      if (operator === rot.GREATER_THAN) {
        filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["greaterThan"](propertyName, expression);
      } else if (operator === rot.GREATER_THAN_OR_EQUAL_TO) {
        filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["greaterThanOrEqualTo"](propertyName, expression);
      } else if (operator === rot.LESSER_THAN) {
        filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["lessThan"](propertyName, expression);
      } else if (operator === rot.LESSER_THAN_OR_EQUAL_TO) {
        filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["lessThanOrEqualTo"](propertyName, expression);
      }
    } else if (operator === rot.BETWEEN) {
      filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["between"](propertyName, lowerBoundary, upperBoundary);
    } else if (operator === rot.EQUAL_TO) {
      filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["equalTo"](propertyName, expression);
    } else if (operator === rot.LIKE) {
      var stringExpression = String(expression).replace(/!/g, '!!').replace(/\./g, '!.').replace(/\*/g, '!*');
      filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["like"](propertyName, "*" + stringExpression + "*", '*', '.', '!', false);
    } else if (operator === rot.NOT_EQUAL_TO) {
      filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["notEqualTo"](propertyName, expression);
    }

    return filter;
  };

  _proto.createDimensionsFilterFromDataSource_ = function createDimensionsFilterFromDataSource_(dataSource) {
    var config = dataSource.dimensionsFiltersConfig || {};
    var dimensions = dataSource.dimensions;

    if (!dimensions) {
      throw new Error('Missing dimensions');
    }

    var conditions = [];

    for (var key in config) {
      var value = config[key].value;

      if (value === null) {
        var dimensionValue = dimensions[key];

        if (dimensionValue !== undefined && dimensionValue !== null) {
          value = dimensionValue;
        }
      }

      if (value !== null) {
        conditions.push(ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["equalTo"](config[key].field, value, true));
      }
    }

    if (conditions.length === 1) {
      return conditions[0];
    } else if (conditions.length >= 2) {
      return ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["and"].apply(null, conditions);
    }

    return null;
  };

  _proto.createTimeFilterFromDataSource_ = function createTimeFilterFromDataSource_(dataSource) {
    var filter = null;
    var range = dataSource.timeRangeValue;
    var timeProperty = dataSource.timeProperty;
    var name = dataSource.timeAttributeName;

    if (range && timeProperty && name) {
      if (range.end !== undefined) {
        var values = this.ngeoWMSTime_.formatWMSTimeParam(timeProperty, range).split('/');
        filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["during"](name, values[0], values[1]);
      } else {
        var resolution = timeProperty.resolution || 'seconds';
        var value = this.ngeoWMSTime_.formatWMSTimeParam(timeProperty, range);
        var momentEnd;

        switch (resolution) {
          case 'year':
            momentEnd = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(value).add(1, 'years').subtract(1, 'seconds');
            break;

          case 'month':
            momentEnd = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(value).add(1, 'months').subtract(1, 'seconds');
            break;

          case 'day':
            momentEnd = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(value).add(1, 'days').subtract(1, 'seconds');
            break;

          default:
        }

        if (momentEnd) {
          var startValue = Object(moment__WEBPACK_IMPORTED_MODULE_12__["default"])(value).utc().format('YYYY-MM-DD HH:mm:ss');
          var endValue = momentEnd.utc().format('YYYY-MM-DD HH:mm:ss');
          filter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_11__["during"](name, startValue, endValue);
        }
      }
    }

    return filter;
  };

  return RuleHelper;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoRuleHelper', [ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_4__["default"].name]);
module.service('ngeoRuleHelper', RuleHelper);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/filter/component.html":
/*!***********************************!*\
  !*** ./src/filter/component.html ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="dropdown">\n  <button\n      class="btn btn-link dropdown-toggle ngeo-filter-condition-button"\n      ng-class="{disabled: $ctrl.aRuleIsActive}"\n      type="button"\n      data-toggle="dropdown"\n      ng-disabled="$ctrl.aRuleIsActive">\n    <span class="fa fa-cog"></span>\n  </button>\n  <ul class="dropdown-menu">\n    <li ng-repeat="condition in ::$ctrl.conditions">\n      <a\n          href\n          ng-click="$ctrl.setCondition(condition)">\n          <span\n              ng-class="{\'ngeo-filter-condition-criteria-active\': condition.value == $ctrl.datasource.filterCondition}"\n              class="fa fa-check ngeo-filter-condition-criteria">\n          </span>\n          <span>{{::condition.text | translate}}</span>\n      </a>\n    </li>\n  </ul>\n</div>\n\n<ngeo-rule\n    ng-repeat="rule in $ctrl.directedRules"\n    feature-overlay="::$ctrl.featureOverlay"\n    class="ngeo-filter-rule-directed"\n    map="$ctrl.map"\n    rule="rule"\n    tool-group="$ctrl.toolGroup">\n</ngeo-rule>\n\n<hr class="ngeo-filter-separator-rules" />\n\n<div ng-repeat="rule in $ctrl.customRules">\n  <a\n      class="btn btn-sm btn-link ngeo-filter-rule-custom-rm-btn"\n      ng-click="!$ctrl.aRuleIsActive && $ctrl.removeCustomRule(rule)"\n      ng-disabled="$ctrl.aRuleIsActive"\n      href>\n    <span class="fa fa-times"></span>\n  </a>\n  <ngeo-rule\n      feature-overlay="::$ctrl.featureOverlay"\n      class="ngeo-filter-rule-custom"\n      map="$ctrl.map"\n      rule="rule"\n      tool-group="$ctrl.toolGroup">\n  </ngeo-rule>\n</div>\n\n<div class="dropdown">\n  <button\n      class="btn btn-link dropdown-toggle"\n      ng-class="{disabled: $ctrl.aRuleIsActive}"\n      type="button"\n      data-toggle="dropdown"\n      ng-disabled="$ctrl.aRuleIsActive">\n    <span translate>+ Add a new criteria</span>\n  </button>\n  <ul class="dropdown-menu">\n    <li ng-repeat="attribute in ::$ctrl.geometryAttributes">\n      <a\n          href\n          ng-click="$ctrl.createAndAddCustomRule(attribute)">\n          <span translate>Spatial filter</span>\n      </a>\n    </li>\n    <li role="presentation" class="divider"></li>\n    <li ng-repeat="attribute in ::$ctrl.otherAttributes">\n      <a\n          href\n          ng-click="$ctrl.createAndAddCustomRule(attribute)">\n          <span>{{::attribute.name | translate}}</span>\n      </a>\n    </li>\n  </ul>\n</div>\n\n<hr class="ngeo-filter-separator-criteria" />\n\n<button\n    class="btn btn-link"\n    type="button"\n    ng-click="$ctrl.apply()"\n    ng-disabled="$ctrl.datasource.visible === false">\n  <span class="fa fa-check"></span>\n  <span translate>Apply filter</span>\n</button>\n\n<button\n    class="btn btn-link"\n    type="button"\n    ng-click="$ctrl.getData()"\n    ng-disabled="$ctrl.datasource.visible === false">\n  <span class="fa fa-chevron-right"></span>\n  <span translate>Get data</span>\n</button>\n';

}
return __p
}

/***/ }),

/***/ "./src/filter/component.js":
/*!*********************************!*\
  !*** ./src/filter/component.js ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/query/MapQuerent.js */ "./src/query/MapQuerent.js");
/* harmony import */ var ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/filter/Condition.js */ "./src/filter/Condition.js");
/* harmony import */ var ngeo_filter_ruleComponent_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/filter/ruleComponent.js */ "./src/filter/ruleComponent.js");
/* harmony import */ var ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/filter/RuleHelper.js */ "./src/filter/RuleHelper.js");
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/rule/Geometry.js */ "./src/rule/Geometry.js");
/* harmony import */ var ngeo_map_FeatureOverlay_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/map/FeatureOverlay.js */ "./src/map/FeatureOverlay.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/sass/font.scss */ "./src/sass/font.scss");
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_10__);











var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoFilter', [ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_filter_ruleComponent_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_map_FeatureOverlay_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/filter', __webpack_require__(/*! ./component.html */ "./src/filter/component.html"));
}]);
module.value('ngeoFilterTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.ngeoFilterTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'ngeo/filter';
});
ngeoFilterTemplateUrl.$inject = ["$attrs", "ngeoFilterTemplateUrl"];

function ngeoFilterTemplateUrl($attrs, ngeoFilterTemplateUrl) {
  return ngeoFilterTemplateUrl($attrs);
}

module.component('ngeoFilter', {
  bindings: {
    'aRuleIsActive': '=',
    'customRules': '<',
    'datasource': '<',
    'directedRules': '<',
    'featureOverlay': '<',
    'filterIsApplied': '=',
    'map': '<',
    'toolGroup': '<'
  },
  controller: 'ngeoFilterController',
  templateUrl: ngeoFilterTemplateUrl
});

var FilterController = function () {
  FilterController.$inject = ["gettextCatalog", "$scope", "$timeout", "ngeoMapQuerent", "ngeoRuleHelper"];

  function FilterController(gettextCatalog, $scope, $timeout, ngeoMapQuerent, ngeoRuleHelper) {
    this.aRuleIsActive = false;
    this.customRules = [];
    this.datasource = null;
    this.directedRules = [];
    this.featureOverlay = null;
    this.map = null;
    this.toolGroup = '';
    this.filterIsApplied = false;
    this.gettextCatalog_ = gettextCatalog;
    this.scope_ = $scope;
    this.timeout_ = $timeout;
    this.ngeoMapQuerent_ = ngeoMapQuerent;
    this.ngeoRuleHelper_ = ngeoRuleHelper;
    this.conditions = [{
      text: gettextCatalog.getString('Match all criteria'),
      value: ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_2__["default"].AND
    }, {
      text: gettextCatalog.getString('Match at least one criterion'),
      value: ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_2__["default"].OR
    }, {
      text: gettextCatalog.getString('Does not match any criterion'),
      value: ngeo_filter_Condition_js__WEBPACK_IMPORTED_MODULE_2__["default"].NOT
    }];
    this.geometryAttributes = [];
    this.otherAttributes = [];
    this.ruleUnlisteners_ = {};
  }

  var _proto = FilterController.prototype;

  _proto.$onInit = function $onInit() {
    var _this = this;

    if (!this.datasource) {
      throw new Error('Missing datasource');
    }

    this.scope_.$watch(function () {
      return _this.aRuleIsActive;
    }, this.handleARuleIsActiveChange_.bind(this));
    this.scope_.$watch(function () {
      return _this.datasource.filterRules;
    }, function () {
      _this.filterIsApplied = _this.hasARuleActive();
    });
    var attributes = this.datasource.attributes;

    for (var _iterator = attributes, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var attribute = _ref;

      if (attribute.type === ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_5__["default"].GEOMETRY) {
        this.geometryAttributes.push(attribute);
      } else {
        this.otherAttributes.push(attribute);
      }
    }

    for (var _iterator2 = this.customRules, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
      var _ref2;

      if (_isArray2) {
        if (_i2 >= _iterator2.length) break;
        _ref2 = _iterator2[_i2++];
      } else {
        _i2 = _iterator2.next();
        if (_i2.done) break;
        _ref2 = _i2.value;
      }

      var rule = _ref2;
      this.registerRule_(rule);
    }

    for (var _iterator3 = this.directedRules, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
      var _ref3;

      if (_isArray3) {
        if (_i3 >= _iterator3.length) break;
        _ref3 = _iterator3[_i3++];
      } else {
        _i3 = _iterator3.next();
        if (_i3.done) break;
        _ref3 = _i3.value;
      }

      var _rule = _ref3;
      this.registerRule_(_rule);
    }

    this.apply();
  };

  _proto.$onDestroy = function $onDestroy() {
    if (!this.datasource) {
      throw new Error('Missing datasource');
    }

    if (!this.featureOverlay) {
      throw new Error('Missing featureOverlay');
    }

    if (this.datasource.filterRules !== null) {
      this.datasource.filterRules = null;
    }

    this.featureOverlay.clear();
  };

  _proto.hasARuleActive = function hasARuleActive() {
    var customRuleActive = false;
    var directedRuleActive = false;

    for (var _iterator4 = this.customRules, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {
      var _ref4;

      if (_isArray4) {
        if (_i4 >= _iterator4.length) break;
        _ref4 = _iterator4[_i4++];
      } else {
        _i4 = _iterator4.next();
        if (_i4.done) break;
        _ref4 = _i4.value;
      }

      var rule = _ref4;

      if (rule.expression) {
        customRuleActive = true;
      }
    }

    for (var _iterator5 = this.directedRules, _isArray5 = Array.isArray(_iterator5), _i5 = 0, _iterator5 = _isArray5 ? _iterator5 : _iterator5[Symbol.iterator]();;) {
      var _ref5;

      if (_isArray5) {
        if (_i5 >= _iterator5.length) break;
        _ref5 = _iterator5[_i5++];
      } else {
        _i5 = _iterator5.next();
        if (_i5.done) break;
        _ref5 = _i5.value;
      }

      var _rule2 = _ref5;

      if (_rule2.expression) {
        directedRuleActive = true;
      }
    }

    return customRuleActive || directedRuleActive;
  };

  _proto.apply = function apply() {
    var _this2 = this;

    if (!this.datasource) {
      throw new Error('Missing datasource');
    }

    this.datasource.filterRules = null;
    this.timeout_(function () {
      var filterRules = _this2.getRulesWithValue_();

      if (filterRules.length) {
        if (!_this2.datasource) {
          throw new Error('Missing datasource');
        }

        _this2.datasource.filterRules = filterRules;

        _this2.ngeoMapQuerent_.clear();
      }
    });
  };

  _proto.getData = function getData() {
    if (!this.datasource) {
      throw new Error('Missing datasource');
    }

    if (!this.map) {
      throw new Error('Missing map');
    }

    var filterRules = this.getRulesWithValue_();

    if (!filterRules.length) {
      return;
    }

    var dataSource = this.datasource;
    var limit = 1000;
    var map = this.map;
    var projCode = map.getView().getProjection().getCode();
    var filter = this.ngeoRuleHelper_.createFilter({
      dataSource: dataSource,
      filterRules: filterRules,
      srsName: projCode
    });

    if (!filter) {
      throw new Error('Missing filter');
    }

    this.ngeoMapQuerent_.issue({
      dataSources: [dataSource],
      filter: filter,
      limit: limit,
      map: map
    });
  };

  _proto.getRulesWithValue_ = function getRulesWithValue_() {
    var filterRules = [];

    for (var _iterator6 = this.customRules, _isArray6 = Array.isArray(_iterator6), _i6 = 0, _iterator6 = _isArray6 ? _iterator6 : _iterator6[Symbol.iterator]();;) {
      var _ref6;

      if (_isArray6) {
        if (_i6 >= _iterator6.length) break;
        _ref6 = _iterator6[_i6++];
      } else {
        _i6 = _iterator6.next();
        if (_i6.done) break;
        _ref6 = _i6.value;
      }

      var rule = _ref6;

      if (rule.value) {
        filterRules.push(rule);
      }
    }

    for (var _iterator7 = this.directedRules, _isArray7 = Array.isArray(_iterator7), _i7 = 0, _iterator7 = _isArray7 ? _iterator7 : _iterator7[Symbol.iterator]();;) {
      var _ref7;

      if (_isArray7) {
        if (_i7 >= _iterator7.length) break;
        _ref7 = _iterator7[_i7++];
      } else {
        _i7 = _iterator7.next();
        if (_i7.done) break;
        _ref7 = _i7.value;
      }

      var _rule3 = _ref7;

      if (_rule3.value) {
        filterRules.push(_rule3);
      }
    }

    return filterRules;
  };

  _proto.createAndAddCustomRule = function createAndAddCustomRule(attribute) {
    var rule = this.ngeoRuleHelper_.createRuleFromAttribute(attribute, true);
    this.registerRule_(rule);
    this.customRules.push(rule);
    this.timeout_(function () {
      rule.active = true;
    }, 1);
  };

  _proto.setCondition = function setCondition(condition) {
    if (!this.datasource) {
      throw new Error('Missing datasource');
    }

    if (this.datasource.filterCondition !== condition.value) {
      this.datasource.filterCondition = condition.value;
    }
  };

  _proto.removeCustomRule = function removeCustomRule(rule) {
    var _this3 = this;

    rule.active = false;
    this.timeout_(function () {
      Object(ol_array_js__WEBPACK_IMPORTED_MODULE_9__["remove"])(_this3.customRules, rule);

      _this3.unregisterRule_(rule);

      rule.destroy();
    });
  };

  _proto.registerRule_ = function registerRule_(rule) {
    if (!this.featureOverlay) {
      throw new Error('Missing featureOverlay');
    }

    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_8__["getUid"])(rule);
    this.ruleUnlisteners_[uid] = this.scope_.$watch(function () {
      return rule.active;
    }, this.handleRuleActiveChange_.bind(this));

    if (rule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
      this.featureOverlay.addFeature(rule.feature);
    }
  };

  _proto.unregisterRule_ = function unregisterRule_(rule) {
    if (!this.featureOverlay) {
      throw new Error('Missing featureOverlay');
    }

    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_8__["getUid"])(rule);
    var unlistener = this.ruleUnlisteners_[uid];
    console.assert(unlistener);
    unlistener();
    delete this.ruleUnlisteners_[uid];

    if (rule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
      this.featureOverlay.removeFeature(rule.feature);
    }
  };

  _proto.handleRuleActiveChange_ = function handleRuleActiveChange_() {
    var aRuleIsActive = false;

    for (var _iterator8 = this.customRules, _isArray8 = Array.isArray(_iterator8), _i8 = 0, _iterator8 = _isArray8 ? _iterator8 : _iterator8[Symbol.iterator]();;) {
      var _ref8;

      if (_isArray8) {
        if (_i8 >= _iterator8.length) break;
        _ref8 = _iterator8[_i8++];
      } else {
        _i8 = _iterator8.next();
        if (_i8.done) break;
        _ref8 = _i8.value;
      }

      var rule = _ref8;

      if (rule.active) {
        aRuleIsActive = true;
        break;
      }
    }

    for (var _iterator9 = this.directedRules, _isArray9 = Array.isArray(_iterator9), _i9 = 0, _iterator9 = _isArray9 ? _iterator9 : _iterator9[Symbol.iterator]();;) {
      var _ref9;

      if (_isArray9) {
        if (_i9 >= _iterator9.length) break;
        _ref9 = _iterator9[_i9++];
      } else {
        _i9 = _iterator9.next();
        if (_i9.done) break;
        _ref9 = _i9.value;
      }

      var _rule4 = _ref9;

      if (_rule4.active) {
        aRuleIsActive = true;
        break;
      }
    }

    this.aRuleIsActive = aRuleIsActive;
  };

  _proto.handleARuleIsActiveChange_ = function handleARuleIsActiveChange_() {
    if (this.aRuleIsActive) {
      return;
    }

    for (var _iterator10 = this.customRules, _isArray10 = Array.isArray(_iterator10), _i10 = 0, _iterator10 = _isArray10 ? _iterator10 : _iterator10[Symbol.iterator]();;) {
      var _ref10;

      if (_isArray10) {
        if (_i10 >= _iterator10.length) break;
        _ref10 = _iterator10[_i10++];
      } else {
        _i10 = _iterator10.next();
        if (_i10.done) break;
        _ref10 = _i10.value;
      }

      var rule = _ref10;

      if (rule.active) {
        rule.active = false;
        break;
      }
    }

    for (var _iterator11 = this.directedRules, _isArray11 = Array.isArray(_iterator11), _i11 = 0, _iterator11 = _isArray11 ? _iterator11 : _iterator11[Symbol.iterator]();;) {
      var _ref11;

      if (_isArray11) {
        if (_i11 >= _iterator11.length) break;
        _ref11 = _iterator11[_i11++];
      } else {
        _i11 = _iterator11.next();
        if (_i11.done) break;
        _ref11 = _i11.value;
      }

      var _rule5 = _ref11;

      if (_rule5.active) {
        _rule5.active = false;
        break;
      }
    }
  };

  return FilterController;
}();

module.controller('ngeoFilterController', FilterController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/filter/ruleComponent.js":
/*!*************************************!*\
  !*** ./src/filter/ruleComponent.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_Menu_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/Menu.js */ "./src/Menu.js");
/* harmony import */ var ngeo_draw_component_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/draw/component.js */ "./src/draw/component.js");
/* harmony import */ var ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/filter/RuleHelper.js */ "./src/filter/RuleHelper.js");
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_interaction_Modify_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/interaction/Modify.js */ "./src/interaction/Modify.js");
/* harmony import */ var ngeo_interaction_Rotate_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/interaction/Rotate.js */ "./src/interaction/Rotate.js");
/* harmony import */ var ngeo_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/interaction/Translate.js */ "./src/interaction/Translate.js");
/* harmony import */ var ngeo_map_FeatureOverlay_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/map/FeatureOverlay.js */ "./src/map/FeatureOverlay.js");
/* harmony import */ var ngeo_misc_datepickerComponent_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/misc/datepickerComponent.js */ "./src/misc/datepickerComponent.js");
/* harmony import */ var ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/misc/decorate.js */ "./src/misc/decorate.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ngeo/misc/ToolActivate.js */ "./src/misc/ToolActivate.js");
/* harmony import */ var ngeo_misc_ToolActivateMgr_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ngeo/misc/ToolActivateMgr.js */ "./src/misc/ToolActivateMgr.js");
/* harmony import */ var ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ngeo/rule/Rule.js */ "./src/rule/Rule.js");
/* harmony import */ var ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ngeo/rule/Geometry.js */ "./src/rule/Geometry.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_style_Text_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ol/style/Text.js */ "./node_modules/ol/style/Text.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ngeo/sass/font.scss */ "./src/sass/font.scss");
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_24___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_24__);


























var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoRule', [ngeo_draw_component_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_map_FeatureOverlay_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, ngeo_misc_datepickerComponent_js__WEBPACK_IMPORTED_MODULE_10__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_12__["default"].name, ngeo_misc_ToolActivateMgr_js__WEBPACK_IMPORTED_MODULE_14__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/filter/rulecomponent', __webpack_require__(/*! ./rulecomponent.html */ "./src/filter/rulecomponent.html"));
}]);
module.value('ngeoRuleTemplateUrl', function ($attrs) {
  var templateUrl = $attrs['ngeoRuleTemplateUrl'];
  return templateUrl !== undefined ? templateUrl : 'ngeo/filter/rulecomponent';
});
ngeoRuleTemplateUrl.$inject = ["$attrs", "ngeoRuleTemplateUrl"];

function ngeoRuleTemplateUrl($attrs, ngeoRuleTemplateUrl) {
  return ngeoRuleTemplateUrl($attrs);
}

var RuleController = function () {
  RuleController.$inject = ["gettextCatalog", "$scope", "$timeout", "ngeoFeatureHelper", "ngeoRuleHelper", "ngeoToolActivateMgr"];

  function RuleController(gettextCatalog, $scope, $timeout, ngeoFeatureHelper, ngeoRuleHelper, ngeoToolActivateMgr) {
    var _this$operators, _this$operatorsShortF;

    this.featureOverlay = null;
    this.map = null;
    this.rule = null;
    this.toolGroup = '';
    this.gettextCatalog_ = gettextCatalog;
    this.scope_ = $scope;
    this.timeout_ = $timeout;
    this.ngeoFeatureHelper_ = ngeoFeatureHelper;
    this.ngeoRuleHelper_ = ngeoRuleHelper;
    this.ngeoToolActivateMgr_ = ngeoToolActivateMgr;
    this.clone = null;
    var operatorType = ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_15__["RuleOperatorType"];
    var spatialOperatorType = ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_15__["RuleSpatialOperatorType"];
    var temporalOperatorType = ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_15__["RuleTemporalOperatorType"];
    this.operators = (_this$operators = {}, _this$operators[operatorType.EQUAL_TO] = gettextCatalog.getString('Is equal to'), _this$operators[operatorType.GREATER_THAN] = gettextCatalog.getString('Is greater than'), _this$operators[operatorType.GREATER_THAN_OR_EQUAL_TO] = gettextCatalog.getString('Is greater than or equal to'), _this$operators[operatorType.LESSER_THAN] = gettextCatalog.getString('Is lesser than'), _this$operators[operatorType.LESSER_THAN_OR_EQUAL_TO] = gettextCatalog.getString('Is lesser than or equal to'), _this$operators[operatorType.NOT_EQUAL_TO] = gettextCatalog.getString('Is not equal to'), _this$operators[operatorType.LIKE] = gettextCatalog.getString('Contains'), _this$operators[spatialOperatorType.CONTAINS] = gettextCatalog.getString('Contains'), _this$operators[spatialOperatorType.INTERSECTS] = gettextCatalog.getString('Intersects'), _this$operators[spatialOperatorType.WITHIN] = gettextCatalog.getString('Is inside of'), _this$operators[temporalOperatorType.BEGINS] = gettextCatalog.getString('Begins at'), _this$operators[temporalOperatorType.DURING] = gettextCatalog.getString('During'), _this$operators[temporalOperatorType.ENDS] = gettextCatalog.getString('Ends at'), _this$operators[temporalOperatorType.EQUALS] = gettextCatalog.getString('Is equal to'), _this$operators);
    this.operatorsShortFormat = (_this$operatorsShortF = {}, _this$operatorsShortF[operatorType.EQUAL_TO] = '=', _this$operatorsShortF[operatorType.GREATER_THAN] = '>', _this$operatorsShortF[operatorType.GREATER_THAN_OR_EQUAL_TO] = '>=', _this$operatorsShortF[operatorType.LESSER_THAN] = '<', _this$operatorsShortF[operatorType.LESSER_THAN_OR_EQUAL_TO] = '<=', _this$operatorsShortF[operatorType.NOT_EQUAL_TO] = '!=', _this$operatorsShortF[operatorType.LIKE] = '~', _this$operatorsShortF[temporalOperatorType.BEGINS] = '>=', _this$operatorsShortF[temporalOperatorType.ENDS] = '<=', _this$operatorsShortF[temporalOperatorType.EQUALS] = '=', _this$operatorsShortF);
    this.timeRangeMode = {
      widget: 'datepicker',
      maxValue: null,
      minValue: null,
      maxDefValue: this.createDate_(),
      minDefValue: this.createWeekAgoDate_(),
      mode: 'range',
      interval: [0, 1, 0, 0]
    };
    this.timeValueMode = {
      widget: 'datepicker',
      maxValue: null,
      minValue: null,
      maxDefValue: this.createDate_(),
      minDefValue: this.createDate_(),
      mode: 'value',
      interval: [0, 1, 0, 0]
    };
    this.toolActivate_ = null;
    this.unlisteners_ = [];
    this.drawActive = false;
    this.drawToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this, 'drawActive');
    this.drawnFeatures = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_18__["default"]();
    this.menu_ = null;
    this.selectedFeatures = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_18__["default"]();
    this.interactions_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_18__["default"]();
    this.modify_ = new ngeo_interaction_Modify_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
      features: this.selectedFeatures,
      style: ngeoFeatureHelper.getVertexStyle(false)
    });
    this.interactions_.push(this.modify_);
    this.rotate_ = new ngeo_interaction_Rotate_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
      features: this.selectedFeatures,
      style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
        text: new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_21__["default"]({
          text: "\uF01E",
          font: '900 18px "Font Awesome 5 Free"',
          fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
            color: '#7a7a7a'
          })
        })
      })
    });
    this.interactions_.push(this.rotate_);
    this.translate_ = new ngeo_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
      features: this.selectedFeatures,
      style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
        text: new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_21__["default"]({
          text: "\uF0B2",
          font: '900 18px "Font Awesome 5 Free"',
          fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
            color: '#7a7a7a'
          })
        })
      })
    });
    this.interactions_.push(this.translate_);
    this.listenerKeys_ = [];
    this.initializeInteractions_();
    this.modifyToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this.modify_, 'active');
    this.rotateToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this.rotate_, 'active');
    this.translateToolActivate = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this.translate_, 'active');
    this.geomType = null;
    this.listenerKeys_ = [];
  }

  var _proto = RuleController.prototype;

  _proto.$onInit = function $onInit() {
    var _this = this;

    if (!this.rule) {
      throw new Error('Missing rule');
    }

    this.clone = this.ngeoRuleHelper_.cloneRule(this.rule);
    this.toolActivate_ = new ngeo_misc_ToolActivate_js__WEBPACK_IMPORTED_MODULE_13__["default"](this.rule, 'active');
    this.ngeoToolActivateMgr_.registerTool(this.toolGroup, this.toolActivate_);
    this.scope_.$watch(function () {
      if (!_this.rule) {
        throw new Error('Missing rule');
      }

      return _this.rule.active;
    }, this.handleActiveChange_.bind(this));

    if (this.clone.type === ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_4__["default"].DATE || this.clone.type === ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_4__["default"].DATETIME) {
      this.unlisteners_.push(this.scope_.$watch(function () {
        if (!_this.clone) {
          throw new Error('Missing clone');
        }

        _this.clone.getExpression();
      }, function (newVal) {
        if (typeof newVal == 'string') {
          _this.timeValueMode.minDefValue = newVal || _this.createDate_();
        }
      }));
      this.unlisteners_.push(this.scope_.$watch(function () {
        if (!_this.clone) {
          throw new Error('Missing clone');
        }

        _this.clone.lowerBoundary;
      }, function (newVal) {
        if (typeof newVal == 'string') {
          _this.timeRangeMode.minDefValue = newVal || _this.createWeekAgoDate_();
        }
      }));
      this.unlisteners_.push(this.scope_.$watch(function () {
        if (!_this.clone) {
          throw new Error('Missing clone');
        }

        _this.clone.upperBoundary;
      }, function (newVal) {
        if (typeof newVal == 'string') {
          _this.timeRangeMode.maxDefValue = newVal || _this.createDate_();
        }
      }));
    } else if (this.clone.type === ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_4__["default"].GEOMETRY) {
      this.unlisteners_.push(this.scope_.$watch(function () {
        if (!_this.clone) {
          throw new Error('Missing clone');
        }

        _this.clone.operator;
      }, function (newVal) {
        _this.drawActive = false;

        if (newVal && newVal === ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_15__["RuleSpatialOperatorType"].CONTAINS) {
          var clone = _this.clone;

          if (clone instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_16__["default"]) {
            var geometry = clone.feature.getGeometry();

            if (geometry) {
              var geomType = _this.ngeoFeatureHelper_.getType(clone.feature);

              var supportedTypes = [ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].CIRCLE, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].POLYGON, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].RECTANGLE];

              if (!supportedTypes.includes(geomType)) {
                if (!_this.clone) {
                  throw new Error('Missing clone');
                }

                _this.clone.setExpression(null);
              }
            }
          }
        }
      }));
      this.unlisteners_.push(this.scope_.$watch(function () {
        if (!_this.clone) {
          throw new Error('Missing clone');
        }

        _this.clone.expression;
      }, function (newVal) {
        if (newVal) {
          var clone = _this.clone;

          if (clone instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_16__["default"]) {
            _this.geomType = _this.ngeoFeatureHelper_.getType(clone.feature);
          }
        } else {
          _this.geomType = null;
        }
      }));
      this.unlisteners_.push(this.scope_.$watch(function () {
        if (!_this.clone) {
          throw new Error('Missing clone');
        }

        if (!_this.rule) {
          throw new Error('Missing rule');
        }

        var hasExpression = _this.clone.getExpression() !== null;
        var isActive = _this.rule.active === true;

        var editToolIsActive = _this.modify_.getActive() || _this.rotate_.getActive() || _this.translate_.getActive();

        return hasExpression && isActive && editToolIsActive;
      }, function (newVal) {
        if (newVal) {
          var clone = _this.clone;

          if (clone instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_16__["default"]) {
            _this.selectedFeatures.push(clone.feature);
          }
        } else {
          _this.selectedFeatures.clear();
        }
      }));
    }
  };

  _proto.$onDestroy = function $onDestroy() {
    if (!this.clone) {
      throw new Error('Missing clone');
    }

    if (!this.rule) {
      throw new Error('Missing rule');
    }

    if (!this.toolActivate_) {
      throw new Error('Missing toolActivate');
    }

    if (this.rule.active) {
      this.rule.active = false;
      this.handleActiveChange_(false, true);
    }

    this.ngeoToolActivateMgr_.unregisterTool(this.toolGroup, this.toolActivate_);

    for (var i = 0, ii = this.unlisteners_.length; i < ii; i++) {
      this.unlisteners_[i]();
    }

    this.unlisteners_.length = 0;
    this.clone.destroy();
  };

  _proto.toggle = function toggle() {
    if (!this.rule) {
      throw new Error('Missing rule');
    }

    if (this.rule.active) {
      this.cancel();
    } else {
      this.rule.active = true;
    }
  };

  _proto.apply = function apply() {
    if (!this.clone) {
      throw new Error('Missing clone');
    }

    if (!this.rule) {
      throw new Error('Missing rule');
    }

    this.ngeoRuleHelper_.extendRule(this.clone, this.rule);
    this.rule.active = false;
  };

  _proto.cancel = function cancel() {
    if (!this.rule) {
      throw new Error('Missing rule');
    }

    if (!this.clone) {
      throw new Error('Missing clone');
    }

    this.ngeoRuleHelper_.extendRule(this.rule, this.clone);
    this.rule.active = false;
  };

  _proto.reset = function reset() {
    if (!this.rule) {
      throw new Error('Missing rule');
    }

    if (!this.clone) {
      throw new Error('Missing clone');
    }

    this.clone.reset();
    this.rule.reset();
  };

  _proto.toggleChoiceSelection = function toggleChoiceSelection(choice) {
    if (!this.clone) {
      throw new Error('Missing clone');
    }

    var rule = this.clone;
    var choices = rule.getExpression() ? rule.getExpression().split(',') : [];
    var idx = choices.indexOf(choice);

    if (idx > -1) {
      choices.splice(idx, 1);
    } else {
      choices.push(choice);
    }

    rule.setExpression(choices.length ? choices.join(',') : null);
  };

  _proto.onDateSelected = function onDateSelected(date) {
    if (!this.clone) {
      throw new Error('Missing clone');
    }

    this.clone.setExpression(date.start);
  };

  _proto.onDateRangeSelected = function onDateRangeSelected(date) {
    if (!this.clone) {
      throw new Error('Missing clone');
    }

    this.clone.lowerBoundary = date.start;
    this.clone.upperBoundary = date.end;
  };

  _proto.createDate_ = function createDate_(opt_timeDelta) {
    var date = new Date();

    if (opt_timeDelta !== undefined) {
      var time = date.getTime() - opt_timeDelta;
      date.setTime(time);
    }

    return date.toISOString();
  };

  _proto.createWeekAgoDate_ = function createWeekAgoDate_() {
    return this.createDate_(1000 * 60 * 60 * 24 * 7);
  };

  _proto.timeToDate = function timeToDate(time) {
    var date = new Date(time);
    return date.toLocaleDateString();
  };

  _proto.handleActiveChange_ = function handleActiveChange_(active, oldActive) {
    if (!this.map) {
      throw new Error('Missing map');
    }

    if (!this.featureOverlay) {
      throw new Error('Missing featureOverlay');
    }

    if (!(this.rule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_16__["default"]) || !(this.clone instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_16__["default"]) || active === oldActive) {
      return;
    }

    var keys = this.listenerKeys_;
    var uid = ['ngeo-rule-', Object(ol_util_js__WEBPACK_IMPORTED_MODULE_17__["getUid"])(this)].join('-');
    var toolMgr = this.ngeoToolActivateMgr_;
    var ruleFeature = this.rule.feature;
    var cloneFeature = this.clone.feature;
    var mapDiv = this.map.getViewport();
    console.assert(mapDiv);

    if (active) {
      keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(this.drawnFeatures, 'add', this.handleFeaturesAdd_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(mapDiv, 'contextmenu', this.handleMapContextMenu_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(this.translate_, 'translateend', this.handleTranslateEnd_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(this.rotate_, 'rotateend', this.handleRotateEnd_, this));
      this.featureOverlay.removeFeature(ruleFeature);
      this.featureOverlay.addFeature(cloneFeature);
      this.registerInteractions_();
      toolMgr.registerTool(uid, this.drawToolActivate, false);
      toolMgr.registerTool(uid, this.modifyToolActivate, true);
      toolMgr.registerTool(uid, this.rotateToolActivate, false);
      toolMgr.registerTool(uid, this.translateToolActivate, false);
      this.modify_.setActive(true);

      if (cloneFeature.getGeometry()) {
        this.ngeoFeatureHelper_.setStyle(cloneFeature, true);
      }
    } else {
      cloneFeature.setStyle(null);
      keys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["unlistenByKey"]);
      keys.length = 0;
      this.drawActive = false;
      toolMgr.unregisterTool(uid, this.drawToolActivate);
      toolMgr.unregisterTool(uid, this.modifyToolActivate);
      toolMgr.unregisterTool(uid, this.rotateToolActivate);
      toolMgr.unregisterTool(uid, this.translateToolActivate);
      this.modify_.setActive(false);
      this.unregisterInteractions_();

      if (this.selectedFeatures.getLength()) {
        this.featureOverlay.removeFeature(cloneFeature);
      }

      this.featureOverlay.addFeature(ruleFeature);
      this.selectedFeatures.clear();
    }
  };

  _proto.initializeInteractions_ = function initializeInteractions_() {
    this.interactions_.forEach(function (interaction) {
      interaction.setActive(false);
      Object(ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_11__["interactionDecoration"])(interaction);
    });
  };

  _proto.registerInteractions_ = function registerInteractions_() {
    var _this2 = this;

    this.interactions_.forEach(function (interaction) {
      if (!_this2.map) {
        throw new Error('Missing map');
      }

      _this2.map.addInteraction(interaction);
    });
  };

  _proto.unregisterInteractions_ = function unregisterInteractions_() {
    var _this3 = this;

    this.interactions_.forEach(function (interaction) {
      if (!_this3.map) {
        throw new Error('Missing map');
      }

      _this3.map.removeInteraction(interaction);
    });
  };

  _proto.handleFeaturesAdd_ = function handleFeaturesAdd_(evt) {
    var _this4 = this;

    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_18__["CollectionEvent"]) {
      this.timeout_(function () {
        var clone = _this4.clone;

        if (clone instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_16__["default"]) {
          var feature = clone.feature;
          var drawnFeature = evt.element;
          var geometry = drawnFeature.getGeometry();
          clone.geometry = geometry;
          _this4.drawActive = false;

          var properties = _this4.ngeoFeatureHelper_.getNonSpatialProperties(drawnFeature);

          _this4.ngeoFeatureHelper_.clearNonSpatialProperties(feature);

          feature.setProperties(properties);

          _this4.ngeoFeatureHelper_.setStyle(feature, true);

          _this4.scope_.$apply();
        }
      });
    }
  };

  _proto.getRuleGeometryType = function getRuleGeometryType() {
    var rule = this.rule;

    if (rule instanceof ngeo_rule_Geometry_js__WEBPACK_IMPORTED_MODULE_16__["default"]) {
      return this.ngeoFeatureHelper_.getType(rule.feature);
    }

    return null;
  };

  _proto.handleMapContextMenu_ = function handleMapContextMenu_(evt) {
    var _this5 = this;

    if (evt instanceof Event || evt instanceof TouchEvent) {
      if (!this.map) {
        throw new Error('Missing map');
      }

      this.removeMenu_();
      var pixel = this.map.getEventPixel(evt);
      var coordinate = this.map.getCoordinateFromPixel(pixel);
      var feature = this.map.forEachFeatureAtPixel(pixel, function (feature) {
        var ret = null;

        if (!(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_23__["default"])) {
          throw new Error('Wrong feature type');
        }

        if (_this5.selectedFeatures.getArray().includes(feature)) {
          ret = feature;
        }

        if (!ret) {
          throw new Error('Missing feature');
        }

        return ret;
      });
      var actions = [];

      if (feature) {
        var type = this.ngeoFeatureHelper_.getType(feature);
        var gettextCatalog = this.gettextCatalog_;

        if (type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].CIRCLE || type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].LINE_STRING || type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].POLYGON || type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].RECTANGLE) {
          actions.push({
            cls: 'fas fa-arrows-alt',
            label: gettextCatalog.getString('Move'),
            name: 'move'
          });
        }

        if (type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].LINE_STRING || type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].POLYGON || type == ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_5__["default"].RECTANGLE) {
          actions.push({
            cls: 'fas fa-undo fa-flip-horizontal',
            label: gettextCatalog.getString('Rotate'),
            name: 'rotate'
          });
        }
      }

      if (actions.length) {
        this.menu_ = new ngeo_Menu_js__WEBPACK_IMPORTED_MODULE_1__["default"]({
          actions: actions
        });
        this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["listen"])(this.menu_, 'actionclick', this.handleMenuActionClick_, this));
        this.map.addOverlay(this.menu_);
        this.menu_.open(coordinate);
        evt.preventDefault();
        evt.stopPropagation();
        this.scope_.$apply();
      }
    }
  };

  _proto.removeMenu_ = function removeMenu_() {
    if (this.menu_) {
      if (!this.map) {
        throw new Error('Missing map');
      }

      this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_19__["unlistenByKey"]);
      this.map.removeOverlay(this.menu_);
      this.menu_ = null;
    }
  };

  _proto.handleMenuActionClick_ = function handleMenuActionClick_(evt) {
    var action = evt.detail.action;

    switch (action) {
      case 'move':
        this.translate_.setActive(true);
        this.scope_.$apply();
        break;

      case 'rotate':
        this.rotate_.setActive(true);
        this.scope_.$apply();
        break;

      default:
        console.log("FIXME - support: " + action);
        break;
    }
  };

  _proto.handleRotateEnd_ = function handleRotateEnd_(evt) {
    this.rotate_.setActive(false);
    this.scope_.$apply();
  };

  _proto.handleTranslateEnd_ = function handleTranslateEnd_(evt) {
    this.translate_.setActive(false);
    this.scope_.$apply();
  };

  return RuleController;
}();

module.component('ngeoRule', {
  bindings: {
    'featureOverlay': '<',
    'map': '<',
    'rule': '<',
    'toolGroup': '<'
  },
  controller: RuleController,
  templateUrl: ngeoRuleTemplateUrl
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/filter/rulecomponent.html":
/*!***************************************!*\
  !*** ./src/filter/rulecomponent.html ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="dropdown">\n  <button\n      class="btn btn-default btn-sm btn-block dropdown-toggle"\n      type="button"\n      data-toggle="dropdown"\n      ng-click="$ctrl.toggle()">\n    <span>{{ ::$ctrl.clone.name | translate }}</span>\n  </button>\n  <div\n    class="dropdown-menu form-group"\n    ng-class="{show: $ctrl.rule.active}">\n\n    <select\n        class="form-control ngeo-rule-operators-list"\n        ng-if="::$ctrl.clone.operators"\n        ng-model="$ctrl.clone.operator"\n        ng-options="$ctrl.operators[operator] | translate for operator in ::$ctrl.clone.operators track by operator">\n    </select>\n\n    <div ng-switch="::$ctrl.clone.type">\n\n      <div\n          class="ngeo-rule-type-date form-group"\n          ng-if="$ctrl.rule.active"\n          ng-switch-when="date|datetime"\n          ng-switch-when-separator="|">\n        <div ng-switch="$ctrl.clone.operator">\n          <div ng-switch-when="..|time_during" ng-switch-when-separator="|">\n            <ngeo-date-picker\n                time="$ctrl.timeRangeMode"\n                on-date-selected="$ctrl.onDateRangeSelected(time)">\n            </ngeo-date-picker>\n          </div>\n          <div ng-switch-default>\n            <ngeo-date-picker\n                time="$ctrl.timeValueMode"\n                on-date-selected="$ctrl.onDateSelected(time)">\n            </ngeo-date-picker>\n          </div>\n        </div>\n      </div>\n\n      <div\n          class="ngeo-rule-type-geometry form-group"\n          ng-switch-when="geometry">\n        <div ng-switch="$ctrl.geomType">\n          <span\n              ng-switch-when="Point">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/point.svg */ "./contribs/gmf/src/icons/point.svg"))) == null ? '' : __t) +
'\n          </span>\n          <span\n              ng-switch-when="LineString">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/line.svg */ "./contribs/gmf/src/icons/line.svg"))) == null ? '' : __t) +
'\n          </span>\n          <span\n              ng-switch-when="Polygon">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/polygon.svg */ "./contribs/gmf/src/icons/polygon.svg"))) == null ? '' : __t) +
'\n          </span>\n          <span\n              ng-switch-when="Circle">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/circle.svg */ "./contribs/gmf/src/icons/circle.svg"))) == null ? '' : __t) +
'\n          </span>\n          <span\n              ng-switch-when="Rectangle">\n          ' +
((__t = (__webpack_require__(/*! gmf/icons/rectangle.svg */ "./contribs/gmf/src/icons/rectangle.svg"))) == null ? '' : __t) +
'\n          </span>\n        </div>\n        <ngeo-drawfeature\n            ngeo-drawfeature-active="$ctrl.drawActive"\n            ngeo-drawfeature-features="$ctrl.drawnFeatures"\n            ngeo-drawfeature-map="$ctrl.map">\n          <div\n              ngeo-btn-group\n              class="btn-group">\n              <a\n                data-toggle="tooltip"\n                title="{{\'Draw a point on the map\' | translate}}"\n                href\n                ngeo-btn\n                ngeo-drawpoint\n                class="btn btn-sm btn-default ngeo-drawfeature-point"\n                ng-show="[\'intersects\', \'within\'].indexOf($ctrl.clone.operator) !== -1"\n                ng-class="{active: dfCtrl.drawPoint.active}"\n                ng-model="dfCtrl.drawPoint.active">\n                ' +
((__t = (__webpack_require__(/*! gmf/icons/point.svg */ "./contribs/gmf/src/icons/point.svg"))) == null ? '' : __t) +
'\n              </a>\n              <a\n                data-toggle="tooltip"\n                title="{{\'Draw a line on the map\' | translate}}"\n                href\n                ngeo-btn\n                ngeo-measurelength\n                class="btn btn-sm btn-default ngeo-drawfeature-linestring"\n                ng-show="[\'intersects\', \'within\'].indexOf($ctrl.clone.operator) !== -1"\n                ng-class="{active: dfCtrl.measureLength.active}"\n                ng-model="dfCtrl.measureLength.active">\n                ' +
((__t = (__webpack_require__(/*! gmf/icons/line.svg */ "./contribs/gmf/src/icons/line.svg"))) == null ? '' : __t) +
'\n              </a>\n              <a\n                data-toggle="tooltip"\n                title="{{\'Draw a polygon on the map\' | translate}}"\n                href\n                ngeo-btn\n                ngeo-measurearea\n                class="btn btn-sm btn-default ngeo-drawfeature-polygon"\n                ng-class="{active: dfCtrl.measureArea.active}"\n                ng-model="dfCtrl.measureArea.active">\n                ' +
((__t = (__webpack_require__(/*! gmf/icons/polygon.svg */ "./contribs/gmf/src/icons/polygon.svg"))) == null ? '' : __t) +
'\n              </a>\n              <a\n                data-toggle="tooltip"\n                title="{{\'Draw a circle on the map\' | translate}}"\n                href\n                ngeo-btn\n                ngeo-measureazimut\n                class="btn btn-sm btn-default ngeo-drawfeature-circle"\n                ng-class="{active: dfCtrl.measureAzimut.active}"\n                ng-model="dfCtrl.measureAzimut.active">\n                ' +
((__t = (__webpack_require__(/*! gmf/icons/circle.svg */ "./contribs/gmf/src/icons/circle.svg"))) == null ? '' : __t) +
'\n              </a>\n              <a\n                data-toggle="tooltip"\n                title="{{\'Draw a rectangle on the map\' | translate}}"\n                href\n                ngeo-btn\n                ngeo-drawrectangle\n                class="btn btn-sm btn-default ngeo-drawfeature-rectangle"\n                ng-class="{active: dfCtrl.drawRectangle.active}"\n                ng-model="dfCtrl.drawRectangle.active">\n                ' +
((__t = (__webpack_require__(/*! gmf/icons/rectangle.svg */ "./contribs/gmf/src/icons/rectangle.svg"))) == null ? '' : __t) +
'\n              </a>\n          </div>\n\n          <div\n              class="ngeo-rule-type-geometry-instructions"\n              ng-if="$ctrl.drawActive">\n            <span ng-if="dfCtrl.drawPoint.active">\n              {{ \'Draw a point on the map.\' | translate }}\n            </span>\n            <span ng-if="dfCtrl.measureLength.active">\n              {{ \'Draw a line string on the map.\' | translate }}\n            </span>\n            <span ng-if="dfCtrl.measureArea.active">\n              {{ \'Draw a polygon on the map.\' | translate }}\n            </span>\n            <span ng-if="dfCtrl.measureAzimut.active">\n              {{ \'Draw a circle on the map.\' | translate }}\n            </span>\n            <span ng-if="dfCtrl.drawRectangle.active">\n              {{ \'Draw a rectangle on the map.\' | translate }}\n            </span>\n          </div>\n        </ngeo-drawfeature>\n      </div>\n\n      <div\n          class="checkbox ngeo-rule-type-select"\n          ng-switch-when="select">\n        <a\n            ng-click="$ctrl.selectAllChoices()"\n            href>{{ All | translate}}\n        </a>\n        <label\n            class="form-group ol-unselectable"\n            ng-repeat="choice in ::$ctrl.clone.choices">\n          <input\n              ng-checked="$ctrl.clone.getExpression() && $ctrl.clone.getExpression().split(\',\').indexOf(choice) > -1"\n              ng-click="$ctrl.toggleChoiceSelection(choice)"\n              type="checkbox"\n              value="choice" />\n          <span>{{ choice | translate }}</span>\n        </label>\n\n      </div>\n\n      <div\n          class="form-group ngeo-rule-type-text"\n          ng-switch-default>\n        <div ng-switch="$ctrl.clone.operator">\n          <div ng-switch-when="..">\n            <input\n                type="number"\n                class="form-control"\n                ng-model="$ctrl.clone.lowerBoundary"/>\n            <input\n                type="number"\n                class="form-control"\n                ng-model="$ctrl.clone.upperBoundary"/>\n          </div>\n          <div ng-switch-default>\n            <input\n                type="number"\n                class="form-control"\n                ng-if="$ctrl.clone.type === \'number\'"\n                ng-model="$ctrl.clone.expression"/>\n            <input\n                type="text"\n                class="form-control"\n                ng-if="$ctrl.clone.type !== \'number\'"\n                ng-model="$ctrl.clone.expression"/>\n          </div>\n        </div>\n      </div>\n\n      <div class="ngeo-rule-btns">\n        <button\n            class="btn btn-sm btn-default"\n            ng-click="$ctrl.apply()"\n            type="button">{{\'Apply\' | translate}}</button>\n        <button\n            class="btn btn-sm btn-default"\n            ng-click="$ctrl.cancel()"\n            type="button">{{\'Cancel\' | translate}}</button>\n      </div>\n\n    </div>\n  </div>\n</div>\n\n\n<div\n    class="ngeo-rule-value"\n    ng-if="$ctrl.rule.value !== null">\n\n  <a\n      class="btn btn-sm btn-link"\n      ng-click="!$ctrl.rule.active && $ctrl.reset()"\n      ng-disabled="$ctrl.rule.active"\n      href>\n    <span class="fa fa-times"></span>\n  </a>\n\n  <div ng-switch="::$ctrl.rule.type">\n\n    <div\n        ng-switch-when="date|datetime"\n        ng-switch-when-separator="|">\n      <div ng-switch="$ctrl.rule.operator">\n        <div ng-switch-when="..|time_during" ng-switch-when-separator="|">\n          <span translate>From </span>\n          <span>{{ $ctrl.timeToDate($ctrl.rule.lowerBoundary) }}</span>\n          <span translate> to </span>\n          <span>{{ $ctrl.timeToDate($ctrl.rule.upperBoundary) }}</span>\n        </div>\n        <div ng-switch-default>\n          <span>{{ $ctrl.operatorsShortFormat[$ctrl.rule.operator] }}</span>\n          <span>{{ $ctrl.timeToDate($ctrl.rule.getExpression()) }}</span>\n        </div>\n      </div>\n    </div>\n\n    <div ng-switch-when="geometry">\n      <span>{{ $ctrl.operators[$ctrl.rule.operator] }}</span>\n      <span ng-switch="$ctrl.getRuleGeometryType()">\n        <span\n            class="gmf-icon gmf-icon-point"\n            ng-switch-when="Point">\n        </span>\n        <span\n            class="gmf-icon gmf-icon-line"\n            ng-switch-when="LineString">\n        </span>\n        <span\n            class="gmf-icon gmf-icon-polygon"\n            ng-switch-when="Polygon">\n        </span>\n        <span\n            class="gmf-icon gmf-icon-circle"\n            ng-switch-when="Circle">\n        </span>\n        <span\n            class="gmf-icon gmf-icon-rectangle"\n            ng-switch-when="Rectangle">\n        </span>\n      </span>\n    </div>\n\n    <div ng-switch-when="select">\n      <span ng-repeat="choice in $ctrl.rule.getExpression().split(\',\')">\n        {{ choice | translate }}{{ $last ? \'\' : \', \' }}\n      </span>\n    </div>\n\n    <div ng-switch-default>\n      <div ng-switch="$ctrl.rule.operator">\n        <div ng-switch-when="..|time_during" ng-switch-when-separator="|">\n          <span translate>Between </span>\n          <span>{{ $ctrl.rule.lowerBoundary }}</span>\n          <span translate> and </span>\n          <span>{{ $ctrl.rule.upperBoundary }}</span>\n        </div>\n        <div ng-switch-default>\n          <span>{{ $ctrl.operatorsShortFormat[$ctrl.rule.operator] }}</span>\n          <span>{{ $ctrl.rule.getExpression() }}</span>\n        </div>\n      </div>\n    </div>\n\n  </div>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./src/format/ArcGISGeoJSON.js":
/*!*************************************!*\
  !*** ./src/format/ArcGISGeoJSON.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
/* harmony import */ var ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/format/GeoJSON.js */ "./node_modules/ol/format/GeoJSON.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }



var layerIdentifier = 'layerName';

var ArcGISGeoJSON = function (_olFormatGeoJSON) {
  _inheritsLoose(ArcGISGeoJSON, _olFormatGeoJSON);

  function ArcGISGeoJSON(opt_options) {
    var _this;

    var options = opt_options ? opt_options : {};
    _this = _olFormatGeoJSON.call(this, opt_options) || this;
    _this.layers_ = options.layers ? options.layers : null;
    return _this;
  }

  var _proto = ArcGISGeoJSON.prototype;

  _proto.getLayers = function getLayers() {
    return this.layers_;
  };

  _proto.setLayers = function setLayers(layers) {
    this.layers_ = layers;
  };

  _proto.readFeaturesFromObject = function readFeaturesFromObject(object, opt_options) {
    var geoJSONObject = object;
    var features = [];
    var geoJSONFeatures = null;

    if (geoJSONObject['type'] === 'FeatureCollection') {
      var geoJSONFeatureCollection = object;
      geoJSONFeatures = geoJSONFeatureCollection['features'];
    } else {
      geoJSONFeatures = [object];
    }

    for (var i = 0, ii = geoJSONFeatures.length; i < ii; ++i) {
      var layerName = geoJSONFeatures[i][layerIdentifier];

      if (this.layers_ && !Object(ol_array_js__WEBPACK_IMPORTED_MODULE_0__["includes"])(this.layers_, layerName)) {
        continue;
      }

      features.push(this.readFeatureFromObject(geoJSONFeatures[i], opt_options));
    }

    return features;
  };

  return ArcGISGeoJSON;
}(ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (ArcGISGeoJSON);

/***/ }),

/***/ "./src/format/Attribute.js":
/*!*********************************!*\
  !*** ./src/format/Attribute.js ***!
  \*********************************/
/*! exports provided: setGeometryType, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setGeometryType", function() { return setGeometryType; });
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");

function setGeometryType(attribute, type) {
  var geomRegex = /gml:((Multi)?(Point|Line|Polygon|Curve|Surface|Geometry)).*/;

  if (geomRegex.exec(type)) {
    attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__["default"].GEOMETRY;

    if (/^gml:Point/.exec(type)) {
      attribute.geomType = 'Point';
    } else if (/^gml:LineString|^gml:Curve/.exec(type)) {
      attribute.geomType = 'LineString';
    } else if (/^gml:Polygon|^gml:Surface/.exec(type)) {
      attribute.geomType = 'Polygon';
    } else if (/^gml:MultiPoint/.exec(type)) {
      attribute.geomType = 'MultiPoint';
    } else if (/^gml:MultiLineString|^gml:MultiCurve/.exec(type)) {
      attribute.geomType = 'MultiLineString';
    } else if (/^gml:MultiPolygon|^gml:MultiSurface/.exec(type)) {
      attribute.geomType = 'MultiPolygon';
    }
  }

  return !!attribute.type && !!attribute.geomType;
}
/* harmony default export */ __webpack_exports__["default"] = (null);

/***/ }),

/***/ "./src/format/AttributeType.js":
/*!*************************************!*\
  !*** ./src/format/AttributeType.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ({
  BOOLEAN: 'boolean',
  DATE: 'date',
  DATETIME: 'datetime',
  TIME: 'time',
  GEOMETRY: 'geometry',
  NUMBER: 'number',
  SELECT: 'select',
  TEXT: 'text'
});

/***/ }),

/***/ "./src/format/FeatureHash.js":
/*!***********************************!*\
  !*** ./src/format/FeatureHash.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/format/FeatureProperties.js */ "./src/format/FeatureProperties.js");
/* harmony import */ var ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/format/FeatureHashStyleType.js */ "./src/format/FeatureHashStyleType.js");
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
/* harmony import */ var ol_color_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/color.js */ "./node_modules/ol/color.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_format_Feature_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/format/Feature.js */ "./node_modules/ol/format/Feature.js");
/* harmony import */ var ol_format_TextFeature_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/format/TextFeature.js */ "./node_modules/ol/format/TextFeature.js");
/* harmony import */ var ol_geom_GeometryLayout_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/geom/GeometryLayout.js */ "./node_modules/ol/geom/GeometryLayout.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/geom/MultiLineString.js */ "./node_modules/ol/geom/MultiLineString.js");
/* harmony import */ var ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/geom/MultiPoint.js */ "./node_modules/ol/geom/MultiPoint.js");
/* harmony import */ var ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/geom/MultiPolygon.js */ "./node_modules/ol/geom/MultiPolygon.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
/* harmony import */ var ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ol/style/Circle.js */ "./node_modules/ol/style/Circle.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_style_Text_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/style/Text.js */ "./node_modules/ol/style/Text.js");
/* harmony import */ var ol_geom_Geometry_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ol/geom/Geometry.js */ "./node_modules/ol/geom/Geometry.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





















var LegacyProperties_ = {};
var DEFAULT_ACCURACY = 0.1;
var StyleTypes_ = {
  'LineString': ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].LINE_STRING,
  'Point': ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].POINT,
  'Polygon': ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].POLYGON,
  'MultiLineString': ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].LINE_STRING,
  'MultiPoint': ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].POINT,
  'MultiPolygon': ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].POLYGON
};
var CHAR64_ = '.-_!*ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghjkmnpqrstuvwxyz';
var GEOMETRY_READERS_ = {
  'P': readMultiPointGeometry_,
  'L': readMultiLineStringGeometry_,
  'A': readMultiPolygonGeometry_,
  'l': readLineStringGeometry_,
  'p': readPointGeometry_,
  'a': readPolygonGeometry_
};
var GEOMETRY_WRITERS_ = {
  'MultiLineString': writeMultiLineStringGeometry_,
  'MultiPoint': writeMultiPointGeometry_,
  'MultiPolygon': writeMultiPolygonGeometry_,
  'LineString': writeLineStringGeometry_,
  'Point': writePointGeometry_,
  'Polygon': writePolygonGeometry_
};

var FeatureHash = function (_olFormatTextFeature) {
  _inheritsLoose(FeatureHash, _olFormatTextFeature);

  function FeatureHash(opt_options) {
    var _this;

    _this = _olFormatTextFeature.call(this) || this;
    var options = opt_options || {};
    _this.accuracy_ = options.accuracy || DEFAULT_ACCURACY;
    _this.encodeStyles_ = options.encodeStyles || true;
    _this.propertiesFunction_ = options.properties || defaultPropertiesFunction_;
    _this.setStyle_ = options.setStyle !== undefined ? options.setStyle : true;
    _this.prevX_ = 0;
    _this.prevY_ = 0;
    LegacyProperties_ = options.propertiesType || {};
    _this.defaultValues_ = options.defaultValues || {};
    return _this;
  }

  var _proto = FeatureHash.prototype;

  _proto.decodeCoordinates_ = function decodeCoordinates_(text, opt_flatCoordinates) {
    var len = text.length;
    var index = 0;
    var flatCoordinates = opt_flatCoordinates !== undefined ? opt_flatCoordinates : [];
    var i = flatCoordinates.length;

    while (index < len) {
      var b = void 0;
      var shift = 0;
      var result = 0;

      do {
        b = CHAR64_.indexOf(text.charAt(index++));
        result |= (b & 0x1f) << shift;
        shift += 5;
      } while (b >= 32);

      var dx = result & 1 ? ~(result >> 1) : result >> 1;
      this.prevX_ += dx;
      shift = 0;
      result = 0;

      do {
        b = CHAR64_.indexOf(text.charAt(index++));
        result |= (b & 0x1f) << shift;
        shift += 5;
      } while (b >= 32);

      var dy = result & 1 ? ~(result >> 1) : result >> 1;
      this.prevY_ += dy;
      flatCoordinates[i++] = this.prevX_ * this.accuracy_;
      flatCoordinates[i++] = this.prevY_ * this.accuracy_;
    }

    return flatCoordinates;
  };

  _proto.encodeCoordinates_ = function encodeCoordinates_(flatCoordinates, stride, offset, end) {
    var encodedCoordinates = '';

    for (var i = offset; i < end; i += stride) {
      var x = flatCoordinates[i];
      var y = flatCoordinates[i + 1];
      x = Math.floor(x / this.accuracy_);
      y = Math.floor(y / this.accuracy_);
      var dx = x - this.prevX_;
      var dy = y - this.prevY_;
      this.prevX_ = x;
      this.prevY_ = y;
      encodedCoordinates += encodeSignedNumber_(dx) + encodeSignedNumber_(dy);
    }

    return encodedCoordinates;
  };

  _proto.readFeatureFromText = function readFeatureFromText(text, opt_options) {
    console.assert(text.length > 2);
    console.assert(text[1] === '(');
    console.assert(text.endsWith(')'));
    var splitIndex = text.indexOf('~');
    var geometryText = splitIndex >= 0 ? text.substring(0, splitIndex) + ")" : text;
    var geometry = this.readGeometryFromText(geometryText, opt_options);
    var feature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_4__["default"](geometry);

    if (splitIndex >= 0) {
      var attributesAndStylesText = text.substring(splitIndex + 1, text.length - 1);
      splitIndex = attributesAndStylesText.indexOf('~');
      var attributesText = splitIndex >= 0 ? attributesAndStylesText.substring(0, splitIndex) : attributesAndStylesText;

      if (attributesText != '') {
        var parts = attributesText.split('\'');

        for (var _iterator = parts, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
          var _ref;

          if (_isArray) {
            if (_i >= _iterator.length) break;
            _ref = _iterator[_i++];
          } else {
            _i = _iterator.next();
            if (_i.done) break;
            _ref = _i.value;
          }

          var encodedPart = _ref;
          var part = decodeURIComponent(encodedPart);
          var keyVal = part.split('*');
          console.assert(keyVal.length === 2);
          var key = keyVal[0];
          var value = keyVal[1];

          if (!this.setStyle_ && LegacyProperties_[key]) {
            key = LegacyProperties_[key];
          }

          feature.set(key, castValue_(key, value));
        }
      }

      if (splitIndex >= 0) {
        var stylesText = attributesAndStylesText.substring(splitIndex + 1);

        if (this.setStyle_) {
          setStyleInFeature_(stylesText, feature);
        } else {
          setStyleProperties_(stylesText, feature);
        }
      }
    }

    return feature;
  };

  _proto.readFeaturesFromText = function readFeaturesFromText(text, opt_options) {
    var _this2 = this;

    console.assert(text.startsWith('F'));
    this.prevX_ = 0;
    this.prevY_ = 0;
    var features = [];
    text = text.substring(1);

    while (text.length > 0) {
      var index = text.indexOf(')');
      console.assert(index >= 0);
      var feature = this.readFeatureFromText(text.substring(0, index + 1), opt_options);
      features.push(feature);
      text = text.substring(index + 1);
    }

    features.forEach(function (feature) {
      for (var key in _this2.defaultValues_) {
        var property = LegacyProperties_[key];

        if (feature.get(property) === undefined) {
          feature.set(property, _this2.defaultValues_[key].call(null, feature));
        }
      }
    });
    return features;
  };

  _proto.readGeometryFromText = function readGeometryFromText(text, opt_options) {
    var geometryReader = GEOMETRY_READERS_[text[0]];
    console.assert(geometryReader !== undefined);
    return geometryReader.call(this, text);
  };

  _proto.writeFeatureText = function writeFeatureText(feature, opt_options) {
    var encodedParts = [];
    var encodedGeometry = '';
    var geometry = feature.getGeometry();

    if (geometry) {
      encodedGeometry = this.writeGeometryText(geometry, opt_options);
    }

    if (encodedGeometry.length > 0) {
      console.assert(encodedGeometry.endsWith(')'));
      encodedGeometry = encodedGeometry.substring(0, encodedGeometry.length - 1);
      encodedParts.push(encodedGeometry);
    }

    var encodedProperties = [];
    var propFunction = this.propertiesFunction_(feature);

    for (var key in propFunction) {
      var value = propFunction[key];

      if (value !== undefined && value !== null && key !== feature.getGeometryName()) {
        if (encodedProperties.length !== 0) {
          encodedProperties.push('\'');
        }

        var encoded = encodeURIComponent(key.replace(/[()'*]/g, '_') + "*" + value.toString().replace(/[()'*]/g, '_'));
        encodedProperties.push(encoded);
      }
    }

    if (encodedProperties.length > 0) {
      encodedParts.push('~');
      Array.prototype.push.apply(encodedParts, encodedProperties);
    }

    if (this.encodeStyles_) {
      var styleFunction = feature.getStyleFunction();

      if (styleFunction !== undefined) {
        var styles = styleFunction(feature, 0);

        if (styles !== null) {
          var encodedStyles = [];
          styles = Array.isArray(styles) ? styles : [styles];

          if (!geometry) {
            throw new Error('Missing geometry');
          }

          encodeStyles_(styles, geometry.getType(), encodedStyles);

          if (encodedStyles.length > 0) {
            encodedParts.push('~');
            Array.prototype.push.apply(encodedParts, encodedStyles);
          }
        }
      }
    }

    encodedParts.push(')');
    return encodedParts.join('');
  };

  _proto.writeFeaturesText = function writeFeaturesText(features, opt_options) {
    this.prevX_ = 0;
    this.prevY_ = 0;
    var textArray = [];

    if (features.length > 0) {
      textArray.push('F');

      for (var i = 0, ii = features.length; i < ii; ++i) {
        textArray.push(this.writeFeatureText(features[i], opt_options));
      }
    }

    return textArray.join('');
  };

  _proto.writeGeometryText = function writeGeometryText(geometry, opt_options) {
    var geometryWriter = GEOMETRY_WRITERS_[geometry.getType()];
    console.assert(geometryWriter !== undefined);
    var transformedGeometry = Object(ol_format_Feature_js__WEBPACK_IMPORTED_MODULE_5__["transformGeometryWithOptions"])(geometry, true, opt_options);

    if (!(transformedGeometry instanceof ol_geom_Geometry_js__WEBPACK_IMPORTED_MODULE_19__["default"])) {
      throw new Error('Missing transformedGeometry');
    }

    var encGeom = geometryWriter.call(this, transformedGeometry);

    if (!encGeom) {
      throw new Error('Missing encodedGeometry');
    }

    return encGeom;
  };

  return FeatureHash;
}(ol_format_TextFeature_js__WEBPACK_IMPORTED_MODULE_6__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (FeatureHash);

function defaultPropertiesFunction_(feature) {
  return feature.getProperties();
}

function encodeSignedNumber_(num) {
  var signedNum = num << 1;

  if (num < 0) {
    signedNum = ~signedNum;
  }

  return encodeNumber_(signedNum);
}

function encodeNumber_(num) {
  var encodedNumber = '';

  while (num >= 0x20) {
    encodedNumber += CHAR64_.charAt(0x20 | num & 0x1f);
    num >>= 5;
  }

  encodedNumber += CHAR64_.charAt(num);
  return encodedNumber;
}

function encodeStyles_(styles, geometryType, encodedStyles) {
  var styleType = StyleTypes_[geometryType];
  console.assert(styleType !== undefined);

  for (var _iterator2 = styles, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
    var _ref2;

    if (_isArray2) {
      if (_i2 >= _iterator2.length) break;
      _ref2 = _iterator2[_i2++];
    } else {
      _i2 = _iterator2.next();
      if (_i2.done) break;
      _ref2 = _i2.value;
    }

    var style = _ref2;
    var fillStyle = style.getFill();
    var imageStyle = style.getImage();
    var strokeStyle = style.getStroke();
    var textStyle = style.getText();

    if (styleType == ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].POLYGON) {
      if (fillStyle !== null) {
        encodeStylePolygon_(fillStyle, strokeStyle, encodedStyles);
      }
    } else if (styleType == ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].LINE_STRING) {
      if (strokeStyle !== null) {
        encodeStyleLine_(strokeStyle, encodedStyles);
      }
    } else if (styleType == ngeo_format_FeatureHashStyleType_js__WEBPACK_IMPORTED_MODULE_1__["default"].POINT) {
      if (imageStyle !== null) {
        encodeStylePoint_(imageStyle, encodedStyles);
      }
    }

    if (textStyle !== null) {
      encodeStyleText_(textStyle, encodedStyles);
    }
  }
}

function encodeStyleLine_(strokeStyle, encodedStyles) {
  encodeStyleStroke_(strokeStyle, encodedStyles);
}

function encodeStylePoint_(imageStyle, encodedStyles) {
  if (imageStyle instanceof ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_14__["default"]) {
    var radius = imageStyle.getRadius();

    if (encodedStyles.length > 0) {
      encodedStyles.push('\'');
    }

    encodedStyles.push(encodeURIComponent("pointRadius*" + radius));
    var fillStyle = imageStyle.getFill();

    if (fillStyle !== null) {
      encodeStyleFill_(fillStyle, encodedStyles);
    }

    var strokeStyle = imageStyle.getStroke();

    if (strokeStyle !== null) {
      encodeStyleStroke_(strokeStyle, encodedStyles);
    }
  }
}

function encodeStylePolygon_(fillStyle, strokeStyle, encodedStyles) {
  encodeStyleFill_(fillStyle, encodedStyles);

  if (strokeStyle !== null) {
    encodeStyleStroke_(strokeStyle, encodedStyles);
  }
}

function encodeStyleFill_(fillStyle, encodedStyles, propertyName) {
  if (propertyName === void 0) {
    propertyName = 'fillColor';
  }

  var fillColor = fillStyle.getColor();
  var fillColorHex;

  if (fillColor !== null) {
    if (Array.isArray(fillColor)) {
      fillColorHex = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_2__["rgbArrayToHex"])(fillColor);
    } else if (typeof fillColor === 'string') {
      fillColorHex = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_2__["rgbArrayToHex"])(Object(ol_color_js__WEBPACK_IMPORTED_MODULE_3__["asArray"])(fillColor));
    } else {
      throw new Error('Unsupported color');
    }

    if (encodedStyles.length > 0) {
      encodedStyles.push('\'');
    }

    encodedStyles.push(encodeURIComponent(propertyName + "*" + fillColorHex));
  }
}

function encodeStyleStroke_(strokeStyle, encodedStyles) {
  var strokeColor = strokeStyle.getColor();

  if (strokeColor !== null) {
    if (Array.isArray(strokeColor)) {
      var strokeColorHex = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_2__["rgbArrayToHex"])(strokeColor);

      if (encodedStyles.length > 0) {
        encodedStyles.push('\'');
      }

      encodedStyles.push(encodeURIComponent("strokeColor*" + strokeColorHex));
    }
  }

  var strokeWidth = strokeStyle.getWidth();

  if (strokeWidth !== undefined) {
    if (encodedStyles.length > 0) {
      encodedStyles.push('\'');
    }

    encodedStyles.push(encodeURIComponent("strokeWidth*" + strokeWidth));
  }
}

function encodeStyleText_(textStyle, encodedStyles) {
  var fontStyle = textStyle.getFont();

  if (fontStyle !== undefined) {
    var font = fontStyle.split(' ');

    if (font.length >= 3) {
      if (encodedStyles.length > 0) {
        encodedStyles.push('\'');
      }

      encodedStyles.push(encodeURIComponent("fontSize*" + font[1]));
    }
  }

  var fillStyle = textStyle.getFill();

  if (fillStyle !== null) {
    encodeStyleFill_(fillStyle, encodedStyles, 'fontColor');
  }
}

function readLineStringGeometry_(text) {
  console.assert(text.startsWith('l('));
  console.assert(text.endsWith(')'));
  text = text.substring(2, text.length - 1);
  var flatCoordinates = this.decodeCoordinates_(text);
  return new ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_8__["default"](flatCoordinates, ol_geom_GeometryLayout_js__WEBPACK_IMPORTED_MODULE_7__["default"].XY);
}

function readMultiLineStringGeometry_(text) {
  console.assert(text.startsWith('L('));
  console.assert(text.endsWith(')'));
  text = text.substring(2, text.length - 1);
  var flatCoordinates = [];
  var ends = [];
  var lineStrings = text.split('\'');

  for (var i = 0, ii = lineStrings.length; i < ii; ++i) {
    flatCoordinates = this.decodeCoordinates_(lineStrings[i], flatCoordinates);
    ends[i] = flatCoordinates.length;
  }

  return new ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_9__["default"](flatCoordinates, ol_geom_GeometryLayout_js__WEBPACK_IMPORTED_MODULE_7__["default"].XY, ends);
}

function readPointGeometry_(text) {
  console.assert(text.startsWith('p('));
  console.assert(text.endsWith(')'));
  text = text.substring(2, text.length - 1);
  var flatCoordinates = this.decodeCoordinates_(text);
  console.assert(flatCoordinates.length === 2);
  return new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__["default"](flatCoordinates, ol_geom_GeometryLayout_js__WEBPACK_IMPORTED_MODULE_7__["default"].XY);
}

function readMultiPointGeometry_(text) {
  console.assert(text.startsWith('P('));
  console.assert(text.endsWith(')'));
  text = text.substring(2, text.length - 1);
  var flatCoordinates = this.decodeCoordinates_(text);
  return new ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_10__["default"](flatCoordinates, ol_geom_GeometryLayout_js__WEBPACK_IMPORTED_MODULE_7__["default"].XY);
}

function readPolygonGeometry_(text) {
  console.assert(text.startsWith('a('));
  console.assert(text.endsWith(')'));
  text = text.substring(2, text.length - 1);
  var flatCoordinates = [];
  var ends = [];
  var rings = text.split('\'');

  for (var i = 0, ii = rings.length; i < ii; ++i) {
    flatCoordinates = this.decodeCoordinates_(rings[i], flatCoordinates);
    var end = flatCoordinates.length;

    if (i === 0) {
      flatCoordinates[end++] = flatCoordinates[0];
      flatCoordinates[end++] = flatCoordinates[1];
    } else {
      flatCoordinates[end++] = flatCoordinates[ends[i - 1]];
      flatCoordinates[end++] = flatCoordinates[ends[i - 1] + 1];
    }

    ends[i] = end;
  }

  return new ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_13__["default"](flatCoordinates, ol_geom_GeometryLayout_js__WEBPACK_IMPORTED_MODULE_7__["default"].XY, ends);
}

function readMultiPolygonGeometry_(text) {
  console.assert(text.startsWith('A('));
  console.assert(text.endsWith(')'));
  text = text.substring(2, text.length - 1);
  var flatCoordinates = [];
  var endss = [];
  var polygons = text.split(')(');

  for (var i = 0, ii = polygons.length; i < ii; ++i) {
    var rings = polygons[i].split('\'');
    endss[i] = [];
    var ends = endss[i];

    for (var j = 0, jj = rings.length; j < jj; ++j) {
      flatCoordinates = this.decodeCoordinates_(rings[j], flatCoordinates);
      var end = flatCoordinates.length;

      if (j === 0) {
        flatCoordinates[end++] = flatCoordinates[0];
        flatCoordinates[end++] = flatCoordinates[1];
      } else {
        flatCoordinates[end++] = flatCoordinates[ends[j - 1]];
        flatCoordinates[end++] = flatCoordinates[ends[j - 1] + 1];
      }

      ends[j] = end;
    }
  }

  return new ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_11__["default"](flatCoordinates, ol_geom_GeometryLayout_js__WEBPACK_IMPORTED_MODULE_7__["default"].XY, endss);
}

function setStyleInFeature_(text, feature) {
  if (text == '') {
    return;
  }

  var properties = getStyleProperties_(text, feature);
  var fillColor = properties.fillColor;
  var fontSize = properties.fontSize;
  var fontColor = properties.fontColor;
  var pointRadius = properties.pointRadius;
  var strokeColor = properties.strokeColor;
  var strokeWidth = properties.strokeWidth;
  var fillStyle = null;

  if (fillColor !== undefined) {
    fillStyle = new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_15__["default"]({
      color: fillColor
    });
  }

  var strokeStyle = null;

  if (strokeColor !== undefined && strokeWidth !== undefined) {
    if (typeof strokeWidth != 'number') {
      throw new Error('Missing strokeWidth');
    }

    strokeStyle = new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_16__["default"]({
      color: strokeColor,
      width: strokeWidth
    });
  }

  var imageStyle = null;

  if (pointRadius !== undefined) {
    if (typeof pointRadius != 'number') {
      throw new Error('Missing pointRadius');
    }

    var _options = {
      radius: pointRadius
    };

    if (fillStyle) {
      _options.fill = fillStyle;
    }

    if (strokeStyle) {
      _options.stroke = strokeStyle;
    }

    imageStyle = new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_14__["default"](_options);
    fillStyle = null;
    strokeStyle = null;
  }

  var textStyle = null;

  if (fontSize !== undefined && fontColor !== undefined) {
    textStyle = new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_18__["default"]({
      font: fontSize + " sans-serif",
      fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_15__["default"]({
        color: fontColor
      })
    });
  }

  var options = {};

  if (fillStyle) {
    options.fill = fillStyle;
  }

  if (strokeStyle) {
    options.stroke = strokeStyle;
  }

  if (imageStyle) {
    options.image = imageStyle;
  }

  if (textStyle) {
    options.text = textStyle;
  }

  var style = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_17__["default"](options);
  feature.setStyle(style);
}

function setStyleProperties_(text, feature) {
  var properties = getStyleProperties_(text, feature);
  var geometry = feature.getGeometry();

  if (geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__["default"]) {
    if (properties.isLabel || properties[ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].IS_TEXT]) {
      delete properties.strokeColor;
      delete properties.fillColor;
    } else {
      delete properties.fontColor;
      delete properties.fontSize;
    }
  } else {
    delete properties.fontColor;

    if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
      delete properties.fillColor;
      delete properties.fillOpacity;
    }
  }

  if (properties.fontSize) {
    var fontSizeStr = properties.fontSize;

    if (typeof fontSizeStr !== 'string') {
      throw new Error('Wrong fontSizeStr type');
    }

    var fontSize = parseFloat(fontSizeStr);

    if (fontSizeStr.includes('px')) {
      fontSize = Math.round(fontSize / 1.333333);
    }

    properties.fontSize = fontSize;
  }

  var clone = {};

  for (var key in properties) {
    var value = properties[key];

    if (LegacyProperties_[key]) {
      clone[LegacyProperties_[key]] = value;
    } else {
      clone[key] = value;
    }
  }

  feature.setProperties(clone);
}

function castValue_(key, value) {
  var numProperties = [ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].ANGLE, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].OPACITY, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].SIZE, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].STROKE, 'pointRadius', 'strokeWidth'];
  var boolProperties = [ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].IS_CIRCLE, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].IS_RECTANGLE, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].IS_TEXT, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].SHOW_MEASURE, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_0__["default"].SHOW_LABEL, 'isCircle', 'isRectangle', 'isLabel', 'showMeasure', 'showLabel'];

  if (numProperties.includes(key)) {
    return +value;
  } else if (boolProperties.includes(key)) {
    return value === 'true' ? true : false;
  } else {
    return value;
  }
}

function getStyleProperties_(text, feature) {
  var parts = text.split('\'');
  var properties = {};

  for (var _iterator3 = parts, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
    var _ref3;

    if (_isArray3) {
      if (_i3 >= _iterator3.length) break;
      _ref3 = _iterator3[_i3++];
    } else {
      _i3 = _iterator3.next();
      if (_i3.done) break;
      _ref3 = _i3.value;
    }

    var encodedPart = _ref3;
    var part = decodeURIComponent(encodedPart);
    var keyVal = part.split('*');
    console.assert(keyVal.length === 2);
    var key = keyVal[0];
    var val = keyVal[1];
    properties[key] = castValue_(key, val);
  }

  return properties;
}

function writeLineStringGeometry_(geometry) {
  if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
    var flatCoordinates = geometry.getFlatCoordinates();
    var stride = geometry.getStride();
    var end = flatCoordinates.length;
    return "l(" + this.encodeCoordinates_(flatCoordinates, stride, 0, end) + ")";
  }

  return null;
}

function writeMultiLineStringGeometry_(geometry) {
  if (geometry instanceof ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_9__["default"]) {
    var ends = geometry.getEnds();
    var lineStringCount = ends.length;
    var flatCoordinates = geometry.getFlatCoordinates();
    var stride = geometry.getStride();
    var offset = 0;
    var textArray = ['L('];

    for (var i = 0; i < lineStringCount; ++i) {
      var end = ends[i];
      var text = this.encodeCoordinates_(flatCoordinates, stride, offset, end);

      if (i !== 0) {
        textArray.push('\'');
      }

      textArray.push(text);
      offset = end;
    }

    textArray.push(')');
    return textArray.join('');
  }

  return null;
}

function writePointGeometry_(geometry) {
  if (geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__["default"]) {
    var flatCoordinates = geometry.getFlatCoordinates();
    var stride = geometry.getStride();
    var end = flatCoordinates.length;
    return "p(" + this.encodeCoordinates_(flatCoordinates, stride, 0, end) + ")";
  }

  return null;
}

function writeMultiPointGeometry_(geometry) {
  if (geometry instanceof ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_10__["default"]) {
    var flatCoordinates = geometry.getFlatCoordinates();
    var stride = geometry.getStride();
    var end = flatCoordinates.length;
    return "P(" + this.encodeCoordinates_(flatCoordinates, stride, 0, end) + ")";
  }

  return null;
}

function encodeRings_(flatCoordinates, stride, offset, ends, textArray) {
  var linearRingCount = ends.length;

  for (var i = 0; i < linearRingCount; ++i) {
    var end = ends[i] - stride;
    var text = this.encodeCoordinates_(flatCoordinates, stride, offset, end);

    if (i !== 0) {
      textArray.push('\'');
    }

    textArray.push(text);
    offset = ends[i];
  }

  return offset;
}

function writePolygonGeometry_(geometry) {
  if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_13__["default"]) {
    var flatCoordinates = geometry.getFlatCoordinates();
    var stride = geometry.getStride();
    var ends = geometry.getEnds();
    var offset = 0;
    var textArray = ['a('];
    encodeRings_.call(this, flatCoordinates, stride, offset, ends, textArray);
    textArray.push(')');
    return textArray.join('');
  }

  return null;
}

function writeMultiPolygonGeometry_(geometry) {
  if (geometry instanceof ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_11__["default"]) {
    var flatCoordinates = geometry.getFlatCoordinates();
    var stride = geometry.getStride();
    var endss = geometry.getEndss();
    var polygonCount = endss.length;
    var offset = 0;
    var textArray = ['A'];

    for (var i = 0; i < polygonCount; ++i) {
      var ends = endss[i];
      textArray.push('(');
      offset = encodeRings_.call(this, flatCoordinates, stride, offset, ends, textArray);
      textArray.push(')');
    }

    return textArray.join('');
  } else {
    throw new Error('Wrong geometry type');
  }
}

/***/ }),

/***/ "./src/format/FeatureHashStyleType.js":
/*!********************************************!*\
  !*** ./src/format/FeatureHashStyleType.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ({
  LINE_STRING: 'LineString',
  POINT: 'Point',
  POLYGON: 'Polygon'
});

/***/ }),

/***/ "./src/format/FeatureProperties.js":
/*!*****************************************!*\
  !*** ./src/format/FeatureProperties.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ({
  ANGLE: 'a',
  COLOR: 'c',
  IS_CIRCLE: 'l',
  IS_RECTANGLE: 'r',
  IS_TEXT: 't',
  NAME: 'n',
  SHOW_LABEL: 'b',
  OPACITY: 'o',
  AZIMUT: 'z',
  SHOW_MEASURE: 'm',
  SIZE: 's',
  STROKE: 'k'
});

/***/ }),

/***/ "./src/format/WFSAttribute.js":
/*!************************************!*\
  !*** ./src/format/WFSAttribute.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_format_Attribute_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/format/Attribute.js */ "./src/format/Attribute.js");
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ngeo_format_XSDAttribute_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/format/XSDAttribute.js */ "./src/format/XSDAttribute.js");




var _default = function () {
  function _default() {}

  var _proto = _default.prototype;

  _proto.read = function read(complexTypeElements) {
    return complexTypeElements.map(this.readFromComplexTypeElement_);
  };

  _proto.readFromComplexTypeElement_ = function readFromComplexTypeElement_(object) {
    var name = object.name;
    var alias = object.alias || null;
    var required = object.minOccurs != '0';
    var attribute = {
      name: name,
      alias: alias,
      required: required
    };
    var type = object.type;

    if (!Object(ngeo_format_Attribute_js__WEBPACK_IMPORTED_MODULE_0__["setGeometryType"])(attribute, type)) {
      if (type === 'gml:TimeInstantType' || type === 'dateTime') {
        attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].DATETIME;
      } else if (type === 'date') {
        attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].DATE;
      } else if (type === 'time') {
        attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].TIME;
      } else if (type === 'decimal' || type === 'double') {
        attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].NUMBER;
        attribute.numType = ngeo_format_XSDAttribute_js__WEBPACK_IMPORTED_MODULE_2__["FormatNumberType"].FLOAT;
      } else if (type === 'integer' || type === 'long') {
        attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].NUMBER;
        attribute.numType = ngeo_format_XSDAttribute_js__WEBPACK_IMPORTED_MODULE_2__["FormatNumberType"].INTEGER;
      } else if (type === 'boolean') {
        attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].BOOLEAN;
      } else {
        attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].TEXT;
      }
    }

    return attribute;
  };

  return _default;
}();



/***/ }),

/***/ "./src/format/XSDAttribute.js":
/*!************************************!*\
  !*** ./src/format/XSDAttribute.js ***!
  \************************************/
/*! exports provided: FormatNumberType, getGeometryAttribute, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormatNumberType", function() { return FormatNumberType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGeometryAttribute", function() { return getGeometryAttribute; });
/* harmony import */ var ngeo_format_Attribute_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/format/Attribute.js */ "./src/format/Attribute.js");
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ol_format_XML_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/format/XML.js */ "./node_modules/ol/format/XML.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }




var FormatNumberType = {
  FLOAT: 'float',
  INTEGER: 'integer'
};

var XSDAttribute = function (_olFormatXML) {
  _inheritsLoose(XSDAttribute, _olFormatXML);

  function XSDAttribute() {
    return _olFormatXML.apply(this, arguments) || this;
  }

  var _proto = XSDAttribute.prototype;

  _proto.read = function read(source) {
    return ol_format_XML_js__WEBPACK_IMPORTED_MODULE_2__["default"].prototype.read.call(this, source);
  };

  _proto.readFromDocument = function readFromDocument(doc) {
    console.assert(doc.nodeType == Node.DOCUMENT_NODE, 'doc.nodeType should be DOCUMENT');
    var n;

    for (n = doc.firstChild; n; n = n.nextSibling) {
      if (n.nodeType == Node.ELEMENT_NODE) {
        if (!(n instanceof Element)) {
          throw new Error('Wrong type');
        }

        return this.readFromNode(n);
      }
    }

    return null;
  };

  _proto.readFromNode = function readFromNode(node) {
    console.assert(node.localName == 'schema', 'localName should be schema');
    var elements = node.getElementsByTagName('element');

    if (!elements.length) {
      elements = node.getElementsByTagName('xsd:element');
    }

    var attributes = [];
    var attribute;

    for (var i = 0, ii = elements.length; i < ii; i++) {
      attribute = this.readFromElementNode_(elements[i]);

      if (attribute) {
        attributes.push(attribute);
      }
    }

    return attributes;
  };

  _proto.readFromElementNode_ = function readFromElementNode_(node) {
    console.assert(node.nodeType == Node.ELEMENT_NODE, 'node.nodeType should be ELEMENT');
    var elementNode = node;
    var name = elementNode.getAttribute('name');

    if (!name) {
      throw new Error('name should be defined in element node');
    }

    var alias = elementNode.getAttribute('alias');
    var nillable = elementNode.getAttribute('nillable');
    var required = nillable !== 'true';
    var readonlyEls = elementNode.getElementsByTagName('readonly');
    var readonly = readonlyEls[0] ? readonlyEls[0].getAttribute('value') === 'true' : false;
    var attribute = {
      name: name,
      readonly: readonly,
      required: required
    };

    if (alias) {
      attribute.alias = alias;
    }

    var type = elementNode.getAttribute('type');

    if (type) {
      if (!Object(ngeo_format_Attribute_js__WEBPACK_IMPORTED_MODULE_0__["setGeometryType"])(attribute, type)) {
        this.setAttributeByXsdType_(attribute, type);
      }
    } else {
      var enumerations = elementNode.getElementsByTagName('enumeration');

      if (!enumerations.length) {
        enumerations = elementNode.getElementsByTagName('xsd:enumeration');
      }

      if (enumerations.length) {
        attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].SELECT;
        var choices = [];

        for (var i = 0, ii = enumerations.length; i < ii; i++) {
          var value = enumerations[i].getAttribute('value');

          if (!value) {
            throw new Error('Missing value');
          }

          choices.push(value);
        }

        attribute.choices = choices;
      } else {
        var restrictions = elementNode.getElementsByTagName('restriction');

        if (!restrictions.length) {
          restrictions = elementNode.getElementsByTagName('xsd:restriction');
        }

        if (restrictions.length && restrictions[0]) {
          var restrictionNode = restrictions[0];
          var base = restrictionNode.getAttribute('base');

          if (!base) {
            throw new Error('Missing base');
          }

          this.setAttributeByXsdType_(attribute, base);
          var maxLengths = elementNode.getElementsByTagName('maxLength');

          if (!maxLengths.length) {
            maxLengths = elementNode.getElementsByTagName('xsd:maxLength');
          }

          if (maxLengths.length && maxLengths[0]) {
            attribute.maxLength = Number(maxLengths[0].getAttribute('value'));
          }
        }
      }
    }

    if (!attribute.type) {
      return null;
    }

    console.assert(attribute.type);
    return attribute;
  };

  _proto.setAttributeByXsdType_ = function setAttributeByXsdType_(attribute, type) {
    if (type === 'xsd:boolean') {
      attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].BOOLEAN;
    } else if (type === 'xsd:date') {
      attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].DATE;
    } else if (type === 'xsd:dateTime') {
      attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].DATETIME;
    } else if (type === 'xsd:time') {
      attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].TIME;
    } else if (type === 'xsd:decimal' || type === 'xsd:double') {
      attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].NUMBER;
      attribute.numType = FormatNumberType.FLOAT;
    } else if (type === 'xsd:integer') {
      attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].NUMBER;
      attribute.numType = FormatNumberType.INTEGER;
    } else if (type === 'xsd:string') {
      attribute.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].TEXT;
    }
  };

  return XSDAttribute;
}(ol_format_XML_js__WEBPACK_IMPORTED_MODULE_2__["default"]);

function getGeometryAttribute(attributes) {
  var geomAttribute = null;

  for (var i = 0, ii = attributes.length; i < ii; i++) {
    if (attributes[i].type === ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_1__["default"].GEOMETRY) {
      geomAttribute = attributes[i];
      break;
    }
  }

  return geomAttribute;
}
/* harmony default export */ __webpack_exports__["default"] = (XSDAttribute);

/***/ }),

/***/ "./src/geolocation/component.js":
/*!**************************************!*\
  !*** ./src/geolocation/component.js ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var ngeo_message_Notification_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/message/Notification.js */ "./src/message/Notification.js");
/* harmony import */ var ol_easing_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/easing.js */ "./node_modules/ol/easing.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_Geolocation_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/Geolocation.js */ "./node_modules/ol/Geolocation.js");
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
Controller.$inject = ["$scope", "$element", "gettextCatalog", "ngeoFeatureOverlayMgr", "ngeoNotification"];










var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoGeolocation', [ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_message_Notification_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
var GeolocationEventType = {
  ERROR: 'geolocation-error'
};

function geolocationComponent() {
  return {
    restrict: 'A',
    scope: {
      'getMapFn': '&ngeoGeolocationMap',
      'getOptionsFn': '&ngeoGeolocationOptions'
    },
    controller: 'ngeoGeolocationController'
  };
}

module.directive('ngeoGeolocation', geolocationComponent);

function Controller($scope, $element, gettextCatalog, ngeoFeatureOverlayMgr, ngeoNotification) {
  var _this = this;

  $element.on('click', this.toggleTracking.bind(this));
  var map = $scope.getMapFn();

  if (!(map instanceof ol_Map_js__WEBPACK_IMPORTED_MODULE_7__["default"])) {
    throw new Error('Wrong map type');
  }

  this.$scope_ = $scope;
  this.map_ = map;
  var options = $scope.getOptionsFn() || {};
  console.assert(options);
  this.notification_ = ngeoNotification;
  this.featureOverlay_ = ngeoFeatureOverlayMgr.getFeatureOverlay();
  this.geolocation_ = new ol_Geolocation_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
    projection: map.getView().getProjection(),
    trackingOptions: {
      enableHighAccuracy: true
    }
  });

  if (options.autorotate) {
    this.autorotateListener();
  }

  this.geolocation_.on('error', function (error) {
    _this.untrack_();

    var msg;

    switch (error.code) {
      case 1:
        msg = gettextCatalog.getString('User denied the request for Geolocation.');
        break;

      case 2:
        msg = gettextCatalog.getString('Location information is unavailable.');
        break;

      case 3:
        msg = gettextCatalog.getString('The request to get user location timed out.');
        break;

      default:
        msg = gettextCatalog.getString('Geolocation: An unknown error occurred.');
        break;
    }

    _this.notification_.error(msg);

    $scope.$emit(GeolocationEventType.ERROR, error);
  });
  this.positionFeature_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_5__["default"]();

  if (options.positionFeatureStyle) {
    this.positionFeature_.setStyle(options.positionFeatureStyle);
  }

  this.accuracyFeature_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_5__["default"]();

  if (options.accuracyFeatureStyle) {
    this.accuracyFeature_.setStyle(options.accuracyFeatureStyle);
  }

  this.zoom_ = options.zoom;
  this.follow_ = false;
  this.viewChangedByMe_ = false;
  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(this.geolocation_, 'change:accuracyGeometry', function () {
    var geometry = _this.geolocation_.getAccuracyGeometry();

    if (!geometry) {
      throw new Error('Missing geometry');
    }

    _this.accuracyFeature_.setGeometry(geometry);

    _this.setPosition_();
  });
  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(this.geolocation_, 'change:position', function () {
    _this.setPosition_();
  });
  var view = map.getView();
  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(view, 'change:center', this.handleViewChange_, this);
  Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(view, 'change:resolution', this.handleViewChange_, this);
}

Controller.prototype.toggleTracking = function () {
  if (this.geolocation_.getTracking()) {
    var currentPosition = this.geolocation_.getPosition();

    if (currentPosition === undefined) {
      this.untrack_();
      this.$scope_.$emit(GeolocationEventType.ERROR, null);
      return;
    }

    console.assert(currentPosition !== undefined);
    var view = this.map_.getView();
    var center = view.getCenter();

    if (!center) {
      throw new Error('Missing center');
    }

    var diff = Math.abs(currentPosition[0] - center[0]) + Math.abs(currentPosition[1] - center[1]);

    if (diff < 2) {
      this.untrack_();
    } else {
      view.setCenter(currentPosition);
      this.untrack_();
      this.track_();
    }
  } else {
    this.track_();
  }
};

Controller.prototype.track_ = function () {
  this.featureOverlay_.addFeature(this.positionFeature_);
  this.featureOverlay_.addFeature(this.accuracyFeature_);
  this.follow_ = true;
  this.geolocation_.setTracking(true);
};

Controller.prototype.untrack_ = function () {
  this.featureOverlay_.clear();
  this.follow_ = false;
  this.geolocation_.setTracking(false);
  this.notification_.clear();
};

Controller.prototype.setPosition_ = function () {
  var view = this.map_.getView();
  var position = this.geolocation_.getPosition();

  if (position === undefined) {
    throw new Error('Missing position');
  }

  var point = new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_8__["default"](position);
  this.positionFeature_.setGeometry(point);
  var accuracy = this.accuracyFeature_.getGeometry();

  if (this.follow_) {
    this.viewChangedByMe_ = true;

    if (this.zoom_ !== undefined) {
      view.setCenter(position);
      view.setZoom(this.zoom_);
    } else if (accuracy instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_9__["default"]) {
      var size = this.map_.getSize();

      if (size === undefined) {
        throw new Error('Missing size');
      }

      view.fit(accuracy, {
        size: size
      });
    }

    this.viewChangedByMe_ = false;
  }
};

Controller.prototype.handleViewChange_ = function (event) {
  if (this.follow_ && !this.viewChangedByMe_) {
    this.follow_ = false;
  }
};

Controller.prototype.autorotateListener = function () {
  var _this2 = this;

  var currentAlpha = 0;

  if (window.hasOwnProperty('ondeviceorientationabsolute')) {
    window.addEventListener('deviceorientationabsolute', function (event) {
      if (!(event instanceof DeviceOrientationEvent)) {
        throw new Error('Wrong event type');
      }

      if (event.alpha !== null) {
        currentAlpha = _this2.handleRotate_(event.alpha, currentAlpha);
      }
    }, true);
  } else if (window.hasOwnProperty('ondeviceorientation')) {
    window.addEventListener('deviceorientation', function (evt) {
      if (evt.webkitCompassHeading) {
        currentAlpha = _this2.handleRotate_(-evt.webkitCompassHeading, currentAlpha);
      } else {
        if (!evt.alpha) {
          throw new Error('Missing evt.alpha');
        }

        currentAlpha = _this2.handleRotate_(evt.alpha - 270, currentAlpha);
      }
    }, true);
  } else {
    console.error('Orientation is not supported on this device');
  }
};

Controller.prototype.handleRotate_ = function (eventAlpha, currentAlpha) {
  if (this.geolocation_.getTracking() && Math.abs(eventAlpha - currentAlpha) > 0.2) {
    currentAlpha = eventAlpha;
    var radAlpha = currentAlpha * Math.PI / 180;
    this.map_.getView().animate({
      rotation: radAlpha,
      duration: 350,
      easing: ol_easing_js__WEBPACK_IMPORTED_MODULE_3__["linear"]
    });
  }

  return currentAlpha;
};

module.controller('ngeoGeolocationController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/grid/Config.js":
/*!****************************!*\
  !*** ./src/grid/Config.js ***!
  \****************************/
/*! exports provided: getRowUid, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getRowUid", function() { return getRowUid; });
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");


function GridConfig(data, columnDefs) {
  this.data = data;
  this.columnDefs = columnDefs;
  this.selectedRows = {};
}

function getRowUid(attributes) {
  return "" + Object(ol_util_js__WEBPACK_IMPORTED_MODULE_0__["getUid"])(attributes);
}

GridConfig.prototype.isRowSelected = function (attributes) {
  return !!this.selectedRows[getRowUid(attributes)];
};

GridConfig.prototype.getSelectedCount = function () {
  return Object.keys(this.selectedRows).length;
};

GridConfig.prototype.getSelectedRows = function () {
  var _this = this;

  if (!this.data) {
    throw new Error('Missing data');
  }

  return this.data.filter(function (row) {
    return _this.isRowSelected(row);
  });
};

GridConfig.prototype.selectRow = function (attributes) {
  var uid = getRowUid(attributes);
  this.selectedRows[uid] = attributes;
};

GridConfig.prototype.toggleRow = function (attributes) {
  var uid = getRowUid(attributes);
  var isSelected = this.isRowSelected(attributes);

  if (isSelected) {
    delete this.selectedRows[uid];
  } else {
    this.selectedRows[uid] = attributes;
  }
};

GridConfig.prototype.selectAll = function () {
  var _this2 = this;

  if (!this.data) {
    throw new Error('Missing data');
  }

  this.data.forEach(function (attributes) {
    _this2.selectRow(attributes);
  });
};

GridConfig.prototype.unselectAll = function () {
  for (var rowId in this.selectedRows) {
    delete this.selectedRows[rowId];
  }
};

GridConfig.prototype.invertSelection = function () {
  var _this3 = this;

  if (!this.data) {
    throw new Error('Missing data');
  }

  this.data.forEach(function (attributes) {
    _this3.toggleRow(attributes);
  });
};

/* harmony default export */ __webpack_exports__["default"] = (GridConfig);

/***/ }),

/***/ "./src/grid/component.html":
/*!*********************************!*\
  !*** ./src/grid/component.html ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="ngeo-grid-table-container">\n  <table float-thead="$ctrl.floatTheadConfig" ng-model="$ctrl.configuration.data"\n         class="table table-bordered table-striped table-hover">\n    <thead class="table-header">\n      <tr>\n        <th ng-repeat="columnDefs in $ctrl.configuration.columnDefs"\n            ng-click="$ctrl.sort(columnDefs.name)" ng-bind-html="columnDefs.name | ngeoTrustHtml | translate">\n          <i ng-show="$ctrl.sortedBy !== columnDefs.name" class="fa fa-fw"></i>\n          <i ng-show="$ctrl.sortedBy === columnDefs.name && $ctrl.sortAscending === true" class="fa fa-caret-up"></i>\n          <i ng-show="$ctrl.sortedBy === columnDefs.name && $ctrl.sortAscending === false" class="fa fa-caret-down"></i>\n        </th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat="attributes in $ctrl.configuration.data"\n          ng-class="[\'row-\' + $ctrl.configuration.getRowUid(attributes), $ctrl.configuration.isRowSelected(attributes) ? \'ngeo-grid-active\': \'\']"\n          ng-click="$ctrl.clickRow(attributes, $event)" ng-mousedown="$ctrl.preventTextSelection($event)">\n        <td ng-repeat="columnDefs in $ctrl.configuration.columnDefs" ng-bind-html="attributes[columnDefs.name] | removeCDATA | ngeoTrustHtmlAuto"></td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./src/grid/component.js":
/*!*******************************!*\
  !*** ./src/grid/component.js ***!
  \*******************************/
/*! exports provided: GridController, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GridController", function() { return GridController; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/filters.js */ "./src/misc/filters.js");
/* harmony import */ var ngeo_grid_Config_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/grid/Config.js */ "./src/grid/Config.js");
/* harmony import */ var ol_has_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/has.js */ "./node_modules/ol/has.js");
/* harmony import */ var floatthead__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! floatthead */ "./node_modules/floatthead/dist/jquery.floatThead.min.js");
/* harmony import */ var floatthead__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(floatthead__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var angular_float_thead__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! angular-float-thead */ "./node_modules/angular-float-thead/angular-floatThead.js");
/* harmony import */ var angular_float_thead__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(angular_float_thead__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/sass/font.scss */ "./src/sass/font.scss");
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_6__);
GridController.$inject = ["$scope"];







var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoGrid', [ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, 'floatThead']);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/grid', __webpack_require__(/*! ./component.html */ "./src/grid/component.html"));
}]);
module.value('ngeoGridTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.ngeoGridTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'ngeo/grid';
});
ngeoGridTemplateUrl.$inject = ["$attrs", "ngeoGridTemplateUrl"];

function ngeoGridTemplateUrl($attrs, ngeoGridTemplateUrl) {
  return ngeoGridTemplateUrl($attrs);
}

var gridComponent = {
  controller: GridController,
  bindings: {
    'configuration': '=ngeoGridConfiguration'
  },
  templateUrl: ngeoGridTemplateUrl
};
module.component('ngeoGrid', gridComponent);
function GridController($scope) {
  this.scope_ = $scope;
  this.configuration = null;
  this.selectedRows = {};
  this.sortedBy = '';
  this.sortAscending = true;
  this.floatTheadConfig = {
    scrollContainer: function scrollContainer($table) {
      return $table.closest('.ngeo-grid-table-container');
    }
  };
}

GridController.prototype.$onInit = function () {
  if (!this.configuration) {
    throw new Error('Missing configuration');
  }

  this.selectedRows = this.configuration.selectedRows;
};

GridController.prototype.sort = function (columnName) {
  if (!this.configuration) {
    throw new Error('Missing configuration');
  }

  if (!this.configuration.data) {
    throw new Error('Missing configuration.data');
  }

  this.sortAscending = this.sortedBy === columnName ? !this.sortAscending : true;
  this.sortedBy = columnName;
  var asc = this.sortAscending ? 1 : -1;
  this.configuration.data.sort(function (attributes1, attributes2) {
    if (!attributes1[columnName]) {
      return 1;
    }

    if (!attributes2[columnName]) {
      return -1;
    }

    return attributes1[columnName] > attributes2[columnName] ? asc : -asc;
  });
};

GridController.prototype.clickRow = function (attributes, event) {
  var shiftKey = isShiftKeyOnly(event);
  var platformModifierKey = isPlatformModifierKeyOnly(event);
  this.clickRow_(attributes, shiftKey, platformModifierKey);
};

GridController.prototype.clickRow_ = function (attributes, shiftKey, platformModifierKey) {
  if (!this.configuration) {
    throw new Error('Missing configuration');
  }

  if (shiftKey && !platformModifierKey) {
    this.selectRange_(attributes);
  } else if (!shiftKey && platformModifierKey) {
    this.configuration.toggleRow(attributes);
  } else {
    var isSelected = this.configuration.isRowSelected(attributes);
    this.configuration.unselectAll();

    if (!isSelected) {
      this.configuration.selectRow(attributes);
    }
  }
};

GridController.prototype.selectRange_ = function (attributes) {
  if (!this.configuration) {
    throw new Error('Missing configuration');
  }

  if (!this.configuration.data) {
    throw new Error('Missing configuration.data');
  }

  var targetUid = Object(ngeo_grid_Config_js__WEBPACK_IMPORTED_MODULE_2__["getRowUid"])(attributes);
  var data = this.configuration.data;

  if (this.configuration.isRowSelected(attributes)) {
    return;
  }

  var posClickedRow = 0;
  var posSelectedRows = [];

  for (var i = 0; i < data.length; i++) {
    var currentRow = data[i];
    var currentUid = Object(ngeo_grid_Config_js__WEBPACK_IMPORTED_MODULE_2__["getRowUid"])(currentRow);

    if (targetUid === currentUid) {
      posClickedRow = i;
    } else if (this.configuration.isRowSelected(currentRow)) {
      posSelectedRows.push(i);
    }
  }

  if (posSelectedRows.length == 0) {
    this.configuration.selectRow(attributes);
  }

  var distance = Infinity;
  var posClosestRow = posSelectedRows[0];

  for (var _i = 0, _posSelectedRows = posSelectedRows; _i < _posSelectedRows.length; _i++) {
    var posSelectedRow = _posSelectedRows[_i];
    var currentPos = posSelectedRow;
    var currentDistance = Math.abs(currentPos - posClickedRow);

    if (distance > currentDistance) {
      distance = currentDistance;
      posClosestRow = currentPos;
    }
  }

  var rangeStart = posClickedRow < posClosestRow ? posClickedRow : posClosestRow;
  var rangeEnd = posClickedRow > posClosestRow ? posClickedRow : posClosestRow;

  for (var l = rangeStart; l <= rangeEnd; l++) {
    this.configuration.selectRow(data[l]);
  }
};

GridController.prototype.preventTextSelection = function (event) {
  var shiftKey = isShiftKeyOnly(event);
  var platformModifierKey = isPlatformModifierKeyOnly(event);

  if (shiftKey || platformModifierKey) {
    event.preventDefault();
  }
};

function isPlatformModifierKeyOnly(event) {
  return !event.altKey && (ol_has_js__WEBPACK_IMPORTED_MODULE_3__["MAC"] ? event.metaKey : event.ctrlKey) && !event.shiftKey;
}

function isShiftKeyOnly(event) {
  return !event.altKey && !(event.metaKey || event.ctrlKey) && event.shiftKey;
}

module.controller('ngeoGridController', GridController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/icons/point.svg?viewbox&height=1em":
/*!************************************************!*\
  !*** ./src/icons/point.svg?viewbox&height=1em ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M7.948 10.25c-1.26.009-2.349-1.23-2.184-2.48.11-1.153 1.218-2.124 2.387-2.013 1.064.06 2.022.956 2.09 2.028.1.975-.492 1.973-1.42 2.31a2.211 2.211 0 01-.873.155zm.047-1.357c.606.03 1.103-.703.827-1.248-.215-.499-.934-.709-1.357-.343-.393.3-.47.941-.11 1.295.16.18.395.295.64.296z\"></path></svg>"

/***/ }),

/***/ "./src/icons/polygon.svg?viewbox&height=1em":
/*!**************************************************!*\
  !*** ./src/icons/polygon.svg?viewbox&height=1em ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M5.045-.029c-1.26-.008-2.35 1.23-2.184 2.48.06.632.43 1.202.936 1.576-.479 1.358-.968 2.714-1.45 4.072-1.257-.008-2.363 1.23-2.2 2.48.105 1.16 1.228 2.13 2.402 2.012a2.295 2.295 0 001.45-.67c1.273.53 2.553 1.056 3.823 1.59a1.992 1.992 0 000 .438c.074 1.165 1.176 2.17 2.355 2.074 1.07-.042 2.057-.932 2.138-2.012a2.295 2.295 0 00-.453-1.607c.435-.593.873-1.186 1.31-1.778.186.04.369.047.562.031 1.067-.047 2.04-.935 2.122-2.012.11-.964-.464-1.959-1.373-2.31a2.202 2.202 0 00-.343-.108 444.27 444.27 0 01-.125-1.857c.743-.313 1.326-1.036 1.388-1.856.11-.964-.463-1.958-1.372-2.309a2.196 2.196 0 00-.92-.172c-.08 0-.158-.008-.235 0-.841.098-1.565.75-1.84 1.545-1.26-.004-2.53-.009-3.791-.016C7.045.918 6.564.361 5.919.127a2.211 2.211 0 00-.874-.156zm.047 1.357c.605-.03 1.103.704.827 1.248-.215.499-.934.71-1.358.343-.392-.299-.47-.94-.109-1.294a.874.874 0 01.64-.297zm8.08.063c.62-.026 1.099.719.796 1.263-.232.498-.967.692-1.373.297-.361-.308-.431-.939-.078-1.28a.899.899 0 01.656-.28zM7.246 2.919c1.257.005 2.517.024 3.775.032a2.333 2.333 0 001.622 1.513c.043.624.084 1.248.125 1.872-.877.376-1.511 1.322-1.388 2.293.042.482.267.94.592 1.295-.416.567-.826 1.136-1.248 1.7a2.045 2.045 0 00-.67-.109v.016c-.632-.012-1.235.287-1.654.748-1.26-.525-2.517-1.063-3.775-1.59.005-.043.013-.083.015-.126a2.274 2.274 0 00-.967-2.074c.472-1.342.944-2.685 1.42-4.025.052 0 .104.005.156 0 .898-.05 1.72-.7 1.997-1.545zm6.38 4.602c.62-.025 1.098.72.796 1.264-.233.497-.967.691-1.373.296-.362-.308-.432-.938-.078-1.279a.899.899 0 01.655-.28zM2.393 9.456c.612-.028 1.109.729.811 1.28-.228.493-.942.68-1.357.311-.377-.3-.46-.926-.11-1.28a.9.9 0 01.656-.311zm7.66 3.432c.615-.037 1.12.711.826 1.263-.217.48-.91.684-1.326.344-.423-.297-.495-.986-.109-1.342a.857.857 0 01.609-.265z\"></path></svg>"

/***/ }),

/***/ "./src/icons/rectangle.svg?viewbox&height=1em":
/*!****************************************************!*\
  !*** ./src/icons/rectangle.svg?viewbox&height=1em ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M2.317 14.491a2.203 2.203 0 01-.874-.156C.257 13.91-.343 12.38.242 11.262a2.265 2.265 0 011.28-1.139l-.016-4.258c-.02-.008-.042-.008-.063-.016C.258 5.424-.343 3.894.243 2.776.74 1.731 2.115 1.194 3.174 1.7c.572.246 1.007.747 1.217 1.326L11.6 3.01c.028-.077.055-.16.093-.234.5-1.045 1.874-1.582 2.933-1.076.979.422 1.584 1.59 1.28 2.62a2.302 2.302 0 01-1.467 1.576l.016 4.228c.057.02.115.035.171.062.979.422 1.584 1.59 1.28 2.621-.24.95-1.151 1.688-2.137 1.685a2.203 2.203 0 01-.874-.156c-.625-.224-1.083-.757-1.295-1.373l-7.207.015c-.302.864-1.151 1.516-2.075 1.513zm-.14-1.357c.508.052 1.045-.42.982-.951-.03-.542-.63-.978-1.154-.78-.472.146-.764.713-.547 1.17.089.223.27.413.5.499a.79.79 0 00.218.062zm11.45 0c.509.052 1.045-.42.982-.951-.03-.542-.63-.978-1.154-.78-.472.146-.764.713-.546 1.17.088.223.27.413.499.499a.79.79 0 00.218.062zM4.39 11.527l7.192-.015c.03-.084.067-.17.109-.25.259-.542.747-.944 1.31-1.139V5.88c-.036-.012-.073-.017-.109-.031-.628-.225-1.085-.768-1.295-1.388H4.407a2.334 2.334 0 01-1.42 1.435l.015 4.227c.056.02.118.037.172.063.576.248 1.009.757 1.217 1.342zm-2.215-6.88c.51.052 1.046-.42.983-.95-.03-.543-.63-.979-1.154-.781-.472.146-.764.714-.547 1.17.089.224.27.414.5.5a.79.79 0 00.218.062zm11.45 0c.51.052 1.046-.42.983-.95-.03-.543-.63-.979-1.154-.781-.472.146-.764.714-.546 1.17.088.224.27.414.499.5a.79.79 0 00.218.062z\"></path></svg>"

/***/ }),

/***/ "./src/icons/swipe.svg?viewbox&height=1em":
/*!************************************************!*\
  !*** ./src/icons/swipe.svg?viewbox&height=1em ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" data-prefix=\"fas\" data-icon=\"sort\" class=\"svg-inline--fa fa-sort fa-w-10\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M9.286 12.783V3.217c0-.86 1.041-1.29 1.648-.683l4.783 4.783a.96.96 0 010 1.362l-4.783 4.787c-.607.607-1.648.177-1.648-.683zM5.066 2.534L.283 7.317a.96.96 0 000 1.362l4.783 4.787c.607.607 1.648.177 1.648-.683V3.217c0-.86-1.041-1.29-1.648-.683z\" fill=\"currentColor\"></path></svg>"

/***/ }),

/***/ "./src/icons/swipe.svg?viewbox&width=1em":
/*!***********************************************!*\
  !*** ./src/icons/swipe.svg?viewbox&width=1em ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" data-prefix=\"fas\" data-icon=\"sort\" class=\"svg-inline--fa fa-sort fa-w-10\" viewBox=\"0 0 16 16\" width=\"1em\" height=\"1em\"><path d=\"M9.286 12.783V3.217c0-.86 1.041-1.29 1.648-.683l4.783 4.783a.96.96 0 010 1.362l-4.783 4.787c-.607.607-1.648.177-1.648-.683zM5.066 2.534L.283 7.317a.96.96 0 000 1.362l4.783 4.787c.607.607 1.648.177 1.648-.683V3.217c0-.86-1.041-1.29-1.648-.683z\" fill=\"currentColor\"></path></svg>"

/***/ }),

/***/ "./src/interaction/DrawAzimut.js":
/*!***************************************!*\
  !*** ./src/interaction/DrawAzimut.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var ngeo_interaction_common_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/interaction/common.js */ "./src/interaction/common.js");
/* harmony import */ var ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/CustomEvent.js */ "./src/CustomEvent.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_functions_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/functions.js */ "./node_modules/ol/functions.js");
/* harmony import */ var ol_geom_Circle_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/geom/Circle.js */ "./node_modules/ol/geom/Circle.js");
/* harmony import */ var ol_geom_GeometryCollection_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/geom/GeometryCollection.js */ "./node_modules/ol/geom/GeometryCollection.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }














var DrawAzimut = function (_olInteractionPointer) {
  _inheritsLoose(DrawAzimut, _olInteractionPointer);

  function DrawAzimut(options) {
    var _this;

    _this = _olInteractionPointer.call(this, {
      type: ''
    }) || this;
    _this.shouldStopEvent = ol_functions_js__WEBPACK_IMPORTED_MODULE_4__["FALSE"];
    _this.downPx_ = [];
    _this.source_ = options.source;
    _this.started_ = false;
    _this.sketchFeature_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]();
    _this.sketchPoint_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]();
    _this.squaredClickTolerance_ = 4;
    _this.sketchLayer_ = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
      source: new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
        useSpatialIndex: false,
        wrapX: false
      }),
      style: options.style || Object(ngeo_interaction_common_js__WEBPACK_IMPORTED_MODULE_0__["getDefaultDrawStyleFunction"])()
    });
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(_assertThisInitialized(_this), 'change:active', _this.updateState_, _assertThisInitialized(_this));
    return _this;
  }

  var _proto = DrawAzimut.prototype;

  _proto.handlePointerMove_ = function handlePointerMove_(event) {
    if (this.started_) {
      this.modifyDrawing_(event);
    } else {
      this.createOrUpdateSketchPoint_(event);
    }

    return true;
  };

  _proto.createOrUpdateSketchPoint_ = function createOrUpdateSketchPoint_(event) {
    var coordinates = event.coordinate.slice();
    var sketchPointGeom = this.sketchPoint_.getGeometry();

    if (!sketchPointGeom) {
      this.sketchPoint_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"](new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_8__["default"](coordinates));
      this.updateSketchFeatures_();
    } else {
      sketchPointGeom.setCoordinates(coordinates);
    }
  };

  _proto.updateSketchFeatures_ = function updateSketchFeatures_() {
    var sketchFeatures = [];
    sketchFeatures.push(this.sketchFeature_);
    sketchFeatures.push(this.sketchPoint_);
    var source = this.sketchLayer_.getSource();
    source.clear(true);
    source.addFeatures(sketchFeatures);
  };

  _proto.startDrawing_ = function startDrawing_(event) {
    var start = event.coordinate;
    this.started_ = true;
    var line = new ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_7__["default"]([start.slice(), start.slice()]);
    var circle = new ol_geom_Circle_js__WEBPACK_IMPORTED_MODULE_5__["default"](start, 0);
    var geometry = new ol_geom_GeometryCollection_js__WEBPACK_IMPORTED_MODULE_6__["default"]([line, circle]);
    this.sketchFeature_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]();
    this.sketchFeature_.setGeometry(geometry);
    this.updateSketchFeatures_();
    var evt = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('drawstart', {
      feature: this.sketchFeature_
    });
    this.dispatchEvent(evt);
  };

  _proto.modifyDrawing_ = function modifyDrawing_(event) {
    var coordinate = event.coordinate;
    var geometry = this.sketchFeature_.getGeometry();

    if (!(geometry instanceof ol_geom_GeometryCollection_js__WEBPACK_IMPORTED_MODULE_6__["default"])) {
      throw new Error('Missing geometry');
    }

    var geometries = geometry.getGeometriesArray();
    var line = geometries[0];

    if (line instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_7__["default"]) {
      var coordinates = line.getCoordinates();
      var sketchPointGeom = this.sketchPoint_.getGeometry();

      if (sketchPointGeom instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
        sketchPointGeom.setCoordinates(coordinate);
        var last = coordinates[coordinates.length - 1];
        last[0] = coordinate[0];
        last[1] = coordinate[1];
        console.assert(line instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_7__["default"]);
        line.setCoordinates(coordinates);
        var circle = geometries[1];

        if (circle instanceof ol_geom_Circle_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
          circle.setRadius(line.getLength());
          this.updateSketchFeatures_();
        }
      }
    }
  };

  _proto.abortDrawing_ = function abortDrawing_() {
    this.started_ = false;
    var sketchFeature = this.sketchFeature_;
    this.sketchFeature_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]();
    this.sketchPoint_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]();
    var source = this.sketchLayer_.getSource();

    if (!(source instanceof ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_11__["default"])) {
      throw new Error('Missing source');
    }

    source.clear(true);
    return sketchFeature;
  };

  _proto.updateState_ = function updateState_() {
    var map = this.getMap();
    var active = this.getActive();

    if (map === null || !active) {
      this.abortDrawing_();
    }

    this.sketchLayer_.setMap(active ? map : null);
  };

  _proto.finishDrawing_ = function finishDrawing_() {
    var sketchFeature = this.abortDrawing_();
    this.source_.addFeature(sketchFeature);
    var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('drawend', {
      feature: this.sketchFeature_
    });
    this.dispatchEvent(event);
  };

  _proto.setMap = function setMap(map) {
    ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_9__["default"].prototype.setMap.call(this, map);
    this.updateState_();
  };

  _proto.handleDownEvent = function handleDownEvent(event) {
    this.downPx_ = event.pixel;
    return true;
  };

  _proto.handleUpEvent = function handleUpEvent(event) {
    if (!this.downPx_) {
      throw new Error('Missing downPx');
    }

    var downPx = this.downPx_;
    var clickPx = event.pixel;
    var dx = downPx[0] - clickPx[0];
    var dy = downPx[1] - clickPx[1];
    var squaredDistance = dx * dx + dy * dy;
    var pass = true;

    if (squaredDistance <= this.squaredClickTolerance_) {
      this.handlePointerMove_(event);

      if (!this.started_) {
        this.startDrawing_(event);
      } else {
        this.finishDrawing_();
      }

      pass = false;
    }

    return pass;
  };

  _proto.handleEvent = function handleEvent(mapBrowserEvent) {
    var pass = true;

    if (mapBrowserEvent.type === 'pointermove') {
      pass = this.handlePointerMove_(mapBrowserEvent);
    } else if (mapBrowserEvent.type === 'dblclick') {
      pass = false;
    }

    return _olInteractionPointer.prototype.handleEvent.call(this, mapBrowserEvent) && pass;
  };

  return DrawAzimut;
}(ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_9__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (DrawAzimut);

/***/ }),

/***/ "./src/interaction/Measure.js":
/*!************************************!*\
  !*** ./src/interaction/Measure.js ***!
  \************************************/
/*! exports provided: getFormattedArea, getFormattedCircleArea, getFormattedLength, getFormattedPoint, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFormattedArea", function() { return getFormattedArea; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFormattedCircleArea", function() { return getFormattedCircleArea; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFormattedLength", function() { return getFormattedLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFormattedPoint", function() { return getFormattedPoint; });
/* harmony import */ var ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/CustomEvent.js */ "./src/CustomEvent.js");
/* harmony import */ var ol_dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/dom.js */ "./node_modules/ol/dom.js");
/* harmony import */ var ol_proj_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/proj.js */ "./node_modules/ol/proj.js");
/* harmony import */ var ol_Overlay_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/Overlay.js */ "./node_modules/ol/Overlay.js");
/* harmony import */ var ol_sphere_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/sphere.js */ "./node_modules/ol/sphere.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_interaction_Interaction_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/interaction/Interaction.js */ "./node_modules/ol/interaction/Interaction.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }















var Measure = function (_olInteractionInterac) {
  _inheritsLoose(Measure, _olInteractionInterac);

  function Measure(options) {
    var _this;

    if (options === void 0) {
      options = {};
    }

    _this = _olInteractionInterac.call(this, {
      handleEvent: handleEvent_
    }) || this;
    _this.helpTooltipElement_ = null;
    _this.helpTooltipOverlay_ = null;
    _this.measureTooltipElement_ = null;
    _this.measureTooltipOverlay_ = null;
    _this.measureTooltipOverlayCoord_ = null;
    _this.sketchFeature = null;
    _this.continueMsg = null;
    _this.decimals = options.decimals;
    _this.precision = options.precision;
    _this.displayHelpTooltip_ = options.displayHelpTooltip !== undefined ? options.displayHelpTooltip : true;
    var startMsg;

    if (options.startMsg !== undefined) {
      startMsg = options.startMsg;
    } else {
      startMsg = document.createElement('span');
      startMsg.textContent = 'Click to start drawing.';
    }

    _this.startMsg = startMsg;
    _this.changeEventKey_ = null;
    _this.postcomposeEventKey_ = null;
    var style = options.style !== undefined ? options.style : [new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
      fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
        color: 'rgba(255, 255, 255, 0.2)'
      })
    }), new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
      stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
        color: 'white',
        width: 5
      })
    }), new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
      stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
        color: '#ffcc33',
        width: 3
      })
    })];
    _this.vectorLayer_ = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
      source: new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_8__["default"](),
      style: style
    });

    var source = _this.vectorLayer_.getSource();

    if (!(source instanceof ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_8__["default"])) {
      throw new Error('Missing source');
    }

    var drawInteraction = _this.createDrawInteraction(options.sketchStyle, source);

    if (!drawInteraction) {
      throw new Error('Missing drawInteraction');
    }

    _this.drawInteraction_ = drawInteraction;
    _this.shouldHandleDrawInteractionActiveChange_ = true;
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(_this.drawInteraction_, 'change:active', _this.handleDrawInteractionActiveChange_, _assertThisInitialized(_this));
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(_this.drawInteraction_, 'drawstart', _this.onDrawStart_, _assertThisInitialized(_this));
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(_this.drawInteraction_, 'drawend', _this.onDrawEnd_, _assertThisInitialized(_this));
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(_assertThisInitialized(_this), 'change:active', _this.updateState_, _assertThisInitialized(_this));
    return _this;
  }

  var _proto = Measure.prototype;

  _proto.getDrawInteraction = function getDrawInteraction() {
    return this.drawInteraction_;
  };

  _proto.createDrawInteraction = function createDrawInteraction(style, source) {
    return null;
  };

  _proto.setMap = function setMap(map) {
    ol_interaction_Interaction_js__WEBPACK_IMPORTED_MODULE_6__["default"].prototype.setMap.call(this, map);
    this.vectorLayer_.setMap(map);
    var prevMap = this.drawInteraction_.getMap();

    if (prevMap !== null) {
      prevMap.removeInteraction(this.drawInteraction_);
    }

    if (map !== null) {
      map.addInteraction(this.drawInteraction_);
    }
  };

  _proto.onDrawStart_ = function onDrawStart_(evt) {
    var _this2 = this;

    this.sketchFeature = evt.feature || evt.detail.feature;
    var source = this.vectorLayer_.getSource();

    if (!(source instanceof ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_8__["default"])) {
      throw new Error('Missing source');
    }

    source.clear(true);
    this.createMeasureTooltip_();

    if (!this.sketchFeature) {
      throw new Error('Missing sketchFeature');
    }

    var geometry = this.sketchFeature.getGeometry();

    if (!geometry) {
      throw new Error('Missing geometry');
    }

    console.assert(geometry !== undefined);
    this.changeEventKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(geometry, 'change', function () {
      _this2.handleMeasure(function (measure, coord) {
        if (coord !== null) {
          if (!_this2.measureTooltipElement_) {
            throw new Error('Missing measureTooltipElement');
          }

          _this2.measureTooltipElement_.innerHTML = measure;
          _this2.measureTooltipOverlayCoord_ = coord;
        }
      });
    });
    this.postcomposeEventKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.getMap(), 'postcompose', function () {
      if (_this2.measureTooltipOverlay_ && _this2.measureTooltipOverlayCoord_) {
        _this2.measureTooltipOverlay_.setPosition(_this2.measureTooltipOverlayCoord_);
      }
    });
  };

  _proto.onDrawEnd_ = function onDrawEnd_(evt) {
    if (!this.measureTooltipElement_) {
      throw new Error('Missing measureTooltipElement');
    }

    if (!this.measureTooltipOverlay_) {
      throw new Error('Missing measureTooltipOverlay');
    }

    if (!this.sketchFeature) {
      throw new Error('Missing sketchFeature');
    }

    this.measureTooltipElement_.classList.add('ngeo-tooltip-static');
    this.measureTooltipOverlay_.setOffset([0, -7]);
    var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__["default"]('measureend', {
      feature: this.sketchFeature
    });
    this.dispatchEvent(event);
    this.sketchFeature = null;
    this.unlistenerEvent_();
  };

  _proto.unlistenerEvent_ = function unlistenerEvent_() {
    if (this.changeEventKey_ !== null && this.postcomposeEventKey_ !== null) {
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["unlistenByKey"])(this.changeEventKey_);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["unlistenByKey"])(this.postcomposeEventKey_);
      this.changeEventKey_ = null;
      this.postcomposeEventKey_ = null;
    }
  };

  _proto.createHelpTooltip_ = function createHelpTooltip_() {
    this.removeHelpTooltip_();

    if (this.displayHelpTooltip_) {
      this.helpTooltipElement_ = document.createElement('div');
      this.helpTooltipElement_.classList.add('tooltip');
      this.helpTooltipOverlay_ = new ol_Overlay_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
        stopEvent: false,
        element: this.helpTooltipElement_,
        offset: [15, 0],
        positioning: 'center-left'
      });
      this.getMap().addOverlay(this.helpTooltipOverlay_);
    }
  };

  _proto.removeHelpTooltip_ = function removeHelpTooltip_() {
    if (this.displayHelpTooltip_) {
      if (this.helpTooltipOverlay_ !== null) {
        this.getMap().removeOverlay(this.helpTooltipOverlay_);
        this.helpTooltipOverlay_ = null;
      }

      if (this.helpTooltipElement_ !== null) {
        if (this.helpTooltipElement_.parentNode) {
          this.helpTooltipElement_.parentNode.removeChild(this.helpTooltipElement_);
        }

        this.helpTooltipElement_ = null;
      }
    }
  };

  _proto.createMeasureTooltip_ = function createMeasureTooltip_() {
    this.removeMeasureTooltip_();
    this.measureTooltipElement_ = document.createElement('div');
    this.measureTooltipElement_.classList.add('tooltip');
    this.measureTooltipElement_.classList.add('ngeo-tooltip-measure');
    this.measureTooltipOverlay_ = new ol_Overlay_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
      element: this.measureTooltipElement_,
      offset: [0, -15],
      positioning: 'bottom-center',
      stopEvent: false
    });
    this.getMap().addOverlay(this.measureTooltipOverlay_);
  };

  _proto.removeMeasureTooltip_ = function removeMeasureTooltip_() {
    if (this.measureTooltipElement_ !== null) {
      if (!this.measureTooltipElement_.parentNode) {
        throw new Error('Missing measureTooltipElement_.parentNode');
      }

      this.measureTooltipElement_.parentNode.removeChild(this.measureTooltipElement_);
      this.measureTooltipElement_ = null;
      this.measureTooltipOverlay_ = null;
      this.measureTooltipOverlayCoord_ = null;
    }
  };

  _proto.updateState_ = function updateState_() {
    var active = this.getActive();
    this.shouldHandleDrawInteractionActiveChange_ = false;
    this.drawInteraction_.setActive(active);
    this.shouldHandleDrawInteractionActiveChange_ = true;

    if (!this.getMap()) {
      return;
    }

    if (active) {
      if (!this.measureTooltipOverlay_) {
        this.createMeasureTooltip_();
        this.createHelpTooltip_();
      }
    } else {
      if (!this.measureTooltipOverlay_) {
        throw new Error('Missing measureTooltipOverlay');
      }

      var source = this.vectorLayer_.getSource();

      if (!(source instanceof ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_8__["default"])) {
        throw new Error('Missing measureTooltipOverlay');
      }

      source.clear(true);
      this.getMap().removeOverlay(this.measureTooltipOverlay_);
      this.removeMeasureTooltip_();
      this.removeHelpTooltip_();
      this.unlistenerEvent_();
    }
  };

  _proto.handleMeasure = function handleMeasure(callback) {};

  _proto.getTooltipElement = function getTooltipElement() {
    if (!this.measureTooltipElement_) {
      throw new Error('Missing measureTooltipElement');
    }

    return this.measureTooltipElement_;
  };

  _proto.handleDrawInteractionActiveChange_ = function handleDrawInteractionActiveChange_() {
    if (this.shouldHandleDrawInteractionActiveChange_) {
      this.setActive(this.drawInteraction_.getActive());
    }
  };

  return Measure;
}(ol_interaction_Interaction_js__WEBPACK_IMPORTED_MODULE_6__["default"]);

function getFormattedArea(polygon, projection, precision, format) {
  var geom = polygon.clone().transform(projection, 'EPSG:4326');
  var area = Math.abs(ol_sphere_js__WEBPACK_IMPORTED_MODULE_4__["getArea"](geom, {
    'projection': 'EPSG:4326'
  }));
  return format(area, 'm²', 'square', precision);
}
function getFormattedCircleArea(circle, precision, format) {
  var area = Math.PI * Math.pow(circle.getRadius(), 2);
  return format(area, 'm²', 'square', precision);
}
function getFormattedLength(lineString, projection, precision, format) {
  var length = 0;
  var coordinates = lineString.getCoordinates();

  for (var i = 0, ii = coordinates.length - 1; i < ii; ++i) {
    var c1 = ol_proj_js__WEBPACK_IMPORTED_MODULE_2__["transform"](coordinates[i], projection, 'EPSG:4326');
    var c2 = ol_proj_js__WEBPACK_IMPORTED_MODULE_2__["transform"](coordinates[i + 1], projection, 'EPSG:4326');
    length += ol_sphere_js__WEBPACK_IMPORTED_MODULE_4__["getDistance"](c1, c2);
  }

  return format(length, 'm', 'unit', precision);
}
function getFormattedPoint(point, decimals, format, opt_template) {
  return format(point.getCoordinates(), decimals, opt_template);
}

function handleEvent_(evt) {
  if (evt.type != 'pointermove' || evt.dragging) {
    return true;
  }

  var helpMsg = this.sketchFeature === null ? this.startMsg : this.continueMsg;

  if (this.displayHelpTooltip_ && helpMsg) {
    if (!this.helpTooltipElement_) {
      throw new Error('Missing helpTooltipElement');
    }

    if (!this.helpTooltipOverlay_) {
      throw new Error('Missing helpTooltipOverlay');
    }

    ol_dom_js__WEBPACK_IMPORTED_MODULE_1__["removeChildren"](this.helpTooltipElement_);
    this.helpTooltipElement_.appendChild(helpMsg);
    this.helpTooltipOverlay_.setPosition(evt.coordinate);
  }

  return true;
}

/* harmony default export */ __webpack_exports__["default"] = (Measure);

/***/ }),

/***/ "./src/interaction/MeasureArea.js":
/*!****************************************!*\
  !*** ./src/interaction/MeasureArea.js ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/interaction/Measure.js */ "./src/interaction/Measure.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





var _default = function (_ngeoInteractionMeasu) {
  _inheritsLoose(_default, _ngeoInteractionMeasu);

  function _default(format, gettextCatalog, options) {
    var _this;

    if (options === void 0) {
      options = {};
    }

    _this = _ngeoInteractionMeasu.call(this, options) || this;
    var continueMsg;

    if (options.continueMsg !== undefined) {
      continueMsg = options.continueMsg;
    } else {
      continueMsg = document.createElement('span');
      continueMsg.textContent = gettextCatalog.getString('Click to continue drawing the polygon.');
      var br = document.createElement('br');
      br.textContent = gettextCatalog.getString('Double-click or click starting point to finish.');
      continueMsg.appendChild(br);
    }

    _this.continueMsg = continueMsg;
    _this.format = format;
    return _this;
  }

  var _proto = _default.prototype;

  _proto.createDrawInteraction = function createDrawInteraction(style, source) {
    return new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_1__["default"]({
      type: 'Polygon',
      source: source,
      style: style
    });
  };

  _proto.handleMeasure = function handleMeasure(callback) {
    if (!this.sketchFeature) {
      throw new Error('Missing sketchFeature');
    }

    var geom = this.sketchFeature.getGeometry();

    if (!(geom instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_2__["default"])) {
      throw new Error('Missing geometry');
    }

    var proj = this.getMap().getView().getProjection();
    console.assert(proj);
    var output = Object(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_0__["getFormattedArea"])(geom, proj, this.precision, this.format);
    var verticesCount = geom.getCoordinates()[0].length;
    var coord = null;

    if (verticesCount > 3) {
      coord = geom.getInteriorPoint().getCoordinates();
    }

    callback(output, coord);
  };

  return _default;
}(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/interaction/MeasureAzimut.js":
/*!******************************************!*\
  !*** ./src/interaction/MeasureAzimut.js ***!
  \******************************************/
/*! exports provided: default, getAzimut, getFormattedAzimutRadius */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAzimut", function() { return getAzimut; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFormattedAzimutRadius", function() { return getFormattedAzimutRadius; });
/* harmony import */ var ngeo_interaction_DrawAzimut_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/interaction/DrawAzimut.js */ "./src/interaction/DrawAzimut.js");
/* harmony import */ var ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/interaction/Measure.js */ "./src/interaction/Measure.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_GeometryCollection_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/geom/GeometryCollection.js */ "./node_modules/ol/geom/GeometryCollection.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }






var _default = function (_ngeoInteractionMeasu) {
  _inheritsLoose(_default, _ngeoInteractionMeasu);

  function _default(unitPrefixFormat, numberFormat, options) {
    var _this;

    if (options === void 0) {
      options = {};
    }

    _this = _ngeoInteractionMeasu.call(this, options) || this;
    var continueMsg;

    if (options.continueMsg !== undefined) {
      continueMsg = options.continueMsg;
    } else {
      continueMsg = document.createElement('span');
      continueMsg.textContent = 'Click to finish.';
    }

    _this.continueMsg = continueMsg;
    _this.numberFormat = numberFormat;
    _this.unitPrefixFormat = unitPrefixFormat;
    return _this;
  }

  var _proto = _default.prototype;

  _proto.createDrawInteraction = function createDrawInteraction(style, source) {
    return new ngeo_interaction_DrawAzimut_js__WEBPACK_IMPORTED_MODULE_0__["default"]({
      source: source,
      style: style
    });
  };

  _proto.handleMeasure = function handleMeasure(callback) {
    if (!this.sketchFeature) {
      throw new Error('Missing sketchFeature');
    }

    var geom = this.sketchFeature.getGeometry();

    if (!(geom instanceof ol_geom_GeometryCollection_js__WEBPACK_IMPORTED_MODULE_3__["default"])) {
      throw new Error('Missing geometry');
    }

    var line = geom.getGeometries()[0];

    if (!(line instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_2__["default"])) {
      throw new Error('Missing line');
    }

    var output = getFormattedAzimutRadius(line, this.getMap().getView().getProjection(), this.decimals, this.precision, this.unitPrefixFormat, this.numberFormat);
    callback(output, line.getLastCoordinate());
  };

  return _default;
}(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_1__["default"]);


function getAzimut(line) {
  var coords = line.getCoordinates();
  var dx = coords[1][0] - coords[0][0];
  var dy = coords[1][1] - coords[0][1];
  var rad = Math.acos(dy / Math.sqrt(dx * dx + dy * dy));
  var factor = dx > 0 ? 1 : -1;
  return factor * rad * 180 / Math.PI % 360;
}

function getFormattedAzimut(line, decimals, format) {
  var azimut = getAzimut(line);
  return format(azimut, decimals) + "\xB0";
}

function getFormattedAzimutRadius(line, projection, decimals, precision, formatLength, formatAzimut) {
  var output = getFormattedAzimut(line, decimals, formatAzimut);
  output += ", " + Object(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_1__["getFormattedLength"])(line, projection, precision, formatLength);
  return output;
}

/***/ }),

/***/ "./src/interaction/MeasureLength.js":
/*!******************************************!*\
  !*** ./src/interaction/MeasureLength.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/interaction/Measure.js */ "./src/interaction/Measure.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_coordinate_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/coordinate.js */ "./node_modules/ol/coordinate.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }






var modifierPressed;

var _default = function (_ngeoInteractionMeasu) {
  _inheritsLoose(_default, _ngeoInteractionMeasu);

  function _default(format, gettextCatalog, options) {
    var _this;

    if (options === void 0) {
      options = {};
    }

    _this = _ngeoInteractionMeasu.call(this, options) || this;

    if (modifierPressed === undefined) {
      modifierPressed = false;
      document.body.addEventListener('keydown', function (evt) {
        modifierPressed = evt.keyCode === 17;
      });
      document.body.addEventListener('keyup', function () {
        modifierPressed = false;
      });
    }

    if (options.continueMsg !== undefined) {
      _this.continueMsg = options.continueMsg;
    } else {
      _this.continueMsg = document.createElement('span');
      _this.continueMsg.textContent = gettextCatalog.getString('Click to continue drawing the line.');
      var br = document.createElement('br');
      br.textContent = gettextCatalog.getString('Double-click or click last point to finish.');

      _this.continueMsg.appendChild(br);
    }

    _this.format = format;
    _this.tolerance = options.tolerance;
    _this.source = options.source;
    return _this;
  }

  var _proto = _default.prototype;

  _proto.createDrawInteraction = function createDrawInteraction(style, source) {
    var _this2 = this;

    return new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_1__["default"]({
      type: 'LineString',
      geometryFunction: function geometryFunction(coordinates, opt_geometry) {
        return _this2.linestringGeometryFunction(coordinates, opt_geometry);
      },
      condition: function condition() {
        return true;
      },
      style: style,
      source: source
    });
  };

  _proto.linestringGeometryFunction = function linestringGeometryFunction(coordinates, opt_geometry) {
    var _this3 = this;

    if (modifierPressed) {
      var viewRotation = this.getMap().getView().getRotation();
      var angle = Math.PI / 4;
      var from = coordinates[coordinates.length - 2];
      var to = coordinates[coordinates.length - 1];
      var dx = from[0] - to[0];
      var dy = from[1] - to[1];
      var length = Object(ol_coordinate_js__WEBPACK_IMPORTED_MODULE_3__["distance"])(from, to);
      var rotation = viewRotation + Math.round((Math.atan2(dy, dx) - viewRotation) / angle) * angle;
      to[0] = from[0] - length * Math.cos(rotation);
      to[1] = from[1] - length * Math.sin(rotation);

      if (this.tolerance !== undefined && this.source !== undefined) {
        var view = this.getMap().getView();

        if (!view) {
          throw new Error('Missing view');
        }

        var resolution = view.getResolution();

        if (!resolution) {
          throw new Error('Missing resolution');
        }

        var delta = resolution * this.tolerance;
        var bbox = [to[0] - delta, to[1] - delta, to[0] + delta, to[1] + delta];
        var layerSource = this.source;
        var featuresInExtent = layerSource.getFeaturesInExtent(bbox);
        featuresInExtent.forEach(function (feature) {
          var lastIntersection = [];
          var bestIntersection = [];
          var bestDistance = Infinity;
          var distanceFromTo = Object(ol_coordinate_js__WEBPACK_IMPORTED_MODULE_3__["distance"])(from, to);
          var ax = from[0];
          var ay = from[1];
          var mx = to[0];
          var my = to[1];
          var unitVector = [(mx - ax) / distanceFromTo, (my - ay) / distanceFromTo];
          var b = [ax + (distanceFromTo + delta) * unitVector[0], ay + (distanceFromTo + delta) * unitVector[1]];
          var geom = feature.getGeometry();

          if (!(geom instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_2__["default"])) {
            throw new Error('Wrong geometry type');
          }

          geom.forEachSegment(function (point1, point2) {
            lastIntersection = _this3.computeLineSegmentIntersection([from, b], [point1, point2]);

            if (lastIntersection !== undefined && Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_4__["containsXY"])(bbox, lastIntersection[0], lastIntersection[1])) {
              var lastDistance = Object(ol_coordinate_js__WEBPACK_IMPORTED_MODULE_3__["distance"])(to, lastIntersection);

              if (lastDistance < bestDistance) {
                bestDistance = lastDistance;
                bestIntersection = lastIntersection;
              }
            }
          });

          if (bestIntersection) {
            to[0] = bestIntersection[0] || to[0];
            to[1] = bestIntersection[1] || to[1];
          }
        });
      }
    }

    var geometry = opt_geometry;

    if (geometry) {
      geometry.setCoordinates(coordinates);
      return geometry;
    }

    return new ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_2__["default"](coordinates);
  };

  _proto.handleMeasure = function handleMeasure(callback) {
    if (!this.sketchFeature) {
      throw new Error('Missing sketchFeature');
    }

    var geom = this.sketchFeature.getGeometry();

    if (!(geom instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_2__["default"])) {
      throw new Error('Wrong geometry type');
    }

    var proj = this.getMap().getView().getProjection();
    console.assert(proj);
    var output = Object(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_0__["getFormattedLength"])(geom, proj, this.precision, this.format);
    var coord = geom.getLastCoordinate();
    callback(output, coord);
  };

  _proto.computeLineSegmentIntersection = function computeLineSegmentIntersection(line1, line2) {
    var numerator1A = (line2[1][0] - line2[0][0]) * (line1[0][1] - line2[0][1]) - (line2[1][1] - line2[0][1]) * (line1[0][0] - line2[0][0]);
    var numerator1B = (line1[1][0] - line1[0][0]) * (line1[0][1] - line2[0][1]) - (line1[1][1] - line1[0][1]) * (line1[0][0] - line2[0][0]);
    var denominator1 = (line2[1][1] - line2[0][1]) * (line1[1][0] - line1[0][0]) - (line2[1][0] - line2[0][0]) * (line1[1][1] - line1[0][1]);

    if (denominator1 === 0) {
      return;
    }

    var ua1 = numerator1A / denominator1;
    var ub1 = numerator1B / denominator1;

    if (ua1 >= 0 && ua1 <= 1 && ub1 >= 0 && ub1 <= 1) {
      var result = [];
      result[0] = line1[0][0] + ua1 * (line1[1][0] - line1[0][0]);
      result[1] = line1[0][1] + ua1 * (line1[1][1] - line1[0][1]);
      return result;
    }
  };

  return _default;
}(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/interaction/Modify.js":
/*!***********************************!*\
  !*** ./src/interaction/Modify.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
/* harmony import */ var ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/format/FeatureProperties.js */ "./src/format/FeatureProperties.js");
/* harmony import */ var ngeo_interaction_ModifyCircle_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/interaction/ModifyCircle.js */ "./src/interaction/ModifyCircle.js");
/* harmony import */ var ngeo_interaction_ModifyRectangle_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/interaction/ModifyRectangle.js */ "./src/interaction/ModifyRectangle.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_functions_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/functions.js */ "./node_modules/ol/functions.js");
/* harmony import */ var ol_interaction_Interaction_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/interaction/Interaction.js */ "./node_modules/ol/interaction/Interaction.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
/* harmony import */ var ol_interaction_Modify_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/interaction/Modify.js */ "./node_modules/ol/interaction/Modify.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }













var _default = function (_olInteractionInterac) {
  _inheritsLoose(_default, _olInteractionInterac);

  function _default(options) {
    var _this;

    _this = _olInteractionInterac.call(this, {
      handleEvent: ol_functions_js__WEBPACK_IMPORTED_MODULE_5__["TRUE"]
    }) || this;
    console.assert(options.features);
    _this.features_ = options.features;
    _this.listenerKeys_ = [];
    _this.interactions_ = [];
    _this.otherFeatures_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__["default"]();

    _this.interactions_.push(new ol_interaction_Modify_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
      deleteCondition: ngeo_utils_js__WEBPACK_IMPORTED_MODULE_0__["deleteCondition"],
      features: _this.otherFeatures_,
      pixelTolerance: options.pixelTolerance,
      style: options.style,
      wrapX: options.wrapX
    }));

    _this.circleFeatures_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__["default"]();

    _this.interactions_.push(new ngeo_interaction_ModifyCircle_js__WEBPACK_IMPORTED_MODULE_2__["default"]({
      features: _this.circleFeatures_,
      pixelTolerance: options.pixelTolerance,
      style: options.style,
      wrapX: options.wrapX
    }));

    _this.rectangleFeatures_ = new ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__["default"]();

    _this.interactions_.push(new ngeo_interaction_ModifyRectangle_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
      features: _this.rectangleFeatures_,
      pixelTolerance: options.pixelTolerance,
      style: options.style,
      wrapX: options.wrapX
    }));

    return _this;
  }

  var _proto = _default.prototype;

  _proto.setActive = function setActive(active) {
    _olInteractionInterac.prototype.setActive.call(this, active);

    this.setState_();
  };

  _proto.setMap = function setMap(map) {
    var interactions = this.interactions_;
    var currentMap = this.getMap();

    if (currentMap) {
      interactions.forEach(function (interaction) {
        currentMap.removeInteraction(interaction);
      });
    }

    _olInteractionInterac.prototype.setMap.call(this, map);

    if (map) {
      interactions.forEach(function (interaction) {
        map.addInteraction(interaction);
      });
    }

    this.setState_();
  };

  _proto.setState_ = function setState_() {
    var _this2 = this;

    var map = this.getMap();

    if (!map) {
      return;
    }

    var active = this.getActive();
    var interactions = this.interactions_;
    var keys = this.listenerKeys_;
    interactions.forEach(function (interaction) {
      interaction.setActive(active && !!map);
    });

    if (active && map) {
      this.features_.forEach(function (feature) {
        return _this2.addFeature_(feature);
      });
      keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(this.features_, 'add', this.handleFeaturesAdd_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(this.features_, 'remove', this.handleFeaturesRemove_, this));
    } else {
      keys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["unlistenByKey"]);
      keys.length = 0;
      this.features_.forEach(function (feature) {
        return _this2.removeFeature_(feature);
      });
    }
  };

  _proto.handleFeaturesAdd_ = function handleFeaturesAdd_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__["CollectionEvent"]) {
      var feature = evt.element;
      console.assert(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_9__["default"], 'feature should be an ol.Feature');
      this.addFeature_(feature);
    }
  };

  _proto.handleFeaturesRemove_ = function handleFeaturesRemove_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_7__["CollectionEvent"]) {
      var feature = evt.element;
      this.removeFeature_(feature);
    }
  };

  _proto.addFeature_ = function addFeature_(feature) {
    var collection = this.getFeatureCollection_(feature);
    collection.push(feature);
  };

  _proto.removeFeature_ = function removeFeature_(feature) {
    var collection = this.getFeatureCollection_(feature);
    collection.remove(feature);
  };

  _proto.getFeatureCollection_ = function getFeatureCollection_(feature) {
    var features;
    var isCircle = feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_1__["default"].IS_CIRCLE);
    var isRectangle = feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_1__["default"].IS_RECTANGLE);

    if (isCircle === true || isCircle === 'true') {
      features = this.circleFeatures_;
    } else if (isRectangle === true || isRectangle === 'true') {
      features = this.rectangleFeatures_;
    } else {
      features = this.otherFeatures_;
    }

    return features;
  };

  return _default;
}(ol_interaction_Interaction_js__WEBPACK_IMPORTED_MODULE_6__["default"]);



/***/ }),

/***/ "./src/interaction/ModifyCircle.js":
/*!*****************************************!*\
  !*** ./src/interaction/ModifyCircle.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/CustomEvent.js */ "./src/CustomEvent.js");
/* harmony import */ var ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/format/FeatureProperties.js */ "./src/format/FeatureProperties.js");
/* harmony import */ var ngeo_interaction_common_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/interaction/common.js */ "./src/interaction/common.js");
/* harmony import */ var ngeo_interaction_MeasureAzimut_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/interaction/MeasureAzimut.js */ "./src/interaction/MeasureAzimut.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_MapBrowserPointerEvent_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/MapBrowserPointerEvent.js */ "./node_modules/ol/MapBrowserPointerEvent.js");
/* harmony import */ var ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/coordinate.js */ "./node_modules/ol/coordinate.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_geom_Circle_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/geom/Circle.js */ "./node_modules/ol/geom/Circle.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
/* harmony import */ var ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ol/interaction/Pointer.js */ "./node_modules/ol/interaction/Pointer.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
/* harmony import */ var ol_structs_RBush_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/structs/RBush.js */ "./node_modules/ol/structs/RBush.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





















var _default = function (_olInteractionPointer) {
  _inheritsLoose(_default, _olInteractionPointer);

  function _default(options) {
    var _this;

    _this = _olInteractionPointer.call(this) || this;
    _this.handleDownEvent = _this.handleDownEvent_;
    _this.handleDragEvent = _this.handleDragEvent_;
    _this.handleEvent = _this.handleEvent;
    _this.handleUpEvent = _this.handleUpEvent_;
    console.assert(options.features);
    _this.vertexFeature_ = null;
    _this.lastPixel_ = [0, 0];
    _this.modified_ = false;
    _this.rBush_ = new ol_structs_RBush_js__WEBPACK_IMPORTED_MODULE_17__["default"]();
    _this.pixelTolerance_ = options.pixelTolerance !== undefined ? options.pixelTolerance : 10;
    _this.snappedToVertex_ = false;
    _this.changingFeature_ = false;
    _this.dragSegments_ = [];
    _this.overlay_ = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_15__["default"]({
      source: new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_16__["default"]({
        useSpatialIndex: false,
        wrapX: !!options.wrapX
      }),
      style: options.style || Object(ngeo_interaction_common_js__WEBPACK_IMPORTED_MODULE_2__["getDefaultModifyStyleFunction"])(),
      updateWhileAnimating: true,
      updateWhileInteracting: true
    });
    _this.features_ = options.features;

    _this.features_.forEach(function (feature) {
      return _this.addFeature_(feature);
    });

    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_8__["listen"])(_this.features_, 'add', _this.handleFeatureAdd_, _assertThisInitialized(_this));
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_8__["listen"])(_this.features_, 'remove', _this.handleFeatureRemove_, _assertThisInitialized(_this));
    return _this;
  }

  var _proto = _default.prototype;

  _proto.addFeature_ = function addFeature_(feature) {
    var geometry = feature.getGeometry();

    if (!geometry) {
      throw new Error('Missing geometry');
    }

    if (geometry.getType() === 'Polygon' && !!feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_1__["default"].IS_CIRCLE)) {
      var _geometry = feature.getGeometry();

      this.writeCircleGeometry_(feature, _geometry);
      var map = this.getMap();

      if (map) {
        this.handlePointerAtPixel_(this.lastPixel_, map);
      }
    }
  };

  _proto.willModifyFeatures_ = function willModifyFeatures_(evt) {
    if (!this.modified_) {
      this.modified_ = true;
      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__["default"]('modifystart', {
        features: this.features_
      });
      this.dispatchEvent(event);
    }
  };

  _proto.removeFeature_ = function removeFeature_(feature) {
    this.removeFeatureSegmentData_(feature);

    if (this.vertexFeature_ && this.features_.getLength() === 0) {
      this.overlay_.getSource().removeFeature(this.vertexFeature_);
      this.vertexFeature_ = null;
    }
  };

  _proto.removeFeatureSegmentData_ = function removeFeatureSegmentData_(feature) {
    var rBush = this.rBush_;
    var nodesToRemove = [];
    rBush.forEach(function (node) {
      if (feature === node.feature) {
        nodesToRemove.push(node);
      }
    });

    for (var i = nodesToRemove.length - 1; i >= 0; --i) {
      rBush.remove(nodesToRemove[i]);
    }
  };

  _proto.setMap = function setMap(map) {
    this.overlay_.setMap(map);

    _olInteractionPointer.prototype.setMap.call(this, map);
  };

  _proto.handleFeatureAdd_ = function handleFeatureAdd_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_18__["CollectionEvent"]) {
      var feature = evt.element;
      console.assert(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_5__["default"], 'feature should be an ol.Feature');
      this.addFeature_(feature);
    }
  };

  _proto.handleFeatureRemove_ = function handleFeatureRemove_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_18__["CollectionEvent"]) {
      var feature = evt.element;
      this.removeFeature_(feature);
    }
  };

  _proto.writeCircleGeometry_ = function writeCircleGeometry_(feature, geometry) {
    var rings = geometry.getCoordinates();
    var coordinates, i, ii, j, jj, segment, segmentData;

    for (j = 0, jj = rings.length; j < jj; ++j) {
      coordinates = rings[j];

      for (i = 0, ii = coordinates.length - 1; i < ii; ++i) {
        segment = coordinates.slice(i, i + 2);
        segmentData = {
          feature: feature,
          geometry: geometry,
          depth: [j],
          index: i,
          segment: segment
        };
        this.rBush_.insert(ol_extent_js__WEBPACK_IMPORTED_MODULE_9__["boundingExtent"](segment), segmentData);
      }
    }
  };

  _proto.createOrUpdateVertexFeature_ = function createOrUpdateVertexFeature_(coordinates) {
    var vertexFeature = this.vertexFeature_;

    if (!vertexFeature) {
      vertexFeature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_5__["default"](new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__["default"](coordinates));
      this.vertexFeature_ = vertexFeature;
      this.overlay_.getSource().addFeature(vertexFeature);
    } else {
      var geometry = vertexFeature.getGeometry();

      if (!(geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__["default"])) {
        throw new Error('Wrong geometry type');
      }

      geometry.setCoordinates(coordinates);
    }

    return vertexFeature;
  };

  _proto.handlePointerMove_ = function handlePointerMove_(evt) {
    this.lastPixel_ = evt.pixel;
    this.handlePointerAtPixel_(evt.pixel, evt.map);
  };

  _proto.handlePointerAtPixel_ = function handlePointerAtPixel_(pixel, map) {
    var pixelCoordinate = map.getCoordinateFromPixel(pixel);

    var sortByDistance = function sortByDistance(a, b) {
      return ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["squaredDistanceToSegment"](pixelCoordinate, a.segment) - ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["squaredDistanceToSegment"](pixelCoordinate, b.segment);
    };

    var lowerLeft = map.getCoordinateFromPixel([pixel[0] - this.pixelTolerance_, pixel[1] + this.pixelTolerance_]);
    var upperRight = map.getCoordinateFromPixel([pixel[0] + this.pixelTolerance_, pixel[1] - this.pixelTolerance_]);
    var box = ol_extent_js__WEBPACK_IMPORTED_MODULE_9__["boundingExtent"]([lowerLeft, upperRight]);
    var nodes = this.rBush_.getInExtent(box);

    if (nodes.length > 0) {
      nodes.sort(sortByDistance);
      var node = nodes[0];
      var closestSegment = node.segment;
      var vertex = ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["closestOnSegment"](pixelCoordinate, closestSegment);
      var vertexPixel = map.getPixelFromCoordinate(vertex);

      if (Math.sqrt(ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["squaredDistance"](pixel, vertexPixel)) <= this.pixelTolerance_) {
        var pixel1 = map.getPixelFromCoordinate(closestSegment[0]);
        var pixel2 = map.getPixelFromCoordinate(closestSegment[1]);
        var squaredDist1 = ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["squaredDistance"](vertexPixel, pixel1);
        var squaredDist2 = ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["squaredDistance"](vertexPixel, pixel2);
        var dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));
        this.snappedToVertex_ = dist <= this.pixelTolerance_;

        if (this.snappedToVertex_) {
          vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];
          this.createOrUpdateVertexFeature_(vertex);
          var vertexSegments = {};
          vertexSegments[Object(ol_util_js__WEBPACK_IMPORTED_MODULE_4__["getUid"])(closestSegment)] = true;
          var segment;

          for (var i = 1, ii = nodes.length; i < ii; ++i) {
            segment = nodes[i].segment;

            if (ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["equals"](closestSegment[0], segment[0]) && ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["equals"](closestSegment[1], segment[1]) || ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["equals"](closestSegment[0], segment[1]) && ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["equals"](closestSegment[1], segment[0])) {
              vertexSegments[Object(ol_util_js__WEBPACK_IMPORTED_MODULE_4__["getUid"])(segment)] = true;
            } else {
              break;
            }
          }

          return;
        }
      }
    }

    if (this.vertexFeature_) {
      this.overlay_.getSource().removeFeature(this.vertexFeature_);
      this.vertexFeature_ = null;
    }
  };

  _proto.setGeometryCoordinates_ = function setGeometryCoordinates_(geometry, coordinates) {
    this.changingFeature_ = true;
    geometry.setCoordinates(coordinates);
    this.changingFeature_ = false;
  };

  _proto.handleDownEvent_ = function handleDownEvent_(evt) {
    this.handlePointerAtPixel_(evt.pixel, evt.map);
    this.dragSegments_ = [];
    this.modified_ = false;
    var vertexFeature = this.vertexFeature_;

    if (vertexFeature) {
      var geometry = vertexFeature.getGeometry();

      if (!(geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_12__["default"])) {
        throw new Error('Wrong geometry type');
      }

      var vertex = geometry.getCoordinates();
      var vertexExtent = ol_extent_js__WEBPACK_IMPORTED_MODULE_9__["boundingExtent"]([vertex]);
      var segmentDataMatches = this.rBush_.getInExtent(vertexExtent);
      var componentSegments = {};
      segmentDataMatches.sort(compareIndexes);

      for (var i = 0, ii = segmentDataMatches.length; i < ii; ++i) {
        var segmentDataMatch = segmentDataMatches[i];
        var segment = segmentDataMatch.segment;
        var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_4__["getUid"])(segmentDataMatch.feature);
        var depth = segmentDataMatch.depth;

        if (depth) {
          uid += "-" + depth.join('-');
        }

        if (!componentSegments[uid]) {
          componentSegments[uid] = new Array(2);
        }

        if (ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["equals"](segment[0], vertex) && !componentSegments[uid][0]) {
          this.dragSegments_.push([segmentDataMatch, 0]);
          componentSegments[uid][0] = segmentDataMatch;
        } else if (ol_coordinate_js__WEBPACK_IMPORTED_MODULE_7__["equals"](segment[1], vertex) && !componentSegments[uid][1]) {
          this.dragSegments_.push([segmentDataMatch, 1]);
          componentSegments[uid][1] = segmentDataMatch;
        }
      }
    }

    return !!this.vertexFeature_;
  };

  _proto.handleDragEvent_ = function handleDragEvent_(evt) {
    this.willModifyFeatures_(evt);
    var vertex = evt.coordinate;
    var geometry = this.dragSegments_[0][0].geometry;
    var center = ol_extent_js__WEBPACK_IMPORTED_MODULE_9__["getCenter"](geometry.getExtent());
    var line = new ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_11__["default"]([center, vertex]);
    var circle = new ol_geom_Circle_js__WEBPACK_IMPORTED_MODULE_10__["default"](center, line.getLength());
    var coordinates = Object(ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_13__["fromCircle"])(circle, 64).getCoordinates();
    this.setGeometryCoordinates_(geometry, coordinates);
    var azimut = Object(ngeo_interaction_MeasureAzimut_js__WEBPACK_IMPORTED_MODULE_3__["getAzimut"])(line);
    this.features_.getArray()[0].set(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_1__["default"].AZIMUT, azimut);
    this.createOrUpdateVertexFeature_(vertex);
  };

  _proto.handleUpEvent_ = function handleUpEvent_(evt) {
    this.rBush_.clear();
    this.writeCircleGeometry_(this.dragSegments_[0][0].feature, this.dragSegments_[0][0].geometry);

    if (this.modified_) {
      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_0__["default"]('modifyend', {
        features: this.features_
      });
      this.dispatchEvent(event);
      this.modified_ = false;
    }

    return false;
  };

  _proto.handleEvent = function handleEvent(mapBrowserEvent) {
    if (!(mapBrowserEvent instanceof ol_MapBrowserPointerEvent_js__WEBPACK_IMPORTED_MODULE_6__["default"])) {
      return true;
    }

    var handled;

    if (!mapBrowserEvent.map.getView().getInteracting() && mapBrowserEvent.type == 'pointermove' && !this.handlingDownUpSequence) {
      this.handlePointerMove_(mapBrowserEvent);
    }

    return _olInteractionPointer.prototype.handleEvent.call(this, mapBrowserEvent) && !handled;
  };

  return _default;
}(ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_14__["default"]);



function compareIndexes(a, b) {
  return a.index - b.index;
}

/***/ }),

/***/ "./src/interaction/ModifyRectangle.js":
/*!********************************************!*\
  !*** ./src/interaction/ModifyRectangle.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var ngeo_interaction_common_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/interaction/common.js */ "./src/interaction/common.js");
/* harmony import */ var ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/CustomEvent.js */ "./src/CustomEvent.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
/* harmony import */ var ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/interaction/Pointer.js */ "./node_modules/ol/interaction/Pointer.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }













var ModifyRectangle = function (_olInteractionPointer) {
  _inheritsLoose(ModifyRectangle, _olInteractionPointer);

  function ModifyRectangle(options) {
    var _this;

    _this = _olInteractionPointer.call(this) || this;
    console.assert(options.features);
    _this.handleDownEvent = _this.handleDown_;
    _this.handleDragEvent = _this.handleDrag_;
    _this.handleUpEvent = _this.handleUp_;
    _this.modified_ = false;
    _this.vectorPoints_ = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
      source: new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
        wrapX: !!options.wrapX
      }),
      visible: _this.getActive(),
      style: options.style || Object(ngeo_interaction_common_js__WEBPACK_IMPORTED_MODULE_0__["getDefaultModifyStyleFunction"])(),
      updateWhileAnimating: true,
      updateWhileInteracting: true
    });
    _this.features_ = options.features;
    _this.feature_ = null;
    _this.cache_ = {};
    _this.params_ = null;
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(_this.features_, 'add', _this.handleFeatureAdd_, _assertThisInitialized(_this));
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(_this.features_, 'remove', _this.handleFeatureRemove_, _assertThisInitialized(_this));

    _this.features_.forEach(function (feature) {
      _this.addFeature_(feature);
    });

    return _this;
  }

  var _proto = ModifyRectangle.prototype;

  _proto.setActive = function setActive(active) {
    ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_7__["default"].prototype.setActive.call(this, active);

    if (this.vectorPoints_) {
      this.vectorPoints_.setVisible(active);
    }
  };

  _proto.addFeature_ = function addFeature_(feature) {
    var featureGeom = feature.getGeometry();

    if (featureGeom instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
      var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(feature);
      var item = this.cache_[uid];

      if (item) {
        return;
      }

      var pointSource = this.vectorPoints_.getSource();
      var corners = featureGeom.getCoordinates()[0];

      while (corners.length > 4) {
        if (corners[0][0] < corners[1][0] && corners[0][1] <= corners[1][1]) {
          corners.pop();
        } else {
          corners.shift();
        }
      }

      var pointFeatures = [];
      var cornerPoint;
      var cornerFeature;
      corners.forEach(function (corner) {
        cornerPoint = new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__["default"](corner);
        cornerFeature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
          'corner': true,
          'geometry': cornerPoint,
          'siblingX': null,
          'siblingY': null,
          'boxFeature': feature
        });
        pointFeatures.push(cornerFeature);
      }, this);
      item = {
        corners: pointFeatures
      };
      this.cache_[uid] = item;
      var previousFeature;
      var nextFeature;
      pointFeatures.forEach(function (cornerFeature, index) {
        previousFeature = pointFeatures[index - 1];

        if (!previousFeature) {
          previousFeature = pointFeatures[pointFeatures.length - 1];
        }

        nextFeature = pointFeatures[index + 1];

        if (!nextFeature) {
          nextFeature = pointFeatures[0];
        }

        if (index % 2 === 0) {
          cornerFeature.set('siblingX', nextFeature);
          cornerFeature.set('siblingY', previousFeature);
        } else {
          cornerFeature.set('siblingX', previousFeature);
          cornerFeature.set('siblingY', nextFeature);
        }
      }, this);
      pointSource.addFeatures(pointFeatures);
    }
  };

  _proto.willModifyFeatures_ = function willModifyFeatures_(evt) {
    if (!this.modified_) {
      this.modified_ = true;
      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('modifystart', {
        features: this.features_
      });
      this.dispatchEvent(event);
      this.params_ = this.initializeParams_();
    }
  };

  _proto.initializeParams_ = function initializeParams_() {
    if (!this.feature_) {
      throw new Error('Missing feature');
    }

    var feature = this.feature_;
    var siblingY = feature.get('siblingX');
    console.assert(siblingY instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_3__["default"]);
    var origin = siblingY.get('siblingY');
    console.assert(origin instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_3__["default"]);
    var originPoint = origin.getGeometry();
    console.assert(originPoint instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__["default"]);
    var originCoordinate = originPoint.getCoordinates();
    var originPixel = this.getMap().getPixelFromCoordinate(originCoordinate);
    var siblingX = origin.get('siblingX');
    console.assert(siblingX instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_3__["default"]);
    var siblingXPoint = siblingX.getGeometry();
    console.assert(siblingXPoint instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__["default"]);
    var siblingXCoordinate = siblingXPoint.getCoordinates();
    var siblingXPixel = this.getMap().getPixelFromCoordinate(siblingXCoordinate);
    var vectorX = [siblingXPixel[0] - originPixel[0], siblingXPixel[1] - originPixel[1]];
    var vectorXMagnitude = Math.sqrt(vectorX[0] * vectorX[0] + vectorX[1] * vectorX[1]);
    vectorX[0] /= vectorXMagnitude;
    vectorX[1] /= vectorXMagnitude;
    var siblingYPoint = siblingY.getGeometry();
    console.assert(siblingYPoint instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__["default"]);
    var siblingYCoordinate = siblingYPoint.getCoordinates();
    var siblingYPixel = this.getMap().getPixelFromCoordinate(siblingYCoordinate);
    var vectorY = [siblingYPixel[0] - originPixel[0], siblingYPixel[1] - originPixel[1]];
    var vectorYMagnitude = Math.sqrt(vectorY[0] * vectorY[0] + vectorY[1] * vectorY[1]);
    vectorY[0] /= vectorYMagnitude;
    vectorY[1] /= vectorYMagnitude;

    if (isNaN(vectorX[0]) && isNaN(vectorY[0])) {
      vectorX = [0, 1];
      vectorY = [1, 0];
    } else if (isNaN(vectorX[0])) {
      vectorX = [vectorY[1], -vectorY[0]];
    } else if (isNaN(vectorY[0])) {
      vectorY = [vectorX[1], -vectorX[0]];
    }

    return {
      originCoordinate: originCoordinate,
      originPixel: originPixel,
      siblingXPoint: siblingXPoint,
      siblingYPoint: siblingYPoint,
      vectorX: vectorX,
      vectorY: vectorY
    };
  };

  _proto.removeFeature_ = function removeFeature_(feature) {
    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(feature);
    var item = this.cache_[uid];
    var corners = item.corners;

    for (var _iterator = corners, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var corner = _ref;
      this.vectorPoints_.getSource().removeFeature(corner);
    }

    this.feature_ = null;
    corners.length = 0;
    delete this.cache_[uid];
  };

  _proto.setMap = function setMap(map) {
    this.vectorPoints_.setMap(map);
    ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_7__["default"].prototype.setMap.call(this, map);
  };

  _proto.handleFeatureAdd_ = function handleFeatureAdd_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_10__["CollectionEvent"]) {
      var feature = evt.element;
      console.assert(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_3__["default"], 'feature should be an ol.Feature');
      this.addFeature_(feature);
    }
  };

  _proto.handleFeatureRemove_ = function handleFeatureRemove_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_10__["CollectionEvent"]) {
      var feature = evt.element;
      this.removeFeature_(feature);
    }
  };

  _proto.handleDown_ = function handleDown_(evt) {
    var map = evt.map;
    var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
      return feature.get('siblingX') && feature.get('siblingY') ? feature : undefined;
    });

    if (feature) {
      this.feature_ = feature;
      return true;
    }

    return false;
  };

  _proto.handleDrag_ = function handleDrag_(evt) {
    this.willModifyFeatures_(evt);

    if (!this.feature_) {
      throw new Error('Missing feature');
    }

    var feature = this.feature_;
    var geometry = feature.getGeometry();

    if (geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
      geometry.setCoordinates(evt.coordinate);

      if (!this.params_) {
        throw new Error('Missing params');
      }

      var destinationPixel = evt.pixel;
      var originPixel = this.params_.originPixel;
      var siblingXPoint = this.params_.siblingXPoint;
      var siblingYPoint = this.params_.siblingYPoint;
      var vectorX = this.params_.vectorX;
      var vectorY = this.params_.vectorY;
      var originCoordinate = this.params_.originCoordinate;
      var b2Pixel = this.calculateNewPixel_(originPixel, destinationPixel, vectorX);
      var b2Coordinate = this.getMap().getCoordinateFromPixel(b2Pixel);
      siblingXPoint.setCoordinates(b2Coordinate);
      var c2Pixel = this.calculateNewPixel_(originPixel, destinationPixel, vectorY);
      var c2Coordinate = this.getMap().getCoordinateFromPixel(c2Pixel);
      siblingYPoint.setCoordinates(c2Coordinate);
      var boxFeature = feature.get('boxFeature');
      var geom = boxFeature.getGeometry();
      console.assert(geom instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_6__["default"]);
      geom.setCoordinates([[evt.coordinate, b2Coordinate, originCoordinate, c2Coordinate, evt.coordinate]]);
    }
  };

  _proto.calculateNewPixel_ = function calculateNewPixel_(origin, destination, vector) {
    var aVector = [destination[0] - origin[0], destination[1] - origin[1]];
    var abScalarProduct = aVector[0] * vector[0] + aVector[1] * vector[1];
    var deltaVector = [vector[0] * abScalarProduct, vector[1] * abScalarProduct];
    return [deltaVector[0] + origin[0], deltaVector[1] + origin[1]];
  };

  _proto.handleUp_ = function handleUp_(evt) {
    if (this.modified_) {
      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('modifyend', {
        features: this.features_
      });
      this.dispatchEvent(event);
      this.params_ = null;
      this.modified_ = false;
    }

    return false;
  };

  return ModifyRectangle;
}(ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_7__["default"]);

/* harmony default export */ __webpack_exports__["default"] = (ModifyRectangle);

/***/ }),

/***/ "./src/interaction/Rotate.js":
/*!***********************************!*\
  !*** ./src/interaction/Rotate.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_interaction_common_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/interaction/common.js */ "./src/interaction/common.js");
/* harmony import */ var ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/CustomEvent.js */ "./src/CustomEvent.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/interaction/Pointer.js */ "./node_modules/ol/interaction/Pointer.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }















var _default = function (_olInteractionPointer) {
  _inheritsLoose(_default, _olInteractionPointer);

  function _default(options) {
    var _this;

    _this = _olInteractionPointer.call(this) || this;
    console.assert(options.features);
    _this.handleDownEvent = _this.handleDown_;
    _this.handleDragEvent = _this.handleDrag_;
    _this.handleUpEvent = _this.handleUp_;
    _this.listenerKeys_ = [];
    _this.modified_ = false;
    _this.keyPressListenerKey_ = null;
    _this.changingFeature_ = false;
    _this.pixelTolerance_ = options.pixelTolerance !== undefined ? options.pixelTolerance : 10;
    _this.features_ = options.features;
    _this.feature_ = null;
    _this.coordinate_ = null;
    _this.centerCoordinate_ = null;
    _this.overlay_ = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
      source: new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
        useSpatialIndex: false,
        wrapX: !!options.wrapX
      }),
      style: options.style || Object(ngeo_interaction_common_js__WEBPACK_IMPORTED_MODULE_0__["getDefaultModifyStyleFunction"])(),
      updateWhileAnimating: true,
      updateWhileInteracting: true
    });
    _this.centerFeatures_ = {};
    return _this;
  }

  var _proto = _default.prototype;

  _proto.setActive = function setActive(active) {
    var _this2 = this;

    if (!this.features_) {
      return;
    }

    if (this.keyPressListenerKey_) {
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["unlistenByKey"])(this.keyPressListenerKey_);
      this.keyPressListenerKey_ = null;
    }

    ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_6__["default"].prototype.setActive.call(this, active);

    if (active) {
      this.keyPressListenerKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(document, 'keyup', this.handleKeyUp_, this);
      this.features_.forEach(function (feature) {
        return _this2.addFeature_(feature);
      });
      this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.features_, 'add', this.handleFeatureAdd_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.features_, 'remove', this.handleFeatureRemove_, this));
    } else {
      this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["unlistenByKey"]);
      this.listenerKeys_.length = 0;
      this.features_.forEach(function (feature) {
        return _this2.removeFeature_(feature);
      });
    }
  };

  _proto.addFeature_ = function addFeature_(feature) {
    var geometry = feature.getGeometry();

    if (!geometry) {
      throw new Error('Missing geometry');
    }

    feature.set('angle', 0);
    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(feature);
    var point = new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_7__["default"](this.getCenterCoordinate_(geometry));
    var centerFeature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_4__["default"](point);
    this.centerFeatures_[uid] = centerFeature;
    this.overlay_.getSource().addFeature(centerFeature);
  };

  _proto.willModifyFeatures_ = function willModifyFeatures_(evt) {
    if (!this.modified_) {
      this.modified_ = true;
      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('modifystart', {
        features: this.features_
      });
      this.dispatchEvent(event);
    }
  };

  _proto.removeFeature_ = function removeFeature_(feature) {
    this.feature_ = null;

    if (feature) {
      var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(feature);

      if (this.centerFeatures_[uid]) {
        var source = this.overlay_.getSource();

        if (!(source instanceof ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_11__["default"])) {
          throw new Error('Wrong source type');
        }

        source.removeFeature(this.centerFeatures_[uid]);
        delete this.centerFeatures_[uid];
      }
    }
  };

  _proto.setMap = function setMap(map) {
    this.overlay_.setMap(map);
    ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_6__["default"].prototype.setMap.call(this, map);
  };

  _proto.handleFeatureAdd_ = function handleFeatureAdd_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_12__["CollectionEvent"]) {
      var feature = evt.element;
      console.assert(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_4__["default"], 'feature should be an ol.Feature');
      this.addFeature_(feature);
    }
  };

  _proto.handleFeatureRemove_ = function handleFeatureRemove_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_12__["CollectionEvent"]) {
      var feature = evt.element;
      this.removeFeature_(feature);
    }
  };

  _proto.handleDown_ = function handleDown_(evt) {
    var map = evt.map;
    var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature, layer) {
      return feature;
    }, undefined);

    if (feature) {
      var found = false;
      this.features_.forEach(function (f) {
        if (Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(f) == Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(feature)) {
          found = true;
        }
      });

      if (!found) {
        feature = undefined;
      }
    }

    if (feature) {
      this.coordinate_ = evt.coordinate;
      this.feature_ = feature;
      var geometry = this.feature_.getGeometry();

      if (geometry !== undefined) {
        this.centerCoordinate_ = this.getCenterCoordinate_(geometry);
      }

      return true;
    }

    return false;
  };

  _proto.getCenterCoordinate_ = function getCenterCoordinate_(geometry) {
    var center;

    if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
      center = geometry.getFlatMidpoint();
    } else if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_9__["default"]) {
      center = geometry.getFlatInteriorPoint();
    } else {
      var extent = geometry.getExtent();
      center = ol_extent_js__WEBPACK_IMPORTED_MODULE_3__["getCenter"](extent);
    }

    return center;
  };

  _proto.handleDrag_ = function handleDrag_(evt) {
    this.willModifyFeatures_(evt);

    if (!this.feature_) {
      throw new Error('Missing feature');
    }

    if (!this.coordinate_) {
      throw new Error('Missing coordinate');
    }

    if (!this.centerCoordinate_) {
      throw new Error('Missing centerCoordinate');
    }

    var geometry = this.feature_.getGeometry();

    if (!geometry) {
      throw new Error('Missing geometry');
    }

    var oldX = this.coordinate_[0];
    var oldY = this.coordinate_[1];
    var centerX = this.centerCoordinate_[0];
    var centerY = this.centerCoordinate_[1];
    var dx1 = oldX - centerX;
    var dy1 = oldY - centerY;
    var dx0 = evt.coordinate[0] - centerX;
    var dy0 = evt.coordinate[1] - centerY;
    this.coordinate_[0] = evt.coordinate[0];
    this.coordinate_[1] = evt.coordinate[1];
    var a0 = Math.atan2(dy0, dx0);
    var a1 = Math.atan2(dy1, dx1);
    var angle = a1 - a0;
    geometry.rotate(-angle, [centerX, centerY]);
  };

  _proto.handleUp_ = function handleUp_(evt) {
    if (this.modified_) {
      if (!this.feature_) {
        throw new Error('Missing feature');
      }

      var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('rotateend', {
        feature: this.feature_
      });
      this.dispatchEvent(event);
      this.modified_ = false;
      this.setActive(false);
    }

    return false;
  };

  _proto.handleKeyUp_ = function handleKeyUp_(evt) {
    if (evt instanceof KeyboardEvent && evt.keyCode === 27) {
      this.setActive(false);
    }
  };

  return _default;
}(ol_interaction_Pointer_js__WEBPACK_IMPORTED_MODULE_6__["default"]);



/***/ }),

/***/ "./src/interaction/Translate.js":
/*!**************************************!*\
  !*** ./src/interaction/Translate.js ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_geom_Geometry_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/geom/Geometry.js */ "./node_modules/ol/geom/Geometry.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
/* harmony import */ var ol_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/interaction/Translate.js */ "./node_modules/ol/interaction/Translate.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }














var _default = function (_olInteractionTransla) {
  _inheritsLoose(_default, _olInteractionTransla);

  function _default(options) {
    var _this;

    _this = _olInteractionTransla.call(this, options) || this;
    _this.listenerKeys_ = [];
    _this.featureListenerKeys_ = {};
    _this.keyPressListenerKey_ = null;
    _this.myFeatures_ = options.features !== undefined ? options.features : null;
    _this.vectorSource_ = new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
      useSpatialIndex: false
    });
    _this.vectorLayer_ = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
      source: _this.vectorSource_,
      style: options.style,
      updateWhileAnimating: true,
      updateWhileInteracting: true
    });
    _this.centerFeatures_ = {};
    return _this;
  }

  var _proto = _default.prototype;

  _proto.setActive = function setActive(active) {
    if (this.keyPressListenerKey_) {
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["unlistenByKey"])(this.keyPressListenerKey_);
      this.keyPressListenerKey_ = null;
    }

    ol_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_8__["default"].prototype.setActive.call(this, active);

    if (active) {
      this.keyPressListenerKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(document, 'keyup', this.handleKeyUp_, this);
    }

    this.setState_();
  };

  _proto.setMap = function setMap(map) {
    var currentMap = this.getMap();

    if (currentMap) {
      this.vectorLayer_.setMap(null);
    }

    ol_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_8__["default"].prototype.setMap.call(this, map);

    if (map) {
      this.vectorLayer_.setMap(map);
    }

    this.setState_();
  };

  _proto.setState_ = function setState_() {
    var _this2 = this;

    var map = this.getMap();

    if (!map) {
      return;
    }

    var active = this.getActive();
    var features = this.myFeatures_;

    if (!features) {
      throw new Error('Missing features');
    }

    var keys = this.listenerKeys_;

    if (map && active && features) {
      features.forEach(function (feature) {
        return _this2.addFeature_(feature);
      });
      keys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(features, 'add', this.handleFeaturesAdd_, this), Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(features, 'remove', this.handleFeaturesRemove_, this));
    } else {
      if (map) {
        var elem = map.getTargetElement();
        elem.style.cursor = 'default';
      }

      keys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["unlistenByKey"]);
      keys.length = 0;
      features.forEach(function (feature) {
        return _this2.removeFeature_(feature);
      });
    }
  };

  _proto.handleFeaturesAdd_ = function handleFeaturesAdd_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_11__["CollectionEvent"]) {
      var feature = evt.element;
      console.assert(feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"], 'feature should be an ol.Feature');
      this.addFeature_(feature);
    }
  };

  _proto.handleFeaturesRemove_ = function handleFeaturesRemove_(evt) {
    if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_11__["CollectionEvent"]) {
      var feature = evt.element;
      this.removeFeature_(feature);
    }
  };

  _proto.addFeature_ = function addFeature_(feature) {
    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_0__["getUid"])(feature);
    var geometry = feature.getGeometry();

    if (!geometry) {
      throw new Error('Missing geometry');
    }

    this.featureListenerKeys_[uid] = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(geometry, 'change', this.handleGeometryChange_.bind(this, feature), this);
    var point = this.getGeometryCenterPoint_(geometry);
    var centerFeature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"](point);
    this.centerFeatures_[uid] = centerFeature;
    this.vectorSource_.addFeature(centerFeature);
  };

  _proto.removeFeature_ = function removeFeature_(feature) {
    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_0__["getUid"])(feature);

    if (this.featureListenerKeys_[uid]) {
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["unlistenByKey"])(this.featureListenerKeys_[uid]);
      delete this.featureListenerKeys_[uid];
      this.vectorSource_.removeFeature(this.centerFeatures_[uid]);
      delete this.centerFeatures_[uid];
    }
  };

  _proto.handleGeometryChange_ = function handleGeometryChange_(feature, evt) {
    var geometry = evt.target;
    console.assert(geometry instanceof ol_geom_Geometry_js__WEBPACK_IMPORTED_MODULE_4__["default"]);
    var point = this.getGeometryCenterPoint_(geometry);
    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_0__["getUid"])(feature);
    this.centerFeatures_[uid].setGeometry(point);
  };

  _proto.getGeometryCenterPoint_ = function getGeometryCenterPoint_(geometry) {
    var center;
    var point;

    if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_7__["default"]) {
      point = geometry.getInteriorPoint();
    } else if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
      center = geometry.getCoordinateAt(0.5);
    } else {
      var extent = geometry.getExtent();
      center = ol_extent_js__WEBPACK_IMPORTED_MODULE_1__["getCenter"](extent);
    }

    if (!point && center) {
      point = new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_6__["default"](center);
    }

    if (!point) {
      throw new Error('Missing point');
    }

    return point;
  };

  _proto.handleKeyUp_ = function handleKeyUp_(evt) {
    if (evt instanceof KeyboardEvent && evt.keyCode === 27) {
      this.setActive(false);
    }
  };

  return _default;
}(ol_interaction_Translate_js__WEBPACK_IMPORTED_MODULE_8__["default"]);



/***/ }),

/***/ "./src/interaction/common.js":
/*!***********************************!*\
  !*** ./src/interaction/common.js ***!
  \***********************************/
/*! exports provided: getDefaultDrawStyleFunction, getDefaultModifyStyleFunction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDefaultDrawStyleFunction", function() { return getDefaultDrawStyleFunction; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDefaultModifyStyleFunction", function() { return getDefaultModifyStyleFunction; });
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");

function getDefaultDrawStyleFunction() {
  var style = Object(ol_style_Style_js__WEBPACK_IMPORTED_MODULE_0__["createEditingStyle"])();
  return function (feature, resolution) {
    var geometry = feature.getGeometry();

    if (geometry) {
      return style[geometry.getType()];
    }
  };
}
function getDefaultModifyStyleFunction() {
  var style = Object(ol_style_Style_js__WEBPACK_IMPORTED_MODULE_0__["createEditingStyle"])();
  return function (feature, resolution) {
    return style.Point;
  };
}

/***/ }),

/***/ "./src/layertree/Controller.js":
/*!*************************************!*\
  !*** ./src/layertree/Controller.js ***!
  \*************************************/
/*! exports provided: LayertreeController, getFirstParentTree, LayertreeVisitorDecision, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayertreeController", function() { return LayertreeController; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstParentTree", function() { return getFirstParentTree; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayertreeVisitorDecision", function() { return LayertreeVisitorDecision; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/decorate.js */ "./src/misc/decorate.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/layer/Group.js */ "./node_modules/ol/layer/Group.js");
/* harmony import */ var ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/layer/Layer.js */ "./node_modules/ol/layer/Layer.js");
LayertreeController.$inject = ["$scope", "$rootScope", "$attrs"];






function LayertreeController($scope, $rootScope, $attrs) {
  var _this = this;

  var isRoot = $attrs.ngeoLayertreeNotroot === undefined;
  this.isRoot = isRoot;
  var nodeExpr = $attrs.ngeoLayertree;
  this.rootScope_ = $rootScope;
  this.properties = {};
  this.state_ = 'off';
  var node;

  if (isRoot) {
    $scope.$watch(nodeExpr, function (newVal, oldVal) {
      _this.node = newVal;
    });
  } else {
    node = $scope.$eval(nodeExpr);
  }

  this.node = node;
  var mapExpr = $attrs.ngeoLayertreeMap;
  var map = $scope.$eval(mapExpr);
  console.assert(map !== undefined);
  this.parent = $scope.$parent.layertreeCtrl;
  this.children = [];

  if (this.parent) {
    this.parent.children.push(this);
  }

  $scope.$on('$destroy', function () {
    if (_this.parent) {
      var index = _this.parent.children.indexOf(_this);

      console.assert(index >= 0);

      _this.parent.children.splice(index, 1);
    }
  });
  this.uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(this);
  this.depth = isRoot ? 0 : this.parent.depth + 1;
  $scope.uid = this.uid;
  $scope.depth = this.depth;
  this.map = map;
  var nodelayerExpr = $attrs.ngeoLayertreeNodelayer;

  if (nodelayerExpr === undefined) {
    var nodelayerexprExpr = $attrs.ngeoLayertreeNodelayerexpr;
    var newNodelayerExpr = $scope.$eval(nodelayerexprExpr);
    console.assert(typeof newNodelayerExpr == 'string');
    nodelayerExpr = newNodelayerExpr;
  }

  console.assert(nodelayerExpr !== undefined);
  this.nodelayerExpr = nodelayerExpr;
  this.layer = null;

  if (!isRoot) {
    var layer = $scope.$eval(nodelayerExpr, {
      'treeCtrl': this
    }) || null;

    if (layer) {
      console.assert(layer instanceof ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_5__["default"] || layer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_4__["default"]);
      this.layer = layer;
    }
  }

  this.dataSource_ = null;

  if (this.layer) {
    Object(ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_1__["layerLoading"])(this.layer, $scope);
    Object(ngeo_misc_decorate_js__WEBPACK_IMPORTED_MODULE_1__["layerDecoration"])(this.layer);
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(this.layer, 'change:opacity', function () {
      _this.rootScope_.$broadcast('ngeo-layertree-opacity', _this);
    });
  }

  var listenersExpr = $attrs.ngeoLayertreeListeners;

  if (listenersExpr === undefined) {
    var listenersexprExpr = $attrs.ngeoLayertreeListenersexpr;
    listenersExpr = $scope.$eval(listenersexprExpr);
  }

  if (listenersExpr !== undefined) {
    console.assert(typeof listenersExpr == 'string');
  }

  this.listenersExpr = listenersExpr;

  if (listenersExpr) {
    $scope.$eval(listenersExpr, {
      'treeScope': $scope,
      'treeCtrl': this
    });
  }

  $scope.layertreeCtrl = this;
}

LayertreeController.prototype.getState = function () {
  return this.state_;
};

LayertreeController.prototype.setState = function (state, opt_broadcast) {
  var _this2 = this;

  if (state === this.state_) {
    return;
  }

  this.setStateInternal_(state);

  if (this.parent) {
    this.parent.refreshState(this, opt_broadcast);
  }

  var firstParents = this.isRoot ? this.children : [getFirstParentTree(this)];

  if (opt_broadcast === undefined || opt_broadcast) {
    firstParents.forEach(function (firstParent) {
      _this2.rootScope_.$broadcast('ngeo-layertree-state', _this2, firstParent);
    });
  }
};

LayertreeController.prototype.setStateInternal_ = function (state) {
  var _this3 = this;

  this.state_ = state === 'on' ? 'on' : 'off';

  if (this.state_ === 'on' && this.node.metadata && this.node.metadata.exclusiveGroup) {
    var firstChild;

    for (var _iterator = this.children, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var child = _ref;

      if (!firstChild) {
        firstChild = child;
        child.setStateInternal_('on');
      } else {
        child.setStateInternal_('off');
      }
    }
  } else {
    this.children.forEach(function (child) {
      child.setStateInternal_(_this3.state_);
    });
  }
};

LayertreeController.prototype.refreshState = function (opt_onChild, opt_broadcast) {
  var group = this.node;

  if (group.children && opt_onChild && opt_onChild.getState() !== 'off' && this.node.metadata && this.node.metadata.exclusiveGroup) {
    var onChild = opt_onChild;
    this.children.forEach(function (child) {
      if (child !== onChild) {
        child.setState('off', opt_broadcast);
      }
    });
  }

  var newState = this.getCalculateState();

  if (this.state_ === newState) {
    return;
  }

  this.state_ = newState;

  if (this.parent) {
    this.parent.refreshState(this, opt_broadcast);
  }
};

LayertreeController.prototype.getCalculateState = function () {
  var group = this.node;

  if (group.children === undefined) {
    return this.state_;
  }

  var childState = '';
  var previousChildState;
  this.children.some(function (child) {
    childState = child.getCalculateState();

    if (previousChildState) {
      if (previousChildState !== childState) {
        childState = 'indeterminate';
        return true;
      }
    }

    previousChildState = childState;
    return false;
  });
  return childState;
};

LayertreeController.prototype.getSetActive = function (val) {
  var layer = this.layer;
  var map = this.map;

  if (!layer) {
    return;
  }

  if (val !== undefined) {
    if (!val) {
      map.removeLayer(layer);
    } else {
      map.addLayer(layer);
    }
  } else {
    return map.getLayers().getArray().includes(layer);
  }
};

LayertreeController.prototype.getDataSource = function () {
  return this.dataSource_;
};

LayertreeController.prototype.setDataSource = function (dataSource) {
  this.dataSource_ = dataSource;
};

function getFirstParentTree(treeCtrl) {
  var tree = treeCtrl;

  while (!tree.parent.isRoot) {
    tree = tree.parent;
  }

  return tree;
}
var LayertreeVisitorDecision = {
  STOP: 'STOP',
  SKIP: 'SKIP',
  DESCEND: 'DESCEND'
};

LayertreeController.prototype.traverseDepthFirst = function (visitor) {
  var decision = visitor(this) || LayertreeVisitorDecision.DESCEND;

  switch (decision) {
    case LayertreeVisitorDecision.STOP:
      return true;

    case LayertreeVisitorDecision.SKIP:
      return false;

    case LayertreeVisitorDecision.DESCEND:
      for (var _iterator2 = this.children, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
        var _ref2;

        if (_isArray2) {
          if (_i2 >= _iterator2.length) break;
          _ref2 = _iterator2[_i2++];
        } else {
          _i2 = _iterator2.next();
          if (_i2.done) break;
          _ref2 = _i2.value;
        }

        var child = _ref2;
        var stop = child.traverseDepthFirst(visitor);

        if (stop) {
          return true;
        }
      }

      return false;

    default:
      throw 'Unhandled case';
  }
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoLayertreeController', []);
module.controller('ngeoLayertreeController', LayertreeController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/layertree/component.html":
/*!**************************************!*\
  !*** ./src/layertree/component.html ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<span ng-if="::!layertreeCtrl.isRoot">{{::layertreeCtrl.node.name}}</span>\n<input\n  type="checkbox"\n  ng-if="::layertreeCtrl.node && !layertreeCtrl.node.children"\n  ng-model="layertreeCtrl.getSetActive"\n  ng-model-options="{getterSetter: true}"/>\n<ul ng-if="::layertreeCtrl.node.children">\n  <li\n    ng-repeat="node in ::layertreeCtrl.node.children"\n    ngeo-layertree="::node"\n    ngeo-layertree-notroot\n    ngeo-layertree-map="layertreeCtrl.map"\n    ngeo-layertree-nodelayerexpr="layertreeCtrl.nodelayerExpr"\n    ngeo-layertree-listenersexpr="layertreeCtrl.listenersExpr">\n  </li>\n</ul>\n';

}
return __p
}

/***/ }),

/***/ "./src/layertree/component.js":
/*!************************************!*\
  !*** ./src/layertree/component.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/layertree/Controller.js */ "./src/layertree/Controller.js");
/* harmony import */ var bootstrap_js_src_collapse_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bootstrap/js/src/collapse.js */ "./node_modules/bootstrap/js/src/collapse.js");
gmfLayertreeComponent.$inject = ["ngeoLayertreeTemplateUrl"];



var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoLayertree', [ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.value('ngeoLayertreeTemplateUrl', function (element, attrs) {
  var templateUrl = attrs['ngeoLayertreeTemplateurl'];
  return templateUrl !== undefined ? templateUrl : 'ngeo/layertree';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/layertree', __webpack_require__(/*! ./component.html */ "./src/layertree/component.html"));
}]);

function gmfLayertreeComponent(ngeoLayertreeTemplateUrl) {
  return {
    restrict: 'A',
    scope: true,
    templateUrl: ngeoLayertreeTemplateUrl,
    controller: ngeo_layertree_Controller_js__WEBPACK_IMPORTED_MODULE_1__["LayertreeController"]
  };
}

module.directive('ngeoLayertree', gmfLayertreeComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/map/BackgroundLayerMgr.js":
/*!***************************************!*\
  !*** ./src/map/BackgroundLayerMgr.js ***!
  \***************************************/
/*! exports provided: MapBackgroundLayerManager, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MapBackgroundLayerManager", function() { return MapBackgroundLayerManager; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/CustomEvent.js */ "./src/CustomEvent.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_Observable_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/Observable.js */ "./node_modules/ol/Observable.js");
/* harmony import */ var ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/layer/Group.js */ "./node_modules/ol/layer/Group.js");
/* harmony import */ var ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/layer/Layer.js */ "./node_modules/ol/layer/Layer.js");
/* harmony import */ var ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/source/ImageWMS.js */ "./node_modules/ol/source/ImageWMS.js");
/* harmony import */ var ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/source/TileWMS.js */ "./node_modules/ol/source/TileWMS.js");
/* harmony import */ var ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/source/WMTS.js */ "./node_modules/ol/source/WMTS.js");
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }











var BACKGROUNDLAYERGROUP_NAME = 'background';
var MapBackgroundLayerManager = function (_olObservable) {
  MapBackgroundLayerManager.$inject = ["ngeoLayerHelper"];

  _inheritsLoose(MapBackgroundLayerManager, _olObservable);

  function MapBackgroundLayerManager(ngeoLayerHelper) {
    var _this;

    _this = _olObservable.call(this) || this;
    _this.mapUids_ = {};
    _this.ngeoLayerHelper_ = ngeoLayerHelper;
    return _this;
  }

  var _proto = MapBackgroundLayerManager.prototype;

  _proto.get = function get(map) {
    var mapUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(map).toString();
    return mapUid in this.mapUids_ ? this.ngeoLayerHelper_.getGroupFromMap(map, BACKGROUNDLAYERGROUP_NAME).getLayers().item(0) : null;
  };

  _proto.set = function set(map, layer) {
    var ZIndex = -200;
    var mapUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(map).toString();
    var previous = this.get(map);

    if (layer !== null) {
      layer.setZIndex(ZIndex);
      this.ngeoLayerHelper_.setZIndexToFirstLevelChildren(layer, ZIndex);
    }

    var bgGroup = this.ngeoLayerHelper_.getGroupFromMap(map, BACKGROUNDLAYERGROUP_NAME);

    if (previous !== null) {
      console.assert(mapUid in this.mapUids_);

      if (layer !== null) {
        bgGroup.getLayers().setAt(0, layer);
      } else {
        bgGroup.getLayers().removeAt(0);
        delete this.mapUids_[mapUid];
      }
    } else if (layer !== null) {
      bgGroup.getLayers().insertAt(0, layer);
      this.mapUids_[mapUid] = true;
    }

    var event = new ngeo_CustomEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"]('change', {
      current: layer,
      previous: previous
    });
    this.dispatchEvent(event);
    return previous;
  };

  _proto.getOpacityBgLayer = function getOpacityBgLayer(map) {
    var mapUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(map).toString();
    return mapUid in this.mapUids_ ? this.ngeoLayerHelper_.getGroupFromMap(map, BACKGROUNDLAYERGROUP_NAME).getLayers().item(1) : null;
  };

  _proto.setOpacityBgLayer = function setOpacityBgLayer(map, layer) {
    var bgGroup = this.ngeoLayerHelper_.getGroupFromMap(map, BACKGROUNDLAYERGROUP_NAME);
    var opacityBackgroundLayer = this.getOpacityBgLayer(map);

    if (opacityBackgroundLayer) {
      var previous = bgGroup.getLayers().remove(opacityBackgroundLayer);
      layer.setOpacity(previous ? previous.getOpacity() : 0);
      layer.setVisible(previous ? previous.getVisible() : true);
    }

    var ZIndex = -100;
    layer.setZIndex(ZIndex);
    this.ngeoLayerHelper_.setZIndexToFirstLevelChildren(layer, ZIndex);
    var index = bgGroup.getLayers().getArray().indexOf(layer);

    if (index === -1) {
      bgGroup.getLayers().push(layer);
    }
  };

  _proto.updateDimensions = function updateDimensions(map, dimensions) {
    var baseBgLayer = this.get(map);

    if (baseBgLayer) {
      var layers = [baseBgLayer];

      if (baseBgLayer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_4__["default"]) {
        layers = baseBgLayer.getLayers().getArray();
      }

      layers.forEach(function (layer) {
        if (layer instanceof ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
          var hasUpdates = false;
          var updatedDimensions = {};

          for (var key in layer.get('dimensions')) {
            var value = dimensions[key];

            if (value !== undefined) {
              updatedDimensions[key] = value;
              hasUpdates = true;
            }
          }

          if (hasUpdates) {
            var source = layer.getSource();

            if (source instanceof ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_8__["default"]) {
              source.updateDimensions(updatedDimensions);
              source.refresh();
            } else if (source instanceof ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_7__["default"] || source instanceof ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
              source.updateParams(updatedDimensions);
              source.refresh();
            }
          }
        }
      });
    }
  };

  return MapBackgroundLayerManager;
}(ol_Observable_js__WEBPACK_IMPORTED_MODULE_3__["default"]);
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoBackgroundLayerMgr', [ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_9__["default"].name]);
module.service('ngeoBackgroundLayerMgr', MapBackgroundLayerManager);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/map/FeatureOverlay.js":
/*!***********************************!*\
  !*** ./src/map/FeatureOverlay.js ***!
  \***********************************/
/*! exports provided: FeatureOverlay, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FeatureOverlay", function() { return FeatureOverlay; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Collection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Collection.js */ "./node_modules/ol/Collection.js");



function FeatureOverlay(manager, index) {
  this.manager_ = manager;
  this.features_ = null;
  this.index_ = index;
  this.listenerKeys_ = [];
}

FeatureOverlay.prototype.addFeature = function (feature) {
  this.manager_.addFeature(feature, this.index_);
};

FeatureOverlay.prototype.removeFeature = function (feature) {
  this.manager_.removeFeature(feature, this.index_);
};

FeatureOverlay.prototype.clear = function () {
  this.manager_.clear(this.index_);
};

FeatureOverlay.prototype.setFeatures = function (features) {
  var _this = this;

  if (this.features_ !== null) {
    this.features_.clear();
    this.listenerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["unlistenByKey"]);
  }

  if (features !== null) {
    features.forEach(function (feature) {
      _this.addFeature(feature);
    });
    this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(features, 'add', this.handleFeatureAdd_, this));
    this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(features, 'remove', this.handleFeatureRemove_, this));
  }

  this.features_ = features;
};

FeatureOverlay.prototype.setStyle = function (style) {
  this.manager_.setStyle(style, this.index_);
};

FeatureOverlay.prototype.handleFeatureAdd_ = function (evt) {
  if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_2__["CollectionEvent"]) {
    var feature = evt.element;
    this.addFeature(feature);
  }
};

FeatureOverlay.prototype.handleFeatureRemove_ = function (evt) {
  if (evt instanceof ol_Collection_js__WEBPACK_IMPORTED_MODULE_2__["CollectionEvent"]) {
    var feature = evt.element;
    this.removeFeature(feature);
  }
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoFeatureOverlay', []);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/map/FeatureOverlayMgr.js":
/*!**************************************!*\
  !*** ./src/map/FeatureOverlayMgr.js ***!
  \**************************************/
/*! exports provided: FeatureOverlayMgr, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FeatureOverlayMgr", function() { return FeatureOverlayMgr; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_map_FeatureOverlay_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/map/FeatureOverlay.js */ "./src/map/FeatureOverlay.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_obj_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/obj.js */ "./node_modules/ol/obj.js");
/* harmony import */ var ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/source/Vector.js */ "./node_modules/ol/source/Vector.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");







function FeatureOverlayMgr() {
  this.featureUidToGroupIndex_ = {};
  this.groups_ = [];
  this.source_ = new ol_source_Vector_js__WEBPACK_IMPORTED_MODULE_5__["default"]({
    useSpatialIndex: false
  });
  this.layer_ = new ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_3__["default"]({
    source: this.source_,
    style: this.styleFunction_.bind(this),
    updateWhileAnimating: true,
    updateWhileInteracting: true
  });
}

FeatureOverlayMgr.prototype.addFeature = function (feature, groupIndex) {
  console.assert(groupIndex >= 0);
  console.assert(groupIndex < this.groups_.length);
  var featureUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(feature).toString();
  this.featureUidToGroupIndex_[featureUid] = groupIndex;
  this.groups_[groupIndex].features[featureUid] = feature;
  this.source_.addFeature(feature);
};

FeatureOverlayMgr.prototype.removeFeature = function (feature, groupIndex) {
  console.assert(groupIndex >= 0);
  console.assert(groupIndex < this.groups_.length);
  var featureUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(feature).toString();
  delete this.featureUidToGroupIndex_[featureUid];
  delete this.groups_[groupIndex].features[featureUid];
  this.source_.removeFeature(feature);
};

FeatureOverlayMgr.prototype.clear = function (groupIndex) {
  console.assert(groupIndex >= 0);
  console.assert(groupIndex < this.groups_.length);
  var group = this.groups_[groupIndex];

  for (var featureUid in group.features) {
    this.removeFeature(group.features[featureUid], groupIndex);
  }

  console.assert(Object(ol_obj_js__WEBPACK_IMPORTED_MODULE_4__["isEmpty"])(group.features));
};

FeatureOverlayMgr.prototype.getLayer = function () {
  return this.layer_;
};

FeatureOverlayMgr.prototype.getFeatureOverlay = function () {
  var groupIndex = this.groups_.length;
  this.groups_.push({
    styleFunction: ol_style_Style_js__WEBPACK_IMPORTED_MODULE_6__["createDefaultStyle"],
    features: {}
  });
  return new ngeo_map_FeatureOverlay_js__WEBPACK_IMPORTED_MODULE_1__["FeatureOverlay"](this, groupIndex);
};

FeatureOverlayMgr.prototype.init = function (map) {
  this.layer_.setMap(map);
};

FeatureOverlayMgr.prototype.setStyle = function (style, groupIndex) {
  console.assert(groupIndex >= 0);
  console.assert(groupIndex < this.groups_.length);
  this.groups_[groupIndex].styleFunction = style === null ? ol_style_Style_js__WEBPACK_IMPORTED_MODULE_6__["createDefaultStyle"] : Object(ol_style_Style_js__WEBPACK_IMPORTED_MODULE_6__["toFunction"])(style);
};

FeatureOverlayMgr.prototype.styleFunction_ = function (feature, resolution) {
  var featureUid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_2__["getUid"])(feature).toString();
  console.assert(featureUid in this.featureUidToGroupIndex_);
  var groupIndex = this.featureUidToGroupIndex_[featureUid];
  var group = this.groups_[groupIndex];
  return group.styleFunction(feature, resolution);
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoFeatureOverlayMgr', [ngeo_map_FeatureOverlay_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.service('ngeoFeatureOverlayMgr', FeatureOverlayMgr);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/map/LayerHelper.js":
/*!********************************!*\
  !*** ./src/map/LayerHelper.js ***!
  \********************************/
/*! exports provided: LayerHelper, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayerHelper", function() { return LayerHelper; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
/* harmony import */ var ol_format_WMTSCapabilities_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/format/WMTSCapabilities.js */ "./node_modules/ol/format/WMTSCapabilities.js");
/* harmony import */ var ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/layer/Group.js */ "./node_modules/ol/layer/Group.js");
/* harmony import */ var ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/layer/Image.js */ "./node_modules/ol/layer/Image.js");
/* harmony import */ var ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/layer/Tile.js */ "./node_modules/ol/layer/Tile.js");
/* harmony import */ var ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/layer/Layer.js */ "./node_modules/ol/layer/Layer.js");
/* harmony import */ var ol_obj_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/obj.js */ "./node_modules/ol/obj.js");
/* harmony import */ var ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/source/ImageWMS.js */ "./node_modules/ol/source/ImageWMS.js");
/* harmony import */ var ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/source/TileWMS.js */ "./node_modules/ol/source/TileWMS.js");
/* harmony import */ var ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/source/WMTS.js */ "./node_modules/ol/source/WMTS.js");
/* harmony import */ var ol_uri_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/uri.js */ "./node_modules/ol/uri.js");
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
LayerHelper.$inject = ["$q", "$http", "ngeoTilesPreloadingLimit"];













function LayerHelper($q, $http, ngeoTilesPreloadingLimit) {
  this.$q_ = $q;
  this.$http_ = $http;
  this.tilesPreloadingLimit_ = ngeoTilesPreloadingLimit;
}
var GROUP_KEY = 'groupName';
var REFRESH_PARAM = 'random';

LayerHelper.prototype.createBasicWMSLayer = function (sourceURL, sourceLayersName, sourceFormat, opt_serverType, opt_time, opt_params, opt_crossOrigin, opt_customSourceOptions, opt_customLayerOptions) {
  var params = {
    FORMAT: sourceFormat,
    LAYERS: sourceLayersName
  };
  var olServerType;

  if (opt_time) {
    params.TIME = opt_time;
  }

  if (opt_serverType) {
    params.SERVERTYPE = opt_serverType;
    olServerType = opt_serverType.replace(ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_12__["ServerType"].QGISSERVER, 'qgis');
  }

  var options = Object.assign({}, opt_customSourceOptions, {
    url: sourceURL,
    params: params,
    serverType: olServerType,
    crossOrigin: opt_crossOrigin
  });
  var source = new ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_8__["default"](options);

  if (opt_params) {
    source.updateParams(opt_params);
  }

  var layerOptions = Object.assign({}, opt_customLayerOptions, {
    source: source
  });
  return new ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_4__["default"](layerOptions);
};

LayerHelper.prototype.createBasicWMSLayerFromDataSource = function (dataSource, opt_crossOrigin) {
  var url = dataSource.wmsUrl;

  if (url === undefined) {
    throw new Error('Missing url');
  }

  var layerNames = dataSource.getWMSLayerNames().join(',');
  var serverType = dataSource.ogcServerType;
  var imageType = dataSource.ogcImageType;
  var layer = this.createBasicWMSLayer(url, layerNames, imageType, serverType, undefined, undefined, opt_crossOrigin);
  layer.setVisible(dataSource.visible);
  layer.set('querySourceIds', [dataSource.id]);
  layer.set('dataSourceId', dataSource.id);
  return layer;
};

LayerHelper.prototype.createWMTSLayerFromCapabilitites = function (capabilitiesURL, layerName, opt_matrixSet, opt_dimensions, opt_customOptions, opt_minResolution, opt_maxResolution) {
  var parser = new ol_format_WMTSCapabilities_js__WEBPACK_IMPORTED_MODULE_2__["default"]();
  var layer = new ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_5__["default"]({
    preload: this.tilesPreloadingLimit_,
    minResolution: opt_minResolution,
    maxResolution: opt_maxResolution
  });
  var $q = this.$q_;
  return this.$http_.get(capabilitiesURL, {
    cache: true
  }).then(function (response) {
    var result;

    if (response.data) {
      result = parser.read(response.data);
    }

    if (result) {
      var options = Object.assign({}, opt_customOptions, Object(ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_10__["optionsFromCapabilities"])(result, {
        matrixSet: opt_matrixSet,
        crossOrigin: 'anonymous',
        layer: layerName
      }));
      var source = new ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_10__["default"](options);

      if (opt_dimensions && !Object(ol_obj_js__WEBPACK_IMPORTED_MODULE_7__["isEmpty"])(opt_dimensions)) {
        source.updateDimensions(opt_dimensions);
      }

      layer.setSource(source);
      var layers = result.Contents.Layer;
      var l = ol_array_js__WEBPACK_IMPORTED_MODULE_1__["find"](layers, function (elt, index, array) {
        return elt.Identifier == layerName;
      });

      if (!l) {
        return $q.reject("Layer " + layerName + " not abalable in WMTS capabilities from " + capabilitiesURL);
      }

      layer.set('capabilitiesStyles', l.Style);
      return $q.resolve(layer);
    }

    return $q.reject("Failed to get WMTS capabilities from " + capabilitiesURL);
  });
};

LayerHelper.prototype.createWMTSLayerFromCapabilititesObj = function (capabilities, layerCap, opt_dimensions) {
  var options = Object(ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_10__["optionsFromCapabilities"])(capabilities, {
    crossOrigin: 'anonymous',
    layer: layerCap.Identifier
  });
  console.assert(options);
  var source = new ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_10__["default"](options);

  if (opt_dimensions && !Object(ol_obj_js__WEBPACK_IMPORTED_MODULE_7__["isEmpty"])(opt_dimensions)) {
    source.updateDimensions(opt_dimensions);
  }

  var result = new ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_5__["default"]({
    preload: Infinity,
    source: source
  });
  result.set('capabilitiesStyles', layerCap.Style);
  return result;
};

LayerHelper.prototype.createBasicGroup = function (opt_layers) {
  var group = new ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_3__["default"]();

  if (opt_layers) {
    group.setLayers(opt_layers);
  }

  return group;
};

LayerHelper.prototype.getGroupFromMap = function (map, groupName) {
  var groups = map.getLayerGroup().getLayers();
  var group;
  groups.getArray().some(function (existingGroup) {
    if (existingGroup.get(GROUP_KEY) === groupName) {
      group = existingGroup;
      return true;
    } else {
      return false;
    }
  });

  if (!group) {
    group = this.createBasicGroup();
    group.set(GROUP_KEY, groupName);
    map.addLayer(group);
  }

  return group;
};

LayerHelper.prototype.getFlatLayers = function (layer) {
  if (layer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_3__["default"]) {
    var sublayers = layer.getLayers().getArray();
    var hasGroupLayer = sublayers.some(function (sublayer) {
      return sublayer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_3__["default"];
    });

    if (!hasGroupLayer) {
      return sublayers.slice();
    }
  }

  return this.getFlatLayers_(layer, [], undefined);
};

LayerHelper.prototype.getFlatLayers_ = function (layer, array, computedOpacity) {
  var _this = this;

  var opacity = layer.getOpacity();

  if (computedOpacity !== undefined) {
    computedOpacity *= opacity;
  } else {
    computedOpacity = opacity;
  }

  if (layer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_3__["default"]) {
    var sublayers = layer.getLayers();
    sublayers.forEach(function (l) {
      _this.getFlatLayers_(l, array, computedOpacity);
    });
  } else if (layer instanceof ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
    if (!array.includes(layer)) {
      layer.set('inheritedOpacity', computedOpacity, true);
      array.push(layer);
    }
  }

  return array;
};

LayerHelper.prototype.getLayerByName = function (layerName, layers) {
  var _this2 = this;

  var found = null;
  layers.some(function (layer) {
    if (layer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_3__["default"]) {
      var sublayers = layer.getLayers().getArray();
      found = _this2.getLayerByName(layerName, sublayers);
    } else if (layer.get('layerNodeName') === layerName) {
      found = layer;
    }

    return !!found;
  });
  return found;
};

LayerHelper.prototype.getWMTSLegendURL = function (layer) {
  var url;
  var styles = layer.get('capabilitiesStyles');

  if (styles !== undefined) {
    var legendURL = styles[0].legendURL;

    if (legendURL !== undefined) {
      url = legendURL[0].href;
    }
  }

  return url;
};

LayerHelper.prototype.getWMSLegendURL = function (url, layerName, opt_scale, opt_legendRule, opt_legendWidth, opt_legendHeight, opt_servertype, opt_dpi, opt_bbox, opt_srs, opt_additionalQueryString) {
  if (!url) {
    return undefined;
  }

  var queryString = {
    FORMAT: 'image/png',
    TRANSPARENT: true,
    SERVICE: 'WMS',
    VERSION: '1.1.1',
    REQUEST: 'GetLegendGraphic',
    LAYER: layerName
  };

  if (opt_scale !== undefined) {
    queryString.SCALE = opt_scale;
  }

  if (opt_legendRule !== undefined) {
    queryString.RULE = opt_legendRule;

    if (opt_legendWidth !== undefined) {
      queryString.WIDTH = opt_legendWidth;
    }

    if (opt_legendHeight !== undefined) {
      queryString.HEIGHT = opt_legendHeight;
    }
  }

  if (opt_servertype == 'qgis') {
    if (opt_dpi != undefined) {
      queryString.DPI = opt_dpi;
    }

    if (opt_bbox != undefined && opt_srs != undefined && opt_scale != undefined && opt_dpi != undefined && opt_legendRule == undefined) {
      queryString.BBOX = opt_bbox.join(',');
      queryString.SRS = opt_srs;
      queryString.WIDTH = Math.round((opt_bbox[2] - opt_bbox[0]) / opt_scale * 39.37 * opt_dpi);
      queryString.HEIGHT = Math.round((opt_bbox[3] - opt_bbox[1]) / opt_scale * 39.37 * opt_dpi);
    }
  }

  if (opt_additionalQueryString) {
    Object.assign(queryString, opt_additionalQueryString);
  }

  return Object(ol_uri_js__WEBPACK_IMPORTED_MODULE_11__["appendParams"])(url, queryString);
};

LayerHelper.prototype.isLayerVisible = function (layer, map) {
  if (!layer.getVisible()) {
    return false;
  }

  var currentResolution = map.getView().getResolution();

  if (currentResolution === undefined) {
    throw new Error('Missing resolution');
  }

  return currentResolution > layer.getMinResolution() && currentResolution < layer.getMaxResolution();
};

LayerHelper.prototype.refreshWMSLayer = function (layer) {
  var source_ = layer.getSource();
  console.assert(source_ instanceof ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_8__["default"] || source_ instanceof ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_9__["default"]);
  var source = source_;
  var params = source.getParams();
  params[REFRESH_PARAM] = Math.random();
  source.updateParams(params);
};

LayerHelper.prototype.setZIndexToFirstLevelChildren = function (element, ZIndex) {
  if (element instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_3__["default"]) {
    var innerGroupLayers = element.getLayers();
    innerGroupLayers.forEach(function (innerLayer) {
      return innerLayer.setZIndex(ZIndex);
    });
  }
};

LayerHelper.prototype.updateWMSLayerState = function (layer, names, opt_time) {
  if (names.length <= 0) {
    layer.setVisible(false);
  } else {
    layer.setVisible(true);
    var source = layer.getSource();

    if (!(source instanceof ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_8__["default"])) {
      throw new Error('Wrong source type');
    }

    if (opt_time) {
      source.updateParams({
        'LAYERS': names,
        'TIME': opt_time
      });
    } else {
      source.updateParams({
        'LAYERS': names
      });
    }
  }
};

LayerHelper.prototype.getQuerySourceIds = function (layer) {
  return layer.get('querySourceIds');
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoLayerHelper', []);
module.service('ngeoLayerHelper', LayerHelper);
module.value('ngeoTilesPreloadingLimit', Infinity);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/map/component.js":
/*!******************************!*\
  !*** ./src/map/component.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
mapComponent.$inject = ["$window"];



var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMap', []);

function mapComponent($window) {
  return {
    restrict: 'A',
    link: function link(scope, element, attrs) {
      var attr = 'ngeoMap';
      var prop = attrs[attr];
      var map = scope.$eval(prop);
      console.assert(map instanceof ol_Map_js__WEBPACK_IMPORTED_MODULE_2__["default"]);
      map.setTarget(element[0]);
      var manageResizeAttr = 'ngeoMapManageResize';
      var manageResizeProp = attrs[manageResizeAttr];
      var manageResize = scope.$eval(manageResizeProp);

      if (manageResize) {
        var resizeTransitionAttr = 'ngeoMapResizeTransition';
        var resizeTransitionProp = attrs[resizeTransitionAttr];
        var resizeTransition = scope.$eval(resizeTransitionProp);
        Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])($window, 'resize', function () {
          if (resizeTransition) {
            var start = Date.now();
            var loop = true;

            var adjustSize = function adjustSize() {
              map.updateSize();
              map.renderSync();

              if (loop) {
                $window.requestAnimationFrame(adjustSize);
              }

              if (Date.now() - start > resizeTransition) {
                loop = false;
              }
            };

            adjustSize();
          } else {
            map.updateSize();
          }
        });
      }
    }
  };
}

module.directive('ngeoMap', mapComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/map/module.js":
/*!***************************!*\
  !*** ./src/map/module.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_map_BackgroundLayerMgr_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/map/BackgroundLayerMgr.js */ "./src/map/BackgroundLayerMgr.js");
/* harmony import */ var ngeo_map_component_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/map/component.js */ "./src/map/component.js");
/* harmony import */ var ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/map/FeatureOverlayMgr.js */ "./src/map/FeatureOverlayMgr.js");
/* harmony import */ var ngeo_map_recenter_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/map/recenter.js */ "./src/map/recenter.js");
/* harmony import */ var ngeo_map_resizemap_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/map/resizemap.js */ "./src/map/resizemap.js");
/* harmony import */ var ngeo_map_scaleselector_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/map/scaleselector.js */ "./src/map/scaleselector.js");







/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMapModule', [ngeo_map_BackgroundLayerMgr_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_map_component_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_map_FeatureOverlayMgr_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_map_recenter_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_map_resizemap_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_map_scaleselector_js__WEBPACK_IMPORTED_MODULE_6__["default"].name]));

/***/ }),

/***/ "./src/map/recenter.js":
/*!*****************************!*\
  !*** ./src/map/recenter.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoRecenter', []);

function mapResenterComponent() {
  return {
    restrict: 'A',
    link: function link($scope, $element, $attrs) {
      var mapExpr = $attrs.ngeoRecenterMap;
      var map = $scope.$eval(mapExpr);

      function recenter(element) {
        var extent = element.attr('ngeo-extent');

        if (extent !== undefined) {
          var size = map.getSize();

          if (size === undefined) {
            throw new Error('Missing size');
          }

          map.getView().fit($scope.$eval(extent), {
            size: size
          });
        }

        var zoom = element.attr('ngeo-zoom');

        if (zoom !== undefined) {
          map.getView().setZoom($scope.$eval(zoom));
        }
      }

      $element.on('click', '*', function (event) {
        recenter(angular__WEBPACK_IMPORTED_MODULE_0___default.a.element($(this)));
      });

      var ce = function ce(event) {
        var selected = event.target.options[event.target.selectedIndex];
        recenter(angular__WEBPACK_IMPORTED_MODULE_0___default.a.element(selected));
      };

      $element.on({
        change: ce
      });
    }
  };
}

module.directive('ngeoRecenter', mapResenterComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/map/resizemap.js":
/*!******************************!*\
  !*** ./src/map/resizemap.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
mapResizeComponent.$inject = ["$window"];


var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoResizemap', []);

function mapResizeComponent($window) {
  var duration = 1000;
  return {
    restrict: 'A',
    link: function link(scope, element, attrs) {
      var attr = 'ngeoResizemap';
      var prop = attrs[attr];
      var map = scope.$eval(prop);
      console.assert(map instanceof ol_Map_js__WEBPACK_IMPORTED_MODULE_1__["default"]);
      var stateExpr = attrs.ngeoResizemapState;
      console.assert(stateExpr !== undefined);
      var start;
      var animationDelayKey;

      var animationDelay = function animationDelay() {
        map.updateSize();
        map.renderSync();

        if (Date.now() - start < duration) {
          animationDelayKey = $window.requestAnimationFrame(animationDelay);
        }
      };

      element.on('transitionend', function () {
        map.updateSize();
        map.renderSync();
      });
      scope.$watch(stateExpr, function (newVal, oldVal) {
        if (newVal != oldVal) {
          start = Date.now();
          $window.cancelAnimationFrame(animationDelayKey);
          animationDelayKey = $window.requestAnimationFrame(animationDelay);
        }
      });
    }
  };
}

module.directive('ngeoResizemap', mapResizeComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/map/scaleselector.html":
/*!************************************!*\
  !*** ./src/map/scaleselector.html ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="btn-group btn-block" ng-class="::{\'dropup\': scaleselectorCtrl.options.dropup}">\n  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">\n    <span ng-bind-html="scaleselectorCtrl.currentScale | ngeoScalify | ngeoTrustHtml"></span>\n  </button>\n  <ul class="dropdown-menu btn-block" role="menu">\n    <li ng-repeat="zoomLevel in ::scaleselectorCtrl.zoomLevels">\n      <a href ng-click="scaleselectorCtrl.changeZoom(zoomLevel)"\n         ng-bind-html="scaleselectorCtrl.getScale(zoomLevel) | ngeoScalify | ngeoTrustHtml">\n      </a>\n    </li>\n  </ul>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./src/map/scaleselector.js":
/*!**********************************!*\
  !*** ./src/map/scaleselector.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var bootstrap_js_src_dropdown_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! bootstrap/js/src/dropdown.js */ "./node_modules/bootstrap/js/src/dropdown.js");





var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoScaleselector', []);
module.value('ngeoScaleselectorTemplateUrl', function (element, attrs) {
  var templateUrl = attrs.ngeoScaleselectorTemplateurl;
  return templateUrl !== undefined ? templateUrl : 'ngeo/map/scaleselector';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/map/scaleselector', __webpack_require__(/*! ./scaleselector.html */ "./src/map/scaleselector.html"));
}]);

var mapScaleselectorComponent = function mapScaleselectorComponent(ngeoScaleselectorTemplateUrl) {
  return {
    restrict: 'A',
    scope: true,
    controller: 'NgeoScaleselectorController',
    templateUrl: ngeoScaleselectorTemplateUrl
  };
};

mapScaleselectorComponent.$inject = ["ngeoScaleselectorTemplateUrl"];
mapScaleselectorComponent.$inject = ["ngeoScaleselectorTemplateUrl"];
module.directive('ngeoScaleselector', mapScaleselectorComponent);

var ScaleselectorController = function () {
  ScaleselectorController.$inject = ["$scope", "$element", "$attrs"];

  function ScaleselectorController($scope, $element, $attrs) {
    var _this = this;

    var scalesExpr = $attrs.ngeoScaleselector;
    this.scales = $scope.$eval(scalesExpr);
    console.assert(this.scales !== undefined);
    this.zoomLevels = [];
    $scope.$watch(function () {
      return Object.keys(_this.scales).length;
    }, function (newLength) {
      _this.zoomLevels = Object.keys(_this.scales).map(Number);

      _this.zoomLevels.sort(ol_array_js__WEBPACK_IMPORTED_MODULE_1__["numberSafeCompareFunction"]);
    });
    var mapExpr = $attrs.ngeoScaleselectorMap;
    this.map_ = $scope.$eval(mapExpr);
    console.assert(this.map_ instanceof ol_Map_js__WEBPACK_IMPORTED_MODULE_2__["default"]);
    var optionsExpr = $attrs.ngeoScaleselectorOptions;
    var options = $scope.$eval(optionsExpr);
    this.options = getOptions_(options);
    this.$scope_ = $scope;
    this.resolutionChangeKey_ = null;
    this.currentScale = undefined;
    var view = this.map_.getView();

    if (view !== null) {
      var currentZoom = this.map_.getView().getZoom();

      if (currentZoom !== undefined) {
        this.currentScale = this.getScale(currentZoom);
      }
    }

    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(this.map_, 'change:view', this.handleViewChange_, this);
    this.registerResolutionChangeListener_();
    $scope.scaleselectorCtrl = this;
  }

  var _proto = ScaleselectorController.prototype;

  _proto.getScale = function getScale(zoom) {
    return this.scales[zoom];
  };

  _proto.changeZoom = function changeZoom(zoom) {
    this.map_.getView().setZoom(zoom);
  };

  _proto.handleResolutionChange_ = function handleResolutionChange_(e) {
    var _this2 = this;

    var view = this.map_.getView();
    var currentScale = this.scales[view.getZoom()];

    if (currentScale !== undefined) {
      this.$scope_.$applyAsync(function () {
        _this2.currentScale = currentScale;
      });
    }
  };

  _proto.handleViewChange_ = function handleViewChange_(e) {
    this.registerResolutionChangeListener_();
    this.handleResolutionChange_(null);
  };

  _proto.registerResolutionChangeListener_ = function registerResolutionChangeListener_() {
    if (this.resolutionChangeKey_ !== null) {
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["unlistenByKey"])(this.resolutionChangeKey_);
    }

    var view = this.map_.getView();
    this.resolutionChangeKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(view, 'change:resolution', this.handleResolutionChange_, this);
  };

  return ScaleselectorController;
}();

function getOptions_(options) {
  var dropup = false;

  if (options !== undefined) {
    dropup = options.dropup == true;
  }

  return {
    dropup: dropup
  };
}

module.controller('NgeoScaleselectorController', ScaleselectorController);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/map/swipe.html":
/*!****************************!*\
  !*** ./src/map/swipe.html ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="ngeo-swipe-line-draggable">\n  <button class="ngeo-swipe-close btn prime btn-sm" ng-click="$ctrl.deactivate()">\n    <i class="fas fa-times"></i>\n  </button>\n  <div class="ngeo-swipe-line"></div>\n  <div class="ngeo-swipe-arrow">' +
((__t = (__webpack_require__(/*! ngeo/icons/swipe.svg?viewbox&height=1em */ "./src/icons/swipe.svg?viewbox&height=1em"))) == null ? '' : __t) +
'</div>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./src/map/swipe.js":
/*!**************************!*\
  !*** ./src/map/swipe.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_render_Event_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/render/Event.js */ "./node_modules/ol/render/Event.js");
/* harmony import */ var resize_observer_polyfill__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! resize-observer-polyfill */ "./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js");
/* harmony import */ var jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery-ui/ui/widgets/draggable.js */ "./node_modules/jquery-ui/ui/widgets/draggable.js");
/* harmony import */ var jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_4__);





var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMapswipe', []);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/src/map/swipe', __webpack_require__(/*! ./swipe.html */ "./src/map/swipe.html"));
}]);
module.value('ngeoMapswipeTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.ngeoMapswipeTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'ngeo/src/map/swipe';
});
ngeoMapswipeTemplateUrl.$inject = ["$attrs", "ngeoMapswipeTemplateUrl"];

function ngeoMapswipeTemplateUrl($attrs, ngeoMapswipeTemplateUrl) {
  return ngeoMapswipeTemplateUrl($attrs);
}

var SwipeController = function () {
  SwipeController.$inject = ["$scope", "$element", "$injector"];

  function SwipeController($scope, $element, $injector) {
    this.map;
    this.layer;
    this.scope_ = $scope;
    this.swipeValue;
    this.draggableElement_ = $element.find('.ngeo-swipe-line-draggable');
    this.layerKeys_ = [];
    this.resizeObserver_;
  }

  var _proto = SwipeController.prototype;

  _proto.$onInit = function $onInit() {
    var _this = this;

    this.swipeValue = this.swipeValue !== undefined ? this.swipeValue : 0.5;
    this.layerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(this.layer, 'prerender', this.handleLayerPrerender_, this));
    this.layerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(this.layer, 'postrender', this.handleLayerPostrender_, this));
    this.layerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(this.layer, 'change:visible', this.handleLayerVisibleChange_, this));
    var halfDraggableWidth = this.draggableElement_.width() / 2;
    this.draggableElement_.draggable({
      axis: 'x',
      containment: 'parent',
      drag: function drag() {
        var parentWidth = _this.draggableElement_.parent().width();

        var position = _this.draggableElement_.position().left + halfDraggableWidth;
        _this.swipeValue = position / parentWidth;

        _this.map.render();
      }
    });
    this.resizeObserver_ = new resize_observer_polyfill__WEBPACK_IMPORTED_MODULE_3__["default"](function () {
      var parentWidth = _this.draggableElement_.parent().width();

      _this.draggableElement_.css('left', parentWidth * _this.swipeValue - halfDraggableWidth);
    });
    this.resizeObserver_.observe(this.draggableElement_.parent().get(0));
  };

  _proto.deactivate = function deactivate() {
    this.layer = null;
    this.map.render();
  };

  _proto.handleLayerPrerender_ = function handleLayerPrerender_(evt) {
    if (!(evt instanceof ol_render_Event_js__WEBPACK_IMPORTED_MODULE_2__["default"])) {
      return;
    }

    var ctx = evt.context;

    if (!ctx) {
      return;
    }

    var width = ctx.canvas.width * this.swipeValue;
    ctx.save();
    ctx.beginPath();
    ctx.rect(0, 0, width, ctx.canvas.height);
    ctx.clip();
  };

  _proto.handleLayerPostrender_ = function handleLayerPostrender_(evt) {
    if (evt instanceof ol_render_Event_js__WEBPACK_IMPORTED_MODULE_2__["default"]) {
      var ctx = evt.context;

      if (!ctx) {
        return;
      }

      ctx.restore();
    }
  };

  _proto.handleLayerVisibleChange_ = function handleLayerVisibleChange_() {
    if (!this.layer.getVisible()) {
      this.deactivate();
    }
  };

  _proto.$onDestroy = function $onDestroy() {
    this.layerKeys_.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["unlistenByKey"]);
    this.layerKeys_.length = 0;
    this.draggableElement_.draggable('destroy');
    this.resizeObserver_.disconnect();
  };

  return SwipeController;
}();

module.component('ngeoMapswipe', {
  controller: SwipeController,
  bindings: {
    map: '<',
    layer: '=',
    swipeValue: '='
  },
  templateUrl: ngeoMapswipeTemplateUrl
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/measure/area.js":
/*!*****************************!*\
  !*** ./src/measure/area.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_draw_Controller_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/draw/Controller.js */ "./src/draw/Controller.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_interaction_MeasureArea_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/interaction/MeasureArea.js */ "./src/interaction/MeasureArea.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
measureAreaComponent.$inject = ["$compile", "gettextCatalog", "$filter", "$injector"];






var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMeasurearea', [ngeo_draw_Controller_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);

function measureAreaComponent($compile, gettextCatalog, $filter, $injector) {
  return {
    restrict: 'A',
    require: '^^ngeoDrawfeature',
    link: function link($scope, element, attrs, drawFeatureCtrl) {
      if (!drawFeatureCtrl) {
        throw new Error('Missing drawFeatureCtrl');
      }

      var helpMsg = gettextCatalog.getString('Click to start drawing polygon');
      var contMsg = gettextCatalog.getString('Click to continue drawing<br>' + 'Double-click or click starting point to finish');
      var options = {
        style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_5__["default"](),
        startMsg: $compile("<div translate>" + helpMsg + "</div>")($scope)[0],
        continueMsg: $compile("<div translate>" + contMsg + "</div>")($scope)[0]
      };

      if ($injector.has('ngeoMeasurePrecision')) {
        options.precision = $injector.get('ngeoMeasurePrecision');
      }

      var measureArea = new ngeo_interaction_MeasureArea_js__WEBPACK_IMPORTED_MODULE_3__["default"]($filter('ngeoUnitPrefix'), gettextCatalog, options);
      drawFeatureCtrl.registerInteraction(measureArea);
      drawFeatureCtrl.measureArea = measureArea;
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(measureArea, 'measureend', drawFeatureCtrl.handleDrawEnd.bind(drawFeatureCtrl, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_2__["default"].POLYGON), drawFeatureCtrl);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_4__["listen"])(measureArea, 'change:active', drawFeatureCtrl.handleActiveChange, drawFeatureCtrl);
    }
  };
}

module.directive('ngeoMeasurearea', measureAreaComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/measure/azimut.js":
/*!*******************************!*\
  !*** ./src/measure/azimut.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_draw_Controller_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/draw/Controller.js */ "./src/draw/Controller.js");
/* harmony import */ var ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/misc/filters.js */ "./src/misc/filters.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_interaction_MeasureAzimut_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/interaction/MeasureAzimut.js */ "./src/interaction/MeasureAzimut.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
measureAzimutComponent.$inject = ["$compile", "gettextCatalog", "$filter", "$injector"];









var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMeasureazimut', [ngeo_draw_Controller_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);

function measureAzimutComponent($compile, gettextCatalog, $filter, $injector) {
  return {
    restrict: 'A',
    require: '^^ngeoDrawfeature',
    link: function link($scope, element, attrs, drawFeatureCtrl) {
      if (!drawFeatureCtrl) {
        throw new Error('Missing drawFeatureCtrl');
      }

      var helpMsg = gettextCatalog.getString('Click to start drawing circle');
      var contMsg = gettextCatalog.getString('Click to finish');
      var options = {
        style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_8__["default"](),
        startMsg: $compile("<div translate>" + helpMsg + "</div>")($scope)[0],
        continueMsg: $compile("<div translate>" + contMsg + "</div>")($scope)[0]
      };

      if ($injector.get('ngeoMeasurePrecision')) {
        options.precision = $injector.get('ngeoMeasurePrecision');
      }

      if ($injector.get('ngeoMeasureDecimals')) {
        options.decimals = $injector.get('ngeoMeasureDecimals');
      }

      var measureAzimut = new ngeo_interaction_MeasureAzimut_js__WEBPACK_IMPORTED_MODULE_4__["default"]($filter('ngeoUnitPrefix'), $filter('number'), options);
      drawFeatureCtrl.registerInteraction(measureAzimut);
      drawFeatureCtrl.measureAzimut = measureAzimut;
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(measureAzimut, 'measureend', function (event) {
        var myEvent = event;
        var geometry = myEvent.detail.feature.getGeometry();
        var circle = geometry.getGeometries()[1];
        var polygon = Object(ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_7__["fromCircle"])(circle, 64);
        myEvent.detail.feature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_6__["default"](polygon);
        var azimut = Object(ngeo_interaction_MeasureAzimut_js__WEBPACK_IMPORTED_MODULE_4__["getAzimut"])(geometry.getGeometries()[0]);
        myEvent.detail.feature.set('azimut', azimut);
        drawFeatureCtrl.handleDrawEnd(ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__["default"].CIRCLE, event);
      }, drawFeatureCtrl);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(measureAzimut, 'change:active', drawFeatureCtrl.handleActiveChange, drawFeatureCtrl);
    }
  };
}

module.directive('ngeoMeasureazimut', measureAzimutComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/measure/length.js":
/*!*******************************!*\
  !*** ./src/measure/length.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_draw_Controller_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/draw/Controller.js */ "./src/draw/Controller.js");
/* harmony import */ var ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/misc/filters.js */ "./src/misc/filters.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_interaction_MeasureLength_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/interaction/MeasureLength.js */ "./src/interaction/MeasureLength.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
measureLengthComponent.$inject = ["$compile", "gettextCatalog", "$filter", "$injector"];







var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMeasurelength', [ngeo_draw_Controller_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);

function measureLengthComponent($compile, gettextCatalog, $filter, $injector) {
  return {
    restrict: 'A',
    require: '^^ngeoDrawfeature',
    link: function link($scope, element, attrs, drawFeatureCtrl) {
      if (!drawFeatureCtrl) {
        throw new Error('Missing drawFeatureCtrl');
      }

      var helpMsg = gettextCatalog.getString('Click to start drawing line');
      var contMsg = gettextCatalog.getString('Click to continue drawing<br>' + 'Double-click or click last point to finish');
      var options = {
        style: new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_6__["default"](),
        startMsg: $compile("<div translate>" + helpMsg + "</div>")($scope)[0],
        continueMsg: $compile("<div translate>" + contMsg + "</div>")($scope)[0]
      };

      if ($injector.has('ngeoMeasurePrecision')) {
        options.precision = $injector.get('ngeoMeasurePrecision');
      }

      if ($injector.has('ngeoSnappingTolerance')) {
        options.tolerance = $injector.get('ngeoSnappingTolerance');
      }

      if ($injector.has('ngeoSnappingSource')) {
        options.source = $injector.get('ngeoSnappingSource');
      }

      var measureLength = new ngeo_interaction_MeasureLength_js__WEBPACK_IMPORTED_MODULE_4__["default"]($filter('ngeoUnitPrefix'), gettextCatalog, options);
      drawFeatureCtrl.registerInteraction(measureLength);
      drawFeatureCtrl.measureLength = measureLength;
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(measureLength, 'measureend', drawFeatureCtrl.handleDrawEnd.bind(drawFeatureCtrl, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_3__["default"].LINE_STRING), drawFeatureCtrl);
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(measureLength, 'change:active', drawFeatureCtrl.handleActiveChange, drawFeatureCtrl);
    }
  };
}

module.directive('ngeoMeasurelength', measureLengthComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/message/Disclaimer.js":
/*!***********************************!*\
  !*** ./src/message/Disclaimer.js ***!
  \***********************************/
/*! exports provided: MessageDisclaimerService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageDisclaimerService", function() { return MessageDisclaimerService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var bootstrap_js_src_alert_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bootstrap/js/src/alert.js */ "./node_modules/bootstrap/js/src/alert.js");
/* harmony import */ var ngeo_message_Popup_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/message/Popup.js */ "./src/message/Popup.js");
/* harmony import */ var ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/message/Message.js */ "./src/message/Message.js");
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/sass/font.scss */ "./src/sass/font.scss");
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_4__);
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }






var MessageDisclaimerService = function (_ngeoMessageMessage) {
  MessageDisclaimerService.$inject = ["$sce", "gettextCatalog", "ngeoCreatePopup"];

  _inheritsLoose(MessageDisclaimerService, _ngeoMessageMessage);

  function MessageDisclaimerService($sce, gettextCatalog, ngeoCreatePopup) {
    var _this;

    _this = _ngeoMessageMessage.call(this) || this;
    _this.sce_ = $sce;
    _this.gettextCatalog_ = gettextCatalog;
    _this.createPopup_ = ngeoCreatePopup;
    var container = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element('<div class="ngeo-disclaimer"></div>');
    angular__WEBPACK_IMPORTED_MODULE_0___default.a.element(document.body).append(container);
    _this.container_ = container;
    _this.messages_ = {};
    _this.messagesConsumerCount_ = {};
    _this.uids_ = {};
    return _this;
  }

  var _proto = MessageDisclaimerService.prototype;

  _proto.alert = function alert(object) {
    this.show(object);
  };

  _proto.close = function close(object) {
    var _this2 = this;

    var msgObjects = this.getMessageObjects(object);
    msgObjects.forEach(function (message) {
      return _this2.closeMessage_(message);
    });
  };

  _proto.showMessage = function showMessage(message) {
    var _this3 = this;

    var gettextCatalog = this.gettextCatalog_;
    var type = message.type;
    console.assert(typeof type == 'string', 'Type should be set.');
    var uid = this.getMessageUid_(message);

    if (this.uids_[uid]) {
      return;
    }

    this.uids_[uid] = true;

    if (message.popup === true) {
      var popup = this.createPopup_();
      var content = this.sce_.trustAsHtml(message.msg);
      popup.open({
        autoDestroy: true,
        content: content,
        title: '&nbsp;'
      });
      popup.scope.$watch('open', function (newVal) {
        if (!newVal) {
          _this3.closeMessage_(message);
        }
      });
      this.messages_[uid] = popup;
    } else {
      var compatibleMessageUid = this.getCompatibleMessageUid_(message);

      if (this.messages_[compatibleMessageUid]) {
        this.messagesConsumerCount_[compatibleMessageUid]++;
        return;
      }

      var classNames = ['alert', 'fade', 'alert-dismissible', 'show'];

      switch (type) {
        case ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_3__["MessageType"].ERROR:
          classNames.push('alert-danger');
          break;

        case ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_3__["MessageType"].INFORMATION:
          classNames.push('alert-info');
          break;

        case ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_3__["MessageType"].SUCCESS:
          classNames.push('alert-success');
          break;

        case ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_3__["MessageType"].WARNING:
          classNames.push('alert-warning');
          break;

        default:
          break;
      }

      var el = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element("<div role=\"alert\" class=\"" + classNames.join(' ') + "\"></div>");
      var button = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element("<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"" + gettextCatalog.getString('Close') + "\"><span aria-hidden=\"true\" class=\"fa fa-times\"></span></button>");
      var msg = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element('<span />').html(message.msg);
      el.append(button).append(msg);
      var container;

      if (message.target) {
        container = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element(message.target);
      } else {
        container = this.container_;
      }

      container.append(el);
      el.addClass('show');
      el.on('closed.bs.alert', function () {
        _this3.closeMessage_(message, true);
      });
      this.messages_[compatibleMessageUid] = el;
      this.messagesConsumerCount_[compatibleMessageUid] = 1;
    }
  };

  _proto.getMessageUid_ = function getMessageUid_(message) {
    return message.msg + "-" + message.type + "-" + message.layerUid;
  };

  _proto.getCompatibleMessageUid_ = function getCompatibleMessageUid_(message) {
    return message.msg + "-" + message.type;
  };

  _proto.closeMessage_ = function closeMessage_(message, force) {
    if (force === void 0) {
      force = false;
    }

    var uid = this.getMessageUid_(message);

    if (!this.uids_[uid]) {
      return;
    }

    delete this.uids_[uid];
    var compatibleMessageUid = this.getCompatibleMessageUid_(message);

    if (force) {
      this.messagesConsumerCount_[compatibleMessageUid] = 0;
    } else {
      this.messagesConsumerCount_[compatibleMessageUid]--;
    }

    if (this.messagesConsumerCount_[compatibleMessageUid] > 0) {
      return;
    }

    var obj = this.messages_[compatibleMessageUid];

    if (obj instanceof ngeo_message_Popup_js__WEBPACK_IMPORTED_MODULE_2__["MessagePopup"]) {
      var mpObj = obj;

      if (mpObj.getOpen()) {
        mpObj.setOpen(false);
      }
    } else {
      var jqueryObj = obj;

      if (jqueryObj.hasClass('show')) {
        jqueryObj.alert('close');
      }
    }

    delete this.messages_[compatibleMessageUid];
    delete this.messagesConsumerCount_[compatibleMessageUid];
  };

  return MessageDisclaimerService;
}(ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_3__["default"]);
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDisclaimer', [ngeo_message_Popup_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.service('ngeoDisclaimer', MessageDisclaimerService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/message/Message.js":
/*!********************************!*\
  !*** ./src/message/Message.js ***!
  \********************************/
/*! exports provided: MessageType, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageType", function() { return MessageType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
var MessageType = {
  ERROR: 'error',
  INFORMATION: 'information',
  SUCCESS: 'success',
  WARNING: 'warning'
};

var _default = function () {
  function _default() {}

  var _proto = _default.prototype;

  _proto.showMessage = function showMessage(message) {};

  _proto.show = function show(object) {
    var msgObjects = this.getMessageObjects(object);
    msgObjects.forEach(this.showMessage, this);
  };

  _proto.error = function error(message) {
    this.show(this.getMessageObjects(message, MessageType.ERROR));
  };

  _proto.info = function info(message) {
    this.show(this.getMessageObjects(message, MessageType.INFORMATION));
  };

  _proto.success = function success(message) {
    this.show(this.getMessageObjects(message, MessageType.SUCCESS));
  };

  _proto.warn = function warn(message) {
    this.show(this.getMessageObjects(message, MessageType.WARNING));
  };

  _proto.getMessageObjects = function getMessageObjects(object, opt_type) {
    var msgObjects = [];
    var defaultType = MessageType.INFORMATION;

    if (typeof object === 'string') {
      msgObjects.push({
        msg: object,
        type: opt_type !== undefined ? opt_type : defaultType
      });
    } else if (Array.isArray(object)) {
      object.forEach(function (msg) {
        if (typeof object === 'string') {
          msgObjects.push({
            msg: msg,
            type: opt_type !== undefined ? opt_type : defaultType
          });
        } else {
          if (typeof msg == 'string') {
            throw new Error('Wrong msg type');
          }

          if (opt_type !== undefined) {
            msg.type = opt_type;
          }

          msgObjects.push(msg);
        }
      });
    } else {
      var msgObject = object;

      if (opt_type !== undefined) {
        msgObject.type = opt_type;
      }

      if (msgObject.type === undefined) {
        msgObject.type = defaultType;
      }

      msgObjects.push(msgObject);
    }

    return msgObjects;
  };

  return _default;
}();



/***/ }),

/***/ "./src/message/Notification.js":
/*!*************************************!*\
  !*** ./src/message/Notification.js ***!
  \*************************************/
/*! exports provided: MessageNotification, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageNotification", function() { return MessageNotification; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var bootstrap_js_src_alert_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bootstrap/js/src/alert.js */ "./node_modules/bootstrap/js/src/alert.js");
/* harmony import */ var ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/message/Message.js */ "./src/message/Message.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





var DEFAULT_DELAY = 7000;
var MessageNotification = function (_ngeoMessageMessage) {
  MessageNotification.$inject = ["$timeout"];

  _inheritsLoose(MessageNotification, _ngeoMessageMessage);

  function MessageNotification($timeout) {
    var _this;

    _this = _ngeoMessageMessage.call(this) || this;
    _this.timeout_ = $timeout;
    var container = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element('<div class="ngeo-notification"></div>');
    angular__WEBPACK_IMPORTED_MODULE_0___default.a.element(document.body).append(container);
    _this.container_ = container;
    _this.cache_ = {};
    return _this;
  }

  var _proto = MessageNotification.prototype;

  _proto.notify = function notify(object) {
    this.show(object);
  };

  _proto.clear = function clear() {
    for (var uid in this.cache_) {
      this.clearMessageByCacheItem_(this.cache_[parseInt(uid, 10)]);
    }
  };

  _proto.showMessage = function showMessage(message) {
    var _this2 = this;

    var type = message.type;
    console.assert(typeof type == 'string', 'Type should be set.');
    var classNames = ['alert', 'fade', 'show'];

    switch (type) {
      case ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__["MessageType"].ERROR:
        classNames.push('alert-danger');
        break;

      case ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__["MessageType"].INFORMATION:
        classNames.push('alert-info');
        break;

      case ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__["MessageType"].SUCCESS:
        classNames.push('alert-success');
        break;

      case ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__["MessageType"].WARNING:
        classNames.push('alert-warning');
        break;

      default:
        break;
    }

    var el = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element("<div class=\"" + classNames.join(' ') + "\"></div>");
    var container;

    if (message.target) {
      container = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element(message.target);
    } else {
      container = this.container_;
    }

    container.append(el);
    el.html(message.msg).addClass('show');
    var delay = message.delay !== undefined ? message.delay : DEFAULT_DELAY;
    var item = {
      el: el
    };
    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_3__["getUid"])(el);
    item.promise = this.timeout_(function () {
      el.alert('close');
      delete _this2.cache_[uid];
    }, delay);
    this.cache_[uid] = item;
  };

  _proto.clearMessageByCacheItem_ = function clearMessageByCacheItem_(item) {
    var el = item.el;
    var promise = item.promise;
    var uid = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_3__["getUid"])(el);
    el.alert('close');
    this.timeout_.cancel(promise);
    delete this.cache_[uid];
  };

  return MessageNotification;
}(ngeo_message_Message_js__WEBPACK_IMPORTED_MODULE_2__["default"]);
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoNotification', []);
module.service('ngeoNotification', MessageNotification);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/message/Popup.js":
/*!******************************!*\
  !*** ./src/message/Popup.js ***!
  \******************************/
/*! exports provided: MessagePopup, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessagePopup", function() { return MessagePopup; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_message_popupComponent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/message/popupComponent.js */ "./src/message/popupComponent.js");
Factory.$inject = ["$compile", "$rootScope", "$sce", "$timeout"];


function MessagePopup($compile, $rootScope, $sce, $timeout) {
  var _this = this;

  this.scope = $rootScope.$new(true);
  this.scope.$watch(function () {
    return _this.scope.open;
  }, function (open) {
    if (!open && _this.autoDestroy_) {
      _this.timeout_(function () {
        _this.destroy();
      });
    }
  });
  this.sce_ = $sce;
  this.timeout_ = $timeout;
  this.element_ = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element('<div ngeo-popup></div>');
  this.autoDestroy_ = false;
  $compile(this.element_)(this.scope);
  angular__WEBPACK_IMPORTED_MODULE_0___default.a.element(document.body).append(this.element_);
}

MessagePopup.prototype.getOpen = function () {
  return this.scope.open;
};

MessagePopup.prototype.setOpen = function (open) {
  this.scope.open = open;
};

MessagePopup.prototype.destroy = function () {
  this.scope.$destroy();
  this.element_.remove();
};

MessagePopup.prototype.setTitle = function (title) {
  var trustedTitle = this.sce_.trustAsHtml(title);
  this.scope.title = trustedTitle;
};

MessagePopup.prototype.setContent = function (content, opt_trusted) {
  this.scope.content = opt_trusted ? this.sce_.trustAsHtml(content) : content;
};

MessagePopup.prototype.setUrl = function (url) {
  var content = this.sce_.trustAsHtml("<iframe src=\"" + url + "\" width=\"100%\" height=\"100%\"></iframe>");
  this.setContent(content);
};

MessagePopup.prototype.setWidth = function (width) {
  this.element_.width(width);
};

MessagePopup.prototype.setHeight = function (height) {
  this.element_.height(height);
};

MessagePopup.prototype.setSize = function (width, height) {
  this.setWidth(width);
  this.setHeight(height);
};

MessagePopup.prototype.setAutoDestroy = function (autoDestroy) {
  this.autoDestroy_ = autoDestroy;
};

MessagePopup.prototype.addClass = function (cls) {
  this.element_.addClass(cls);
};

MessagePopup.prototype.open = function (options) {
  if (options.url) {
    this.setUrl(options.url);
  } else if (options.content) {
    this.setContent(options.content);
  } else {
    console.assert(false, 'ngeo.message.Popup options requirest "url" or "content".');
  }

  if (options.autoDestroy !== undefined) {
    this.setAutoDestroy(options.autoDestroy);
  }

  if (options.cls !== undefined) {
    this.addClass(options.cls);
  }

  if (options.height !== undefined) {
    this.setHeight(options.height);
  }

  if (options.title !== undefined) {
    this.setTitle(options.title);
  }

  if (options.width !== undefined) {
    this.setWidth(options.width);
  }

  this.setOpen(true);
};

function Factory($compile, $rootScope, $sce, $timeout) {
  return function () {
    return new MessagePopup($compile, $rootScope, $sce, $timeout);
  };
}

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoCreatePopup', [ngeo_message_popupComponent_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.factory('ngeoCreatePopup', Factory);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/message/displaywindowComponent.html":
/*!*************************************************!*\
  !*** ./src/message/displaywindowComponent.html ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n  class="ngeo-displaywindow"\n  ng-show="$ctrl.open"\n  title=""\n>\n\n  <div class="windowcontainer" ng-style="$ctrl.style">\n\n    <button\n      type="button"\n      class="btn fa-times close"\n      ng-click="$ctrl.close()">\n    </button>\n\n    <div class="animation-container">\n      <div class="slide-animation ">\n        <div\n          class="header ui-draggable-handle"\n          ng-if="$ctrl.title !== null">\n          <p class="title">{{$ctrl.title | translate}}</p>\n        </div>\n        <div\n          class="details content"\n          ng-if="$ctrl.content"\n          ng-bind-html="$ctrl.content">\n        </div>\n        <div\n          class="details iframe"\n          ng-if="$ctrl.url !== null">\n          <iframe\n            frameborder="0"\n            type="text/html"\n            height="100%"\n            width="100%"\n            ng-src="{{ $ctrl.urlTrusted }}"></iframe>\n        </div>\n        <div class="content-template-container"></div>\n      </div>\n    </div>\n\n  </div>\n\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./src/message/displaywindowComponent.js":
/*!***********************************************!*\
  !*** ./src/message/displaywindowComponent.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/sass/font.scss */ "./src/sass/font.scss");
/* harmony import */ var ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_font_scss__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var jquery_ui_ui_widgets_resizable_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jquery-ui/ui/widgets/resizable.js */ "./node_modules/jquery-ui/ui/widgets/resizable.js");
/* harmony import */ var jquery_ui_ui_widgets_resizable_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_resizable_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jquery-ui/ui/widgets/draggable.js */ "./node_modules/jquery-ui/ui/widgets/draggable.js");
/* harmony import */ var jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/sass/jquery-ui.scss */ "./src/sass/jquery-ui.scss");
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var angular_sanitize__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! angular-sanitize */ "./node_modules/angular-sanitize/index.js");
/* harmony import */ var angular_sanitize__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(angular_sanitize__WEBPACK_IMPORTED_MODULE_5__);
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }







var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMessageDisplaywindowComponent', ['ngSanitize']);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/message/displaywindowComponent', __webpack_require__(/*! ./displaywindowComponent.html */ "./src/message/displaywindowComponent.html"));
}]);
module.value('ngeoMessageDisplaywindowTemplateUrl', function ($attrs) {
  var templateUrl = $attrs['ngeoMessageDisplaywindowTemplateUrl'];
  return templateUrl !== undefined ? templateUrl : 'ngeo/message/displaywindowComponent';
});
ngeoMessageDisplaywindowTemplateUrl.$inject = ["$attrs", "ngeoMessageDisplaywindowTemplateUrl"];

function ngeoMessageDisplaywindowTemplateUrl($attrs, ngeoMessageDisplaywindowTemplateUrl) {
  return ngeoMessageDisplaywindowTemplateUrl($attrs);
}

var Controller = function () {
  Controller.$inject = ["$element", "$sce", "$scope", "$compile"];

  function Controller($element, $sce, $scope, $compile) {
    this.clearOnClose = false;
    this.content = null;
    this.contentTemplate = null;
    this.contentScope = null;
    this.draggable = false;
    this.draggableContainment = '';
    this.desktop = false;
    this.height = '';
    this.open = false;
    this.resizable = false;
    this.title = null;
    this.url = null;
    this.width = '';
    this.element_ = $element;
    this.sce_ = $sce;
    this.scope_ = $scope;
    this.compile_ = $compile;
  }

  var _proto = Controller.prototype;

  _proto.$onInit = function $onInit() {
    var _this = this;

    this.clearOnClose = this.clearOnClose !== false;
    this.content = this.content || null;
    this.contentTemplate = this.contentTemplate || null;
    this.contentScope = this.contentScope || null;
    this.desktop = this.desktop !== false;
    this.draggableContainment = this.draggableContainment || 'document';
    this.open = this.open === true;
    this.height = this.height || '240px';
    this.width = this.width || '240px';
    this.draggable = this.draggable !== undefined ? this.draggable : this.desktop;
    this.resizable = this.resizable !== undefined ? this.resizable : this.desktop;

    if (this.draggable) {
      this.element_.find('.ngeo-displaywindow .windowcontainer').draggable({
        'containment': this.draggableContainment,
        'handle': 'div.header'
      });
    }

    if (this.resizable) {
      this.element_.find('.ngeo-displaywindow .windowcontainer').resizable({
        'minHeight': 240,
        'minWidth': 240
      });
    }

    if (this.contentTemplate) {
      this.updateContentTemplate_();
    }

    this.scope_.$watch(function () {
      return _this.contentTemplate;
    }, function () {
      return _this.updateContentTemplate_();
    });
  };

  _proto.updateContentTemplate_ = function updateContentTemplate_() {
    if (!this.contentTemplate) {
      return;
    }

    var scope = this.contentScope || this.scope_;
    var compiled = this.compile_(this.contentTemplate)(scope);
    var displayWindow = this.element_.find('.ngeo-displaywindow .windowcontainer .animation-container .content-template-container');
    displayWindow.empty();
    displayWindow.append(compiled);
  };

  _proto.close = function close() {
    this.open = false;

    if (this.clearOnClose) {
      this.clear_();
    }
  };

  _proto.clear_ = function clear_() {
    this.content = null;
    this.title = null;
    this.url = null;
  };

  _createClass(Controller, [{
    key: "style",
    get: function get() {
      return {
        height: this.height,
        width: this.width
      };
    }
  }, {
    key: "urlTrusted",
    get: function get() {
      if (this.url) {
        return this.sce_.trustAsResourceUrl(this.url);
      }
    }
  }]);

  return Controller;
}();

var ngeoMessageDisplaywindowComponent = {
  bindings: {
    'clearOnClose': '<?',
    'content': '=?',
    'contentTemplate': '=?',
    'contentScope': '<?',
    'desktop': '<?',
    'draggable': '<?',
    'draggableContainment': '<?',
    'height': '=?',
    'open': '=?',
    'resizable': '<?',
    'title': '=?',
    'url': '=?',
    'width': '=?'
  },
  controller: Controller,
  templateUrl: ngeoMessageDisplaywindowTemplateUrl
};
module.component('ngeoDisplaywindow', ngeoMessageDisplaywindowComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/message/modalComponent.js":
/*!***************************************!*\
  !*** ./src/message/modalComponent.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery-ui/ui/widgets/draggable.js */ "./node_modules/jquery-ui/ui/widgets/draggable.js");
/* harmony import */ var jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_draggable_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/sass/jquery-ui.scss */ "./src/sass/jquery-ui.scss");
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var bootstrap_js_src_modal_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bootstrap/js/src/modal.js */ "./node_modules/bootstrap/js/src/modal.js");




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoModal', []);
var messageModalComponent = {
  template: "<div class=\"modal fade\" tabindex=\"-1\" role=\"dialog\">\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content\">\n        <ng-transclude></ng-transclude>\n      </div>\n    </div>\n  </div>",
  require: {
    'ngModel': 'ngModel'
  },
  transclude: true,
  controller: 'ngeoModalController',
  bindings: {
    'draggableHandle': '=?ngeodraggableHandle',
    'resizable': '<ngeoModalResizable',
    'closable': '<ngeoModalClosable'
  }
};
module.component('ngeoModal', messageModalComponent);

var Controller = function () {
  Controller.$inject = ["$scope", "$element"];

  function Controller($scope, $element) {
    this.$element_ = $element;
    this.$scope_ = $scope;
    this.modal_ = null;
    this.draggableHandle = '';
    this.closable = false;
    this.resizable = false;
    this.ngModel = null;
  }

  var _proto = Controller.prototype;

  _proto.$onInit = function $onInit() {
    this.closable = this.closable !== false;
    this.resizable = !!this.resizable;
    this.draggableHandle = this.draggableHandle || '.ui-draggable-handle';
  };

  _proto.$postLink = function $postLink() {
    var _this = this;

    this.modal_ = this.$element_.children();

    if (!this.closable) {
      this.modal_.attr('data-keyboard', 'false');
      this.modal_.attr('data-backdrop', 'static');
    }

    var dialog = this.modal_.find('.modal-dialog');
    dialog.draggable({
      handle: this.draggableHandle
    });

    if (this.resizable) {
      dialog.resizable();
    }

    if (!this.ngModel) {
      throw new Error('Missing model');
    }

    this.ngModel.$render = function () {
      if (!_this.ngModel) {
        throw new Error('Missing model');
      }

      if (!_this.modal_) {
        throw new Error('Missing modal');
      }

      _this.modal_.modal(_this.ngModel.$viewValue ? 'show' : 'hide');
    };

    this.modal_.on('shown.bs.modal hidden.bs.modal', function (e) {
      if (!_this.ngModel) {
        throw new Error('Missing model');
      }

      var type = e.type;
      console.assert(type == 'shown' || type == 'hidden');

      _this.ngModel.$setViewValue(type == 'shown');
    });
  };

  _proto.$onDestroy = function $onDestroy() {
    if (!this.modal_) {
      throw new Error('Missing modal');
    }

    this.modal_.modal('hide');
    var dialog = this.modal_.find('.modal-dialog');
    dialog.draggable('destroy');

    if (this.resizable) {
      dialog.resizable('destroy');
    }
  };

  return Controller;
}();

module.controller('ngeoModalController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/message/popoverComponent.js":
/*!*****************************************!*\
  !*** ./src/message/popoverComponent.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var bootstrap_js_src_tooltip_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bootstrap/js/src/tooltip.js */ "./node_modules/bootstrap/js/src/tooltip.js");
/* harmony import */ var bootstrap_js_src_popover_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bootstrap/js/src/popover.js */ "./node_modules/bootstrap/js/src/popover.js");
PopoverController.$inject = ["$scope"];



var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoPopover', []);

function messagePopoverComponent() {
  return {
    restrict: 'A',
    scope: true,
    controller: 'NgeoPopoverController as popoverCtrl',
    link: function link(scope, elem, attrs, ngeoPopoverCtrl) {
      if (!ngeoPopoverCtrl) {
        throw new Error('Missing ngeoPopoverCtrl');
      }

      ngeoPopoverCtrl.anchorElm.on('inserted.bs.popover', function () {
        ngeoPopoverCtrl.bodyElm.show();
        ngeoPopoverCtrl.shown = true;
      });
      ngeoPopoverCtrl.anchorElm.popover({
        container: 'body',
        html: true,
        content: ngeoPopoverCtrl.bodyElm,
        boundary: 'viewport',
        placement: attrs['ngeoPopoverPlacement'] || 'right'
      });

      if (attrs['ngeoPopoverDismiss']) {
        $(attrs['ngeoPopoverDismiss']).on('scroll', function () {
          ngeoPopoverCtrl.dismissPopover();
        });
      }

      scope.$on('$destroy', function () {
        ngeoPopoverCtrl.anchorElm.popover('dispose');
        ngeoPopoverCtrl.anchorElm.unbind('inserted.bs.popover');
        ngeoPopoverCtrl.anchorElm.unbind('hidden.bs.popover');
      });
    }
  };
}

function messagePopoverAnchorComponent() {
  return {
    restrict: 'A',
    require: '^^ngeoPopover',
    link: function link(scope, elem, attrs, ngeoPopoverCtrl) {
      if (!ngeoPopoverCtrl) {
        throw new Error('Missing ngeoPopoverCtrl');
      }

      ngeoPopoverCtrl.anchorElm = elem;
    }
  };
}

function messagePopoverContentComponent() {
  return {
    restrict: 'A',
    require: '^^ngeoPopover',
    link: function link(scope, elem, attrs, ngeoPopoverCtrl) {
      if (!ngeoPopoverCtrl) {
        throw new Error('Missing ngeoPopoverCtrl');
      }

      ngeoPopoverCtrl.bodyElm = elem;
      elem.hide();
    }
  };
}

function PopoverController($scope) {
  var _this = this;

  this.shown = false;
  this.anchorElm = null;
  this.bodyElm = null;

  var clickHandler = function clickHandler(clickEvent) {
    if (!_this.anchorElm) {
      throw new Error('Missing anchorElm');
    }

    if (!_this.bodyElm) {
      throw new Error('Missing bodyElm');
    }

    if (_this.anchorElm[0] !== clickEvent.target && _this.bodyElm.parent()[0] !== clickEvent.target && _this.bodyElm.parent().find(clickEvent.target).length === 0 && _this.shown) {
      _this.dismissPopover();
    }
  };

  document.body.addEventListener('click', clickHandler);
  $scope.$on('$destroy', function () {
    document.body.removeEventListener('click', clickHandler);
  });
}

PopoverController.prototype.dismissPopover = function () {
  if (!this.anchorElm) {
    throw new Error('Missing anchorElm');
  }

  this.shown = false;
  this.anchorElm.popover('hide');
};

module.controller('NgeoPopoverController', PopoverController);
module.directive('ngeoPopover', messagePopoverComponent);
module.directive('ngeoPopoverAnchor', messagePopoverAnchorComponent);
module.directive('ngeoPopoverContent', messagePopoverContentComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/message/popupComponent.js":
/*!***************************************!*\
  !*** ./src/message/popupComponent.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var angular_sanitize__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! angular-sanitize */ "./node_modules/angular-sanitize/index.js");
/* harmony import */ var angular_sanitize__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(angular_sanitize__WEBPACK_IMPORTED_MODULE_1__);
messagePopopComponent.$inject = ["ngeoPopupTemplateUrl"];


var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoPopup', ['ngSanitize']);
module.value('ngeoPopupTemplateUrl', function (element, attrs) {
  var templateUrl = attrs['ngeoPopupTemplateurl'];
  return templateUrl !== undefined ? templateUrl : 'ngeo/message/popupcomponent';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/message/popupcomponent', __webpack_require__(/*! ./popupcomponent.html */ "./src/message/popupcomponent.html"));
}]);

function messagePopopComponent(ngeoPopupTemplateUrl) {
  return {
    restrict: 'A',
    templateUrl: ngeoPopupTemplateUrl,
    link: function link(scope, element, attrs) {
      element.addClass('popover');

      scope['close'] = function (evt) {
        if (evt) {
          evt.stopPropagation();
          evt.preventDefault();
        }

        element.addClass('hidden');
      };

      scope.$watch('open', function (newVal, oldVal) {
        element.css('display', newVal ? 'block' : 'none');
      });
    }
  };
}

module.directive('ngeoPopup', messagePopopComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/message/popupcomponent.html":
/*!*****************************************!*\
  !*** ./src/message/popupcomponent.html ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<h4 class="popover-title ngeo-popup-title">\n  <span ng-bind-html="title"></span>\n  <button type="button" class="close" ng-click="open = false"> &times;</button>\n</h4>\n<div class="popover-body" ng-bind-html="content"></div>\n';

}
return __p
}

/***/ }),

/***/ "./src/misc/AutoProjection.js":
/*!************************************!*\
  !*** ./src/misc/AutoProjection.js ***!
  \************************************/
/*! exports provided: AutoProjectionService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AutoProjectionService", function() { return AutoProjectionService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_proj_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/proj.js */ "./node_modules/ol/proj.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");



function AutoProjectionService() {}

AutoProjectionService.prototype.stringToCoordinates = function (str) {
  var coords = str.match(/([\d\.']+)[\s,]+([\d\.']+)/);

  if (coords) {
    var x = parseFloat(coords[1].replace('\'', ''));
    var y = parseFloat(coords[2].replace('\'', ''));

    if (!isNaN(x) && !isNaN(y)) {
      return [x, y];
    }
  }

  return null;
};

AutoProjectionService.prototype.getProjectionList = function (projectionsCodes) {
  var code, proj;
  var projections = [];
  projectionsCodes.forEach(function (projection) {
    code = projection.toUpperCase();

    if (code.substr(0, 5) != 'EPSG:') {
      code = "EPSG:" + code;
    }

    proj = ol_proj_js__WEBPACK_IMPORTED_MODULE_1__["get"](code);

    if (proj !== null) {
      projections.push(proj);
    } else {
      console.error("The projection " + code + " is not defined in ol.proj.");
    }
  });
  return projections;
};

AutoProjectionService.prototype.tryProjections = function (coordinates, extent, viewProjection, opt_projections) {
  var position = null;

  if (opt_projections === undefined) {
    opt_projections = [viewProjection];
  }

  opt_projections.some(function (projection) {
    try {
      position = ol_proj_js__WEBPACK_IMPORTED_MODULE_1__["transform"](coordinates, projection, viewProjection);

      if (ol_extent_js__WEBPACK_IMPORTED_MODULE_2__["containsCoordinate"](extent, position)) {
        return true;
      }
    } catch (e) {}

    position = null;
    return false;
  });
  return position;
};

AutoProjectionService.prototype.tryProjectionsWithInversion = function (coordinates, extent, viewProjection, opt_projections) {
  var position = this.tryProjections(coordinates, extent, viewProjection, opt_projections);

  if (position === null) {
    position = this.tryProjections(coordinates.reverse(), extent, viewProjection, opt_projections);
  }

  return position;
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoAutoProjection', []);
module.service('ngeoAutoProjection', AutoProjectionService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/EventHelper.js":
/*!*********************************!*\
  !*** ./src/misc/EventHelper.js ***!
  \*********************************/
/*! exports provided: EventHelper, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventHelper", function() { return EventHelper; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");


function EventHelper() {
  this.listenerKeys_ = {};
}

EventHelper.prototype.addListenerKey = function (uid, key) {
  if (!this.listenerKeys_[uid]) {
    this.initListenerKey_(uid);
  }

  this.listenerKeys_[uid].push(key);
};

EventHelper.prototype.clearListenerKey = function (uid) {
  this.initListenerKey_(uid);
};

EventHelper.prototype.initListenerKey_ = function (uid) {
  if (!this.listenerKeys_[uid]) {
    this.listenerKeys_[uid] = [];
  } else {
    if (this.listenerKeys_[uid].length) {
      this.listenerKeys_[uid].forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["unlistenByKey"]);
      this.listenerKeys_[uid].length = 0;
    }
  }
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoEventHelper', []);
module.service('ngeoEventHelper', EventHelper);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/FeatureHelper.js":
/*!***********************************!*\
  !*** ./src/misc/FeatureHelper.js ***!
  \***********************************/
/*! exports provided: FeatureFormatType, FeatureHelper, getFilteredFeatureValues, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FeatureFormatType", function() { return FeatureFormatType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FeatureHelper", function() { return FeatureHelper; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilteredFeatureValues", function() { return getFilteredFeatureValues; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/filters.js */ "./src/misc/filters.js");
/* harmony import */ var ngeo_download_service_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/download/service.js */ "./src/download/service.js");
/* harmony import */ var ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/format/FeatureProperties.js */ "./src/format/FeatureProperties.js");
/* harmony import */ var ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/GeometryType.js */ "./src/GeometryType.js");
/* harmony import */ var ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/interaction/Measure.js */ "./src/interaction/Measure.js");
/* harmony import */ var ngeo_interaction_MeasureAzimut_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/interaction/MeasureAzimut.js */ "./src/interaction/MeasureAzimut.js");
/* harmony import */ var ol_color_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/color.js */ "./node_modules/ol/color.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/geom/MultiLineString.js */ "./node_modules/ol/geom/MultiLineString.js");
/* harmony import */ var ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/geom/MultiPoint.js */ "./node_modules/ol/geom/MultiPoint.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
/* harmony import */ var ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ol/geom/MultiPolygon.js */ "./node_modules/ol/geom/MultiPolygon.js");
/* harmony import */ var ol_geom_SimpleGeometry_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ol/geom/SimpleGeometry.js */ "./node_modules/ol/geom/SimpleGeometry.js");
/* harmony import */ var ol_format_GPX_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ol/format/GPX.js */ "./node_modules/ol/format/GPX.js");
/* harmony import */ var ol_format_KML_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ol/format/KML.js */ "./node_modules/ol/format/KML.js");
/* harmony import */ var ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ol/style/Circle.js */ "./node_modules/ol/style/Circle.js");
/* harmony import */ var ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ol/style/Fill.js */ "./node_modules/ol/style/Fill.js");
/* harmony import */ var ol_style_RegularShape_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ol/style/RegularShape.js */ "./node_modules/ol/style/RegularShape.js");
/* harmony import */ var ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ol/style/Stroke.js */ "./node_modules/ol/style/Stroke.js");
/* harmony import */ var ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ol/style/Style.js */ "./node_modules/ol/style/Style.js");
/* harmony import */ var ol_style_Text_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ol/style/Text.js */ "./node_modules/ol/style/Text.js");
FeatureHelper.$inject = ["$injector", "$filter"];

























var VertexStyleRegularShapeRadius = 6;
var FeatureFormatType = {
  GPX: 'GPX',
  KML: 'KML'
};
function FeatureHelper($injector, $filter) {
  this.$filter_ = $filter;
  this.decimals_ = undefined;

  if ($injector.has('ngeoMeasureDecimals')) {
    this.decimals_ = $injector.get('ngeoMeasureDecimals');
  }

  this.precision_ = undefined;

  if ($injector.has('ngeoMeasurePrecision')) {
    this.precision_ = $injector.get('ngeoMeasurePrecision');
  }

  this.numberFormat_ = $filter('number');
  this.unitPrefixFormat_ = $filter('ngeoUnitPrefix');
  this.ngeoNumberCoordinates_ = $filter('ngeoNumberCoordinates');
  this.pointFilterFn_ = null;
  this.pointFilterArgs_ = [];

  if ($injector.has('ngeoPointfilter')) {
    var filterElements = $injector.get('ngeoPointfilter').split(':');
    var filterName = filterElements.shift();
    var filter = this.$filter_(filterName);
    console.assert(typeof filter == 'function');
    this.pointFilterFn_ = filter;
    this.pointFilterArgs_ = filterElements;
  } else {
    this.pointFilterFn_ = null;
  }

  this.projection_ = null;
  this.download_ = $injector.get('ngeoDownload');
}

FeatureHelper.prototype.setProjection = function (projection) {
  this.projection_ = projection;
};

FeatureHelper.prototype.setStyle = function (feature, opt_select) {
  var styles = this.getStyle(feature);

  if (opt_select) {
    if (this.supportsVertex_(feature)) {
      styles.push(this.getVertexStyle());
    }

    styles.unshift(this.getHaloStyle_(feature));
  }

  feature.setStyle(styles);
};

FeatureHelper.prototype.getStyle = function (feature) {
  var type = this.getType(feature);
  var style;

  switch (type) {
    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].LINE_STRING:
      style = this.getLineStringStyle_(feature);
      break;

    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].POINT:
      style = this.getPointStyle_(feature);
      break;

    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].CIRCLE:
    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].POLYGON:
    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].RECTANGLE:
      style = this.getPolygonStyle_(feature);
      break;

    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].TEXT:
      style = this.getTextStyle_(feature);
      break;

    default:
      break;
  }

  if (!style) {
    throw new Error('Missing style');
  }

  var styles;

  if (style instanceof Array) {
    styles = style;
  } else {
    styles = [style];
  }

  return styles;
};

FeatureHelper.prototype.getLineStringStyle_ = function (feature) {
  var strokeWidth = this.getStrokeProperty(feature);
  var showLabel = this.getShowLabelProperty(feature);
  var showMeasure = this.getShowMeasureProperty(feature);
  var color = this.getRGBAColorProperty(feature);
  var styles = [new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
    stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
      color: color,
      width: strokeWidth
    })
  })];
  var textLabelValues = [];

  if (showMeasure) {
    textLabelValues.push(this.getMeasure(feature));
  }

  if (showLabel) {
    textLabelValues.push(this.getNameProperty(feature));
  }

  if (showLabel || showMeasure) {
    var textLabelValue = textLabelValues.join('\n');
    styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
      text: this.createTextStyle_({
        propertyName: '',
        name: '',
        text: textLabelValue
      })
    }));
  }

  return styles;
};

FeatureHelper.prototype.getPointStyle_ = function (feature) {
  var size = this.getSizeProperty(feature);
  var color = this.getRGBAColorProperty(feature);
  var showLabel = this.getShowLabelProperty(feature);
  var showMeasure = this.getShowMeasureProperty(feature);
  var styles = [new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
    image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_19__["default"]({
      radius: size,
      fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
        color: color
      })
    })
  })];
  var textLabelValues = [];

  if (showMeasure) {
    textLabelValues.push(this.getMeasure(feature));
  }

  if (showLabel) {
    textLabelValues.push(this.getNameProperty(feature));
  }

  if (showLabel || showMeasure) {
    var textLabelValue = textLabelValues.join('\n');
    var font_size = 10;
    var point_to_px = 1.3;
    styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
      text: this.createTextStyle_({
        propertyName: '',
        name: '',
        text: textLabelValue,
        size: font_size,
        offsetY: -(size + font_size / 2 * textLabelValues.length * point_to_px + 4)
      })
    }));
  }

  return styles;
};

FeatureHelper.prototype.optNumber = function (feature, attrib) {
  var value = feature.get(attrib);

  if (value !== undefined) {
    if (typeof value == 'string') {
      return +value;
    } else {
      return value;
    }
  } else {
    return undefined;
  }
};

FeatureHelper.prototype.getNumber = function (feature, attrib) {
  var value = feature.get(attrib);

  if (typeof value == 'string') {
    return +value;
  } else {
    return value;
  }
};

FeatureHelper.prototype.getPolygonStyle_ = function (feature) {
  var strokeWidth = this.getStrokeProperty(feature);
  var opacity = this.getOpacityProperty(feature);
  var color = this.getRGBAColorProperty(feature);
  var showLabel = this.getShowLabelProperty(feature);
  var showMeasure = this.getShowMeasureProperty(feature);
  var fillColor = color.slice();
  fillColor[3] = opacity;
  var azimut = this.optNumber(feature, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].AZIMUT);
  var styles = [new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
    fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
      color: fillColor
    }),
    stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
      color: color,
      width: strokeWidth
    })
  })];

  if (showMeasure || showLabel) {
    if (showMeasure && azimut !== undefined) {
      if (!this.projection_) {
        throw new Error('Missing projection');
      }

      var line = this.getRadiusLine(feature, azimut);
      var length = Object(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_5__["getFormattedLength"])(line, this.projection_, this.precision_, this.unitPrefixFormat_);
      styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        geometry: line,
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
          color: fillColor
        }),
        stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
          color: color,
          width: strokeWidth
        }),
        text: this.createTextStyle_({
          propertyName: '',
          name: '',
          text: length,
          angle: (azimut % 180 + 180) % 180 - 90
        })
      }));
      styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        geometry: new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_13__["default"](line.getLastCoordinate()),
        text: this.createTextStyle_({
          propertyName: '',
          name: '',
          text: this.numberFormat_(azimut, this.decimals_) + "\xB0",
          size: 10,
          offsetX: Math.cos((azimut - 90) * Math.PI / 180) * 20,
          offsetY: Math.sin((azimut - 90) * Math.PI / 180) * 20
        })
      }));

      if (showLabel) {
        styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
          text: this.createTextStyle_({
            propertyName: '',
            name: '',
            text: this.getNameProperty(feature),
            offsetY: -8,
            exceedLength: true
          })
        }));
      }
    } else {
      var textLabelValues = [];

      if (showMeasure) {
        textLabelValues.push(this.getMeasure(feature));
      }

      if (showLabel) {
        textLabelValues.push(this.getNameProperty(feature));
      }

      if (showLabel || showMeasure) {
        var textLabelValue = textLabelValues.join('\n');
        styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
          text: this.createTextStyle_({
            propertyName: '',
            name: '',
            text: textLabelValue,
            exceedLength: true
          })
        }));
      }
    }
  }

  return styles;
};

FeatureHelper.prototype.getTextStyle_ = function (feature) {
  return new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
    text: this.createTextStyle_({
      propertyName: '',
      name: '',
      rotateWithView: true,
      text: this.getNameProperty(feature),
      size: this.getSizeProperty(feature),
      angle: this.getAngleProperty(feature),
      color: this.getRGBAColorProperty(feature),
      width: this.getStrokeProperty(feature)
    })
  });
};

FeatureHelper.prototype.createEditingStyles = function (feature) {
  var white = [255, 255, 255, 1];
  var blue = [0, 153, 255, 1];
  var width = 3;
  var styles = [];
  var geom = feature.getGeometry();

  if (!geom) {
    throw new Error('Missing geom');
  }

  var type = geom.getType();

  if (type === 'Point') {
    styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
      image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_19__["default"]({
        radius: width * 2,
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
          color: blue
        }),
        stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
          color: white,
          width: width / 2
        })
      }),
      zIndex: Infinity
    }));
  } else {
    if (type === 'LineString') {
      styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
          color: white,
          width: width + 2
        })
      }));
      styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
          color: blue,
          width: width
        })
      }));
    } else {
      styles.push(new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
          color: blue,
          width: width / 2
        }),
        fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
          color: [255, 255, 255, 0.5]
        })
      }));
    }

    styles.push(this.getVertexStyle(true));
  }

  return styles;
};

FeatureHelper.prototype.getVertexInfoAtCoordinate = function (feature, coordinate, resolution) {
  var info = null;

  if (this.supportsVertexRemoval_(feature)) {
    var buffer = resolution * VertexStyleRegularShapeRadius;
    var coordinates = null;
    var coordinatess = null;
    var coordinatesss = null;
    var minNumCoordinates = -1;
    var geometry = feature.getGeometry();

    if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_10__["default"]) {
      coordinates = geometry.getCoordinates();
      minNumCoordinates = 2;
    } else if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_14__["default"]) {
      coordinatess = geometry.getCoordinates();
      minNumCoordinates = 4;
    } else if (geometry instanceof ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_11__["default"]) {
      coordinatess = geometry.getCoordinates();
      minNumCoordinates = 2;
    } else if (geometry instanceof ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_15__["default"]) {
      coordinatesss = geometry.getCoordinates();
      minNumCoordinates = 4;
    }

    if (coordinates) {
      var index = this.getCoordinateIndexThatHitsAt_(coordinates, coordinate, minNumCoordinates, buffer);

      if (index !== -1) {
        info = [index];
      }
    } else if (coordinatess) {
      var ii = coordinatess.length;

      for (var i = 0; i < ii; i++) {
        var _index = this.getCoordinateIndexThatHitsAt_(coordinatess[i], coordinate, minNumCoordinates, buffer);

        if (_index !== -1) {
          info = [i, _index];
          break;
        }
      }
    } else if (coordinatesss) {
      var _ii = coordinatesss.length;

      for (var _i = 0; _i < _ii; _i++) {
        var _coordinatess = coordinatesss[_i];
        var jj = _coordinatess.length;

        for (var j = 0; j < jj; j++) {
          var _index2 = this.getCoordinateIndexThatHitsAt_(_coordinatess[j], coordinate, minNumCoordinates, buffer);

          if (_index2 !== -1) {
            info = [_i, j, _index2];
            break;
          }
        }

        if (info) {
          break;
        }
      }
    }
  }

  return info;
};

FeatureHelper.prototype.getCoordinateIndexThatHitsAt_ = function (coordinates, coordinate, min, buffer) {
  var index = -1;
  var ii = coordinates.length;

  if (ii > min) {
    for (var i = 0; i < ii; i++) {
      var hits = ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["containsCoordinate"](ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["buffer"](ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["createOrUpdateFromCoordinate"](coordinates[i]), buffer), coordinate);

      if (hits) {
        index = i;
        break;
      }
    }
  }

  return index;
};

FeatureHelper.prototype.getVertexStyle = function (opt_incGeomFunc) {
  var incGeomFunc = opt_incGeomFunc !== undefined ? opt_incGeomFunc : true;
  var options = {
    image: new ol_style_RegularShape_js__WEBPACK_IMPORTED_MODULE_21__["default"]({
      radius: VertexStyleRegularShapeRadius,
      points: 4,
      angle: Math.PI / 4,
      fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
        color: [255, 255, 255, 0.5]
      }),
      stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
        color: [0, 0, 0, 1]
      })
    })
  };

  if (incGeomFunc) {
    options.geometry = function (feature) {
      var geom = feature.getGeometry();

      if (!(geom instanceof ol_geom_SimpleGeometry_js__WEBPACK_IMPORTED_MODULE_16__["default"])) {
        return;
      }

      if (geom.getType() == 'Point') {
        return;
      }

      var innerMultiCoordinates;
      var multiCoordinates = [];
      var coordinates = [];

      if (geom instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_10__["default"]) {
        coordinates = geom.getCoordinates();
      } else if (geom instanceof ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_11__["default"]) {
        multiCoordinates = geom.getCoordinates();
      } else if (geom instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_14__["default"]) {
        coordinates = geom.getCoordinates()[0];
      } else if (geom instanceof ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_15__["default"]) {
        innerMultiCoordinates = geom.getCoordinates();
      }

      if (innerMultiCoordinates) {
        for (var i = 0, ii = innerMultiCoordinates.length; i < ii; i++) {
          multiCoordinates = multiCoordinates.concat(innerMultiCoordinates[i]);
        }
      }

      for (var _i2 = 0, _ii2 = multiCoordinates.length; _i2 < _ii2; _i2++) {
        coordinates = coordinates.concat(multiCoordinates[_i2]);
      }

      if (coordinates.length) {
        return new ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_12__["default"](coordinates);
      } else {
        return geom;
      }
    };
  }

  return new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"](options);
};

FeatureHelper.prototype.removeVertex = function (feature, vertexInfo) {
  var deleted = false;
  var geometry = feature.getGeometry();

  if (!(geometry instanceof ol_geom_SimpleGeometry_js__WEBPACK_IMPORTED_MODULE_16__["default"])) {
    throw new Error('Wrong geometry type');
  }

  if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_10__["default"]) {
    var coordinates = geometry.getCoordinates();
    var index = vertexInfo[0];

    if (coordinates.length > 2) {
      coordinates.splice(index, 1);
      deleted = true;
    }

    if (deleted) {
      geometry.setCoordinates(coordinates);
    }
  } else if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_14__["default"]) {
    var _coordinates = geometry.getCoordinates();

    var indexOne = vertexInfo[0];
    var indexTwo = vertexInfo[1];
    var component = _coordinates[indexOne];

    if (component.length > 4) {
      component.splice(indexTwo, 1);
      deleted = true;

      if (indexTwo === 0) {
        component.pop();
        component.push(component[0]);
      }
    }

    if (deleted) {
      geometry.setCoordinates(_coordinates);
    }
  } else if (geometry instanceof ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_11__["default"]) {
    var _coordinates2 = geometry.getCoordinates();

    var _indexOne = vertexInfo[0];
    var _indexTwo = vertexInfo[1];
    var _component = _coordinates2[_indexOne];

    if (_component.length > 2) {
      _component.splice(_indexTwo, 1);

      deleted = true;
    }

    if (deleted) {
      geometry.setCoordinates(_coordinates2);
    }
  } else if (geometry instanceof ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_15__["default"]) {
    var _coordinates3 = geometry.getCoordinates();

    var _indexOne2 = vertexInfo[0];
    var _indexTwo2 = vertexInfo[1];
    var indexThree = vertexInfo[2];
    var _component2 = _coordinates3[_indexOne2][_indexTwo2];

    if (_component2.length > 4) {
      _component2.splice(indexThree, 1);

      deleted = true;

      if (indexThree === 0) {
        _component2.pop();

        _component2.push(_component2[0]);
      }
    }

    if (deleted) {
      geometry.setCoordinates(_coordinates3);
    }
  }
};

FeatureHelper.prototype.supportsVertex_ = function (feature) {
  var supported = [ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].LINE_STRING, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].MULTI_LINE_STRING, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].MULTI_POLYGON, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].POLYGON, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].RECTANGLE];
  var type = this.getType(feature);
  return supported.includes(type);
};

FeatureHelper.prototype.supportsVertexRemoval_ = function (feature) {
  var supported = [ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].LINE_STRING, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].MULTI_LINE_STRING, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].MULTI_POLYGON, ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].POLYGON];
  var type = this.getType(feature);
  return supported.includes(type);
};

FeatureHelper.prototype.getHaloStyle_ = function (feature) {
  var type = this.getType(feature);
  var style;
  var haloSize = 3;

  switch (type) {
    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].POINT:
      var size = this.getSizeProperty(feature);
      style = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        image: new ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_19__["default"]({
          radius: size + haloSize,
          fill: new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
            color: [255, 255, 255, 1]
          })
        })
      });
      break;

    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].LINE_STRING:
    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].CIRCLE:
    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].POLYGON:
    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].RECTANGLE:
      var strokeWidth = this.getStrokeProperty(feature);
      style = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        stroke: new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
          color: [255, 255, 255, 1],
          width: strokeWidth + haloSize * 2
        })
      });
      break;

    case ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].TEXT:
      style = new ol_style_Style_js__WEBPACK_IMPORTED_MODULE_23__["default"]({
        text: this.createTextStyle_({
          propertyName: '',
          name: '',
          rotateWithView: true,
          text: this.getNameProperty(feature),
          size: this.getSizeProperty(feature),
          angle: this.getAngleProperty(feature),
          width: haloSize * 3
        })
      });
      break;

    default:
      break;
  }

  if (!style) {
    throw new Error('Missing style');
  }

  return style;
};

function getFilteredFeatureValues(feature) {
  var properties = feature.getProperties();
  delete properties.boundedBy;
  delete properties[feature.getGeometryName()];
  delete properties.ngeo_feature_type_;
  return properties;
}

FeatureHelper.prototype.getAngleProperty = function (feature) {
  var angle = +feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].ANGLE);
  console.assert(typeof angle == 'number');
  return angle;
};

FeatureHelper.prototype.getColorProperty = function (feature) {
  var color = feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].COLOR);
  console.assert(typeof color == 'string');
  return color;
};

FeatureHelper.prototype.getRGBAColorProperty = function (feature) {
  var color = this.getColorProperty(feature);
  return Object(ol_color_js__WEBPACK_IMPORTED_MODULE_7__["fromString"])(color);
};

FeatureHelper.prototype.getNameProperty = function (feature) {
  var name = feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].NAME);
  console.assert(typeof name == 'string');
  return name;
};

FeatureHelper.prototype.getOpacityProperty = function (feature) {
  return this.getNumber(feature, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].OPACITY);
};

FeatureHelper.prototype.getShowMeasureProperty = function (feature) {
  var showMeasure = feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SHOW_MEASURE);

  if (showMeasure === undefined) {
    showMeasure = false;
  } else if (typeof showMeasure === 'string') {
    showMeasure = showMeasure === 'true' ? true : false;
  }

  return showMeasure;
};

FeatureHelper.prototype.getShowLabelProperty = function (feature) {
  var showLabel = feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SHOW_LABEL);

  if (showLabel === undefined) {
    showLabel = false;
  } else if (typeof showLabel === 'string') {
    showLabel = showLabel === 'true' ? true : false;
  }

  return showLabel;
};

FeatureHelper.prototype.getSizeProperty = function (feature) {
  return this.getNumber(feature, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].SIZE);
};

FeatureHelper.prototype.getStrokeProperty = function (feature) {
  return this.getNumber(feature, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].STROKE);
};

FeatureHelper.prototype.export = function (features, formatType) {
  switch (formatType) {
    case FeatureFormatType.GPX:
      this.exportGPX(features);
      break;

    case FeatureFormatType.KML:
      this.exportKML(features);
      break;

    default:
      break;
  }
};

FeatureHelper.prototype.exportGPX = function (features) {
  var format = new ol_format_GPX_js__WEBPACK_IMPORTED_MODULE_17__["default"]();
  var mimeType = 'application/gpx+xml';
  var fileName = 'export.gpx';
  this.export_(features, format, fileName, mimeType);
};

FeatureHelper.prototype.exportKML = function (features) {
  var format = new ol_format_KML_js__WEBPACK_IMPORTED_MODULE_18__["default"]();
  var mimeType = 'application/vnd.google-earth.kml+xml';
  var fileName = 'export.kml';
  this.export_(features, format, fileName, mimeType);
};

FeatureHelper.prototype.export_ = function (features, format, fileName, opt_mimeType) {
  var _this = this;

  var mimeType = opt_mimeType !== undefined ? opt_mimeType : 'text/plain';
  var clones = [];
  var clone;
  features.forEach(function (feature) {
    clone = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_9__["default"](feature.getProperties());

    _this.setStyle(clone, false);

    clones.push(clone);
  });
  var writeOptions = this.projection_ ? {
    dataProjection: 'EPSG:4326',
    featureProjection: this.projection_
  } : {};
  var data = format.writeFeatures(clones, writeOptions);
  this.download_(data, fileName, mimeType + ";charset=utf-8");
};

FeatureHelper.prototype.createTextStyle_ = function (options) {
  var text_options = options;

  if (options.angle) {
    var angle = options.angle !== undefined ? options.angle : 0;
    var rotation = angle * Math.PI / 180;
    text_options.rotation = rotation;
    delete options.angle;
  }

  text_options.font = ['normal', (options.size || 10) + "pt", 'Arial'].join(' ');

  if (options.color) {
    text_options.fill = new ol_style_Fill_js__WEBPACK_IMPORTED_MODULE_20__["default"]({
      color: options.color || [0, 0, 0, 1]
    });
    delete options.color;
  }

  text_options.stroke = new ol_style_Stroke_js__WEBPACK_IMPORTED_MODULE_22__["default"]({
    color: [255, 255, 255, 1],
    width: options.width || 3
  });
  delete options.width;
  return new ol_style_Text_js__WEBPACK_IMPORTED_MODULE_24__["default"](text_options);
};

FeatureHelper.prototype.getMeasure = function (feature) {
  if (!this.projection_) {
    throw new Error('Missing projection');
  }

  var geometry = feature.getGeometry();

  if (!geometry) {
    throw new Error('Missing geometry');
  }

  var measure = '';

  if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_14__["default"]) {
    if (this.getType(feature) === ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].CIRCLE) {
      var azimut = this.optNumber(feature, ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].AZIMUT);

      if (typeof azimut != 'number') {
        throw new Error('Missing azimut');
      }

      var line = this.getRadiusLine(feature, azimut);
      measure = Object(ngeo_interaction_MeasureAzimut_js__WEBPACK_IMPORTED_MODULE_6__["getFormattedAzimutRadius"])(line, this.projection_, this.decimals_, this.precision_, this.unitPrefixFormat_, this.numberFormat_);
    } else {
      measure = Object(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_5__["getFormattedArea"])(geometry, this.projection_, this.precision_, this.unitPrefixFormat_);
    }
  } else if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_10__["default"]) {
    measure = Object(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_5__["getFormattedLength"])(geometry, this.projection_, this.precision_, this.unitPrefixFormat_);
  } else if (geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_13__["default"]) {
    if (this.pointFilterFn_ === null) {
      measure = Object(ngeo_interaction_Measure_js__WEBPACK_IMPORTED_MODULE_5__["getFormattedPoint"])(geometry, this.decimals_, this.ngeoNumberCoordinates_);
    } else {
      var coordinates = geometry.getCoordinates();

      if (this.pointFilterArgs_.length > 1) {
        measure = this.pointFilterFn_(coordinates, this.pointFilterArgs_[0], this.pointFilterArgs_[1]).join(', ');
      } else {
        measure = this.pointFilterFn_(coordinates, this.pointFilterArgs_[0]).join(', ');
      }
    }
  }

  return measure;
};

FeatureHelper.prototype.getType = function (feature) {
  var geometry = feature.getGeometry();
  console.assert(geometry, 'Geometry should be thruthy');
  var type;

  if (geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_13__["default"]) {
    if (feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].IS_TEXT)) {
      type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].TEXT;
    } else {
      type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].POINT;
    }
  } else if (geometry instanceof ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_12__["default"]) {
    type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].MULTI_POINT;
  } else if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_14__["default"]) {
    if (feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].IS_CIRCLE)) {
      type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].CIRCLE;
    } else if (feature.get(ngeo_format_FeatureProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"].IS_RECTANGLE)) {
      type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].RECTANGLE;
    } else {
      type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].POLYGON;
    }
  } else if (geometry instanceof ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_15__["default"]) {
    type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].MULTI_POLYGON;
  } else if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_10__["default"]) {
    type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].LINE_STRING;
  } else if (geometry instanceof ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_11__["default"]) {
    type = ngeo_GeometryType_js__WEBPACK_IMPORTED_MODULE_4__["default"].MULTI_LINE_STRING;
  }

  if (!type) {
    throw new Error('Missing type');
  }

  return type;
};

FeatureHelper.prototype.fitMapToFeature = function (feature, map, opt_duration) {
  var duration = opt_duration !== undefined ? opt_duration : 250;
  var size = map.getSize();

  if (!Array.isArray(size)) {
    throw new Error('Missing size');
  }

  var view = map.getView();
  var viewExtent = view.calculateExtent(size);
  var geometry = feature.getGeometry();

  if (!geometry) {
    throw new Error('Missing geometry');
  }

  var geomIsVisible = geometry.intersectsExtent(viewExtent);
  var mapCenter = view.getCenter();

  if (!Array.isArray(mapCenter)) {
    throw new Error('Missing mapCenter');
  }

  var featureExtent = geometry.getExtent();

  if (geomIsVisible) {
    if (!(geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_13__["default"])) {
      var featureResolution = view.getResolutionForExtent(featureExtent);
      var featureZoomTmp = view.getZoomForResolution(featureResolution);

      if (!featureZoomTmp) {
        throw new Error('Missing featureZoom');
      }

      var featureZoom = Math.floor(featureZoomTmp);
      var zoom = view.getZoom();

      if (!zoom) {
        throw new Error('Missing zoom');
      }

      if (featureZoom < zoom) {
        view.animate({
          center: mapCenter,
          duration: duration
        }, {
          center: mapCenter,
          duration: duration,
          zoom: featureZoom
        });
      }
    }
  } else {
    var featureExtentHeight = ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["getHeight"](featureExtent);
    var featureExtentWidth = ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["getWidth"](featureExtent);
    var viewExtentHeight = ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["getHeight"](viewExtent);
    var viewExtentWidth = ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["getWidth"](viewExtent);
    var geomFitsInExtent = viewExtentHeight >= featureExtentHeight && viewExtentWidth >= featureExtentWidth;

    if (geomFitsInExtent) {
      var featureCenter;

      if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_10__["default"]) {
        featureCenter = geometry.getCoordinateAt(0.5);
      } else if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_14__["default"]) {
        featureCenter = geometry.getInteriorPoint().getCoordinates();
      } else if (geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_13__["default"]) {
        featureCenter = geometry.getCoordinates();
      } else {
        featureCenter = ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["getCenter"](geometry.getExtent());
      }

      view.animate({
        center: mapCenter,
        duration: duration
      }, {
        center: featureCenter,
        duration: duration
      });
    } else {
      view.fit(featureExtent, {
        duration: duration,
        size: size
      });
    }
  }
};

FeatureHelper.prototype.getRadiusLine = function (feature, azimut) {
  var geometry = feature.getGeometry();

  if (!geometry) {
    throw new Error('Missing geometry');
  }

  var extent = geometry.getExtent();
  var radius = (extent[3] - extent[1]) / 2;
  var center = ol_extent_js__WEBPACK_IMPORTED_MODULE_8__["getCenter"](geometry.getExtent());
  var x = Math.cos((azimut - 90) * Math.PI / 180) * radius;
  var y = -Math.sin((azimut - 90) * Math.PI / 180) * radius;
  var endPoint = [x + center[0], y + center[1]];
  return new ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_10__["default"]([center, endPoint]);
};

FeatureHelper.prototype.getNonSpatialProperties = function (feature) {
  var geometryName = feature.getGeometryName();
  var nonSpatialProperties = {};
  var properties = feature.getProperties();

  for (var key in properties) {
    if (key !== geometryName) {
      nonSpatialProperties[key] = properties[key];
    }
  }

  return nonSpatialProperties;
};

FeatureHelper.prototype.clearNonSpatialProperties = function (feature) {
  var geometryName = feature.getGeometryName();
  var properties = feature.getProperties();

  for (var key in properties) {
    if (key !== geometryName) {
      feature.set(key, undefined);
    }
  }
};

FeatureHelper.prototype.findFeatureIndexByFid = function (features, fid) {
  var index = -1;

  for (var i = 0, ii = features.length; i < ii; i++) {
    if (features[i].getId() == fid) {
      index = i;
      break;
    }
  }

  return index;
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoFeatureHelper', [ngeo_download_service_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.service('ngeoFeatureHelper', FeatureHelper);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/File.js":
/*!**************************!*\
  !*** ./src/misc/File.js ***!
  \**************************/
/*! exports provided: FileService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileService", function() { return FileService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
FileService.$inject = ["$q", "$http", "gettext"];

function FileService($q, $http, gettext) {
  this.isValidFileSize = function (fileSize) {
    return fileSize <= 20000000;
  };

  this.isWmsGetCap = function (fileContent) {
    return /<(WMT_MS_Capabilities|WMS_Capabilities)/.test(fileContent);
  };

  this.isWmtsGetCap = function (fileContent) {
    return fileContent.includes('<Capabilities');
  };

  this.isKml = function (fileContent) {
    return fileContent.includes('<kml') && fileContent.includes('</kml>');
  };

  this.isGpx = function (fileContent) {
    return fileContent.includes('<gpx') && fileContent.includes('</gpx>');
  };

  var fileReader = null;

  this.read = function (file) {
    var defer = $q.defer();

    if (fileReader && fileReader.readyState === FileReader.LOADING) {
      fileReader.abort();
    }

    fileReader = new FileReader();

    fileReader.onload = function (evt) {
      var target = evt.target;

      if (!(target instanceof FileReader)) {
        throw new Error('Wrong target type');
      }

      defer.resolve(target.result);
    };

    fileReader.onerror = function (evt) {
      var target = evt.target;

      if (!(target instanceof FileReader)) {
        throw new Error('Wrong target type');
      }

      var err = target.error;

      if (!err) {
        throw new Error('Missing error');
      }

      console.error('Reading file failed: ', err);
      defer.reject({
        'message': err.code == 20 ? gettext('Operation canceled') : gettext('Read failed'),
        'reason': err.message
      });
    };

    fileReader.onprogress = function (evt) {
      defer.notify(evt);
    };

    fileReader.readAsText(file);
    return defer.promise;
  };

  var canceler;

  this.load = function (url, opt_cancelP) {
    if (canceler) {
      canceler.resolve();
    }

    canceler = opt_cancelP || $q.defer();
    var defer = $q.defer();
    $http.get(url, {
      timeout: canceler.promise
    }).then(function (response) {
      defer.resolve(response.data);
    }, function (reason) {
      console.error('Uploading file failed: ', reason);
      defer.reject({
        'message': gettext('Upload failed'),
        'reason': reason
      });
    });
    return defer.promise;
  };
}
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoFile', []);
module.service('ngeoFile', FileService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/Time.js":
/*!**************************!*\
  !*** ./src/misc/Time.js ***!
  \**************************/
/*! exports provided: Time, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Time", function() { return Time; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);

function Time() {}

Time.prototype.createDate = function (value, defaultValue) {
  if (defaultValue === void 0) {
    defaultValue = null;
  }

  return value !== null && value != undefined ? new Date(value) : defaultValue;
};

Time.prototype.getTime = function (date, defaultValue) {
  if (defaultValue === void 0) {
    defaultValue = null;
  }

  return date ? date.getTime() : defaultValue;
};

Time.prototype.getOptions = function (time) {
  var minDate = this.createDate(time.minValue);
  var maxDate = this.createDate(time.maxValue);
  var minDefaultDate = this.createDate(time.minDefValue, minDate);
  var maxDefaultDate = this.createDate(time.maxDefValue, maxDate);

  if (!minDefaultDate) {
    throw new Error('Missing minDefaultDate');
  }

  if (!maxDefaultDate) {
    throw new Error('Missing maxDefaultDate');
  }

  var minTime = this.getTime(minDate);
  var maxTime = this.getTime(maxDate);

  if (!minTime) {
    throw new Error('Missing minTime');
  }

  if (!maxTime) {
    throw new Error('Missing maxTime');
  }

  var minDefaultTime = this.getTime(minDefaultDate);
  var maxDefaultTime = this.getTime(maxDefaultDate);

  if (!minDefaultTime) {
    throw new Error('Missing minDefaultTime');
  }

  var defaultValues = minDefaultTime;

  if (time.mode === 'range') {
    if (!maxDefaultTime) {
      throw new Error('Missing maxDefaultTime');
    }

    defaultValues = [minDefaultTime, maxDefaultTime];
  }

  return {
    minDate: minTime,
    maxDate: maxTime,
    values: defaultValues
  };
};

Time.prototype.getUTCDate = function (localDate) {
  return new Date(localDate.getUTCFullYear(), localDate.getUTCMonth(), localDate.getUTCDate());
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoTime', []);
module.service('ngeoTime', Time);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/ToolActivate.js":
/*!**********************************!*\
  !*** ./src/misc/ToolActivate.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (toolContext, activePropertyName) {
  this.getActive = function () {
    return toolContext[activePropertyName];
  };

  this.setActive = function (newVal) {
    toolContext[activePropertyName] = newVal;
  };
});

/***/ }),

/***/ "./src/misc/ToolActivateMgr.js":
/*!*************************************!*\
  !*** ./src/misc/ToolActivateMgr.js ***!
  \*************************************/
/*! exports provided: ToolActivateMgr, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ToolActivateMgr", function() { return ToolActivateMgr; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
ToolActivateMgr.$inject = ["$rootScope"];

function ToolActivateMgr($rootScope) {
  this.groups_ = {};
  this.scope_ = $rootScope;
}

ToolActivateMgr.prototype.registerTool = function (groupName, tool, opt_defaultActivate) {
  var _this = this;

  if (!this.groups_[groupName]) {
    this.groups_[groupName] = [];
  }

  var unlisten = this.scope_.$watch(tool.getActive, function (newVal, oldVal) {
    if (newVal === oldVal) {
      return;
    }

    if (newVal) {
      _this.deactivateTools_(groupName, tool);
    } else {
      _this.activateDefault_(groupName);
    }
  });
  this.groups_[groupName].push({
    tool: tool,
    defaultTool: opt_defaultActivate || false,
    unlisten: unlisten
  });
};

ToolActivateMgr.prototype.unregisterTool = function (groupName, tool) {
  var entries = this.groups_[groupName];

  if (entries) {
    for (var i = 0; i < entries.length; i++) {
      if (entries[i].tool == tool) {
        entries[i].unlisten();
        entries.splice(i, 1);
        break;
      }
    }
  }
};

ToolActivateMgr.prototype.unregisterGroup = function (groupName) {
  var entries = this.groups_[groupName];

  if (entries) {
    for (var _iterator = entries, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var entry = _ref;
      entry.unlisten();
    }

    delete this.groups_[groupName];
  }
};

ToolActivateMgr.prototype.activateTool = function (tool) {
  tool.setActive(true);
};

ToolActivateMgr.prototype.deactivateTool = function (tool) {
  tool.setActive(false);
};

ToolActivateMgr.prototype.deactivateTools_ = function (groupName, tool) {
  var entries = this.groups_[groupName];

  for (var _iterator2 = entries, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
    var _ref2;

    if (_isArray2) {
      if (_i2 >= _iterator2.length) break;
      _ref2 = _iterator2[_i2++];
    } else {
      _i2 = _iterator2.next();
      if (_i2.done) break;
      _ref2 = _i2.value;
    }

    var entry = _ref2;

    if (tool != entry.tool) {
      entry.tool.setActive(false);
    }
  }
};

ToolActivateMgr.prototype.activateDefault_ = function (groupName) {
  var entries = this.groups_[groupName];
  var defaultTool = null;
  var hasActiveTool = false;

  for (var _iterator3 = entries, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
    var _ref3;

    if (_isArray3) {
      if (_i3 >= _iterator3.length) break;
      _ref3 = _iterator3[_i3++];
    } else {
      _i3 = _iterator3.next();
      if (_i3.done) break;
      _ref3 = _i3.value;
    }

    var entry = _ref3;
    hasActiveTool = hasActiveTool || entry.tool.getActive();

    if (entry.defaultTool) {
      defaultTool = entry.tool;
    }
  }

  if (!hasActiveTool && defaultTool !== null) {
    defaultTool.setActive(true);
  }
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoToolActivateMgr', []);
module.service('ngeoToolActivateMgr', ToolActivateMgr);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/WMSTime.js":
/*!*****************************!*\
  !*** ./src/misc/WMSTime.js ***!
  \*****************************/
/*! exports provided: WMSTime, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WMSTime", function() { return WMSTime; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_Time_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/Time.js */ "./src/misc/Time.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }



var WMSTime = function (_Time) {
  WMSTime.$inject = ["$filter", "gettextCatalog"];

  _inheritsLoose(WMSTime, _Time);

  function WMSTime($filter, gettextCatalog) {
    var _this;

    _this = _Time.call(this) || this;
    _this.$filter_ = $filter;
    _this.gettextCatalog_ = gettextCatalog;
    return _this;
  }

  var _proto = WMSTime.prototype;

  _proto.formatTimeValue = function formatTimeValue(time, resolution, opt_useISOFormat, opt_toUTC) {
    var date = new Date(time);
    var utc = opt_toUTC ? 'UTC' : undefined;
    var yearResolution = 'yyyy';
    var monthResolution = 'yyyy-MM';
    var dayResolution = 'yyyy-MM-dd';
    var secondResolution = null;

    if (!opt_useISOFormat) {
      var gettextCatalog = this.gettextCatalog_;
      yearResolution = gettextCatalog.getString('yyyy');
      monthResolution = gettextCatalog.getString('M/yyyy');
      dayResolution = gettextCatalog.getString('M/d/yyyy');
      secondResolution = gettextCatalog.getString('M/d/yyyy HH:MM:ss');
    }

    switch (resolution) {
      case 'year':
        return this.$filter_('date')(date, yearResolution, utc);

      case 'month':
        return this.$filter_('date')(date, monthResolution, utc);

      case 'day':
        return this.$filter_('date')(date, dayResolution, utc);

      case 'second':
        if (secondResolution) {
          return this.$filter_('date')(date, secondResolution, utc);
        } else {
          return date.toISOString().replace(/\.\d{3}/, '');
        }

      default:
        return date.toISOString().replace(/\.\d{3}/, '');
    }
  };

  _proto.formatWMSTimeParam = function formatWMSTimeParam(wmsTimeProperty, times, opt_toUTC) {
    console.assert(wmsTimeProperty.resolution !== undefined);

    if (wmsTimeProperty.mode === 'range') {
      console.assert(times.end !== undefined);
      return this.formatTimeValue(times.start, wmsTimeProperty.resolution, true, opt_toUTC) + "/" + this.formatTimeValue(times.end, wmsTimeProperty.resolution, true, opt_toUTC);
    } else {
      return this.formatTimeValue(times.start, wmsTimeProperty.resolution, true, opt_toUTC);
    }
  };

  return WMSTime;
}(ngeo_misc_Time_js__WEBPACK_IMPORTED_MODULE_1__["Time"]);
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoWMSTime', [ngeo_misc_Time_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.service('ngeoWMSTime', WMSTime);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/btnComponent.js":
/*!**********************************!*\
  !*** ./src/misc/btnComponent.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
buttonComponent.$inject = ["$parse"];
buttonGroupComponent.$inject = ["$parse"];

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoBtnComponent', []);

function buttonGroupComponent($parse) {
  return {
    restrict: 'A',
    controller: 'ngeoBtnGroupController',
    link: function link(scope, element, attrs, controller) {
      if (!controller) {
        throw new Error('Missing controller');
      }

      var setActive = $parse(attrs.ngeoBtnGroupActive).assign;

      if (setActive) {
        scope.$watch(function () {
          return controller.buttons_.some(function (buttonModel) {
            return buttonModel(scope) === true;
          });
        }, function (newValue) {
          setActive(scope, newValue);
        });
      }
    }
  };
}

module.directive('ngeoBtnGroup', buttonGroupComponent);

var BtnGroupController = function () {
  BtnGroupController.$inject = ["$scope"];

  function BtnGroupController($scope) {
    this.buttons_ = [];
    this.scope_ = $scope;
  }

  var _proto = BtnGroupController.prototype;

  _proto.activate = function activate(index) {
    var _this = this;

    this.buttons_.forEach(function (expressionFn, i) {
      if (i != index) {
        expressionFn.assign(_this.scope_, false);
      }
    });
  };

  _proto.addButton = function addButton(expressionFn) {
    this.buttons_.push(expressionFn);
    return this.buttons_.length - 1;
  };

  return BtnGroupController;
}();

module.controller('ngeoBtnGroupController', BtnGroupController);

function buttonComponent($parse) {
  return {
    require: ['?^ngeoBtnGroup', 'ngModel'],
    restrict: 'A',
    link: function link(scope, element, attrs, ctrls) {
      if (!ctrls) {
        throw new Error('Missing ctrls');
      }

      var buttonsCtrl = ctrls[0];
      var ngModelCtrl = ctrls[1];
      var indexInGroup = -1;
      var ngModelGet = $parse(attrs.ngModel);
      var ngModelSet = ngModelGet.assign;

      if (ngModelGet(scope) === undefined) {
        ngModelSet(scope, false);
      }

      if (buttonsCtrl !== null) {
        indexInGroup = buttonsCtrl.addButton(ngModelGet);
      }

      element.on('click', function () {
        scope.$apply(function () {
          ngModelCtrl.$setViewValue(!ngModelCtrl.$viewValue);
          ngModelCtrl.$render();
        });
      });

      ngModelCtrl.$render = function () {
        if (ngModelCtrl.$viewValue && buttonsCtrl !== null) {
          buttonsCtrl.activate(indexInGroup);
        }

        element.toggleClass('active', ngModelCtrl.$viewValue);
      };
    }
  };
}

module.directive('ngeoBtn', buttonComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/colorpickerComponent.html":
/*!********************************************!*\
  !*** ./src/misc/colorpickerComponent.html ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<table class="ngeo-colorpicker-palette">\n  <tr ng-repeat="colors in ::ctrl.colors">\n    <td\n      ng-repeat="color in ::colors"\n      ng-click="ctrl.setColor(color)"\n      ng-class="{\'ngeo-colorpicker-selected\': color == ctrl.color}">\n      <div ng-style="::{\'background-color\': color}"></div>\n    </td>\n  </tr>\n</table>\n';

}
return __p
}

/***/ }),

/***/ "./src/misc/colorpickerComponent.js":
/*!******************************************!*\
  !*** ./src/misc/colorpickerComponent.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
colorPickerComponent.$inject = ["ngeoColorpickerTemplateUrl"];

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoColorpicker', []);
module.value('ngeoColorpickerTemplateUrl', function (element, attrs) {
  var templateUrl = attrs['ngeoColorpickerTemplateurl'];
  return templateUrl !== undefined ? templateUrl : 'ngeo/misc/colorpickerComponent';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/misc/colorpickerComponent', __webpack_require__(/*! ./colorpickerComponent.html */ "./src/misc/colorpickerComponent.html"));
}]);

function colorPickerComponent(ngeoColorpickerTemplateUrl) {
  return {
    restrict: 'A',
    scope: {
      colors: '<?ngeoColorpicker',
      color: '=?ngeoColorpickerColor'
    },
    controller: 'NgeoColorpickerController as ctrl',
    bindToController: true,
    templateUrl: ngeoColorpickerTemplateUrl
  };
}

module.directive('ngeoColorpicker', colorPickerComponent);
var DEFAULT_COLORS = [['#F4EB37', '#CDDC39', '#62AF44', '#009D57', '#0BA9CC', '#4186F0', '#3F5BA9', '#7C3592', '#A61B4A', '#DB4436', '#F8971B', '#F4B400', '#795046'], ['#F9F7A6', '#E6EEA3', '#B7DBAB', '#7CCFA9', '#93D7E8', '#9FC3FF', '#A7B5D7', '#C6A4CF', '#D698AD', '#EE9C96', '#FAD199', '#FFDD5E', '#B29189'], ['#ffffff', '#CCCCCC', '#777', '#000000']];

function Controller() {
  this.colors = this.colors || DEFAULT_COLORS;
  this.color;
}

Controller.prototype.setColor = function (color) {
  this.color = color;
};

module.controller('NgeoColorpickerController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/controlComponent.js":
/*!**************************************!*\
  !*** ./src/misc/controlComponent.js ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_Map_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/Map.js */ "./node_modules/ol/Map.js");
/* harmony import */ var ol_control_Control_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/control/Control.js */ "./node_modules/ol/control/Control.js");



var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoControl', []);

function controlComponent() {
  return {
    restrict: 'A',
    link: function link(scope, element, attrs) {
      var control = scope.$eval(attrs['ngeoControl']);
      console.assert(control instanceof ol_control_Control_js__WEBPACK_IMPORTED_MODULE_2__["default"]);
      var map = scope.$eval(attrs['ngeoControlMap']);
      console.assert(map instanceof ol_Map_js__WEBPACK_IMPORTED_MODULE_1__["default"]);
      control.setTarget(element[0]);
      map.addControl(control);
    }
  };
}

module.directive('ngeoControl', controlComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/datepickerComponent.html":
/*!*******************************************!*\
  !*** ./src/misc/datepickerComponent.html ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div class="ngeo-datepicker">\n  <form name="dateForm" class="ngeo-datepicker-form" novalidate>\n    <div ng-if="::datepickerCtrl.time.widget === \'datepicker\'">\n      <div class="ngeo-datepicker-start-date">\n        <span ng-if="::datepickerCtrl.time.mode === \'range\'" translate>From:</span>\n        <span ng-if="::datepickerCtrl.time.mode !== \'range\'" translate>Date:</span>\n        <input name="sdate" ui-date="datepickerCtrl.sdateOptions" ng-model="datepickerCtrl.sdate" required=""/>\n      </div>\n      <div\n        class="ngeo-datepicker-end-date"\n        ng-if="::datepickerCtrl.time.mode === \'range\'">\n        <span translate>To:</span>\n        <input name="edate" ui-date="datepickerCtrl.edateOptions" ng-model="datepickerCtrl.edate" required=""/>\n      </div>\n    </div>\n  </form>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./src/misc/datepickerComponent.js":
/*!*****************************************!*\
  !*** ./src/misc/datepickerComponent.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_Time_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/Time.js */ "./src/misc/Time.js");
/* harmony import */ var angular_ui_date__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! angular-ui-date */ "./node_modules/angular-ui-date/dist/date.js");
/* harmony import */ var angular_ui_date__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(angular_ui_date__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/sass/jquery-ui.scss */ "./src/sass/jquery-ui.scss");
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery_ui_ui_i18n_datepicker_fr_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery-ui/ui/i18n/datepicker-fr.js */ "./node_modules/jquery-ui/ui/i18n/datepicker-fr.js");
/* harmony import */ var jquery_ui_ui_i18n_datepicker_fr_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_i18n_datepicker_fr_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var jquery_ui_ui_i18n_datepicker_en_GB_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jquery-ui/ui/i18n/datepicker-en-GB.js */ "./node_modules/jquery-ui/ui/i18n/datepicker-en-GB.js");
/* harmony import */ var jquery_ui_ui_i18n_datepicker_en_GB_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_i18n_datepicker_en_GB_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var jquery_ui_ui_i18n_datepicker_de_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jquery-ui/ui/i18n/datepicker-de.js */ "./node_modules/jquery-ui/ui/i18n/datepicker-de.js");
/* harmony import */ var jquery_ui_ui_i18n_datepicker_de_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_i18n_datepicker_de_js__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var jquery_ui_ui_i18n_datepicker_it_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jquery-ui/ui/i18n/datepicker-it.js */ "./node_modules/jquery-ui/ui/i18n/datepicker-it.js");
/* harmony import */ var jquery_ui_ui_i18n_datepicker_it_js__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_i18n_datepicker_it_js__WEBPACK_IMPORTED_MODULE_7__);
Controller.$inject = ["$scope", "ngeoTime", "gettextCatalog"];
datePickerComponent.$inject = ["ngeoDatePickerTemplateUrl", "$timeout"];








var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDatePicker', [ngeo_misc_Time_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, 'ui.date']);
module.value('ngeoDatePickerTemplateUrl', function (element, attrs) {
  var templateUrl = attrs.ngeoDatePickerTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'ngeo/misc/datepickerComponent';
});
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/misc/datepickerComponent', __webpack_require__(/*! ./datepickerComponent.html */ "./src/misc/datepickerComponent.html"));
}]);

function datePickerComponent(ngeoDatePickerTemplateUrl, $timeout) {
  return {
    scope: {
      onDateSelected: '&',
      time: '='
    },
    bindToController: true,
    controller: 'ngeoDatePickerController as datepickerCtrl',
    restrict: 'AE',
    templateUrl: ngeoDatePickerTemplateUrl,
    link: function link(scope, element, attrs, ctrl) {
      if (!ctrl) {
        throw new Error('Missing ctrl');
      }

      ctrl.init();
      var lang = ctrl.gettextCatalog_.getCurrentLanguage();
      $.datepicker.setDefaults($.datepicker.regional[lang]);
      ctrl.sdateOptions = angular__WEBPACK_IMPORTED_MODULE_0___default.a.extend({}, ctrl.sdateOptions, {
        'minDate': ctrl.initialMinDate,
        'maxDate': ctrl.initialMaxDate,
        'onClose': function onClose(selectedDate) {
          if (selectedDate) {
            $(element[0]).find('input[name="edate"]').datepicker('option', 'minDate', selectedDate);
          }
        }
      });
      ctrl.edateOptions = angular__WEBPACK_IMPORTED_MODULE_0___default.a.extend({}, ctrl.edateOptions, {
        'minDate': ctrl.initialMinDate,
        'maxDate': ctrl.initialMaxDate,
        'onClose': function onClose(selectedDate) {
          if (selectedDate) {
            $(element[0]).find('input[name="sdate"]').datepicker('option', 'maxDate', selectedDate);
          }
        }
      });
      angular__WEBPACK_IMPORTED_MODULE_0___default.a.element('body').on('hidden.bs.popover', function () {
        var dp = angular__WEBPACK_IMPORTED_MODULE_0___default.a.element('#ui-datepicker-div');

        if (dp && dp.css('display') === 'block') {
          $(element[0]).find('input[name$="date"]').datepicker('hide');
        }
      });
      $timeout(function () {
        angular__WEBPACK_IMPORTED_MODULE_0___default.a.element('#ui-datepicker-div').on('click', function (e) {
          e.stopPropagation();
        });
      });
    }
  };
}

module.directive('ngeoDatePicker', datePickerComponent);

function Controller($scope, ngeoTime, gettextCatalog) {
  var _this = this;

  this.ngeoTime_ = ngeoTime;
  this.time = null;
  this.gettextCatalog_ = gettextCatalog;
  this.isModeRange = false;
  this.onDateSelected = null;
  this.initialMinDate = null;
  this.initialMaxDate = null;
  this.edateOptions = {
    'changeMonth': true,
    'changeYear': true
  };
  this.sdateOptions = {
    'changeMonth': true,
    'changeYear': true
  };
  this.sdate = null;
  this.edate = null;
  $scope.$watchGroup(['datepickerCtrl.sdate', 'datepickerCtrl.edate'], function (newDates, oldDates) {
    if (!_this.onDateSelected) {
      throw new Error('Missing onDateSelected');
    }

    var sDate = newDates[0];
    var eDate = newDates[1];

    if (angular__WEBPACK_IMPORTED_MODULE_0___default.a.isDate(sDate) && (!_this.isModeRange || angular__WEBPACK_IMPORTED_MODULE_0___default.a.isDate(eDate))) {
      var start = _this.ngeoTime_.getTime(sDate);

      var end = _this.ngeoTime_.getTime(eDate);

      if (!start) {
        throw new Error('Missing start');
      }

      _this.onDateSelected({
        time: {
          start: start,
          end: end
        }
      });
    }
  });
}

Controller.prototype.init = function () {
  if (!this.time) {
    throw new Error('Missing time');
  }

  var initialOptions_ = this.ngeoTime_.getOptions(this.time);
  this.initialMinDate = this.ngeoTime_.createDate(initialOptions_.minDate);
  this.initialMaxDate = this.ngeoTime_.createDate(initialOptions_.maxDate);
  this.isModeRange = this.time.mode === 'range';

  if (this.isModeRange) {
    if (!Array.isArray(initialOptions_.values)) {
      throw new Error('Value should be an array');
    }

    this.sdate = this.ngeoTime_.createDate(initialOptions_.values[0]);
    this.edate = this.ngeoTime_.createDate(initialOptions_.values[1]);
  } else {
    if (typeof initialOptions_.values != 'number') {
      throw new Error('Value should be a number');
    }

    this.sdate = this.ngeoTime_.createDate(initialOptions_.values);
  }
};

module.controller('ngeoDatePickerController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/misc/datetimepickerComponent.js":
/*!*********************************************!*\
  !*** ./src/misc/datetimepickerComponent.js ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_php_date_formatter_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/php-date-formatter.js */ "./src/misc/php-date-formatter.js");
/* harmony import */ var jquery_datetimepicker_jquery_datetimepicker_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jquery-datetimepicker/jquery.datetimepicker.js */ "./node_modules/jquery-datetimepicker/jquery.datetimepicker.js");
/* harmony import */ var jquery_datetimepicker_jquery_datetimepicker_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jquery_datetimepicker_jquery_datetimepicker_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var jquery_datetimepicker_jquery_datetimepicker_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jquery-datetimepicker/jquery.datetimepicker.css */ "./node_modules/jquery-datetimepicker/jquery.datetimepicker.css");
/* harmony import */ var jquery_datetimepicker_jquery_datetimepicker_css__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery_datetimepicker_jquery_datetimepicker_css__WEBPACK_IMPORTED_MODULE_3__);
Controller.$inject = ["$element", "gettextCatalog"];




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDateTimePicker', ['gettext']);

function dateTimeComponent() {
  return {
    restrict: 'A',
    controller: Controller,
    bindToController: true,
    scope: {
      'options': '<ngeoDatetimepickerOptions'
    }
  };
}

module.directive('ngeoDatetimepicker', dateTimeComponent);

function Controller($element, gettextCatalog) {
  this.element_ = $element;
  this.gettextCatalog_ = gettextCatalog;
  this.options;
}

Controller.prototype.$onInit = function () {
  var lang = this.gettextCatalog_.getCurrentLanguage();
  $.datetimepicker.setLocale(lang);
  $.datetimepicker.setDateFormatter(new ngeo_misc_php_date_formatter_js__WEBPACK_IMPORTED_MODULE_1__["default"]());

  if (typeof this.options === 'string') {
    this.options = angular__WEBPACK_IMPORTED_MODULE_0___default.a.fromJson(this.options);
  }

  this.element_.datetimepicker(this.options);
};

module.controller('ngeoDateTimePickerController', Controller);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/misc/debounce.js":
/*!******************************!*\
  !*** ./src/misc/debounce.js ***!
  \******************************/
/*! exports provided: debounce, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "debounce", function() { return debounce; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
factory.$inject = ["$timeout"];

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoDebounce', []);
function debounce(func, wait, invokeApply, $timeout) {
  var timeout = null;
  return function () {
    var _this = this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var later = function later() {
      timeout = null;
      func.apply(_this, args);
    };

    if (timeout !== null) {
      $timeout.cancel(timeout);
    }

    timeout = $timeout(later, wait, invokeApply);
  };
}

function factory($timeout) {
  var deb = debounce;
  return function (func, wait, invokeApply) {
    return deb(func, wait, invokeApply, $timeout);
  };
}

module.factory('ngeoDebounce', factory);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/decorate.js":
/*!******************************!*\
  !*** ./src/misc/decorate.js ***!
  \******************************/
/*! exports provided: interactionDecoration, layerDecoration, layerLoading */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "interactionDecoration", function() { return interactionDecoration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "layerDecoration", function() { return layerDecoration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "layerLoading", function() { return layerLoading; });
/* harmony import */ var ol_interaction_Interaction_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/interaction/Interaction.js */ "./node_modules/ol/interaction/Interaction.js");
/* harmony import */ var ol_layer_Base_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/layer/Base.js */ "./node_modules/ol/layer/Base.js");
/* harmony import */ var ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/layer/Group.js */ "./node_modules/ol/layer/Group.js");
/* harmony import */ var ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/layer/Layer.js */ "./node_modules/ol/layer/Layer.js");
/* harmony import */ var ol_source_Image_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/source/Image.js */ "./node_modules/ol/source/Image.js");
/* harmony import */ var ol_source_Tile_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/source/Tile.js */ "./node_modules/ol/source/Tile.js");






function interactionDecoration(interaction) {
  console.assert(interaction instanceof ol_interaction_Interaction_js__WEBPACK_IMPORTED_MODULE_0__["default"]);
  Object.defineProperty(interaction, 'active', {
    get: function get() {
      return interaction.getActive();
    },
    set: function set(val) {
      interaction.setActive(val);
    }
  });
}
function layerDecoration(layer) {
  console.assert(layer instanceof ol_layer_Base_js__WEBPACK_IMPORTED_MODULE_1__["default"]);
  Object.defineProperty(layer, 'visible', {
    configurable: true,
    get: function get() {
      return layer.getVisible();
    },
    set: function set(val) {
      layer.setVisible(val);
    }
  });
  Object.defineProperty(layer, 'opacity', {
    configurable: true,
    get: function get() {
      return layer.getOpacity();
    },
    set: function set(val) {
      layer.setOpacity(val);
    }
  });
}
function layerLoading(layer, $scope) {
  var source;
  var incrementEvents = [];
  var decrementEvents = [];
  var incrementLoadCount_ = increment_;
  var decrementLoadCount_ = decrement_;
  layer.set('load_count', 0, true);

  if (layer instanceof ol_layer_Group_js__WEBPACK_IMPORTED_MODULE_2__["default"]) {
    layer.getLayers().on('add', function (olEvent) {
      var newLayer = olEvent.element;
      newLayer.set('parent_group', layer);
    });
  }

  if (layer instanceof ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_3__["default"]) {
    source = layer.getSource();

    if (source === null) {
      return;
    } else if (source instanceof ol_source_Tile_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
      incrementEvents = ['tileloadstart'];
      decrementEvents = ['tileloadend', 'tileloaderror'];
    } else if (source instanceof ol_source_Image_js__WEBPACK_IMPORTED_MODULE_4__["default"]) {
      incrementEvents = ['imageloadstart'];
      decrementEvents = ['imageloadend', 'imageloaderror'];
    } else {
      console.assert(false, 'unsupported source type');
    }

    source.on(incrementEvents, function () {
      incrementLoadCount_(layer);
      $scope.$applyAsync();
    });
    source.on(decrementEvents, function () {
      decrementLoadCount_(layer);
      $scope.$applyAsync();
    });
  }

  Object.defineProperty(layer, 'loading', {
    configurable: true,
    get: function get() {
      return layer.get('load_count') > 0;
    }
  });

  function increment_(layer) {
    var load_count = layer.get('load_count');
    var parent = layer.get('parent_group');
    layer.set('load_count', ++load_count, true);

    if (parent) {
      increment_(parent);
    }
  }

  function decrement_(layer) {
    var load_count = layer.get('load_count');
    var parent = layer.get('parent_group');
    layer.set('load_count', --load_count, true);

    if (parent) {
      decrement_(parent);
    }
  }
}

/***/ }),

/***/ "./src/misc/extraModule.js":
/*!*********************************!*\
  !*** ./src/misc/extraModule.js ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_misc_AutoProjection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/misc/AutoProjection.js */ "./src/misc/AutoProjection.js");
/* harmony import */ var ngeo_misc_btnComponent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/misc/btnComponent.js */ "./src/misc/btnComponent.js");
/* harmony import */ var ngeo_misc_controlComponent_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/misc/controlComponent.js */ "./src/misc/controlComponent.js");
/* harmony import */ var ngeo_misc_datepickerComponent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/misc/datepickerComponent.js */ "./src/misc/datepickerComponent.js");
/* harmony import */ var ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/misc/debounce.js */ "./src/misc/debounce.js");
/* harmony import */ var ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/misc/EventHelper.js */ "./src/misc/EventHelper.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");
/* harmony import */ var ngeo_misc_File_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ngeo/misc/File.js */ "./src/misc/File.js");
/* harmony import */ var ngeo_misc_filereaderComponent_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ngeo/misc/filereaderComponent.js */ "./src/misc/filereaderComponent.js");
/* harmony import */ var ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ngeo/misc/filters.js */ "./src/misc/filters.js");
/* harmony import */ var ngeo_misc_sortableComponent_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ngeo/misc/sortableComponent.js */ "./src/misc/sortableComponent.js");
/* harmony import */ var ngeo_misc_Time_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngeo/misc/Time.js */ "./src/misc/Time.js");
/* harmony import */ var ngeo_misc_ToolActivateMgr_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ngeo/misc/ToolActivateMgr.js */ "./src/misc/ToolActivateMgr.js");
/* harmony import */ var ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ngeo/misc/WMSTime.js */ "./src/misc/WMSTime.js");















/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMiscExtraModule', [ngeo_misc_AutoProjection_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_misc_btnComponent_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_misc_controlComponent_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_misc_datepickerComponent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_misc_EventHelper_js__WEBPACK_IMPORTED_MODULE_6__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_7__["default"].name, ngeo_misc_File_js__WEBPACK_IMPORTED_MODULE_8__["default"].name, ngeo_misc_filereaderComponent_js__WEBPACK_IMPORTED_MODULE_9__["default"].name, ngeo_misc_filters_js__WEBPACK_IMPORTED_MODULE_10__["default"].name, ngeo_misc_sortableComponent_js__WEBPACK_IMPORTED_MODULE_11__["default"].name, ngeo_misc_Time_js__WEBPACK_IMPORTED_MODULE_12__["default"].name, ngeo_misc_ToolActivateMgr_js__WEBPACK_IMPORTED_MODULE_13__["default"].name, ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_14__["default"].name]));

/***/ }),

/***/ "./src/misc/filereaderComponent.js":
/*!*****************************************!*\
  !*** ./src/misc/filereaderComponent.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
filereaderComponent.$inject = ["$window"];

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoFilereader', []);

function filereaderComponent($window) {
  return {
    restrict: 'A',
    scope: {
      'fileContent': '=ngeoFilereader',
      'supported': '=?ngeoFilereaderSupported'
    },
    link: function link(scope, element) {
      var supported = 'FileReader' in $window;
      scope.supported = supported;

      if (!supported) {
        return;
      }

      var ce = function ce(changeEvent) {
        var fileReader = new $window.FileReader();

        fileReader.onload = function (evt) {
          var target = evt.target;
          scope.$apply(function () {
            scope.fileContent = target.result;
          });
        };

        var files = changeEvent.target.files;

        if (!files) {
          throw new Error('Missing files');
        }

        fileReader.readAsText(files[0]);
      };

      element.on({
        change: ce
      });
    }
  };
}

module.directive('ngeoFilereader', filereaderComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/filters.js":
/*!*****************************!*\
  !*** ./src/misc/filters.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_math_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/math.js */ "./node_modules/ol/math.js");
/* harmony import */ var ol_string_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/string.js */ "./node_modules/ol/string.js");
DurationFilter.$inject = ["gettextCatalog"];
trustHtmlAutoFilter.$inject = ["$sce", "ngeoStringToHtmlReplacements"];
trustHtmlFilter.$inject = ["$sce"];
NumberCoordinatesFilter.$inject = ["$filter"];
UnitPrefixFilter.$inject = ["$filter"];
NumberFilter.$inject = ["$locale"];
ScalifyFilter.$inject = ["$filter"];



var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoAngularFilters', []);

function ScalifyFilter($filter) {
  var numberFilter = $filter('number');

  var filterFn = function filterFn(scale) {
    var text = numberFilter(scale, 0);
    return text ? "1\xA0:\xA0" + text : '';
  };

  filterFn.$stateful = true;
  return filterFn;
}

module.filter('ngeoScalify', ScalifyFilter);

function NumberFilter($locale) {
  var formats = $locale.NUMBER_FORMATS;

  var result = function result(number, opt_precision) {
    var groupSep = formats.GROUP_SEP;
    var decimalSep = formats.DECIMAL_SEP;

    if (opt_precision === undefined) {
      opt_precision = 3;
    }

    if (number === Infinity) {
      return "\u221E";
    } else if (number === -Infinity) {
      return "-\u221E";
    } else if (number === 0) {
      return '0';
    }

    var sign = number < 0;
    number = Math.abs(number);
    var nb_decimal = opt_precision - Math.floor(Math.log(number) / Math.log(10)) - 1;
    var factor = Math.pow(10, nb_decimal);
    number = Math.round(number * factor);
    var decimal = '';
    var unit = Math.floor(number / factor);

    if (nb_decimal > 0) {
      var str_number = "" + number;

      while (str_number.length < nb_decimal) {
        str_number = "0" + str_number;
      }

      decimal = str_number.substring(str_number.length - nb_decimal);

      while (decimal.endsWith('0')) {
        decimal = decimal.substring(0, decimal.length - 1);
      }
    }

    var groups = [];
    var str_unit = "" + unit;

    while (str_unit.length > 3) {
      var index = str_unit.length - 3;
      groups.unshift(str_unit.substring(index));
      str_unit = str_unit.substring(0, index);
    }

    groups.unshift(str_unit);
    return (sign ? '-' : '') + groups.join(groupSep) + (decimal.length === 0 ? '' : decimalSep + decimal);
  };

  return result;
}

module.filter('ngeoNumber', NumberFilter);

function UnitPrefixFilter($filter) {
  var numberFilter = $filter('ngeoNumber');
  var standardPrefix = ['', 'k', 'M', 'G', 'T', 'P'];
  var binaryPrefix = ['', 'Ki', 'Mi', 'Gi', 'Ti', 'Pi'];

  var result = function result(number, opt_unit, opt_type, opt_precision) {
    if (opt_unit === undefined) {
      opt_unit = '';
    }

    var divisor = 1000;
    var prefix = standardPrefix;

    if (opt_type === 'square') {
      divisor = 1000000;
    } else if (opt_type === 'binary') {
      divisor = 1024;
      prefix = binaryPrefix;
    }

    var index = 0;
    var index_max = prefix.length - 1;

    while (number >= divisor && index < index_max) {
      number = number / divisor;
      index++;
    }

    var postfix = prefix[index] + opt_unit;
    var space = postfix.length == 0 ? '' : "\xA0";
    return numberFilter(number, opt_precision) + space + postfix;
  };

  return result;
}

module.filter('ngeoUnitPrefix', UnitPrefixFilter);

function NumberCoordinatesFilter($filter) {
  var filterFn = function filterFn(coordinates, opt_fractionDigits, opt_template) {
    var template = opt_template ? opt_template : '{x} {y}';
    var x = coordinates[0];
    var y = coordinates[1];
    var fractionDigits = parseInt(opt_fractionDigits, 10) | 0;
    var x_str = $filter('number')(x, fractionDigits);
    var y_str = $filter('number')(y, fractionDigits);
    return template.replace('{x}', x_str).replace('{y}', y_str);
  };

  return filterFn;
}

module.filter('ngeoNumberCoordinates', NumberCoordinatesFilter);

function DMSCoordinatesFilter() {
  var degreesToStringHDMS = function degreesToStringHDMS(degrees, hemispheres, fractionDigits) {
    var normalizedDegrees = Object(ol_math_js__WEBPACK_IMPORTED_MODULE_1__["modulo"])(degrees + 180, 360) - 180;
    var dms = Math.abs(3600 * normalizedDegrees);
    var d = Math.floor(dms / 3600);
    var m = Math.floor(dms / 60 % 60);
    var s = dms % 60;
    return d + "\xB0 " + Object(ol_string_js__WEBPACK_IMPORTED_MODULE_2__["padNumber"])(m, 2) + "\u2032 " + Object(ol_string_js__WEBPACK_IMPORTED_MODULE_2__["padNumber"])(s, 2, fractionDigits) + "\u2033 " + hemispheres.charAt(normalizedDegrees < 0 ? 1 : 0);
  };

  var filterFn = function filterFn(coordinates, opt_fractionDigits, opt_template) {
    var fractionDigits = parseInt(opt_fractionDigits, 10) | 0;
    var template = opt_template ? opt_template : '{x} {y}';
    var xdms = degreesToStringHDMS(coordinates[0], 'EW', fractionDigits);
    var ydms = degreesToStringHDMS(coordinates[1], 'NS', fractionDigits);
    return template.replace('{x}', xdms).replace('{y}', ydms);
  };

  return filterFn;
}

module.filter('ngeoDMSCoordinates', DMSCoordinatesFilter);

function trustHtmlFilter($sce) {
  return function (input) {
    if (input !== undefined && input !== null) {
      return $sce.trustAsHtml("" + input);
    } else {
      return $sce.trustAsHtml('&nbsp;');
    }
  };
}

module.filter('ngeoTrustHtml', trustHtmlFilter);

function trustHtmlAutoFilter($sce, ngeoStringToHtmlReplacements) {
  return function (input) {
    if (input !== undefined && input !== null) {
      if (typeof input === 'string') {
        for (var _iterator = ngeoStringToHtmlReplacements, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
          var _ref;

          if (_isArray) {
            if (_i >= _iterator.length) break;
            _ref = _iterator[_i++];
          } else {
            _i = _iterator.next();
            if (_i.done) break;
            _ref = _i.value;
          }

          var replacement = _ref;

          if (input.match(replacement.expression)) {
            input = replacement.template.replace(/\$1/g, input);
            break;
          }
        }

        return $sce.trustAsHtml("" + input);
      } else {
        return $sce.trustAsHtml("" + input);
      }
    } else {
      return $sce.trustAsHtml('&nbsp;');
    }
  };
}

module.filter('ngeoTrustHtmlAuto', trustHtmlAutoFilter);

function DurationFilter(gettextCatalog) {
  var TimeUnits = Object.freeze({
    SECONDS: Symbol('seconds'),
    MINUTES: Symbol('minutes'),
    HOURS: Symbol('hours'),
    DAYS: Symbol('days')
  });

  var pluralize = function pluralize(amount, unit) {
    var formattedUnit = '';

    switch (unit) {
      case TimeUnits.SECONDS:
        formattedUnit = gettextCatalog.getPlural(amount, 'second', 'seconds');
        break;

      case TimeUnits.MINUTES:
        formattedUnit = gettextCatalog.getPlural(amount, 'minute', 'minutes');
        break;

      case TimeUnits.HOURS:
        formattedUnit = gettextCatalog.getPlural(amount, 'hour', 'hours');
        break;

      case TimeUnits.DAYS:
        formattedUnit = gettextCatalog.getPlural(amount, 'day', 'days');
        break;

      default:
        break;
    }

    return amount + " " + formattedUnit;
  };

  var result = function result(duration) {
    duration = Math.round(duration);
    var output;

    if (duration < 60) {
      return pluralize(duration, TimeUnits.SECONDS);
    }

    var remainder = duration % 60;
    duration = Math.floor(duration / 60);

    if (duration < 60) {
      output = pluralize(duration, TimeUnits.MINUTES);

      if (remainder > 0) {
        output += " " + pluralize(remainder, TimeUnits.SECONDS);
      }

      return output;
    }

    remainder = duration % 60;
    duration = Math.floor(duration / 60);

    if (duration < 24) {
      output = pluralize(duration, TimeUnits.HOURS);

      if (remainder > 0) {
        output += " " + pluralize(remainder, TimeUnits.MINUTES);
      }

      return output;
    }

    remainder = duration % 24;
    duration = Math.floor(duration / 24);
    output = pluralize(duration, TimeUnits.DAYS);

    if (remainder > 0) {
      output += " " + pluralize(remainder, TimeUnits.HOURS);
    }

    return output;
  };

  return result;
}

module.filter('ngeoDuration', DurationFilter);
var StringToHtmlReplacements = [{
  expression: /^(https?:\/\/.+)$/gm,
  template: '<a target="_blank" href="$1">$1</a>'
}, {
  expression: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/gmi,
  template: '<a href="mailto:$1">$1</a>'
}];
module.constant('ngeoStringToHtmlReplacements', StringToHtmlReplacements);

var removeCDATA = function removeCDATA() {
  return function (input) {
    if (input && input.replace) {
      return input.replace(/<!\[CDATA\[(.*)\]\]>/, '$1');
    }
  };
};

module.filter('removeCDATA', removeCDATA);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/php-date-formatter.js":
/*!****************************************!*\
  !*** ./src/misc/php-date-formatter.js ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return DateFormatter; });


var DAY = 1000 * 60 * 60 * 24;
var HOUR = 3600;

function _compare(str1, str2) {
  return typeof str1 === 'string' && typeof str2 === 'string' && str1.toLowerCase() === str2.toLowerCase();
}

function _lpad(value, length, chr) {
  var val = value.toString();
  chr = chr || '0';
  return val.length < length ? _lpad(chr + val, length) : val;
}

function _extend(out) {
  out = out || {};

  for (var i = 1; i < arguments.length; i++) {
    var obj = arguments[i];

    if (!obj) {
      continue;
    }

    for (var key in obj) {
      if (obj.hasOwnProperty(key)) {
        if (typeof obj[key] === 'object') {
          _extend(out[key], obj[key]);
        } else {
          out[key] = obj[key];
        }
      }
    }
  }

  return out;
}

function _indexOf(val, arr) {
  for (var i = 0; i < arr.length; i++) {
    if (arr[i].toLowerCase() === val.toLowerCase()) {
      return i;
    }
  }

  return -1;
}

var defaultSettings = {
  dateSettings: {
    days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
    daysShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
    months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
    monthsShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    meridiem: ['AM', 'PM'],
    ordinal: function ordinal(number) {
      var n = number % 10,
          suffixes = {
        1: 'st',
        2: 'nd',
        3: 'rd'
      };
      return Math.floor(number % 100 / 10) === 1 || !suffixes[n] ? 'th' : suffixes[n];
    }
  },
  separators: /[ \-+/.T:@]/g,
  validParts: /[dDjlNSwzWFmMntLoYyaABgGhHisueTIOPZcrU]/g,
  intParts: /[djwNzmnyYhHgGis]/g,
  tzParts: /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,
  tzClip: /[^-+\dA-Z]/g
};

var DateFormatter = function () {
  function DateFormatter(options) {
    var self = this,
        config = _extend(defaultSettings, options);

    self.dateSettings = config.dateSettings;
    self.separators = config.separators;
    self.validParts = config.validParts;
    self.intParts = config.intParts;
    self.tzParts = config.tzParts;
    self.tzClip = config.tzClip;
  }

  var _proto = DateFormatter.prototype;

  _proto.getMonth = function getMonth(val) {
    var self = this;
    var i = _indexOf(val, self.dateSettings.monthsShort) + 1;

    if (i === 0) {
      i = _indexOf(val, self.dateSettings.months) + 1;
    }

    return i;
  };

  _proto.parseDate = function parseDate(vDate, vFormat) {
    var self = this,
        vSettings = self.dateSettings,
        out = {
      date: null,
      year: null,
      month: null,
      day: null,
      hour: 0,
      min: 0,
      sec: 0
    };
    var vDateFlag = false,
        vTimeFlag = false,
        i;

    if (!vDate) {
      return null;
    }

    if (vDate instanceof Date) {
      return vDate;
    }

    if (vFormat === 'U') {
      i = parseInt(vDate);
      return i ? new Date(i * 1000) : vDate;
    }

    switch (typeof vDate) {
      case 'number':
        return new Date(vDate);

      case 'string':
        break;

      default:
        return null;
    }

    var vFormatParts = vFormat.match(self.validParts);

    if (!vFormatParts || vFormatParts.length === 0) {
      throw new Error("Invalid date format definition.");
    }

    var vDateParts = vDate.replace(self.separators, '\0').split('\0');

    for (i = 0; i < vDateParts.length; i++) {
      var vDatePart = vDateParts[i];
      var iDatePart = parseInt(vDatePart);

      switch (vFormatParts[i]) {
        case 'y':
        case 'Y':
          if (iDatePart) {
            var len = vDatePart.length;
            out.year = len === 2 ? parseInt((iDatePart < 70 ? '20' : '19') + vDatePart) : iDatePart;
          } else {
            return null;
          }

          vDateFlag = true;
          break;

        case 'm':
        case 'n':
        case 'M':
        case 'F':
          if (isNaN(iDatePart)) {
            var vMonth = self.getMonth(vDatePart);

            if (vMonth > 0) {
              out.month = vMonth;
            } else {
              return null;
            }
          } else {
            if (iDatePart >= 1 && iDatePart <= 12) {
              out.month = iDatePart;
            } else {
              return null;
            }
          }

          vDateFlag = true;
          break;

        case 'd':
        case 'j':
          if (iDatePart >= 1 && iDatePart <= 31) {
            out.day = iDatePart;
          } else {
            return null;
          }

          vDateFlag = true;
          break;

        case 'g':
        case 'h':
          var vMeriIndex = vFormatParts.includes('a') ? vFormatParts.indexOf('a') : vFormatParts.includes('A') ? vFormatParts.indexOf('A') : -1;
          var mer = vDateParts[vMeriIndex];

          if (vMeriIndex !== -1) {
            var vMeriOffset = _compare(mer, vSettings.meridiem[0]) ? 0 : _compare(mer, vSettings.meridiem[1]) ? 12 : -1;

            if (iDatePart >= 1 && iDatePart <= 12 && vMeriOffset !== -1) {
              out.hour = iDatePart % 12 === 0 ? vMeriOffset : iDatePart + vMeriOffset;
            } else {
              if (iDatePart >= 0 && iDatePart <= 23) {
                out.hour = iDatePart;
              }
            }
          } else {
            if (iDatePart >= 0 && iDatePart <= 23) {
              out.hour = iDatePart;
            } else {
              return null;
            }
          }

          vTimeFlag = true;
          break;

        case 'G':
        case 'H':
          if (iDatePart >= 0 && iDatePart <= 23) {
            out.hour = iDatePart;
          } else {
            return null;
          }

          vTimeFlag = true;
          break;

        case 'i':
          if (iDatePart >= 0 && iDatePart <= 59) {
            out.min = iDatePart;
          } else {
            return null;
          }

          vTimeFlag = true;
          break;

        case 's':
          if (iDatePart >= 0 && iDatePart <= 59) {
            out.sec = iDatePart;
          } else {
            return null;
          }

          vTimeFlag = true;
          break;
      }
    }

    if (vDateFlag === true && out.year && out.month && out.day) {
      out.date = new Date(out.year, out.month - 1, out.day, out.hour, out.min, out.sec, 0);
    } else {
      if (vTimeFlag !== true) {
        return null;
      }

      out.date = new Date(0, 0, 0, out.hour, out.min, out.sec, 0);
    }

    return out.date;
  };

  _proto.guessDate = function guessDate(vDateStr, vFormat) {
    if (typeof vDateStr !== 'string') {
      return vDateStr;
    }

    var self = this;
    var vParts = vDateStr.replace(self.separators, '\0').split('\0'),
        vPattern = /^[djmn]/g;
    var vFormatParts = vFormat.match(self.validParts);
    var vDate = new Date();

    if (!vPattern.test(vFormatParts[0])) {
      return vDateStr;
    }

    for (var i = 0; i < vParts.length; i++) {
      var vDigit = 2;
      var iPart = vParts[i];
      var iSec = parseInt(iPart.substr(0, 2));

      if (isNaN(iSec)) {
        return null;
      }

      switch (i) {
        case 0:
          if (vFormatParts[0] === 'm' || vFormatParts[0] === 'n') {
            vDate.setMonth(iSec - 1);
          } else {
            vDate.setDate(iSec);
          }

          break;

        case 1:
          if (vFormatParts[0] === 'm' || vFormatParts[0] === 'n') {
            vDate.setDate(iSec);
          } else {
            vDate.setMonth(iSec - 1);
          }

          break;

        case 2:
          var vYear = vDate.getFullYear();
          var len = iPart.length;
          vDigit = len < 4 ? len : 4;
          vYear = parseInt(len < 4 ? vYear.toString().substr(0, 4 - len) + iPart : iPart.substr(0, 4));

          if (!vYear) {
            return null;
          }

          vDate.setFullYear(vYear);
          break;

        case 3:
          vDate.setHours(iSec);
          break;

        case 4:
          vDate.setMinutes(iSec);
          break;

        case 5:
          vDate.setSeconds(iSec);
          break;
      }

      var n = iPart.substr(vDigit);

      if (n.length > 0) {
        vParts.splice(i + 1, 0, n);
      }
    }

    return vDate;
  };

  _proto.parseFormat = function parseFormat(vChar, vDate) {
    var fmt = null;

    var self = this,
        vSettings = self.dateSettings,
        backslash = /\\?(.?)/gi,
        doFormat = function doFormat(t, s) {
      return fmt[t] ? fmt[t]() : s;
    };

    fmt = {
      d: function d() {
        return _lpad(fmt.j(), 2);
      },
      D: function D() {
        return vSettings.daysShort[fmt.w()];
      },
      j: function j() {
        return vDate.getDate();
      },
      l: function l() {
        return vSettings.days[fmt.w()];
      },
      N: function N() {
        return fmt.w() || 7;
      },
      w: function w() {
        return vDate.getDay();
      },
      z: function z() {
        var a = new Date(fmt.Y(), fmt.n() - 1, fmt.j()),
            b = new Date(fmt.Y(), 0, 1);
        return Math.round((a - b) / DAY);
      },
      W: function W() {
        var a = new Date(fmt.Y(), fmt.n() - 1, fmt.j() - fmt.N() + 3);
        var b = new Date(a.getFullYear(), 0, 4);
        return _lpad(1 + Math.round((a - b) / DAY / 7), 2);
      },
      F: function F() {
        return vSettings.months[vDate.getMonth()];
      },
      m: function m() {
        return _lpad(fmt.n(), 2);
      },
      M: function M() {
        return vSettings.monthsShort[vDate.getMonth()];
      },
      n: function n() {
        return vDate.getMonth() + 1;
      },
      t: function t() {
        return new Date(fmt.Y(), fmt.n(), 0).getDate();
      },
      L: function L() {
        var Y = fmt.Y();
        return Y % 4 === 0 && Y % 100 !== 0 || Y % 400 === 0 ? 1 : 0;
      },
      o: function o() {
        var n = fmt.n(),
            W = fmt.W(),
            Y = fmt.Y();
        return Y + (n === 12 && W < 9 ? 1 : n === 1 && W > 9 ? -1 : 0);
      },
      Y: function Y() {
        return vDate.getFullYear();
      },
      y: function y() {
        return fmt.Y().toString().slice(-2);
      },
      a: function a() {
        return fmt.A().toLowerCase();
      },
      A: function A() {
        var n = fmt.G() < 12 ? 0 : 1;
        return vSettings.meridiem[n];
      },
      B: function B() {
        var H = vDate.getUTCHours() * HOUR;
        var i = vDate.getUTCMinutes() * 60;
        var s = vDate.getUTCSeconds();
        return _lpad(Math.floor((H + i + s + HOUR) / 86.4) % 1000, 3);
      },
      g: function g() {
        return fmt.G() % 12 || 12;
      },
      G: function G() {
        return vDate.getHours();
      },
      h: function h() {
        return _lpad(fmt.g(), 2);
      },
      H: function H() {
        return _lpad(fmt.G(), 2);
      },
      i: function i() {
        return _lpad(vDate.getMinutes(), 2);
      },
      s: function s() {
        return _lpad(vDate.getSeconds(), 2);
      },
      u: function u() {
        return _lpad(vDate.getMilliseconds() * 1000, 6);
      },
      e: function e() {
        var str = /\((.*)\)/.exec(String(vDate))[1];
        return str || 'Coordinated Universal Time';
      },
      I: function I() {
        var a = new Date(fmt.Y(), 0),
            c = Date.UTC(fmt.Y(), 0),
            b = new Date(fmt.Y(), 6),
            d = Date.UTC(fmt.Y(), 6);
        return a - c !== b - d ? 1 : 0;
      },
      O: function O() {
        var tzo = vDate.getTimezoneOffset(),
            a = Math.abs(tzo);
        return (tzo > 0 ? '-' : '+') + _lpad(Math.floor(a / 60) * 100 + a % 60, 4);
      },
      P: function P() {
        var O = fmt.O();
        return O.substr(0, 3) + ':' + O.substr(3, 2);
      },
      T: function T() {
        var str = (String(vDate).match(self.tzParts) || [""]).pop().replace(self.tzClip, "");
        return str || 'UTC';
      },
      Z: function Z() {
        return -vDate.getTimezoneOffset() * 60;
      },
      c: function c() {
        return 'Y-m-d\\TH:i:sP'.replace(backslash, doFormat);
      },
      r: function r() {
        return 'D, d M Y H:i:s O'.replace(backslash, doFormat);
      },
      U: function U() {
        return vDate.getTime() / 1000 || 0;
      }
    };
    return doFormat(vChar, vChar);
  };

  _proto.formatDate = function formatDate(vDate, vFormat) {
    var self = this,
        BACKSLASH = '\\';

    if (typeof vDate === 'string') {
      vDate = self.parseDate(vDate, vFormat);

      if (!vDate) {
        return null;
      }
    }

    if (vDate instanceof Date) {
      var vDateStr = '';
      var len = vFormat.length;

      for (var i = 0; i < len; i++) {
        var vChar = vFormat.charAt(i);

        if (vChar === 'S' || vChar === BACKSLASH) {
          continue;
        }

        if (i > 0 && vFormat.charAt(i - 1) === BACKSLASH) {
          vDateStr += vChar;
          continue;
        }

        var str = self.parseFormat(vChar, vDate);

        if (i !== len - 1 && self.intParts.test(vChar) && vFormat.charAt(i + 1) === 'S') {
          var n = parseInt(str) || 0;
          str += self.dateSettings.ordinal(n);
        }

        vDateStr += str;
      }

      return vDateStr;
    }

    return '';
  };

  return DateFormatter;
}();



/***/ }),

/***/ "./src/misc/sortableComponent.js":
/*!***************************************!*\
  !*** ./src/misc/sortableComponent.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var jquery_ui_ui_widgets_sortable_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery-ui/ui/widgets/sortable.js */ "./node_modules/jquery-ui/ui/widgets/sortable.js");
/* harmony import */ var jquery_ui_ui_widgets_sortable_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_sortable_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/sass/jquery-ui.scss */ "./src/sass/jquery-ui.scss");
/* harmony import */ var ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(ngeo_sass_jquery_ui_scss__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var jquery_ui_touch_punch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jquery-ui-touch-punch */ "./node_modules/jquery-ui-touch-punch/jquery.ui.touch-punch.js");
/* harmony import */ var jquery_ui_touch_punch__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_touch_punch__WEBPACK_IMPORTED_MODULE_3__);
sortableComponent.$inject = ["$timeout"];




var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoSortable', []);

function sortableComponent($timeout) {
  return {
    restrict: 'A',
    link: function link(scope, element, attrs) {
      var sortable = scope.$eval(attrs.ngeoSortable) || [];
      console.assert(Array.isArray(sortable));
      scope.$watchCollection(function () {
        return sortable;
      }, function () {
        sortable.length && $timeout(resetUpDragDrop, 0);
      });
      var optionsObject = scope.$eval(attrs.ngeoSortableOptions);
      var options = getOptions(optionsObject);
      var callbackFn = scope.$eval(attrs.ngeoSortableCallback);
      var callbackCtx = scope.$eval(attrs.ngeoSortableCallbackCtx);

      function resetUpDragDrop() {
        var children = element.children();

        for (var i = 0; i < children.length; ++i) {
          angular__WEBPACK_IMPORTED_MODULE_0___default.a.element(children[i]).data('idx', i);
        }

        var sortableElement = $(element);

        if (sortableElement.data('ui-sortable')) {
          sortableElement.off('sortupdate');
          sortableElement.sortable('destroy');
        }

        var sortableOptions = {
          axis: 'y',
          classes: {
            'ui-sortable-helper': options.draggerClassName
          }
        };

        if (options.handleClassName) {
          sortableOptions.handle = "." + options.handleClassName;
        }

        if (options.placeholderClassName) {
          sortableOptions.placeholder = options.placeholderClassName;
          sortableOptions.forcePlaceholderSize = true;
        }

        sortableElement.sortable(sortableOptions);
        sortableElement.on('sortupdate', function (event, ui) {
          var oldIndex = $(ui.item[0]).data('idx');
          var newIndex = ui.item.index();
          $(ui.item[0]).data('idx', newIndex);
          scope.$apply(function () {
            sortable.splice(newIndex, 0, sortable.splice(oldIndex, 1)[0]);
          });

          if (callbackFn instanceof Function) {
            callbackFn.apply(callbackCtx, [element, sortable]);
          }
        });
      }

      function getOptions(options) {
        var ret;
        var defaultHandleClassName = 'ngeo-sortable-handle';

        if (options === undefined) {
          ret = {
            'handleClassName': defaultHandleClassName
          };
        } else {
          if (options.handleClassName === undefined) {
            options.handleClassName = defaultHandleClassName;
          }

          ret = options;
        }

        return ret;
      }
    }
  };
}

module.directive('ngeoSortable', sortableComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/misc/swipe.js":
/*!***************************!*\
  !*** ./src/misc/swipe.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMiscSwipe', []);
module.factory('$verticalSwipe', [function () {
  var MOVE_BUFFER_RADIUS = 10;
  var POINTER_EVENTS = {
    mouse: {
      start: 'mousedown',
      move: 'mousemove',
      end: 'mouseup'
    },
    touch: {
      start: 'touchstart',
      move: 'touchmove',
      end: 'touchend',
      cancel: 'touchcancel'
    },
    pointer: {
      start: 'pointerdown',
      move: 'pointermove',
      end: 'pointerup',
      cancel: 'pointercancel'
    }
  };

  function getCoordinates(event) {
    var uiEvent;
    var touchEvent = event.originalEvent;

    if (touchEvent.changedTouches && touchEvent.changedTouches.length > 0) {
      uiEvent = touchEvent.changedTouches[0];
    } else {
      uiEvent = event.originalEvent;
    }

    return {
      x: uiEvent.clientX,
      y: uiEvent.clientY
    };
  }

  function getEvents(pointerTypes, eventType) {
    var res = [];
    angular__WEBPACK_IMPORTED_MODULE_0___default.a.forEach(pointerTypes, function (pointerType) {
      var eventName = POINTER_EVENTS[pointerType][eventType];

      if (eventName) {
        res.push(eventName);
      }
    });
    return res.join(' ');
  }

  return {
    bind: function bind(element, eventHandlers, pointerTypes) {
      var totalX;
      var totalY;
      var startCoords;
      var lastPos;
      var active = false;
      pointerTypes = pointerTypes || ['mouse', 'touch', 'pointer'];
      element.on(getEvents(pointerTypes, 'start'), function (event) {
        startCoords = getCoordinates(event);
        active = true;
        totalX = 0;
        totalY = 0;
        lastPos = startCoords;

        if (eventHandlers.start) {
          eventHandlers.start(startCoords, event);
        }
      });
      var events = getEvents(pointerTypes, 'cancel');

      if (events) {
        element.on(events, function (event) {
          active = false;

          if (eventHandlers.cancel) {
            eventHandlers.cancel(event);
          }
        });
      }

      element.on(getEvents(pointerTypes, 'move'), function (event) {
        if (!active) {
          return;
        }

        if (!startCoords) {
          return;
        }

        var coords = getCoordinates(event);
        totalX += Math.abs(coords.x - lastPos.x);
        totalY += Math.abs(coords.y - lastPos.y);
        lastPos = coords;

        if (totalX < MOVE_BUFFER_RADIUS && totalY < MOVE_BUFFER_RADIUS) {
          return;
        }

        if (totalX > totalY) {
          active = false;

          if (eventHandlers.cancel) {
            eventHandlers.cancel(event);
          }

          return;
        } else {
          event.preventDefault();

          if (eventHandlers.move) {
            eventHandlers.move(coords, event);
          }
        }
      });
      element.on(getEvents(pointerTypes, 'end'), function (event) {
        if (!active) {
          return;
        }

        active = false;

        if (eventHandlers.end) {
          eventHandlers.end(getCoordinates(event), event);
        }
      });
    }
  };
}]);

function makeSwipeDirective_(directiveName, direction, eventName) {
  module.directive(directiveName, ['$parse', '$verticalSwipe', function ($parse, $verticalSwipe) {
    var MAX_HORIZONTAL_DISTANCE = 75;
    var MAX_HORIZONTAL_RATIO = 0.3;
    var MIN_VERTICAL_DISTANCE = 30;
    return function (scope, element, attr) {
      var swipeHandler = $parse(attr[directiveName]);
      var startCoords;
      var valid;

      function validSwipe(coords) {
        if (!startCoords) {
          return false;
        }

        var deltaY = (coords.y - startCoords.y) * direction;
        var deltaX = Math.abs(coords.x - startCoords.x);
        return valid && deltaX < MAX_HORIZONTAL_DISTANCE && deltaY > 0 && deltaY > MIN_VERTICAL_DISTANCE && deltaX / deltaY < MAX_HORIZONTAL_RATIO;
      }

      var pointerTypes = ['touch'];

      if (angular__WEBPACK_IMPORTED_MODULE_0___default.a.isDefined(attr.ngeoSwipeDisableMouse)) {
        pointerTypes.push('mouse');
      }

      $verticalSwipe.bind(element, {
        'start': function start(coords, event) {
          startCoords = coords;
          valid = true;
        },
        'cancel': function cancel(event) {
          valid = false;
        },
        'end': function end(coords, event) {
          if (validSwipe(coords)) {
            scope.$apply(function () {
              element.triggerHandler(eventName);
              swipeHandler(scope, {
                $event: event
              });
            });
          }
        }
      }, pointerTypes);
    };
  }]);
}

makeSwipeDirective_('ngeoSwipeDown', 1, 'swipedown');
makeSwipeDirective_('ngeoSwipeUp', -1, 'swipeup');
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/misc/syncArrays.js":
/*!********************************!*\
  !*** ./src/misc/syncArrays.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
function syncArrays(arr1, arr2, reverse, scope, filter) {
  var dereg1 = scope.$watchCollection(function () {
    return arr1;
  }, function () {
    var i, ii, j;

    if (reverse) {
      for (i = arr1.length - 1, j = 0; i >= 0; --i) {
        if (filter(arr1[i])) {
          arr2[j++] = arr1[i];
        }
      }
    } else {
      for (i = 0, ii = arr1.length, j = 0; i < ii; ++i) {
        if (filter(arr1[i])) {
          arr2[j++] = arr1[i];
        }
      }
    }

    arr2.length = j;
  });
  var dereg2 = scope.$watchCollection(function () {
    return arr2;
  }, function () {
    var i, ii, j;

    if (reverse) {
      for (i = 0, ii = arr1.length, j = arr2.length - 1; i < ii; ++i) {
        if (filter(arr1[i])) {
          arr1[i] = arr2[j--];
        }
      }

      console.assert(j == -1);
    } else {
      for (i = 0, ii = arr1.length, j = 0; i < ii; ++i) {
        if (filter(arr1[i])) {
          arr1[i] = arr2[j++];
        }
      }

      console.assert(j == arr2.length);
    }
  });
  return function () {
    dereg1();
    dereg2();
  };
}

/* harmony default export */ __webpack_exports__["default"] = (syncArrays);

/***/ }),

/***/ "./src/olcs/constants.js":
/*!*******************************!*\
  !*** ./src/olcs/constants.js ***!
  \*******************************/
/*! exports provided: Permalink3dParam */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Permalink3dParam", function() { return Permalink3dParam; });
var Permalink3dParam = {
  ENABLED: '3d_enabled',
  LON: '3d_lon',
  LAT: '3d_lat',
  ELEVATION: '3d_elevation',
  HEADING: '3d_heading',
  PITCH: '3d_pitch',
  PREFIX: '3d_'
};

/***/ }),

/***/ "./src/print/Mask.js":
/*!***************************!*\
  !*** ./src/print/Mask.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Mask; });
/* harmony import */ var ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/layer/Layer.js */ "./node_modules/ol/layer/Layer.js");
/* harmony import */ var ol_dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/dom.js */ "./node_modules/ol/dom.js");
/* harmony import */ var ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/print/Utils.js */ "./src/print/Utils.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }





var Mask = function (_Layer) {
  _inheritsLoose(Mask, _Layer);

  function Mask(options) {
    var _this;

    if (options === void 0) {
      options = {};
    }

    _this = _Layer.call(this, options) || this;
    _this.context_ = Object(ol_dom_js__WEBPACK_IMPORTED_MODULE_1__["createCanvasContext2D"])();
    _this.context_.canvas.style.opacity = '0.5';
    _this.context_.canvas.style.position = 'absolute';
    _this.getScale;
    _this.getSize;
    _this.getRotation;
    return _this;
  }

  var _proto = Mask.prototype;

  _proto.render = function render(frameState) {
    this.context_.canvas.width = frameState.size[0] * frameState.pixelRatio;
    this.context_.canvas.height = frameState.size[1] * frameState.pixelRatio;
    var center = [this.context_.canvas.width / 2, this.context_.canvas.height / 2];
    this.context_.beginPath();
    this.context_.moveTo(0, 0);
    this.context_.lineTo(this.context_.canvas.width, 0);
    this.context_.lineTo(this.context_.canvas.width, this.context_.canvas.height);
    this.context_.lineTo(0, this.context_.canvas.height);
    this.context_.lineTo(0, 0);
    this.context_.closePath();
    var size = this.getSize();
    var height = size[1] * frameState.pixelRatio;
    var width = size[0] * frameState.pixelRatio;
    var scale = this.getScale(frameState);
    var resolution = frameState.viewState.resolution;
    var extentHalfWidth = width / ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_2__["DOTS_PER_INCH"] / ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_2__["INCHES_PER_METER"] * scale / resolution / 2;
    var extentHalfHeight = height / ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_2__["DOTS_PER_INCH"] / ngeo_print_Utils_js__WEBPACK_IMPORTED_MODULE_2__["INCHES_PER_METER"] * scale / resolution / 2;
    var rotation = this.getRotation !== undefined ? this.getRotation() : 0;
    var diagonal = Math.sqrt(Math.pow(extentHalfWidth, 2) + Math.pow(extentHalfHeight, 2));
    var gamma = Math.atan(extentHalfHeight / extentHalfWidth) - rotation;
    var omega = Math.atan(extentHalfWidth / extentHalfHeight) - rotation;
    var x1 = center[0] - Math.cos(gamma) * diagonal;
    var y1 = center[1] + Math.sin(gamma) * diagonal;
    var x2 = center[0] + Math.sin(omega) * diagonal;
    var y2 = center[1] + Math.cos(omega) * diagonal;
    var x3 = center[0] + Math.cos(gamma) * diagonal;
    var y3 = center[1] - Math.sin(gamma) * diagonal;
    var x4 = center[0] - Math.sin(omega) * diagonal;
    var y4 = center[1] - Math.cos(omega) * diagonal;
    this.context_.moveTo(x1, y1);
    this.context_.lineTo(x2, y2);
    this.context_.lineTo(x3, y3);
    this.context_.lineTo(x4, y4);
    this.context_.lineTo(x1, y1);
    this.context_.closePath();
    this.context_.fillStyle = '#000';
    this.context_.fill();
    return this.context_.canvas;
  };

  return Mask;
}(ol_layer_Layer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);



/***/ }),

/***/ "./src/print/Service.js":
/*!******************************!*\
  !*** ./src/print/Service.js ***!
  \******************************/
/*! exports provided: PrintService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PrintService", function() { return PrintService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_print_VectorEncoder_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/print/VectorEncoder.js */ "./src/print/VectorEncoder.js");
/* harmony import */ var ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/map/LayerHelper.js */ "./src/map/LayerHelper.js");
/* harmony import */ var ol_array_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/array.js */ "./node_modules/ol/array.js");
/* harmony import */ var ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/layer/Image.js */ "./node_modules/ol/layer/Image.js");
/* harmony import */ var ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/layer/Tile.js */ "./node_modules/ol/layer/Tile.js");
/* harmony import */ var ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/layer/Vector.js */ "./node_modules/ol/layer/Vector.js");
/* harmony import */ var ol_math_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/math.js */ "./node_modules/ol/math.js");
/* harmony import */ var ol_size_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/size.js */ "./node_modules/ol/size.js");
/* harmony import */ var ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/source/ImageWMS.js */ "./node_modules/ol/source/ImageWMS.js");
/* harmony import */ var ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/source/TileWMS.js */ "./node_modules/ol/source/TileWMS.js");
/* harmony import */ var ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/source/WMTS.js */ "./node_modules/ol/source/WMTS.js");
/* harmony import */ var ol_tilegrid_WMTS_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ol/tilegrid/WMTS.js */ "./node_modules/ol/tilegrid/WMTS.js");
PrintService.$inject = ["url", "$http", "gettextCatalog", "ngeoLayerHelper"];
createPrintServiceFactory.$inject = ["$http", "gettextCatalog", "ngeoLayerHelper"];













function PrintService(url, $http, gettextCatalog, ngeoLayerHelper) {
  this.url_ = url;
  this.$http_ = $http;
  this.gettextCatalog_ = gettextCatalog;
  this.ngeoLayerHelper_ = ngeoLayerHelper;
  this.vectorEncoder = new ngeo_print_VectorEncoder_js__WEBPACK_IMPORTED_MODULE_1__["default"]();
  this.printNativeAngle_ = true;
}

PrintService.prototype.cancel = function (ref, opt_httpConfig) {
  var httpConfig = opt_httpConfig !== undefined ? opt_httpConfig : {};
  var url = this.url_ + "/cancel/" + ref;
  return this.$http_['delete'](url, httpConfig);
};

PrintService.prototype.createSpec = function (map, scale, dpi, layout, format, customAttributes, email) {
  var specMap = {
    dpi: dpi,
    rotation: customAttributes.rotation
  };
  this.encodeMap_(map, scale, specMap);
  var attributes = {
    map: specMap
  };
  Object.assign(attributes, customAttributes);
  var lang = this.gettextCatalog_.getCurrentLanguage();
  var spec = {
    attributes: attributes,
    format: format,
    lang: lang,
    layout: layout
  };

  if (email) {
    spec.smtp = {
      to: email
    };
  }

  return spec;
};

PrintService.prototype.encodeMap_ = function (map, scale, object) {
  var _this = this;

  var view = map.getView();
  var viewCenter = view.getCenter();
  var viewProjection = view.getProjection();
  var viewResolution = view.getResolution();
  var viewRotation = object.rotation || Object(ol_math_js__WEBPACK_IMPORTED_MODULE_7__["toDegrees"])(view.getRotation());

  if (!viewCenter) {
    throw new Error('Missing viewCenter');
  }

  if (!viewProjection) {
    throw new Error('Missing viewProjection');
  }

  if (!viewResolution) {
    throw new Error('Missing viewResolution');
  }

  object.center = viewCenter;
  object.projection = viewProjection.getCode();
  object.rotation = viewRotation;
  object.scale = scale;
  object.layers = [];
  var mapLayerGroup = map.getLayerGroup();

  if (!mapLayerGroup) {
    throw new Error('Missing mapLayerGroup');
  }

  this.printNativeAngle_ = mapLayerGroup.get('printNativeAngle') !== false;
  var layers = this.ngeoLayerHelper_.getFlatLayers(mapLayerGroup);
  Object(ol_array_js__WEBPACK_IMPORTED_MODULE_3__["stableSort"])(layers, function (layer_a, layer_b) {
    return (layer_a.getZIndex() || 0) - (layer_b.getZIndex() || 0);
  });
  layers = layers.slice().reverse();
  layers.forEach(function (layer) {
    if (layer.getVisible()) {
      _this.encodeLayer(object.layers, layer, viewResolution);
    }
  });
};

PrintService.prototype.encodeLayer = function (arr, layer, resolution) {
  if (layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_4__["default"]) {
    this.encodeImageLayer_(arr, layer);
  } else if (layer instanceof ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
    this.encodeTileLayer_(arr, layer);
  } else if (layer instanceof ol_layer_Vector_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
    this.encodeVectorLayer(arr, layer, resolution);
  }
};

PrintService.prototype.encodeVectorLayer = function (arr, layer, resolution) {
  this.vectorEncoder.encodeVectorLayer(arr, layer, resolution);
};

PrintService.prototype.encodeImageLayer_ = function (arr, layer) {
  if (!(layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_4__["default"])) {
    throw new Error('layer not instance of olLayerImage');
  }

  var source = layer.getSource();

  if (source instanceof ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_9__["default"]) {
    this.encodeImageWmsLayer_(arr, layer);
  }
};

PrintService.prototype.encodeImageWmsLayer_ = function (arr, layer) {
  if (!(layer instanceof ol_layer_Image_js__WEBPACK_IMPORTED_MODULE_4__["default"])) {
    throw new Error('layer not instance of olLayerImage');
  }

  var source = layer.getSource();

  if (!(source instanceof ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_9__["default"])) {
    throw new Error('source not instance of olSourceImageWMS');
  }

  var url = source.getUrl();

  if (url !== undefined) {
    this.encodeWmsLayer_(arr, layer, url, source.getParams());
  }
};

PrintService.prototype.encodeWmsLayer_ = function (arr, layer, url, params) {
  if (url.startsWith('//')) {
    url = window.location.protocol + url;
  }

  var url_url = new URL(url);
  var customParams = {
    'TRANSPARENT': 'true'
  };

  if (url_url.searchParams) {
    url_url.searchParams.forEach(function (value, key) {
      customParams[key] = value;
    });
  }

  for (var key in params) {
    var value = params[key];

    if (value !== null && value !== undefined) {
      customParams[key] = value;
    }
  }

  delete customParams.LAYERS;
  delete customParams.FORMAT;
  delete customParams.SERVERTYPE;
  delete customParams.VERSION;
  var serverType = undefined;

  if (params.SERVERTYPE !== 'arcgis') {
    serverType = params.SERVERTYPE;
  }

  var object = {
    baseURL: getAbsoluteUrl_(url_url.origin + url_url.pathname),
    imageFormat: 'FORMAT' in params ? params.FORMAT : 'image/png',
    layers: params.LAYERS.split(','),
    customParams: customParams,
    serverType: serverType,
    type: 'wms',
    opacity: this.getOpacityOrInherited_(layer),
    version: params.VERSION,
    useNativeAngle: this.printNativeAngle_
  };
  arr.push(object);
};

function getAbsoluteUrl_(url) {
  var a = document.createElement('a');
  a.href = encodeURI(url);
  return decodeURI(a.href);
}

PrintService.prototype.encodeTileLayer_ = function (arr, layer) {
  if (!(layer instanceof ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_5__["default"])) {
    throw new Error('layer not instance of olLayerTile');
  }

  var source = layer.getSource();

  if (source instanceof ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_11__["default"]) {
    this.encodeTileWmtsLayer_(arr, layer);
  } else if (source instanceof ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_10__["default"]) {
    this.encodeTileWmsLayer_(arr, layer);
  }
};

PrintService.prototype.encodeTileWmtsLayer_ = function (arr, layer) {
  if (!(layer instanceof ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_5__["default"])) {
    throw new Error('layer not instance of olLayerTile');
  }

  var source = layer.getSource();

  if (!(source instanceof ol_source_WMTS_js__WEBPACK_IMPORTED_MODULE_11__["default"])) {
    throw new Error('source not instance of olSourceWMTS');
  }

  var projection = source.getProjection();

  if (!projection) {
    throw new Error('Missing projection');
  }

  var metersPerUnit = projection.getMetersPerUnit();

  if (!metersPerUnit) {
    throw new Error('Missing metersPerUnit');
  }

  var tileGrid = source.getTileGrid();

  if (!(tileGrid instanceof ol_tilegrid_WMTS_js__WEBPACK_IMPORTED_MODULE_12__["default"])) {
    throw new Error('tileGrid not instance of olTilegridWMTS');
  }

  var matrixIds = tileGrid.getMatrixIds();
  var matrices = [];

  for (var i = 0, ii = matrixIds.length; i < ii; ++i) {
    var tileRange = tileGrid.getFullTileRange(i);
    matrices.push({
      identifier: matrixIds[i],
      scaleDenominator: tileGrid.getResolution(i) * metersPerUnit / 0.28E-3,
      tileSize: ol_size_js__WEBPACK_IMPORTED_MODULE_8__["toSize"](tileGrid.getTileSize(i)),
      topLeftCorner: tileGrid.getOrigin(i),
      matrixSize: [tileRange.maxX - tileRange.minX, tileRange.maxY - tileRange.minY]
    });
  }

  var dimensions = source.getDimensions();
  var dimensionKeys = Object.keys(dimensions);
  var object = {
    baseURL: this.getWmtsUrl_(source),
    dimensions: dimensionKeys,
    dimensionParams: dimensions,
    imageFormat: source.getFormat(),
    layer: source.getLayer(),
    matrices: matrices,
    matrixSet: source.getMatrixSet(),
    opacity: this.getOpacityOrInherited_(layer),
    requestEncoding: source.getRequestEncoding(),
    style: source.getStyle(),
    type: 'WMTS',
    version: source.getVersion()
  };
  arr.push(object);
};

PrintService.prototype.encodeTileWmsLayer_ = function (arr, layer) {
  if (!(layer instanceof ol_layer_Tile_js__WEBPACK_IMPORTED_MODULE_5__["default"])) {
    throw new Error('layer not instance of olLayerTile');
  }

  var source = layer.getSource();

  if (!(source instanceof ol_source_TileWMS_js__WEBPACK_IMPORTED_MODULE_10__["default"])) {
    throw new Error('source not instance of olSourceTileWMS');
  }

  var urls = source.getUrls();

  if (!urls) {
    throw new Error('Missing urls');
  }

  this.encodeWmsLayer_(arr, layer, urls[0], source.getParams());
};

PrintService.prototype.getWmtsUrl_ = function (source) {
  var urls = source.getUrls();

  if (!urls) {
    throw new Error('Missing urls');
  }

  return getAbsoluteUrl_(urls[0]);
};

PrintService.prototype.getOpacityOrInherited_ = function (layer) {
  if (layer.get('inheritedOpacity') !== undefined) {
    return layer.get('inheritedOpacity');
  }

  return layer.getOpacity();
};

PrintService.prototype.createReport = function (printSpec, opt_httpConfig) {
  var format = printSpec.format || 'pdf';
  var url = this.url_ + "/report." + format;
  var httpConfig = {
    headers: {
      'Content-Type': 'application/json; charset=UTF-8'
    }
  };
  Object.assign(httpConfig, opt_httpConfig !== undefined ? opt_httpConfig : {});
  return this.$http_.post(url, printSpec, httpConfig);
};

PrintService.prototype.getStatus = function (ref, opt_httpConfig) {
  var httpConfig = opt_httpConfig !== undefined ? opt_httpConfig : {};
  var url = this.url_ + "/status/" + ref + ".json";
  return this.$http_.get(url, httpConfig);
};

PrintService.prototype.getReportUrl = function (ref) {
  return this.url_ + "/report/" + ref;
};

PrintService.prototype.getCapabilities = function (opt_httpConfig) {
  var httpConfig = opt_httpConfig !== undefined ? opt_httpConfig : {
    withCredentials: true
  };
  var url = this.url_ + "/capabilities.json";
  return this.$http_.get(url, httpConfig);
};

function createPrintServiceFactory($http, gettextCatalog, ngeoLayerHelper) {
  return function (url) {
    return new PrintService(url, $http, gettextCatalog, ngeoLayerHelper);
  };
}

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoPrint', [ngeo_map_LayerHelper_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);
module.service('ngeoPrintService', PrintService);
module.factory('ngeoCreatePrint', createPrintServiceFactory);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/print/Utils.js":
/*!****************************!*\
  !*** ./src/print/Utils.js ***!
  \****************************/
/*! exports provided: PrintUtils, INCHES_PER_METER, DOTS_PER_INCH, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PrintUtils", function() { return PrintUtils; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "INCHES_PER_METER", function() { return INCHES_PER_METER; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DOTS_PER_INCH", function() { return DOTS_PER_INCH; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);

function PrintUtils() {
  this.extentHalfHorizontalDistance_ = -1;
  this.extentHalfVerticalDistance_ = -1;
}
var INCHES_PER_METER = 39.37;
var DOTS_PER_INCH = 72;

PrintUtils.prototype.getOptimalScale = function (mapSize, mapResolution, printMapSize, printMapScales) {
  var mapWidth = mapSize[0] * mapResolution;
  var mapHeight = mapSize[1] * mapResolution;
  var scaleWidth = mapWidth * INCHES_PER_METER * DOTS_PER_INCH / printMapSize[0];
  var scaleHeight = mapHeight * INCHES_PER_METER * DOTS_PER_INCH / printMapSize[1];
  var scale = Math.min(scaleWidth, scaleHeight);
  var optimal = -1;

  for (var i = 0, ii = printMapScales.length; i < ii; ++i) {
    if (scale > printMapScales[i]) {
      optimal = printMapScales[i];
    }
  }

  return optimal;
};

PrintUtils.prototype.getOptimalResolution = function (mapSize, printMapSize, printMapScale) {
  var dotsPerMeter = DOTS_PER_INCH * INCHES_PER_METER;
  var resolutionX = printMapSize[0] * printMapScale / (dotsPerMeter * mapSize[0]);
  var resolutionY = printMapSize[1] * printMapScale / (dotsPerMeter * mapSize[1]);
  var optimalResolution = Math.max(resolutionX, resolutionY);
  return optimalResolution;
};

PrintUtils.prototype.getBottomLeftCorner = function (mapCenter) {
  return [mapCenter[0] - this.extentHalfHorizontalDistance_, mapCenter[1] - this.extentHalfVerticalDistance_];
};

PrintUtils.prototype.getBottomRightCorner = function (mapCenter) {
  return [mapCenter[0] + this.extentHalfHorizontalDistance_, mapCenter[1] - this.extentHalfVerticalDistance_];
};

PrintUtils.prototype.getUpLeftCorner = function (mapCenter) {
  return [mapCenter[0] - this.extentHalfHorizontalDistance_, mapCenter[1] + this.extentHalfVerticalDistance_];
};

PrintUtils.prototype.getUpRightCorner = function (mapCenter) {
  return [mapCenter[0] + this.extentHalfHorizontalDistance_, mapCenter[1] + this.extentHalfVerticalDistance_];
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoPrintUtils', []);
module.service('ngeoPrintUtils', PrintUtils);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/print/VectorEncoder.js":
/*!************************************!*\
  !*** ./src/print/VectorEncoder.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
/* harmony import */ var ol_util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/util.js */ "./node_modules/ol/util.js");
/* harmony import */ var ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/format/GeoJSON.js */ "./node_modules/ol/format/GeoJSON.js");
/* harmony import */ var ol_style_RegularShape_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/style/RegularShape.js */ "./node_modules/ol/style/RegularShape.js");
/* harmony import */ var ol_math_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/math.js */ "./node_modules/ol/math.js");
/* harmony import */ var ol_style_Icon_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/style/Icon.js */ "./node_modules/ol/style/Icon.js");
/* harmony import */ var ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/style/Circle.js */ "./node_modules/ol/style/Circle.js");
/* harmony import */ var ol_color_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/color.js */ "./node_modules/ol/color.js");









function VectorEncoder() {
  this.geojsonFormat = new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_2__["default"]();
}

var PrintStyleType = {
  LINE_STRING: 'LineString',
  POINT: 'Point',
  POLYGON: 'Polygon'
};
var PRINT_STYLE_TYPES = {
  'LineString': PrintStyleType.LINE_STRING,
  'Point': PrintStyleType.POINT,
  'Polygon': PrintStyleType.POLYGON,
  'MultiLineString': PrintStyleType.LINE_STRING,
  'MultiPoint': PrintStyleType.POINT,
  'MultiPolygon': PrintStyleType.POLYGON
};

VectorEncoder.prototype.encodeVectorLayer = function (arr, layer, resolution) {
  var source = layer.getSource();
  var features = source.getFeatures();
  var geojsonFeatures = [];
  var mapfishStyleObject = {
    version: 2
  };

  for (var i = 0, ii = features.length; i < ii; ++i) {
    var originalFeature = features[i];
    var styleData = null;
    var styleFunction = originalFeature.getStyleFunction() || layer.getStyleFunction();

    if (styleFunction !== undefined) {
      styleData = styleFunction.call(layer, originalFeature, resolution);
    }

    var origGeojsonFeature = this.geojsonFormat.writeFeatureObject(originalFeature);
    var styles = Array.isArray(styleData) ? styleData : styleData === null ? null : [styleData];

    if (styles !== null && styles.length > 0) {
      var isOriginalFeatureAdded = false;

      for (var j = 0, jj = styles.length; j < jj; ++j) {
        var style = styles[j];
        var geometry = style.getGeometry();
        var geojsonFeature = void 0;

        if (!geometry) {
          geojsonFeature = origGeojsonFeature;
          geometry = originalFeature.getGeometry();

          if (!geometry) {
            continue;
          }

          if (!isOriginalFeatureAdded) {
            geojsonFeatures.push(geojsonFeature);
            isOriginalFeatureAdded = true;
          }
        } else {
          var styledFeature = originalFeature.clone();
          styledFeature.setGeometry(geometry);
          geojsonFeature = this.geojsonFormat.writeFeatureObject(styledFeature);
          geometry = styledFeature.getGeometry();
          geojsonFeatures.push(geojsonFeature);
        }

        var geometryType = geometry.getType();

        if (geojsonFeature.properties === null) {
          geojsonFeature.properties = {};
        }

        var featureStyleProp = "_ngeo_style_" + j;
        var styleId = Object(ol_util_js__WEBPACK_IMPORTED_MODULE_1__["getUid"])(style).toString() + "-" + geometryType;
        this.encodeVectorStyle(mapfishStyleObject, geometryType, style, styleId, featureStyleProp);
        geojsonFeature.properties[featureStyleProp] = styleId;
      }
    }
  }

  if (geojsonFeatures.length > 0) {
    var geojsonFeatureCollection = {
      type: 'FeatureCollection',
      features: geojsonFeatures
    };
    var object = {
      geoJson: geojsonFeatureCollection,
      opacity: layer.getOpacity(),
      style: mapfishStyleObject,
      type: 'geojson'
    };
    arr.push(object);
  }
};

VectorEncoder.prototype.encodeVectorStyle = function (object, geometryType, style, styleId, featureStyleProp) {
  if (!(geometryType in PRINT_STYLE_TYPES)) {
    return;
  }

  var styleType = PRINT_STYLE_TYPES[geometryType];
  var key = "[" + featureStyleProp + " = '" + styleId + "']";

  if (key in object) {
    return;
  }

  var styleObject = {
    symbolizers: []
  };
  object[key] = styleObject;
  var fillStyle = style.getFill();
  var imageStyle = style.getImage();
  var strokeStyle = style.getStroke();
  var textStyle = style.getText();

  if (styleType === PrintStyleType.POLYGON) {
    if (fillStyle !== null) {
      this.encodeVectorStylePolygon(styleObject.symbolizers, fillStyle, strokeStyle);
    }
  } else if (styleType === PrintStyleType.LINE_STRING) {
    if (strokeStyle !== null) {
      this.encodeVectorStyleLine(styleObject.symbolizers, strokeStyle);
    }
  } else if (styleType === PrintStyleType.POINT) {
    if (imageStyle !== null) {
      this.encodeVectorStylePoint(styleObject.symbolizers, imageStyle);
    }
  }

  if (textStyle !== null) {
    this.encodeTextStyle(styleObject.symbolizers, textStyle);
  }
};

VectorEncoder.prototype.encodeVectorStyleFill = function (symbolizer, fillStyle) {
  var fillColor = fillStyle.getColor();

  if (fillColor !== null) {
    console.assert(typeof fillColor === 'string' || Array.isArray(fillColor));
    fillColor = Object(ol_color_js__WEBPACK_IMPORTED_MODULE_7__["asArray"])(fillColor);
    console.assert(Array.isArray(fillColor), 'only supporting fill colors');
    symbolizer.fillColor = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_0__["rgbArrayToHex"])(fillColor);
    symbolizer.fillOpacity = fillColor[3];
  }
};

VectorEncoder.prototype.encodeVectorStyleLine = function (symbolizers, strokeStyle) {
  var symbolizer = {
    type: 'line'
  };
  this.encodeVectorStyleStroke(symbolizer, strokeStyle);
  symbolizers.push(symbolizer);
};

VectorEncoder.prototype.encodeVectorStylePoint = function (symbolizers, imageStyle) {
  var symbolizer;

  if (imageStyle instanceof ol_style_Circle_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
    symbolizer = {
      type: 'point'
    };
    symbolizer.pointRadius = imageStyle.getRadius();
    var fillStyle = imageStyle.getFill();

    if (fillStyle !== null) {
      this.encodeVectorStyleFill(symbolizer, fillStyle);
    }

    var strokeStyle = imageStyle.getStroke();

    if (strokeStyle !== null) {
      this.encodeVectorStyleStroke(symbolizer, strokeStyle);
    }
  } else if (imageStyle instanceof ol_style_Icon_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
    var imgSrc = imageStyle.getSrc();

    if (!imgSrc) {
      throw new Error('Missing imgSrc');
    }

    var src = new URL(imgSrc, window.location.href).href;

    if (src !== undefined) {
      symbolizer = {
        type: 'point',
        externalGraphic: src
      };
      var opacity = imageStyle.getOpacity();

      if (opacity !== null) {
        symbolizer.graphicOpacity = opacity;
      }

      var size = imageStyle.getSize();

      if (size !== null) {
        var scale = imageStyle.getScale();

        if (isNaN(scale)) {
          scale = 1;
        }

        symbolizer.graphicWidth = size[0] * scale;
        symbolizer.graphicHeight = size[1] * scale;
      }

      var rotation = imageStyle.getRotation();

      if (isNaN(rotation)) {
        rotation = 0;
      }

      symbolizer.rotation = Object(ol_math_js__WEBPACK_IMPORTED_MODULE_4__["toDegrees"])(rotation);
    }
  } else if (imageStyle instanceof ol_style_RegularShape_js__WEBPACK_IMPORTED_MODULE_3__["default"]) {
    var points = imageStyle.getPoints();

    if (points !== null) {
      symbolizer = {
        type: 'point'
      };

      if (points === 4) {
        symbolizer.graphicName = 'square';
      } else if (points === 3) {
        symbolizer.graphicName = 'triangle';
      } else if (points === 5) {
        symbolizer.graphicName = 'star';
      } else if (points === 8) {
        symbolizer.graphicName = 'cross';
      }

      var sizeShape = imageStyle.getSize();

      if (sizeShape !== null) {
        symbolizer.graphicWidth = sizeShape[0];
        symbolizer.graphicHeight = sizeShape[1];
      }

      var rotationShape = imageStyle.getRotation();

      if (!isNaN(rotationShape) && rotationShape !== 0) {
        symbolizer.rotation = Object(ol_math_js__WEBPACK_IMPORTED_MODULE_4__["toDegrees"])(rotationShape);
      }

      var opacityShape = imageStyle.getOpacity();

      if (opacityShape !== null) {
        symbolizer.graphicOpacity = opacityShape;
      }

      var strokeShape = imageStyle.getStroke();

      if (strokeShape !== null) {
        this.encodeVectorStyleStroke(symbolizer, strokeShape);
      }

      var fillShape = imageStyle.getFill();

      if (fillShape !== null) {
        this.encodeVectorStyleFill(symbolizer, fillShape);
      }
    }
  }

  if (symbolizer !== undefined) {
    symbolizers.push(symbolizer);
  }
};

VectorEncoder.prototype.encodeVectorStylePolygon = function (symbolizers, fillStyle, strokeStyle) {
  var symbolizer = {
    type: 'polygon'
  };
  this.encodeVectorStyleFill(symbolizer, fillStyle);

  if (strokeStyle !== null) {
    this.encodeVectorStyleStroke(symbolizer, strokeStyle);
  }

  symbolizers.push(symbolizer);
};

VectorEncoder.prototype.encodeVectorStyleStroke = function (symbolizer, strokeStyle) {
  var strokeColor = strokeStyle.getColor();

  if (strokeColor !== null) {
    if (!(typeof strokeColor === 'string' || Array.isArray(strokeColor))) {
      throw new Error('Wrong strokeColor type');
    }

    var strokeColorRgba = Object(ol_color_js__WEBPACK_IMPORTED_MODULE_7__["asArray"])(strokeColor);

    if (!Array.isArray(strokeColorRgba)) {
      throw new Error('parsed StrokeColor is not an array');
    }

    symbolizer.strokeColor = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_0__["rgbArrayToHex"])(strokeColorRgba);
    symbolizer.strokeOpacity = strokeColorRgba[3];
  }

  var strokeDashstyle = strokeStyle.getLineDash();

  if (strokeDashstyle !== null) {
    symbolizer.strokeDashstyle = strokeDashstyle.join(' ');
  }

  var strokeWidth = strokeStyle.getWidth();

  if (strokeWidth !== undefined) {
    symbolizer.strokeWidth = strokeWidth;
  }

  var strokeLineCap = strokeStyle.getLineCap();

  if (strokeLineCap) {
    symbolizer.strokeLinecap = strokeLineCap;
  }
};

VectorEncoder.prototype.encodeTextStyle = function (symbolizers, textStyle) {
  var symbolizer = {
    type: 'Text'
  };
  var label = textStyle.getText();

  if (label !== undefined) {
    symbolizer.label = label;
    var xAlign = 'c';
    var yAlign = 'm';
    var olTextAlign = textStyle.getTextAlign();

    if (olTextAlign === 'left' || olTextAlign === 'start') {
      xAlign = 'l';
    } else if (olTextAlign === 'right' || olTextAlign === 'end') {
      xAlign = 'r';
    }

    var olTextBaseline = textStyle.getTextBaseline();

    if (olTextBaseline === 'bottom') {
      yAlign = 'l';
    } else if (olTextBaseline === 'top') {
      yAlign = 't';
    }

    symbolizer.labelAlign = "" + xAlign + yAlign;
    var labelRotation = textStyle.getRotation();

    if (labelRotation !== undefined) {
      symbolizer.labelRotation = (labelRotation * 180 / Math.PI).toString();
      symbolizer.labelAlign = 'cm';
    }

    var fontStyle = textStyle.getFont();

    if (fontStyle !== undefined) {
      var font = fontStyle.split(' ');

      if (font.length >= 3) {
        symbolizer.fontWeight = font[0];
        symbolizer.fontSize = font[1];
        symbolizer.fontFamily = font.splice(2).join(' ');
      }
    }

    var strokeStyle = textStyle.getStroke();

    if (strokeStyle !== null) {
      var strokeColor = strokeStyle.getColor();

      if (!(typeof strokeColor === 'string' || Array.isArray(strokeColor))) {
        throw new Error('Wrong strokeColor type');
      }

      var strokeColorRgba = Object(ol_color_js__WEBPACK_IMPORTED_MODULE_7__["asArray"])(strokeColor);

      if (!Array.isArray(strokeColor)) {
        throw new Error('Wrong strokeColor type');
      }

      symbolizer.haloColor = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_0__["rgbArrayToHex"])(strokeColorRgba);
      symbolizer.haloOpacity = strokeColorRgba[3];
      var width = strokeStyle.getWidth();

      if (width !== undefined) {
        symbolizer.haloRadius = width / 2;
      }
    }

    var fillStyle = textStyle.getFill();

    if (fillStyle !== null) {
      var fillColor = fillStyle.getColor();

      if (!(typeof fillColor === 'string' || Array.isArray(fillColor))) {
        throw new Error('Wrong fillColor type');
      }

      var fillColorRgba = Object(ol_color_js__WEBPACK_IMPORTED_MODULE_7__["asArray"])(fillColor);

      if (!Array.isArray(fillColor)) {
        throw new Error('Wrong fillColor type');
      }

      symbolizer.fontColor = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_0__["rgbArrayToHex"])(fillColorRgba);
    }

    if (symbolizer.labelAlign !== undefined) {
      symbolizer.labelXOffset = textStyle.getOffsetX();
      symbolizer.labelYOffset = -textStyle.getOffsetY();
    }

    symbolizers.push(symbolizer);
  }
};

/* harmony default export */ __webpack_exports__["default"] = (VectorEncoder);

/***/ }),

/***/ "./src/profile/d3Elevation.js":
/*!************************************!*\
  !*** ./src/profile/d3Elevation.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var d3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! d3 */ "./node_modules/d3/index.js");


function d3Elevation(options) {
  var light = options.light !== undefined ? options.light : false;
  var margin = light ? {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  } : {
    top: 10,
    right: 20,
    bottom: 30,
    left: 40
  };
  var hoverCallback = options.hoverCallback !== undefined ? options.hoverCallback : function () {};
  var outCallback = options.outCallback !== undefined ? options.outCallback : function () {};
  var distanceExtractor = options.distanceExtractor;
  var linesConfiguration = options.linesConfiguration;
  var numberOfLines = Object.keys(linesConfiguration).length;
  var bisectDistance = Object(d3__WEBPACK_IMPORTED_MODULE_0__["bisector"])(function (d) {
    return distanceExtractor(d);
  }).left;
  var poiExtractor = options.poiExtractor;
  var styleDefs = options.styleDefs;
  var poiLabelAngle = options.poiLabelAngle !== undefined ? options.poiLabelAngle : -60;
  var i18n = options.i18n || {};
  var xAxisLabel = i18n.xAxis || 'Distance';
  var yAxisLabel = i18n.yAxis || 'Elevation';
  var formatter = {
    xhover: function xhover(dist, units) {
      return parseFloat(dist.toPrecision(3)) + " " + units;
    },
    yhover: function yhover(ele, units) {
      return ele !== null ? Math.round(ele) + " m" : '';
    },
    xtick: function xtick(dist, units) {
      return dist;
    },
    ytick: function ytick(ele, units) {
      return ele;
    }
  };

  if (options.formatter !== undefined) {
    Object.assign(formatter, options.formatter);
  }

  var lightXAxis = options.lightXAxis !== undefined ? options.lightXAxis : false;
  var svg;
  var x;
  var y;
  var scaleModifier = options.scaleModifier;
  var g;
  var height;
  var width;
  var xFactor;
  var xUnits;
  var xDomain;

  var profile = function profile(selection) {
    var func = function func(data) {
      Object(d3__WEBPACK_IMPORTED_MODULE_0__["select"])(this).selectAll('svg').remove();

      if (data === undefined) {
        return;
      }

      width = Math.max(this.clientWidth - margin.right - margin.left, 0);
      x = Object(d3__WEBPACK_IMPORTED_MODULE_0__["scaleLinear"])().range([0, width]);
      height = Math.max(this.clientHeight - margin.top - margin.bottom, 0);
      y = Object(d3__WEBPACK_IMPORTED_MODULE_0__["scaleLinear"])().range([height, 0]);
      var xAxis = Object(d3__WEBPACK_IMPORTED_MODULE_0__["axisBottom"])(x);
      var yAxis = Object(d3__WEBPACK_IMPORTED_MODULE_0__["axisLeft"])(y);
      var area = null;

      if (numberOfLines === 1) {
        area = Object(d3__WEBPACK_IMPORTED_MODULE_0__["area"])().x(function (d) {
          return x(distanceExtractor(d));
        }).y0(height).y1(function (d) {
          var firstLineName = Object.keys(linesConfiguration)[0];
          return y(linesConfiguration[firstLineName].zExtractor(d));
        });
      }

      svg = Object(d3__WEBPACK_IMPORTED_MODULE_0__["select"])(this).selectAll('svg').data([data]);
      var svgEnter = svg.enter().append('svg');
      svg = Object(d3__WEBPACK_IMPORTED_MODULE_0__["select"])(this).selectAll('svg').data([data]);

      if (styleDefs !== undefined) {
        svgEnter.append('defs').append('style').attr('type', 'text/css').text(styleDefs);
      }

      var gEnter = svgEnter.append('g');
      clearPois();
      gEnter.style('font', '11px Arial');

      if (numberOfLines === 1) {
        gEnter.append('path').attr('class', 'area').style('fill', 'rgba(222, 222, 222, 0.5)');
      }

      gEnter.insert('g', ':first-child').attr('class', 'grid-y');

      if (!light) {
        gEnter.append('g').attr('class', 'x axis').attr('transform', "translate(0," + height + ")");
        gEnter.append('text').attr('class', 'x label').attr('text-anchor', 'end').attr('x', width - 4).attr('y', height - 4);
        gEnter.append('g').attr('class', 'y axis');
        gEnter.append('text').attr('class', 'y label').attr('text-anchor', 'end').attr('y', 6).attr('dy', '.75em').attr('transform', 'rotate(-90)').style('fill', 'grey').text(yAxisLabel + " [m]");
        gEnter.append('g').attr('class', 'metas').attr('transform', "translate(" + (width + 3) + ", 0)");
      }

      gEnter.append('g').attr('class', 'pois');
      var xHover = gEnter.append('g').attr('class', 'x grid-hover');
      xHover.append('svg:line').attr('stroke-dasharray', '5,5');
      xHover.append('text');
      gEnter.append('rect').attr('class', 'overlay').attr('width', width).attr('height', height).style('fill', 'none').style('pointer-events', 'all');
      svg.attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom);
      g = svg.select('g').attr('transform', "translate(" + margin.left + "," + margin.top + ")");
      xDomain = Object(d3__WEBPACK_IMPORTED_MODULE_0__["extent"])(data, function (d) {
        return distanceExtractor(d);
      });
      x.domain(xDomain);

      var yDomain = function () {
        var elevationsValues = [];

        var _loop = function _loop(name) {
          var extent = Object(d3__WEBPACK_IMPORTED_MODULE_0__["extent"])(data, function (d) {
            return linesConfiguration[name].zExtractor(d);
          });

          if (extent.every(Number.isFinite)) {
            elevationsValues = elevationsValues.concat(extent);
          }
        };

        for (var name in linesConfiguration) {
          _loop(name);
        }

        return [Math.min.apply(Math, elevationsValues), Math.max.apply(Math, elevationsValues)];
      }();

      y.domain(yDomain);

      if (scaleModifier !== undefined) {
        scaleModifier(x, y, width, height);
      } else {
        var padding = (yDomain[1] - yDomain[0]) * 0.1;
        y.domain([yDomain[0] - padding, yDomain[1] + padding]);
      }

      if (numberOfLines === 1) {
        if (!area) {
          throw new Error('Missing area');
        }

        g.select('.area').transition().attr('d', area);
      }

      var line, yHover;

      var _loop2 = function _loop2(name) {
        gEnter.append('path').attr('class', "line " + name).style('stroke', linesConfiguration[name].color || '#F00').style('fill', 'none');
        yHover = gEnter.append('g').attr('class', "y grid-hover " + name);
        yHover.append('svg:line').attr('stroke-dasharray', '5,5');
        yHover.append('text');
        line = Object(d3__WEBPACK_IMPORTED_MODULE_0__["line"])().x(function (d) {
          return x(distanceExtractor(d));
        }).y(function (d) {
          return y(linesConfiguration[name].zExtractor(d));
        }).defined(function (d) {
          return linesConfiguration[name].zExtractor(d) !== null;
        });
        g.select(".line." + name).transition().attr('d', line);
      };

      for (var name in linesConfiguration) {
        _loop2(name);
      }

      xFactor = xDomain[1] > 2000 ? 1000 : 1;
      xUnits = xDomain[1] > 2000 ? 'km' : 'm';

      if (!light) {
        xAxis.tickFormat(function (domainValue) {
          return formatter.xtick(domainValue / xFactor, xUnits);
        });

        if (lightXAxis) {
          xAxis.tickValues([0, x.domain()[1]]);
        }

        yAxis.tickFormat(function (dommainValue) {
          return formatter.ytick(dommainValue, 'm');
        });
        g.select('.x.axis').transition().call(xAxis);
        g.select('.x.label').text(xAxisLabel + " [" + xUnits + "]").style('fill', 'grey').style('shape-rendering', 'crispEdges');

        if (height / 15 < 10) {
          yAxis.ticks(height / 15);
        }

        g.select('.y.axis').transition().call(yAxis);
      }

      g.select('.grid-y').transition().call(yAxis.tickSize(-width).tickFormat(null)).selectAll('.tick line').style('stroke', '#ccc').style('opacity', 0.7);
      g.select('.grid-y').selectAll('.tick text').remove();
      g.selectAll('.axis').selectAll('path, line').style('fill', 'none').style('stroke', '#000').style('shape-rendering', 'crispEdges');
      g.select('.grid-y').select('path').style('stroke', 'none');
      g.selectAll('.grid-hover line').style('stroke', '#222').style('opacity', 0.8);
      g.select('.overlay').on('mouseout', mouseout).on('mousemove', mousemove);

      function mousemove() {
        var mouseX = Object(d3__WEBPACK_IMPORTED_MODULE_0__["mouse"])(this)[0];
        var x0 = x.invert(mouseX);
        profile.highlight(x0);
      }

      function mouseout() {
        profile.clearHighlight();
      }
    };

    selection.each(func);
  };

  profile.clearHighlight = function () {
    g.selectAll('.grid-hover').style('display', 'none');
    outCallback.call(null);
  };

  profile.highlight = function (distance) {
    var data = svg.datum();
    var i = bisectDistance(data, distance);

    if (i >= data.length) {
      return;
    }

    var point = data[i];
    var dist = distanceExtractor(point);
    var elevation;
    var elevations = [];
    var elevationsRef = {};
    var lineName;

    for (lineName in linesConfiguration) {
      elevation = linesConfiguration[lineName].zExtractor(point);

      if (Number.isFinite(elevation)) {
        elevations.push(elevation);
        elevationsRef[lineName] = elevation;
        g.select(".y.grid-hover." + lineName).style('display', 'inline').select('line').attr('x1', x(0)).attr('y1', y(elevation)).attr('x2', width).attr('y2', y(elevation));
      } else {
        g.select(".y.grid-hover." + lineName).style('display', 'none');
      }
    }

    var y2 = y(Math.max.apply(null, elevations));
    g.select('.x.grid-hover').style('display', 'inline').select('line').attr('x1', x(dist)).attr('y1', height).attr('x2', x(dist)).attr('y2', Number.isFinite(y2) ? y2 : 0);
    var right = dist > xDomain[1] / 2;
    var xtranslate = x(dist);
    xtranslate += right ? -10 : 10;
    g.select('.x.grid-hover text').text(formatter.xhover(dist / xFactor, xUnits)).style('text-anchor', right ? 'end' : 'start').attr('transform', "translate(" + xtranslate + "," + (height - 10) + ")");

    if (numberOfLines === 1) {
      var hasValue = Number.isFinite(elevations[0]);
      g.select('.y.grid-hover text').text(hasValue ? formatter.yhover(elevations[0], 'm') : 'no value').style('text-anchor', right ? 'end' : 'start').attr('transform', "translate(" + xtranslate + "," + (hasValue ? y(elevations[0]) - 10 : 0) + ")");
    }

    hoverCallback.call(null, point, dist / xFactor, xUnits, elevationsRef, 'm');
  };

  profile.showPois = function (pois) {
    if (!svg) {
      return;
    }

    pois = pois !== undefined ? pois : [];
    console.assert(pois.length === 0 || poiExtractor !== undefined);
    var pe = poiExtractor;
    var g = svg.select('g');
    var profileData = svg.datum();
    var ps = g.select('.pois');
    var p = ps.selectAll('.poi').data(pois, function (d) {
      var i = bisectDistance(profileData, Math.round(pe.dist(d) * 10) / 10, 1);
      var point = profileData[i];

      if (point) {
        var lineName;
        var elevations = [];

        for (lineName in linesConfiguration) {
          elevations.push(linesConfiguration[lineName].zExtractor(point));
        }

        var z = Math.max.apply(null, elevations);
        pe.z(d, z);
      }

      return pe.id(d);
    });
    var poiEnterG = p.enter().append('g').attr('class', 'poi');
    poiEnterG.append('text').attr('x', light ? 0 : 9).attr('dy', '.35em').attr('text-anchor', light ? 'middle' : 'start');
    poiEnterG.append('line').style('shape-rendering', 'crispEdges');
    poiEnterG.style('opacity', 0).transition().duration(1000).delay(100).style('opacity', 1);
    poiEnterG.selectAll('text').attr('transform', function (d) {
      if (light) {
        return ["translate(" + x(pe.dist(d)) + "," + (y(pe.z(d)) - 10) + ")"];
      } else {
        return ["translate(" + x(pe.dist(d)) + "," + (y(pe.z(d)) - 20) + ") rotate(" + poiLabelAngle + ")"];
      }
    }).text(function (d) {
      return "" + pe.sort(d) + (light ? '' : " - " + pe.title(d));
    });
    poiEnterG.selectAll('line').style('stroke', 'grey').attr('x1', function (d) {
      return x(pe.dist(d));
    }).attr('y1', function (d) {
      return y(y.domain()[0]);
    }).attr('x2', function (d) {
      return x(pe.dist(d));
    }).attr('y2', function (d) {
      return y(pe.z(d));
    });
    poiEnterG.exit().remove();
  };

  function clearPois() {
    profile.showPois([]);
  }

  return profile;
}

/* harmony default export */ __webpack_exports__["default"] = (d3Elevation);

/***/ }),

/***/ "./src/profile/elevationComponent.js":
/*!*******************************************!*\
  !*** ./src/profile/elevationComponent.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/misc/debounce.js */ "./src/misc/debounce.js");
/* harmony import */ var ngeo_profile_d3Elevation_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/profile/d3Elevation.js */ "./src/profile/d3Elevation.js");
/* harmony import */ var d3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! d3 */ "./node_modules/d3/index.js");
profileElevationComponent.$inject = ["ngeoDebounce"];





var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoProfile', [ngeo_misc_debounce_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]);

function profileElevationComponent(ngeoDebounce) {
  return {
    restrict: 'A',
    link: function link(scope, element, attrs) {
      var optionsAttr = attrs.ngeoProfileOptions;
      console.assert(optionsAttr !== undefined);
      var selection = Object(d3__WEBPACK_IMPORTED_MODULE_4__["select"])(element[0]);
      var profile = undefined;
      scope.$watchCollection(optionsAttr, function (newVal) {
        var options = Object.assign({}, newVal);

        if (options !== undefined) {
          if (options.hoverCallback !== undefined) {
            var origHoverCallback = options.hoverCallback;

            options.hoverCallback = function () {
              origHoverCallback.apply(void 0, arguments);
              scope.$applyAsync();
            };
          }

          if (options.outCallback !== undefined) {
            var origOutCallback = options.outCallback;

            options.outCallback = function () {
              origOutCallback();
              scope.$applyAsync();
            };
          }

          profile = Object(ngeo_profile_d3Elevation_js__WEBPACK_IMPORTED_MODULE_3__["default"])(options);
          refreshData();
        }
      });
      var elevationData = undefined;
      scope.$watch(attrs.ngeoProfile, function (newVal, oldVal) {
        elevationData = newVal;
        refreshData();
      });
      var poiData = undefined;
      scope.$watch(attrs.ngeoProfilePois, function (newVal, oldVal) {
        poiData = newVal;
        refreshData();
      });
      scope.$watch(attrs.ngeoProfileHighlight, function (newVal, oldVal) {
        if (newVal === undefined) {
          return;
        }

        if (newVal > 0) {
          profile.highlight(newVal);
        } else {
          profile.clearHighlight();
        }
      });
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_1__["listen"])(window, 'resize', ngeoDebounce(refreshData, 50, true));

      function refreshData(evt) {
        if (profile !== undefined) {
          selection.datum(elevationData).call(profile);

          if (elevationData !== undefined) {
            profile.showPois(poiData);
          }
        }
      }
    }
  };
}

module.directive('ngeoProfile', profileElevationComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/query/Action.js":
/*!*****************************!*\
  !*** ./src/query/Action.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ({
  ADD: 'add',
  REMOVE: 'remove',
  REPLACE: 'replace'
});

/***/ }),

/***/ "./src/query/MapQuerent.js":
/*!*********************************!*\
  !*** ./src/query/MapQuerent.js ***!
  \*********************************/
/*! exports provided: MapQuerent, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MapQuerent", function() { return MapQuerent; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
/* harmony import */ var ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/query/Action.js */ "./src/query/Action.js");
/* harmony import */ var ngeo_query_Querent_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/query/Querent.js */ "./src/query/Querent.js");
/* harmony import */ var ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/datasource/DataSources.js */ "./src/datasource/DataSources.js");
/* harmony import */ var ngeo_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ngeo/datasource/Helper.js */ "./src/datasource/Helper.js");
/* harmony import */ var ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/misc/FeatureHelper.js */ "./src/misc/FeatureHelper.js");







var MapQuerent = function () {
  MapQuerent.$inject = ["$injector", "ngeoDataSources", "ngeoDataSourcesHelper", "ngeoFeatureHelper", "ngeoQuerent", "ngeoQueryResult"];

  function MapQuerent($injector, ngeoDataSources, ngeoDataSourcesHelper, ngeoFeatureHelper, ngeoQuerent, ngeoQueryResult) {
    var options = $injector.has('ngeoQueryOptions') ? $injector.get('ngeoQueryOptions') : {};
    this.dataSources_ = ngeoDataSources.collection;
    this.featureHelper_ = ngeoFeatureHelper;
    this.ngeoDataSourcesHelper_ = ngeoDataSourcesHelper;
    this.ngeoQuerent_ = ngeoQuerent;
    this.result_ = ngeoQueryResult;
    this.limit_ = options.limit !== undefined ? options.limit : 50;
    this.queryCountFirst_ = options.queryCountFirst !== undefined ? options.queryCountFirst : false;
    this.tolerancePx_;

    if (Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["hasCoarsePointingDevice"])()) {
      this.tolerancePx_ = options.toleranceTouch !== undefined ? options.toleranceTouch : 10;
    } else {
      this.tolerancePx_ = options.tolerance !== undefined ? options.tolerance : 3;
    }

    this.bboxAsGETParam_ = options.bboxAsGETParam || false;
    this.dataSourceNames_ = {};
    this.cleared_ = false;
  }

  var _proto = MapQuerent.prototype;

  _proto.issue = function issue(options) {
    var action = options.action ? options.action : ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_2__["default"].REPLACE;
    this.clear(action !== ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_2__["default"].REPLACE);
    var queryableDataSources;

    if (options.dataSources === undefined && options.queryableDataSources === undefined) {
      queryableDataSources = this.ngeoQuerent_.getQueryableDataSources(this.dataSources_.getArray(), options.map);
    }

    var limit = options.limit !== undefined ? options.limit : this.limit_;
    Object.assign(options, {
      queryableDataSources: queryableDataSources,
      limit: limit,
      tolerancePx: this.tolerancePx_,
      wfsCount: this.queryCountFirst_,
      bboxAsGETParam: this.bboxAsGETParam_
    });
    this.result_.pending = true;
    return this.ngeoQuerent_.issue(options).then(this.handleResult_.bind(this, action));
  };

  _proto.clear = function clear(keep) {
    if (keep === void 0) {
      keep = false;
    }

    if (this.cleared_) {
      return;
    }

    this.result_.total = 0;

    for (var _iterator = this.result_.sources, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var source = _ref;

      if (!keep) {
        source.features.length = 0;
        delete source.totalFeatureCount;
      } else {
        this.result_.total += source.features.length;
      }

      source.pending = false;
      source.queried = false;
      source.tooManyResults = false;
    }

    if (!keep) {
      this.result_.sources.length = 0;
    }

    this.result_.pending = false;
    this.cleared_ = true;
  };

  _proto.handleResult_ = function handleResult_(action, response) {
    var _this = this;

    var total = action === ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_2__["default"].REPLACE ? 0 : this.result_.total;

    var _loop = function _loop(idStr) {
      var id = Number(idStr);

      var dataSource = _this.ngeoDataSourcesHelper_.getDataSource(id);

      if (!dataSource) {
        throw new Error('Missing dataSource');
      }

      var label = dataSource.name;
      console.assert(dataSource);
      var querentResultItem = response[id];
      var features = querentResultItem.features;
      var limit = querentResultItem.limit;
      var tooManyResults = querentResultItem.tooManyFeatures === true;
      var totalFeatureCount = querentResultItem.totalFeatureCount;
      var typeSeparatedFeatures = {};
      features.forEach(function (feature) {
        var type = feature.get('ngeo_feature_type_');

        if (!typeSeparatedFeatures[type]) {
          typeSeparatedFeatures[type] = [];
        }

        if (dataSource.attributes && dataSource.attributes.length) {
          var properties = feature.getProperties();
          var filteredProperties = {};
          dataSource.attributes.forEach(function (attribute) {
            if (attribute.alias) {
              filteredProperties[attribute.alias] = properties[attribute.name];
              feature.unset(attribute.name, true);
            } else {
              filteredProperties[attribute.name] = properties[attribute.name];
            }
          });
          feature.setProperties(filteredProperties, true);
        }

        typeSeparatedFeatures[type].push(feature);
      });

      for (var type in typeSeparatedFeatures) {
        label = type ? type : label;
        var featuresByType = typeSeparatedFeatures[type];
        var shouldPush = false;

        if (action === ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_2__["default"].REPLACE) {
          shouldPush = true;
        } else {
          var existingSource = void 0;

          for (var _iterator2 = _this.result_.sources, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
            var _ref2;

            if (_isArray2) {
              if (_i2 >= _iterator2.length) break;
              _ref2 = _iterator2[_i2++];
            } else {
              _i2 = _iterator2.next();
              if (_i2.done) break;
              _ref2 = _i2.value;
            }

            var source = _ref2;

            if (source.id === id && source.label === label) {
              existingSource = source;
              break;
            }
          }

          if (existingSource) {
            for (var _iterator3 = featuresByType, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
              var _ref3;

              if (_isArray3) {
                if (_i3 >= _iterator3.length) break;
                _ref3 = _iterator3[_i3++];
              } else {
                _i3 = _iterator3.next();
                if (_i3.done) break;
                _ref3 = _i3.value;
              }

              var newFeature = _ref3;

              var existingFeatureIndex = _this.featureHelper_.findFeatureIndexByFid(existingSource.features, "" + newFeature.getId());

              if (existingFeatureIndex === -1) {
                if (action === ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_2__["default"].ADD) {
                  existingSource.features.push(newFeature);
                  total += 1;
                }
              } else {
                if (action === ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_2__["default"].REMOVE) {
                  existingSource.features.splice(existingFeatureIndex, 1);
                  total -= 1;
                }
              }
            }
          } else {
            if (action === ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_2__["default"].ADD) {
              shouldPush = true;
            }
          }
        }

        if (shouldPush) {
          _this.result_.sources.push({
            features: featuresByType,
            id: id,
            label: label,
            limit: limit,
            pending: false,
            queried: true,
            tooManyResults: tooManyResults,
            totalFeatureCount: totalFeatureCount
          });

          total += features.length;
        }
      }
    };

    for (var idStr in response) {
      _loop(idStr);
    }

    this.result_.total = total;
    this.result_.pending = false;
    this.cleared_ = false;
  };

  return MapQuerent;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoMapQuerent', [ngeo_datasource_DataSources_js__WEBPACK_IMPORTED_MODULE_4__["default"].name, ngeo_datasource_Helper_js__WEBPACK_IMPORTED_MODULE_5__["default"].name, ngeo_query_Querent_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_misc_FeatureHelper_js__WEBPACK_IMPORTED_MODULE_6__["default"].name]);
module.service('ngeoMapQuerent', MapQuerent);
module.value('ngeoQueryResult', {
  sources: [],
  total: 0,
  pending: false
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/query/Mode.js":
/*!***************************!*\
  !*** ./src/query/Mode.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ({
  CLICK: 'click',
  DRAW_BOX: 'drawbox',
  DRAW_POLYGON: 'drawpolygon'
});

/***/ }),

/***/ "./src/query/ModeSelector.js":
/*!***********************************!*\
  !*** ./src/query/ModeSelector.js ***!
  \***********************************/
/*! exports provided: QueryModeSelector, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QueryModeSelector", function() { return QueryModeSelector; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/query/Action.js */ "./src/query/Action.js");
/* harmony import */ var ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/query/Mode.js */ "./src/query/Mode.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_has_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/has.js */ "./node_modules/ol/has.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }






var QueryModeSelector = function () {
  QueryModeSelector.$inject = ["$rootScope"];

  function QueryModeSelector($rootScope) {
    this.keyActionAdd_ = 'a';
    this.keyActionRemove_ = 'x';
    this.keysAction_ = [this.keyActionAdd_, this.keyActionRemove_];
    this.action_ = ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_1__["default"].REPLACE;
    this.previousAction_ = null;
    this.mode_ = ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__["default"].CLICK;
    this.previousMode_ = null;
    this.activeActionKey_ = null;
    this.rootScope_ = $rootScope;
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(document, 'keydown', this.handleKeyDown_, this);
    Object(ol_events_js__WEBPACK_IMPORTED_MODULE_3__["listen"])(document, 'keyup', this.handleKeyUp_, this);
  }

  var _proto = QueryModeSelector.prototype;

  _proto.handleKeyDown_ = function handleKeyDown_(evt) {
    if (!(evt instanceof KeyboardEvent)) {
      return;
    }

    var key = evt.key;

    if (this.keysAction_.includes(key) && !this.previousAction_) {
      this.previousAction_ = this.action;
      var newAction;

      switch (key) {
        case this.keyActionAdd_:
          newAction = ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_1__["default"].ADD;
          break;

        case this.keyActionRemove_:
          newAction = ngeo_query_Action_js__WEBPACK_IMPORTED_MODULE_1__["default"].REMOVE;
          break;

        default:
          break;
      }

      if (newAction) {
        this.action = newAction;
        this.activeActionKey_ = key;
        this.rootScope_.$apply();
      }
    } else if ((ol_has_js__WEBPACK_IMPORTED_MODULE_4__["MAC"] ? evt.metaKey : evt.ctrlKey) && !this.previousMode_) {
      this.previousMode_ = this.mode;
      this.mode = ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__["default"].DRAW_BOX;
      this.rootScope_.$apply();
    }
  };

  _proto.handleKeyUp_ = function handleKeyUp_(evt) {
    if (!(evt instanceof KeyboardEvent)) {
      return;
    }

    var updateScope = false;

    if (!(evt.metaKey || evt.ctrlKey) && this.previousMode_) {
      this.mode = this.previousMode_;
      this.previousMode_ = null;
      updateScope = true;
    }

    var key = evt.key;

    if (this.activeActionKey_ === key && this.previousAction_) {
      this.action = this.previousAction_;
      this.previousAction_ = null;
      this.activeActionKey_ = null;
      updateScope = true;
    }

    if (updateScope) {
      this.rootScope_.$apply();
    }
  };

  _createClass(QueryModeSelector, [{
    key: "action",
    get: function get() {
      return this.action_;
    },
    set: function set(action) {
      this.action_ = action;
    }
  }, {
    key: "mode",
    get: function get() {
      return this.mode_;
    },
    set: function set(mode) {
      this.mode_ = mode;
    }
  }]);

  return QueryModeSelector;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoQueryModeSelector', []);
module.service('ngeoQueryModeSelector', QueryModeSelector);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/query/Querent.js":
/*!******************************!*\
  !*** ./src/query/Querent.js ***!
  \******************************/
/*! exports provided: Querent, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Querent", function() { return Querent; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/datasource/OGC.js */ "./src/datasource/OGC.js");
/* harmony import */ var ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/filter/RuleHelper.js */ "./src/filter/RuleHelper.js");
/* harmony import */ var ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/misc/WMSTime.js */ "./src/misc/WMSTime.js");
/* harmony import */ var ol_format_filter_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/format/filter.js */ "./node_modules/ol/format/filter.js");
/* harmony import */ var ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/format/WFS.js */ "./node_modules/ol/format/WFS.js");
/* harmony import */ var ngeo_WFSDescribeFeatureType_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ngeo/WFSDescribeFeatureType.js */ "./src/WFSDescribeFeatureType.js");
/* harmony import */ var ol_format_WMSCapabilities_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/format/WMSCapabilities.js */ "./node_modules/ol/format/WMSCapabilities.js");
/* harmony import */ var ol_format_WMTSCapabilities_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/format/WMTSCapabilities.js */ "./node_modules/ol/format/WMTSCapabilities.js");
/* harmony import */ var ol_uri_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/uri.js */ "./node_modules/ol/uri.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ol/source/ImageWMS.js */ "./node_modules/ol/source/ImageWMS.js");












var Querent = function () {
  Querent.$inject = ["$http", "$q", "ngeoRuleHelper", "ngeoWMSTime"];

  function Querent($http, $q, ngeoRuleHelper, ngeoWMSTime) {
    this.http_ = $http;
    this.q_ = $q;
    this.ngeoRuleHelper_ = ngeoRuleHelper;
    this.ngeoWMSTime_ = ngeoWMSTime;
    this.requestCancelers_ = [];
    this.wmsGetCapabilitiesPromises_ = {};
    this.wmtsGetCapabilitiesPromises_ = {};
  }

  var _proto = Querent.prototype;

  _proto.issue = function issue(options) {
    var promises = [];
    var map = options.map;
    this.cancelStillRunningRequests_();
    var queryableDataSources;

    if (options.queryableDataSources) {
      queryableDataSources = options.queryableDataSources;
    } else {
      var dataSources = options.dataSources;
      console.assert(dataSources, 'DataSources should be set');
      queryableDataSources = this.getQueryableDataSources(dataSources, map);
    }

    var combinedWFSDataSources = this.getCombinableWFSDataSources_(queryableDataSources.wfs);
    promises.push(this.issueCombinedWFS_(combinedWFSDataSources, options));
    var coordinate = options.coordinate;

    if (coordinate) {
      var combinedWMSDataSources = this.getCombinableWMSDataSources_(queryableDataSources.wms);
      promises.push(this.issueCombinedWMS_(combinedWMSDataSources, options));
    }

    return this.q_.all(promises).then(handleCombinedQueryResult_);
  };

  _proto.getQueryableDataSources = function getQueryableDataSources(dataSources, map) {
    var queryableDataSources = {
      wfs: [],
      wms: []
    };
    var resolution = map.getView().getResolution();

    if (resolution === undefined) {
      throw new Error('Missing resolution');
    }

    for (var _iterator = dataSources, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var dataSource = _ref;

      if (!this.isDataSourceQueryable_(dataSource, resolution)) {
        continue;
      }

      if (dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"]) {
        if (dataSource.supportsWFS) {
          queryableDataSources.wfs.push(dataSource);
        } else {
          queryableDataSources.wms.push(dataSource);
        }
      }
    }

    return queryableDataSources;
  };

  _proto.wfsDescribeFeatureType = function wfsDescribeFeatureType(dataSource) {
    if (!dataSource.supportsAttributes) {
      throw "The data source must support WFS, have a single OGCLayer that\n      is queryable in order to issue WFS DescribeFeatureType requests";
    }

    if (!dataSource.wfsUrl) {
      throw new Error('Missing WFS URL');
    }

    var wfsLayerNames = dataSource.getWFSLayerNames();
    var url = Object(ol_uri_js__WEBPACK_IMPORTED_MODULE_9__["appendParams"])(dataSource.wfsUrl, {
      'REQUEST': 'DescribeFeatureType',
      'SERVICE': 'WFS',
      'VERSION': '2.0.0',
      'TYPENAME': wfsLayerNames
    });
    return this.http_.get(url).then(function (response) {
      var format = new ngeo_WFSDescribeFeatureType_js__WEBPACK_IMPORTED_MODULE_6__["default"]();
      return format.read(response.data);
    });
  };

  _proto.wmsFindLayerCapability = function wmsFindLayerCapability(layerCapabilities, layerName) {
    var found = null;

    for (var _iterator2 = layerCapabilities, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
      var _ref2;

      if (_isArray2) {
        if (_i2 >= _iterator2.length) break;
        _ref2 = _iterator2[_i2++];
      } else {
        _i2 = _iterator2.next();
        if (_i2.done) break;
        _ref2 = _i2.value;
      }

      var layerCapability = _ref2;

      if (layerCapability.Name === layerName) {
        found = layerCapability;
        break;
      } else if (layerCapability.Layer) {
        found = this.wmsFindLayerCapability(layerCapability.Layer, layerName);

        if (found) {
          break;
        }
      }
    }

    return found;
  };

  _proto.wmsGetCapabilities = function wmsGetCapabilities(baseUrl, opt_cache) {
    var cache = opt_cache !== false;
    var params = {
      'REQUEST': 'GetCapabilities',
      'SERVICE': 'WMS',
      'VERSION': '1.3.0'
    };
    var url = Object(ol_uri_js__WEBPACK_IMPORTED_MODULE_9__["appendParams"])(baseUrl, params);
    var promise;

    if (!cache || !this.wmsGetCapabilitiesPromises_[baseUrl]) {
      promise = this.http_.get(url).then(function (response) {
        var format = new ol_format_WMSCapabilities_js__WEBPACK_IMPORTED_MODULE_7__["default"]();
        return format.read(response.data);
      });
    } else if (cache && this.wmsGetCapabilitiesPromises_[baseUrl]) {
      promise = this.wmsGetCapabilitiesPromises_[baseUrl];
    }

    if (!promise) {
      throw new Error('Missing promise');
    }

    if (cache && !this.wmsGetCapabilitiesPromises_[baseUrl]) {
      this.wmsGetCapabilitiesPromises_[baseUrl] = promise;
    }

    return promise;
  };

  _proto.wmtsFindLayerCapability = function wmtsFindLayerCapability(layerCapabilities, layerName) {
    var found = null;

    for (var _iterator3 = layerCapabilities, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {
      var _ref3;

      if (_isArray3) {
        if (_i3 >= _iterator3.length) break;
        _ref3 = _iterator3[_i3++];
      } else {
        _i3 = _iterator3.next();
        if (_i3.done) break;
        _ref3 = _i3.value;
      }

      var layerCapability = _ref3;

      if (layerCapability.Identifier === layerName) {
        found = layerCapability;
        break;
      }
    }

    return found;
  };

  _proto.wmtsGetCapabilities = function wmtsGetCapabilities(url, opt_cache) {
    var cache = opt_cache !== false;
    var promise;

    if (!cache || !this.wmtsGetCapabilitiesPromises_[url]) {
      promise = this.http_.get(url).then(function (response) {
        var format = new ol_format_WMTSCapabilities_js__WEBPACK_IMPORTED_MODULE_8__["default"]();
        return format.read(response.data);
      });
    } else if (cache && this.wmtsGetCapabilitiesPromises_[url]) {
      promise = this.wmtsGetCapabilitiesPromises_[url];
    }

    if (!promise) {
      throw new Error('Missing promise');
    }

    if (cache && !this.wmtsGetCapabilitiesPromises_[url]) {
      this.wmtsGetCapabilitiesPromises_[url] = promise;
    }

    return promise;
  };

  _proto.handleQueryResult_ = function handleQueryResult_(dataSources, limit, wfs, response) {
    var hash = {};

    for (var _iterator4 = dataSources, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {
      var _ref4;

      if (_isArray4) {
        if (_i4 >= _iterator4.length) break;
        _ref4 = _iterator4[_i4++];
      } else {
        _i4 = _iterator4.next();
        if (_i4.done) break;
        _ref4 = _i4.value;
      }

      var dataSource = _ref4;
      var dataSourceId = dataSource.id;

      if (typeof response === 'number') {
        var features = [];
        var tooManyFeatures = true;
        var totalFeatureCount = response;
        this.setUniqueIds_(features, dataSource.id);
        hash[dataSourceId] = {
          features: features,
          limit: limit,
          tooManyFeatures: tooManyFeatures,
          totalFeatureCount: totalFeatureCount
        };
      } else {
        var _features = dataSource instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"] ? this.readAndTypeFeatures_(dataSource, response.data, wfs) : [];

        this.setUniqueIds_(_features, dataSource.id);
        hash[dataSourceId] = {
          features: _features,
          limit: limit
        };
      }
    }

    return hash;
  };

  _proto.readAndTypeFeatures_ = function readAndTypeFeatures_(dataSource, data, wfs) {
    var _this = this;

    var features = [];
    var readFeatures;
    var featureTypes = this.getSetOlFormatTypes_(dataSource, wfs).slice();
    featureTypes.forEach(function (type) {
      _this.getSetOlFormatTypes_(dataSource, wfs, [type]);

      if (wfs) {
        if (!dataSource.wfsFormat) {
          throw new Error('Missing wfsFormat');
        }

        readFeatures = dataSource.wfsFormat.readFeatures(data);
      } else {
        if (!dataSource.wmsFormat) {
          throw new Error('Missing wmsFormat');
        }

        readFeatures = dataSource.wmsFormat.readFeatures(data);
      }

      if (readFeatures.length > 0) {
        readFeatures.forEach(function (feature) {
          feature.set('ngeo_feature_type_', type);
          features.push(feature);
        });
      }
    });
    this.getSetOlFormatTypes_(dataSource, wfs, featureTypes);
    return features;
  };

  _proto.getSetOlFormatTypes_ = function getSetOlFormatTypes_(dataSource, wfs, opt_types) {
    var types;

    if (wfs) {
      if (!dataSource.wfsFormat) {
        throw new Error('Missing wfsFormat');
      }

      if (opt_types) {
        dataSource.wfsFormat.setFeatureType(opt_types);
      }

      types = dataSource.wfsFormat.getFeatureType();
    } else {
      if (!dataSource.wmsFormat) {
        throw new Error('Missing wmsFormat');
      }

      if (opt_types) {
        dataSource.wmsFormat.setLayers(opt_types);
      }

      types = dataSource.wmsFormat.getLayers();
    }

    if (!types) {
      return [];
    }

    return Array.isArray(types) ? types : [types];
  };

  _proto.issueCombinedWFS_ = function issueCombinedWFS_(combinedDataSources, options) {
    var _this2 = this;

    var promises = [];
    var maxFeatures = options.limit;
    var map = options.map;
    var view = map.getView();
    var resolution = view.getResolution();
    var projection = view.getProjection();
    var srsName = projection.getCode();
    var wfsCount = false;

    if (resolution === undefined) {
      throw new Error('Missing resolution');
    }

    var bbox;
    var coordinate = options.coordinate;

    if (coordinate) {
      var tolerancePx = options.tolerancePx;
      console.assert(tolerancePx);
      var tolerance = tolerancePx * resolution;
      bbox = ol_extent_js__WEBPACK_IMPORTED_MODULE_10__["buffer"](ol_extent_js__WEBPACK_IMPORTED_MODULE_10__["createOrUpdateFromCoordinate"](coordinate), tolerance);
    } else {
      bbox = options.extent;
    }

    var wfsFormat = new ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_5__["default"]();
    var xmlSerializer = new XMLSerializer();

    var _loop = function _loop() {
      if (_isArray5) {
        if (_i5 >= _iterator5.length) return "break";
        _ref5 = _iterator5[_i5++];
      } else {
        _i5 = _iterator5.next();
        if (_i5.done) return "break";
        _ref5 = _i5.value;
      }

      var dataSources = _ref5;
      var getFeatureCommonOptions = null;
      var featureTypes = [];
      var url = null;
      var params = {};

      if (options.bboxAsGETParam && bbox) {
        params.bbox = bbox.join(',');
      }

      for (var _iterator6 = dataSources, _isArray6 = Array.isArray(_iterator6), _i6 = 0, _iterator6 = _isArray6 ? _iterator6 : _iterator6[Symbol.iterator]();;) {
        var _ref6;

        if (_isArray6) {
          if (_i6 >= _iterator6.length) break;
          _ref6 = _iterator6[_i6++];
        } else {
          _i6 = _iterator6.next();
          if (_i6.done) break;
          _ref6 = _i6.value;
        }

        var dataSource = _ref6;
        var currentFeatureTypes = dataSource.getInRangeWFSLayerNames(resolution, true);

        if (!getFeatureCommonOptions) {
          var featureNS = dataSource.wfsFeatureNS;
          var featurePrefix = dataSource.wfsFeaturePrefix;
          var geometryName = dataSource.geometryName(currentFeatureTypes[0]);
          var outputFormat = dataSource.wfsOutputFormat;

          if (!geometryName) {
            throw new Error('Missing geometryName');
          }

          getFeatureCommonOptions = {
            bbox: bbox,
            featureNS: featureNS,
            featurePrefix: featurePrefix,
            geometryName: geometryName,
            outputFormat: outputFormat,
            srsName: srsName,
            featureTypes: []
          };
          url = dataSource.wfsUrl;
          Object.assign(params, dataSource.activeDimensions);
        }

        featureTypes = featureTypes.concat(currentFeatureTypes);
        var filter = null;

        if (options.filter) {
          filter = _this2.ngeoRuleHelper_.createFilter({
            dataSource: dataSource,
            filter: options.filter,
            incDimensions: true,
            incTime: true
          });
        } else if (dataSource.filterRules && dataSource.filterRules.length || dataSource.timeRangeValue || dataSource.dimensionsFiltersConfig && Object.keys(dataSource.dimensionsFiltersConfig).length > 0) {
          console.assert(dataSources.length === 1, "A data source having filterRules or timeRangeValue should issue\n            a single query, alone.");
          filter = _this2.ngeoRuleHelper_.createFilter({
            dataSource: dataSource,
            incDimensions: true,
            incTime: true,
            srsName: srsName
          });
        }

        if (options.geometry) {
          var spatialFilter = ol_format_filter_js__WEBPACK_IMPORTED_MODULE_4__["intersects"](dataSource.geometryName(), options.geometry, srsName);
          filter = _this2.ngeoRuleHelper_.joinFilters(filter, spatialFilter);
        }

        if (filter) {
          getFeatureCommonOptions.filter = filter;
        }
      }

      if (!getFeatureCommonOptions) {
        throw new Error('Missing getFeatureCommonOptions');
      }

      getFeatureCommonOptions.featureTypes = featureTypes;

      if (!url) {
        throw new Error('Missing url');
      }

      var getFeatureDefer = _this2.q_.defer();

      promises.push(getFeatureDefer.promise.then(_this2.handleQueryResult_.bind(_this2, dataSources, maxFeatures, true)));
      var countPromise = void 0;

      if (wfsCount) {
        var getCountOptions = Object.assign({
          resultType: 'hits'
        }, getFeatureCommonOptions);
        var featureCountXml = wfsFormat.writeGetFeature(getCountOptions);
        var featureCountRequest = xmlSerializer.serializeToString(featureCountXml);

        var canceler = _this2.registerCanceler_();

        countPromise = _this2.http_.post(url, featureCountRequest, {
          params: params,
          headers: {
            'Content-Type': 'text/xml; charset=UTF-8'
          },
          timeout: canceler.promise
        }).then(function (response) {
          if (!dataSources[0].wfsFormat) {
            throw new Error('Missing wfsFormat');
          }

          var meta = dataSources[0].wfsFormat.readFeatureCollectionMetadata(response.data);

          if (!meta) {
            throw new Error('Missing meta');
          }

          return meta.numberOfFeatures;
        });
      } else {
        countPromise = _this2.q_.resolve();
      }

      var afterCount_ = function afterCount_(numberOfFeatures) {
        if (numberOfFeatures === undefined || numberOfFeatures < maxFeatures) {
          var getFeatureOptions = Object.assign({
            maxFeatures: maxFeatures
          }, getFeatureCommonOptions);
          var featureRequestXml = wfsFormat.writeGetFeature(getFeatureOptions);
          var featureRequest = xmlSerializer.serializeToString(featureRequestXml);

          if (typeof url !== 'string') {
            throw new Error('Wrong URL type');
          }

          var _canceler = _this2.registerCanceler_();

          _this2.http_.post(url, featureRequest, {
            params: params,
            headers: {
              'Content-Type': 'text/xml; charset=UTF-8'
            },
            timeout: _canceler.promise
          }).then(function (response) {
            getFeatureDefer.resolve(response);
          });
        } else {
          getFeatureDefer.resolve(numberOfFeatures);
        }

        return null;
      };

      countPromise.then(afterCount_);
    };

    for (var _iterator5 = combinedDataSources, _isArray5 = Array.isArray(_iterator5), _i5 = 0, _iterator5 = _isArray5 ? _iterator5 : _iterator5[Symbol.iterator]();;) {
      var _ref5;

      var _ret = _loop();

      if (_ret === "break") break;
    }

    return this.q_.all(promises).then(handleCombinedQueryResult_);
  };

  _proto.issueCombinedWMS_ = function issueCombinedWMS_(combinedDataSources, options) {
    var promises = [];
    var FEATURE_COUNT = options.limit;
    var map = options.map;
    var view = map.getView();
    var resolution = view.getResolution();
    var projection = view.getProjection();
    var projCode = projection.getCode();

    if (resolution === undefined) {
      throw new Error('Missing resolution');
    }

    var coordinate = options.coordinate;

    if (!coordinate) {
      throw new Error('Missing coordinate');
    }

    for (var _iterator7 = combinedDataSources, _isArray7 = Array.isArray(_iterator7), _i7 = 0, _iterator7 = _isArray7 ? _iterator7 : _iterator7[Symbol.iterator]();;) {
      var _ref7;

      if (_isArray7) {
        if (_i7 >= _iterator7.length) break;
        _ref7 = _iterator7[_i7++];
      } else {
        _i7 = _iterator7.next();
        if (_i7.done) break;
        _ref7 = _i7.value;
      }

      var dataSources = _ref7;
      var url = void 0;
      var LAYERS = [];
      var INFO_FORMAT = void 0;
      var activeDimensionsSet = false;
      var params = {};
      var filterString = null;
      var filtrableLayerName = null;

      for (var _iterator8 = dataSources, _isArray8 = Array.isArray(_iterator8), _i8 = 0, _iterator8 = _isArray8 ? _iterator8 : _iterator8[Symbol.iterator]();;) {
        var _ref8;

        if (_isArray8) {
          if (_i8 >= _iterator8.length) break;
          _ref8 = _iterator8[_i8++];
        } else {
          _i8 = _iterator8.next();
          if (_i8.done) break;
          _ref8 = _i8.value;
        }

        var dataSource = _ref8;

        if (!INFO_FORMAT) {
          INFO_FORMAT = dataSource.wmsInfoFormat;
          url = dataSource.wmsUrl;
        }

        LAYERS = LAYERS.concat(dataSource.getWMSLayerNames(true));

        if (!activeDimensionsSet) {
          Object.assign(params, dataSource.activeDimensions);
          activeDimensionsSet = true;
        }

        if (dataSource.filterRules && dataSource.filterRules.length) {
          console.assert(dataSources.length === 1);
          filtrableLayerName = dataSource.getFiltrableWFSLayerName();
          filterString = this.ngeoRuleHelper_.createFilterString({
            dataSource: dataSource,
            srsName: projCode
          });
        }

        if (dataSource.timeRangeValue && dataSource.timeProperty) {
          console.assert(dataSources.length === 1);
          params.TIME = this.ngeoWMSTime_.formatWMSTimeParam(dataSource.timeProperty, dataSource.timeRangeValue);
        }
      }

      params.LAYERS = LAYERS;
      params.QUERY_LAYERS = LAYERS;

      if (filterString && filtrableLayerName) {
        var filterParamValue = null;

        if (LAYERS.length === 1) {
          filterParamValue = filterString;
        } else {
          var filterParamValues = [];

          for (var i = 0, ii = LAYERS.length; i < ii; i++) {
            if (LAYERS[i] === filtrableLayerName) {
              filterParamValues.push("(" + filterString + ")");
            } else {
              filterParamValues.push('()');
            }
          }

          filterParamValue = filterParamValues.join('');
        }

        params.FILTER = filterParamValue;
      }

      if (!url) {
        throw new Error('Missing url');
      }

      var wmsSource = new ol_source_ImageWMS_js__WEBPACK_IMPORTED_MODULE_11__["default"]({
        params: params,
        url: url,
        projection: map.getView().getProjection()
      });
      var wmsGetFeatureInfoUrl = wmsSource.getFeatureInfoUrl(coordinate, resolution, projCode, {
        'FEATURE_COUNT': FEATURE_COUNT,
        'INFO_FORMAT': INFO_FORMAT
      });

      if (!wmsGetFeatureInfoUrl) {
        throw new Error('Missing wmsGetFeatureInfoUrl');
      }

      var canceler = this.registerCanceler_();
      promises.push(this.http_.get(wmsGetFeatureInfoUrl, {
        timeout: canceler.promise
      }).then(this.handleQueryResult_.bind(this, dataSources, FEATURE_COUNT, false)));
    }

    return this.q_.all(promises).then(handleCombinedQueryResult_);
  };

  _proto.getCombinableWFSDataSources_ = function getCombinableWFSDataSources_(dataSources) {
    var combinableDataSources = [];
    var notCombinableDataSources = [];

    for (var _iterator9 = dataSources, _isArray9 = Array.isArray(_iterator9), _i9 = 0, _iterator9 = _isArray9 ? _iterator9 : _iterator9[Symbol.iterator]();;) {
      var _ref9;

      if (_isArray9) {
        if (_i9 >= _iterator9.length) break;
        _ref9 = _iterator9[_i9++];
      } else {
        _i9 = _iterator9.next();
        if (_i9.done) break;
        _ref9 = _i9.value;
      }

      var dataSource = _ref9;

      if (dataSource.combinableForWFS) {
        var combined = false;

        for (var _iterator10 = combinableDataSources, _isArray10 = Array.isArray(_iterator10), _i10 = 0, _iterator10 = _isArray10 ? _iterator10 : _iterator10[Symbol.iterator]();;) {
          var _ref10;

          if (_isArray10) {
            if (_i10 >= _iterator10.length) break;
            _ref10 = _iterator10[_i10++];
          } else {
            _i10 = _iterator10.next();
            if (_i10.done) break;
            _ref10 = _i10.value;
          }

          var combinableDataSource = _ref10;

          if (dataSource.combinableWithDataSourceForWFS(combinableDataSource[0])) {
            combinableDataSource.push(dataSource);
            combined = true;
          }
        }

        if (!combined) {
          combinableDataSources.push([dataSource]);
        }
      } else {
        notCombinableDataSources.push([dataSource]);
      }
    }

    return combinableDataSources.concat(notCombinableDataSources);
  };

  _proto.getCombinableWMSDataSources_ = function getCombinableWMSDataSources_(dataSources) {
    var combinableDataSources = [];
    var notCombinableDataSources = [];

    for (var _iterator11 = dataSources, _isArray11 = Array.isArray(_iterator11), _i11 = 0, _iterator11 = _isArray11 ? _iterator11 : _iterator11[Symbol.iterator]();;) {
      var _ref11;

      if (_isArray11) {
        if (_i11 >= _iterator11.length) break;
        _ref11 = _iterator11[_i11++];
      } else {
        _i11 = _iterator11.next();
        if (_i11.done) break;
        _ref11 = _i11.value;
      }

      var dataSource = _ref11;

      if (dataSource.combinableForWMS) {
        var combined = false;

        for (var _iterator12 = combinableDataSources, _isArray12 = Array.isArray(_iterator12), _i12 = 0, _iterator12 = _isArray12 ? _iterator12 : _iterator12[Symbol.iterator]();;) {
          var _ref12;

          if (_isArray12) {
            if (_i12 >= _iterator12.length) break;
            _ref12 = _iterator12[_i12++];
          } else {
            _i12 = _iterator12.next();
            if (_i12.done) break;
            _ref12 = _i12.value;
          }

          var combinableDataSource = _ref12;

          if (dataSource.combinableWithDataSourceForWMS(combinableDataSource[0])) {
            combinableDataSource.push(dataSource);
            combined = true;
          }
        }

        if (!combined) {
          combinableDataSources.push([dataSource]);
        }
      } else {
        notCombinableDataSources.push([dataSource]);
      }
    }

    return combinableDataSources.concat(notCombinableDataSources);
  };

  _proto.isDataSourceQueryable_ = function isDataSourceQueryable_(ds, res) {
    var queryable = ds.visible && ds.inRange && ds.queryable;

    if (queryable && ds instanceof ngeo_datasource_OGC_js__WEBPACK_IMPORTED_MODULE_1__["default"]) {
      var ogcDS = ds;
      queryable = ogcDS.isAnyOGCLayerInRange(res, true);
    }

    return queryable;
  };

  _proto.setUniqueIds_ = function setUniqueIds_(features, dataSourceId) {
    features.forEach(function (feature) {
      if (feature.getId() !== undefined) {
        var id = dataSourceId + "_" + feature.getId();
        feature.setId(id);
      }
    });
  };

  _proto.registerCanceler_ = function registerCanceler_() {
    var canceler = this.q_.defer();
    this.requestCancelers_.push(canceler);
    return canceler;
  };

  _proto.cancelStillRunningRequests_ = function cancelStillRunningRequests_() {
    for (var _iterator13 = this.requestCancelers_, _isArray13 = Array.isArray(_iterator13), _i13 = 0, _iterator13 = _isArray13 ? _iterator13 : _iterator13[Symbol.iterator]();;) {
      var _ref13;

      if (_isArray13) {
        if (_i13 >= _iterator13.length) break;
        _ref13 = _iterator13[_i13++];
      } else {
        _i13 = _iterator13.next();
        if (_i13.done) break;
        _ref13 = _i13.value;
      }

      var canceler = _ref13;
      canceler.resolve();
    }

    this.requestCancelers_.length = 0;
  };

  return Querent;
}();

function handleCombinedQueryResult_(response) {
  var combinedHash = {};

  for (var _iterator14 = response, _isArray14 = Array.isArray(_iterator14), _i14 = 0, _iterator14 = _isArray14 ? _iterator14 : _iterator14[Symbol.iterator]();;) {
    var _ref14;

    if (_isArray14) {
      if (_i14 >= _iterator14.length) break;
      _ref14 = _iterator14[_i14++];
    } else {
      _i14 = _iterator14.next();
      if (_i14.done) break;
      _ref14 = _i14.value;
    }

    var hash = _ref14;

    for (var dataSourceIdStr in hash) {
      var dataSourceId = Number(dataSourceIdStr);
      combinedHash[dataSourceId] = hash[dataSourceId];
    }
  }

  return combinedHash;
}

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoQuerent', [ngeo_filter_RuleHelper_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_misc_WMSTime_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]);
module.service('ngeoQuerent', Querent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/query/component.js":
/*!********************************!*\
  !*** ./src/query/component.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_events_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/events.js */ "./src/events.js");
/* harmony import */ var ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/query/Mode.js */ "./src/query/Mode.js");
/* harmony import */ var ngeo_query_ModeSelector_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/query/ModeSelector.js */ "./src/query/ModeSelector.js");
/* harmony import */ var ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ngeo/query/MapQuerent.js */ "./src/query/MapQuerent.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_events_condition_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/events/condition.js */ "./node_modules/ol/events/condition.js");
/* harmony import */ var ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/interaction/Draw.js */ "./node_modules/ol/interaction/Draw.js");
/* harmony import */ var ol_layer_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ol/layer.js */ "./node_modules/ol/layer.js");
/* harmony import */ var ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ol/MapBrowserEvent.js */ "./node_modules/ol/MapBrowserEvent.js");
/* harmony import */ var ol_source_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ol/source.js */ "./node_modules/ol/source.js");











var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoQuery', [ngeo_query_ModeSelector_js__WEBPACK_IMPORTED_MODULE_3__["default"].name, ngeo_query_MapQuerent_js__WEBPACK_IMPORTED_MODULE_4__["default"].name]);

var QueryController = function () {
  QueryController.$inject = ["ngeoMapQuerent", "ngeoQueryModeSelector", "$injector", "$scope"];

  function QueryController(ngeoMapQuerent, ngeoQueryModeSelector, $injector, $scope) {
    var _this = this;

    this.active;
    this.autoclear;
    this.map;
    this.ngeoMapQuerent_ = ngeoMapQuerent;
    this.ngeoQueryModeSelector_ = ngeoQueryModeSelector;
    var ngeoQueryOptions = $injector.has('ngeoQueryOptions') ? $injector.get('ngeoQueryOptions') : {};
    this.ngeoQueryOptions_ = ngeoQueryOptions;
    this.scope_ = $scope;
    this.vectorSource_ = new ol_source_js__WEBPACK_IMPORTED_MODULE_10__["Vector"]({
      wrapX: false
    });
    this.vectorLayer_ = new ol_layer_js__WEBPACK_IMPORTED_MODULE_8__["Vector"]({
      source: this.vectorSource_
    });
    this.drawBoxInteraction_ = new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
      condition: ol_events_condition_js__WEBPACK_IMPORTED_MODULE_6__["always"],
      geometryFunction: Object(ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_7__["createBox"])(),
      source: this.vectorSource_,
      type: 'Circle'
    });
    this.drawPolygonInteraction_ = new ol_interaction_Draw_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
      condition: ol_events_condition_js__WEBPACK_IMPORTED_MODULE_6__["always"],
      source: this.vectorSource_,
      type: 'Polygon'
    });
    this.listenerKeys_ = [];
    this.mode_ = null;
    $scope.$watch(function () {
      return _this.active;
    }, this.handleActiveChange_.bind(this));
    $scope.$watch(function () {
      var value = null;

      if (_this.active) {
        value = _this.ngeoQueryModeSelector_.mode;
      }

      return value;
    }, this.enableMode_.bind(this));
  }

  var _proto = QueryController.prototype;

  _proto.$onInit = function $onInit() {
    this.autoclear = !!this.autoclear;
  };

  _proto.$onDestroy = function $onDestroy() {
    this.enableMode_(null);
  };

  _proto.enableMode_ = function enableMode_(mode) {
    this.disableMode_();

    if (!mode) {
      return;
    }

    switch (mode) {
      case ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__["default"].CLICK:
        this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.map, 'singleclick', this.handleMapClick_, this));

        if (this.ngeoQueryOptions_.cursorHover) {
          this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.map, 'pointermove', this.handleMapPointerMove_, this));
        }

        break;

      case ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__["default"].DRAW_BOX:
        this.map.addLayer(this.vectorLayer_);
        this.map.addInteraction(this.drawBoxInteraction_);
        this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.drawBoxInteraction_, 'drawend', this.handleDrawBoxInteractionDrawEnd_, this));
        break;

      case ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__["default"].DRAW_POLYGON:
        this.map.addLayer(this.vectorLayer_);
        this.map.addInteraction(this.drawPolygonInteraction_);
        this.listenerKeys_.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_5__["listen"])(this.drawPolygonInteraction_, 'drawend', this.handleDrawPolygonInteractionDrawEnd_, this));
        break;

      default:
        break;
    }

    this.mode_ = mode;
  };

  _proto.disableMode_ = function disableMode_() {
    if (!this.mode_) {
      return;
    }

    switch (this.mode_) {
      case ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__["default"].CLICK:
        if (this.ngeoQueryOptions_.cursorHover) {
          this.map.getTargetElement().style.cursor = '';
        }

        break;

      case ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__["default"].DRAW_BOX:
        this.vectorSource_.clear();
        this.map.removeLayer(this.vectorLayer_);
        this.map.removeInteraction(this.drawBoxInteraction_);
        this.drawBoxInteraction_.sketchPoint_ = null;
        this.drawBoxInteraction_.overlay_.getSource().clear(true);
        break;

      case ngeo_query_Mode_js__WEBPACK_IMPORTED_MODULE_2__["default"].DRAW_POLYGON:
        this.vectorSource_.clear();
        this.map.removeLayer(this.vectorLayer_);
        this.map.removeInteraction(this.drawPolygonInteraction_);
        this.drawPolygonInteraction_.sketchPoint_ = null;
        this.drawPolygonInteraction_.overlay_.getSource().clear(true);
        break;

      default:
        break;
    }

    Object(ngeo_events_js__WEBPACK_IMPORTED_MODULE_1__["unlistenByKeys"])(this.listenerKeys_);
    this.mode_ = null;
  };

  _proto.getLimitOption_ = function getLimitOption_() {
    return this.ngeoQueryOptions_ && this.ngeoQueryOptions_.limit ? this.ngeoQueryOptions_.limit : undefined;
  };

  _proto.handleActiveChange_ = function handleActiveChange_(active) {
    if (!active) {
      if (this.autoclear) {
        this.ngeoMapQuerent_.clear();
      }
    }
  };

  _proto.handleDrawBoxInteractionDrawEnd_ = function handleDrawBoxInteractionDrawEnd_(evt) {
    var _this2 = this;

    var feature = evt.feature;
    var action = this.ngeoQueryModeSelector_.action;
    var extent = feature.getGeometry().getExtent();
    var limit = this.getLimitOption_();
    var map = this.map;
    this.ngeoMapQuerent_.issue({
      action: action,
      extent: extent,
      limit: limit,
      map: map
    }).then(function () {}).catch(function () {}).then(function () {
      _this2.vectorSource_.clear();
    });
  };

  _proto.handleDrawPolygonInteractionDrawEnd_ = function handleDrawPolygonInteractionDrawEnd_(evt) {
    var _this3 = this;

    var feature = evt.feature;
    var action = this.ngeoQueryModeSelector_.action;
    var geometry = feature.getGeometry();
    var limit = this.getLimitOption_();
    var map = this.map;
    this.ngeoMapQuerent_.issue({
      action: action,
      geometry: geometry,
      limit: limit,
      map: map
    }).then(function () {}).catch(function () {}).then(function () {
      _this3.vectorSource_.clear();
    });
  };

  _proto.handleMapClick_ = function handleMapClick_(evt) {
    if (!(evt instanceof ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_9__["default"])) {
      return;
    }

    var action = this.ngeoQueryModeSelector_.action;
    var coordinate = evt.coordinate;
    var map = this.map;
    this.ngeoMapQuerent_.issue({
      action: action,
      coordinate: coordinate,
      map: map
    });
  };

  _proto.handleMapPointerMove_ = function handleMapPointerMove_(evt) {
    if (!(evt instanceof ol_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_9__["default"]) || evt.dragging) {
      return;
    }

    var pixel = this.map.getEventPixel(evt.originalEvent);

    var queryable = function queryable(layer) {
      var visible = layer.get('visible');
      var sourceids = layer.get('querySourceIds');
      return visible && !!sourceids;
    };

    var hit = this.map.forEachLayerAtPixel(pixel, function () {
      return true;
    }, {
      layerFilter: queryable
    });
    this.map.getTargetElement().style.cursor = hit ? 'pointer' : '';
  };

  return QueryController;
}();

module.component('ngeoQuery', {
  bindings: {
    'active': '=',
    'autoclear': '=?',
    'map': '<'
  },
  controller: QueryController
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/query/panelComponent.html":
/*!***************************************!*\
  !*** ./src/query/panelComponent.html ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = function(obj) {
obj || (obj = {});
var __t, __p = '';
with (obj) {
__p += '<div\n  class="btn-group"\n>\n  <button\n    data-toggle="tooltip"\n    title="{{\'While active, click on the map to issue a query\' | translate}}"\n    class="btn btn-default"\n    ng-class="{active: $ctrl.ngeoQueryModeSelector.mode === \'click\'}"\n    ng-click="$ctrl.ngeoQueryModeSelector.mode = \'click\'"\n  >\n    ' +
((__t = (__webpack_require__(/*! ngeo/icons/point.svg?viewbox&height=1em */ "./src/icons/point.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </button>\n  <button\n    data-toggle="tooltip"\n    title="{{\'While active, click twice the map to issue a query using a box\' | translate}}"\n    class="btn btn-default"\n    ng-class="{active: $ctrl.ngeoQueryModeSelector.mode === \'drawbox\'}"\n    ng-click="$ctrl.ngeoQueryModeSelector.mode = \'drawbox\'"\n  >\n    ' +
((__t = (__webpack_require__(/*! ngeo/icons/rectangle.svg?viewbox&height=1em */ "./src/icons/rectangle.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </button>\n  <button\n    data-toggle="tooltip"\n    title="{{\'While active, click on the map multiple times to draw a polygon, which will issue a query using it\' | translate}}"\n    class="btn btn-default"\n    ng-class="{active: $ctrl.ngeoQueryModeSelector.mode === \'drawpolygon\'}"\n    ng-click="$ctrl.ngeoQueryModeSelector.mode = \'drawpolygon\'"\n  >\n    ' +
((__t = (__webpack_require__(/*! ngeo/icons/polygon.svg?viewbox&height=1em */ "./src/icons/polygon.svg?viewbox&height=1em"))) == null ? '' : __t) +
'\n  </button>\n</div>\n\n<div class="ngeo-query-panel-actions">\n  <div class="form-check">\n    <label class="form-check-label">\n      <input\n        type="radio"\n        class="form-check-input"\n        ng-model="$ctrl.ngeoQueryModeSelector.action"\n        value="add"\n      >\n        <span>{{\'Add\' | translate }}</span>\n      </input>\n    </label>\n  </div>\n  <div class="form-check">\n    <label class="form-check-label">\n      <input\n        type="radio"\n        class="form-check-input"\n        ng-model="$ctrl.ngeoQueryModeSelector.action"\n        value="remove"\n      >\n        <span>{{\'Remove\' | translate }}</span>\n      </input>\n    </label>\n  </div>\n  <div class="form-check">\n    <label class="form-check-label">\n      <input\n        type="radio"\n        class="form-check-input"\n        ng-model="$ctrl.ngeoQueryModeSelector.action"\n        value="replace"\n      >\n        <span>{{\'Replace\' | translate }}</span>\n      </input>\n    </label>\n  </div>\n</div>\n';

}
return __p
}

/***/ }),

/***/ "./src/query/panelComponent.js":
/*!*************************************!*\
  !*** ./src/query/panelComponent.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_query_ModeSelector_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/query/ModeSelector.js */ "./src/query/ModeSelector.js");


var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoQueryPanel', [ngeo_query_ModeSelector_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.run(["$templateCache", function ($templateCache) {
  $templateCache.put('ngeo/src/query/panelComponent', __webpack_require__(/*! ./panelComponent.html */ "./src/query/panelComponent.html"));
}]);
module.value('ngeoQueryPanelTemplateUrl', function ($attrs) {
  var templateUrl = $attrs.ngeoQueryPanelTemplateUrl;
  return templateUrl !== undefined ? templateUrl : 'ngeo/src/query/panelComponent';
});
ngeoQueryPanelTemplateUrl.$inject = ["$attrs", "ngeoQueryPanelTemplateUrl"];

function ngeoQueryPanelTemplateUrl($attrs, ngeoQueryPanelTemplateUrl) {
  return ngeoQueryPanelTemplateUrl($attrs);
}

var QueryPanelController = function QueryPanelController(ngeoQueryModeSelector) {
  this.ngeoQueryModeSelector = ngeoQueryModeSelector;
};

QueryPanelController.$inject = ["ngeoQueryModeSelector"];
QueryPanelController.$inject = ["ngeoQueryModeSelector"];
module.component('ngeoQueryPanel', {
  controller: QueryPanelController,
  templateUrl: ngeoQueryPanelTemplateUrl
});
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/rule/Date.js":
/*!**************************!*\
  !*** ./src/rule/Date.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/rule/Rule.js */ "./src/rule/Rule.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }




var _default = function (_ngeoRuleRule) {
  _inheritsLoose(_default, _ngeoRuleRule);

  function _default(options) {
    options.type = options.type || ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__["default"].DATE;
    return _ngeoRuleRule.call(this, options) || this;
  }

  return _default;
}(ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__["default"]);



/***/ }),

/***/ "./src/rule/Geometry.js":
/*!******************************!*\
  !*** ./src/rule/Geometry.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/rule/Rule.js */ "./src/rule/Rule.js");
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/format/GeoJSON.js */ "./node_modules/ol/format/GeoJSON.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }







var _default = function (_ngeoRuleRule) {
  _inheritsLoose(_default, _ngeoRuleRule);

  function _default(options) {
    var _this;

    options.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__["default"].GEOMETRY;
    _this = _ngeoRuleRule.call(this, options) || this;
    var properties = options.featureProperties || {};
    _this.feature_ = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_3__["default"](properties);
    _this.format_ = new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_4__["default"]();
    _this.updatingExpression_ = false;
    _this.updatingGeometry_ = false;
    _this.geometryChangeListenerKey_ = null;

    _this.listenerKeys.push(Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(_this.feature_, "change:" + _this.feature.getGeometryName(), _this.handleFeatureGeometryChange_, _assertThisInitialized(_this)));

    _this.setGeometryFromExpression_();

    return _this;
  }

  var _proto = _default.prototype;

  _proto.setExpression = function setExpression(expression) {
    this.updatingExpression_ = true;

    _ngeoRuleRule.prototype.setExpression.call(this, expression);

    if (!this.updatingGeometry_) {
      this.setGeometryFromExpression_();
    }

    this.registerGeometryChange_();
    this.updatingExpression_ = false;
  };

  _proto.handleFeatureGeometryChange_ = function handleFeatureGeometryChange_() {
    if (this.updatingExpression_) {
      return;
    }

    this.updatingGeometry_ = true;
    var geometry = this.feature_.getGeometry();

    if (geometry) {
      this.expression = this.format_.writeGeometry(geometry);
    } else {
      this.expression = null;
    }

    this.registerGeometryChange_();
    this.updatingGeometry_ = false;
  };

  _proto.handleGeometryChange_ = function handleGeometryChange_(evt) {
    var geometry = evt.target;
    this.updatingGeometry_ = true;
    this.expression = this.format_.writeGeometry(geometry);
    this.updatingGeometry_ = false;
  };

  _proto.setGeometryFromExpression_ = function setGeometryFromExpression_() {
    var geometry = null;

    if (this.expression) {
      var expression = this.expression;
      geometry = this.format_.readGeometry(expression);
    }

    this.geometry = geometry;
  };

  _proto.registerGeometryChange_ = function registerGeometryChange_() {
    if (this.geometryChangeListenerKey_ !== null) {
      Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["unlistenByKey"])(this.geometryChangeListenerKey_);
      this.geometryChangeListenerKey_ = null;
    }

    var geometry = this.feature_.getGeometry();

    if (geometry) {
      this.geometryChangeListenerKey_ = Object(ol_events_js__WEBPACK_IMPORTED_MODULE_2__["listen"])(geometry, 'change', this.handleGeometryChange_, this);
    }
  };

  _createClass(_default, [{
    key: "feature",
    get: function get() {
      return this.feature_;
    }
  }, {
    key: "geometry",
    get: function get() {
      return this.feature_.getGeometry() || null;
    },
    set: function set(geometry) {
      this.feature_.setGeometry(geometry || undefined);
    }
  }]);

  return _default;
}(ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__["default"]);



/***/ }),

/***/ "./src/rule/Rule.js":
/*!**************************!*\
  !*** ./src/rule/Rule.js ***!
  \**************************/
/*! exports provided: RuleOperatorType, RuleSpatialOperatorType, RuleTemporalOperatorType, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RuleOperatorType", function() { return RuleOperatorType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RuleSpatialOperatorType", function() { return RuleSpatialOperatorType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RuleTemporalOperatorType", function() { return RuleTemporalOperatorType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Rule; });
/* harmony import */ var ol_events_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/events.js */ "./node_modules/ol/events.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }


var RuleOperatorType = {
  BETWEEN: '..',
  EQUAL_TO: '=',
  GREATER_THAN: '>',
  GREATER_THAN_OR_EQUAL_TO: '>=',
  LESSER_THAN: '<',
  LESSER_THAN_OR_EQUAL_TO: '<=',
  LIKE: '~',
  NOT_EQUAL_TO: '!='
};
var RuleSpatialOperatorType = {
  CONTAINS: 'contains',
  INTERSECTS: 'intersects',
  WITHIN: 'within'
};
var RuleTemporalOperatorType = {
  BEGINS: 'time_start',
  DURING: 'time_during',
  ENDS: 'time_end',
  EQUALS: 'time_equal'
};

var Rule = function () {
  function Rule(options) {
    this.active = options.active === true;
    this.expression = options.expression !== undefined ? options.expression : null;
    this.lowerBoundary = options.lowerBoundary !== undefined ? options.lowerBoundary : null;
    this.operator = options.operator || null;
    this.upperBoundary = options.upperBoundary !== undefined ? options.upperBoundary : null;
    this.isCustom_ = options.isCustom !== false;
    this.name_ = options.name;
    this.operators_ = options.operators || null;
    this.propertyName_ = options.propertyName;
    this.type_ = options.type;
    this.listenerKeys = [];
  }

  var _proto = Rule.prototype;

  _proto.getExpression = function getExpression() {
    return this.expression;
  };

  _proto.setExpression = function setExpression(expression) {
    this.expression = expression;
  };

  _proto.reset = function reset() {
    if (this.getExpression() !== null) {
      this.setExpression(null);
    }

    if (this.lowerBoundary !== null) {
      this.lowerBoundary = null;
    }

    if (this.upperBoundary !== null) {
      this.upperBoundary = null;
    }
  };

  _proto.destroy = function destroy() {
    this.listenerKeys.forEach(ol_events_js__WEBPACK_IMPORTED_MODULE_0__["unlistenByKey"]);
    this.listenerKeys.length = 0;
  };

  _createClass(Rule, [{
    key: "isCustom",
    get: function get() {
      return this.isCustom_;
    }
  }, {
    key: "name",
    get: function get() {
      return this.name_;
    }
  }, {
    key: "operators",
    get: function get() {
      return this.operators_;
    }
  }, {
    key: "propertyName",
    get: function get() {
      return this.propertyName_;
    }
  }, {
    key: "type",
    get: function get() {
      return this.type_;
    }
  }, {
    key: "value",
    get: function get() {
      var value = null;
      var expression = this.getExpression();
      var lowerBoundary = this.lowerBoundary;
      var operator = this.operator;
      var propertyName = this.propertyName;
      var upperBoundary = this.upperBoundary;

      if (operator) {
        if (operator === RuleOperatorType.BETWEEN || operator === RuleTemporalOperatorType.DURING) {
          if (lowerBoundary !== null && upperBoundary !== null) {
            value = {
              operator: operator,
              lowerBoundary: lowerBoundary,
              propertyName: propertyName,
              upperBoundary: upperBoundary
            };
          }
        } else {
          if (expression !== null) {
            value = {
              expression: expression,
              operator: operator,
              propertyName: propertyName
            };
          }
        }
      }

      return value;
    }
  }]);

  return Rule;
}();



/***/ }),

/***/ "./src/rule/Select.js":
/*!****************************!*\
  !*** ./src/rule/Select.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/rule/Rule.js */ "./src/rule/Rule.js");
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }




var _default = function (_ngeoRuleRule) {
  _inheritsLoose(_default, _ngeoRuleRule);

  function _default(options) {
    var _this;

    options.operator = ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__["RuleOperatorType"].EQUAL_TO;
    options.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__["default"].SELECT;
    _this = _ngeoRuleRule.call(this, options) || this;
    _this.choices_ = options.choices;
    return _this;
  }

  _createClass(_default, [{
    key: "choices",
    get: function get() {
      return this.choices_;
    }
  }, {
    key: "selectedChoices",
    get: function get() {
      var selectedChoices;

      if (this.expression) {
        var stringExpression = String(this.expression);
        selectedChoices = stringExpression.split(',');
      } else {
        selectedChoices = [];
      }

      return selectedChoices;
    }
  }]);

  return _default;
}(ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__["default"]);



/***/ }),

/***/ "./src/rule/Text.js":
/*!**************************!*\
  !*** ./src/rule/Text.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return _default; });
/* harmony import */ var ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ngeo/format/AttributeType.js */ "./src/format/AttributeType.js");
/* harmony import */ var ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/rule/Rule.js */ "./src/rule/Rule.js");
function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }




var _default = function (_ngeoRuleRule) {
  _inheritsLoose(_default, _ngeoRuleRule);

  function _default(options) {
    options.operator = options.operator || ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__["RuleOperatorType"].LIKE;
    options.type = ngeo_format_AttributeType_js__WEBPACK_IMPORTED_MODULE_0__["default"].TEXT;
    return _ngeoRuleRule.call(this, options) || this;
  }

  return _default;
}(ngeo_rule_Rule_js__WEBPACK_IMPORTED_MODULE_1__["default"]);



/***/ }),

/***/ "./src/sass/font.scss":
/*!****************************!*\
  !*** ./src/sass/font.scss ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./src/sass/jquery-ui.scss":
/*!*********************************!*\
  !*** ./src/sass/jquery-ui.scss ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./src/search/createGeoJSONBloodhound.js":
/*!***********************************************!*\
  !*** ./src/search/createGeoJSONBloodhound.js ***!
  \***********************************************/
/*! exports provided: createGeoJSONBloodhound, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createGeoJSONBloodhound", function() { return createGeoJSONBloodhound; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/format/GeoJSON.js */ "./node_modules/ol/format/GeoJSON.js");
/* harmony import */ var corejs_typeahead__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! corejs-typeahead */ "./node_modules/corejs-typeahead/dist/typeahead.bundle.js-exposed");
/* harmony import */ var corejs_typeahead__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(corejs_typeahead__WEBPACK_IMPORTED_MODULE_2__);



function createGeoJSONBloodhound(url, opt_filter, opt_featureProjection, opt_dataProjection, opt_options, opt_remoteOptions) {
  var geojsonFormat = new ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_1__["default"]();
  var bloodhoundOptions = {
    remote: {
      url: url,
      prepare: function prepare(query, settings) {
        if (settings.url) {
          settings.url = settings.url.replace('%QUERY', query);
        }

        return settings;
      },
      transform: function transform(parsedResponse) {
        var featureCollection = parsedResponse;

        if (opt_filter !== undefined) {
          featureCollection = {
            type: 'FeatureCollection',
            features: featureCollection.features.filter(opt_filter)
          };
        }

        return geojsonFormat.readFeatures(featureCollection, {
          featureProjection: opt_featureProjection,
          dataProjection: opt_dataProjection
        });
      }
    },
    datumTokenizer: function datumTokenizer(datum) {
      return [];
    },
    queryTokenizer: Bloodhound.tokenizers.whitespace
  };
  var options = Object.assign({}, opt_options || {
    datumTokenizer: function datumTokenizer(datum) {
      return [];
    },
    queryTokenizer: Bloodhound.tokenizers.whitespace
  });
  var remoteOptions = Object.assign({}, opt_remoteOptions || {
    url: ''
  });

  if (options.remote) {
    Object.assign(remoteOptions, options.remote);
    delete options.remote;
  }

  Object.assign(bloodhoundOptions, options);
  Object.assign(bloodhoundOptions.remote, remoteOptions);
  return new Bloodhound(bloodhoundOptions);
}
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoSearchCreategeojsonbloodhound', []);
module.value('ngeoSearchCreateGeoJSONBloodhound', createGeoJSONBloodhound);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/search/createLocationSearchBloodhound.js":
/*!******************************************************!*\
  !*** ./src/search/createLocationSearchBloodhound.js ***!
  \******************************************************/
/*! exports provided: createLocationSearchBloodhoundFunction, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createLocationSearchBloodhoundFunction", function() { return createLocationSearchBloodhoundFunction; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_proj_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/proj.js */ "./node_modules/ol/proj.js");
/* harmony import */ var _geoblocks_proj_src_EPSG_21781_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @geoblocks/proj/src/EPSG_21781.js */ "./node_modules/@geoblocks/proj/src/EPSG_21781.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var corejs_typeahead__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! corejs-typeahead */ "./node_modules/corejs-typeahead/dist/typeahead.bundle.js-exposed");
/* harmony import */ var corejs_typeahead__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(corejs_typeahead__WEBPACK_IMPORTED_MODULE_5__);







function createLocationSearchBloodhound(opt_options) {
  var options = opt_options || {};
  var sourceProjection = ol_proj_js__WEBPACK_IMPORTED_MODULE_1__["get"](_geoblocks_proj_src_EPSG_21781_js__WEBPACK_IMPORTED_MODULE_2__["default"]);
  var targetProjection = options.targetProjection;

  var parseBbox = function parseBbox(bbox) {
    var regex = /BOX\((.*?) (.*?),(.*?) (.*?)\)/g;
    var match = regex.exec(bbox);

    if (match !== null) {
      return [parseFloat(match[1]), parseFloat(match[2]), parseFloat(match[3]), parseFloat(match[4])];
    } else {
      return null;
    }
  };

  var removeHtmlTags = function removeHtmlTags(label) {
    return label.replace(/<\/?[ib]>/g, '');
  };

  var extractName = function extractName(label) {
    var regex = /<b>(.*?)<\/b>/g;
    var match = regex.exec(label);

    if (match !== null) {
      return match[1];
    } else {
      return label;
    }
  };

  var bloodhoundOptions = {
    remote: {
      url: 'https://api3.geo.admin.ch/rest/services/api/SearchServer?type=locations&searchText=%QUERY',
      prepare: function prepare(query, settings) {
        if (settings.url) {
          settings.url = settings.url.replace('%QUERY', query);

          if (options.limit !== undefined) {
            settings.url += "&limit=" + options.limit;
          }

          if (options.origins !== undefined) {
            settings.url += "&origins=" + options.origins;
          }
        }

        return options.prepare !== undefined ? options.prepare(query, settings) : settings;
      },
      transform: function transform(parsedResponse_) {
        var parsedResponse = parsedResponse_;

        if (Array.isArray(parsedResponse)) {
          throw new Error('Wrong parsedResponse type');
        }

        var features = parsedResponse.results.map(function (result) {
          var attrs = result.attrs;
          var point = new ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_3__["default"]([attrs.y, attrs.x]);
          var bbox = parseBbox(attrs.geom_st_box2d);

          if (targetProjection !== undefined) {
            point.transform(sourceProjection, targetProjection);

            if (bbox !== null) {
              bbox = ol_proj_js__WEBPACK_IMPORTED_MODULE_1__["transformExtent"](bbox, sourceProjection, targetProjection);
            }
          }

          attrs.geometry = point;
          attrs.bbox = bbox;
          var label = attrs.label;
          attrs.label_no_html = removeHtmlTags(label);
          attrs.label_simple = extractName(label);
          var feature = new ol_Feature_js__WEBPACK_IMPORTED_MODULE_4__["default"](attrs);
          feature.setId(attrs.featureId);
          return feature;
        });
        return features;
      }
    },
    datumTokenizer: function datumTokenizer(datum) {
      return [];
    },
    queryTokenizer: Bloodhound.tokenizers.whitespace
  };
  var bhOptions = Object.assign({}, options.options || {
    datumTokenizer: function datumTokenizer(datum) {
      return [];
    },
    queryTokenizer: Bloodhound.tokenizers.whitespace
  });
  var remoteOptions = Object.assign({}, options.remoteOptions || {});

  if (bhOptions.remote) {
    Object.assign(remoteOptions, bhOptions.remote);
    delete bhOptions.remote;
  }

  Object.assign(bloodhoundOptions, bhOptions);
  Object.assign(bloodhoundOptions.remote, remoteOptions);
  return new Bloodhound(bloodhoundOptions);
}

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoCreateLocationSearchBloodhound', []);
module.value('ngeoCreateLocationSearchBloodhound', createLocationSearchBloodhound);
function createLocationSearchBloodhoundFunction() {}
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/search/module.js":
/*!******************************!*\
  !*** ./src/search/module.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_search_searchDirective_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/search/searchDirective.js */ "./src/search/searchDirective.js");
/* harmony import */ var ngeo_search_createGeoJSONBloodhound_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/search/createGeoJSONBloodhound.js */ "./src/search/createGeoJSONBloodhound.js");
/* harmony import */ var ngeo_search_createLocationSearchBloodhound_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngeo/search/createLocationSearchBloodhound.js */ "./src/search/createLocationSearchBloodhound.js");




/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoSearchModule', [ngeo_search_searchDirective_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_search_createGeoJSONBloodhound_js__WEBPACK_IMPORTED_MODULE_2__["default"].name, ngeo_search_createLocationSearchBloodhound_js__WEBPACK_IMPORTED_MODULE_3__["default"].name]));

/***/ }),

/***/ "./src/search/searchDirective.js":
/*!***************************************!*\
  !*** ./src/search/searchDirective.js ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);


function searchComponent() {
  return {
    restrict: 'A',
    link: function link(scope, element, attrs) {
      var typeaheadOptionsExpr = attrs.ngeoSearch;
      var typeaheadOptions = scope.$eval(typeaheadOptionsExpr);
      var typeaheadDatasetsExpr = attrs.ngeoSearchDatasets;
      var typeaheadDatasets = scope.$eval(typeaheadDatasetsExpr);
      element.typeahead(typeaheadOptions, typeaheadDatasets);
      var typeaheadListenersExpr = attrs.ngeoSearchListeners;
      var typeaheadListeners_ = scope.$eval(typeaheadListenersExpr);
      var typeaheadListeners = adaptListeners_(typeaheadListeners_);
      element.on('typeahead:open', function () {
        scope.$apply(function () {
          typeaheadListeners.open();
        });
      });
      element.on('typeahead:close', function () {
        scope.$apply(function () {
          typeaheadListeners.close();
        });
      });
      element.on('typeahead:cursorchange', function (event, suggestion, dataset) {
        scope.$apply(function () {
          typeaheadListeners.cursorchange(event, suggestion, dataset);
        });
      });
      element.on('typeahead:select', function (event, suggestion, dataset) {
        scope.$apply(function () {
          typeaheadListeners.select(event, suggestion, dataset);
        });
      });
      element.on('typeahead:autocomplete', function (event, suggestion, dataset) {
        scope.$apply(function () {
          typeaheadListeners.autocomplete(event, suggestion, dataset);
        });
      });
      element.on('typeahead:asyncreceive', function (event, dataset, query) {
        scope.$apply(function () {
          var empty = element.data('tt-typeahead').menu._allDatasetsEmpty();

          typeaheadListeners.datasetsempty(event, query, empty);
        });
      });
      element.on('typeahead:change', function (event) {
        scope.$apply(function () {
          var query = element.data('tt-typeahead').input.query;
          typeaheadListeners.change(event, query);
        });
      });
    }
  };
}

function adaptListeners_(object) {
  var typeaheadListeners;

  if (object === undefined) {
    typeaheadListeners = {
      open: function open() {},
      close: function close() {},
      cursorchange: function cursorchange() {},
      datasetsempty: function datasetsempty() {},
      select: function select() {},
      autocomplete: function autocomplete() {},
      change: function change() {}
    };
  } else {
    typeaheadListeners = {
      open: object.open !== undefined ? object.open : function () {},
      close: object.close !== undefined ? object.close : function () {},
      cursorchange: object.cursorchange !== undefined ? object.cursorchange : function () {},
      datasetsempty: object.datasetsempty !== undefined ? object.datasetsempty : function () {},
      select: object.select !== undefined ? object.select : function () {},
      autocomplete: object.autocomplete !== undefined ? object.autocomplete : function () {},
      change: object.change !== undefined ? object.change : function () {}
    };
  }

  return typeaheadListeners;
}

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoSearchDirective', []);
module.directive('ngeoSearch', searchComponent);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/statemanager/Location.js":
/*!**************************************!*\
  !*** ./src/statemanager/Location.js ***!
  \**************************************/
/*! exports provided: StatemanagerLocation, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StatemanagerLocation", function() { return StatemanagerLocation; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/utils.js */ "./src/utils.js");
LocationFactory.$inject = ["$rootScope", "$window"];


function StatemanagerLocation(location, history) {
  this.history_ = history;
  this.schema_ = location.protocol.substring(0, location.protocol.length - 1);
  this.domain_ = location.hostname;
  this.port_ = location.port ? parseInt(location.port, 10) : undefined;
  this.path_ = location.pathname;
  this.queryData_ = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["decodeQueryString"])(location.search);
  this.fragment_ = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["decodeQueryString"])(location.hash);
}

function replaceState(history, state) {
  try {
    history.replaceState(null, '', state);
  } catch (error) {}
}

StatemanagerLocation.prototype.getPath = function () {
  return this.path_;
};

StatemanagerLocation.prototype.getUriString = function () {
  var out = [];

  if (this.schema_) {
    out.push(this.schema_, ':');
  }

  if (this.domain_ || this.schema_ === 'file') {
    out.push('//');
    out.push(this.domain_);

    if (this.port_ !== undefined) {
      out.push(':', String(this.port_));
    }
  }

  if (this.path_) {
    if (this.domain_ && !this.path_.startsWith('/')) {
      out.push('/');
    }

    out.push(this.path_);
  }

  var encodedQueryData = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["encodeQueryString"])(this.queryData_);

  if (encodedQueryData.length > 0) {
    out.push('?', encodedQueryData);
  }

  var encodedFragment = Object(ngeo_utils_js__WEBPACK_IMPORTED_MODULE_1__["encodeQueryString"])(this.fragment_);

  if (encodedFragment.length > 0) {
    out.push('#', encodedFragment);
  }

  return out.join('');
};

StatemanagerLocation.prototype.hasParam = function (key) {
  return key in this.queryData_;
};

StatemanagerLocation.prototype.hasFragmentParam = function (key) {
  return key in this.fragment_;
};

StatemanagerLocation.prototype.getParam = function (key) {
  return this.queryData_[key];
};

StatemanagerLocation.prototype.getFragmentParam = function (key) {
  return this.fragment_[key];
};

StatemanagerLocation.prototype.getParamAsInt = function (key) {
  var value = this.getParam(key);

  if (value === undefined) {
    return undefined;
  }

  console.assert(typeof value == 'string');
  var valueAsInt = parseInt(value, 10);
  return isNaN(valueAsInt) ? undefined : valueAsInt;
};

StatemanagerLocation.prototype.getParamAsFloat = function (key) {
  var value = this.getParam(key);

  if (value === undefined) {
    return undefined;
  }

  console.assert(typeof value == 'string');
  var valueAsFloat = parseFloat(value);
  return isNaN(valueAsFloat) ? undefined : valueAsFloat;
};

StatemanagerLocation.prototype.getFragmentParamAsInt = function (key) {
  var value = this.getFragmentParam(key);

  if (value === undefined) {
    return undefined;
  }

  console.assert(typeof value == 'string');
  var valueAsInt = parseInt(value, 10);
  return isNaN(valueAsInt) ? undefined : valueAsInt;
};

StatemanagerLocation.prototype.getParamKeys = function () {
  var keys = [];

  for (var key in this.queryData_) {
    keys.push(key);
  }

  return keys;
};

StatemanagerLocation.prototype.getFragmentParamKeys = function () {
  var keys = [];

  for (var key in this.fragment_) {
    keys.push(key);
  }

  return keys;
};

StatemanagerLocation.prototype.getParamKeysWithPrefix = function (prefix) {
  var keys = [];

  for (var key in this.queryData_) {
    if (key.startsWith(prefix)) {
      keys.push(key);
    }
  }

  return keys;
};

StatemanagerLocation.prototype.getFragmentParamKeysWithPrefix = function (prefix) {
  var keys = [];

  for (var key in this.fragment_) {
    if (key.startsWith(prefix)) {
      keys.push(key);
    }
  }

  return keys;
};

StatemanagerLocation.prototype.updateParams = function (params) {
  for (var key in params) {
    this.queryData_[key] = params[key];
  }
};

StatemanagerLocation.prototype.updateFragmentParams = function (params) {
  for (var key in params) {
    this.fragment_[key] = params[key];
  }
};

StatemanagerLocation.prototype.deleteParam = function (key) {
  delete this.queryData_[key];
};

StatemanagerLocation.prototype.deleteFragmentParam = function (key) {
  delete this.fragment_[key];
};

StatemanagerLocation.prototype.refresh = function () {
  replaceState(this.history_, this.getUriString());
};

StatemanagerLocation.prototype.setPath = function (path) {
  this.path_ = path;
};

function LocationFactory($rootScope, $window) {
  var history = $window.history;
  var service = new StatemanagerLocation($window.location, $window.history);
  var lastUri = service.getUriString();
  $rootScope.$watch(function () {
    var newUri = service.getUriString();

    if (lastUri !== newUri) {
      $rootScope.$evalAsync(function () {
        lastUri = newUri;

        if (history !== undefined && history.replaceState !== undefined) {
          replaceState(history, newUri);
        }

        $rootScope.$broadcast('ngeoLocationChange');
      });
    }
  });
  return service;
}

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoLocation', []);
module.factory('ngeoLocation', LocationFactory);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/statemanager/Service.js":
/*!*************************************!*\
  !*** ./src/statemanager/Service.js ***!
  \*************************************/
/*! exports provided: StatemanagerService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StatemanagerService", function() { return StatemanagerService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_statemanager_Location_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/statemanager/Location.js */ "./src/statemanager/Location.js");


var StatemanagerService = function () {
  StatemanagerService.$inject = ["ngeoLocation", "ngeoUsedKeyRegexp"];

  function StatemanagerService(ngeoLocation, ngeoUsedKeyRegexp) {
    var _this = this;

    this.initialState = {};
    this.ngeoLocation = ngeoLocation;
    this.usedKeyRegexp = ngeoUsedKeyRegexp;
    this.useLocalStorage_ = false;
    this.setUseLocalStorage(false);
    var paramKeys = ngeoLocation.getParamKeys().filter(function (key) {
      return key != 'debug' && key != 'no_redirect';
    });

    if (paramKeys.length === 0) {
      if (this.useLocalStorage_) {
        var _loop = function _loop(key) {
          console.assert(key);

          _this.usedKeyRegexp.some(function (keyRegexp) {
            if (key.match(keyRegexp)) {
              var value = window.localStorage[key];

              if (value !== undefined || value !== null) {
                _this.initialState[key] = value;
              } else {
                _this.initialState[key] = '';
              }

              return true;
            }

            return false;
          });
        };

        for (var key in window.localStorage) {
          _loop(key);
        }
      }
    } else {
      paramKeys.forEach(function (key) {
        _this.usedKeyRegexp.some(function (keyRegexp) {
          if (key.match(keyRegexp)) {
            var value = _this.ngeoLocation.getParam(key);

            if (value !== undefined) {
              _this.initialState[key] = value;
              return true;
            }
          }

          return false;
        });
      });
    }
  }

  var _proto = StatemanagerService.prototype;

  _proto.setUseLocalStorage = function setUseLocalStorage(value) {
    this.useLocalStorage_ = value;

    if (this.useLocalStorage_) {
      try {
        if ('localStorage' in window) {
          window.localStorage['test'] = '';
          delete window.localStorage['test'];
        } else {
          this.useLocalStorage_ = false;
        }
      } catch (err) {
        console.error(err);
        this.useLocalStorage_ = false;
      }
    }

    return this.useLocalStorage_;
  };

  _proto.getInitialStringValue = function getInitialStringValue(key) {
    return this.initialState[key];
  };

  _proto.getInitialNumberValue = function getInitialNumberValue(key) {
    var value = this.initialState[key];

    if (value === undefined) {
      return undefined;
    }

    return parseFloat(value);
  };

  _proto.getInitialBooleanValue = function getInitialBooleanValue(key) {
    var value = this.initialState[key];

    if (value === undefined) {
      return undefined;
    }

    return value === 'true';
  };

  _proto.updateState = function updateState(object) {
    this.ngeoLocation.updateParams(object);

    if (this.useLocalStorage_) {
      for (var key in object) {
        console.assert(key);
        var value = object[key];
        console.assert(value !== undefined);
        window.localStorage[key] = value;
      }
    }
  };

  _proto.deleteParam = function deleteParam(key) {
    this.ngeoLocation.deleteParam(key);

    if (this.useLocalStorage_) {
      delete window.localStorage[key];
    }
  };

  return StatemanagerService;
}();
var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoStateManager', [ngeo_statemanager_Location_js__WEBPACK_IMPORTED_MODULE_1__["default"].name]);
module.service('ngeoStateManager', StatemanagerService);
module.value('ngeoUsedKeyRegexp', [new RegExp('.*')]);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/statemanager/WfsPermalink.js":
/*!******************************************!*\
  !*** ./src/statemanager/WfsPermalink.js ***!
  \******************************************/
/*! exports provided: WfsPermalinkService, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WfsPermalinkService", function() { return WfsPermalinkService; });
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");
/* harmony import */ var ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/Feature.js */ "./node_modules/ol/Feature.js");
/* harmony import */ var ol_format_filter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/format/filter.js */ "./node_modules/ol/format/filter.js");
/* harmony import */ var ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/format/WFS.js */ "./node_modules/ol/format/WFS.js");
WfsPermalinkService.$inject = ["$http", "ngeoPermalinkOgcserverUrl", "ngeoQueryResult", "ngeoWfsPermalinkOptions"];





function WfsPermalinkService($http, ngeoPermalinkOgcserverUrl, ngeoQueryResult, ngeoWfsPermalinkOptions) {
  var _this = this;

  var options = ngeoWfsPermalinkOptions;
  this.url_ = ngeoPermalinkOgcserverUrl;
  this.maxFeatures_ = options.maxFeatures !== undefined ? options.maxFeatures : 50;
  this.wfsTypes_ = {};
  console.assert(Array.isArray(options.wfsTypes), 'wfsTypes is not correctly set');
  options.wfsTypes.forEach(function (wfsType) {
    _this.wfsTypes_[wfsType.featureType] = wfsType;
  });
  this.defaultFeatureNS_ = options.defaultFeatureNS;
  this.defaultFeaturePrefix_ = options.defaultFeaturePrefix;
  this.pointRecenterZoom_ = options.pointRecenterZoom;
  this.$http_ = $http;
  this.result_ = ngeoQueryResult;
}

WfsPermalinkService.prototype.clear = function () {
  this.clearResult_();
};

WfsPermalinkService.prototype.issue = function (queryData, map) {
  console.assert(this.url_, 'url is not set. to use the wfs permalink service, ' + 'set the value `ngeoWfsPermalinkOptions`');
  this.clearResult_();
  var typeName = queryData.wfsType;

  if (!this.wfsTypes_.hasOwnProperty(typeName)) {
    return;
  }

  var wfsType = this.wfsTypes_[typeName];
  var filters = this.createFilters_(queryData.filterGroups);

  if (filters === null) {
    return;
  }

  this.issueRequest_(wfsType, filters, map, queryData.showFeatures);
};

WfsPermalinkService.prototype.issueRequest_ = function (wfsType, filter, map, showFeatures) {
  var _this2 = this;

  var wfsFormat = new ol_format_WFS_js__WEBPACK_IMPORTED_MODULE_4__["default"]();
  var featureRequestXml = wfsFormat.writeGetFeature({
    srsName: map.getView().getProjection().getCode(),
    featureNS: wfsType.featureNS !== undefined ? wfsType.featureNS : this.defaultFeatureNS_,
    featurePrefix: wfsType.featurePrefix !== undefined ? wfsType.featurePrefix : this.defaultFeaturePrefix_,
    featureTypes: [wfsType.featureType],
    outputFormat: 'GML3',
    filter: filter,
    maxFeatures: this.maxFeatures_
  });
  var featureRequest = new XMLSerializer().serializeToString(featureRequestXml);
  var config = {
    headers: {
      'Content-Type': 'text/xml; charset=UTF-8'
    }
  };
  this.$http_.post(this.url_, featureRequest, config).then(function (response) {
    var features = wfsFormat.readFeatures(response.data);

    if (features.length == 0) {
      return;
    }

    var size = map.getSize();

    if (size !== undefined && _this2.pointRecenterZoom_ !== undefined) {
      var maxZoom = _this2.pointRecenterZoom_;
      var padding = [10, 10, 10, 10];
      map.getView().fit(_this2.getExtent_(features), {
        size: size,
        maxZoom: maxZoom,
        padding: padding
      });
    }

    if (showFeatures) {
      var resultSource = {
        'features': features,
        'id': wfsType.featureType,
        'identifierAttributeField': wfsType.label,
        'label': wfsType.featureType,
        'pending': false
      };

      _this2.result_.sources.push(resultSource);

      _this2.result_.total = features.length;
    }
  });
};

WfsPermalinkService.prototype.getExtent_ = function (features) {
  return features.reduce(function (extent, feature) {
    if (feature instanceof ol_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]) {
      var geometry = feature.getGeometry();

      if (geometry) {
        return Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_1__["extend"])(extent, geometry.getExtent());
      }

      return extent;
    }
  }, Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_1__["createEmpty"])());
};

WfsPermalinkService.prototype.createFilters_ = function (filterGroups) {
  if (filterGroups.length == 0) {
    return null;
  }

  var createFiltersForGroup = function createFiltersForGroup(filterGroup) {
    var filters = filterGroup.filters.map(function (filterDef) {
      var condition = filterDef.condition;

      if (Array.isArray(condition)) {
        return WfsPermalinkService.or_(condition.map(function (cond) {
          return Object(ol_format_filter_js__WEBPACK_IMPORTED_MODULE_3__["equalTo"])(filterDef.property, cond);
        }));
      } else {
        return Object(ol_format_filter_js__WEBPACK_IMPORTED_MODULE_3__["equalTo"])(filterDef.property, condition);
      }
    });
    return WfsPermalinkService.and_(filters);
  };

  var filters = filterGroups.map(createFiltersForGroup);

  if (filters) {
    return WfsPermalinkService.or_(filters);
  }

  return null;
};

WfsPermalinkService.and_ = function (filters) {
  return WfsPermalinkService.joinFilters_(filters, ol_format_filter_js__WEBPACK_IMPORTED_MODULE_3__["and"]);
};

WfsPermalinkService.or_ = function (filters) {
  return WfsPermalinkService.joinFilters_(filters, ol_format_filter_js__WEBPACK_IMPORTED_MODULE_3__["or"]);
};

WfsPermalinkService.joinFilters_ = function (filters, joinFn) {
  return filters.reduce(function (combinedFilters, currentFilter) {
    if (combinedFilters === null) {
      return currentFilter;
    } else {
      console.assert(currentFilter !== null);
      return joinFn(combinedFilters, currentFilter);
    }
  });
};

WfsPermalinkService.prototype.clearResult_ = function () {
  this.result_.total = 0;
  this.result_.sources.forEach(function (source) {
    source.features.length = 0;
  });
};

var module = angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoWfsPermalink', []);
module.value('ngeoPermalinkOgcserverUrl', '');
module.value('ngeoWfsPermalinkOptions', {
  url: '',
  wfsTypes: [],
  defaultFeatureNS: '',
  defaultFeaturePrefix: ''
});
module.service('ngeoWfsPermalink', WfsPermalinkService);
/* harmony default export */ __webpack_exports__["default"] = (module);

/***/ }),

/***/ "./src/statemanager/module.js":
/*!************************************!*\
  !*** ./src/statemanager/module.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! angular */ "./node_modules/angular/index.js");
/* harmony import */ var angular__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(angular__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ngeo_statemanager_Location_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ngeo/statemanager/Location.js */ "./src/statemanager/Location.js");
/* harmony import */ var ngeo_statemanager_Service_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ngeo/statemanager/Service.js */ "./src/statemanager/Service.js");



/* harmony default export */ __webpack_exports__["default"] = (angular__WEBPACK_IMPORTED_MODULE_0___default.a.module('ngeoStatemanagerModule', [ngeo_statemanager_Location_js__WEBPACK_IMPORTED_MODULE_1__["default"].name, ngeo_statemanager_Service_js__WEBPACK_IMPORTED_MODULE_2__["default"].name]));

/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/*! exports provided: hasCoarsePointingDevice, getBrowserLanguage, toMulti, isSafari, colorZeroPadding, rgbArrayToHex, decodeQueryString, encodeQueryString, deleteCondition, extentToRectangle */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasCoarsePointingDevice", function() { return hasCoarsePointingDevice; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getBrowserLanguage", function() { return getBrowserLanguage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toMulti", function() { return toMulti; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isSafari", function() { return isSafari; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "colorZeroPadding", function() { return colorZeroPadding; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rgbArrayToHex", function() { return rgbArrayToHex; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "decodeQueryString", function() { return decodeQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "encodeQueryString", function() { return encodeQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deleteCondition", function() { return deleteCondition; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extentToRectangle", function() { return extentToRectangle; });
/* harmony import */ var ol_events_condition_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ol/events/condition.js */ "./node_modules/ol/events/condition.js");
/* harmony import */ var ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ol/geom/LineString.js */ "./node_modules/ol/geom/LineString.js");
/* harmony import */ var ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ol/geom/MultiPoint.js */ "./node_modules/ol/geom/MultiPoint.js");
/* harmony import */ var ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ol/geom/MultiLineString.js */ "./node_modules/ol/geom/MultiLineString.js");
/* harmony import */ var ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ol/geom/MultiPolygon.js */ "./node_modules/ol/geom/MultiPolygon.js");
/* harmony import */ var ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ol/geom/Point.js */ "./node_modules/ol/geom/Point.js");
/* harmony import */ var ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ol/geom/Polygon.js */ "./node_modules/ol/geom/Polygon.js");
/* harmony import */ var ol_extent_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ol/extent.js */ "./node_modules/ol/extent.js");








function hasCoarsePointingDevice() {
  return matchMedia('(pointer: coarse)').matches;
}
function getBrowserLanguage(availableLanguages) {
  var browserLanguages = window.navigator.languages || [window.navigator.language];
  browserLanguages = browserLanguages.map(function (item) {
    return item.substring(0, 2);
  });
  browserLanguages = browserLanguages.filter(function (item, index, arr) {
    return arr.indexOf(item) == index;
  });
  var supportedLanguages = browserLanguages.filter(function (item) {
    return availableLanguages.includes(item);
  });
  return supportedLanguages[0];
}
function toMulti(geometry) {
  var multiGeom;

  if (geometry instanceof ol_geom_Point_js__WEBPACK_IMPORTED_MODULE_5__["default"]) {
    var multiGeomPoint = new ol_geom_MultiPoint_js__WEBPACK_IMPORTED_MODULE_2__["default"]([]);
    multiGeomPoint.appendPoint(geometry);
    multiGeom = multiGeomPoint;
  } else if (geometry instanceof ol_geom_LineString_js__WEBPACK_IMPORTED_MODULE_1__["default"]) {
    var multiGeomLine = new ol_geom_MultiLineString_js__WEBPACK_IMPORTED_MODULE_3__["default"]([]);
    multiGeomLine.appendLineString(geometry);
    multiGeom = multiGeomLine;
  } else if (geometry instanceof ol_geom_Polygon_js__WEBPACK_IMPORTED_MODULE_6__["default"]) {
    var multiGeomPolygon = new ol_geom_MultiPolygon_js__WEBPACK_IMPORTED_MODULE_4__["default"]([]);
    multiGeomPolygon.appendPolygon(geometry);
    multiGeom = multiGeomPolygon;
  } else {
    multiGeom = geometry;
  }

  return multiGeom;
}
function isSafari() {
  return navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome');
}
function colorZeroPadding(hex) {
  return hex.length == 1 ? "0" + hex : hex;
}
function rgbArrayToHex(rgb) {
  var r = rgb[0];
  var g = rgb[1];
  var b = rgb[2];

  if (r != (r & 255) || g != (g & 255) || b != (b & 255)) {
    throw Error("\"(" + r + "," + g + "," + b + ")\" is not a valid RGB color");
  }

  var hexR = colorZeroPadding(r.toString(16));
  var hexG = colorZeroPadding(g.toString(16));
  var hexB = colorZeroPadding(b.toString(16));
  return "#" + hexR + hexG + hexB;
}
function decodeQueryString(queryString) {
  var queryData = {};

  if (queryString) {
    var pairs = queryString.substring(1).split('&');

    for (var _iterator = pairs, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
      var _ref;

      if (_isArray) {
        if (_i >= _iterator.length) break;
        _ref = _iterator[_i++];
      } else {
        _i = _iterator.next();
        if (_i.done) break;
        _ref = _i.value;
      }

      var pair = _ref;
      var indexOfEquals = pair.indexOf('=');

      if (indexOfEquals >= 0) {
        var name = pair.substring(0, indexOfEquals);
        var value = pair.substring(indexOfEquals + 1);

        try {
          queryData[decodeURIComponent(name)] = decodeURIComponent(value);
        } catch (error) {
          console.error("Malformed parameter: " + name + "=" + value);
        }
      } else {
        queryData[pair] = '';
      }
    }
  }

  return queryData;
}
function encodeQueryString(queryData) {
  var queryItem = [];

  for (var key in queryData) {
    var value = queryData[key];
    queryItem.push(encodeURIComponent(key) + "=" + encodeURIComponent(value));
  }

  return queryItem.join('&');
}
function deleteCondition(event) {
  return Object(ol_events_condition_js__WEBPACK_IMPORTED_MODULE_0__["noModifierKeys"])(event) && Object(ol_events_condition_js__WEBPACK_IMPORTED_MODULE_0__["singleClick"])(event);
}
function extentToRectangle(extent) {
  var result = [Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_7__["getTopLeft"])(extent), Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_7__["getTopRight"])(extent), Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_7__["getBottomRight"])(extent), Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_7__["getBottomLeft"])(extent), Object(ol_extent_js__WEBPACK_IMPORTED_MODULE_7__["getTopLeft"])(extent)];
  return result;
}

/***/ }),

/***/ "dll-reference vendor":
/*!*************************!*\
  !*** external "vendor" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = vendor;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVza3RvcC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvYXBwcy9hcHBtb2R1bGUuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL2FwcHMvZGVza3RvcC9Db250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9hcHBzL2Rlc2t0b3AvY29udGV4dHVhbGRhdGEuaHRtbCIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2F1dGhlbnRpY2F0aW9uL1NlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9hdXRoZW50aWNhdGlvbi9jb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2F1dGhlbnRpY2F0aW9uL2NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2F1dGhlbnRpY2F0aW9uL21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2JhY2tncm91bmRsYXllcnNlbGVjdG9yL2NvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvYmFja2dyb3VuZGxheWVyc2VsZWN0b3IvY29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvY29udGV4dHVhbGRhdGEvY29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvY29udGV4dHVhbGRhdGEvbW9kdWxlLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvY29udHJvbGxlcnMvQWJzdHJhY3RBUElDb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvY29udHJvbGxlcnMvQWJzdHJhY3RBcHBDb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvY29udHJvbGxlcnMvQWJzdHJhY3REZXNrdG9wQ29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2NvbnRyb2xsZXJzL2Jvb3RzdHJhcC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2RhdGFzb3VyY2UvRGF0YVNvdXJjZUJlaW5nRmlsdGVyZWQuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9kYXRhc291cmNlL0V4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvZGF0YXNvdXJjZS9IZWxwZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9kYXRhc291cmNlL0xheWVyQmVpbmdTd2lwZS5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2RhdGFzb3VyY2UvTWFuYWdlci5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2RhdGFzb3VyY2UvT0dDLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvZGF0YXNvdXJjZS9XRlNBbGlhc2VzLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvZGF0YXNvdXJjZS9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9kaXNjbGFpbWVyL2NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2RyYXdpbmcvZHJhd0ZlYXR1cmVDb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2RyYXdpbmcvZHJhd0ZlYXR1cmVDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9kcmF3aW5nL2ZlYXR1cmVTdHlsZUNvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvZHJhd2luZy9mZWF0dXJlU3R5bGVDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9kcmF3aW5nL21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2VkaXRpbmcvRWRpdEZlYXR1cmUuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9lZGl0aW5nL0VudW1lcmF0ZUF0dHJpYnV0ZS5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2VkaXRpbmcvU25hcHBpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9lZGl0aW5nL1hTREF0dHJpYnV0ZXMuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9lZGl0aW5nL2VkaXRGZWF0dXJlQ29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9lZGl0aW5nL2VkaXRGZWF0dXJlQ29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvZWRpdGluZy9lZGl0RmVhdHVyZVNlbGVjdG9yQ29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9lZGl0aW5nL2VkaXRGZWF0dXJlU2VsZWN0b3JDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9lZGl0aW5nL21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2ZpbHRlcnMvU2F2ZWRGaWx0ZXJzLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvZmlsdGVycy9maWx0ZXJzZWxlY3RvckNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2ZpbHRlcnMvZmlsdGVyc2VsZWN0b3Jjb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2ZpbHRlcnMvbW9kdWxlLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaWNvbnMvY2lyY2xlLnN2ZyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2ljb25zL2NpcmNsZS5zdmc/ZmYxNyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2ljb25zL2RvdC5zdmciLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9pY29ucy9sYXllcnMuc3ZnIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaWNvbnMvbGluZS5zdmciLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9pY29ucy9saW5lLnN2Zz8wNTU5Iiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaWNvbnMvcG9pbnQuc3ZnIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaWNvbnMvcG9pbnQuc3ZnP2QwNDEiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9pY29ucy9wb2x5Z29uLnN2ZyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2ljb25zL3BvbHlnb24uc3ZnPzQ4YTMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9pY29ucy9yZWN0YW5nbGUuc3ZnIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaWNvbnMvcmVjdGFuZ2xlLnN2Zz83YzMzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaWNvbnMvc2VhcmNoLWdvLnN2ZyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2ljb25zL3N0YWNrLWluZGV0ZXJtaW5hdGUuc3ZnIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaWNvbnMvdGV4dC5zdmciLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9pbXBvcnQvaW1wb3J0ZGF0YXNvdXJjZUNvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaW1wb3J0L2ltcG9ydGRhdGFzb3VyY2VDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9pbXBvcnQvbW9kdWxlLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaW1wb3J0L3dtc0NhcGFiaWxpdHlMYXllcnRyZWVDb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2ltcG9ydC93bXNDYXBhYmlsaXR5TGF5ZXJ0cmVlQ29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvaW1wb3J0L3dtdHNDYXBhYmlsaXR5TGF5ZXJ0cmVlQ29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9pbXBvcnQvd210c0NhcGFiaWxpdHlMYXllcnRyZWVDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2xheWVydHJlZS9TeW5jTGF5ZXJ0cmVlTWFwLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvbGF5ZXJ0cmVlL1RyZWVNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvbGF5ZXJ0cmVlL2NvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvbGF5ZXJ0cmVlL2NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2xheWVydHJlZS9kYXRhc291cmNlR3JvdXBUcmVlQ29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9sYXllcnRyZWUvZGF0YXNvdXJjZUdyb3VwVHJlZUNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2xheWVydHJlZS9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9sYXllcnRyZWUvdGltZVNsaWRlckNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL2xheWVydHJlZS90aW1lc2xpZGVyQ29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9tYXAvY29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9tYXAvY29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvbWFwL21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL21hcC9tb3VzZXBvc2l0aW9uQ29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9tYXAvbW91c2Vwb3NpdGlvbkNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3Blcm1hbGluay9QZXJtYWxpbmsuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9wZXJtYWxpbmsvU2hhcmVTZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvcGVybWFsaW5rL2Nyb3NzaGFpci5zdmciLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9wZXJtYWxpbmsvbW9kdWxlLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvcGVybWFsaW5rL3NoYXJlQ29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9wZXJtYWxpbmsvc2hhcmVDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9wcmludC9jb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3ByaW50L2NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3ByaW50L21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3Byb2ZpbGUvY29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9wcm9maWxlL2NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3Byb2ZpbGUvZHJhd0xpbmVDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9wcm9maWxlL21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3F1ZXJ5L2V4dHJhTW9kdWxlLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvcXVlcnkvZ3JpZENvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvcXVlcnkvZ3JpZENvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3F1ZXJ5L3dpbmRvd0NvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvcXVlcnkvd2luZG93Q29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvcmFzdGVyL1Jhc3RlclNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy9yYXN0ZXIvY29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvcmFzdGVyL3dpZGdldENvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvc2VhcmNoL0Z1bGx0ZXh0U2VhcmNoLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvc2VhcmNoL2NvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvc2VhcmNoL2NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3NlYXJjaC9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vLy4vY29udHJpYnMvZ21mL3NyYy90aGVtZS9NYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvdGhlbWUvVGhlbWVzLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvdGhlbWUvbW9kdWxlLmpzIiwid2VicGFjazovLy8uL2NvbnRyaWJzL2dtZi9zcmMvdGhlbWUvc2VsZWN0b3JDb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9jb250cmlicy9nbWYvc3JjL3RoZW1lL3NlbGVjdG9yQ29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AZ2VvYmxvY2tzL3Byb2ovc3JjL0VQU0dfMjA1Ni5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYW5ndWxhci1mbG9hdC10aGVhZC9hbmd1bGFyLWZsb2F0VGhlYWQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2NvcmVqcy10eXBlYWhlYWQvZGlzdC90eXBlYWhlYWQuYnVuZGxlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9jb3JlanMtdHlwZWFoZWFkL2Rpc3QvdHlwZWFoZWFkLmJ1bmRsZS5qcy1leHBvc2VkIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9jcmVhdGUvY2hlY2stb3ZlcmZsb3cuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2NyZWF0ZS9kYXRlLWZyb20tYXJyYXkuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2NyZWF0ZS9mcm9tLWFueXRoaW5nLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9jcmVhdGUvZnJvbS1hcnJheS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvY3JlYXRlL2Zyb20tb2JqZWN0LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9jcmVhdGUvZnJvbS1zdHJpbmctYW5kLWFycmF5LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9jcmVhdGUvZnJvbS1zdHJpbmctYW5kLWZvcm1hdC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvY3JlYXRlL2Zyb20tc3RyaW5nLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9jcmVhdGUvbG9jYWwuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2NyZWF0ZS9wYXJzaW5nLWZsYWdzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9jcmVhdGUvdXRjLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9jcmVhdGUvdmFsaWQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2R1cmF0aW9uL2Ficy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvZHVyYXRpb24vYWRkLXN1YnRyYWN0LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9kdXJhdGlvbi9hcy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvZHVyYXRpb24vYnViYmxlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9kdXJhdGlvbi9jbG9uZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvZHVyYXRpb24vY29uc3RydWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2R1cmF0aW9uL2NyZWF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvZHVyYXRpb24vZHVyYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2R1cmF0aW9uL2dldC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvZHVyYXRpb24vaHVtYW5pemUuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2R1cmF0aW9uL2lzby1zdHJpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2R1cmF0aW9uL3Byb3RvdHlwZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvZHVyYXRpb24vdmFsaWQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2Zvcm1hdC9mb3JtYXQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2xvY2FsZS9iYXNlLWNvbmZpZy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbG9jYWxlL2NhbGVuZGFyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9sb2NhbGUvY29uc3RydWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2xvY2FsZS9lbi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbG9jYWxlL2Zvcm1hdHMuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2xvY2FsZS9pbnZhbGlkLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9sb2NhbGUvbGlzdHMuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2xvY2FsZS9sb2NhbGUuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL2xvY2FsZS9sb2NhbGVzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9sb2NhbGUvb3JkaW5hbC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbG9jYWxlL3ByZS1wb3N0LWZvcm1hdC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbG9jYWxlL3Byb3RvdHlwZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbG9jYWxlL3JlbGF0aXZlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9sb2NhbGUvc2V0LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvYWRkLXN1YnRyYWN0LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvY2FsZW5kYXIuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL21vbWVudC9jbG9uZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbW9tZW50L2NvbXBhcmUuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL21vbWVudC9jb25zdHJ1Y3Rvci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbW9tZW50L2NyZWF0aW9uLWRhdGEuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL21vbWVudC9kaWZmLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvZm9ybWF0LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvZnJvbS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbW9tZW50L2dldC1zZXQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL21vbWVudC9sb2NhbGUuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL21vbWVudC9taW4tbWF4LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvbW9tZW50LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvbm93LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvcHJvdG90eXBlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvc3RhcnQtZW5kLW9mLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvdG8tdHlwZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvbW9tZW50L3RvLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9tb21lbnQvdmFsaWQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3BhcnNlL3JlZ2V4LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi9wYXJzZS90b2tlbi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvYWxpYXNlcy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91bml0cy9kYXktb2YtbW9udGguanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3VuaXRzL2RheS1vZi13ZWVrLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91bml0cy9kYXktb2YteWVhci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvaG91ci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvbWlsbGlzZWNvbmQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3VuaXRzL21pbnV0ZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvbW9udGguanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3VuaXRzL29mZnNldC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvcHJpb3JpdGllcy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvcXVhcnRlci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvc2Vjb25kLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91bml0cy90aW1lc3RhbXAuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3VuaXRzL3RpbWV6b25lLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91bml0cy91bml0cy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvd2Vlay1jYWxlbmRhci11dGlscy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdW5pdHMvd2Vlay15ZWFyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91bml0cy93ZWVrLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91bml0cy95ZWFyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91dGlscy9hYnMtY2VpbC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMvYWJzLWZsb29yLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91dGlscy9hYnMtcm91bmQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3V0aWxzL2NvbXBhcmUtYXJyYXlzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91dGlscy9kZWZhdWx0cy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMvZGVwcmVjYXRlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91dGlscy9leHRlbmQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3V0aWxzL2hhcy1vd24tcHJvcC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMvaG9va3MuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3V0aWxzL2luZGV4LW9mLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91dGlscy9pcy1hcnJheS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMvaXMtZGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMvaXMtZnVuY3Rpb24uanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3V0aWxzL2lzLW51bWJlci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMvaXMtb2JqZWN0LWVtcHR5LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91dGlscy9pcy1vYmplY3QuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3V0aWxzL2lzLXVuZGVmaW5lZC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMva2V5cy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMvbWFwLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL2xpYi91dGlscy9tb2QuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3V0aWxzL3NvbWUuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbWVudC9zcmMvbGliL3V0aWxzL3RvLWludC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9tZW50L3NyYy9saWIvdXRpbHMvemVyby1maWxsLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb21lbnQvc3JjL21vbWVudC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvc2V0aW1tZWRpYXRlL3NldEltbWVkaWF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdGltZXJzLWJyb3dzZXJpZnkvbWFpbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvQ3VzdG9tRXZlbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0dlb21ldHJ5VHlwZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvTWVudS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvUG9wb3Zlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvV0ZTRGVzY3JpYmVGZWF0dXJlVHlwZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYXJyYXkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RhdGFzb3VyY2UvRGF0YVNvdXJjZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZGF0YXNvdXJjZS9EYXRhU291cmNlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZGF0YXNvdXJjZS9GaWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9kYXRhc291cmNlL0ZpbGVHcm91cC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZGF0YXNvdXJjZS9Hcm91cC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZGF0YXNvdXJjZS9IZWxwZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RhdGFzb3VyY2UvT0dDLmpzIiwid2VicGFjazovLy8uL3NyYy9kYXRhc291cmNlL09HQ0dyb3VwLmpzIiwid2VicGFjazovLy8uL3NyYy9kYXRhc291cmNlL1dNU0dyb3VwLmpzIiwid2VicGFjazovLy8uL3NyYy9kb3dubG9hZC9Dc3YuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Rvd25sb2FkL3NlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RyYXcvQ29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZHJhdy9jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RyYXcvZmVhdHVyZXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RyYXcvcG9pbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RyYXcvcmVjdGFuZ2xlLmpzIiwid2VicGFjazovLy8uL3NyYy9kcmF3L3RleHQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VkaXRpbmcvYXR0cmlidXRlc0NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZWRpdGluZy9hdHRyaWJ1dGVzY29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VkaXRpbmcvY3JlYXRlZmVhdHVyZUNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZWRpdGluZy9leHBvcnRmZWF0dXJlc0NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZXZlbnRzLmpzIiwid2VicGFjazovLy8uL3NyYy9maWx0ZXIvQ29uZGl0aW9uLmpzIiwid2VicGFjazovLy8uL3NyYy9maWx0ZXIvUnVsZUhlbHBlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZmlsdGVyL2NvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL3NyYy9maWx0ZXIvY29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL3NyYy9maWx0ZXIvcnVsZUNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZmlsdGVyL3J1bGVjb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvZm9ybWF0L0FyY0dJU0dlb0pTT04uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Zvcm1hdC9BdHRyaWJ1dGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Zvcm1hdC9BdHRyaWJ1dGVUeXBlLmpzIiwid2VicGFjazovLy8uL3NyYy9mb3JtYXQvRmVhdHVyZUhhc2guanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Zvcm1hdC9GZWF0dXJlSGFzaFN0eWxlVHlwZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZm9ybWF0L0ZlYXR1cmVQcm9wZXJ0aWVzLmpzIiwid2VicGFjazovLy8uL3NyYy9mb3JtYXQvV0ZTQXR0cmlidXRlLmpzIiwid2VicGFjazovLy8uL3NyYy9mb3JtYXQvWFNEQXR0cmlidXRlLmpzIiwid2VicGFjazovLy8uL3NyYy9nZW9sb2NhdGlvbi9jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dyaWQvQ29uZmlnLmpzIiwid2VicGFjazovLy8uL3NyYy9ncmlkL2NvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL3NyYy9ncmlkL2NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaWNvbnMvcG9pbnQuc3ZnIiwid2VicGFjazovLy8uL3NyYy9pY29ucy9wb2x5Z29uLnN2ZyIsIndlYnBhY2s6Ly8vLi9zcmMvaWNvbnMvcmVjdGFuZ2xlLnN2ZyIsIndlYnBhY2s6Ly8vLi9zcmMvaWNvbnMvc3dpcGUuc3ZnPzEyODUiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ljb25zL3N3aXBlLnN2ZyIsIndlYnBhY2s6Ly8vLi9zcmMvaW50ZXJhY3Rpb24vRHJhd0F6aW11dC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW50ZXJhY3Rpb24vTWVhc3VyZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW50ZXJhY3Rpb24vTWVhc3VyZUFyZWEuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ludGVyYWN0aW9uL01lYXN1cmVBemltdXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ludGVyYWN0aW9uL01lYXN1cmVMZW5ndGguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ludGVyYWN0aW9uL01vZGlmeS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW50ZXJhY3Rpb24vTW9kaWZ5Q2lyY2xlLmpzIiwid2VicGFjazovLy8uL3NyYy9pbnRlcmFjdGlvbi9Nb2RpZnlSZWN0YW5nbGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ludGVyYWN0aW9uL1JvdGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW50ZXJhY3Rpb24vVHJhbnNsYXRlLmpzIiwid2VicGFjazovLy8uL3NyYy9pbnRlcmFjdGlvbi9jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2xheWVydHJlZS9Db250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9sYXllcnRyZWUvY29tcG9uZW50Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL2xheWVydHJlZS9jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21hcC9CYWNrZ3JvdW5kTGF5ZXJNZ3IuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21hcC9GZWF0dXJlT3ZlcmxheS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFwL0ZlYXR1cmVPdmVybGF5TWdyLmpzIiwid2VicGFjazovLy8uL3NyYy9tYXAvTGF5ZXJIZWxwZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21hcC9jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21hcC9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21hcC9yZWNlbnRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFwL3Jlc2l6ZW1hcC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFwL3NjYWxlc2VsZWN0b3IuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvbWFwL3NjYWxlc2VsZWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21hcC9zd2lwZS5odG1sIiwid2VicGFjazovLy8uL3NyYy9tYXAvc3dpcGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21lYXN1cmUvYXJlYS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWVhc3VyZS9hemltdXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21lYXN1cmUvbGVuZ3RoLmpzIiwid2VicGFjazovLy8uL3NyYy9tZXNzYWdlL0Rpc2NsYWltZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21lc3NhZ2UvTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWVzc2FnZS9Ob3RpZmljYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21lc3NhZ2UvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21lc3NhZ2UvZGlzcGxheXdpbmRvd0NvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL3NyYy9tZXNzYWdlL2Rpc3BsYXl3aW5kb3dDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21lc3NhZ2UvbW9kYWxDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21lc3NhZ2UvcG9wb3ZlckNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWVzc2FnZS9wb3B1cENvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWVzc2FnZS9wb3B1cGNvbXBvbmVudC5odG1sIiwid2VicGFjazovLy8uL3NyYy9taXNjL0F1dG9Qcm9qZWN0aW9uLmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL0V2ZW50SGVscGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL0ZlYXR1cmVIZWxwZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21pc2MvRmlsZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWlzYy9UaW1lLmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL1Rvb2xBY3RpdmF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWlzYy9Ub29sQWN0aXZhdGVNZ3IuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21pc2MvV01TVGltZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWlzYy9idG5Db21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21pc2MvY29sb3JwaWNrZXJDb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvbWlzYy9jb2xvcnBpY2tlckNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWlzYy9jb250cm9sQ29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL2RhdGVwaWNrZXJDb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvbWlzYy9kYXRlcGlja2VyQ29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL2RhdGV0aW1lcGlja2VyQ29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL2RlYm91bmNlLmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL2RlY29yYXRlLmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL2V4dHJhTW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9taXNjL2ZpbGVyZWFkZXJDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21pc2MvZmlsdGVycy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWlzYy9waHAtZGF0ZS1mb3JtYXR0ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21pc2Mvc29ydGFibGVDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21pc2Mvc3dpcGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21pc2Mvc3luY0FycmF5cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvb2xjcy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ByaW50L01hc2suanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ByaW50L1NlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ByaW50L1V0aWxzLmpzIiwid2VicGFjazovLy8uL3NyYy9wcmludC9WZWN0b3JFbmNvZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9wcm9maWxlL2QzRWxldmF0aW9uLmpzIiwid2VicGFjazovLy8uL3NyYy9wcm9maWxlL2VsZXZhdGlvbkNvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlcnkvQWN0aW9uLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVyeS9NYXBRdWVyZW50LmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVyeS9Nb2RlLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVyeS9Nb2RlU2VsZWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXJ5L1F1ZXJlbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXJ5L2NvbXBvbmVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlcnkvcGFuZWxDb21wb25lbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlcnkvcGFuZWxDb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3J1bGUvRGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcnVsZS9HZW9tZXRyeS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcnVsZS9SdWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9ydWxlL1NlbGVjdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcnVsZS9UZXh0LmpzIiwid2VicGFjazovLy8uL3NyYy9zZWFyY2gvY3JlYXRlR2VvSlNPTkJsb29kaG91bmQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NlYXJjaC9jcmVhdGVMb2NhdGlvblNlYXJjaEJsb29kaG91bmQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NlYXJjaC9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NlYXJjaC9zZWFyY2hEaXJlY3RpdmUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0YXRlbWFuYWdlci9Mb2NhdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3RhdGVtYW5hZ2VyL1NlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0YXRlbWFuYWdlci9XZnNQZXJtYWxpbmsuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0YXRlbWFuYWdlci9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vY29udHJpYnMvZ21mL2FwcHMvZGVza3RvcC9Db250cm9sbGVyLmpzXCIpO1xuIiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBkZWNvZGVRdWVyeVN0cmluZyB9IGZyb20gJ25nZW8vdXRpbHMuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXSk7XG5tb2R1bGUuY29uZmlnKFsnJGNvbXBpbGVQcm92aWRlcicsIGZ1bmN0aW9uICgkY29tcGlsZVByb3ZpZGVyKSB7XG4gIGlmICghKCdkZWJ1ZycgaW4gZGVjb2RlUXVlcnlTdHJpbmcod2luZG93LmxvY2F0aW9uLnNlYXJjaCkpKSB7XG4gICAgJGNvbXBpbGVQcm92aWRlci5kZWJ1Z0luZm9FbmFibGVkKGZhbHNlKTtcbiAgfVxufV0pO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgJy4vc2Fzcy9kZXNrdG9wLnNjc3MnO1xuaW1wb3J0ICdnbWYvY29udHJvbGxlcnMvZGVza3RvcC5zY3NzJztcbmltcG9ydCAnLi9zYXNzL3ZhcnNfZGVza3RvcC5zY3NzJztcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IGdtZkNvbnRyb2xsZXJzQWJzdHJhY3REZXNrdG9wQ29udHJvbGxlciwgeyBBYnN0cmFjdERlc2t0b3BDb250cm9sbGVyIH0gZnJvbSAnZ21mL2NvbnRyb2xsZXJzL0Fic3RyYWN0RGVza3RvcENvbnRyb2xsZXIuanMnO1xuaW1wb3J0IGFwcEJhc2UgZnJvbSAnLi4vYXBwbW9kdWxlLmpzJztcbmltcG9ydCBFUFNHMjA1NiBmcm9tICdAZ2VvYmxvY2tzL3Byb2ovc3JjL0VQU0dfMjA1Ni5qcyc7XG5pbXBvcnQgRVBTRzIxNzgxIGZyb20gJ0BnZW9ibG9ja3MvcHJvai9zcmMvRVBTR18yMTc4MS5qcyc7XG5cbmlmICghd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSkge1xuICBhbGVydCgnWW91ciBicm93c2VyIGlzIG5vdCBzdXBwb3J0ZWQsIHBsZWFzZSB1cGRhdGUgaXQgb3IgdXNlIGFub3RoZXIgb25lLiBZb3Ugd2lsbCBiZSByZWRpcmVjdGVkLlxcblxcbicgKyAnVm90cmUgbmF2aWdhdGV1ciBuXFwnZXN0IHBhcyBzdXBwb3J0w6ksIHZldWlsbGV6IGxlIG1ldHRyZSDDoCBqb3VyIG91IGVuIHV0aWxpc2VyIHVuIGF1dHJlLiAnICsgJ1ZvdXMgYWxsZXogw6p0cmUgcmVkaXJpZ8OpLlxcblxcbicgKyAnSWhyIEJyb3dzZXIgd2lyZCBuaWNodCB1bnRlcnN0w7x0enQsIGJpdHRlIGFrdHVhbGlzaWVyZW4gU2llIGlobiBvZGVyIHZlcndlbmRlbiBTaWUgZWluZW4gYW5kZXJlbi4gJyArICdTaWUgd2VyZGVuIHdlaXRlcmdlbGVpdGV0LicpO1xuICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICdodHRwczovL2dlb21hcGZpc2gub3JnLyc7XG59XG5cbnZhciBDb250cm9sbGVyID0gZnVuY3Rpb24gKF9BYnN0cmFjdERlc2t0b3BDb250cikge1xuICBDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkaW5qZWN0b3JcIl07XG5cbiAgX2luaGVyaXRzTG9vc2UoQ29udHJvbGxlciwgX0Fic3RyYWN0RGVza3RvcENvbnRyKTtcblxuICBmdW5jdGlvbiBDb250cm9sbGVyKCRzY29wZSwgJGluamVjdG9yKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX3RoaXMgPSBfQWJzdHJhY3REZXNrdG9wQ29udHIuY2FsbCh0aGlzLCB7XG4gICAgICBzcmlkOiAyMDU2LFxuICAgICAgbWFwVmlld0NvbmZpZzoge1xuICAgICAgICBjZW50ZXI6IFsyNjMyNDY0LCAxMTg1NDU3XSxcbiAgICAgICAgem9vbTogMyxcbiAgICAgICAgcmVzb2x1dGlvbnM6IFsyNTAsIDEwMCwgNTAsIDIwLCAxMCwgNSwgMiwgMSwgMC41LCAwLjI1LCAwLjEsIDAuMDVdLFxuICAgICAgICBjb25zdHJhaW5SZXNvbHV0aW9uOiB0cnVlLFxuICAgICAgICBleHRlbnQ6IFsyNDg1MDcxLjU0LCAxNzUzNDYuMzYsIDI4Mjg1MTUuNzgsIDEyOTk5NDEuODRdXG4gICAgICB9XG4gICAgfSwgJHNjb3BlLCAkaW5qZWN0b3IpIHx8IHRoaXM7XG4gICAgX3RoaXMuc2VhcmNoQ29vcmRpbmF0ZXNQcm9qZWN0aW9ucyA9IFtFUFNHMjE3ODEsIEVQU0cyMDU2LCAnRVBTRzo0MzI2J107XG4gICAgX3RoaXMuc2NhbGVTZWxlY3RvclZhbHVlcyA9IFsyNTAwMDAsIDEwMDAwMCwgNTAwMDAsIDIwMDAwLCAxMDAwMCwgNTAwMCwgMjAwMCwgMTAwMCwgNTAwLCAyNTAsIDEwMCwgNTBdO1xuICAgIF90aGlzLmVsZXZhdGlvbkxheWVycyA9IFsnYXN0ZXInLCAnc3J0bSddO1xuICAgIF90aGlzLmVsZXZhdGlvbkxheWVyc0NvbmZpZyA9IHt9O1xuICAgIF90aGlzLnNlbGVjdGVkRWxldmF0aW9uTGF5ZXIgPSBfdGhpcy5lbGV2YXRpb25MYXllcnNbMF07XG4gICAgX3RoaXMucHJvZmlsZUxpbmVzY29uZmlndXJhdGlvbiA9IHtcbiAgICAgICdhc3Rlcic6IHtcbiAgICAgICAgY29sb3I6ICcjMDAwMEEwJ1xuICAgICAgfSxcbiAgICAgICdzcnRtJzoge1xuICAgICAgICBjb2xvcjogJyMwMEEwMDAnXG4gICAgICB9XG4gICAgfTtcbiAgICBfdGhpcy5tb3VzZVBvc2l0aW9uUHJvamVjdGlvbnMgPSBbe1xuICAgICAgY29kZTogRVBTRzIwNTYsXG4gICAgICBsYWJlbDogJ0NIMTkwMysgLyBMVjk1JyxcbiAgICAgIGZpbHRlcjogJ25nZW9OdW1iZXJDb29yZGluYXRlczo6e3h9LCB7eX0gbSdcbiAgICB9LCB7XG4gICAgICBjb2RlOiBFUFNHMjE3ODEsXG4gICAgICBsYWJlbDogJ0NIMTkwMyAvIExWMDMnLFxuICAgICAgZmlsdGVyOiAnbmdlb051bWJlckNvb3JkaW5hdGVzOjp7eH0sIHt5fSBtJ1xuICAgIH0sIHtcbiAgICAgIGNvZGU6ICdFUFNHOjQzMjYnLFxuICAgICAgbGFiZWw6ICdXR1M4NCcsXG4gICAgICBmaWx0ZXI6ICduZ2VvRE1TQ29vcmRpbmF0ZXM6MidcbiAgICB9XTtcbiAgICB2YXIgZ2V0dGV4dENhdGFsb2cgPSAkaW5qZWN0b3IuZ2V0KCdnZXR0ZXh0Q2F0YWxvZycpO1xuICAgIGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQWRkIGEgdGhlbWUnKTtcbiAgICBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0FkZCBhIHN1YiB0aGVtZScpO1xuICAgIGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQWRkIGEgbGF5ZXInKTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gQ29udHJvbGxlcjtcbn0oQWJzdHJhY3REZXNrdG9wQ29udHJvbGxlcik7XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnQXBwZGVza3RvcCcsIFthcHBCYXNlLm5hbWUsIGdtZkNvbnRyb2xsZXJzQWJzdHJhY3REZXNrdG9wQ29udHJvbGxlci5uYW1lXSk7XG5tb2R1bGUudmFsdWUoJ2dtZkNvbnRleHR1YWxkYXRhY29udGVudFRlbXBsYXRlVXJsJywgJ2dtZi9jb250ZXh0dWFsZGF0YScpO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdnbWYvY29udGV4dHVhbGRhdGEnLCByZXF1aXJlKCcuL2NvbnRleHR1YWxkYXRhLmh0bWwnKSk7XG59XSk7XG5tb2R1bGUuY29udHJvbGxlcignRGVza3RvcENvbnRyb2xsZXInLCBDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaikge1xub2JqIHx8IChvYmogPSB7fSk7XG52YXIgX190LCBfX3AgPSAnJztcbndpdGggKG9iaikge1xuX19wICs9ICc8dGFibGU+XFxuICA8dHI+XFxuICAgIDx0ZCB0cmFuc2xhdGU+XFxuICAgICAgU3dpc3MgZ3JpZCAoTFY5NSlcXG4gICAgPC90ZD5cXG4gICAgPHRkPlxcbiAgICAgIHt7Y29vcmRfMjA1NnxuZ2VvTnVtYmVyQ29vcmRpbmF0ZXM6MDpcXCd7eH0gLyB7eX1cXCd9fVxcbiAgICA8L3RkPlxcbiAgPC90cj5cXG4gIDx0cj5cXG4gICAgPHRkIHRyYW5zbGF0ZT5cXG4gICAgICBTd2lzcyBncmlkIChMVjAzKVxcbiAgICA8L3RkPlxcbiAgICA8dGQ+XFxuICAgICAge3tjb29yZF8yMTc4MXxuZ2VvTnVtYmVyQ29vcmRpbmF0ZXM6MDpcXCd7eH0gLyB7eX1cXCd9fVxcbiAgICA8L3RkPlxcbiAgPC90cj5cXG4gIDx0cj5cXG4gICAgPHRkIHRyYW5zbGF0ZT5cXG4gICAgICBXZ3MgQ29vcmQuXFxuICAgIDwvdGQ+XFxuICAgIDx0ZD5cXG4gICAgICB7e2Nvb3JkXzQzMjZ8bmdlb051bWJlckNvb3JkaW5hdGVzOjI6XFwne3l9IC8ge3h9XFwnfX1cXG4gICAgPC90ZD5cXG4gIDwvdHI+XFxuICA8dHI+XFxuICAgIDx0ZCB0cmFuc2xhdGU+XFxuICAgICAgV2dzIENvb3JkLiBETVNcXG4gICAgPC90ZD5cXG4gICAgPHRkPlxcbiAgICAgIHt7Y29vcmRfNDMyNnxuZ2VvRE1TQ29vcmRpbmF0ZXM6MDpcXCd7eX0ge3h9XFwnfX1cXG4gICAgPC90ZD5cXG4gIDwvdHI+XFxuICA8dHI+XFxuICAgIDx0ZCB0cmFuc2xhdGU+XFxuICAgICAgRWxldmF0aW9uIChTUlRNKVxcbiAgICA8L3RkPlxcbiAgICA8dGQgbmctaWY9XCJzcnRtXCI+XFxuICAgICAge3tzcnRtIHwgbnVtYmVyfX0gW21dXFxuICAgIDwvdGQ+XFxuICA8L3RyPlxcbiAgPHRyPlxcbiAgICA8dGQgdHJhbnNsYXRlPlxcbiAgICAgIEVsZXZhdGlvbiAoQXN0ZXIpXFxuICAgIDwvdGQ+XFxuICAgIDx0ZCBuZy1pZj1cImFzdGVyXCI+XFxuICAgICAge3thc3RlciB8IG51bWJlcn19IFttXVxcbiAgICA8L3RkPlxcbiAgPC90cj5cXG48L3RhYmxlPlxcbjxhIG5nLWhyZWY9XCJodHRwczovL21hcHMuZ29vZ2xlLmNoLz9pZT1VVEY4JmxsPXt7Y29vcmRfNDMyNl9ub3J0aGVybn19LHt7Y29vcmRfNDMyNl9lYXN0ZXJufX0mbGF5ZXI9YyZjYmxsPXt7Y29vcmRfNDMyNl9ub3J0aGVybn19LHt7Y29vcmRfNDMyNl9lYXN0ZXJufX0mY2JwPTEyLDU3Ljc4LCwwLDguMVwiIHRhcmdldD1cIl9ibGFua1wiPkdvb2dsZSBTdHJlZXRWaWV3PC9hPlxcbic7XG5cbn1cbnJldHVybiBfX3Bcbn0iLCJmdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb0N1c3RvbUV2ZW50IGZyb20gJ25nZW8vQ3VzdG9tRXZlbnQuanMnO1xuaW1wb3J0IG9sRXZlbnRzRXZlbnRUYXJnZXQgZnJvbSAnb2wvZXZlbnRzL1RhcmdldC5qcyc7XG5pbXBvcnQgKiBhcyBTZW50cnkgZnJvbSAnQHNlbnRyeS9icm93c2VyJztcbmV4cG9ydCB2YXIgUm91dGVTdWZmaXggPSB7XG4gIENIQU5HRV9QQVNTV09SRDogJ2xvZ2luY2hhbmdlcGFzc3dvcmQnLFxuICBJU19MT0dHRURfSU46ICdsb2dpbnVzZXInLFxuICBMT0dJTjogJ2xvZ2luJyxcbiAgTE9HT1VUOiAnbG9nb3V0JyxcbiAgUkVTRVRfUEFTU1dPUkQ6ICdsb2dpbnJlc2V0cGFzc3dvcmQnXG59O1xuZXhwb3J0IHZhciBBdXRoZW50aWNhdGlvblNlcnZpY2UgPSBmdW5jdGlvbiAoX29sRXZlbnRzRXZlbnRUYXJnZXQpIHtcbiAgQXV0aGVudGljYXRpb25TZXJ2aWNlLiRpbmplY3QgPSBbXCIkaHR0cFwiLCBcIiRpbmplY3RvclwiLCBcIiRyb290U2NvcGVcIiwgXCJhdXRoZW50aWNhdGlvbkJhc2VVcmxcIiwgXCJnbWZVc2VyXCJdO1xuXG4gIF9pbmhlcml0c0xvb3NlKEF1dGhlbnRpY2F0aW9uU2VydmljZSwgX29sRXZlbnRzRXZlbnRUYXJnZXQpO1xuXG4gIGZ1bmN0aW9uIEF1dGhlbnRpY2F0aW9uU2VydmljZSgkaHR0cCwgJGluamVjdG9yLCAkcm9vdFNjb3BlLCBhdXRoZW50aWNhdGlvbkJhc2VVcmwsIGdtZlVzZXIpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfdGhpcyA9IF9vbEV2ZW50c0V2ZW50VGFyZ2V0LmNhbGwodGhpcykgfHwgdGhpcztcbiAgICBfdGhpcy4kaHR0cF8gPSAkaHR0cDtcbiAgICBfdGhpcy4kcm9vdFNjb3BlXyA9ICRyb290U2NvcGU7XG4gICAgX3RoaXMuYmFzZVVybF8gPSBhdXRoZW50aWNhdGlvbkJhc2VVcmwucmVwbGFjZSgvXFwvJC8sICcnKTtcbiAgICBfdGhpcy51c2VyXyA9IGdtZlVzZXI7XG4gICAgX3RoaXMubm9SZWxvYWRSb2xlXyA9ICRpbmplY3Rvci5oYXMoJ2dtZkF1dGhlbnRpY2F0aW9uTm9SZWxvYWRSb2xlJykgPyAkaW5qZWN0b3IuZ2V0KCdnbWZBdXRoZW50aWNhdGlvbk5vUmVsb2FkUm9sZScpIDogbnVsbDtcblxuICAgIF90aGlzLmxvYWRfKCk7XG5cbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gQXV0aGVudGljYXRpb25TZXJ2aWNlLnByb3RvdHlwZTtcblxuICBfcHJvdG8ubG9hZF8gPSBmdW5jdGlvbiBsb2FkXygpIHtcbiAgICB2YXIgdXJsID0gdGhpcy5iYXNlVXJsXyArIFwiL1wiICsgUm91dGVTdWZmaXguSVNfTE9HR0VEX0lOO1xuICAgIHRoaXMuJGh0dHBfLmdldCh1cmwsIHtcbiAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZVxuICAgIH0pLnRoZW4odGhpcy5oYW5kbGVMb2dpbl8uYmluZCh0aGlzLCB0cnVlKSk7XG4gIH07XG5cbiAgX3Byb3RvLmNoYW5nZVBhc3N3b3JkID0gZnVuY3Rpb24gY2hhbmdlUGFzc3dvcmQobG9naW4sIG9sZFB3ZCwgbmV3UHdkLCBjb25mUHdkLCBvdHApIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIGlmIChvdHAgPT09IHZvaWQgMCkge1xuICAgICAgb3RwID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHZhciB1cmwgPSB0aGlzLmJhc2VVcmxfICsgXCIvXCIgKyBSb3V0ZVN1ZmZpeC5DSEFOR0VfUEFTU1dPUkQ7XG4gICAgcmV0dXJuIHRoaXMuJGh0dHBfLnBvc3QodXJsLCAkLnBhcmFtKHtcbiAgICAgICdsb2dpbic6IGxvZ2luLFxuICAgICAgJ29sZFBhc3N3b3JkJzogb2xkUHdkLFxuICAgICAgJ290cCc6IG90cCxcbiAgICAgICduZXdQYXNzd29yZCc6IG5ld1B3ZCxcbiAgICAgICdjb25maXJtTmV3UGFzc3dvcmQnOiBjb25mUHdkXG4gICAgfSksIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXG4gICAgICB9LFxuICAgICAgd2l0aENyZWRlbnRpYWxzOiB0cnVlXG4gICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpczIudXNlcl8uaXNfcGFzc3dvcmRfY2hhbmdlZCA9IHRydWU7XG4gICAgICB2YXIgZXZlbnQgPSBuZXcgbmdlb0N1c3RvbUV2ZW50KCdyZWFkeScsIHtcbiAgICAgICAgdXNlcjogX3RoaXMyLnVzZXJfXG4gICAgICB9KTtcblxuICAgICAgX3RoaXMyLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5sb2dpbiA9IGZ1bmN0aW9uIGxvZ2luKF9sb2dpbiwgcHdkLCBvdHApIHtcbiAgICBpZiAob3RwID09PSB2b2lkIDApIHtcbiAgICAgIG90cCA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgdXJsID0gdGhpcy5iYXNlVXJsXyArIFwiL1wiICsgUm91dGVTdWZmaXguTE9HSU47XG4gICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICdsb2dpbic6IF9sb2dpbixcbiAgICAgICdwYXNzd29yZCc6IHB3ZFxuICAgIH07XG5cbiAgICBpZiAob3RwKSB7XG4gICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywge1xuICAgICAgICAnb3RwJzogb3RwXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy4kaHR0cF8ucG9zdCh1cmwsICQucGFyYW0ocGFyYW1zKSwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICAgIH0sXG4gICAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWVcbiAgICB9KS50aGVuKHRoaXMuaGFuZGxlTG9naW5fLmJpbmQodGhpcywgZmFsc2UpKTtcbiAgfTtcblxuICBfcHJvdG8ubG9nb3V0ID0gZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdmFyIG5vUmVsb2FkID0gdGhpcy5ub1JlbG9hZFJvbGVfID8gdGhpcy5nZXRSb2xlc05hbWVzKCkuaW5jbHVkZXModGhpcy5ub1JlbG9hZFJvbGVfKSA6IGZhbHNlO1xuICAgIHZhciB1cmwgPSB0aGlzLmJhc2VVcmxfICsgXCIvXCIgKyBSb3V0ZVN1ZmZpeC5MT0dPVVQ7XG4gICAgcmV0dXJuIHRoaXMuJGh0dHBfLmdldCh1cmwsIHtcbiAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZVxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMzLnJlc2V0VXNlcl8obm9SZWxvYWQpO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5yZXNldFBhc3N3b3JkID0gZnVuY3Rpb24gcmVzZXRQYXNzd29yZChsb2dpbikge1xuICAgIHZhciB1cmwgPSB0aGlzLmJhc2VVcmxfICsgXCIvXCIgKyBSb3V0ZVN1ZmZpeC5SRVNFVF9QQVNTV09SRDtcbiAgICByZXR1cm4gdGhpcy4kaHR0cF8ucG9zdCh1cmwsICQucGFyYW0oe1xuICAgICAgJ2xvZ2luJzogbG9naW5cbiAgICB9KSwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICAgIH1cbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICByZXR1cm4gcmVzcC5kYXRhO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5nZXRFbWFpbCA9IGZ1bmN0aW9uIGdldEVtYWlsKCkge1xuICAgIHJldHVybiB0aGlzLnVzZXJfLmVtYWlsIHx8IG51bGw7XG4gIH07XG5cbiAgX3Byb3RvLmdldFJvbGVzSWRzID0gZnVuY3Rpb24gZ2V0Um9sZXNJZHMoKSB7XG4gICAgcmV0dXJuIHRoaXMudXNlcl8ucm9sZXMgPyB0aGlzLnVzZXJfLnJvbGVzLm1hcChmdW5jdGlvbiAocm9sZSkge1xuICAgICAgcmV0dXJuIHJvbGUuaWQ7XG4gICAgfSkgOiBbXTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0Um9sZXNOYW1lcyA9IGZ1bmN0aW9uIGdldFJvbGVzTmFtZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMudXNlcl8ucm9sZXMgPyB0aGlzLnVzZXJfLnJvbGVzLm1hcChmdW5jdGlvbiAocm9sZSkge1xuICAgICAgcmV0dXJuIHJvbGUubmFtZTtcbiAgICB9KSA6IFtdO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVMb2dpbl8gPSBmdW5jdGlvbiBoYW5kbGVMb2dpbl8oY2hlY2tpbmdMb2dpblN0YXR1cywgcmVzcCkge1xuICAgIHRoaXMuc2V0VXNlcl8ocmVzcC5kYXRhLCAhY2hlY2tpbmdMb2dpblN0YXR1cyk7XG5cbiAgICBpZiAoY2hlY2tpbmdMb2dpblN0YXR1cykge1xuICAgICAgdmFyIGV2ZW50ID0gbmV3IG5nZW9DdXN0b21FdmVudCgncmVhZHknLCB7XG4gICAgICAgIHVzZXI6IHRoaXMudXNlcl9cbiAgICAgIH0pO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzcDtcbiAgfTtcblxuICBfcHJvdG8uc2V0VXNlcl8gPSBmdW5jdGlvbiBzZXRVc2VyXyhyZXNwRGF0YSwgZW1pdEV2ZW50KSB7XG4gICAgU2VudHJ5LnNldFVzZXIoe1xuICAgICAgdXNlcm5hbWU6IHJlc3BEYXRhLnVzZXJuYW1lXG4gICAgfSk7XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy51c2VyXykge1xuICAgICAgdGhpcy51c2VyX1trZXldID0gbnVsbDtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBfa2V5IGluIHJlc3BEYXRhKSB7XG4gICAgICB0aGlzLnVzZXJfW19rZXldID0gcmVzcERhdGFbX2tleV07XG4gICAgfVxuXG4gICAgaWYgKGVtaXRFdmVudCAmJiByZXNwRGF0YS51c2VybmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YXIgZXZlbnQgPSBuZXcgbmdlb0N1c3RvbUV2ZW50KCdsb2dpbicsIHtcbiAgICAgICAgdXNlcjogdGhpcy51c2VyX1xuICAgICAgfSk7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ucmVzZXRVc2VyXyA9IGZ1bmN0aW9uIHJlc2V0VXNlcl8obm9SZWxvYWQpIHtcbiAgICBub1JlbG9hZCA9IG5vUmVsb2FkIHx8IGZhbHNlO1xuXG4gICAgZm9yICh2YXIga2V5IGluIHRoaXMudXNlcl8pIHtcbiAgICAgIHRoaXMudXNlcl9ba2V5XSA9IG51bGw7XG4gICAgfVxuXG4gICAgdmFyIGV2ZW50ID0gbmV3IG5nZW9DdXN0b21FdmVudCgnbG9nb3V0Jywge1xuICAgICAgdXNlcjogdGhpcy51c2VyX1xuICAgIH0pO1xuICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cbiAgICBpZiAoIW5vUmVsb2FkKSB7XG4gICAgICB0aGlzLmxvYWRfKCk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBBdXRoZW50aWNhdGlvblNlcnZpY2U7XG59KG9sRXZlbnRzRXZlbnRUYXJnZXQpO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZBdXRoZW50aWNhdGlvblNlcnZpY2UnLCBbXSk7XG5tb2R1bGUuc2VydmljZSgnZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlJywgQXV0aGVudGljYXRpb25TZXJ2aWNlKTtcbm1vZHVsZS52YWx1ZSgnZ21mVXNlcicsIHtcbiAgZnVuY3Rpb25hbGl0aWVzOiBudWxsLFxuICBpc19wYXNzd29yZF9jaGFuZ2VkOiBudWxsLFxuICByb2xlczogbnVsbCxcbiAgdXNlcm5hbWU6IG51bGxcbn0pO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXYgbmctaWY9XCIkY3RybC5nbWZVc2VyLmlzX2ludHJhbmV0XCI+XFxuICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxcbiAgICA8c3Bhbj57e1xcJ1lvdSBhcmUgcmVjb2duaXplZCBhcyBhbiBpbnRyYW5ldCB1c2VyLlxcJyB8IHRyYW5zbGF0ZX19PC9zcGFuPlxcbiAgPC9kaXY+XFxuPC9kaXY+XFxuPGRpdiBuZy1pZj1cIiRjdHJsLmdtZlVzZXIudXNlcm5hbWVcIj5cXG4gIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgIDxzcGFuPnt7XFwnTG9nZ2VkIGluIGFzXFwnIHwgdHJhbnNsYXRlfX08L3NwYW4+XFxuICAgIDxzdHJvbmc+e3sgOjokY3RybC5nbWZVc2VyLnVzZXJuYW1lIH19PC9zdHJvbmc+LlxcbiAgPC9kaXY+XFxuXFxuICA8Zm9ybVxcbiAgICAgIG5hbWU9XCJsb2dvdXRGb3JtXCJcXG4gICAgICByb2xlPVwiZm9ybVwiXFxuICAgICAgbmctc3VibWl0PVwiJGN0cmwubG9nb3V0KClcIlxcbiAgICAgIG5nLWNvbnRyb2xsZXI9XCJHbWZBdXRoZW50aWNhdGlvbkNvbnRyb2xsZXJcIlxcbiAgICAgIG5nLWNsYXNzPVwie1xcJ2hhcy1lcnJvclxcJzogJGN0cmwuZXJyb3J9XCJcXG4gICAgICBuZy1pZj1cIiEkY3RybC5jaGFuZ2luZ1Bhc3N3b3JkXCI+XFxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGlucHV0XFxuICAgICAgICAgIHR5cGU9XCJzdWJtaXRcIlxcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbCBidG4gcHJpbWVcIlxcbiAgICAgICAgICB2YWx1ZT1cInt7XFwnTG9nb3V0XFwnIHwgdHJhbnNsYXRlfX1cIiAvPlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cXG4gICAgPGlucHV0XFxuICAgICAgICBuZy1zaG93PVwiJGN0cmwuYWxsb3dQYXNzd29yZENoYW5nZVwiXFxuICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXG4gICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sIGJ0biBidG4tZGVmYXVsdFwiXFxuICAgICAgICB2YWx1ZT1cInt7XFwnQ2hhbmdlIHBhc3N3b3JkXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICAgICAgbmctY2xpY2s9XCIkY3RybC5jaGFuZ2luZ1Bhc3N3b3JkID0gdHJ1ZVwiLz5cXG4gICAgPC9kaXY+XFxuICA8L2Zvcm0+XFxuXFxuICA8Zm9ybVxcbiAgICAgIG5hbWU9XCJjaGFuZ2VQYXNzd29yZEZvcm1cIlxcbiAgICAgIHJvbGU9XCJmb3JtXCJcXG4gICAgICBuZy1zdWJtaXQ9XCIkY3RybC5jaGFuZ2VQYXNzd29yZCgpXCJcXG4gICAgICBuZy1jb250cm9sbGVyPVwiR21mQXV0aGVudGljYXRpb25Db250cm9sbGVyXCJcXG4gICAgICBuZy1jbGFzcz1cIntcXCdoYXMtZXJyb3JcXCc6ICRjdHJsLmVycm9yfVwiXFxuICAgICAgbmctaWY9XCIkY3RybC5jaGFuZ2luZ1Bhc3N3b3JkXCI+XFxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGlucHV0XFxuICAgICAgICAgIHR5cGU9XCJwYXNzd29yZFwiXFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgbmFtZT1cIm9sZHBhc3N3b3JkXCJcXG4gICAgICAgICAgbmctbW9kZWw9XCIkY3RybC5vbGRQd2RWYWxcIlxcbiAgICAgICAgICBuZy1hdHRyLXBsYWNlaG9sZGVyPVwie3tcXCdPbGQgcGFzc3dvcmRcXCcgfCB0cmFuc2xhdGV9fVwiLz5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGlucHV0XFxuICAgICAgICAgIHR5cGU9XCJwYXNzd29yZFwiXFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgbmFtZT1cIm5ld3Bhc3N3b3JkXCJcXG4gICAgICAgICAgbmctbW9kZWw9XCIkY3RybC5uZXdQd2RWYWxcIlxcbiAgICAgICAgICBuZy1hdHRyLXBsYWNlaG9sZGVyPVwie3tcXCdOZXcgcGFzc3dvcmRcXCcgfCB0cmFuc2xhdGV9fVwiLz5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGlucHV0XFxuICAgICAgICAgIHR5cGU9XCJwYXNzd29yZFwiXFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgbmFtZT1cIm5ld3Bhc3N3b3JkY29uZmlybVwiXFxuICAgICAgICAgIG5nLW1vZGVsPVwiJGN0cmwubmV3UHdkQ29uZlZhbFwiXFxuICAgICAgICAgIG5nLWF0dHItcGxhY2Vob2xkZXI9XCJ7e1xcJ0NvbmZpcm0gbmV3IHBhc3N3b3JkXFwnIHwgdHJhbnNsYXRlfX1cIi8+XFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IG5nLWlmPVwiJGN0cmwuZ21mVXNlci5vdHBfdXJpXCIgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGxhYmVsIHRyYW5zbGF0ZT5Ud28gZmFjdG9yIGF1dGhlbnRpY2F0aW9uIGJhcmNvZGU6PC9sYWJlbD5cXG4gICAgICA8ZGl2PjxpbWcgY2xhc3M9XCJcIiBuZy1zcmM9XCJ7eyRjdHJsLm90cEltYWdlfX1cIj48L2Rpdj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgbmctaWY9XCIkY3RybC5nbWZVc2VyLnR3b19mYWN0b3JfdG90cF9zZWNyZXRcIiBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cXG4gICAgICA8bGFiZWwgdHJhbnNsYXRlPlR3byBmYWN0b3IgYXV0aGVudGljYXRpb24ga2V5OjwvbGFiZWw+XFxuICAgICAgPGNvZGU+e3skY3RybC5nbWZVc2VyLnR3b19mYWN0b3JfdG90cF9zZWNyZXR9fTwvY29kZT5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgbmctaWY9XCIkY3RybC50d29GYWN0b3JBdXRoXCIgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGlucHV0XFxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcXG4gICAgICAgICAgYXV0b2NvbXBsZXRlPVwib2ZmXCJcXG4gICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICAgICAgICBuYW1lPVwib3RwXCJcXG4gICAgICAgICAgbmctbW9kZWw9XCIkY3RybC5vdHBWYWxcIlxcbiAgICAgICAgICBuZy1hdHRyLXBsYWNlaG9sZGVyPVwie3tcXCdBdXRoZW50aWNhdGlvbiBjb2RlXFwnIHwgdHJhbnNsYXRlfX1cIi8+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cXG4gICAgICA8aW5wdXRcXG4gICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sIGJ0biBwcmltZVwiXFxuICAgICAgICAgIHZhbHVlPVwie3tcXCdDaGFuZ2UgcGFzc3dvcmRcXCcgfCB0cmFuc2xhdGV9fVwiIC8+XFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2wgYnRuIGJ0bi1kZWZhdWx0XCJcXG4gICAgICAgICAgdmFsdWU9XCJ7e1xcJ0NhbmNlbFxcJyB8IHRyYW5zbGF0ZX19XCJcXG4gICAgICAgICAgbmctaWY9XCIhJGN0cmwudXNlck11c3RDaGFuZ2VJdHNQYXNzd29yZFwiXFxuICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuY2hhbmdlUGFzc3dvcmRSZXNldCgpXCIgLz5cXG4gICAgICA8aW5wdXRcXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sIGJ0biBidG4tZGVmYXVsdFwiXFxuICAgICAgICAgIHZhbHVlPVwie3tcXCdMb2dvdXRcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgICAgICAgIG5nLWlmPVwiJGN0cmwudXNlck11c3RDaGFuZ2VJdHNQYXNzd29yZFwiXFxuICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwubG9nb3V0KClcIiAvPlxcbiAgICA8L2Rpdj5cXG4gIDwvZm9ybT5cXG5cXG4gIDxkaXYgbmctc2hvdz1cIiRjdHJsLmVycm9yXCIgY2xhc3M9XCJnbWYtYXV0aGVudGljYXRpb24tZXJyb3IgaGVscC1ibG9ja1wiPjwvZGl2PlxcbjwvZGl2PlxcblxcbjxkaXYgbmctaWY9XCIhJGN0cmwuZ21mVXNlci51c2VybmFtZVwiPlxcblxcbiAgPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIiBuZy1zaG93PVwiJGN0cmwuaW5mb01lc3NhZ2VcIj5cXG4gICAgPHNwYW4+e3sgJGN0cmwuaW5mb01lc3NhZ2UgfX08L3NwYW4+XFxuICA8L2Rpdj5cXG5cXG4gIDxmb3JtXFxuICAgICAgbmFtZT1cImxvZ2luRm9ybVwiXFxuICAgICAgcm9sZT1cImZvcm1cIlxcbiAgICAgIG5nLXN1Ym1pdD1cIiRjdHJsLmxvZ2luKClcIlxcbiAgICAgIG5nLWNvbnRyb2xsZXI9XCJHbWZBdXRoZW50aWNhdGlvbkNvbnRyb2xsZXJcIlxcbiAgICAgIG5nLWNsYXNzPVwie1xcJ2hhcy1lcnJvclxcJzogJGN0cmwuZXJyb3J9XCI+XFxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGlucHV0XFxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcXG4gICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICAgICAgICBuYW1lPVwibG9naW5cIlxcbiAgICAgICAgICBuZy1tb2RlbD1cIiRjdHJsLmxvZ2luVmFsXCJcXG4gICAgICAgICAgbmctYXR0ci1wbGFjZWhvbGRlcj1cInt7XFwnVXNlcm5hbWVcXCcgfCB0cmFuc2xhdGV9fVwiIC8+XFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgICB0eXBlPVwicGFzc3dvcmRcIlxcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgIG5hbWU9XCJwYXNzd29yZFwiXFxuICAgICAgICAgIG5nLW1vZGVsPVwiJGN0cmwucHdkVmFsXCJcXG4gICAgICAgICAgbmctYXR0ci1wbGFjZWhvbGRlcj1cInt7XFwnUGFzc3dvcmRcXCcgfCB0cmFuc2xhdGV9fVwiLz5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgbmctaWY9XCIkY3RybC50d29GYWN0b3JBdXRoXCIgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGlucHV0XFxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcXG4gICAgICAgICAgYXV0b2NvbXBsZXRlPVwib2ZmXCJcXG4gICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICAgICAgICBuYW1lPVwib3RwXCJcXG4gICAgICAgICAgbmctbW9kZWw9XCIkY3RybC5vdHBWYWxcIlxcbiAgICAgICAgICBuZy1hdHRyLXBsYWNlaG9sZGVyPVwie3tcXCdBdXRoZW50aWNhdGlvbiBjb2RlXFwnIHwgdHJhbnNsYXRlfX1cIi8+XFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxcbiAgICA8aW5wdXRcXG4gICAgICAgIHR5cGU9XCJzdWJtaXRcIlxcbiAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2wgYnRuIHByaW1lXCJcXG4gICAgICAgIHZhbHVlPVwie3tcXCdDb25uZWN0XFwnIHwgdHJhbnNsYXRlfX1cIiAvPlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBuZy1zaG93PVwiJGN0cmwuYWxsb3dQYXNzd29yZFJlc2V0XCIgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGEgbmctY2xpY2s9XCIkY3RybC5yZXNldFBhc3N3b3JkKClcIlxcbiAgICAgICAgIGhyZWY9XCJcIj57e1xcJ1Bhc3N3b3JkIGZvcmdvdHRlbj9cXCcgfCB0cmFuc2xhdGV9fTwvYT5cXG4gICAgPC9kaXY+XFxuICA8L2Zvcm0+XFxuXFxuICA8ZGl2IG5nLXNob3c9XCIkY3RybC5lcnJvclwiIGNsYXNzPVwiZ21mLWF1dGhlbnRpY2F0aW9uLWVycm9yIGhlbHAtYmxvY2tcIj48L2Rpdj5cXG5cXG4gIDxuZ2VvLW1vZGFsXFxuICAgICAgbmctbW9kZWw9XCIkY3RybC5yZXNldFBhc3N3b3JkTW9kYWxTaG93blwiPlxcbiAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyIHVpLWRyYWdnYWJsZS1oYW5kbGVcIj5cXG4gICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgICAgY2xhc3M9XCJjbG9zZVwiXFxuICAgICAgICAgICAgICBkYXRhLWRpc21pc3M9XCJtb2RhbFwiXFxuICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwie3tcXCdDbG9zZVxcJyB8IHRyYW5zbGF0ZX19XCI+XFxuICAgICAgICA8c3BhbiBhcmlhLWhpZGRlbj1cInRydWVcIj4mdGltZXM7PC9zcGFuPlxcbiAgICAgIDwvYnV0dG9uPlxcbiAgICAgIDxoNCBjbGFzcz1cIm1vZGFsLXRpdGxlXCI+XFxuICAgICAgICB7e1xcJ1Bhc3N3b3JkIGZvcmdvdHRlbj9cXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgIDwvaDQ+XFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVwibW9kYWwtYm9keVwiIHRyYW5zbGF0ZT5cXG4gICAgICBBIG5ldyBwYXNzd29yZCBoYXMganVzdCBiZWVuIHNlbnQgdG8geW91IGJ5IGUtbWFpbC5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cXG4gICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHRcIlxcbiAgICAgICAgICAgICAgZGF0YS1kaXNtaXNzPVwibW9kYWxcIj57e1xcJ09LXFwnIHwgdHJhbnNsYXRlfX08L2J1dHRvbj5cXG4gICAgPC9kaXY+XFxuICA8L25nZW8tbW9kYWw+XFxuXFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IGdtZkF1dGhlbnRpY2F0aW9uU2VydmljZSBmcm9tICdnbWYvYXV0aGVudGljYXRpb24vU2VydmljZS5qcyc7XG5pbXBvcnQgeyBNZXNzYWdlVHlwZSB9IGZyb20gJ25nZW8vbWVzc2FnZS9NZXNzYWdlLmpzJztcbmltcG9ydCBuZ2VvTWVzc2FnZU5vdGlmaWNhdGlvbiBmcm9tICduZ2VvL21lc3NhZ2UvTm90aWZpY2F0aW9uLmpzJztcbmltcG9ydCBuZ2VvTWVzc2FnZU1vZGFsQ29tcG9uZW50IGZyb20gJ25nZW8vbWVzc2FnZS9tb2RhbENvbXBvbmVudC5qcyc7XG5pbXBvcnQgcXJ1cmkgZnJvbSAncXJ1cmknO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZBdXRoZW50aWNhdGlvbicsIFtnbWZBdXRoZW50aWNhdGlvblNlcnZpY2UubmFtZSwgbmdlb01lc3NhZ2VOb3RpZmljYXRpb24ubmFtZSwgbmdlb01lc3NhZ2VNb2RhbENvbXBvbmVudC5uYW1lXSk7XG5cbmZ1bmN0aW9uIGdtZkF1dGhlbnRpY2F0aW9uVGVtcGxhdGVVcmxfKGVsZW1lbnQsIGF0dHJzKSB7XG4gIHZhciB0ZW1wbGF0ZVVybCA9IGF0dHJzLmdtZkF1dGhlbnRpY2F0aW9uVGVtcGxhdGV1cmw7XG4gIHJldHVybiB0ZW1wbGF0ZVVybCAhPT0gdW5kZWZpbmVkID8gdGVtcGxhdGVVcmwgOiAnZ21mL2F1dGhlbnRpY2F0aW9uJztcbn1cblxubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdnbWYvYXV0aGVudGljYXRpb24nLCByZXF1aXJlKCcuL2NvbXBvbmVudC5odG1sJykpO1xufV0pO1xuZ21mQXV0aGVudGljYXRpb25UZW1wbGF0ZVVybC4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkYXR0cnNcIiwgXCJnbWZBdXRoZW50aWNhdGlvblRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBnbWZBdXRoZW50aWNhdGlvblRlbXBsYXRlVXJsKCRlbGVtZW50LCAkYXR0cnMsIGdtZkF1dGhlbnRpY2F0aW9uVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIGdtZkF1dGhlbnRpY2F0aW9uVGVtcGxhdGVVcmwoJGVsZW1lbnQsICRhdHRycyk7XG59XG5cbnZhciBhdXRoZW50aWNhdGlvbkNvbXBvbmVudCA9IHtcbiAgYmluZGluZ3M6IHtcbiAgICAnYWxsb3dQYXNzd29yZFJlc2V0JzogJzw/Z21mQXV0aGVudGljYXRpb25BbGxvd1Bhc3N3b3JkUmVzZXQnLFxuICAgICdhbGxvd1Bhc3N3b3JkQ2hhbmdlJzogJzw/Z21mQXV0aGVudGljYXRpb25BbGxvd1Bhc3N3b3JkQ2hhbmdlJyxcbiAgICAncGFzc3dvcmRWYWxpZGF0b3InOiAnPD9nbWZBdXRoZW50aWNhdGlvblBhc3N3b3JkVmFsaWRhdG9yJyxcbiAgICAnZm9yY2VQYXNzd29yZENoYW5nZSc6ICc8P2dtZkF1dGhlbnRpY2F0aW9uRm9yY2VQYXNzd29yZENoYW5nZScsXG4gICAgJ2luZm9NZXNzYWdlJzogJz0/Z21mQXV0aGVudGljYXRpb25JbmZvTWVzc2FnZSdcbiAgfSxcbiAgY29udHJvbGxlcjogJ0dtZkF1dGhlbnRpY2F0aW9uQ29udHJvbGxlcicsXG4gIHRlbXBsYXRlVXJsOiBnbWZBdXRoZW50aWNhdGlvblRlbXBsYXRlVXJsXG59O1xubW9kdWxlLnZhbHVlKCdnbWZBdXRoZW50aWNhdGlvblRlbXBsYXRlVXJsJywgZ21mQXV0aGVudGljYXRpb25UZW1wbGF0ZVVybF8pO1xubW9kdWxlLmNvbXBvbmVudCgnZ21mQXV0aGVudGljYXRpb24nLCBhdXRoZW50aWNhdGlvbkNvbXBvbmVudCk7XG5cbnZhciBBdXRoZW50aWNhdGlvbkNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIEF1dGhlbnRpY2F0aW9uQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCJnbWZUd29GYWN0b3JBdXRoXCIsIFwiZ2V0dGV4dENhdGFsb2dcIiwgXCJnbWZBdXRoZW50aWNhdGlvblNlcnZpY2VcIiwgXCJnbWZVc2VyXCIsIFwibmdlb05vdGlmaWNhdGlvblwiXTtcblxuICBmdW5jdGlvbiBBdXRoZW50aWNhdGlvbkNvbnRyb2xsZXIoJHNjb3BlLCAkZWxlbWVudCwgZ21mVHdvRmFjdG9yQXV0aCwgZ2V0dGV4dENhdGFsb2csIGdtZkF1dGhlbnRpY2F0aW9uU2VydmljZSwgZ21mVXNlciwgbmdlb05vdGlmaWNhdGlvbikge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB0aGlzLiRlbGVtZW50XyA9ICRlbGVtZW50O1xuICAgIHRoaXMuZ21mVXNlciA9IGdtZlVzZXI7XG4gICAgdGhpcy5nZXR0ZXh0Q2F0YWxvZyA9IGdldHRleHRDYXRhbG9nO1xuICAgIHRoaXMuZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlXyA9IGdtZkF1dGhlbnRpY2F0aW9uU2VydmljZTtcbiAgICB0aGlzLm5vdGlmaWNhdGlvbl8gPSBuZ2VvTm90aWZpY2F0aW9uO1xuICAgIHRoaXMudHdvRmFjdG9yQXV0aCA9IGdtZlR3b0ZhY3RvckF1dGg7XG4gICAgdGhpcy5hbGxvd1Bhc3N3b3JkUmVzZXQgPSB0cnVlO1xuICAgIHRoaXMuYWxsb3dQYXNzd29yZENoYW5nZSA9IHRydWU7XG4gICAgdGhpcy5wYXNzd29yZFZhbGlkYXRvciA9IG51bGw7XG4gICAgdGhpcy5mb3JjZVBhc3N3b3JkQ2hhbmdlID0gZmFsc2U7XG4gICAgdGhpcy5pbmZvTWVzc2FnZSA9IG51bGw7XG4gICAgdGhpcy5jaGFuZ2luZ1Bhc3N3b3JkID0gZmFsc2U7XG4gICAgdGhpcy51c2VyTXVzdENoYW5nZUl0c1Bhc3N3b3JkID0gZmFsc2U7XG4gICAgdGhpcy5yZXNldFBhc3N3b3JkTW9kYWxTaG93biA9IGZhbHNlO1xuICAgIHRoaXMuZXJyb3IgPSBmYWxzZTtcbiAgICB0aGlzLmxvZ2luVmFsID0gJyc7XG4gICAgdGhpcy5wd2RWYWwgPSAnJztcbiAgICB0aGlzLm90cFZhbDtcbiAgICB0aGlzLm9sZFB3ZFZhbCA9ICcnO1xuICAgIHRoaXMubmV3UHdkVmFsID0gJyc7XG4gICAgdGhpcy5uZXdQd2RDb25mVmFsID0gJyc7XG4gICAgdGhpcy5vdHBJbWFnZTtcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5nbWZVc2VyLm90cF91cmk7XG4gICAgfSwgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgaWYgKHZhbCkge1xuICAgICAgICBfdGhpcy5vdHBJbWFnZSA9IHFydXJpKHZhbCwge1xuICAgICAgICAgIG1hcmdpbjogMlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBBdXRoZW50aWNhdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlO1xuXG4gIF9wcm90by4kb25Jbml0ID0gZnVuY3Rpb24gJG9uSW5pdCgpIHtcbiAgICB0aGlzLmFsbG93UGFzc3dvcmRSZXNldCA9IHRoaXMuYWxsb3dQYXNzd29yZFJlc2V0ICE9PSBmYWxzZTtcbiAgICB0aGlzLmFsbG93UGFzc3dvcmRDaGFuZ2UgPSB0aGlzLmFsbG93UGFzc3dvcmRDaGFuZ2UgIT09IGZhbHNlO1xuICAgIHRoaXMuZm9yY2VQYXNzd29yZENoYW5nZSA9IHRoaXMuZm9yY2VQYXNzd29yZENoYW5nZSA9PT0gdHJ1ZTtcblxuICAgIGlmICh0aGlzLmZvcmNlUGFzc3dvcmRDaGFuZ2UpIHtcbiAgICAgIHRoaXMuY2hhbmdpbmdQYXNzd29yZCA9IHRydWU7XG4gICAgfVxuXG4gICAgdGhpcy51c2VyTXVzdENoYW5nZUl0c1Bhc3N3b3JkID0gdGhpcy5nbWZVc2VyLmlzX3Bhc3N3b3JkX2NoYW5nZWQgPT09IGZhbHNlICYmIHRoaXMuZm9yY2VQYXNzd29yZENoYW5nZTtcbiAgfTtcblxuICBfcHJvdG8uY2hhbmdlUGFzc3dvcmQgPSBmdW5jdGlvbiBjaGFuZ2VQYXNzd29yZCgpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2c7XG4gICAgdmFyIG9sZFB3ZCA9IHRoaXMub2xkUHdkVmFsO1xuICAgIHZhciBuZXdQd2QgPSB0aGlzLm5ld1B3ZFZhbDtcbiAgICB2YXIgY29uZlB3ZCA9IHRoaXMubmV3UHdkQ29uZlZhbDtcbiAgICB2YXIgZXJyb3JzID0gW107XG5cbiAgICBpZiAob2xkUHdkID09PSAnJykge1xuICAgICAgZXJyb3JzLnB1c2goZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdUaGUgb2xkIHBhc3N3b3JkIGlzIHJlcXVpcmVkLicpKTtcbiAgICB9XG5cbiAgICBpZiAobmV3UHdkID09PSAnJykge1xuICAgICAgZXJyb3JzLnB1c2goZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdUaGUgbmV3IHBhc3N3b3JkIGlzIHJlcXVpcmVkLicpKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZlB3ZCA9PT0gJycpIHtcbiAgICAgIGVycm9ycy5wdXNoKGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnVGhlIHBhc3N3b3JkIGNvbmZpcm1hdGlvbiBpcyByZXF1aXJlZC4nKSk7XG4gICAgfVxuXG4gICAgaWYgKGVycm9ycy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuc2V0RXJyb3JfKGVycm9ycyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChvbGRQd2QgPT09IG5ld1B3ZCkge1xuICAgICAgICBlcnJvcnMucHVzaChnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1RoZSBvbGQgYW5kIG5ldyBwYXNzd29yZHMgYXJlIHRoZSBzYW1lLicpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5ld1B3ZCAhPT0gY29uZlB3ZCkge1xuICAgICAgICBlcnJvcnMucHVzaChnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1RoZSBwYXNzd29yZHMgZG9uXFwndCBtYXRjaC4nKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnBhc3N3b3JkVmFsaWRhdG9yKSB7XG4gICAgICAgIGlmICghdGhpcy5wYXNzd29yZFZhbGlkYXRvci5pc1Bhc3N3b3JkVmFsaWQob2xkUHdkKSkge1xuICAgICAgICAgIGVycm9ycy5wdXNoKGdldHRleHRDYXRhbG9nLmdldFN0cmluZyh0aGlzLnBhc3N3b3JkVmFsaWRhdG9yLm5vdFZhbGlkTWVzc2FnZSkpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuc2V0RXJyb3JfKGVycm9ycyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdXNlcm5hbWUgPSB0aGlzLmdtZlVzZXIudXNlcm5hbWU7XG4gICAgICAgIHRoaXMuZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlXy5jaGFuZ2VQYXNzd29yZCh1c2VybmFtZSwgb2xkUHdkLCBuZXdQd2QsIGNvbmZQd2QsIHRoaXMub3RwVmFsKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczIuY2hhbmdlUGFzc3dvcmRSZXNldCgpO1xuXG4gICAgICAgICAgX3RoaXMyLnNldEVycm9yXyhbZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdZb3VyIHBhc3N3b3JkIGhhcyBzdWNjZXNzZnVsbHkgYmVlbiBjaGFuZ2VkLicpXSwgTWVzc2FnZVR5cGUuSU5GT1JNQVRJT04pO1xuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgX3RoaXMyLm9sZFB3ZFZhbCA9ICcnO1xuICAgICAgICAgIF90aGlzMi5vdHBWYWwgPSAnJztcblxuICAgICAgICAgIF90aGlzMi5zZXRFcnJvcl8oZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdJbmNvcnJlY3Qgb2xkIHBhc3N3b3JkLicpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5sb2dpbiA9IGZ1bmN0aW9uIGxvZ2luKCkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdmFyIGdldHRleHRDYXRhbG9nID0gdGhpcy5nZXR0ZXh0Q2F0YWxvZztcbiAgICB2YXIgZXJyb3JzID0gW107XG5cbiAgICBpZiAodGhpcy5sb2dpblZhbCA9PT0gJycpIHtcbiAgICAgIGVycm9ycy5wdXNoKGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnVGhlIHVzZXJuYW1lIGlzIHJlcXVpcmVkLicpKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wd2RWYWwgPT09ICcnKSB7XG4gICAgICBlcnJvcnMucHVzaChnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1RoZSBwYXNzd29yZCBpcyByZXF1aXJlZC4nKSk7XG4gICAgfVxuXG4gICAgaWYgKGVycm9ycy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuc2V0RXJyb3JfKGVycm9ycyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlXy5sb2dpbih0aGlzLmxvZ2luVmFsLCB0aGlzLnB3ZFZhbCwgdGhpcy5vdHBWYWwpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczMubG9naW5WYWwgPSAnJztcbiAgICAgICAgX3RoaXMzLnB3ZFZhbCA9ICcnO1xuICAgICAgICBfdGhpczMub3RwVmFsID0gJyc7XG5cbiAgICAgICAgX3RoaXMzLnJlc2V0RXJyb3JfKCk7XG4gICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMy5wd2RWYWwgPSAnJztcbiAgICAgICAgX3RoaXMzLm90cFZhbCA9ICcnO1xuXG4gICAgICAgIF90aGlzMy5zZXRFcnJvcl8oZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdJbmNvcnJlY3QgY3JlZGVudGlhbHMgb3IgZGlzYWJsZWQgYWNjb3VudC4nKSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmxvZ291dCA9IGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2c7XG4gICAgdGhpcy5nbWZBdXRoZW50aWNhdGlvblNlcnZpY2VfLmxvZ291dCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXM0LnJlc2V0RXJyb3JfKCk7XG4gICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXM0LnNldEVycm9yXyhnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0NvdWxkIG5vdCBsb2cgb3V0LicpKTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8ucmVzZXRQYXNzd29yZCA9IGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQoKSB7XG4gICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICB2YXIgZ2V0dGV4dENhdGFsb2cgPSB0aGlzLmdldHRleHRDYXRhbG9nO1xuXG4gICAgaWYgKCF0aGlzLmxvZ2luVmFsKSB7XG4gICAgICB0aGlzLnNldEVycm9yXyhnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1BsZWFzZSwgaW5wdXQgYSBsb2dpbi4uLicpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmdtZkF1dGhlbnRpY2F0aW9uU2VydmljZV8ucmVzZXRQYXNzd29yZCh0aGlzLmxvZ2luVmFsKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzNS5yZXNldFBhc3N3b3JkTW9kYWxTaG93biA9IHRydWU7XG5cbiAgICAgIF90aGlzNS5yZXNldEVycm9yXygpO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzNS5zZXRFcnJvcl8oZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSByZXNldHRpbmcgdGhlIHBhc3N3b3JkLicpKTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uY2hhbmdlUGFzc3dvcmRSZXNldCA9IGZ1bmN0aW9uIGNoYW5nZVBhc3N3b3JkUmVzZXQoKSB7XG4gICAgdGhpcy5yZXNldEVycm9yXygpO1xuICAgIHRoaXMuY2hhbmdpbmdQYXNzd29yZCA9IGZhbHNlO1xuICAgIHRoaXMub2xkUHdkVmFsID0gJyc7XG4gICAgdGhpcy5uZXdQd2RWYWwgPSAnJztcbiAgICB0aGlzLm5ld1B3ZENvbmZWYWwgPSAnJztcbiAgfTtcblxuICBfcHJvdG8uc2V0RXJyb3JfID0gZnVuY3Rpb24gc2V0RXJyb3JfKGVycm9ycywgbWVzc2FnZVR5cGUpIHtcbiAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgIGlmIChtZXNzYWdlVHlwZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgIG1lc3NhZ2VUeXBlID0gTWVzc2FnZVR5cGUuRVJST1I7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZXJyb3IpIHtcbiAgICAgIHRoaXMucmVzZXRFcnJvcl8oKTtcbiAgICB9XG5cbiAgICB0aGlzLmVycm9yID0gdHJ1ZTtcbiAgICB2YXIgY29udGFpbmVyID0gdGhpcy4kZWxlbWVudF8uZmluZCgnLmdtZi1hdXRoZW50aWNhdGlvbi1lcnJvcicpO1xuXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGVycm9ycykpIHtcbiAgICAgIGVycm9ycyA9IFtlcnJvcnNdO1xuICAgIH1cblxuICAgIGVycm9ycy5mb3JFYWNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIG1zZzogZXJyb3IsXG4gICAgICAgIHRhcmdldDogY29udGFpbmVyXG4gICAgICB9O1xuXG4gICAgICBpZiAobWVzc2FnZVR5cGUpIHtcbiAgICAgICAgb3B0aW9ucy50eXBlID0gbWVzc2FnZVR5cGU7XG4gICAgICB9XG5cbiAgICAgIF90aGlzNi5ub3RpZmljYXRpb25fLm5vdGlmeShvcHRpb25zKTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8ucmVzZXRFcnJvcl8gPSBmdW5jdGlvbiByZXNldEVycm9yXygpIHtcbiAgICB0aGlzLm5vdGlmaWNhdGlvbl8uY2xlYXIoKTtcbiAgICB0aGlzLmVycm9yID0gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIEF1dGhlbnRpY2F0aW9uQ29udHJvbGxlcjtcbn0oKTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ0dtZkF1dGhlbnRpY2F0aW9uQ29udHJvbGxlcicsIEF1dGhlbnRpY2F0aW9uQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mQXV0aGVudGljYXRpb25Db21wb25lbnQgZnJvbSAnZ21mL2F1dGhlbnRpY2F0aW9uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlIGZyb20gJ2dtZi9hdXRoZW50aWNhdGlvbi9TZXJ2aWNlLmpzJztcbmV4cG9ydCBkZWZhdWx0IGFuZ3VsYXIubW9kdWxlKCdnbWZBdXRoZW50aWNhdGlvbk1vZHVsZScsIFtnbWZBdXRoZW50aWNhdGlvbkNvbXBvbmVudC5uYW1lLCBnbWZBdXRoZW50aWNhdGlvblNlcnZpY2UubmFtZV0pOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzx1bCBjbGFzcz1cImdtZi1iYWNrZ3JvdW5kbGF5ZXJzZWxlY3RvclwiPlxcbiAgPGxpIG5nLXJlcGVhdD1cImxheWVyIGluIGN0cmwuYmdMYXllcnNcIlxcbiAgICAgIG5nLWNsaWNrPVwiY3RybC5zZXRMYXllcihsYXllcilcIlxcbiAgICAgIG5nLWNsYXNzPVwie1xcJ2dtZi1iYWNrZ3JvdW5kbGF5ZXJzZWxlY3Rvci1hY3RpdmVcXCc6IGN0cmwuYmdMYXllciA9PSBsYXllciwgXFwnZ21mLWJhY2tncm91bmRsYXllcnNlbGVjdG9yLWRpc2FibGVkXFwnOiBjdHJsLm9wYWNpdHlMYXllciA9PSBsYXllcn1cIj5cXG4gICAgPGltZyBjbGFzcz1cImdtZi10aHVtYlwiXFxuICAgICAgICAgbmctc3JjPVwie3s6OmxheWVyLmdldChcXCdtZXRhZGF0YVxcJylbXFwndGh1bWJuYWlsXFwnXX19XCIgLz5cXG4gICAgPHNwYW4gY2xhc3M9XCJnbWYtdGV4dFwiPnt7bGF5ZXIuZ2V0KFwibGFiZWxcIikgfCB0cmFuc2xhdGV9fTwvc3Bhbj5cXG4gICAgPHNwYW4gbmctY2xhc3M9XCJ7XFwnZ21mLWJhY2tncm91bmRsYXllcnNlbGVjdG9yLW9wYWNpdHktY2hlY2tcXCc6IGN0cmwub3BhY2l0eUxheWVyID09IGxheWVyfVwiPjwvc3Bhbj5cXG4gIDwvbGk+XFxuXFxuICA8aW5wdXQgbmctaWY9XCJjdHJsLm9wYWNpdHlMYXllclwiXFxuICAgICAgICAgY2xhc3M9XCJpbnB1dC1hY3Rpb24gZ21mLWJhY2tncm91bmRsYXllcnNlbGVjdG9yLW9wYWNpdHktc2xpZGVyXCJcXG4gICAgICAgICBuYW1lPVwiYmctbGF5ZXItb3BhY2l0eVwiXFxuICAgICAgICAgdHlwZT1cInJhbmdlXCJcXG4gICAgICAgICBtaW49XCIwXCJcXG4gICAgICAgICBtYXg9XCIxXCJcXG4gICAgICAgICBzdGVwPVwiMC4wMVwiXFxuICAgICAgICAgbmctbW9kZWw9XCJjdHJsLmdldFNldEJnTGF5ZXJPcGFjaXR5XCJcXG4gICAgICAgICBuZy1tb2RlbC1vcHRpb25zPVwie2dldHRlclNldHRlcjogdHJ1ZX1cIj5cXG48L3VsPlxcbic7XG5cbn1cbnJldHVybiBfX3Bcbn0iLCJDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCJuZ2VvQmFja2dyb3VuZExheWVyTWdyXCIsIFwiZ21mVGhlbWVzXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mVGhlbWVUaGVtZXMgZnJvbSAnZ21mL3RoZW1lL1RoZW1lcy5qcyc7XG5pbXBvcnQgbmdlb01hcEJhY2tncm91bmRMYXllck1nciBmcm9tICduZ2VvL21hcC9CYWNrZ3JvdW5kTGF5ZXJNZ3IuanMnO1xuaW1wb3J0IHsgbGlzdGVuLCB1bmxpc3RlbkJ5S2V5IH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mQmFja2dyb3VuZGxheWVyc2VsZWN0b3InLCBbZ21mVGhlbWVUaGVtZXMubmFtZSwgbmdlb01hcEJhY2tncm91bmRMYXllck1nci5uYW1lXSk7XG5tb2R1bGUudmFsdWUoJ2dtZkJhY2tncm91bmRsYXllcnNlbGVjdG9yVGVtcGxhdGVVcmwnLCBmdW5jdGlvbiAoJGVsZW1lbnQsICRhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSAkYXR0cnMuZ21mQmFja2dyb3VuZGxheWVyc2VsZWN0b3JUZW1wbGF0ZXVybDtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICdnbWYvYmFja2dyb3VuZGxheWVyc2VsZWN0b3InO1xufSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi9iYWNrZ3JvdW5kbGF5ZXJzZWxlY3RvcicsIHJlcXVpcmUoJy4vY29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5nbWZCYWNrZ3JvdW5kbGF5ZXJzZWxlY3RvclRlbXBsYXRlVXJsLiRpbmplY3QgPSBbXCIkZWxlbWVudFwiLCBcIiRhdHRyc1wiLCBcImdtZkJhY2tncm91bmRsYXllcnNlbGVjdG9yVGVtcGxhdGVVcmxcIl07XG5cbmZ1bmN0aW9uIGdtZkJhY2tncm91bmRsYXllcnNlbGVjdG9yVGVtcGxhdGVVcmwoJGVsZW1lbnQsICRhdHRycywgZ21mQmFja2dyb3VuZGxheWVyc2VsZWN0b3JUZW1wbGF0ZVVybCkge1xuICByZXR1cm4gZ21mQmFja2dyb3VuZGxheWVyc2VsZWN0b3JUZW1wbGF0ZVVybCgkZWxlbWVudCwgJGF0dHJzKTtcbn1cblxudmFyIGJhY2tncm91bmRsYXllcnNlbGVjdG9yQ29tcG9uZW50ID0ge1xuICBjb250cm9sbGVyOiAnR21mQmFja2dyb3VuZGxheWVyc2VsZWN0b3JDb250cm9sbGVyIGFzIGN0cmwnLFxuICBiaW5kaW5nczoge1xuICAgICdtYXAnOiAnPWdtZkJhY2tncm91bmRsYXllcnNlbGVjdG9yTWFwJyxcbiAgICAnb3BhY2l0eU9wdGlvbnMnOiAnPWdtZkJhY2tncm91bmRsYXllck9wYWNpdHlPcHRpb25zJyxcbiAgICAnc2VsZWN0JzogJyY/Z21mQmFja2dyb3VuZGxheWVyc2VsZWN0b3JTZWxlY3QnXG4gIH0sXG4gIHRlbXBsYXRlVXJsOiBnbWZCYWNrZ3JvdW5kbGF5ZXJzZWxlY3RvclRlbXBsYXRlVXJsXG59O1xubW9kdWxlLmNvbXBvbmVudCgnZ21mQmFja2dyb3VuZGxheWVyc2VsZWN0b3InLCBiYWNrZ3JvdW5kbGF5ZXJzZWxlY3RvckNvbXBvbmVudCk7XG5cbmZ1bmN0aW9uIENvbnRyb2xsZXIoJHNjb3BlLCBuZ2VvQmFja2dyb3VuZExheWVyTWdyLCBnbWZUaGVtZXMpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLm1hcCA9IG51bGw7XG4gIHRoaXMub3BhY2l0eU9wdGlvbnM7XG4gIHRoaXMuc2VsZWN0ID0gbnVsbDtcbiAgdGhpcy5iZ0xheWVyID0gbnVsbDtcbiAgdGhpcy5iZ0xheWVycyA9IG51bGw7XG4gIHRoaXMub3BhY2l0eUxheWVyID0gbnVsbDtcbiAgdGhpcy5nbWZUaGVtZXNfID0gZ21mVGhlbWVzO1xuICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgdGhpcy5saXN0ZW5lcktleXNfLnB1c2gobGlzdGVuKGdtZlRoZW1lcywgJ2NoYW5nZScsIHRoaXMuaGFuZGxlVGhlbWVzQ2hhbmdlXywgdGhpcykpO1xuICB0aGlzLmJhY2tncm91bmRMYXllck1ncl8gPSBuZ2VvQmFja2dyb3VuZExheWVyTWdyO1xuICB0aGlzLmxpc3RlbmVyS2V5c18ucHVzaChsaXN0ZW4odGhpcy5iYWNrZ3JvdW5kTGF5ZXJNZ3JfLCAnY2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgX3RoaXMuYmdMYXllciA9IGV2ZW50LmRldGFpbC5jdXJyZW50O1xuICB9KSk7XG4gICRzY29wZS4kb24oJyRkZXN0cm95JywgdGhpcy5oYW5kbGVEZXN0cm95Xy5iaW5kKHRoaXMpKTtcbn1cblxuQ29udHJvbGxlci5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5oYW5kbGVUaGVtZXNDaGFuZ2VfKCk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVUaGVtZXNDaGFuZ2VfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMyID0gdGhpcztcblxuICB0aGlzLmdtZlRoZW1lc18uZ2V0QmdMYXllcnMoKS50aGVuKGZ1bmN0aW9uIChsYXllcnMpIHtcbiAgICBfdGhpczIuYmdMYXllcnMgPSBsYXllcnM7XG5cbiAgICBpZiAoX3RoaXMyLm9wYWNpdHlPcHRpb25zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhciBvcGFjaXR5TGF5ZXIgPSBsYXllcnMuZmluZChmdW5jdGlvbiAobGF5ZXIpIHtcbiAgICAgICAgcmV0dXJuIGxheWVyLmdldCgnbGFiZWwnKSA9PT0gX3RoaXMyLm9wYWNpdHlPcHRpb25zO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChvcGFjaXR5TGF5ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBfdGhpczIuc2V0T3BhY2l0eUJnTGF5ZXIob3BhY2l0eUxheWVyKTtcblxuICAgICAgICBfdGhpczIuYmdMYXllcnMgPSBfdGhpczIuYmdMYXllcnMuc2xpY2UoKTtcblxuICAgICAgICB2YXIgaW5kZXhPcGEgPSBfdGhpczIuYmdMYXllcnMuZmluZEluZGV4KGZ1bmN0aW9uIChsYXllcikge1xuICAgICAgICAgIHJldHVybiBsYXllciA9PT0gX3RoaXMyLm9wYWNpdHlMYXllcjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgX3RoaXMyLmJnTGF5ZXJzLnNwbGljZShpbmRleE9wYSwgMSk7XG5cbiAgICAgICAgX3RoaXMyLmJnTGF5ZXJzLnB1c2gob3BhY2l0eUxheWVyKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0U2V0QmdMYXllck9wYWNpdHkgPSBmdW5jdGlvbiAodmFsKSB7XG4gIGlmICghdGhpcy5vcGFjaXR5TGF5ZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb3BhY2l0eUxheWVyJyk7XG4gIH1cblxuICBpZiAodmFsICE9PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wYWNpdHlMYXllci5zZXRPcGFjaXR5KHZhbCk7XG4gICAgdGhpcy5vcGFjaXR5TGF5ZXIuc2V0VmlzaWJsZSh2YWwgIT09IDApO1xuICAgIHRoaXMuYmdMYXllci5zZXRWaXNpYmxlKHZhbCAhPT0gMSk7XG4gIH1cblxuICByZXR1cm4gdGhpcy5vcGFjaXR5TGF5ZXIuZ2V0T3BhY2l0eSgpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc2V0TGF5ZXIgPSBmdW5jdGlvbiAobGF5ZXIsIG9wdF9zaWxlbnQpIHtcbiAgdmFyIG9wYWNpdHkgPSB0aGlzLm9wYWNpdHlMYXllciA/IHRoaXMub3BhY2l0eUxheWVyLmdldE9wYWNpdHkoKSA6IDA7XG4gIHRoaXMuYmdMYXllciA9IGxheWVyO1xuICB0aGlzLmJhY2tncm91bmRMYXllck1ncl8uc2V0KHRoaXMubWFwLCBsYXllcik7XG4gIGxheWVyLnNldFZpc2libGUob3BhY2l0eSAhPT0gMSk7XG5cbiAgaWYgKHRoaXMub3BhY2l0eUxheWVyKSB7XG4gICAgdGhpcy5vcGFjaXR5TGF5ZXIuc2V0VmlzaWJsZShvcGFjaXR5ICE9PSAwKTtcbiAgICB0aGlzLm9wYWNpdHlMYXllci5zZXRPcGFjaXR5KG9wYWNpdHkpO1xuICB9XG5cbiAgaWYgKCFvcHRfc2lsZW50ICYmIHRoaXMuc2VsZWN0KSB7XG4gICAgdGhpcy5zZWxlY3QoKTtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc2V0T3BhY2l0eUJnTGF5ZXIgPSBmdW5jdGlvbiAobGF5ZXIpIHtcbiAgdmFyIG9wYWNpdHkgPSB0aGlzLm9wYWNpdHlMYXllciA/IHRoaXMub3BhY2l0eUxheWVyLmdldE9wYWNpdHkoKSA6IGxheWVyLmdldE9wYWNpdHkoKTtcbiAgbGF5ZXIuc2V0T3BhY2l0eShvcGFjaXR5KTtcbiAgdGhpcy5vcGFjaXR5TGF5ZXIgPSBsYXllcjtcbiAgdGhpcy5vcGFjaXR5TGF5ZXIuc2V0VmlzaWJsZShvcGFjaXR5ICE9PSAwKTtcbiAgdGhpcy5iZ0xheWVyLnNldFZpc2libGUob3BhY2l0eSAhPT0gMSk7XG4gIHRoaXMuYmFja2dyb3VuZExheWVyTWdyXy5zZXRPcGFjaXR5QmdMYXllcih0aGlzLm1hcCwgbGF5ZXIpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlRGVzdHJveV8gPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMubGlzdGVuZXJLZXlzXy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICB0aGlzLmxpc3RlbmVyS2V5c18ubGVuZ3RoID0gMDtcbn07XG5cbm1vZHVsZS5jb250cm9sbGVyKCdHbWZCYWNrZ3JvdW5kbGF5ZXJzZWxlY3RvckNvbnRyb2xsZXInLCBDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJjb250ZXh0dWFsRGF0YUNvbXBvbmVudENvbnRlbnQuJGluamVjdCA9IFtcImdtZkNvbnRleHR1YWxkYXRhY29udGVudFRlbXBsYXRlVXJsXCJdO1xuQ29udGV4dHVhbGRhdGFDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkY29tcGlsZVwiLCBcIiR0aW1lb3V0XCIsIFwiJHNjb3BlXCIsIFwiZ21mUmFzdGVyXCIsIFwiJGluamVjdG9yXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mUmFzdGVyUmFzdGVyU2VydmljZSBmcm9tICdnbWYvcmFzdGVyL1Jhc3RlclNlcnZpY2UuanMnO1xuaW1wb3J0IG9sT3ZlcmxheSBmcm9tICdvbC9PdmVybGF5LmpzJztcbmltcG9ydCAqIGFzIG9sUHJvaiBmcm9tICdvbC9wcm9qLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mQ29udGV4dHVhbGRhdGEnLCBbZ21mUmFzdGVyUmFzdGVyU2VydmljZS5uYW1lXSk7XG5cbmZ1bmN0aW9uIGNvbnRleHR1YWxEYXRhQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgc2NvcGU6IGZhbHNlLFxuICAgIGNvbnRyb2xsZXI6ICdHbWZDb250ZXh0dWFsZGF0YUNvbnRyb2xsZXIgYXMgY2RDdHJsJyxcbiAgICBiaW5kVG9Db250cm9sbGVyOiB7XG4gICAgICAnZGlzcGxheWVkJzogJz1nbWZDb250ZXh0dWFsZGF0YURpc3BsYXllZCcsXG4gICAgICAnbWFwJzogJzxnbWZDb250ZXh0dWFsZGF0YU1hcCcsXG4gICAgICAncHJvamVjdGlvbnMnOiAnPGdtZkNvbnRleHR1YWxkYXRhUHJvamVjdGlvbnMnLFxuICAgICAgJ2NhbGxiYWNrJzogJzxnbWZDb250ZXh0dWFsZGF0YUNhbGxiYWNrJ1xuICAgIH0sXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGNvbnRyb2xsZXIpIHtcbiAgICAgIGlmICghY29udHJvbGxlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY29udHJvbGxlcicpO1xuICAgICAgfVxuXG4gICAgICBjb250cm9sbGVyLmluaXQoKTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ2dtZkNvbnRleHR1YWxkYXRhJywgY29udGV4dHVhbERhdGFDb21wb25lbnQpO1xuZXhwb3J0IGZ1bmN0aW9uIENvbnRleHR1YWxkYXRhQ29udHJvbGxlcigkY29tcGlsZSwgJHRpbWVvdXQsICRzY29wZSwgZ21mUmFzdGVyLCAkaW5qZWN0b3IpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLm1hcCA9IG51bGw7XG4gIHRoaXMucHJvamVjdGlvbnMgPSBbXTtcbiAgdGhpcy5kaXNwbGF5ZWQgPSBmYWxzZTtcblxuICB0aGlzLmNhbGxiYWNrID0gZnVuY3Rpb24gKGMsIG8pIHtcbiAgICByZXR1cm4ge307XG4gIH07XG5cbiAgdGhpcy5vdmVybGF5XyA9IG51bGw7XG4gIHRoaXMubG9uZ1ByZXNzVGltZW91dF8gPSBudWxsO1xuICB0aGlzLiRjb21waWxlXyA9ICRjb21waWxlO1xuICB0aGlzLnRpbWVvdXRfID0gJHRpbWVvdXQ7XG4gIHRoaXMuJHNjb3BlXyA9ICRzY29wZTtcbiAgdGhpcy5nbWZSYXN0ZXJfID0gZ21mUmFzdGVyO1xuICB0aGlzLmdtZkNvbnRleHR1YWxkYXRhT3B0aW9uc18gPSAkaW5qZWN0b3IuaGFzKCdnbWZDb250ZXh0dWFsZGF0YU9wdGlvbnMnKSA/ICRpbmplY3Rvci5nZXQoJ2dtZkNvbnRleHR1YWxkYXRhT3B0aW9ucycpIDoge307XG4gIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZnVuY3Rpb24gKCkge1xuICAgIF90aGlzLiRzY29wZV8uJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLmhpZGVQb3BvdmVyKCk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5Db250ZXh0dWFsZGF0YUNvbnRyb2xsZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIHRoaXMucHJlcGFyZVBvcG92ZXJfKCk7XG5cbiAgaWYgKCF0aGlzLm1hcCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgfVxuXG4gIHZhciBtYXBEaXYgPSB0aGlzLm1hcC5nZXRUYXJnZXRFbGVtZW50KCk7XG5cbiAgaWYgKCFtYXBEaXYpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwRGl2Jyk7XG4gIH1cblxuICBtYXBEaXYuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCB0aGlzLmhhbmRsZU1hcENvbnRleHRNZW51Xy5iaW5kKHRoaXMpKTtcbiAgbWFwRGl2LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLmhhbmRsZU1hcFRvdWNoU3RhcnRfLmJpbmQodGhpcykpO1xuICBtYXBEaXYuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5oYW5kbGVNYXBUb3VjaEVuZF8uYmluZCh0aGlzKSk7XG4gIG1hcERpdi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMuaGFuZGxlTWFwVG91Y2hFbmRfLmJpbmQodGhpcykpO1xuICB0aGlzLm1hcC5vbigncG9pbnRlcmRvd24nLCBmdW5jdGlvbiAoKSB7XG4gICAgX3RoaXMyLiRzY29wZV8uJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzMi5oaWRlUG9wb3ZlcigpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbkNvbnRleHR1YWxkYXRhQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlTWFwVG91Y2hTdGFydF8gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgdGhpcy5sb25nUHJlc3NUaW1lb3V0XyA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICBfdGhpczMuaGFuZGxlTWFwQ29udGV4dE1lbnVfKGV2ZW50KTtcbiAgfSwgNTAwKTtcbn07XG5cbkNvbnRleHR1YWxkYXRhQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlTWFwVG91Y2hFbmRfID0gZnVuY3Rpb24gKCkge1xuICBpZiAodGhpcy5sb25nUHJlc3NUaW1lb3V0Xykge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLmxvbmdQcmVzc1RpbWVvdXRfKTtcbiAgfVxufTtcblxuQ29udGV4dHVhbGRhdGFDb250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVNYXBDb250ZXh0TWVudV8gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgdGhpcy4kc2NvcGVfLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFfdGhpczQubWFwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgdmFyIHBpeGVsID0gX3RoaXM0Lm1hcC5nZXRFdmVudFBpeGVsKGV2ZW50KTtcblxuICAgIHZhciBjb29yZGluYXRlID0gX3RoaXM0Lm1hcC5nZXRDb29yZGluYXRlRnJvbVBpeGVsKHBpeGVsKTtcblxuICAgIF90aGlzNC5zZXRDb250ZW50Xyhjb29yZGluYXRlKTtcblxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBfdGhpczQuc2hvd1BvcG92ZXIoKTtcblxuICAgIF90aGlzNC50aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIV90aGlzNC5vdmVybGF5Xykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb3ZlcmxheScpO1xuICAgICAgfVxuXG4gICAgICBfdGhpczQub3ZlcmxheV8uc2V0UG9zaXRpb24oY29vcmRpbmF0ZSk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuQ29udGV4dHVhbGRhdGFDb250cm9sbGVyLnByb3RvdHlwZS5zZXRDb250ZW50XyA9IGZ1bmN0aW9uIChjb29yZGluYXRlKSB7XG4gIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gIGlmICghdGhpcy5tYXApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gIH1cblxuICBpZiAoIXRoaXMuY29udGVudF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY29udGVudCcpO1xuICB9XG5cbiAgdmFyIHNjb3BlID0gdGhpcy4kc2NvcGVfLiRuZXcodHJ1ZSk7XG4gIHRoaXMuJGNvbXBpbGVfKHRoaXMuY29udGVudF8pKHNjb3BlKTtcbiAgdmFyIG1hcFByb2plY3Rpb24gPSB0aGlzLm1hcC5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpLmdldENvZGUoKTtcbiAgdGhpcy5wcm9qZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9qKSB7XG4gICAgdmFyIGNvb3JkID0gb2xQcm9qLnRyYW5zZm9ybShjb29yZGluYXRlLCBtYXBQcm9qZWN0aW9uLCBcIkVQU0c6XCIgKyBwcm9qKTtcbiAgICBzY29wZVtcImNvb3JkX1wiICsgcHJval0gPSBjb29yZDtcbiAgICBzY29wZVtcImNvb3JkX1wiICsgcHJvaiArIFwiX2Vhc3Rlcm5cIl0gPSBjb29yZFswXTtcbiAgICBzY29wZVtcImNvb3JkX1wiICsgcHJvaiArIFwiX25vcnRoZXJuXCJdID0gY29vcmRbMV07XG4gIH0pO1xuICB0aGlzLmdtZlJhc3Rlcl8uZ2V0UmFzdGVyKGNvb3JkaW5hdGUsIHRoaXMuZ21mQ29udGV4dHVhbGRhdGFPcHRpb25zXy5yYXN0ZXJQYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcbiAgICBPYmplY3QuYXNzaWduKHNjb3BlLCByZXNwKTtcblxuICAgIGlmIChfdGhpczUuY2FsbGJhY2spIHtcbiAgICAgIE9iamVjdC5hc3NpZ24oc2NvcGUsIF90aGlzNS5jYWxsYmFjay5jYWxsKF90aGlzNSwgY29vcmRpbmF0ZSwgcmVzcCkpO1xuICAgIH1cbiAgfSwgZnVuY3Rpb24gKCkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG9uIGdldHRpbmcgdGhlIHJhc3Rlci4nKTtcbiAgfSk7XG59O1xuXG5Db250ZXh0dWFsZGF0YUNvbnRyb2xsZXIucHJvdG90eXBlLnByZXBhcmVQb3BvdmVyXyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLm1hcCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgfVxuXG4gIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3BvcG92ZXInKTtcbiAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2JzLXBvcG92ZXItYm90dG9tJyk7XG4gIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdnbWYtY29udGV4dHVhbGRhdGEnKTtcbiAgY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgdmFyIGFycm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XG4gIGFycm93LmNsYXNzTGlzdC5hZGQoJ2Fycm93Jyk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZChhcnJvdyk7XG4gIHRoaXMuY29udGVudF8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgdGhpcy5jb250ZW50Xy5zZXRBdHRyaWJ1dGUoJ2dtZi1jb250ZXh0dWFsZGF0YWNvbnRlbnQnLCAnJyk7XG4gIHRoaXMuY29udGVudF8uY2xhc3NMaXN0LmFkZCgncG9wb3Zlci1ib2R5Jyk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmNvbnRlbnRfKTtcbiAgdGhpcy5vdmVybGF5XyA9IG5ldyBvbE92ZXJsYXkoe1xuICAgIGVsZW1lbnQ6IGNvbnRhaW5lcixcbiAgICBzdG9wRXZlbnQ6IHRydWUsXG4gICAgYXV0b1BhbjogdHJ1ZSxcbiAgICBhdXRvUGFuQW5pbWF0aW9uOiB7XG4gICAgICBkdXJhdGlvbjogMjUwXG4gICAgfSxcbiAgICBwb3NpdGlvbmluZzogJ3RvcC1jZW50ZXInXG4gIH0pO1xuICB0aGlzLm1hcC5hZGRPdmVybGF5KHRoaXMub3ZlcmxheV8pO1xufTtcblxuQ29udGV4dHVhbGRhdGFDb250cm9sbGVyLnByb3RvdHlwZS5zaG93UG9wb3ZlciA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLm92ZXJsYXlfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG92ZXJsYXknKTtcbiAgfVxuXG4gIHZhciBlbGVtZW50ID0gdGhpcy5vdmVybGF5Xy5nZXRFbGVtZW50KCk7XG5cbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGVsZW1lbnQnKTtcbiAgfVxuXG4gIGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gIHRoaXMuZGlzcGxheWVkID0gdHJ1ZTtcbn07XG5cbkNvbnRleHR1YWxkYXRhQ29udHJvbGxlci5wcm90b3R5cGUuaGlkZVBvcG92ZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5vdmVybGF5Xykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBvdmVybGF5Jyk7XG4gIH1cblxuICB2YXIgZWxlbWVudCA9IHRoaXMub3ZlcmxheV8uZ2V0RWxlbWVudCgpO1xuXG4gIGlmICghZWxlbWVudCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBlbGVtZW50Jyk7XG4gIH1cblxuICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIHRoaXMuZGlzcGxheWVkID0gZmFsc2U7XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignR21mQ29udGV4dHVhbGRhdGFDb250cm9sbGVyJywgQ29udGV4dHVhbGRhdGFDb250cm9sbGVyKTtcblxuZnVuY3Rpb24gY29udGV4dHVhbERhdGFDb21wb25lbnRDb250ZW50KGdtZkNvbnRleHR1YWxkYXRhY29udGVudFRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBzY29wZTogdHJ1ZSxcbiAgICB0ZW1wbGF0ZVVybDogZ21mQ29udGV4dHVhbGRhdGFjb250ZW50VGVtcGxhdGVVcmxcbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnZ21mQ29udGV4dHVhbGRhdGFjb250ZW50JywgY29udGV4dHVhbERhdGFDb21wb25lbnRDb250ZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZDb250ZXh0dWFsZGF0YUNvbXBvbmVudCBmcm9tICdnbWYvY29udGV4dHVhbGRhdGEvY29tcG9uZW50LmpzJztcbmltcG9ydCAnLi9jb250ZXh0dWFsZGF0YS5zY3NzJztcbmV4cG9ydCBkZWZhdWx0IGFuZ3VsYXIubW9kdWxlKCdnbWZDb250ZXh0dWFsZGF0YU1vZHVsZScsIFtnbWZDb250ZXh0dWFsZGF0YUNvbXBvbmVudC5uYW1lXSk7IiwiZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IGdtZkNvbnRyb2xsZXJzQWJzdHJhY3RBcHBDb250cm9sbGVyLCB7IEFic3RyYWN0QXBwQ29udHJvbGxlciwgZ2V0TG9jYXRpb25JY29uIH0gZnJvbSAnZ21mL2NvbnRyb2xsZXJzL0Fic3RyYWN0QXBwQ29udHJvbGxlci5qcyc7XG5pbXBvcnQgbmdlb01hcFJlc2l6ZW1hcCBmcm9tICduZ2VvL21hcC9yZXNpemVtYXAuanMnO1xuaW1wb3J0ICogYXMgb2xQcm9qIGZyb20gJ29sL3Byb2ouanMnO1xuaW1wb3J0IG9sTWFwIGZyb20gJ29sL01hcC5qcyc7XG5pbXBvcnQgb2xWaWV3IGZyb20gJ29sL1ZpZXcuanMnO1xuaW1wb3J0IG9sQ29udHJvbFNjYWxlTGluZSBmcm9tICdvbC9jb250cm9sL1NjYWxlTGluZS5qcyc7XG5pbXBvcnQgb2xDb250cm9sWm9vbSBmcm9tICdvbC9jb250cm9sL1pvb20uanMnO1xuaW1wb3J0IG9sQ29udHJvbFJvdGF0ZSBmcm9tICdvbC9jb250cm9sL1JvdGF0ZS5qcyc7XG5pbXBvcnQgKiBhcyBvbEludGVyYWN0aW9uIGZyb20gJ29sL2ludGVyYWN0aW9uLmpzJztcbmV4cG9ydCB2YXIgQWJzdHJhY3RBUElDb250cm9sbGVyID0gZnVuY3Rpb24gKF9BYnN0cmFjdEFwcENvbnRyb2xsZSkge1xuICBBYnN0cmFjdEFQSUNvbnRyb2xsZXIuJGluamVjdCA9IFtcImNvbmZpZ1wiLCBcIiRzY29wZVwiLCBcIiRpbmplY3RvclwiXTtcblxuICBfaW5oZXJpdHNMb29zZShBYnN0cmFjdEFQSUNvbnRyb2xsZXIsIF9BYnN0cmFjdEFwcENvbnRyb2xsZSk7XG5cbiAgZnVuY3Rpb24gQWJzdHJhY3RBUElDb250cm9sbGVyKGNvbmZpZywgJHNjb3BlLCAkaW5qZWN0b3IpIHtcbiAgICB2YXIgdmlld0NvbmZpZyA9IHtcbiAgICAgIHByb2plY3Rpb246IG9sUHJvai5nZXQoXCJFUFNHOlwiICsgKGNvbmZpZy5zcmlkIHx8IDIwNTYpKVxuICAgIH07XG4gICAgT2JqZWN0LmFzc2lnbih2aWV3Q29uZmlnLCBjb25maWcubWFwVmlld0NvbmZpZyB8fCB7fSk7XG4gICAgdmFyIHNjYWxlbGluZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FsZWxpbmUnKTtcblxuICAgIGlmICghc2NhbGVsaW5lKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc2NhbGVsaW5lJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9BYnN0cmFjdEFwcENvbnRyb2xsZS5jYWxsKHRoaXMsIGNvbmZpZywgbmV3IG9sTWFwKHtcbiAgICAgIHBpeGVsUmF0aW86IGNvbmZpZy5tYXBQaXhlbFJhdGlvLFxuICAgICAgbGF5ZXJzOiBbXSxcbiAgICAgIHZpZXc6IG5ldyBvbFZpZXcodmlld0NvbmZpZyksXG4gICAgICBjb250cm9sczogY29uZmlnLm1hcENvbnRyb2xzIHx8IFtuZXcgb2xDb250cm9sU2NhbGVMaW5lKHtcbiAgICAgICAgdGFyZ2V0OiBzY2FsZWxpbmVcbiAgICAgIH0pLCBuZXcgb2xDb250cm9sWm9vbSh7XG4gICAgICAgIHRhcmdldDogJ29sLXpvb20tY29udHJvbCcsXG4gICAgICAgIHpvb21JblRpcExhYmVsOiAnJyxcbiAgICAgICAgem9vbU91dFRpcExhYmVsOiAnJ1xuICAgICAgfSksIG5ldyBvbENvbnRyb2xSb3RhdGUoe1xuICAgICAgICBsYWJlbDogZ2V0TG9jYXRpb25JY29uKCksXG4gICAgICAgIHRpcExhYmVsOiAnJ1xuICAgICAgfSldLFxuICAgICAgaW50ZXJhY3Rpb25zOiBjb25maWcubWFwSW50ZXJhY3Rpb25zIHx8IG9sSW50ZXJhY3Rpb24uZGVmYXVsdHMoe1xuICAgICAgICBwaW5jaFJvdGF0ZTogdHJ1ZSxcbiAgICAgICAgYWx0U2hpZnREcmFnUm90YXRlOiB0cnVlXG4gICAgICB9KVxuICAgIH0pLCAkc2NvcGUsICRpbmplY3RvcikgfHwgdGhpcztcbiAgfVxuXG4gIHJldHVybiBBYnN0cmFjdEFQSUNvbnRyb2xsZXI7XG59KEFic3RyYWN0QXBwQ29udHJvbGxlcik7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0dtZkFic3RyYWN0QVBJQ29udHJvbGxlck1vZHVsZScsIFtnbWZDb250cm9sbGVyc0Fic3RyYWN0QXBwQ29udHJvbGxlci5uYW1lLCBuZ2VvTWFwUmVzaXplbWFwLm5hbWVdKTtcbm1vZHVsZS5jb250cm9sbGVyKCdBYnN0cmFjdEFQSUNvbnRyb2xsZXInLCBBYnN0cmFjdEFQSUNvbnRyb2xsZXIpO1xubW9kdWxlLnZhbHVlKCdpc0Rlc2t0b3AnLCB0cnVlKTtcbm1vZHVsZS52YWx1ZSgnbmdlb1F1ZXJ5T3B0aW9ucycsIHtcbiAgJ2xpbWl0JzogMjBcbn0pO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIkFic3RyYWN0QXBwQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiY29uZmlnXCIsIFwibWFwXCIsIFwiJHNjb3BlXCIsIFwiJGluamVjdG9yXCJdO1xuaW1wb3J0ICdqcXVlcnknO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgJ2FuZ3VsYXItZ2V0dGV4dCc7XG5pbXBvcnQgJ2FuZ3VsYXItZHluYW1pYy1sb2NhbGUnO1xuaW1wb3J0IGJvb3RzdHJhcCBmcm9tICdnbWYvY29udHJvbGxlcnMvYm9vdHN0cmFwLmpzJztcbmltcG9ydCBnbWZBdXRoZW50aWNhdGlvbk1vZHVsZSBmcm9tICdnbWYvYXV0aGVudGljYXRpb24vbW9kdWxlLmpzJztcbmltcG9ydCBnbWZCYWNrZ3JvdW5kbGF5ZXJzZWxlY3RvckNvbXBvbmVudCBmcm9tICdnbWYvYmFja2dyb3VuZGxheWVyc2VsZWN0b3IvY29tcG9uZW50LmpzJztcbmltcG9ydCBnbWZEYXRhc291cmNlTW9kdWxlIGZyb20gJ2dtZi9kYXRhc291cmNlL21vZHVsZS5qcyc7XG5pbXBvcnQgZ21mRGlzY2xhaW1lckNvbXBvbmVudCBmcm9tICdnbWYvZGlzY2xhaW1lci9jb21wb25lbnQuanMnO1xuaW1wb3J0IGdtZkRyYXdpbmdNb2R1bGUgZnJvbSAnZ21mL2RyYXdpbmcvbW9kdWxlLmpzJztcbmltcG9ydCBnbWZGaWx0ZXJzTW9kdWxlIGZyb20gJ2dtZi9maWx0ZXJzL21vZHVsZS5qcyc7XG5pbXBvcnQgZ21mTGF5ZXJ0cmVlTW9kdWxlIGZyb20gJ2dtZi9sYXllcnRyZWUvbW9kdWxlLmpzJztcbmltcG9ydCBnbWZNYXBNb2R1bGUgZnJvbSAnZ21mL21hcC9tb2R1bGUuanMnO1xuaW1wb3J0IGdtZlF1ZXJ5RXh0cmFNb2R1bGUgZnJvbSAnZ21mL3F1ZXJ5L2V4dHJhTW9kdWxlLmpzJztcbmltcG9ydCBnbWZTZWFyY2hNb2R1bGUgZnJvbSAnZ21mL3NlYXJjaC9tb2R1bGUuanMnO1xuaW1wb3J0IGdtZlRoZW1lTW9kdWxlIGZyb20gJ2dtZi90aGVtZS9tb2R1bGUuanMnO1xuaW1wb3J0IG5nZW9NZXNzYWdlRGlzcGxheXdpbmRvd0NvbXBvbmVudCBmcm9tICduZ2VvL21lc3NhZ2UvZGlzcGxheXdpbmRvd0NvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb01pc2NFeHRyYU1vZHVsZSBmcm9tICduZ2VvL21pc2MvZXh0cmFNb2R1bGUuanMnO1xuaW1wb3J0IG5nZW9NaXNjRmVhdHVyZUhlbHBlciwgeyBGZWF0dXJlRm9ybWF0VHlwZSB9IGZyb20gJ25nZW8vbWlzYy9GZWF0dXJlSGVscGVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSBmcm9tICduZ2VvL21pc2MvVG9vbEFjdGl2YXRlLmpzJztcbmltcG9ydCBuZ2VvUXVlcnlNYXBRdWVyZW50IGZyb20gJ25nZW8vcXVlcnkvTWFwUXVlcmVudC5qcyc7XG5pbXBvcnQgbmdlb1F1ZXJ5Q29tcG9uZW50IGZyb20gJ25nZW8vcXVlcnkvY29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvU3RhdGVtYW5hZ2VyTW9kdWxlIGZyb20gJ25nZW8vc3RhdGVtYW5hZ2VyL21vZHVsZS5qcyc7XG5pbXBvcnQgbmdlb1N0YXRlbWFuYWdlcldmc1Blcm1hbGluayBmcm9tICduZ2VvL3N0YXRlbWFuYWdlci9XZnNQZXJtYWxpbmsuanMnO1xuaW1wb3J0IG5nZW9HZW9sb2NhdGlvbiBmcm9tICduZ2VvL2dlb2xvY2F0aW9uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgKiBhcyBvbEFycmF5IGZyb20gJ29sL2FycmF5LmpzJztcbmltcG9ydCB7IGxpc3RlbiB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xNYXAgZnJvbSAnb2wvTWFwLmpzJztcbmltcG9ydCBvbFN0eWxlQ2lyY2xlIGZyb20gJ29sL3N0eWxlL0NpcmNsZS5qcyc7XG5pbXBvcnQgb2xTdHlsZUZpbGwgZnJvbSAnb2wvc3R5bGUvRmlsbC5qcyc7XG5pbXBvcnQgb2xTdHlsZVN0cm9rZSBmcm9tICdvbC9zdHlsZS9TdHJva2UuanMnO1xuaW1wb3J0IG9sU3R5bGVTdHlsZSBmcm9tICdvbC9zdHlsZS9TdHlsZS5qcyc7XG5pbXBvcnQgeyBUaGVtZUV2ZW50VHlwZSB9IGZyb20gJ2dtZi90aGVtZS9NYW5hZ2VyLmpzJztcbmltcG9ydCB7IGdldEJyb3dzZXJMYW5ndWFnZSB9IGZyb20gJ25nZW8vdXRpbHMuanMnO1xuaW1wb3J0ICogYXMgU2VudHJ5IGZyb20gJ0BzZW50cnkvYnJvd3Nlcic7XG5leHBvcnQgZnVuY3Rpb24gQWJzdHJhY3RBcHBDb250cm9sbGVyKGNvbmZpZywgbWFwLCAkc2NvcGUsICRpbmplY3Rvcikge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHRoaXMubmdlb0xvY2F0aW9uID0gJGluamVjdG9yLmdldCgnbmdlb0xvY2F0aW9uJyk7XG5cbiAgaWYgKHRoaXMubmdlb0xvY2F0aW9uLmhhc1BhcmFtKCdkZWJ1ZycpKSB7XG4gICAgd2luZG93LmluamVjdG9yID0gJGluamVjdG9yO1xuICB9XG5cbiAgdGhpcy5tYXAgPSBtYXA7XG5cbiAgaWYgKCEodGhpcy5tYXAgaW5zdGFuY2VvZiBvbE1hcCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIG1hcCB0eXBlJyk7XG4gIH1cblxuICB2YXIgbmdlb0ZlYXR1cmVzID0gJGluamVjdG9yLmdldCgnbmdlb0ZlYXR1cmVzJyk7XG4gIHRoaXMuZHJhd0ZlYXR1cmVMYXllciA9ICRpbmplY3Rvci5nZXQoJ25nZW9GZWF0dXJlT3ZlcmxheU1ncicpLmdldEZlYXR1cmVPdmVybGF5KCk7XG4gIHRoaXMuZHJhd0ZlYXR1cmVMYXllci5zZXRGZWF0dXJlcyhuZ2VvRmVhdHVyZXMpO1xuICB2YXIgbmdlb0ZlYXR1cmVIZWxwZXIgPSAkaW5qZWN0b3IuZ2V0KCduZ2VvRmVhdHVyZUhlbHBlcicpO1xuICBuZ2VvRmVhdHVyZUhlbHBlci5zZXRQcm9qZWN0aW9uKHRoaXMubWFwLmdldFZpZXcoKS5nZXRQcm9qZWN0aW9uKCkpO1xuICB0aGlzLmdtZlRoZW1lTWFuYWdlciA9ICRpbmplY3Rvci5nZXQoJ2dtZlRoZW1lTWFuYWdlcicpO1xuICB0aGlzLmdtZlRyZWVNYW5hZ2VyXyA9ICRpbmplY3Rvci5nZXQoJ2dtZlRyZWVNYW5hZ2VyJyk7XG4gIHRoaXMuZ21mVGhlbWVzXyA9ICRpbmplY3Rvci5nZXQoJ2dtZlRoZW1lcycpO1xuICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICB0aGlzLmdtZlRoZW1lc18uZ2V0VGhlbWVzT2JqZWN0KCkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgX3RoaXMubG9hZGluZyA9IGZhbHNlO1xuICB9KTtcbiAgdGhpcy5wZXJtYWxpbmtfID0gJGluamVjdG9yLmdldCgnZ21mUGVybWFsaW5rJyk7XG4gIHZhciBnbWZBdXRoZW50aWNhdGlvbiA9ICRpbmplY3Rvci5nZXQoJ2dtZkF1dGhlbnRpY2F0aW9uU2VydmljZScpO1xuICB0aGlzLmhhc0VkaXRhYmxlTGF5ZXJzID0gZmFsc2U7XG5cbiAgdGhpcy51cGRhdGVIYXNFZGl0YWJsZUxheWVyc18gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB0aGlzLmdtZlRoZW1lc18uaGFzRWRpdGFibGVMYXllcnMoKS50aGVuKGZ1bmN0aW9uIChoYXNFZGl0YWJsZUxheWVycykge1xuICAgICAgX3RoaXMyLmhhc0VkaXRhYmxlTGF5ZXJzID0gaGFzRWRpdGFibGVMYXllcnM7XG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5sb2dpblJlZGlyZWN0VXJsID0gbnVsbDtcbiAgdGhpcy5sb2dpbkluZm9NZXNzYWdlID0gbnVsbDtcbiAgdGhpcy51c2VyTXVzdENoYW5nZUl0c1Bhc3N3b3JkID0gZmFsc2U7XG4gICRzY29wZS4kb24oJ2F1dGhlbnRpY2F0aW9ucmVxdWlyZWQnLCBmdW5jdGlvbiAoZXZlbnQsIGFyZ3MpIHtcbiAgICB2YXIgZ2V0dGV4dENhdGFsb2cgPSAkaW5qZWN0b3IuZ2V0KCdnZXR0ZXh0Q2F0YWxvZycpO1xuICAgIF90aGlzLmxvZ2luSW5mb01lc3NhZ2UgPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1NvbWUgbGF5ZXJzIGluIHRoaXMgbGluayBhcmUgbm90IGFjY2Vzc2libGUgdG8gdW5hdXRoZW50aWNhdGVkIHVzZXJzLiAnICsgJ1BsZWFzZSBsb2cgaW4gdG8gc2VlIHdob2xlIGRhdGEuJyk7XG4gICAgX3RoaXMubG9naW5SZWRpcmVjdFVybCA9IGFyZ3MudXJsO1xuICAgIF90aGlzLmxvZ2luQWN0aXZlID0gdHJ1ZTtcbiAgICB2YXIgdW5iaW5kID0gJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMubG9naW5BY3RpdmU7XG4gICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCFfdGhpcy5sb2dpbkFjdGl2ZSkge1xuICAgICAgICBfdGhpcy5sb2dpbkluZm9NZXNzYWdlID0gbnVsbDtcbiAgICAgICAgX3RoaXMubG9naW5SZWRpcmVjdFVybCA9IG51bGw7XG4gICAgICAgIHVuYmluZCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICB2YXIgdXNlckNoYW5nZSA9IGZ1bmN0aW9uIHVzZXJDaGFuZ2UoZXZ0KSB7XG4gICAgaWYgKF90aGlzLmdtZlVzZXIuaXNfcGFzc3dvcmRfY2hhbmdlZCA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoX3RoaXMubG9naW5SZWRpcmVjdFVybCkge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBfdGhpcy5sb2dpblJlZGlyZWN0VXJsO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciByb2xlSWQgPSBnbWZBdXRoZW50aWNhdGlvbi5nZXRSb2xlc0lkcygpLmpvaW4oJywnKTtcbiAgICB2YXIgZnVuY3Rpb25hbGl0aWVzID0gX3RoaXMuZ21mVXNlci5mdW5jdGlvbmFsaXRpZXM7XG5cbiAgICBpZiAoZnVuY3Rpb25hbGl0aWVzICYmIGZ1bmN0aW9uYWxpdGllcy5maWx0ZXJhYmxlX2xheWVycyAmJiBmdW5jdGlvbmFsaXRpZXMuZmlsdGVyYWJsZV9sYXllcnMubGVuZ3RoID4gMCkge1xuICAgICAgX3RoaXMuZmlsdGVyU2VsZWN0b3JFbmFibGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBfdGhpcy5nbWZUaGVtZXNfLmdldFRoZW1lc09iamVjdCgpLnRoZW4oZnVuY3Rpb24gKHRoZW1lcykge1xuICAgICAgaWYgKGZ1bmN0aW9uYWxpdGllcyAmJiBmdW5jdGlvbmFsaXRpZXMub3Blbl9wYW5lbCAmJiBmdW5jdGlvbmFsaXRpZXMub3Blbl9wYW5lbFswXSA9PT0gJ2xheWVyX2ZpbHRlcicpIHtcbiAgICAgICAgX3RoaXMuZmlsdGVyU2VsZWN0b3JBY3RpdmUgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdmFyIHByZXZpb3VzVGhlbWVOYW1lID0gX3RoaXMuZ21mVGhlbWVNYW5hZ2VyLmdldFRoZW1lTmFtZSgpO1xuXG4gICAgX3RoaXMuZ21mVGhlbWVNYW5hZ2VyLnNldFRoZW1lTmFtZSgnJywgdHJ1ZSk7XG5cbiAgICBfdGhpcy5nbWZUaGVtZXNfLmxvYWRUaGVtZXMocm9sZUlkKTtcblxuICAgIGlmIChldnQudHlwZSAhPT0gJ3JlYWR5Jykge1xuICAgICAgdmFyIHRoZW1lTmFtZSA9IF90aGlzLnBlcm1hbGlua18uZGVmYXVsdFRoZW1lTmFtZUZyb21GdW5jdGlvbmFsaXRpZXMoKTtcblxuICAgICAgX3RoaXMuZ21mVGhlbWVNYW5hZ2VyLnVwZGF0ZUN1cnJlbnRUaGVtZSh0aGVtZU5hbWUsIHByZXZpb3VzVGhlbWVOYW1lLCB0cnVlKTtcbiAgICB9XG5cbiAgICBfdGhpcy5zZXREZWZhdWx0QmFja2dyb3VuZF8obnVsbCk7XG5cbiAgICBfdGhpcy51cGRhdGVIYXNFZGl0YWJsZUxheWVyc18oKTtcbiAgfTtcblxuICBsaXN0ZW4oZ21mQXV0aGVudGljYXRpb24sICdyZWFkeScsIHVzZXJDaGFuZ2UpO1xuICBsaXN0ZW4oZ21mQXV0aGVudGljYXRpb24sICdsb2dpbicsIHVzZXJDaGFuZ2UpO1xuICBsaXN0ZW4oZ21mQXV0aGVudGljYXRpb24sICdsb2dvdXQnLCB1c2VyQ2hhbmdlKTtcbiAgdGhpcy5zZWFyY2hEYXRhc291cmNlcyA9IFt7XG4gICAgbGFiZWxLZXk6ICdsYWJlbCcsXG4gICAgZ3JvdXBWYWx1ZXM6ICRpbmplY3Rvci5nZXQoJ2dtZlNlYXJjaEdyb3VwcycpLFxuICAgIGdyb3VwQWN0aW9uczogJGluamVjdG9yLmdldCgnZ21mU2VhcmNoQWN0aW9ucycpLFxuICAgIHByb2plY3Rpb246IFwiRVBTRzpcIiArIChjb25maWcuc3JpZCB8fCAyMDU2KSxcbiAgICB1cmw6ICRpbmplY3Rvci5nZXQoJ2Z1bGx0ZXh0c2VhcmNoVXJsJylcbiAgfV07XG4gIHRoaXMuZGltZW5zaW9ucyA9IHt9O1xuICB0aGlzLnBlcm1hbGlua18uc2V0RGltZW5zaW9ucyh0aGlzLmRpbWVuc2lvbnMpO1xuICB2YXIgZ21mRGF0YVNvdXJjZXNNYW5hZ2VyID0gJGluamVjdG9yLmdldCgnZ21mRGF0YVNvdXJjZXNNYW5hZ2VyJyk7XG4gIGdtZkRhdGFTb3VyY2VzTWFuYWdlci5zZXREYXRhc291cmNlTWFwKHRoaXMubWFwKTtcbiAgZ21mRGF0YVNvdXJjZXNNYW5hZ2VyLnNldERpbWVuc2lvbnModGhpcy5kaW1lbnNpb25zKTtcblxuICBpZiAoJGluamVjdG9yLmhhcygnZ21mRGVmYXVsdERpbWVuc2lvbnMnKSkge1xuICAgIHZhciBkZWZhdWx0RGltZW5zaW9ucyA9ICRpbmplY3Rvci5nZXQoJ2dtZkRlZmF1bHREaW1lbnNpb25zJyk7XG5cbiAgICBmb3IgKHZhciBkaW0gaW4gZGVmYXVsdERpbWVuc2lvbnMpIHtcbiAgICAgIGlmICh0aGlzLmRpbWVuc2lvbnNbZGltXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMuZGltZW5zaW9uc1tkaW1dID0gZGVmYXVsdERpbWVuc2lvbnNbZGltXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0aGlzLmJhY2tncm91bmRMYXllck1ncl8gPSAkaW5qZWN0b3IuZ2V0KCduZ2VvQmFja2dyb3VuZExheWVyTWdyJyk7XG4gICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuZGltZW5zaW9ucztcbiAgfSwgZnVuY3Rpb24gKCkge1xuICAgIF90aGlzLmJhY2tncm91bmRMYXllck1ncl8udXBkYXRlRGltZW5zaW9ucyhfdGhpcy5tYXAsIF90aGlzLmRpbWVuc2lvbnMpO1xuICB9KTtcbiAgdGhpcy5iYWNrZ3JvdW5kTGF5ZXJNZ3JfLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgX3RoaXMuYmFja2dyb3VuZExheWVyTWdyXy51cGRhdGVEaW1lbnNpb25zKF90aGlzLm1hcCwgX3RoaXMuZGltZW5zaW9ucyk7XG4gIH0pO1xuICB0aGlzLmxlZnROYXZWaXNpYmxlID0gZmFsc2U7XG4gIHRoaXMucmlnaHROYXZWaXNpYmxlID0gZmFsc2U7XG4gIHZhciBxdWVyeUZpbGwgPSBuZXcgb2xTdHlsZUZpbGwoe1xuICAgIGNvbG9yOiBbMjU1LCAxNzAsIDAsIDAuNl1cbiAgfSk7XG4gIHZhciBxdWVyeVN0cm9rZSA9IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICBjb2xvcjogWzI1NSwgMTcwLCAwLCAxXSxcbiAgICB3aWR0aDogMlxuICB9KTtcbiAgdGhpcy5xdWVyeUZlYXR1cmVTdHlsZSA9IG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgIGZpbGw6IHF1ZXJ5RmlsbCxcbiAgICBpbWFnZTogbmV3IG9sU3R5bGVDaXJjbGUoe1xuICAgICAgZmlsbDogcXVlcnlGaWxsLFxuICAgICAgcmFkaXVzOiA1LFxuICAgICAgc3Ryb2tlOiBxdWVyeVN0cm9rZVxuICAgIH0pLFxuICAgIHN0cm9rZTogcXVlcnlTdHJva2VcbiAgfSk7XG4gIHRoaXMuZmlsdGVyU2VsZWN0b3JFbmFibGVkID0gZmFsc2U7XG4gIHRoaXMuZmlsdGVyU2VsZWN0b3JBY3RpdmUgPSBmYWxzZTtcbiAgdGhpcy5xdWVyeUFjdGl2ZSA9IHRydWU7XG4gIHRoaXMucXVlcnlBdXRvQ2xlYXIgPSB0cnVlO1xuICB0aGlzLnByaW50UGFuZWxBY3RpdmUgPSBmYWxzZTtcbiAgdGhpcy5jb250ZXh0ZGF0YUFjdGl2ZTtcbiAgdGhpcy5wcmludEFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLm5nZW9NYXBRdWVyZW50XyA9ICRpbmplY3Rvci5nZXQoJ25nZW9NYXBRdWVyZW50Jyk7XG4gICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5wcmludFBhbmVsQWN0aXZlO1xuICB9LCBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgaWYgKCFuZXdWYWwgJiYgIV90aGlzLnF1ZXJ5QWN0aXZlKSB7XG4gICAgICBfdGhpcy5uZ2VvTWFwUXVlcmVudF8uY2xlYXIoKTtcbiAgICB9XG5cbiAgICBfdGhpcy5xdWVyeUF1dG9DbGVhciA9ICFuZXdWYWw7XG4gICAgX3RoaXMucHJpbnRBY3RpdmUgPSBuZXdWYWw7XG4gIH0pO1xuICB0aGlzLm1lYXN1cmVBcmVhQWN0aXZlID0gZmFsc2U7XG4gIHRoaXMubWVhc3VyZVBvaW50QWN0aXZlID0gZmFsc2U7XG4gIHRoaXMubWVhc3VyZUxlbmd0aEFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLmRyYXdGZWF0dXJlQWN0aXZlID0gZmFsc2U7XG4gIHRoaXMuZHJhd1Byb2ZpbGVQYW5lbEFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLmdtZlVzZXIgPSAkaW5qZWN0b3IuZ2V0KCdnbWZVc2VyJyk7XG4gICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5nbWZVc2VyLmlzX3Bhc3N3b3JkX2NoYW5nZWQ7XG4gIH0sIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIF90aGlzLnVzZXJNdXN0Q2hhbmdlSXRzUGFzc3dvcmQgPSB2YWx1ZSA9PT0gZmFsc2U7XG4gIH0pO1xuICB0aGlzLnN0YXRlTWFuYWdlciA9ICRpbmplY3Rvci5nZXQoJ25nZW9TdGF0ZU1hbmFnZXInKTtcbiAgdGhpcy50bWhEeW5hbWljTG9jYWxlID0gJGluamVjdG9yLmdldCgndG1oRHluYW1pY0xvY2FsZScpO1xuICB0aGlzLiRzY29wZSA9ICRzY29wZTtcbiAgdGhpcy5sYW5nID0gJyc7XG4gIHRoaXMuZGVmYXVsdExhbmcgPSAkaW5qZWN0b3IuZ2V0KCdkZWZhdWx0TGFuZycpO1xuICB0aGlzLmxhbmdVcmxzID0gJGluamVjdG9yLmdldCgnbGFuZ1VybHMnKTtcbiAgdGhpcy5nZXR0ZXh0Q2F0YWxvZyA9ICRpbmplY3Rvci5nZXQoJ2dldHRleHRDYXRhbG9nJyk7XG4gIHRoaXMuaW5pdExhbmd1YWdlKCk7XG4gIHZhciBtYXBUb29scyA9ICdtYXBUb29scyc7XG4gIHRoaXMubWFwVG9vbHNHcm91cCA9IG1hcFRvb2xzO1xuICB2YXIgbmdlb0ZlYXR1cmVPdmVybGF5TWdyID0gJGluamVjdG9yLmdldCgnbmdlb0ZlYXR1cmVPdmVybGF5TWdyJyk7XG4gIG5nZW9GZWF0dXJlT3ZlcmxheU1nci5pbml0KHRoaXMubWFwKTtcbiAgdmFyIG5nZW9Ub29sQWN0aXZhdGVNZ3IgPSAkaW5qZWN0b3IuZ2V0KCduZ2VvVG9vbEFjdGl2YXRlTWdyJyk7XG4gIHZhciBxdWVyeVRvb2xBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSh0aGlzLCAncXVlcnlBY3RpdmUnKTtcbiAgbmdlb1Rvb2xBY3RpdmF0ZU1nci5yZWdpc3RlclRvb2wobWFwVG9vbHMsIHF1ZXJ5VG9vbEFjdGl2YXRlLCB0cnVlKTtcbiAgdmFyIG1lYXN1cmVBcmVhQWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUodGhpcywgJ21lYXN1cmVBcmVhQWN0aXZlJyk7XG4gIG5nZW9Ub29sQWN0aXZhdGVNZ3IucmVnaXN0ZXJUb29sKG1hcFRvb2xzLCBtZWFzdXJlQXJlYUFjdGl2YXRlLCBmYWxzZSk7XG4gIHZhciBtZWFzdXJlUG9pbnRBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSh0aGlzLCAnbWVhc3VyZVBvaW50QWN0aXZlJyk7XG4gIG5nZW9Ub29sQWN0aXZhdGVNZ3IucmVnaXN0ZXJUb29sKG1hcFRvb2xzLCBtZWFzdXJlUG9pbnRBY3RpdmF0ZSwgZmFsc2UpO1xuICB2YXIgbWVhc3VyZUxlbmd0aEFjdGl2YXRlID0gbmV3IG5nZW9NaXNjVG9vbEFjdGl2YXRlKHRoaXMsICdtZWFzdXJlTGVuZ3RoQWN0aXZlJyk7XG4gIG5nZW9Ub29sQWN0aXZhdGVNZ3IucmVnaXN0ZXJUb29sKG1hcFRvb2xzLCBtZWFzdXJlTGVuZ3RoQWN0aXZhdGUsIGZhbHNlKTtcbiAgdmFyIGRyYXdGZWF0dXJlQWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUodGhpcywgJ2RyYXdGZWF0dXJlQWN0aXZlJyk7XG4gIG5nZW9Ub29sQWN0aXZhdGVNZ3IucmVnaXN0ZXJUb29sKG1hcFRvb2xzLCBkcmF3RmVhdHVyZUFjdGl2YXRlLCBmYWxzZSk7XG4gIHZhciBkcmF3UHJvZmlsZVBhbmVsQWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUodGhpcywgJ2RyYXdQcm9maWxlUGFuZWxBY3RpdmUnKTtcbiAgbmdlb1Rvb2xBY3RpdmF0ZU1nci5yZWdpc3RlclRvb2wobWFwVG9vbHMsIGRyYXdQcm9maWxlUGFuZWxBY3RpdmF0ZSwgZmFsc2UpO1xuICB2YXIgcHJpbnRQYW5lbEFjdGl2YXRlID0gbmV3IG5nZW9NaXNjVG9vbEFjdGl2YXRlKHRoaXMsICdwcmludFBhbmVsQWN0aXZlJyk7XG4gIG5nZW9Ub29sQWN0aXZhdGVNZ3IucmVnaXN0ZXJUb29sKG1hcFRvb2xzLCBwcmludFBhbmVsQWN0aXZhdGUsIGZhbHNlKTtcbiAgdmFyIGNvbnRleHRkYXRhQWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUodGhpcywgJ2NvbnRleHRkYXRhQWN0aXZlJyk7XG4gIG5nZW9Ub29sQWN0aXZhdGVNZ3IucmVnaXN0ZXJUb29sKG1hcFRvb2xzLCBjb250ZXh0ZGF0YUFjdGl2YXRlLCBmYWxzZSk7XG4gICRzY29wZS4kcm9vdC4kb24oVGhlbWVFdmVudFR5cGUuVEhFTUVfTkFNRV9TRVQsIGZ1bmN0aW9uIChldmVudCwgbmFtZSkge1xuICAgIF90aGlzLmdtZlRoZW1lc18uZ2V0VGhlbWVPYmplY3QobmFtZSkudGhlbihmdW5jdGlvbiAodGhlbWUpIHtcbiAgICAgIF90aGlzLnNldERlZmF1bHRCYWNrZ3JvdW5kXyh0aGVtZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRoaXMudXBkYXRlQ3VycmVudEJhY2tncm91bmRMYXllcl8gPSBmdW5jdGlvbiAoc2tpcFBlcm1hbGluaykge1xuICAgIF90aGlzLmdtZlRoZW1lc18uZ2V0QmdMYXllcnMoKS50aGVuKGZ1bmN0aW9uIChsYXllcnMpIHtcbiAgICAgIHZhciBiYWNrZ3JvdW5kO1xuXG4gICAgICBpZiAoIXNraXBQZXJtYWxpbmspIHtcbiAgICAgICAgYmFja2dyb3VuZCA9IF90aGlzLnBlcm1hbGlua18uZ2V0QmFja2dyb3VuZExheWVyKGxheWVycyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghYmFja2dyb3VuZCkge1xuICAgICAgICB2YXIgZnVuY3Rpb25hbGl0aWVzID0gX3RoaXMuZ21mVXNlci5mdW5jdGlvbmFsaXRpZXM7XG5cbiAgICAgICAgaWYgKGZ1bmN0aW9uYWxpdGllcykge1xuICAgICAgICAgIHZhciBkZWZhdWx0QmFzZW1hcEFycmF5ID0gZnVuY3Rpb25hbGl0aWVzLmRlZmF1bHRfYmFzZW1hcDtcblxuICAgICAgICAgIGlmIChkZWZhdWx0QmFzZW1hcEFycmF5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QmFzZW1hcExhYmVsID0gZGVmYXVsdEJhc2VtYXBBcnJheVswXTtcbiAgICAgICAgICAgIGJhY2tncm91bmQgPSBvbEFycmF5LmZpbmQobGF5ZXJzLCBmdW5jdGlvbiAobGF5ZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGxheWVyLmdldCgnbGFiZWwnKSA9PT0gZGVmYXVsdEJhc2VtYXBMYWJlbDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIWJhY2tncm91bmQgJiYgbGF5ZXJzWzFdKSB7XG4gICAgICAgIGJhY2tncm91bmQgPSBsYXllcnNbMV07XG4gICAgICB9XG5cbiAgICAgIGlmIChiYWNrZ3JvdW5kKSB7XG4gICAgICAgIF90aGlzLmJhY2tncm91bmRMYXllck1ncl8uc2V0KF90aGlzLm1hcCwgYmFja2dyb3VuZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy51cGRhdGVDdXJyZW50QmFja2dyb3VuZExheWVyXyhmYWxzZSk7XG5cbiAgdmFyIG9wZW5Qb3B1cF8gPSBmdW5jdGlvbiBvcGVuUG9wdXBfKHRpdGxlLCBvcHRfd2lkdGgsIG9wdF9oZWlnaHQsIG9wdF9hcHBseSkge1xuICAgIF90aGlzLmRpc3BsYXl3aW5kb3dUaXRsZSA9IHRpdGxlO1xuICAgIF90aGlzLmRpc3BsYXl3aW5kb3dPcGVuID0gdHJ1ZTtcblxuICAgIGlmIChvcHRfd2lkdGgpIHtcbiAgICAgIF90aGlzLmRpc3BsYXl3aW5kb3dXaWR0aCA9IG9wdF93aWR0aCArIFwicHhcIjtcbiAgICB9XG5cbiAgICBpZiAob3B0X2hlaWdodCkge1xuICAgICAgX3RoaXMuZGlzcGxheXdpbmRvd0hlaWdodCA9IG9wdF9oZWlnaHQgKyBcInB4XCI7XG4gICAgfVxuXG4gICAgaWYgKG9wdF9hcHBseSAhPT0gZmFsc2UpIHtcbiAgICAgIF90aGlzLiRzY29wZS4kYXBwbHkoKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGdtZnggPSB3aW5kb3cuZ21meCB8fCB7fTtcbiAgd2luZG93LmdtZnggPSBnbWZ4O1xuXG4gIGdtZngub3BlbklmcmFtZVBvcHVwID0gZnVuY3Rpb24gKHVybCwgdGl0bGUsIG9wdF93aWR0aCwgb3B0X2hlaWdodCwgb3B0X2FwcGx5KSB7XG4gICAgX3RoaXMuZGlzcGxheXdpbmRvd1VybCA9IHVybDtcbiAgICBvcGVuUG9wdXBfKHRpdGxlLCBvcHRfd2lkdGgsIG9wdF9oZWlnaHQsIG9wdF9hcHBseSk7XG4gIH07XG5cbiAgZ21meC5vcGVuVGV4dFBvcHVwID0gZnVuY3Rpb24gKGNvbnRlbnQsIHRpdGxlLCBvcHRfd2lkdGgsIG9wdF9oZWlnaHQsIG9wdF9hcHBseSkge1xuICAgIF90aGlzLmRpc3BsYXl3aW5kb3dDb250ZW50ID0gY29udGVudDtcbiAgICBvcGVuUG9wdXBfKHRpdGxlLCBvcHRfd2lkdGgsIG9wdF9oZWlnaHQsIG9wdF9hcHBseSk7XG4gIH07XG5cbiAgdGhpcy5tYW5hZ2VSZXNpemUgPSBmYWxzZTtcbiAgdGhpcy5yZXNpemVUcmFuc2l0aW9uO1xuICB2YXIgY2d4cCA9IHdpbmRvdy5jZ3hwIHx8IHt9O1xuICB3aW5kb3cuY2d4cCA9IGNneHA7XG4gIGNneHAudG9vbHMgPSB3aW5kb3cuY2d4cC50b29scyB8fCB7fTtcblxuICBjZ3hwLnRvb2xzLm9wZW5JbmZvV2luZG93ID0gZnVuY3Rpb24gKHVybCwgdGl0bGUsIG9wdF93aWR0aCwgb3B0X2hlaWdodCwgb3B0X2FwcGx5KSB7XG4gICAgZ21meC5vcGVuSWZyYW1lUG9wdXAodXJsLCB0aXRsZSwgb3B0X3dpZHRoLCBvcHRfaGVpZ2h0LCBvcHRfYXBwbHkpO1xuICB9O1xuXG4gIHRoaXMuZGlzcGxheXdpbmRvd0NvbnRlbnQgPSBudWxsO1xuICB0aGlzLmRpc3BsYXl3aW5kb3dEcmFnZ2FibGVDb250YWlubWVudCA9ICcuZ21mLW1hcCc7XG4gIHRoaXMuZGlzcGxheXdpbmRvd0hlaWdodCA9ICc1MHZoJztcbiAgdGhpcy5kaXNwbGF5d2luZG93T3BlbiA9IGZhbHNlO1xuICB0aGlzLmRpc3BsYXl3aW5kb3dUaXRsZSA9IG51bGw7XG4gIHRoaXMuZGlzcGxheXdpbmRvd1VybCA9IG51bGw7XG4gIHRoaXMuZGlzcGxheXdpbmRvd1dpZHRoID0gJzUwdncnO1xuXG4gIGlmICgkaW5qZWN0b3IuaGFzKCdzZW50cnlPcHRpb25zJykpIHtcbiAgICB2YXIgb3B0aW9ucyA9ICRpbmplY3Rvci5nZXQoJ3NlbnRyeU9wdGlvbnMnKTtcbiAgICB2YXIgdGFncyA9IG9wdGlvbnMudGFncyB8fCBbXTtcbiAgICBkZWxldGUgb3B0aW9ucy50YWdzO1xuICAgIE9iamVjdC5hc3NpZ24ob3B0aW9ucywge1xuICAgICAgYmVmb3JlQnJlYWRjcnVtYjogYXVnbWVudEJyZWFkY3J1bWJcbiAgICB9KTtcbiAgICBTZW50cnkuaW5pdChvcHRpb25zKTtcblxuICAgIGZvciAodmFyIHRhZyBpbiB0YWdzKSB7XG4gICAgICBTZW50cnkuc2V0VGFnKHRhZywgdGFnc1t0YWddKTtcbiAgICB9XG4gIH1cblxuICB2YXIgcG9zaXRpb25GZWF0dXJlU3R5bGUgPSBjb25maWcucG9zaXRpb25GZWF0dXJlU3R5bGUgfHwgbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgaW1hZ2U6IG5ldyBvbFN0eWxlQ2lyY2xlKHtcbiAgICAgIHJhZGl1czogNixcbiAgICAgIGZpbGw6IG5ldyBvbFN0eWxlRmlsbCh7XG4gICAgICAgIGNvbG9yOiAncmdiYSgyMzAsIDEwMCwgMTAwLCAxKSdcbiAgICAgIH0pLFxuICAgICAgc3Ryb2tlOiBuZXcgb2xTdHlsZVN0cm9rZSh7XG4gICAgICAgIGNvbG9yOiAncmdiYSgyMzAsIDQwLCA0MCwgMSknLFxuICAgICAgICB3aWR0aDogMlxuICAgICAgfSlcbiAgICB9KVxuICB9KTtcbiAgdmFyIGFjY3VyYWN5RmVhdHVyZVN0eWxlID0gY29uZmlnLmFjY3VyYWN5RmVhdHVyZVN0eWxlIHx8IG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgIGZpbGw6IG5ldyBvbFN0eWxlRmlsbCh7XG4gICAgICBjb2xvcjogJ3JnYmEoMTAwLCAxMDAsIDIzMCwgMC4zKSdcbiAgICB9KSxcbiAgICBzdHJva2U6IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICAgIGNvbG9yOiAncmdiYSg0MCwgNDAsIDIzMCwgMSknLFxuICAgICAgd2lkdGg6IDJcbiAgICB9KVxuICB9KTtcbiAgdGhpcy5nZW9sb2NhdGlvbk9wdGlvbnMgPSB7XG4gICAgcG9zaXRpb25GZWF0dXJlU3R5bGU6IHBvc2l0aW9uRmVhdHVyZVN0eWxlLFxuICAgIGFjY3VyYWN5RmVhdHVyZVN0eWxlOiBhY2N1cmFjeUZlYXR1cmVTdHlsZSxcbiAgICB6b29tOiBjb25maWcuZ2VvbG9jYXRpb25ab29tLFxuICAgIGF1dG9yb3RhdGU6IGNvbmZpZy5hdXRvcm90YXRlXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldExheWVyQnlMYWJlbHMobGF5ZXJzLCBsYWJlbHMpIHtcbiAgaWYgKGxhYmVscyAmJiBsYWJlbHMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBvbEFycmF5LmZpbmQobGF5ZXJzLCBmdW5jdGlvbiAobGF5ZXIpIHtcbiAgICAgIHJldHVybiBsYXllci5nZXQoJ2xhYmVsJykgPT09IGxhYmVsc1swXTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG5BYnN0cmFjdEFwcENvbnRyb2xsZXIucHJvdG90eXBlLnN3aXRjaExhbmd1YWdlID0gZnVuY3Rpb24gKGxhbmcpIHtcbiAgaWYgKCEobGFuZyBpbiB0aGlzLmxhbmdVcmxzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsYW5nIFVSTCcpO1xuICB9XG5cbiAgdGhpcy5nZXR0ZXh0Q2F0YWxvZy5zZXRDdXJyZW50TGFuZ3VhZ2UobGFuZyk7XG4gIHRoaXMuZ2V0dGV4dENhdGFsb2cubG9hZFJlbW90ZSh0aGlzLmxhbmdVcmxzW2xhbmddKTtcbiAgdGhpcy50bWhEeW5hbWljTG9jYWxlLnNldChsYW5nKTtcbiAgdGhpcy5sYW5nID0gbGFuZztcbn07XG5cbkFic3RyYWN0QXBwQ29udHJvbGxlci5wcm90b3R5cGUuaW5pdExhbmd1YWdlID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMzID0gdGhpcztcblxuICB0aGlzLiRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpczMubGFuZztcbiAgfSwgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgX3RoaXMzLnN0YXRlTWFuYWdlci51cGRhdGVTdGF0ZSh7XG4gICAgICAnbGFuZyc6IG5ld1ZhbHVlXG4gICAgfSk7XG4gIH0pO1xuICB2YXIgYnJvd3Nlckxhbmd1YWdlID0gZ2V0QnJvd3Nlckxhbmd1YWdlKE9iamVjdC5rZXlzKHRoaXMubGFuZ1VybHMpKTtcbiAgdmFyIHVybExhbmd1YWdlID0gdGhpcy5zdGF0ZU1hbmFnZXIuZ2V0SW5pdGlhbFN0cmluZ1ZhbHVlKCdsYW5nJyk7XG5cbiAgaWYgKHVybExhbmd1YWdlICE9PSB1bmRlZmluZWQgJiYgdXJsTGFuZ3VhZ2UgaW4gdGhpcy5sYW5nVXJscykge1xuICAgIHRoaXMuc3dpdGNoTGFuZ3VhZ2UodXJsTGFuZ3VhZ2UpO1xuICAgIHJldHVybjtcbiAgfSBlbHNlIGlmIChicm93c2VyTGFuZ3VhZ2UgIT09IHVuZGVmaW5lZCAmJiBicm93c2VyTGFuZ3VhZ2UgaW4gdGhpcy5sYW5nVXJscykge1xuICAgIHRoaXMuc3dpdGNoTGFuZ3VhZ2UoYnJvd3Nlckxhbmd1YWdlKTtcbiAgICByZXR1cm47XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5zd2l0Y2hMYW5ndWFnZSh0aGlzLmRlZmF1bHRMYW5nKTtcbiAgICByZXR1cm47XG4gIH1cbn07XG5cbkFic3RyYWN0QXBwQ29udHJvbGxlci5wcm90b3R5cGUuc2V0RGVmYXVsdEJhY2tncm91bmRfID0gZnVuY3Rpb24gKHRoZW1lKSB7XG4gIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gIHRoaXMuZ21mVGhlbWVzXy5nZXRCZ0xheWVycygpLnRoZW4oZnVuY3Rpb24gKGxheWVycykge1xuICAgIHZhciBsYXllcjtcbiAgICBsYXllciA9IF90aGlzNC5wZXJtYWxpbmtfLmdldEJhY2tncm91bmRMYXllcihsYXllcnMpO1xuXG4gICAgaWYgKCFsYXllciAmJiBfdGhpczQuZ21mVXNlci5mdW5jdGlvbmFsaXRpZXMpIHtcbiAgICAgIGxheWVyID0gZ2V0TGF5ZXJCeUxhYmVscyhsYXllcnMsIF90aGlzNC5nbWZVc2VyLmZ1bmN0aW9uYWxpdGllcy5kZWZhdWx0X2Jhc2VtYXApO1xuICAgIH1cblxuICAgIGlmICghbGF5ZXIgJiYgdGhlbWUpIHtcbiAgICAgIGxheWVyID0gZ2V0TGF5ZXJCeUxhYmVscyhsYXllcnMsIHRoZW1lLmZ1bmN0aW9uYWxpdGllcy5kZWZhdWx0X2Jhc2VtYXApO1xuICAgIH1cblxuICAgIGlmICghbGF5ZXIpIHtcbiAgICAgIGxheWVyID0gbGF5ZXJzW2xheWVycy5sZW5ndGggPiAxID8gMSA6IDBdO1xuICAgIH1cblxuICAgIGlmICghbGF5ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsYXllcicpO1xuICAgIH1cblxuICAgIF90aGlzNC5iYWNrZ3JvdW5kTGF5ZXJNZ3JfLnNldChfdGhpczQubWFwLCBsYXllcik7XG4gIH0pO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldExvY2F0aW9uSWNvbigpIHtcbiAgdmFyIGFycm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICBhcnJvdy5jbGFzc05hbWUgPSAnZmEgZmEtbG9jYXRpb24tYXJyb3cnO1xuICBhcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKC0wLjgycmFkKSc7XG4gIHZhciBhcnJvd1dyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIGFycm93V3JhcHBlci5hcHBlbmRDaGlsZChhcnJvdyk7XG4gIHJldHVybiBhcnJvd1dyYXBwZXI7XG59XG5cbmZ1bmN0aW9uIGF1Z21lbnRCcmVhZGNydW1iKGJyZWFkY3J1bWIsIGhpbnQpIHtcbiAgaWYgKGJyZWFkY3J1bWIuY2F0ZWdvcnkgPT09ICd1aS5jbGljaycpIHtcbiAgICB2YXIgdGFyZ2V0ID0gaGludC5ldmVudC50YXJnZXQ7XG5cbiAgICBpZiAodGFyZ2V0KSB7XG4gICAgICB2YXIgbWVzc2FnZSA9IHRhcmdldC5kYXRhc2V0LnNlbnRyeTtcblxuICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgYnJlYWRjcnVtYi5tZXNzYWdlID0gYnJlYWRjcnVtYi5tZXNzYWdlICsgXCIgfCBcIiArIG1lc3NhZ2U7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnR21mQWJzdHJhY3RBcHBDb250cm9sbGVyTW9kdWxlJywgWydnZXR0ZXh0JywgJ3RtaC5keW5hbWljTG9jYWxlJywgZ21mQXV0aGVudGljYXRpb25Nb2R1bGUubmFtZSwgZ21mQmFja2dyb3VuZGxheWVyc2VsZWN0b3JDb21wb25lbnQubmFtZSwgZ21mRGF0YXNvdXJjZU1vZHVsZS5uYW1lLCBnbWZEaXNjbGFpbWVyQ29tcG9uZW50Lm5hbWUsIGdtZkRyYXdpbmdNb2R1bGUubmFtZSwgZ21mRmlsdGVyc01vZHVsZS5uYW1lLCBnbWZMYXllcnRyZWVNb2R1bGUubmFtZSwgZ21mTWFwTW9kdWxlLm5hbWUsIGdtZlF1ZXJ5RXh0cmFNb2R1bGUubmFtZSwgZ21mU2VhcmNoTW9kdWxlLm5hbWUsIGdtZlRoZW1lTW9kdWxlLm5hbWUsIG5nZW9NZXNzYWdlRGlzcGxheXdpbmRvd0NvbXBvbmVudC5uYW1lLCBuZ2VvTWlzY0V4dHJhTW9kdWxlLm5hbWUsIG5nZW9NaXNjRmVhdHVyZUhlbHBlci5uYW1lLCBuZ2VvUXVlcnlNYXBRdWVyZW50Lm5hbWUsIG5nZW9RdWVyeUNvbXBvbmVudC5uYW1lLCBuZ2VvU3RhdGVtYW5hZ2VyTW9kdWxlLm5hbWUsIG5nZW9TdGF0ZW1hbmFnZXJXZnNQZXJtYWxpbmsubmFtZSwgbmdlb0dlb2xvY2F0aW9uLm5hbWVdKTtcbm1vZHVsZS5jb250cm9sbGVyKCdBYnN0cmFjdENvbnRyb2xsZXInLCBBYnN0cmFjdEFwcENvbnRyb2xsZXIpO1xubW9kdWxlLnZhbHVlKCduZ2VvRXhwb3J0RmVhdHVyZUZvcm1hdHMnLCBbRmVhdHVyZUZvcm1hdFR5cGUuS01MLCBGZWF0dXJlRm9ybWF0VHlwZS5HUFhdKTtcbm1vZHVsZS5jb25maWcoWyd0bWhEeW5hbWljTG9jYWxlUHJvdmlkZXInLCAnYW5ndWxhckxvY2FsZVNjcmlwdCcsIGZ1bmN0aW9uICh0bWhEeW5hbWljTG9jYWxlUHJvdmlkZXIsIGFuZ3VsYXJMb2NhbGVTY3JpcHQpIHtcbiAgdG1oRHluYW1pY0xvY2FsZVByb3ZpZGVyLmxvY2FsZUxvY2F0aW9uUGF0dGVybihhbmd1bGFyTG9jYWxlU2NyaXB0KTtcbn1dKTtcbmJvb3RzdHJhcChtb2R1bGUpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mQ29udHJvbGxlcnNBYnN0cmFjdEFQSUNvbnRyb2xsZXIsIHsgQWJzdHJhY3RBUElDb250cm9sbGVyIH0gZnJvbSAnZ21mL2NvbnRyb2xsZXJzL0Fic3RyYWN0QVBJQ29udHJvbGxlci5qcyc7XG5pbXBvcnQgZ21mQ29udGV4dHVhbGRhdGFNb2R1bGUgZnJvbSAnZ21mL2NvbnRleHR1YWxkYXRhL21vZHVsZS5qcyc7XG5pbXBvcnQgZ21mRGF0YXNvdXJjZURhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkIGZyb20gJ2dtZi9kYXRhc291cmNlL0RhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkLmpzJztcbmltcG9ydCBnbWZFZGl0aW5nTW9kdWxlIGZyb20gJ2dtZi9lZGl0aW5nL21vZHVsZS5qcyc7XG5pbXBvcnQgZ21mUGVybWFsaW5rU2hhcmVDb21wb25lbnQgZnJvbSAnZ21mL3Blcm1hbGluay9zaGFyZUNvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mUHJpbnRNb2R1bGUgZnJvbSAnZ21mL3ByaW50L21vZHVsZS5qcyc7XG5pbXBvcnQgZ21mUHJvZmlsZU1vZHVsZSBmcm9tICdnbWYvcHJvZmlsZS9tb2R1bGUuanMnO1xuaW1wb3J0IGdtZlJhc3RlckNvbXBvbmVudCBmcm9tICdnbWYvcmFzdGVyL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb01hcHN3aXBlTW9kdWxlIGZyb20gJ25nZW8vbWFwL3N3aXBlLmpzJztcbmltcG9ydCBuZ2VvRHJhd0ZlYXR1cmVzIGZyb20gJ25nZW8vZHJhdy9mZWF0dXJlcy5qcyc7XG5pbXBvcnQgbmdlb01pc2NUb29sQWN0aXZhdGUgZnJvbSAnbmdlby9taXNjL1Rvb2xBY3RpdmF0ZS5qcyc7XG5pbXBvcnQgbmdlb1F1ZXJ5UGFuZWxDb21wb25lbnQgZnJvbSAnbmdlby9xdWVyeS9wYW5lbENvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mSW1wb3J0TW9kdWxlIGZyb20gJ2dtZi9pbXBvcnQvbW9kdWxlLmpzJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4gfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sTGF5ZXJWZWN0b3IgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yLmpzJztcbmltcG9ydCBvbFNvdXJjZVZlY3RvciBmcm9tICdvbC9zb3VyY2UvVmVjdG9yLmpzJztcbmltcG9ydCBvbFN0eWxlRmlsbCBmcm9tICdvbC9zdHlsZS9GaWxsLmpzJztcbmltcG9ydCBvbFN0eWxlU3Ryb2tlIGZyb20gJ29sL3N0eWxlL1N0cm9rZS5qcyc7XG5pbXBvcnQgb2xTdHlsZVN0eWxlIGZyb20gJ29sL3N0eWxlL1N0eWxlLmpzJztcbmltcG9ydCBvbFN0eWxlVGV4dCBmcm9tICdvbC9zdHlsZS9UZXh0LmpzJztcbmV4cG9ydCB2YXIgQWJzdHJhY3REZXNrdG9wQ29udHJvbGxlciA9IGZ1bmN0aW9uIChfQWJzdHJhY3RBUElDb250cm9sbGUpIHtcbiAgQWJzdHJhY3REZXNrdG9wQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiY29uZmlnXCIsIFwiJHNjb3BlXCIsIFwiJGluamVjdG9yXCJdO1xuXG4gIF9pbmhlcml0c0xvb3NlKEFic3RyYWN0RGVza3RvcENvbnRyb2xsZXIsIF9BYnN0cmFjdEFQSUNvbnRyb2xsZSk7XG5cbiAgZnVuY3Rpb24gQWJzdHJhY3REZXNrdG9wQ29udHJvbGxlcihjb25maWcsICRzY29wZSwgJGluamVjdG9yKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX3RoaXMgPSBfQWJzdHJhY3RBUElDb250cm9sbGUuY2FsbCh0aGlzLCBjb25maWcsICRzY29wZSwgJGluamVjdG9yKSB8fCB0aGlzO1xuICAgIF90aGlzLmRhdGFQYW5lbEFjdGl2ZSA9IHRydWU7XG4gICAgX3RoaXMubG9naW5BY3RpdmUgPSBmYWxzZTtcbiAgICBfdGhpcy50b29sc0FjdGl2ZSA9IGZhbHNlO1xuICAgIF90aGlzLm1vZGFsU2hhcmVTaG93biA9IGZhbHNlO1xuICAgIF90aGlzLmVkaXRGZWF0dXJlQWN0aXZlID0gZmFsc2U7XG4gICAgX3RoaXMucXVlcnlQYW5lbEFjdGl2ZSA9IGZhbHNlO1xuICAgIF90aGlzLnJvdXRpbmdmZWF0dXJlQWN0aXZlID0gZmFsc2U7XG4gICAgX3RoaXMuZ29vZ2xlU3RyZWV0Vmlld0FjdGl2ZSA9IGZhbHNlO1xuICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF90aGlzLmdvb2dsZVN0cmVldFZpZXdBY3RpdmU7XG4gICAgfSwgZnVuY3Rpb24gKG5ld1ZhbCkge1xuICAgICAgX3RoaXMuc2V0RGF0YVBhbmVsTWF4UmVzaXphYmxlV2lkdGhfKCk7XG4gICAgfSk7XG4gICAgX3RoaXMuZ29vZ2xlU3RyZWV0Vmlld1N0eWxlID0gbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICB0ZXh0OiBuZXcgb2xTdHlsZVRleHQoe1xuICAgICAgICBmaWxsOiBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgICAgIGNvbG9yOiAnIzI3OUI2MSdcbiAgICAgICAgfSksXG4gICAgICAgIGZvbnQ6ICc5MDAgMzBweCBcIkZvbnQgQXdlc29tZSA1IEZyZWVcIicsXG4gICAgICAgIG9mZnNldFk6IC0xNSxcbiAgICAgICAgc3Ryb2tlOiBuZXcgb2xTdHlsZVN0cm9rZSh7XG4gICAgICAgICAgY29sb3I6ICcjZmZmZmZmJyxcbiAgICAgICAgICB3aWR0aDogM1xuICAgICAgICB9KSxcbiAgICAgICAgdGV4dDogXCJcXHVGMDQxXCJcbiAgICAgIH0pXG4gICAgfSk7XG4gICAgX3RoaXMuaW1wb3J0RGF0YVNvdXJjZUFjdGl2ZSA9IGZhbHNlO1xuICAgIHZhciBib2R5ID0gJCgnYm9keScpO1xuICAgIGJvZHkudG9vbHRpcCh7XG4gICAgICBjb250YWluZXI6ICdib2R5JyxcbiAgICAgIHRyaWdnZXI6ICdob3ZlcicsXG4gICAgICBzZWxlY3RvcjogJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nLFxuICAgICAgc2FuaXRpemVGbjogJGluamVjdG9yLmdldCgnJHNhbml0aXplJylcbiAgICB9KTtcbiAgICBib2R5Lm9uKCd0b3VjaHN0YXJ0LmRldGVjdFRvdWNoJywgZnVuY3Rpb24gKCkge1xuICAgICAgYm9keS50b29sdGlwKCdkaXNwb3NlJyk7XG4gICAgICBib2R5Lm9mZigndG91Y2hzdGFydC5kZXRlY3RUb3VjaCcpO1xuICAgIH0pO1xuICAgIHZhciBuZ2VvRmVhdHVyZUhlbHBlciA9ICRpbmplY3Rvci5nZXQoJ25nZW9GZWF0dXJlSGVscGVyJyk7XG4gICAgX3RoaXMuZWRpdEZlYXR1cmVWZWN0b3JMYXllciA9IG5ldyBvbExheWVyVmVjdG9yKHtcbiAgICAgIHNvdXJjZTogbmV3IG9sU291cmNlVmVjdG9yKHtcbiAgICAgICAgd3JhcFg6IGZhbHNlLFxuICAgICAgICBmZWF0dXJlczogbmV3IG9sQ29sbGVjdGlvbigpXG4gICAgICB9KSxcbiAgICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShmZWF0dXJlLCByZXNvbHV0aW9uKSB7XG4gICAgICAgIHJldHVybiBuZ2VvRmVhdHVyZUhlbHBlci5jcmVhdGVFZGl0aW5nU3R5bGVzKGZlYXR1cmUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgX3RoaXMuZWRpdEZlYXR1cmVWZWN0b3JMYXllci5zZXRNYXAoX3RoaXMubWFwKTtcblxuICAgIHZhciBuZ2VvVG9vbEFjdGl2YXRlTWdyID0gJGluamVjdG9yLmdldCgnbmdlb1Rvb2xBY3RpdmF0ZU1ncicpO1xuICAgIF90aGlzLmdtZkRhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkID0gJGluamVjdG9yLmdldCgnZ21mRGF0YVNvdXJjZUJlaW5nRmlsdGVyZWQnKTtcbiAgICBfdGhpcy5nbWZMYXllckJlaW5nU3dpcGUgPSAkaW5qZWN0b3IuZ2V0KCdnbWZMYXllckJlaW5nU3dpcGUnKTtcbiAgICB2YXIgZWRpdEZlYXR1cmVBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgJ2VkaXRGZWF0dXJlQWN0aXZlJyk7XG4gICAgbmdlb1Rvb2xBY3RpdmF0ZU1nci5yZWdpc3RlclRvb2woJ21hcFRvb2xzJywgZWRpdEZlYXR1cmVBY3RpdmF0ZSwgZmFsc2UpO1xuICAgIHZhciBnb29nbGVTdHJlZXRWaWV3QWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICdnb29nbGVTdHJlZXRWaWV3QWN0aXZlJyk7XG4gICAgbmdlb1Rvb2xBY3RpdmF0ZU1nci5yZWdpc3RlclRvb2woJ21hcFRvb2xzJywgZ29vZ2xlU3RyZWV0Vmlld0FjdGl2YXRlLCBmYWxzZSk7XG4gICAgX3RoaXMuc2NhbGVTZWxlY3Rvck9wdGlvbnMgPSB7XG4gICAgICBkcm9wdXA6IHRydWVcbiAgICB9O1xuICAgIF90aGlzLnByb2ZpbGVMaW5lID0gbnVsbDtcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5nbWZVc2VyLnVzZXJuYW1lO1xuICAgIH0sIGZ1bmN0aW9uIChuZXdWYWwpIHtcbiAgICAgIGlmIChuZXdWYWwgIT09IG51bGwgJiYgX3RoaXMubG9naW5BY3RpdmUpIHtcbiAgICAgICAgX3RoaXMubG9naW5BY3RpdmUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfdGhpcy5kYXRhUGFuZWxNaW5SZXNpemFibGVXaWR0aF8gPSAzMjA7XG4gICAgdmFyIGRhdGFQYW5lbENscyA9ICdnbWYtYXBwLWRhdGEtcGFuZWwnO1xuICAgIHZhciAkZGF0YVBhbmVsID0gJChcIi5cIiArIGRhdGFQYW5lbENscykucmVzaXphYmxlKHtcbiAgICAgICdnaG9zdCc6IHRydWUsXG4gICAgICAnaGFuZGxlcyc6ICdlJyxcbiAgICAgICdtaW5XaWR0aCc6IF90aGlzLmRhdGFQYW5lbE1pblJlc2l6YWJsZVdpZHRoXyxcbiAgICAgICdzdG9wJzogZnVuY3Rpb24gc3RvcChldmVudCwgdWkpIHtcbiAgICAgICAgX3RoaXMubWFwLnVwZGF0ZVNpemUoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfdGhpcy4kZGF0YVBhbmVsXyA9ICRkYXRhUGFuZWw7XG4gICAgdmFyICRyZXNpemFibGVFYXN0SGFuZGxlID0gJGRhdGFQYW5lbC5maW5kKCcudWktcmVzaXphYmxlLWUnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICBfdGhpcy5kYXRhUGFuZWxBY3RpdmUgPSAhX3RoaXMuZGF0YVBhbmVsQWN0aXZlO1xuXG4gICAgICBfdGhpcy4kc2NvcGUuJGFwcGx5KCk7XG4gICAgfSk7XG4gICAgJCgnPGRpdj4nLCB7XG4gICAgICAnY2xhc3MnOiBkYXRhUGFuZWxDbHMgKyBcIi10b2dnbGUtYnRuIGJ0biBwcmltZSBidG4tc21cIlxuICAgIH0pLmFwcGVuZFRvKCRyZXNpemFibGVFYXN0SGFuZGxlKS5hcHBlbmQoJCgnPHNwYW4+Jywge1xuICAgICAgJ2NsYXNzJzogXCJmYSBmYS1hbmdsZS1kb3VibGUtbGVmdCBcIiArIGRhdGFQYW5lbENscyArIFwiLWNvbGxhcHNlLWJ0blwiXG4gICAgfSkpLmFwcGVuZCgkKCc8c3Bhbj4nLCB7XG4gICAgICAnY2xhc3MnOiBcImZhIGZhLWFuZ2xlLWRvdWJsZS1yaWdodCBcIiArIGRhdGFQYW5lbENscyArIFwiLWV4cGFuZC1idG5cIlxuICAgIH0pKTtcbiAgICB2YXIgbmdlb0RlYm91bmNlID0gJGluamVjdG9yLmdldCgnbmdlb0RlYm91bmNlJyk7XG4gICAgbGlzdGVuKHdpbmRvdywgJ3Jlc2l6ZScsIG5nZW9EZWJvdW5jZShfdGhpcy5zZXREYXRhUGFuZWxNYXhSZXNpemFibGVXaWR0aF8uYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSksIDUwLCB0cnVlKSk7XG5cbiAgICBfdGhpcy5zZXREYXRhUGFuZWxNYXhSZXNpemFibGVXaWR0aF8oKTtcblxuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBBYnN0cmFjdERlc2t0b3BDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uc2V0RGF0YVBhbmVsTWF4UmVzaXphYmxlV2lkdGhfID0gZnVuY3Rpb24gc2V0RGF0YVBhbmVsTWF4UmVzaXphYmxlV2lkdGhfKCkge1xuICAgIHZhciByaWdodFBhbmVsV2lkdGggPSAzMjA7XG5cbiAgICBpZiAodGhpcy5nb29nbGVTdHJlZXRWaWV3QWN0aXZlKSB7XG4gICAgICByaWdodFBhbmVsV2lkdGggKz0gMTQwO1xuICAgIH1cblxuICAgIHZhciBtaW5pbXVtTWFwV2lkdGggPSAxMjA7XG4gICAgdmFyIHdpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgdmFyIG1heFdpZHRoID0gd2luZG93V2lkdGggLSByaWdodFBhbmVsV2lkdGggLSBtaW5pbXVtTWFwV2lkdGg7XG5cbiAgICBpZiAobWF4V2lkdGggPCB0aGlzLmRhdGFQYW5lbE1pblJlc2l6YWJsZVdpZHRoXykge1xuICAgICAgbWF4V2lkdGggPSB0aGlzLmRhdGFQYW5lbE1pblJlc2l6YWJsZVdpZHRoXztcbiAgICB9XG5cbiAgICB0aGlzLiRkYXRhUGFuZWxfLnJlc2l6YWJsZSgnb3B0aW9uJywgJ21heFdpZHRoJywgbWF4V2lkdGgpO1xuICAgIHZhciB3aWR0aCA9IHRoaXMuJGRhdGFQYW5lbF8ud2lkdGgoKTtcblxuICAgIGlmICghd2lkdGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB3aWR0aCcpO1xuICAgIH1cblxuICAgIGlmICh3aWR0aCA+IG1heFdpZHRoKSB7XG4gICAgICB0aGlzLiRkYXRhUGFuZWxfLndpZHRoKG1heFdpZHRoKTtcbiAgICAgIHRoaXMubWFwLnVwZGF0ZVNpemUoKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIEFic3RyYWN0RGVza3RvcENvbnRyb2xsZXI7XG59KEFic3RyYWN0QVBJQ29udHJvbGxlcik7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0dtZkFic3RyYWN0RGVza3RvcENvbnRyb2xsZXJNb2R1bGUnLCBbbmdlb1F1ZXJ5UGFuZWxDb21wb25lbnQubmFtZSwgZ21mQ29udHJvbGxlcnNBYnN0cmFjdEFQSUNvbnRyb2xsZXIubmFtZSwgZ21mQ29udGV4dHVhbGRhdGFNb2R1bGUubmFtZSwgZ21mRGF0YXNvdXJjZURhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkLm5hbWUsIGdtZkVkaXRpbmdNb2R1bGUubmFtZSwgZ21mUGVybWFsaW5rU2hhcmVDb21wb25lbnQubmFtZSwgZ21mUHJpbnRNb2R1bGUubmFtZSwgZ21mUHJvZmlsZU1vZHVsZS5uYW1lLCBnbWZSYXN0ZXJDb21wb25lbnQubmFtZSwgbmdlb0RyYXdGZWF0dXJlcy5uYW1lLCBnbWZJbXBvcnRNb2R1bGUubmFtZSwgbmdlb01hcHN3aXBlTW9kdWxlLm5hbWVdKTtcbm1vZHVsZS5jb250cm9sbGVyKCdBYnN0cmFjdERlc2t0b3BDb250cm9sbGVyJywgQWJzdHJhY3REZXNrdG9wQ29udHJvbGxlcik7XG5tb2R1bGUudmFsdWUoJ25nZW9NZWFzdXJlUHJlY2lzaW9uJywgMyk7XG5tb2R1bGUudmFsdWUoJ25nZW9NZWFzdXJlRGVjaW1hbHMnLCAwKTtcbm1vZHVsZS52YWx1ZSgnbmdlb1NuYXBwaW5nVG9sZXJhbmNlJywgMjApO1xubW9kdWxlLnZhbHVlKCduZ2VvU25hcHBpbmdTb3VyY2UnLCBuZXcgb2xTb3VyY2VWZWN0b3IoKSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuXG5mdW5jdGlvbiBib290c3RyYXAobW9kdWxlKSB7XG4gIHZhciBvbGRPYmplY3RUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbiAgaWYgKCFvbGRPYmplY3RUb1N0cmluZy50b1N0cmluZygpLmluY2x1ZGVzKCdbbmF0aXZlIGNvZGVdJykpIHtcbiAgICBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuICdbb2JqZWN0IE51bGxdJztcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gJ1tvYmplY3QgVW5kZWZpbmVkXSc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvbGRPYmplY3RUb1N0cmluZy5jYWxsKHRoaXMpO1xuICAgIH07XG4gIH1cblxuICB2YXIgaW50ZXJmYWNlXyA9ICQoJ21ldGFbbmFtZT1pbnRlcmZhY2VdJylbMF0uZ2V0QXR0cmlidXRlKCdjb250ZW50Jyk7XG4gIHZhciBkeW5hbWljVXJsXyA9ICQoJ21ldGFbbmFtZT1keW5hbWljVXJsXScpWzBdLmdldEF0dHJpYnV0ZSgnY29udGVudCcpO1xuICB2YXIgc2VhcmNoID0gZG9jdW1lbnQubG9jYXRpb24gPyBkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2ggfHwgJycgOiAnJztcbiAgdmFyIGR5bmFtaWNVcmwgPSBkeW5hbWljVXJsXyArIFwiP2ludGVyZmFjZT1cIiArIGludGVyZmFjZV8gKyBcIiZxdWVyeT1cIiArIGVuY29kZVVSSUNvbXBvbmVudChzZWFyY2gpICsgXCImcGF0aD1cIiArIGVuY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5sb2NhdGlvbi5wYXRobmFtZSk7XG4gIHZhciByZXF1ZXN0ID0gJC5hamF4KGR5bmFtaWNVcmwsIHtcbiAgICAnZGF0YVR5cGUnOiAnanNvbicsXG4gICAgJ3hockZpZWxkcyc6IHtcbiAgICAgIHdpdGhDcmVkZW50aWFsczogZmFsc2VcbiAgICB9XG4gIH0pO1xuICByZXF1ZXN0LmZhaWwoZnVuY3Rpb24gKGpxWEhSLCB0ZXh0U3RhdHVzKSB7XG4gICAgd2luZG93LmFsZXJ0KFwiRmFpbGVkIHRvIGdldCB0aGUgZHluYW1pYzogXCIgKyB0ZXh0U3RhdHVzKTtcbiAgfSk7XG4gIHJlcXVlc3QuZG9uZShmdW5jdGlvbiAoZHluYW1pYykge1xuICAgIGlmIChkeW5hbWljLmRvUmVkaXJlY3QpIHtcbiAgICAgIHZhciBzbWFsbF9zY3JlZW4gPSB3aW5kb3cubWF0Y2hNZWRpYSA/IHdpbmRvdy5tYXRjaE1lZGlhKCcobWF4LXdpZHRoOiAxMDI0cHgpJykgOiBmYWxzZTtcblxuICAgICAgaWYgKHNtYWxsX3NjcmVlbiAmJiAnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpIHtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBkeW5hbWljLnJlZGlyZWN0VXJsO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIG5hbWUgaW4gZHluYW1pYy5jb25zdGFudHMpIHtcbiAgICAgIG1vZHVsZS5jb25zdGFudChuYW1lLCBkeW5hbWljLmNvbnN0YW50c1tuYW1lXSk7XG4gICAgfVxuXG4gICAgYW5ndWxhci5ib290c3RyYXAoZG9jdW1lbnQsIFtcIkFwcFwiICsgaW50ZXJmYWNlX10pO1xuICB9KTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYm9vdHN0cmFwOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZCcsIFtdKTtcbm1vZHVsZS52YWx1ZSgnZ21mRGF0YVNvdXJjZUJlaW5nRmlsdGVyZWQnLCB7XG4gIGRhdGFTb3VyY2U6IG51bGxcbn0pO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBFWFRFUk5BTExBWUVSR1JPVVBfTkFNRSB9IGZyb20gJ2dtZi9pbmRleC5qcyc7XG5pbXBvcnQgbmdlb01hcExheWVySGVscGVyIGZyb20gJ25nZW8vbWFwL0xheWVySGVscGVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY0ZpbGUgZnJvbSAnbmdlby9taXNjL0ZpbGUuanMnO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlRGF0YVNvdXJjZXMgZnJvbSAnbmdlby9kYXRhc291cmNlL0RhdGFTb3VyY2VzLmpzJztcbmltcG9ydCBuZ2VvRGF0YXNvdXJjZUZpbGUgZnJvbSAnbmdlby9kYXRhc291cmNlL0ZpbGUuanMnO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlRmlsZUdyb3VwIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9GaWxlR3JvdXAuanMnO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlT0dDLCB7IFR5cGUsIFdNU0luZm9Gb3JtYXQgfSBmcm9tICduZ2VvL2RhdGFzb3VyY2UvT0dDLmpzJztcbmltcG9ydCBuZ2VvRGF0YXNvdXJjZU9HQ0dyb3VwIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9PR0NHcm91cC5qcyc7XG5pbXBvcnQgbmdlb0RhdGFzb3VyY2VXTVNHcm91cCBmcm9tICduZ2VvL2RhdGFzb3VyY2UvV01TR3JvdXAuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ29sL2V4dGVudC5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4gfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sQ29sbGVjdGlvbiBmcm9tICdvbC9Db2xsZWN0aW9uLmpzJztcbmltcG9ydCBvbEZvcm1hdEdQWCBmcm9tICdvbC9mb3JtYXQvR1BYLmpzJztcbmltcG9ydCBvbEZvcm1hdEtNTCBmcm9tICdvbC9mb3JtYXQvS01MLmpzJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuZXhwb3J0IHZhciBFeHRlcm5hbERhdFNvdXJjZXNNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICBFeHRlcm5hbERhdFNvdXJjZXNNYW5hZ2VyLiRpbmplY3QgPSBbXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIiRpbmplY3RvclwiLCBcIiRxXCIsIFwiJHJvb3RTY29wZVwiLCBcIm5nZW9EYXRhU291cmNlc1wiLCBcIm5nZW9GaWxlXCIsIFwibmdlb0xheWVySGVscGVyXCJdO1xuXG4gIGZ1bmN0aW9uIEV4dGVybmFsRGF0U291cmNlc01hbmFnZXIoZ2V0dGV4dENhdGFsb2csICRpbmplY3RvciwgJHEsICRyb290U2NvcGUsIG5nZW9EYXRhU291cmNlcywgbmdlb0ZpbGUsIG5nZW9MYXllckhlbHBlcikge1xuICAgIHRoaXMuaW5qZWN0b3JfID0gJGluamVjdG9yO1xuICAgIHRoaXMucV8gPSAkcTtcbiAgICB0aGlzLnJvb3RTY29wZV8gPSAkcm9vdFNjb3BlO1xuICAgIHRoaXMuZGF0YVNvdXJjZXNfID0gbmdlb0RhdGFTb3VyY2VzLmNvbGxlY3Rpb247XG4gICAgdGhpcy5uZ2VvRmlsZV8gPSBuZ2VvRmlsZTtcbiAgICB0aGlzLm5nZW9MYXllckhlbHBlcl8gPSBuZ2VvTGF5ZXJIZWxwZXI7XG4gICAgdGhpcy5leHREYXRhU291cmNlc18gPSB7fTtcbiAgICB0aGlzLmZpbGVzXyA9IHt9O1xuICAgIHRoaXMubWFwXyA9IG51bGw7XG4gICAgdGhpcy5maWxlR3JvdXBfID0gbmV3IG5nZW9EYXRhc291cmNlRmlsZUdyb3VwKHtcbiAgICAgIGRhdGFTb3VyY2VzOiBbXSxcbiAgICAgIGluamVjdG9yOiB0aGlzLmluamVjdG9yXyxcbiAgICAgIHRpdGxlOiBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0xvY2FsIGZpbGVzJylcbiAgICB9KTtcbiAgICB0aGlzLndtc0dyb3Vwc0NvbGxlY3Rpb25fID0gbmV3IG9sQ29sbGVjdGlvbigpO1xuICAgIHRoaXMud210c0dyb3Vwc0NvbGxlY3Rpb25fID0gbmV3IG9sQ29sbGVjdGlvbigpO1xuICAgIHRoaXMud210c0NhY2hlXyA9IHt9O1xuICAgIGxpc3Rlbih0aGlzLmRhdGFTb3VyY2VzXywgJ3JlbW92ZScsIHRoaXMuaGFuZGxlRGF0YVNvdXJjZXNSZW1vdmVfLCB0aGlzKTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBFeHRlcm5hbERhdFNvdXJjZXNNYW5hZ2VyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uYWRkV01TR3JvdXBfID0gZnVuY3Rpb24gYWRkV01TR3JvdXBfKHdtc0dyb3VwKSB7XG4gICAgdGhpcy53bXNHcm91cHNDb2xsZWN0aW9uLnB1c2god21zR3JvdXApO1xuICB9O1xuXG4gIF9wcm90by5yZW1vdmVXTVNHcm91cF8gPSBmdW5jdGlvbiByZW1vdmVXTVNHcm91cF8od21zR3JvdXApIHtcbiAgICB0aGlzLndtc0dyb3Vwc0NvbGxlY3Rpb24ucmVtb3ZlKHdtc0dyb3VwKTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0V01TR3JvdXAgPSBmdW5jdGlvbiBnZXRXTVNHcm91cCh1cmwpIHtcbiAgICB2YXIgZm91bmQgPSBudWxsO1xuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gdGhpcy53bXNHcm91cHMsIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IpLCBfaSA9IDAsIF9pdGVyYXRvciA9IF9pc0FycmF5ID8gX2l0ZXJhdG9yIDogX2l0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjtcblxuICAgICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICAgIGlmIChfaSA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pID0gX2l0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciB3bXNHcm91cCA9IF9yZWY7XG5cbiAgICAgIGlmICh3bXNHcm91cC51cmwgPT09IHVybCkge1xuICAgICAgICBmb3VuZCA9IHdtc0dyb3VwO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZm91bmQ7XG4gIH07XG5cbiAgX3Byb3RvLmFkZFdNVFNHcm91cF8gPSBmdW5jdGlvbiBhZGRXTVRTR3JvdXBfKHdtdHNHcm91cCkge1xuICAgIHRoaXMud210c0dyb3Vwc0NvbGxlY3Rpb24ucHVzaCh3bXRzR3JvdXApO1xuICB9O1xuXG4gIF9wcm90by5yZW1vdmVXTVRTR3JvdXBfID0gZnVuY3Rpb24gcmVtb3ZlV01UU0dyb3VwXyh3bXRzR3JvdXApIHtcbiAgICB0aGlzLndtdHNHcm91cHNDb2xsZWN0aW9uLnJlbW92ZSh3bXRzR3JvdXApO1xuICB9O1xuXG4gIF9wcm90by5nZXRXTVRTR3JvdXAgPSBmdW5jdGlvbiBnZXRXTVRTR3JvdXAodXJsKSB7XG4gICAgdmFyIGZvdW5kID0gbnVsbDtcblxuICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB0aGlzLndtdHNHcm91cHMsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYyO1xuXG4gICAgICBpZiAoX2lzQXJyYXkyKSB7XG4gICAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmMiA9IF9pdGVyYXRvcjJbX2kyKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICAgIGlmIChfaTIuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYyID0gX2kyLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgd210c0dyb3VwID0gX3JlZjI7XG5cbiAgICAgIGlmICh3bXRzR3JvdXAudXJsID09PSB1cmwpIHtcbiAgICAgICAgZm91bmQgPSB3bXRzR3JvdXA7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmb3VuZDtcbiAgfTtcblxuICBfcHJvdG8uaXNFeHRlcm5hbERhdGFTb3VyY2UgPSBmdW5jdGlvbiBpc0V4dGVybmFsRGF0YVNvdXJjZShkYXRhU291cmNlKSB7XG4gICAgcmV0dXJuICEhdGhpcy5leHREYXRhU291cmNlc19bZGF0YVNvdXJjZS5pZF07XG4gIH07XG5cbiAgX3Byb3RvLmFkZExheWVyXyA9IGZ1bmN0aW9uIGFkZExheWVyXyhsYXllcikge1xuICAgIHRoaXMubGF5ZXJHcm91cC5nZXRMYXllcnMoKS5wdXNoKGxheWVyKTtcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlTGF5ZXJfID0gZnVuY3Rpb24gcmVtb3ZlTGF5ZXJfKGxheWVyKSB7XG4gICAgdGhpcy5sYXllckdyb3VwLmdldExheWVycygpLnJlbW92ZShsYXllcik7XG4gIH07XG5cbiAgX3Byb3RvLmNyZWF0ZUFuZEFkZERhdGFTb3VyY2VGcm9tV01TQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uIGNyZWF0ZUFuZEFkZERhdGFTb3VyY2VGcm9tV01TQ2FwYWJpbGl0eShsYXllciwgY2FwYWJpbGl0aWVzLCB1cmwpIHtcbiAgICB2YXIgaWQgPSBnZXRJZChsYXllcik7XG4gICAgdmFyIHNlcnZpY2UgPSBjYXBhYmlsaXRpZXMuU2VydmljZTtcbiAgICB1cmwgPSBzZXJ2aWNlLk9ubGluZVJlc291cmNlIHx8IHVybDtcbiAgICB2YXIgZGF0YVNvdXJjZTtcblxuICAgIGlmICh0aGlzLmV4dERhdGFTb3VyY2VzX1tpZF0pIHtcbiAgICAgIGRhdGFTb3VyY2UgPSB0aGlzLmV4dERhdGFTb3VyY2VzX1tpZF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciByZXEgPSBjYXBhYmlsaXRpZXMuQ2FwYWJpbGl0eS5SZXF1ZXN0O1xuICAgICAgdmFyIGZvcm1hdHMgPSByZXEuR2V0TWFwLkZvcm1hdDtcbiAgICAgIHZhciBpbWFnZVBuZ1R5cGUgPSAnaW1hZ2UvcG5nJztcbiAgICAgIHZhciBvZ2NJbWFnZVR5cGUgPSBmb3JtYXRzLmluY2x1ZGVzKGltYWdlUG5nVHlwZSkgPyBpbWFnZVBuZ1R5cGUgOiBmb3JtYXRzWzBdO1xuICAgICAgdmFyIGluZm9Gb3JtYXRzID0gcmVxLkdldEZlYXR1cmVJbmZvLkZvcm1hdDtcbiAgICAgIHZhciB3bXNJbmZvRm9ybWF0ID0gaW5mb0Zvcm1hdHMuaW5jbHVkZXMoV01TSW5mb0Zvcm1hdC5HTUwpID8gV01TSW5mb0Zvcm1hdC5HTUwgOiB1bmRlZmluZWQ7XG4gICAgICB2YXIgcXVlcnlhYmxlID0gbGF5ZXIucXVlcnlhYmxlID09PSB0cnVlICYmIHdtc0luZm9Gb3JtYXQgIT09IHVuZGVmaW5lZDtcbiAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBpZDogaWQsXG4gICAgICAgIG5hbWU6IGxheWVyLlRpdGxlLFxuICAgICAgICBvZ2NJbWFnZVR5cGU6IG9nY0ltYWdlVHlwZSxcbiAgICAgICAgd21zTGF5ZXJzOiBbe1xuICAgICAgICAgIG5hbWU6IGxheWVyLk5hbWUsXG4gICAgICAgICAgcXVlcnlhYmxlOiBxdWVyeWFibGVcbiAgICAgICAgfV0sXG4gICAgICAgIG9nY1R5cGU6IFR5cGUuV01TLFxuICAgICAgICB2aXNpYmxlOiB0cnVlLFxuICAgICAgICB3bXNVcmw6IHVybFxuICAgICAgfTtcblxuICAgICAgaWYgKHdtc0luZm9Gb3JtYXQpIHtcbiAgICAgICAgb3B0aW9ucy53bXNJbmZvRm9ybWF0ID0gd21zSW5mb0Zvcm1hdDtcbiAgICAgIH1cblxuICAgICAgZGF0YVNvdXJjZSA9IG5ldyBuZ2VvRGF0YXNvdXJjZU9HQyhvcHRpb25zKTtcbiAgICAgIHRoaXMuZXh0RGF0YVNvdXJjZXNfW2lkXSA9IGRhdGFTb3VyY2U7XG4gICAgfVxuXG4gICAgdmFyIHdtc0dyb3VwID0gdGhpcy5nZXRXTVNHcm91cCh1cmwpO1xuXG4gICAgaWYgKHdtc0dyb3VwKSB7XG4gICAgICBpZiAoIXdtc0dyb3VwLmRhdGFTb3VyY2VzLmluY2x1ZGVzKGRhdGFTb3VyY2UpKSB7XG4gICAgICAgIHdtc0dyb3VwLmFkZERhdGFTb3VyY2UoZGF0YVNvdXJjZSk7XG4gICAgICAgIHRoaXMuZGF0YVNvdXJjZXNfLnB1c2goZGF0YVNvdXJjZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHdtc0dyb3VwID0gbmV3IG5nZW9EYXRhc291cmNlV01TR3JvdXAoe1xuICAgICAgICBkYXRhU291cmNlczogW2RhdGFTb3VyY2VdLFxuICAgICAgICBpbmplY3RvcjogdGhpcy5pbmplY3Rvcl8sXG4gICAgICAgIHRpdGxlOiBzZXJ2aWNlLlRpdGxlLFxuICAgICAgICB1cmw6IHVybFxuICAgICAgfSwgdGhpcy5uZ2VvTGF5ZXJIZWxwZXJfKTtcbiAgICAgIHRoaXMuYWRkTGF5ZXJfKHdtc0dyb3VwLmxheWVyKTtcbiAgICAgIHRoaXMuYWRkV01TR3JvdXBfKHdtc0dyb3VwKTtcbiAgICAgIHRoaXMuZGF0YVNvdXJjZXNfLnB1c2goZGF0YVNvdXJjZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5jcmVhdGVBbmRBZGREYXRhU291cmNlRnJvbVdNVFNDYXBhYmlsaXR5ID0gZnVuY3Rpb24gY3JlYXRlQW5kQWRkRGF0YVNvdXJjZUZyb21XTVRTQ2FwYWJpbGl0eShsYXllciwgY2FwYWJpbGl0aWVzLCB3bXRzVXJsKSB7XG4gICAgdmFyIGlkID0gZ2V0SWQobGF5ZXIpO1xuXG4gICAgaWYgKHRoaXMud210c0NhY2hlX1tpZF0pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgZGF0YVNvdXJjZTtcblxuICAgIGlmICh0aGlzLmV4dERhdGFTb3VyY2VzX1tpZF0pIHtcbiAgICAgIGRhdGFTb3VyY2UgPSB0aGlzLmV4dERhdGFTb3VyY2VzX1tpZF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBuYW1lID0gdHlwZW9mIGxheWVyLlRpdGxlO1xuICAgICAgdmFyIHdtdHNMYXllciA9IHR5cGVvZiBsYXllci5JZGVudGlmaWVyO1xuICAgICAgZGF0YVNvdXJjZSA9IG5ldyBuZ2VvRGF0YXNvdXJjZU9HQyh7XG4gICAgICAgIGlkOiBpZCxcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgb2djVHlwZTogVHlwZS5XTVRTLFxuICAgICAgICB2aXNpYmxlOiB0cnVlLFxuICAgICAgICB3bXRzTGF5ZXI6IHdtdHNMYXllcixcbiAgICAgICAgd210c1VybDogd210c1VybFxuICAgICAgfSk7XG4gICAgICB0aGlzLmV4dERhdGFTb3VyY2VzX1tpZF0gPSBkYXRhU291cmNlO1xuICAgIH1cblxuICAgIHZhciB3bXRzR3JvdXAgPSB0aGlzLmdldFdNVFNHcm91cCh3bXRzVXJsKTtcblxuICAgIGlmICghd210c0dyb3VwKSB7XG4gICAgICB3bXRzR3JvdXAgPSBuZXcgbmdlb0RhdGFzb3VyY2VPR0NHcm91cCh7XG4gICAgICAgIGRhdGFTb3VyY2VzOiBbXSxcbiAgICAgICAgdGl0bGU6IGNhcGFiaWxpdGllcy5TZXJ2aWNlSWRlbnRpZmljYXRpb24uVGl0bGUsXG4gICAgICAgIHVybDogd210c1VybFxuICAgICAgfSk7XG4gICAgICB0aGlzLmFkZFdNVFNHcm91cF8od210c0dyb3VwKTtcbiAgICB9XG5cbiAgICB3bXRzR3JvdXAuYWRkRGF0YVNvdXJjZShkYXRhU291cmNlKTtcbiAgICB2YXIgbGF5ZXJPYmogPSB0aGlzLm5nZW9MYXllckhlbHBlcl8uY3JlYXRlV01UU0xheWVyRnJvbUNhcGFiaWxpdGl0ZXNPYmooY2FwYWJpbGl0aWVzLCBsYXllcik7XG4gICAgdGhpcy5hZGRMYXllcl8obGF5ZXJPYmopO1xuICAgIHRoaXMuZGF0YVNvdXJjZXNfLnB1c2goZGF0YVNvdXJjZSk7XG4gICAgdGhpcy53bXRzQ2FjaGVfW2lkXSA9IHtcbiAgICAgIGxheWVyT2JqOiBsYXllck9iaixcbiAgICAgIHVucmVnaXN0ZXI6IHRoaXMucm9vdFNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZGF0YVNvdXJjZS52aXNpYmxlO1xuICAgICAgfSwgdGhpcy5oYW5kbGVXTVRTRGF0YVNvdXJjZVZpc2libGVDaGFuZ2VfLmJpbmQodGhpcywgbGF5ZXJPYmopKVxuICAgIH07XG4gIH07XG5cbiAgX3Byb3RvLmNyZWF0ZUFuZEFkZERhdGFTb3VyY2VGcm9tRmlsZSA9IGZ1bmN0aW9uIGNyZWF0ZUFuZEFkZERhdGFTb3VyY2VGcm9tRmlsZShmaWxlLCBvcHRfY2FsbGJhY2spIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdGhpcy5nZXRGaWxlRGF0YVNvdXJjZV8oZmlsZSkudGhlbihmdW5jdGlvbiAoZGF0YVNvdXJjZSkge1xuICAgICAgdmFyIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgdmFyIGZpbGVHcm91cCA9IF90aGlzLmZpbGVHcm91cF87XG5cbiAgICAgIGlmIChpc0VtcHR5KGRhdGFTb3VyY2UuZXh0ZW50KSkge1xuICAgICAgICBzdWNjZXNzID0gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIV90aGlzLm1hcF8pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZmlsZUdyb3VwLmRhdGFTb3VyY2VzLmluY2x1ZGVzKGRhdGFTb3VyY2UpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXMuYWRkTGF5ZXJfKGRhdGFTb3VyY2UubGF5ZXIpO1xuXG4gICAgICAgIGZpbGVHcm91cC5hZGREYXRhU291cmNlKGRhdGFTb3VyY2UpO1xuXG4gICAgICAgIF90aGlzLm1hcF8uZ2V0VmlldygpLmZpdChkYXRhU291cmNlLmV4dGVudCk7XG5cbiAgICAgICAgX3RoaXMuZGF0YVNvdXJjZXNfLnB1c2goZGF0YVNvdXJjZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRfY2FsbGJhY2spIHtcbiAgICAgICAgb3B0X2NhbGxiYWNrKHN1Y2Nlc3MpO1xuICAgICAgfVxuICAgIH0sIGZ1bmN0aW9uIChyZWplY3Rpb25zKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvYWQgZmlsZTogXCIgKyBmaWxlLm5hbWUpO1xuXG4gICAgICBpZiAob3B0X2NhbGxiYWNrKSB7XG4gICAgICAgIG9wdF9jYWxsYmFjayhmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLmdldEZpbGVEYXRhU291cmNlXyA9IGZ1bmN0aW9uIGdldEZpbGVEYXRhU291cmNlXyhmaWxlKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgZGVmZXIgPSB0aGlzLnFfLmRlZmVyKCk7XG5cbiAgICBpZiAodGhpcy5maWxlc19bZmlsZS5uYW1lXSkge1xuICAgICAgZGVmZXIucmVzb2x2ZSh0aGlzLmZpbGVzX1tmaWxlLm5hbWVdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIG5nZW9GaWxlID0gdGhpcy5uZ2VvRmlsZV87XG4gICAgICBuZ2VvRmlsZS5yZWFkKGZpbGUpLnRoZW4oZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgaWYgKCFfdGhpczIubWFwXykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBmZWF0dXJlcztcbiAgICAgICAgdmFyIHJlYWRPcHRpb25zID0ge1xuICAgICAgICAgIGZlYXR1cmVQcm9qZWN0aW9uOiBfdGhpczIubWFwXy5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG5nZW9GaWxlLmlzS21sKGNvbnRlbnQpKSB7XG4gICAgICAgICAgZmVhdHVyZXMgPSBuZXcgb2xGb3JtYXRLTUwoKS5yZWFkRmVhdHVyZXMoY29udGVudCwgcmVhZE9wdGlvbnMpO1xuICAgICAgICB9IGVsc2UgaWYgKG5nZW9GaWxlLmlzR3B4KGNvbnRlbnQpKSB7XG4gICAgICAgICAgZmVhdHVyZXMgPSBuZXcgb2xGb3JtYXRHUFgoKS5yZWFkRmVhdHVyZXMoY29udGVudCwgcmVhZE9wdGlvbnMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZlYXR1cmVzKSB7XG4gICAgICAgICAgdmFyIGlkID0gZ2V0SWQoZmlsZSk7XG4gICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgbmdlb0RhdGFzb3VyY2VGaWxlKHtcbiAgICAgICAgICAgIGZlYXR1cmVzOiBuZXcgb2xDb2xsZWN0aW9uKGZlYXR1cmVzKSxcbiAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgIG5hbWU6IGZpbGUubmFtZSxcbiAgICAgICAgICAgIHZpc2libGU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBfdGhpczIuZmlsZXNfW2ZpbGUubmFtZV0gPSBkYXRhU291cmNlO1xuICAgICAgICAgIF90aGlzMi5leHREYXRhU291cmNlc19baWRdID0gZGF0YVNvdXJjZTtcbiAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGFTb3VyY2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlZmVyLnJlamVjdCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlV01UU0RhdGFTb3VyY2VWaXNpYmxlQ2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZVdNVFNEYXRhU291cmNlVmlzaWJsZUNoYW5nZV8obGF5ZXIsIHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBvbGRWYWx1ZSkge1xuICAgICAgbGF5ZXIuc2V0VmlzaWJsZSh2YWx1ZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEYXRhU291cmNlc1JlbW92ZV8gPSBmdW5jdGlvbiBoYW5kbGVEYXRhU291cmNlc1JlbW92ZV8oZXZ0KSB7XG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgICAgdmFyIGRhdGFTb3VyY2UgPSBldnQuZWxlbWVudDtcblxuICAgICAgaWYgKHRoaXMuZXh0RGF0YVNvdXJjZXNfW2RhdGFTb3VyY2UuaWRdID09PSBkYXRhU291cmNlKSB7XG4gICAgICAgIGlmIChkYXRhU291cmNlIGluc3RhbmNlb2Ygbmdlb0RhdGFzb3VyY2VGaWxlKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdmVGaWxlRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIG5nZW9EYXRhc291cmNlT0dDKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdmVPR0NEYXRhU291cmNlXyhkYXRhU291cmNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlRmlsZURhdGFTb3VyY2VfID0gZnVuY3Rpb24gcmVtb3ZlRmlsZURhdGFTb3VyY2VfKGRhdGFTb3VyY2UpIHtcbiAgICB0aGlzLnJlbW92ZUxheWVyXyhkYXRhU291cmNlLmxheWVyKTtcbiAgICB0aGlzLmZpbGVHcm91cF8ucmVtb3ZlRGF0YVNvdXJjZShkYXRhU291cmNlKTtcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlT0dDRGF0YVNvdXJjZV8gPSBmdW5jdGlvbiByZW1vdmVPR0NEYXRhU291cmNlXyhkYXRhU291cmNlKSB7XG4gICAgaWYgKGRhdGFTb3VyY2Uub2djVHlwZSA9PT0gVHlwZS5XTVMpIHtcbiAgICAgIGlmICghZGF0YVNvdXJjZS53bXNVcmwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGRhdGFTb3VyY2Uud21zVXJsJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciB3bXNHcm91cCA9IHRoaXMuZ2V0V01TR3JvdXAoZGF0YVNvdXJjZS53bXNVcmwpO1xuXG4gICAgICBpZiAod21zR3JvdXAgJiYgd21zR3JvdXAuZGF0YVNvdXJjZXMuaW5jbHVkZXMoZGF0YVNvdXJjZSkpIHtcbiAgICAgICAgd21zR3JvdXAucmVtb3ZlRGF0YVNvdXJjZShkYXRhU291cmNlKTtcblxuICAgICAgICBpZiAoIXdtc0dyb3VwLmRhdGFTb3VyY2VzLmxlbmd0aCkge1xuICAgICAgICAgIHRoaXMucmVtb3ZlTGF5ZXJfKHdtc0dyb3VwLmxheWVyKTtcbiAgICAgICAgICB3bXNHcm91cC5kZXN0cm95KCk7XG4gICAgICAgICAgdGhpcy5yZW1vdmVXTVNHcm91cF8od21zR3JvdXApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChkYXRhU291cmNlLm9nY1R5cGUgPT09IFR5cGUuV01UUykge1xuICAgICAgaWYgKCFkYXRhU291cmNlLndtdHNVcmwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGRhdGFTb3VyY2Uud21zVXJsJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciB3bXRzR3JvdXAgPSB0aGlzLmdldFdNVFNHcm91cChkYXRhU291cmNlLndtdHNVcmwpO1xuXG4gICAgICBpZiAod210c0dyb3VwICYmIHdtdHNHcm91cC5kYXRhU291cmNlcy5pbmNsdWRlcyhkYXRhU291cmNlKSkge1xuICAgICAgICB3bXRzR3JvdXAucmVtb3ZlRGF0YVNvdXJjZShkYXRhU291cmNlKTtcbiAgICAgICAgdmFyIGlkID0gZGF0YVNvdXJjZS5pZDtcbiAgICAgICAgdGhpcy5yZW1vdmVMYXllcl8odGhpcy53bXRzQ2FjaGVfW2lkXS5sYXllck9iaik7XG4gICAgICAgIHRoaXMud210c0NhY2hlX1tpZF0udW5yZWdpc3RlcigpO1xuICAgICAgICBkZWxldGUgdGhpcy53bXRzQ2FjaGVfW2lkXTtcblxuICAgICAgICBpZiAoIXdtdHNHcm91cC5kYXRhU291cmNlcy5sZW5ndGgpIHtcbiAgICAgICAgICB3bXRzR3JvdXAuZGVzdHJveSgpO1xuICAgICAgICAgIHRoaXMucmVtb3ZlV01UU0dyb3VwXyh3bXRzR3JvdXApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhFeHRlcm5hbERhdFNvdXJjZXNNYW5hZ2VyLCBbe1xuICAgIGtleTogXCJmaWxlR3JvdXBcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmZpbGVHcm91cF87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndtc0dyb3Vwc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud21zR3JvdXBzQ29sbGVjdGlvbl8uZ2V0QXJyYXkoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwid21zR3JvdXBzQ29sbGVjdGlvblwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud21zR3JvdXBzQ29sbGVjdGlvbl87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndtdHNHcm91cHNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndtdHNHcm91cHNDb2xsZWN0aW9uXy5nZXRBcnJheSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ3bXRzR3JvdXBzQ29sbGVjdGlvblwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud210c0dyb3Vwc0NvbGxlY3Rpb25fO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJsYXllckdyb3VwXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICBpZiAoIXRoaXMubWFwXykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLm5nZW9MYXllckhlbHBlcl8uZ2V0R3JvdXBGcm9tTWFwKHRoaXMubWFwXywgRVhURVJOQUxMQVlFUkdST1VQX05BTUUpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJtYXBcIixcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChtYXApIHtcbiAgICAgIHRoaXMubWFwXyA9IG1hcDtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gRXh0ZXJuYWxEYXRTb3VyY2VzTWFuYWdlcjtcbn0oKTtcblxuZnVuY3Rpb24gZ2V0SWQobGF5ZXIpIHtcbiAgcmV0dXJuIE51bWJlcihvbFV0aWxHZXRVaWQobGF5ZXIpKSArIDEwMDAwMDA7XG59XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXInLCBbbmdlb01hcExheWVySGVscGVyLm5hbWUsIG5nZW9NaXNjRmlsZS5uYW1lLCBuZ2VvRGF0YXNvdXJjZURhdGFTb3VyY2VzLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCdnbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcicsIEV4dGVybmFsRGF0U291cmNlc01hbmFnZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mRWRpdGluZ0VudW1lcmF0ZUF0dHJpYnV0ZSBmcm9tICdnbWYvZWRpdGluZy9FbnVtZXJhdGVBdHRyaWJ1dGUuanMnO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlSGVscGVyIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9IZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlIGZyb20gJ25nZW8vZm9ybWF0L0F0dHJpYnV0ZVR5cGUuanMnO1xuZXhwb3J0IHZhciBEYXRhc291cmNlSGVscGVyID0gZnVuY3Rpb24gKCkge1xuICBEYXRhc291cmNlSGVscGVyLiRpbmplY3QgPSBbXCIkcVwiLCBcImdtZkVudW1lcmF0ZUF0dHJpYnV0ZVwiLCBcIm5nZW9EYXRhU291cmNlc0hlbHBlclwiXTtcblxuICBmdW5jdGlvbiBEYXRhc291cmNlSGVscGVyKCRxLCBnbWZFbnVtZXJhdGVBdHRyaWJ1dGUsIG5nZW9EYXRhU291cmNlc0hlbHBlcikge1xuICAgIHRoaXMucV8gPSAkcTtcbiAgICB0aGlzLmdtZkVudW1lcmF0ZUF0dHJpYnV0ZV8gPSBnbWZFbnVtZXJhdGVBdHRyaWJ1dGU7XG4gICAgdGhpcy5uZ2VvRGF0YVNvdXJjZXNIZWxwZXJfID0gbmdlb0RhdGFTb3VyY2VzSGVscGVyO1xuICAgIHRoaXMuY29sbGVjdGlvbl8gPSBudWxsO1xuICAgIHRoaXMuY2FjaGVfID0ge307XG4gIH1cblxuICB2YXIgX3Byb3RvID0gRGF0YXNvdXJjZUhlbHBlci5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmdldERhdGFTb3VyY2UgPSBmdW5jdGlvbiBnZXREYXRhU291cmNlKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMubmdlb0RhdGFTb3VyY2VzSGVscGVyXy5nZXREYXRhU291cmNlKGlkKTtcbiAgfTtcblxuICBfcHJvdG8ucHJlcGFyZUZpbHRyYWJsZURhdGFTb3VyY2UgPSBmdW5jdGlvbiBwcmVwYXJlRmlsdHJhYmxlRGF0YVNvdXJjZShkYXRhU291cmNlKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHZhciBwcmVwYXJlRmlsdHJhYmxlRGF0YVNvdXJjZURlZmVyID0gdGhpcy5xXy5kZWZlcigpO1xuICAgIHRoaXMubmdlb0RhdGFTb3VyY2VzSGVscGVyXy5nZXREYXRhU291cmNlQXR0cmlidXRlcyhkYXRhU291cmNlKS50aGVuKGZ1bmN0aW9uIChhdHRyaWJ1dGVzKSB7XG4gICAgICB2YXIgZW51bUF0dHJpYnV0ZXMgPSBkYXRhU291cmNlLmdtZkxheWVyLm1ldGFkYXRhID8gZGF0YVNvdXJjZS5nbWZMYXllci5tZXRhZGF0YS5lbnVtZXJhdGVkQXR0cmlidXRlcyA6IHVuZGVmaW5lZDtcblxuICAgICAgaWYgKGVudW1BdHRyaWJ1dGVzICYmIGVudW1BdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcblxuICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHtcbiAgICAgICAgICBpZiAoX2lzQXJyYXkpIHtcbiAgICAgICAgICAgIGlmIChfaSA+PSBfaXRlcmF0b3IubGVuZ3RoKSByZXR1cm4gXCJicmVha1wiO1xuICAgICAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2kgPSBfaXRlcmF0b3IubmV4dCgpO1xuICAgICAgICAgICAgaWYgKF9pLmRvbmUpIHJldHVybiBcImJyZWFrXCI7XG4gICAgICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IF9yZWY7XG5cbiAgICAgICAgICBpZiAoZW51bUF0dHJpYnV0ZXMuaW5jbHVkZXMoYXR0cmlidXRlLm5hbWUpICYmIGF0dHJpYnV0ZS50eXBlICE9PSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5TRUxFQ1QgJiYgKCFhdHRyaWJ1dGUuY2hvaWNlcyB8fCAhYXR0cmlidXRlLmNob2ljZXMubGVuZ3RoKSkge1xuICAgICAgICAgICAgcHJvbWlzZXMucHVzaChfdGhpcy5nbWZFbnVtZXJhdGVBdHRyaWJ1dGVfLmdldEF0dHJpYnV0ZVZhbHVlcyhkYXRhU291cmNlLCBhdHRyaWJ1dGUubmFtZSkudGhlbihmdW5jdGlvbiAodmFsdWVzKSB7XG4gICAgICAgICAgICAgIHZhciBjaG9pY2VzID0gdmFsdWVzLm1hcChmdW5jdGlvbiAoY2hvaWNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNob2ljZS52YWx1ZTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGF0dHJpYnV0ZS50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuU0VMRUNUO1xuICAgICAgICAgICAgICBhdHRyaWJ1dGUuY2hvaWNlcyA9IGNob2ljZXM7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGF0dHJpYnV0ZXMsIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IpLCBfaSA9IDAsIF9pdGVyYXRvciA9IF9pc0FycmF5ID8gX2l0ZXJhdG9yIDogX2l0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgICAgdmFyIF9yZWY7XG5cbiAgICAgICAgICB2YXIgX3JldCA9IF9sb29wKCk7XG5cbiAgICAgICAgICBpZiAoX3JldCA9PT0gXCJicmVha1wiKSBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBfdGhpcy5xXy5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHByZXBhcmVGaWx0cmFibGVEYXRhU291cmNlRGVmZXIucmVzb2x2ZShkYXRhU291cmNlKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcmVwYXJlRmlsdHJhYmxlRGF0YVNvdXJjZURlZmVyLnJlc29sdmUoZGF0YVNvdXJjZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHByZXBhcmVGaWx0cmFibGVEYXRhU291cmNlRGVmZXIucHJvbWlzZTtcbiAgfTtcblxuICBfY3JlYXRlQ2xhc3MoRGF0YXNvdXJjZUhlbHBlciwgW3tcbiAgICBrZXk6IFwiY29sbGVjdGlvblwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMubmdlb0RhdGFTb3VyY2VzSGVscGVyXy5jb2xsZWN0aW9uO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBEYXRhc291cmNlSGVscGVyO1xufSgpO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZEYXRhU291cmNlc0hlbHBlcicsIFtuZ2VvRGF0YXNvdXJjZUhlbHBlci5uYW1lLCBnbWZFZGl0aW5nRW51bWVyYXRlQXR0cmlidXRlLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCdnbWZEYXRhU291cmNlc0hlbHBlcicsIERhdGFzb3VyY2VIZWxwZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZMYXllckJlaW5nU3dpcGUnLCBbXSk7XG5tb2R1bGUudmFsdWUoJ2dtZkxheWVyQmVpbmdTd2lwZScsIHtcbiAgbGF5ZXI6IG51bGwsXG4gIHN3aXBlVmFsdWU6IG51bGxcbn0pO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IEdtZkRhdGFzb3VyY2VPR0MgZnJvbSAnZ21mL2RhdGFzb3VyY2UvT0dDLmpzJztcbmltcG9ydCBnbWZEYXRhc291cmNlV0ZTQWxpYXNlcyBmcm9tICdnbWYvZGF0YXNvdXJjZS9XRlNBbGlhc2VzLmpzJztcbmltcG9ydCBnbWZMYXllcnRyZWVTeW5jTGF5ZXJ0cmVlTWFwLCB7IGdldExheWVyIH0gZnJvbSAnZ21mL2xheWVydHJlZS9TeW5jTGF5ZXJ0cmVlTWFwLmpzJztcbmltcG9ydCBnbWZMYXllcnRyZWVUcmVlTWFuYWdlciBmcm9tICdnbWYvbGF5ZXJ0cmVlL1RyZWVNYW5hZ2VyLmpzJztcbmltcG9ydCBnbWZUaGVtZVRoZW1lcywgeyBUaGVtZU5vZGVUeXBlIH0gZnJvbSAnZ21mL3RoZW1lL1RoZW1lcy5qcyc7XG5pbXBvcnQgZ21mT0dDIGZyb20gJ2dtZi9kYXRhc291cmNlL09HQy5qcyc7XG5pbXBvcnQgT0dDLCB7IFNlcnZlclR5cGUsIFdGU091dHB1dEZvcm1hdCwgVHlwZSB9IGZyb20gJ25nZW8vZGF0YXNvdXJjZS9PR0MuanMnO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlRGF0YVNvdXJjZXMgZnJvbSAnbmdlby9kYXRhc291cmNlL0RhdGFTb3VyY2VzLmpzJztcbmltcG9ydCBuZ2VvRmlsdGVyUnVsZUhlbHBlciBmcm9tICduZ2VvL2ZpbHRlci9SdWxlSGVscGVyLmpzJztcbmltcG9ydCBuZ2VvTWFwQmFja2dyb3VuZExheWVyTWdyIGZyb20gJ25nZW8vbWFwL0JhY2tncm91bmRMYXllck1nci5qcyc7XG5pbXBvcnQgbmdlb01hcExheWVySGVscGVyIGZyb20gJ25nZW8vbWFwL0xheWVySGVscGVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY1dNU1RpbWUgZnJvbSAnbmdlby9taXNjL1dNU1RpbWUuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0IHsgbGlzdGVuIH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbExheWVyVGlsZSBmcm9tICdvbC9sYXllci9UaWxlLmpzJztcbmltcG9ydCB7IGNsZWFyIGFzIGNsZWFyT2JqZWN0IH0gZnJvbSAnb2wvb2JqLmpzJztcbmltcG9ydCBvbExheWVySW1hZ2UgZnJvbSAnb2wvbGF5ZXIvSW1hZ2UuanMnO1xuaW1wb3J0IG9sU291cmNlSW1hZ2VXTVMgZnJvbSAnb2wvc291cmNlL0ltYWdlV01TLmpzJztcbmltcG9ydCBvbFNvdXJjZVRpbGVXTVMgZnJvbSAnb2wvc291cmNlL1RpbGVXTVMuanMnO1xuZXhwb3J0IHZhciBEYXRhc291cmNlTWFuYWdlciA9IGZ1bmN0aW9uICgpIHtcbiAgRGF0YXNvdXJjZU1hbmFnZXIuJGluamVjdCA9IFtcIiRxXCIsIFwiJHJvb3RTY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwiZ21mVGhlbWVzXCIsIFwiZ21mVHJlZU1hbmFnZXJcIiwgXCJuZ2VvQmFja2dyb3VuZExheWVyTWdyXCIsIFwibmdlb0RhdGFTb3VyY2VzXCIsIFwibmdlb0xheWVySGVscGVyXCIsIFwibmdlb1J1bGVIZWxwZXJcIiwgXCJuZ2VvV01TVGltZVwiLCBcImdtZldGU0FsaWFzZXNcIl07XG5cbiAgZnVuY3Rpb24gRGF0YXNvdXJjZU1hbmFnZXIoJHEsICRyb290U2NvcGUsICR0aW1lb3V0LCBnbWZUaGVtZXMsIGdtZlRyZWVNYW5hZ2VyLCBuZ2VvQmFja2dyb3VuZExheWVyTWdyLCBuZ2VvRGF0YVNvdXJjZXMsIG5nZW9MYXllckhlbHBlciwgbmdlb1J1bGVIZWxwZXIsIG5nZW9XTVNUaW1lLCBnbWZXRlNBbGlhc2VzKSB7XG4gICAgdGhpcy5xXyA9ICRxO1xuICAgIHRoaXMucm9vdFNjb3BlXyA9ICRyb290U2NvcGU7XG4gICAgdGhpcy50aW1lb3V0XyA9ICR0aW1lb3V0O1xuICAgIHRoaXMuZ21mVGhlbWVzXyA9IGdtZlRoZW1lcztcbiAgICB0aGlzLmdtZlRyZWVNYW5hZ2VyXyA9IGdtZlRyZWVNYW5hZ2VyO1xuICAgIHRoaXMubmdlb0JhY2tncm91bmRMYXllck1ncl8gPSBuZ2VvQmFja2dyb3VuZExheWVyTWdyO1xuICAgIHRoaXMubmdlb0RhdGFTb3VyY2VzXyA9IG5nZW9EYXRhU291cmNlcztcbiAgICB0aGlzLmRhdGFTb3VyY2VzXyA9IG5nZW9EYXRhU291cmNlcy5jb2xsZWN0aW9uO1xuICAgIHRoaXMubmdlb0xheWVySGVscGVyXyA9IG5nZW9MYXllckhlbHBlcjtcbiAgICB0aGlzLm5nZW9SdWxlSGVscGVyXyA9IG5nZW9SdWxlSGVscGVyO1xuICAgIHRoaXMubmdlb1dNU1RpbWVfID0gbmdlb1dNU1RpbWU7XG4gICAgdGhpcy5nbWZXRlNBbGlhc2VzXyA9IGdtZldGU0FsaWFzZXM7XG4gICAgdGhpcy5kYXRhU291cmNlc0NhY2hlXyA9IHt9O1xuICAgIHRoaXMuZGltZW5zaW9uc187XG4gICAgdGhpcy5kaW1lbnNpb25zV2F0Y2hlclVucmVnaXN0ZXIgPSBudWxsO1xuICAgIHRoaXMudHJlZUN0cmxDYWNoZV8gPSB7fTtcbiAgICB0aGlzLnRyZWVDdHJsc1VucmVnaXN0ZXJfID0gbnVsbDtcbiAgICBsaXN0ZW4odGhpcy5uZ2VvQmFja2dyb3VuZExheWVyTWdyXywgJ2NoYW5nZScsIHRoaXMuaGFuZGxlTmdlb0JhY2tncm91bmRMYXllckNoYW5nZV8sIHRoaXMpO1xuICAgIGxpc3Rlbih0aGlzLmdtZlRoZW1lc18sICdjaGFuZ2UnLCB0aGlzLmhhbmRsZVRoZW1lc0NoYW5nZV8sIHRoaXMpO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IERhdGFzb3VyY2VNYW5hZ2VyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uc2V0RGF0YXNvdXJjZU1hcCA9IGZ1bmN0aW9uIHNldERhdGFzb3VyY2VNYXAobWFwKSB7XG4gICAgdGhpcy5uZ2VvRGF0YVNvdXJjZXNfLm1hcCA9IG1hcDtcbiAgfTtcblxuICBfcHJvdG8uc2V0RGltZW5zaW9ucyA9IGZ1bmN0aW9uIHNldERpbWVuc2lvbnMoZGltZW5zaW9ucykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBpZiAodGhpcy5kaW1lbnNpb25zV2F0Y2hlclVucmVnaXN0ZXIpIHtcbiAgICAgIHRoaXMuZGltZW5zaW9uc1dhdGNoZXJVbnJlZ2lzdGVyKCk7XG4gICAgfVxuXG4gICAgdGhpcy5kaW1lbnNpb25zXyA9IGRpbWVuc2lvbnM7XG4gICAgdGhpcy5kaW1lbnNpb25zV2F0Y2hlclVucmVnaXN0ZXIgPSB0aGlzLnJvb3RTY29wZV8uJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5kaW1lbnNpb25zXztcbiAgICB9LCB0aGlzLmhhbmRsZURpbWVuc2lvbnNDaGFuZ2VfLmJpbmQodGhpcyksIHRydWUpO1xuICAgIHRoaXMuaGFuZGxlRGltZW5zaW9uc0NoYW5nZV8oKTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRGltZW5zaW9uc0NoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVEaW1lbnNpb25zQ2hhbmdlXygpIHtcbiAgICB2YXIgbGF5ZXJzID0gW107XG4gICAgdmFyIGxheWVySWRzID0gW107XG4gICAgdmFyIGRhdGFTb3VyY2VzID0gdGhpcy5kYXRhU291cmNlc18uZ2V0QXJyYXkoKTtcblxuICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGRhdGFTb3VyY2VzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGF0YVNvdXJjZSA9IF9yZWY7XG5cbiAgICAgIGlmIChkYXRhU291cmNlIGluc3RhbmNlb2YgZ21mT0dDICYmIGRhdGFTb3VyY2UuZGltZW5zaW9uc0ZpbHRlcnNDb25maWcpIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRhdGFTb3VyY2UuZGltZW5zaW9uc0ZpbHRlcnNDb25maWcpIHtcbiAgICAgICAgICBpZiAoZGF0YVNvdXJjZS5kaW1lbnNpb25zRmlsdGVyc0NvbmZpZ1trZXldLnZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgbGF5ZXIgPSB0aGlzLmdldERhdGFTb3VyY2VMYXllcl8oZGF0YVNvdXJjZSk7XG5cbiAgICAgICAgICAgIGlmIChsYXllciA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaWQgPSBvbFV0aWxHZXRVaWQobGF5ZXIpO1xuXG4gICAgICAgICAgICBpZiAoIWxheWVySWRzLmluY2x1ZGVzKGlkKSkge1xuICAgICAgICAgICAgICBsYXllcnMucHVzaChsYXllcik7XG4gICAgICAgICAgICAgIGxheWVySWRzLnB1c2goaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGxheWVycy5mb3JFYWNoKHRoaXMudXBkYXRlTGF5ZXJGaWx0ZXJfLmJpbmQodGhpcykpO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVUaGVtZXNDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlVGhlbWVzQ2hhbmdlXygpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHRoaXMuY2xlYXJEYXRhU291cmNlc18oKTtcblxuICAgIGlmICh0aGlzLnRyZWVDdHJsc1VucmVnaXN0ZXJfKSB7XG4gICAgICB0aGlzLnRyZWVDdHJsc1VucmVnaXN0ZXJfKCk7XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhclRyZWVDdHJsQ2FjaGVfKCk7XG4gICAgdGhpcy5nbWZUaGVtZXNfLmdldE9nY1NlcnZlcnNPYmplY3QoKS50aGVuKGZ1bmN0aW9uIChvZ2NTZXJ2ZXJzKSB7XG4gICAgICB2YXIgcHJvbWlzZVRoZW1lcyA9IF90aGlzMi5nbWZUaGVtZXNfLmdldFRoZW1lc09iamVjdCgpLnRoZW4oZnVuY3Rpb24gKHRoZW1lcykge1xuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gdGhlbWVzLCBfaXNBcnJheTIgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjIpLCBfaTIgPSAwLCBfaXRlcmF0b3IyID0gX2lzQXJyYXkyID8gX2l0ZXJhdG9yMiA6IF9pdGVyYXRvcjJbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgICB2YXIgX3JlZjI7XG5cbiAgICAgICAgICBpZiAoX2lzQXJyYXkyKSB7XG4gICAgICAgICAgICBpZiAoX2kyID49IF9pdGVyYXRvcjIubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICAgIF9yZWYyID0gX2l0ZXJhdG9yMltfaTIrK107XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9pMiA9IF9pdGVyYXRvcjIubmV4dCgpO1xuICAgICAgICAgICAgaWYgKF9pMi5kb25lKSBicmVhaztcbiAgICAgICAgICAgIF9yZWYyID0gX2kyLnZhbHVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciB0aGVtZSA9IF9yZWYyO1xuXG4gICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IHRoZW1lLmNoaWxkcmVuLCBfaXNBcnJheTMgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjMpLCBfaTMgPSAwLCBfaXRlcmF0b3IzID0gX2lzQXJyYXkzID8gX2l0ZXJhdG9yMyA6IF9pdGVyYXRvcjNbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgICAgIHZhciBfcmVmMztcblxuICAgICAgICAgICAgaWYgKF9pc0FycmF5Mykge1xuICAgICAgICAgICAgICBpZiAoX2kzID49IF9pdGVyYXRvcjMubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICAgICAgX3JlZjMgPSBfaXRlcmF0b3IzW19pMysrXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIF9pMyA9IF9pdGVyYXRvcjMubmV4dCgpO1xuICAgICAgICAgICAgICBpZiAoX2kzLmRvbmUpIGJyZWFrO1xuICAgICAgICAgICAgICBfcmVmMyA9IF9pMy52YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGNoaWxkID0gX3JlZjM7XG5cbiAgICAgICAgICAgIF90aGlzMi5jcmVhdGVEYXRhU291cmNlXyhjaGlsZCwgY2hpbGQsIG9nY1NlcnZlcnMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHZhciBwcm9taXNlQmdMYXllcnMgPSBfdGhpczIuZ21mVGhlbWVzXy5nZXRCYWNrZ3JvdW5kTGF5ZXJzT2JqZWN0KCkudGhlbihmdW5jdGlvbiAoYmFja2dyb3VuZExheWVycykge1xuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3I0ID0gYmFja2dyb3VuZExheWVycywgX2lzQXJyYXk0ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I0KSwgX2k0ID0gMCwgX2l0ZXJhdG9yNCA9IF9pc0FycmF5NCA/IF9pdGVyYXRvcjQgOiBfaXRlcmF0b3I0W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgICAgdmFyIF9yZWY0O1xuXG4gICAgICAgICAgaWYgKF9pc0FycmF5NCkge1xuICAgICAgICAgICAgaWYgKF9pNCA+PSBfaXRlcmF0b3I0Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmNCA9IF9pdGVyYXRvcjRbX2k0KytdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfaTQgPSBfaXRlcmF0b3I0Lm5leHQoKTtcbiAgICAgICAgICAgIGlmIChfaTQuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmNCA9IF9pNC52YWx1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgYmFja2dyb3VuZExheWVyID0gX3JlZjQ7XG5cbiAgICAgICAgICBfdGhpczIuY3JlYXRlRGF0YVNvdXJjZV8obnVsbCwgYmFja2dyb3VuZExheWVyLCBvZ2NTZXJ2ZXJzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF90aGlzMi5xXy5hbGwoW3Byb21pc2VUaGVtZXMsIHByb21pc2VCZ0xheWVyc10pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczIudHJlZUN0cmxzVW5yZWdpc3Rlcl8gPSBfdGhpczIucm9vdFNjb3BlXy4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoX3RoaXMyLmdtZlRyZWVNYW5hZ2VyXy5yb290Q3RybCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwuY2hpbGRyZW47XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfdGhpczIuaGFuZGxlVHJlZU1hbmFnZXJSb290Q2hpbGRyZW5DaGFuZ2VfLmJpbmQoX3RoaXMyKSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlVHJlZU1hbmFnZXJSb290Q2hpbGRyZW5DaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlVHJlZU1hbmFnZXJSb290Q2hpbGRyZW5DaGFuZ2VfKHZhbHVlKSB7XG4gICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICB0aGlzLnRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgbmV3VHJlZUN0cmxzID0gW107XG5cbiAgICAgIHZhciB2aXNpdG9yID0gZnVuY3Rpb24gdmlzaXRvcih0cmVlQ3RybCkge1xuICAgICAgICB2YXIgbm9kZSA9IHRyZWVDdHJsLm5vZGU7XG4gICAgICAgIHZhciBncm91cE5vZGUgPSBub2RlO1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBncm91cE5vZGUuY2hpbGRyZW47XG5cbiAgICAgICAgaWYgKCFjaGlsZHJlbikge1xuICAgICAgICAgIG5ld1RyZWVDdHJscy5wdXNoKHRyZWVDdHJsKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdmFsdWUubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICB2YWx1ZVtpXS50cmF2ZXJzZURlcHRoRmlyc3QodmlzaXRvcik7XG4gICAgICB9XG5cbiAgICAgIGZvciAodmFyIF9pNSA9IDAsIF9paSA9IG5ld1RyZWVDdHJscy5sZW5ndGg7IF9pNSA8IF9paTsgX2k1KyspIHtcbiAgICAgICAgdmFyIG5ld1RyZWVDdHJsID0gbmV3VHJlZUN0cmxzW19pNV07XG5cbiAgICAgICAgdmFyIGNhY2hlSXRlbSA9IF90aGlzMy5nZXRUcmVlQ3RybENhY2hlSXRlbV8obmV3VHJlZUN0cmwpO1xuXG4gICAgICAgIGlmICghY2FjaGVJdGVtKSB7XG4gICAgICAgICAgX3RoaXMzLmFkZFRyZWVDdHJsVG9DYWNoZV8obmV3VHJlZUN0cmwpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBjYWNoZSA9IF90aGlzMy50cmVlQ3RybENhY2hlXztcblxuICAgICAgZm9yICh2YXIgaWQgaW4gX3RoaXMzLnRyZWVDdHJsQ2FjaGVfKSB7XG4gICAgICAgIHZhciBpdGVtID0gY2FjaGVbaWRdO1xuXG4gICAgICAgIGlmICghbmV3VHJlZUN0cmxzLmluY2x1ZGVzKGl0ZW0udHJlZUN0cmwpKSB7XG4gICAgICAgICAgX3RoaXMzLnJlbW92ZVRyZWVDdHJsQ2FjaGVJdGVtXyhpdGVtKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5jbGVhckRhdGFTb3VyY2VzXyA9IGZ1bmN0aW9uIGNsZWFyRGF0YVNvdXJjZXNfKCkge1xuICAgIHZhciBkYXRhU291cmNlcyA9IHRoaXMuZGF0YVNvdXJjZXNfLmdldEFycmF5KCk7XG5cbiAgICBmb3IgKHZhciBpID0gZGF0YVNvdXJjZXMubGVuZ3RoIC0gMSwgaWkgPSAwOyBpID49IGlpOyBpLS0pIHtcbiAgICAgIGlmICh0aGlzLmRhdGFTb3VyY2VzQ2FjaGVfW2RhdGFTb3VyY2VzW2ldLmlkXSkge1xuICAgICAgICB0aGlzLmRhdGFTb3VyY2VzXy5yZW1vdmUoZGF0YVNvdXJjZXNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNsZWFyT2JqZWN0KHRoaXMuZGF0YVNvdXJjZXNDYWNoZV8pO1xuICB9O1xuXG4gIF9wcm90by5jcmVhdGVEYXRhU291cmNlXyA9IGZ1bmN0aW9uIGNyZWF0ZURhdGFTb3VyY2VfKGZpcnN0TGV2ZWxHcm91cCwgbm9kZSwgb2djU2VydmVycykge1xuICAgIHZhciBncm91cE5vZGUgPSBub2RlO1xuICAgIHZhciBjaGlsZHJlbiA9IGdyb3VwTm9kZS5jaGlsZHJlbjtcblxuICAgIGlmIChjaGlsZHJlbikge1xuICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yNSA9IGNoaWxkcmVuLCBfaXNBcnJheTUgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjUpLCBfaTYgPSAwLCBfaXRlcmF0b3I1ID0gX2lzQXJyYXk1ID8gX2l0ZXJhdG9yNSA6IF9pdGVyYXRvcjVbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgdmFyIF9yZWY1O1xuXG4gICAgICAgIGlmIChfaXNBcnJheTUpIHtcbiAgICAgICAgICBpZiAoX2k2ID49IF9pdGVyYXRvcjUubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICBfcmVmNSA9IF9pdGVyYXRvcjVbX2k2KytdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9pNiA9IF9pdGVyYXRvcjUubmV4dCgpO1xuICAgICAgICAgIGlmIChfaTYuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgX3JlZjUgPSBfaTYudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY2hpbGQgPSBfcmVmNTtcbiAgICAgICAgdGhpcy5jcmVhdGVEYXRhU291cmNlXyhmaXJzdExldmVsR3JvdXAsIGNoaWxkLCBvZ2NTZXJ2ZXJzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBnbWZMYXllciA9IG5vZGU7XG4gICAgdmFyIGlkID0gTnVtYmVyKG9sVXRpbEdldFVpZChnbWZMYXllcikpO1xuXG4gICAgaWYgKHRoaXMuZGF0YVNvdXJjZXNDYWNoZV9baWRdKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG1ldGEgPSBnbWZMYXllci5tZXRhZGF0YTtcbiAgICB2YXIgb2djVHlwZSA9IGdtZkxheWVyLnR5cGU7XG4gICAgdmFyIG1heFJlc29sdXRpb24gPSAwO1xuICAgIHZhciBtaW5SZXNvbHV0aW9uID0gMDtcbiAgICB2YXIgd21zTGF5ZXJzO1xuICAgIHZhciB3ZnNMYXllcnM7XG4gICAgdmFyIG9nY1NlcnZlcjtcbiAgICB2YXIgd210c0xheWVyO1xuICAgIHZhciB3bXRzVXJsO1xuICAgIHZhciBvZ2NJbWFnZVR5cGU7XG4gICAgdmFyIHRpbWVQcm9wZXJ0eTtcblxuICAgIGlmIChvZ2NUeXBlID09PSBUaGVtZU5vZGVUeXBlLldNVFMpIHtcbiAgICAgIHZhciBnbWZMYXllcldNVFMgPSBnbWZMYXllcjtcbiAgICAgIHdtdHNMYXllciA9IGdtZkxheWVyV01UUy5sYXllcjtcbiAgICAgIHdtdHNVcmwgPSBnbWZMYXllcldNVFMudXJsO1xuICAgICAgbWF4UmVzb2x1dGlvbiA9IG1ldGEubWF4UmVzb2x1dGlvbjtcbiAgICAgIG1pblJlc29sdXRpb24gPSBtZXRhLm1pblJlc29sdXRpb247XG4gICAgICB2YXIgbGF5ZXJzID0gbWV0YS5xdWVyeUxheWVycyB8fCBtZXRhLndtc0xheWVycztcblxuICAgICAgaWYgKGxheWVycykge1xuICAgICAgICB3bXNMYXllcnMgPSBsYXllcnMuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24gKGxheWVyKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IGxheWVyLFxuICAgICAgICAgICAgcXVlcnlhYmxlOiB0cnVlXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHdmc0xheWVycyA9IGxheWVycy5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbiAobGF5ZXIpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWF4UmVzb2x1dGlvbjogbWF4UmVzb2x1dGlvbixcbiAgICAgICAgICAgIG1pblJlc29sdXRpb246IG1pblJlc29sdXRpb24sXG4gICAgICAgICAgICBuYW1lOiBsYXllcixcbiAgICAgICAgICAgIHF1ZXJ5YWJsZTogdHJ1ZVxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAobWV0YS5vZ2NTZXJ2ZXIgJiYgb2djU2VydmVyc1ttZXRhLm9nY1NlcnZlcl0pIHtcbiAgICAgICAgb2djU2VydmVyID0gb2djU2VydmVyc1ttZXRhLm9nY1NlcnZlcl07XG4gICAgICB9XG5cbiAgICAgIG9nY0ltYWdlVHlwZSA9IGdtZkxheWVyV01UUy5pbWFnZVR5cGU7XG4gICAgfSBlbHNlIGlmIChvZ2NUeXBlID09PSBUaGVtZU5vZGVUeXBlLldNUykge1xuICAgICAgdmFyIGdtZkxheWVyV01TID0gZ21mTGF5ZXI7XG4gICAgICBtYXhSZXNvbHV0aW9uID0gZ21mTGF5ZXJXTVMubWF4UmVzb2x1dGlvbkhpbnQ7XG4gICAgICBtaW5SZXNvbHV0aW9uID0gZ21mTGF5ZXJXTVMubWluUmVzb2x1dGlvbkhpbnQ7XG4gICAgICB2YXIgcXVlcnlhYmxlID0gZmFsc2U7XG5cbiAgICAgIGZvciAodmFyIF9pdGVyYXRvcjYgPSBnbWZMYXllcldNUy5jaGlsZExheWVycywgX2lzQXJyYXk2ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I2KSwgX2k3ID0gMCwgX2l0ZXJhdG9yNiA9IF9pc0FycmF5NiA/IF9pdGVyYXRvcjYgOiBfaXRlcmF0b3I2W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgIHZhciBfcmVmNjtcblxuICAgICAgICBpZiAoX2lzQXJyYXk2KSB7XG4gICAgICAgICAgaWYgKF9pNyA+PSBfaXRlcmF0b3I2Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgX3JlZjYgPSBfaXRlcmF0b3I2W19pNysrXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfaTcgPSBfaXRlcmF0b3I2Lm5leHQoKTtcbiAgICAgICAgICBpZiAoX2k3LmRvbmUpIGJyZWFrO1xuICAgICAgICAgIF9yZWY2ID0gX2k3LnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHdmc2xheWVyID0gX3JlZjY7XG5cbiAgICAgICAgaWYgKHdmc2xheWVyLnF1ZXJ5YWJsZSkge1xuICAgICAgICAgIHF1ZXJ5YWJsZSA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgd21zTGF5ZXJzID0gZ21mTGF5ZXJXTVMubGF5ZXJzLnNwbGl0KCcsJykubWFwKGZ1bmN0aW9uIChjaGlsZExheWVyKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbmFtZTogY2hpbGRMYXllcixcbiAgICAgICAgICBxdWVyeWFibGU6IHF1ZXJ5YWJsZVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICB3ZnNMYXllcnMgPSBnbWZMYXllcldNUy5jaGlsZExheWVycy5tYXAoZnVuY3Rpb24gKGNoaWxkTGF5ZXIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBtYXhSZXNvbHV0aW9uOiBjaGlsZExheWVyLm1heFJlc29sdXRpb25IaW50LFxuICAgICAgICAgIG1pblJlc29sdXRpb246IGNoaWxkTGF5ZXIubWluUmVzb2x1dGlvbkhpbnQsXG4gICAgICAgICAgbmFtZTogY2hpbGRMYXllci5uYW1lLFxuICAgICAgICAgIHF1ZXJ5YWJsZTogY2hpbGRMYXllci5xdWVyeWFibGVcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgdmFyIG9nY1NlcnZlck5hbWUgPSAhZmlyc3RMZXZlbEdyb3VwIHx8IGZpcnN0TGV2ZWxHcm91cC5taXhlZCA/IGdtZkxheWVyV01TLm9nY1NlcnZlciA6IGZpcnN0TGV2ZWxHcm91cC5vZ2NTZXJ2ZXI7XG4gICAgICBvZ2NTZXJ2ZXIgPSBvZ2NTZXJ2ZXJzW29nY1NlcnZlck5hbWVdO1xuICAgICAgb2djSW1hZ2VUeXBlID0gb2djU2VydmVyLmltYWdlVHlwZTtcblxuICAgICAgaWYgKGdtZkxheWVyV01TLnRpbWUpIHtcbiAgICAgICAgdGltZVByb3BlcnR5ID0gZ21mTGF5ZXJXTVMudGltZTtcbiAgICAgIH0gZWxzZSBpZiAoZmlyc3RMZXZlbEdyb3VwICYmIGZpcnN0TGV2ZWxHcm91cC50aW1lKSB7XG4gICAgICAgIHRpbWVQcm9wZXJ0eSA9IGZpcnN0TGV2ZWxHcm91cC50aW1lO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBvZ2NTZXJ2ZXJUeXBlID0gb2djU2VydmVyID8gb2djU2VydmVyLnR5cGUgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHdmc0ZlYXR1cmVOUyA9IG9nY1NlcnZlciA/IG9nY1NlcnZlci5uYW1lc3BhY2UgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHdtc0lzU2luZ2xlVGlsZSA9IG9nY1NlcnZlciA/IG9nY1NlcnZlci5pc1NpbmdsZVRpbGUgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHdmc1VybCA9IG9nY1NlcnZlciAmJiBvZ2NTZXJ2ZXIud2ZzU3VwcG9ydCA/IG9nY1NlcnZlci51cmxXZnMgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHdtc1VybCA9IG9nY1NlcnZlciA/IG9nY1NlcnZlci51cmwgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHdmc091dHB1dEZvcm1hdCA9IFdGU091dHB1dEZvcm1hdC5HTUwzO1xuXG4gICAgaWYgKG9nY1NlcnZlclR5cGUgPT09IFNlcnZlclR5cGUuUUdJU1NFUlZFUikge1xuICAgICAgd2ZzT3V0cHV0Rm9ybWF0ID0gV0ZTT3V0cHV0Rm9ybWF0LkdNTDI7XG4gICAgfVxuXG4gICAgdmFyIHNuYXBwYWJsZSA9ICEhbWV0YS5zbmFwcGluZ0NvbmZpZztcbiAgICB2YXIgc25hcHBpbmdUb2xlcmFuY2UgPSBtZXRhLnNuYXBwaW5nQ29uZmlnID8gbWV0YS5zbmFwcGluZ0NvbmZpZy50b2xlcmFuY2UgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHNuYXBwaW5nVG9FZGdlcyA9IG1ldGEuc25hcHBpbmdDb25maWcgPyBtZXRhLnNuYXBwaW5nQ29uZmlnLmVkZ2UgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHNuYXBwaW5nVG9WZXJ0aWNlID0gbWV0YS5zbmFwcGluZ0NvbmZpZyA/IG1ldGEuc25hcHBpbmdDb25maWcudmVydGV4IDogdW5kZWZpbmVkO1xuICAgIHZhciBkaW1lbnNpb25zID0gdGhpcy5kaW1lbnNpb25zXztcbiAgICB2YXIgZGltZW5zaW9uc0NvbmZpZyA9IG5vZGUuZGltZW5zaW9ucyB8fCBmaXJzdExldmVsR3JvdXAgPT09IG51bGwgPyB7fSA6IGZpcnN0TGV2ZWxHcm91cC5kaW1lbnNpb25zO1xuICAgIHZhciBkaW1lbnNpb25zRmlsdGVyc0NvbmZpZyA9IGdtZkxheWVyLmRpbWVuc2lvbnNGaWx0ZXJzO1xuICAgIHZhciB0aW1lTG93ZXJWYWx1ZTtcbiAgICB2YXIgdGltZVVwcGVyVmFsdWU7XG5cbiAgICBpZiAodGltZVByb3BlcnR5KSB7XG4gICAgICB2YXIgdGltZVZhbHVlcyA9IHRoaXMubmdlb1dNU1RpbWVfLmdldE9wdGlvbnModGltZVByb3BlcnR5KS52YWx1ZXM7XG5cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHRpbWVWYWx1ZXMpKSB7XG4gICAgICAgIHRpbWVMb3dlclZhbHVlID0gdGltZVZhbHVlc1swXTtcbiAgICAgICAgdGltZVVwcGVyVmFsdWUgPSB0aW1lVmFsdWVzWzFdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGltZUxvd2VyVmFsdWUgPSB0aW1lVmFsdWVzO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBjb3B5YWJsZSA9IG1ldGEuY29weWFibGU7XG4gICAgdmFyIGlkZW50aWZpZXJBdHRyaWJ1dGUgPSBtZXRhLmlkZW50aWZpZXJBdHRyaWJ1dGVGaWVsZDtcbiAgICB2YXIgbmFtZSA9IGdtZkxheWVyLm5hbWU7XG4gICAgdmFyIHRpbWVBdHRyaWJ1dGVOYW1lID0gbWV0YS50aW1lQXR0cmlidXRlO1xuICAgIHZhciB2aXNpYmxlID0gbWV0YS5pc0NoZWNrZWQgPT09IHRydWU7XG4gICAgdmFyIG9nY0F0dHJpYnV0ZXMgPSBvZ2NTZXJ2ZXIgPyBvZ2NTZXJ2ZXIuYXR0cmlidXRlcyA6IG51bGw7XG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICBjb3B5YWJsZTogY29weWFibGUsXG4gICAgICBkaW1lbnNpb25zQ29uZmlnOiBkaW1lbnNpb25zQ29uZmlnLFxuICAgICAgZGltZW5zaW9uc0ZpbHRlcnNDb25maWc6IGRpbWVuc2lvbnNGaWx0ZXJzQ29uZmlnLFxuICAgICAgZ21mTGF5ZXI6IGdtZkxheWVyLFxuICAgICAgaWQ6IGlkLFxuICAgICAgaWRlbnRpZmllckF0dHJpYnV0ZTogaWRlbnRpZmllckF0dHJpYnV0ZSxcbiAgICAgIG5hbWU6IG5hbWUsXG4gICAgICBvZ2NUeXBlOiBvZ2NUeXBlLFxuICAgICAgb2djQXR0cmlidXRlczogb2djQXR0cmlidXRlcyxcbiAgICAgIHNuYXBwYWJsZTogc25hcHBhYmxlLFxuICAgICAgdGltZUF0dHJpYnV0ZU5hbWU6IHRpbWVBdHRyaWJ1dGVOYW1lLFxuICAgICAgdmlzaWJsZTogdmlzaWJsZSxcbiAgICAgIHdmc091dHB1dEZvcm1hdDogd2ZzT3V0cHV0Rm9ybWF0XG4gICAgfTtcblxuICAgIGlmIChkaW1lbnNpb25zKSB7XG4gICAgICBvcHRpb25zLmRpbWVuc2lvbnMgPSBkaW1lbnNpb25zO1xuICAgIH1cblxuICAgIGlmIChtYXhSZXNvbHV0aW9uKSB7XG4gICAgICBvcHRpb25zLm1heFJlc29sdXRpb24gPSBtYXhSZXNvbHV0aW9uO1xuICAgIH1cblxuICAgIGlmIChtaW5SZXNvbHV0aW9uKSB7XG4gICAgICBvcHRpb25zLm1pblJlc29sdXRpb24gPSBtaW5SZXNvbHV0aW9uO1xuICAgIH1cblxuICAgIGlmIChvZ2NJbWFnZVR5cGUpIHtcbiAgICAgIG9wdGlvbnMub2djSW1hZ2VUeXBlID0gb2djSW1hZ2VUeXBlO1xuICAgIH1cblxuICAgIGlmICh3bXNMYXllcnMpIHtcbiAgICAgIG9wdGlvbnMud21zTGF5ZXJzID0gd21zTGF5ZXJzO1xuICAgIH1cblxuICAgIGlmICh3ZnNMYXllcnMpIHtcbiAgICAgIG9wdGlvbnMud2ZzTGF5ZXJzID0gd2ZzTGF5ZXJzO1xuICAgIH1cblxuICAgIGlmIChvZ2NTZXJ2ZXJUeXBlKSB7XG4gICAgICBvcHRpb25zLm9nY1NlcnZlclR5cGUgPSBvZ2NTZXJ2ZXJUeXBlO1xuICAgIH1cblxuICAgIGlmICh3ZnNGZWF0dXJlTlMpIHtcbiAgICAgIG9wdGlvbnMud2ZzRmVhdHVyZU5TID0gd2ZzRmVhdHVyZU5TO1xuICAgIH1cblxuICAgIGlmIChzbmFwcGluZ1RvbGVyYW5jZSkge1xuICAgICAgb3B0aW9ucy5zbmFwcGluZ1RvbGVyYW5jZSA9IHNuYXBwaW5nVG9sZXJhbmNlO1xuICAgIH1cblxuICAgIGlmIChzbmFwcGluZ1RvRWRnZXMpIHtcbiAgICAgIG9wdGlvbnMuc25hcHBpbmdUb0VkZ2VzID0gc25hcHBpbmdUb0VkZ2VzO1xuICAgIH1cblxuICAgIGlmIChzbmFwcGluZ1RvVmVydGljZSkge1xuICAgICAgb3B0aW9ucy5zbmFwcGluZ1RvVmVydGljZSA9IHNuYXBwaW5nVG9WZXJ0aWNlO1xuICAgIH1cblxuICAgIGlmICh0aW1lTG93ZXJWYWx1ZSkge1xuICAgICAgb3B0aW9ucy50aW1lTG93ZXJWYWx1ZSA9IHRpbWVMb3dlclZhbHVlO1xuICAgIH1cblxuICAgIGlmICh0aW1lUHJvcGVydHkpIHtcbiAgICAgIG9wdGlvbnMudGltZVByb3BlcnR5ID0gdGltZVByb3BlcnR5O1xuICAgIH1cblxuICAgIGlmICh0aW1lVXBwZXJWYWx1ZSkge1xuICAgICAgb3B0aW9ucy50aW1lVXBwZXJWYWx1ZSA9IHRpbWVVcHBlclZhbHVlO1xuICAgIH1cblxuICAgIGlmICh3ZnNVcmwpIHtcbiAgICAgIG9wdGlvbnMud2ZzVXJsID0gd2ZzVXJsO1xuICAgIH1cblxuICAgIGlmICh3bXNJc1NpbmdsZVRpbGUpIHtcbiAgICAgIG9wdGlvbnMud21zSXNTaW5nbGVUaWxlID0gd21zSXNTaW5nbGVUaWxlO1xuICAgIH1cblxuICAgIGlmICh3bXNVcmwpIHtcbiAgICAgIG9wdGlvbnMud21zVXJsID0gd21zVXJsO1xuICAgIH1cblxuICAgIGlmICh3bXRzTGF5ZXIpIHtcbiAgICAgIG9wdGlvbnMud210c0xheWVyID0gd210c0xheWVyO1xuICAgIH1cblxuICAgIGlmICh3bXRzVXJsKSB7XG4gICAgICBvcHRpb25zLndtdHNVcmwgPSB3bXRzVXJsO1xuICAgIH1cblxuICAgIHRoaXMuZGF0YVNvdXJjZXNDYWNoZV9baWRdID0gbmV3IEdtZkRhdGFzb3VyY2VPR0Mob3B0aW9ucyk7XG4gIH07XG5cbiAgX3Byb3RvLmFkZFRyZWVDdHJsVG9DYWNoZV8gPSBmdW5jdGlvbiBhZGRUcmVlQ3RybFRvQ2FjaGVfKHRyZWVDdHJsKSB7XG4gICAgdmFyIGlkID0gb2xVdGlsR2V0VWlkKHRyZWVDdHJsLm5vZGUpO1xuICAgIHZhciBkYXRhU291cmNlID0gdGhpcy5kYXRhU291cmNlc0NhY2hlX1tpZF07XG5cbiAgICBpZiAoIWRhdGFTb3VyY2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkYXRhU291cmNlJyk7XG4gICAgfVxuXG4gICAgdHJlZUN0cmwuc2V0RGF0YVNvdXJjZShkYXRhU291cmNlKTtcbiAgICB2YXIgc3RhdGVXYXRjaGVyVW5yZWdpc3RlciA9IHRoaXMucm9vdFNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRyZWVDdHJsLmdldFN0YXRlKCk7XG4gICAgfSwgdGhpcy5oYW5kbGVUcmVlQ3RybFN0YXRlQ2hhbmdlXy5iaW5kKHRoaXMsIHRyZWVDdHJsKSk7XG4gICAgdmFyIGZpbHRlclJ1bGVzV2F0Y2hlclVucmVnaXN0ZXIgPSB0aGlzLnJvb3RTY29wZV8uJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBoYXNGaWx0ZXJzID0gZGF0YVNvdXJjZS5maWx0ZXJSdWxlcyAhPT0gbnVsbDtcbiAgICAgIHZhciBpc1Zpc2libGUgPSBkYXRhU291cmNlLnZpc2libGU7XG4gICAgICByZXR1cm4gaGFzRmlsdGVycyAmJiBpc1Zpc2libGU7XG4gICAgfSwgdGhpcy5oYW5kbGVEYXRhU291cmNlRmlsdGVyUnVsZXNDaGFuZ2VfLmJpbmQodGhpcywgZGF0YVNvdXJjZSkpO1xuICAgIHZhciB0aW1lTG93ZXJWYWx1ZVdhdGNoZXJVbnJlZ2lzdGVyO1xuICAgIHZhciB0aW1lVXBwZXJWYWx1ZVdhdGNoZXJVbnJlZ2lzdGVyO1xuICAgIHZhciB3bXNMYXllcjtcblxuICAgIGlmIChkYXRhU291cmNlLnRpbWVQcm9wZXJ0eSAmJiBkYXRhU291cmNlLm9nY1R5cGUgPT09IFR5cGUuV01TKSB7XG4gICAgICB0aW1lTG93ZXJWYWx1ZVdhdGNoZXJVbnJlZ2lzdGVyID0gdGhpcy5yb290U2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBkYXRhU291cmNlLnRpbWVMb3dlclZhbHVlO1xuICAgICAgfSwgdGhpcy5oYW5kbGVEYXRhU291cmNlVGltZVZhbHVlQ2hhbmdlXy5iaW5kKHRoaXMsIGRhdGFTb3VyY2UpKTtcblxuICAgICAgaWYgKGRhdGFTb3VyY2UudGltZVByb3BlcnR5Lm1vZGUgPT09ICdyYW5nZScpIHtcbiAgICAgICAgdGltZVVwcGVyVmFsdWVXYXRjaGVyVW5yZWdpc3RlciA9IHRoaXMucm9vdFNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBkYXRhU291cmNlLnRpbWVVcHBlclZhbHVlO1xuICAgICAgICB9LCB0aGlzLmhhbmRsZURhdGFTb3VyY2VUaW1lVmFsdWVDaGFuZ2VfLmJpbmQodGhpcywgZGF0YVNvdXJjZSkpO1xuICAgICAgfVxuXG4gICAgICB3bXNMYXllciA9IGdldExheWVyKHRyZWVDdHJsKTtcbiAgICB9XG5cbiAgICB0aGlzLnRyZWVDdHJsQ2FjaGVfW2lkXSA9IHtcbiAgICAgIGZpbHRlclJ1bGVzV2F0Y2hlclVucmVnaXN0ZXI6IGZpbHRlclJ1bGVzV2F0Y2hlclVucmVnaXN0ZXIsXG4gICAgICBzdGF0ZVdhdGNoZXJVbnJlZ2lzdGVyOiBzdGF0ZVdhdGNoZXJVbnJlZ2lzdGVyLFxuICAgICAgdGltZUxvd2VyVmFsdWVXYXRjaGVyVW5yZWdpc3RlcjogdGltZUxvd2VyVmFsdWVXYXRjaGVyVW5yZWdpc3RlcixcbiAgICAgIHRpbWVVcHBlclZhbHVlV2F0Y2hlclVucmVnaXN0ZXI6IHRpbWVVcHBlclZhbHVlV2F0Y2hlclVucmVnaXN0ZXIsXG4gICAgICB0cmVlQ3RybDogdHJlZUN0cmwsXG4gICAgICB3bXNMYXllcjogd21zTGF5ZXJcbiAgICB9O1xuICAgIHRoaXMuZGF0YVNvdXJjZXNfLnB1c2goZGF0YVNvdXJjZSk7XG4gICAgdGhpcy5nbWZXRlNBbGlhc2VzXy5kZXNjcmliZShkYXRhU291cmNlKTtcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlVHJlZUN0cmxDYWNoZUl0ZW1fID0gZnVuY3Rpb24gcmVtb3ZlVHJlZUN0cmxDYWNoZUl0ZW1fKGl0ZW0pIHtcbiAgICB2YXIgZGF0YVNvdXJjZSA9IGl0ZW0udHJlZUN0cmwuZ2V0RGF0YVNvdXJjZSgpO1xuXG4gICAgaWYgKCFkYXRhU291cmNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFTb3VyY2Ugc2hvdWxkIGJlIHNldCcpO1xuICAgIH1cblxuICAgIHRoaXMuZGF0YVNvdXJjZXNfLnJlbW92ZShkYXRhU291cmNlKTtcbiAgICBpdGVtLnRyZWVDdHJsLnNldERhdGFTb3VyY2UobnVsbCk7XG4gICAgaXRlbS5maWx0ZXJSdWxlc1dhdGNoZXJVbnJlZ2lzdGVyKCk7XG4gICAgaXRlbS5zdGF0ZVdhdGNoZXJVbnJlZ2lzdGVyKCk7XG5cbiAgICBpZiAoaXRlbS50aW1lTG93ZXJWYWx1ZVdhdGNoZXJVbnJlZ2lzdGVyKSB7XG4gICAgICBpdGVtLnRpbWVMb3dlclZhbHVlV2F0Y2hlclVucmVnaXN0ZXIoKTtcbiAgICB9XG5cbiAgICBpZiAoaXRlbS50aW1lVXBwZXJWYWx1ZVdhdGNoZXJVbnJlZ2lzdGVyKSB7XG4gICAgICBpdGVtLnRpbWVVcHBlclZhbHVlV2F0Y2hlclVucmVnaXN0ZXIoKTtcbiAgICB9XG5cbiAgICBkZWxldGUgdGhpcy50cmVlQ3RybENhY2hlX1tvbFV0aWxHZXRVaWQoaXRlbS50cmVlQ3RybC5ub2RlKV07XG4gIH07XG5cbiAgX3Byb3RvLmNsZWFyVHJlZUN0cmxDYWNoZV8gPSBmdW5jdGlvbiBjbGVhclRyZWVDdHJsQ2FjaGVfKCkge1xuICAgIGZvciAodmFyIGlkIGluIHRoaXMudHJlZUN0cmxDYWNoZV8pIHtcbiAgICAgIHRoaXMucmVtb3ZlVHJlZUN0cmxDYWNoZUl0ZW1fKHRoaXMudHJlZUN0cmxDYWNoZV9baWRdKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZVRyZWVDdHJsU3RhdGVDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlVHJlZUN0cmxTdGF0ZUNoYW5nZV8odHJlZUN0cmwsIG5ld1ZhbCkge1xuICAgIHZhciB0cmVlRGF0YVNvdXJjZSA9IHRyZWVDdHJsLmdldERhdGFTb3VyY2UoKTtcblxuICAgIGlmICghdHJlZURhdGFTb3VyY2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YVNvdXJjZSBzaG91bGQgYmUgc2V0Jyk7XG4gICAgfVxuXG4gICAgdmFyIHZpc2libGUgPSBuZXdWYWwgPT09ICdvbic7XG4gICAgdHJlZURhdGFTb3VyY2UudmlzaWJsZSA9IHZpc2libGU7XG4gICAgdmFyIGxheWVyID0gdGhpcy5nZXREYXRhU291cmNlTGF5ZXJfKHRyZWVEYXRhU291cmNlKTtcblxuICAgIGlmIChsYXllciA9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZUxheWVyRmlsdGVyXyhsYXllcik7XG4gIH07XG5cbiAgX3Byb3RvLmdldFRyZWVDdHJsQ2FjaGVJdGVtXyA9IGZ1bmN0aW9uIGdldFRyZWVDdHJsQ2FjaGVJdGVtXyh0cmVlQ3RybCkge1xuICAgIHJldHVybiB0aGlzLnRyZWVDdHJsQ2FjaGVfW29sVXRpbEdldFVpZCh0cmVlQ3RybC5ub2RlKV0gfHwgbnVsbDtcbiAgfTtcblxuICBfcHJvdG8uZ2V0RGF0YVNvdXJjZUxheWVyXyA9IGZ1bmN0aW9uIGdldERhdGFTb3VyY2VMYXllcl8oZGF0YVNvdXJjZSkge1xuICAgIGlmICghKGRhdGFTb3VyY2UgaW5zdGFuY2VvZiBnbWZPR0MpIHx8IGRhdGFTb3VyY2UuZ21mTGF5ZXIgPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGlkID0gb2xVdGlsR2V0VWlkKGRhdGFTb3VyY2UuZ21mTGF5ZXIpO1xuXG4gICAgaWYgKGlkID09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBpdGVtID0gdGhpcy50cmVlQ3RybENhY2hlX1tpZF07XG5cbiAgICBpZiAoaXRlbSA9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgdHJlZUN0cmwgPSBpdGVtLnRyZWVDdHJsO1xuICAgIHJldHVybiBnZXRMYXllcih0cmVlQ3RybCk7XG4gIH07XG5cbiAgX3Byb3RvLnVwZGF0ZUxheWVyRmlsdGVyXyA9IGZ1bmN0aW9uIHVwZGF0ZUxheWVyRmlsdGVyXyhsYXllcikge1xuICAgIHZhciBfc291cmNlJHVwZGF0ZVBhcmFtcztcblxuICAgIGlmICghKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckltYWdlIHx8IGxheWVyIGluc3RhbmNlb2Ygb2xMYXllclRpbGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHNvdXJjZSA9IGxheWVyLmdldFNvdXJjZSgpO1xuXG4gICAgaWYgKCEoc291cmNlIGluc3RhbmNlb2Ygb2xTb3VyY2VJbWFnZVdNUyB8fCBzb3VyY2UgaW5zdGFuY2VvZiBvbFNvdXJjZVRpbGVXTVMpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHBhcmFtcyA9IHNvdXJjZS5nZXRQYXJhbXMoKTtcbiAgICB2YXIgbGF5ZXJzUGFyYW0gPSBwYXJhbXMuTEFZRVJTO1xuICAgIHZhciBsYXllcnNMaXN0ID0gbGF5ZXJzUGFyYW0uc3BsaXQoJywnKTtcblxuICAgIGlmICghbGF5ZXJzTGlzdC5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsYXllcnNMaXN0Jyk7XG4gICAgfVxuXG4gICAgdmFyIGZpbHRlclBhcmFtID0gJ0ZJTFRFUic7XG4gICAgdmFyIGZpbHRlclBhcmFtVmFsdWVzID0gW107XG4gICAgdmFyIGhhc0ZpbHRlciA9IGZhbHNlO1xuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yNyA9IGxheWVyc0xpc3QsIF9pc0FycmF5NyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNyksIF9pOCA9IDAsIF9pdGVyYXRvcjcgPSBfaXNBcnJheTcgPyBfaXRlcmF0b3I3IDogX2l0ZXJhdG9yN1tTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY3O1xuXG4gICAgICBpZiAoX2lzQXJyYXk3KSB7XG4gICAgICAgIGlmIChfaTggPj0gX2l0ZXJhdG9yNy5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmNyA9IF9pdGVyYXRvcjdbX2k4KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k4ID0gX2l0ZXJhdG9yNy5uZXh0KCk7XG4gICAgICAgIGlmIChfaTguZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWY3ID0gX2k4LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgd21zTGF5ZXJOYW1lID0gX3JlZjc7XG4gICAgICB2YXIgZmlsdGVyUGFyYW1WYWx1ZSA9ICcoKSc7XG4gICAgICB2YXIgZGF0YVNvdXJjZXMgPSB0aGlzLmRhdGFTb3VyY2VzXy5nZXRBcnJheSgpO1xuXG4gICAgICBmb3IgKHZhciBfaXRlcmF0b3I4ID0gZGF0YVNvdXJjZXMsIF9pc0FycmF5OCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yOCksIF9pOSA9IDAsIF9pdGVyYXRvcjggPSBfaXNBcnJheTggPyBfaXRlcmF0b3I4IDogX2l0ZXJhdG9yOFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICB2YXIgX3JlZjg7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5OCkge1xuICAgICAgICAgIGlmIChfaTkgPj0gX2l0ZXJhdG9yOC5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWY4ID0gX2l0ZXJhdG9yOFtfaTkrK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2k5ID0gX2l0ZXJhdG9yOC5uZXh0KCk7XG4gICAgICAgICAgaWYgKF9pOS5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmOCA9IF9pOS52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBkYXRhU291cmNlID0gX3JlZjg7XG4gICAgICAgIHZhciBkc0xheWVyID0gdGhpcy5nZXREYXRhU291cmNlTGF5ZXJfKGRhdGFTb3VyY2UpO1xuXG4gICAgICAgIGlmIChkc0xheWVyID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCEoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIGdtZk9HQykpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGRhdGFTb3VyY2UgdHlwZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGdtZkxheWVyV01TID0gZGF0YVNvdXJjZS5nbWZMYXllcjtcblxuICAgICAgICBpZiAob2xVdGlsR2V0VWlkKGRzTGF5ZXIpID09IG9sVXRpbEdldFVpZChsYXllcikgJiYgbGF5ZXIuZ2V0KCdxdWVyeVNvdXJjZUlkcycpLmluY2x1ZGVzKFN0cmluZyhkYXRhU291cmNlLmlkKSkgJiYgZ21mTGF5ZXJXTVMubGF5ZXJzLnNwbGl0KCcsJykuaW5jbHVkZXMod21zTGF5ZXJOYW1lKSkge1xuICAgICAgICAgIHZhciBpZCA9IG9sVXRpbEdldFVpZChkYXRhU291cmNlLmdtZkxheWVyKTtcbiAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMudHJlZUN0cmxDYWNoZV9baWRdO1xuXG4gICAgICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgaXRlbScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciB0cmVlQ3RybCA9IGl0ZW0udHJlZUN0cmw7XG4gICAgICAgICAgdmFyIHByb2pDb2RlID0gdHJlZUN0cmwubWFwLmdldFZpZXcoKS5nZXRQcm9qZWN0aW9uKCkuZ2V0Q29kZSgpO1xuXG4gICAgICAgICAgaWYgKCEoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIE9HQykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZGF0YXNvdXJjZScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBmaWx0ZXJTdHJpbmcgPSBkYXRhU291cmNlLnZpc2libGUgPyB0aGlzLm5nZW9SdWxlSGVscGVyXy5jcmVhdGVGaWx0ZXJTdHJpbmcoe1xuICAgICAgICAgICAgZGF0YVNvdXJjZTogZGF0YVNvdXJjZSxcbiAgICAgICAgICAgIHByb2pDb2RlOiBwcm9qQ29kZSxcbiAgICAgICAgICAgIGluY0RpbWVuc2lvbnM6IHRydWVcbiAgICAgICAgICB9KSA6IG51bGw7XG5cbiAgICAgICAgICBpZiAoZmlsdGVyU3RyaW5nKSB7XG4gICAgICAgICAgICBmaWx0ZXJQYXJhbVZhbHVlID0gXCIoXCIgKyBmaWx0ZXJTdHJpbmcgKyBcIilcIjtcbiAgICAgICAgICAgIGhhc0ZpbHRlciA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZpbHRlclBhcmFtVmFsdWVzLnB1c2goZmlsdGVyUGFyYW1WYWx1ZSk7XG4gICAgfVxuXG4gICAgc291cmNlLnVwZGF0ZVBhcmFtcygoX3NvdXJjZSR1cGRhdGVQYXJhbXMgPSB7fSwgX3NvdXJjZSR1cGRhdGVQYXJhbXNbZmlsdGVyUGFyYW1dID0gaGFzRmlsdGVyID8gZmlsdGVyUGFyYW1WYWx1ZXMuam9pbignJykgOiBudWxsLCBfc291cmNlJHVwZGF0ZVBhcmFtcykpO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEYXRhU291cmNlRmlsdGVyUnVsZXNDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlRGF0YVNvdXJjZUZpbHRlclJ1bGVzQ2hhbmdlXyhkYXRhU291cmNlKSB7XG4gICAgaWYgKGRhdGFTb3VyY2UuZmlsdHJhYmxlICE9PSB0cnVlIHx8IGRhdGFTb3VyY2Uub2djVHlwZSAhPT0gVHlwZS5XTVMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgbGF5ZXIgPSB0aGlzLmdldERhdGFTb3VyY2VMYXllcl8oZGF0YVNvdXJjZSk7XG5cbiAgICBpZiAobGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlTGF5ZXJGaWx0ZXJfKGxheWVyKTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRGF0YVNvdXJjZVRpbWVWYWx1ZUNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVEYXRhU291cmNlVGltZVZhbHVlQ2hhbmdlXyhkYXRhU291cmNlKSB7XG4gICAgdmFyIGlkID0gb2xVdGlsR2V0VWlkKGRhdGFTb3VyY2UuZ21mTGF5ZXIpO1xuICAgIHZhciBpdGVtID0gdGhpcy50cmVlQ3RybENhY2hlX1tpZF07XG5cbiAgICBpZiAoIWl0ZW0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBpdGVtJyk7XG4gICAgfVxuXG4gICAgdmFyIHdtc0xheWVyID0gaXRlbS53bXNMYXllcjtcbiAgICB2YXIgd21zU291cmNlID0gd21zTGF5ZXIuZ2V0U291cmNlKCk7XG4gICAgdmFyIHRpbWVQcm9wZXJ0eSA9IGRhdGFTb3VyY2UudGltZVByb3BlcnR5O1xuICAgIHZhciB0aW1lUGFyYW07XG4gICAgdmFyIHJhbmdlID0gZGF0YVNvdXJjZS50aW1lUmFuZ2VWYWx1ZTtcblxuICAgIGlmIChyYW5nZSkge1xuICAgICAgaWYgKCF0aW1lUHJvcGVydHkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHRpbWVQcm9wZXJ0eScpO1xuICAgICAgfVxuXG4gICAgICB0aW1lUGFyYW0gPSB0aGlzLm5nZW9XTVNUaW1lXy5mb3JtYXRXTVNUaW1lUGFyYW0odGltZVByb3BlcnR5LCByYW5nZSk7XG4gICAgfVxuXG4gICAgdmFyIHBhcmFtcyA9IHdtc1NvdXJjZS5nZXRQYXJhbXMoKTtcbiAgICB2YXIgY3VycmVudFRpbWVQYXJhbSA9IHBhcmFtcy5USU1FO1xuXG4gICAgaWYgKGN1cnJlbnRUaW1lUGFyYW0gPT09IHRpbWVQYXJhbSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMubmdlb0xheWVySGVscGVyXy51cGRhdGVXTVNMYXllclN0YXRlKHdtc0xheWVyLCB3bXNTb3VyY2UuZ2V0UGFyYW1zKCkuTEFZRVJTLCB0aW1lUGFyYW0pO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVOZ2VvQmFja2dyb3VuZExheWVyQ2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZU5nZW9CYWNrZ3JvdW5kTGF5ZXJDaGFuZ2VfKGV2dCkge1xuICAgIHZhciBldmVudCA9IGV2dDtcbiAgICB2YXIgcHJldmlvdXNCYWNrZ3JvdW5kTGF5ZXIgPSBldmVudC5kZXRhaWwucHJldmlvdXM7XG4gICAgdmFyIGN1cnJlbnRCYWNrZ3JvdW5kTGF5ZXIgPSBldmVudC5kZXRhaWwuY3VycmVudDtcbiAgICB2YXIgY2FjaGUgPSB0aGlzLmRhdGFTb3VyY2VzQ2FjaGVfO1xuXG4gICAgaWYgKHByZXZpb3VzQmFja2dyb3VuZExheWVyKSB7XG4gICAgICB2YXIgaWRzID0gcHJldmlvdXNCYWNrZ3JvdW5kTGF5ZXIuZ2V0KCdxdWVyeVNvdXJjZUlkcycpO1xuXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShpZHMpKSB7XG4gICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjkgPSBpZHMsIF9pc0FycmF5OSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yOSksIF9pMTAgPSAwLCBfaXRlcmF0b3I5ID0gX2lzQXJyYXk5ID8gX2l0ZXJhdG9yOSA6IF9pdGVyYXRvcjlbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgICB2YXIgX3JlZjk7XG5cbiAgICAgICAgICBpZiAoX2lzQXJyYXk5KSB7XG4gICAgICAgICAgICBpZiAoX2kxMCA+PSBfaXRlcmF0b3I5Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmOSA9IF9pdGVyYXRvcjlbX2kxMCsrXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2kxMCA9IF9pdGVyYXRvcjkubmV4dCgpO1xuICAgICAgICAgICAgaWYgKF9pMTAuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmOSA9IF9pMTAudmFsdWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGlkID0gX3JlZjk7XG4gICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBjYWNoZVtpZF07XG5cbiAgICAgICAgICBpZiAoZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgZGF0YVNvdXJjZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2VzXy5yZW1vdmUoZGF0YVNvdXJjZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGN1cnJlbnRCYWNrZ3JvdW5kTGF5ZXIpIHtcbiAgICAgIHZhciBfaWRzID0gY3VycmVudEJhY2tncm91bmRMYXllci5nZXQoJ3F1ZXJ5U291cmNlSWRzJyk7XG5cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KF9pZHMpKSB7XG4gICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjEwID0gX2lkcywgX2lzQXJyYXkxMCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMTApLCBfaTExID0gMCwgX2l0ZXJhdG9yMTAgPSBfaXNBcnJheTEwID8gX2l0ZXJhdG9yMTAgOiBfaXRlcmF0b3IxMFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICAgIHZhciBfcmVmMTA7XG5cbiAgICAgICAgICBpZiAoX2lzQXJyYXkxMCkge1xuICAgICAgICAgICAgaWYgKF9pMTEgPj0gX2l0ZXJhdG9yMTAubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICAgIF9yZWYxMCA9IF9pdGVyYXRvcjEwW19pMTErK107XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9pMTEgPSBfaXRlcmF0b3IxMC5uZXh0KCk7XG4gICAgICAgICAgICBpZiAoX2kxMS5kb25lKSBicmVhaztcbiAgICAgICAgICAgIF9yZWYxMCA9IF9pMTEudmFsdWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIF9pZCA9IF9yZWYxMDtcbiAgICAgICAgICB2YXIgX2RhdGFTb3VyY2UgPSBjYWNoZVtfaWRdO1xuXG4gICAgICAgICAgaWYgKF9kYXRhU291cmNlKSB7XG4gICAgICAgICAgICBfZGF0YVNvdXJjZS52aXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGF0YVNvdXJjZXNfLnB1c2goX2RhdGFTb3VyY2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gRGF0YXNvdXJjZU1hbmFnZXI7XG59KCk7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZkRhdGFTb3VyY2VzTWFuYWdlcicsIFtnbWZEYXRhc291cmNlV0ZTQWxpYXNlcy5uYW1lLCBnbWZMYXllcnRyZWVTeW5jTGF5ZXJ0cmVlTWFwLm5hbWUsIGdtZkxheWVydHJlZVRyZWVNYW5hZ2VyLm5hbWUsIGdtZlRoZW1lVGhlbWVzLm5hbWUsIG5nZW9GaWx0ZXJSdWxlSGVscGVyLm5hbWUsIG5nZW9EYXRhc291cmNlRGF0YVNvdXJjZXMubmFtZSwgbmdlb01hcEJhY2tncm91bmRMYXllck1nci5uYW1lLCBuZ2VvTWFwTGF5ZXJIZWxwZXIubmFtZSwgbmdlb01pc2NXTVNUaW1lLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCdnbWZEYXRhU291cmNlc01hbmFnZXInLCBEYXRhc291cmNlTWFuYWdlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IG5nZW9EYXRhc291cmNlT0dDIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9PR0MuanMnO1xuXG52YXIgR21mRGF0YXNvdXJjZU9HQyA9IGZ1bmN0aW9uIChfbmdlb0RhdGFzb3VyY2VPR0MpIHtcbiAgX2luaGVyaXRzTG9vc2UoR21mRGF0YXNvdXJjZU9HQywgX25nZW9EYXRhc291cmNlT0dDKTtcblxuICBmdW5jdGlvbiBHbWZEYXRhc291cmNlT0dDKG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfdGhpcyA9IF9uZ2VvRGF0YXNvdXJjZU9HQy5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgX3RoaXMuZ21mTGF5ZXJfID0gb3B0aW9ucy5nbWZMYXllcjtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoR21mRGF0YXNvdXJjZU9HQywgW3tcbiAgICBrZXk6IFwiZ21mTGF5ZXJcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmdtZkxheWVyXztcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gR21mRGF0YXNvdXJjZU9HQztcbn0obmdlb0RhdGFzb3VyY2VPR0MpO1xuXG5leHBvcnQgZGVmYXVsdCBHbWZEYXRhc291cmNlT0dDOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlSGVscGVyIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9IZWxwZXIuanMnO1xuaW1wb3J0IHsgU2VydmVyVHlwZSB9IGZyb20gJ25nZW8vZGF0YXNvdXJjZS9PR0MuanMnO1xuZXhwb3J0IHZhciBEYXRhc291cmNlV0ZTQWxpYXMgPSBmdW5jdGlvbiAoKSB7XG4gIERhdGFzb3VyY2VXRlNBbGlhcy4kaW5qZWN0ID0gW1wibmdlb0RhdGFTb3VyY2VzSGVscGVyXCJdO1xuXG4gIGZ1bmN0aW9uIERhdGFzb3VyY2VXRlNBbGlhcyhuZ2VvRGF0YVNvdXJjZXNIZWxwZXIpIHtcbiAgICB0aGlzLm5nZW9EYXRhU291cmNlc0hlbHBlcl8gPSBuZ2VvRGF0YVNvdXJjZXNIZWxwZXI7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gRGF0YXNvdXJjZVdGU0FsaWFzLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZGVzY3JpYmUgPSBmdW5jdGlvbiBkZXNjcmliZShkYXRhU291cmNlKSB7XG4gICAgaWYgKGRhdGFTb3VyY2Uub2djU2VydmVyVHlwZSA9PT0gU2VydmVyVHlwZS5RR0lTU0VSVkVSICYmIGRhdGFTb3VyY2Uud2ZzVXJsXyAmJiBkYXRhU291cmNlLmdldFdGU0xheWVyTmFtZXMoKS5sZW5ndGggPT0gMSAmJiAhZGF0YVNvdXJjZS5hdHRyaWJ1dGVzKSB7XG4gICAgICB0aGlzLm5nZW9EYXRhU291cmNlc0hlbHBlcl8uZ2V0RGF0YVNvdXJjZUF0dHJpYnV0ZXMoZGF0YVNvdXJjZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBEYXRhc291cmNlV0ZTQWxpYXM7XG59KCk7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZkRhdGFzb3VyY2VXRlNBbGlhc2VzJywgW25nZW9EYXRhc291cmNlSGVscGVyLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCdnbWZXRlNBbGlhc2VzJywgRGF0YXNvdXJjZVdGU0FsaWFzKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZEYXRhc291cmNlRGF0YVNvdXJjZUJlaW5nRmlsdGVyZWQgZnJvbSAnZ21mL2RhdGFzb3VyY2UvRGF0YVNvdXJjZUJlaW5nRmlsdGVyZWQuanMnO1xuaW1wb3J0IGdtZkRhdGFzb3VyY2VFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlciBmcm9tICdnbWYvZGF0YXNvdXJjZS9FeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlci5qcyc7XG5pbXBvcnQgZ21mRGF0YXNvdXJjZUhlbHBlciBmcm9tICdnbWYvZGF0YXNvdXJjZS9IZWxwZXIuanMnO1xuaW1wb3J0IGdtZkRhdGFzb3VyY2VNYW5hZ2VyIGZyb20gJ2dtZi9kYXRhc291cmNlL01hbmFnZXIuanMnO1xuaW1wb3J0IGdtZkRhdGFzb3VyY2VXRlNBbGlhc2VzIGZyb20gJ2dtZi9kYXRhc291cmNlL1dGU0FsaWFzZXMuanMnO1xuZXhwb3J0IGRlZmF1bHQgYW5ndWxhci5tb2R1bGUoJ2dtZkRhdGFzb3VyY2VNb2R1bGUnLCBbZ21mRGF0YXNvdXJjZURhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkLm5hbWUsIGdtZkRhdGFzb3VyY2VFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlci5uYW1lLCBnbWZEYXRhc291cmNlSGVscGVyLm5hbWUsIGdtZkRhdGFzb3VyY2VNYW5hZ2VyLm5hbWUsIGdtZkRhdGFzb3VyY2VXRlNBbGlhc2VzLm5hbWVdKTsiLCJEaXNjbGFpbWVyQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkc2NlXCIsIFwiJHRpbWVvdXRcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIm5nZW9EaXNjbGFpbWVyXCIsIFwibmdlb0V2ZW50SGVscGVyXCIsIFwibmdlb0xheWVySGVscGVyXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4gfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sTGF5ZXJCYXNlIGZyb20gJ29sL2xheWVyL0Jhc2UuanMnO1xuaW1wb3J0IG9sTGF5ZXJHcm91cCBmcm9tICdvbC9sYXllci9Hcm91cC5qcyc7XG5pbXBvcnQgeyBEQVRBTEFZRVJHUk9VUF9OQU1FIH0gZnJvbSAnZ21mL2luZGV4LmpzJztcbmltcG9ydCBuZ2VvTWFwTGF5ZXJIZWxwZXIgZnJvbSAnbmdlby9tYXAvTGF5ZXJIZWxwZXIuanMnO1xuaW1wb3J0IHsgTWVzc2FnZVR5cGUgfSBmcm9tICduZ2VvL21lc3NhZ2UvTWVzc2FnZS5qcyc7XG5pbXBvcnQgbmdlb01lc3NhZ2VEaXNjbGFpbWVyIGZyb20gJ25nZW8vbWVzc2FnZS9EaXNjbGFpbWVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY0V2ZW50SGVscGVyIGZyb20gJ25nZW8vbWlzYy9FdmVudEhlbHBlci5qcyc7XG5pbXBvcnQgeyBDb2xsZWN0aW9uRXZlbnQgfSBmcm9tICdvbC9Db2xsZWN0aW9uLmpzJztcbmltcG9ydCAnYW5ndWxhci1zYW5pdGl6ZSc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZkRpc2NsYWltZXInLCBbJ25nU2FuaXRpemUnLCBuZ2VvTWFwTGF5ZXJIZWxwZXIubmFtZSwgbmdlb01lc3NhZ2VEaXNjbGFpbWVyLm5hbWUsIG5nZW9NaXNjRXZlbnRIZWxwZXIubmFtZV0pO1xuXG5mdW5jdGlvbiBEaXNjbGFpbWVyQ29udHJvbGxlcigkZWxlbWVudCwgJHNjZSwgJHRpbWVvdXQsIGdldHRleHRDYXRhbG9nLCBuZ2VvRGlzY2xhaW1lciwgbmdlb0V2ZW50SGVscGVyLCBuZ2VvTGF5ZXJIZWxwZXIpIHtcbiAgdGhpcy5tYXAgPSBudWxsO1xuICB0aGlzLmxheWVyVmlzaWJpbGl0eTtcbiAgdGhpcy5leHRlcm5hbDtcbiAgdGhpcy5wb3B1cDtcbiAgdGhpcy52aXNpYmlsaXR5ID0gZmFsc2U7XG4gIHRoaXMubXNnO1xuICB0aGlzLm1zZ3NfID0gW107XG4gIHRoaXMuc2NlXyA9ICRzY2U7XG4gIHRoaXMudGltZW91dF8gPSAkdGltZW91dDtcbiAgdGhpcy5nZXR0ZXh0Q2F0YWxvZ18gPSBnZXR0ZXh0Q2F0YWxvZztcbiAgdGhpcy5lbGVtZW50XyA9ICRlbGVtZW50O1xuICB0aGlzLmRpc2NsYWltZXJfID0gbmdlb0Rpc2NsYWltZXI7XG4gIHRoaXMuZXZlbnRIZWxwZXJfID0gbmdlb0V2ZW50SGVscGVyO1xuICB0aGlzLm5nZW9MYXllckhlbHBlcl8gPSBuZ2VvTGF5ZXJIZWxwZXI7XG4gIHRoaXMuZGF0YUxheWVyR3JvdXBfID0gbnVsbDtcbn1cblxuRGlzY2xhaW1lckNvbnRyb2xsZXIucHJvdG90eXBlLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5tYXApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gIH1cblxuICB0aGlzLmxheWVyVmlzaWJpbGl0eSA9IHRoaXMubGF5ZXJWaXNpYmlsaXR5ICE9PSB1bmRlZmluZWQgPyB0aGlzLmxheWVyVmlzaWJpbGl0eSA6IHRydWU7XG4gIHRoaXMuZGF0YUxheWVyR3JvdXBfID0gdGhpcy5uZ2VvTGF5ZXJIZWxwZXJfLmdldEdyb3VwRnJvbU1hcCh0aGlzLm1hcCwgREFUQUxBWUVSR1JPVVBfTkFNRSk7XG4gIHRoaXMucmVnaXN0ZXJMYXllcl8odGhpcy5kYXRhTGF5ZXJHcm91cF8pO1xufTtcblxuRGlzY2xhaW1lckNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZUxheWVyc0FkZF8gPSBmdW5jdGlvbiAoZXZ0KSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgIHRoaXMudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGxheWVyID0gZXZ0LmVsZW1lbnQ7XG5cbiAgICAgIGlmICghKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckJhc2UpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgbGF5ZXIgdHlwZScpO1xuICAgICAgfVxuXG4gICAgICBfdGhpcy5yZWdpc3RlckxheWVyXyhsYXllcik7XG4gICAgfSk7XG4gIH1cbn07XG5cbkRpc2NsYWltZXJDb250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVMYXllcnNSZW1vdmVfID0gZnVuY3Rpb24gKGV2dCkge1xuICBpZiAoZXZ0IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgdmFyIGxheWVyID0gZXZ0LmVsZW1lbnQ7XG5cbiAgICBpZiAoIShsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJCYXNlKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBsYXllciB0eXBlJyk7XG4gICAgfVxuXG4gICAgdGhpcy51bnJlZ2lzdGVyTGF5ZXJfKGxheWVyKTtcbiAgfVxufTtcblxuRGlzY2xhaW1lckNvbnRyb2xsZXIucHJvdG90eXBlLnJlZ2lzdGVyTGF5ZXJfID0gZnVuY3Rpb24gKGxheWVyKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIHZhciBsYXllclVpZCA9IG9sVXRpbEdldFVpZChsYXllcik7XG5cbiAgaWYgKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckdyb3VwKSB7XG4gICAgdGhpcy5ldmVudEhlbHBlcl8uYWRkTGlzdGVuZXJLZXkobGF5ZXJVaWQsIGxpc3RlbihsYXllci5nZXRMYXllcnMoKSwgJ2FkZCcsIHRoaXMuaGFuZGxlTGF5ZXJzQWRkXywgdGhpcykpO1xuICAgIHRoaXMuZXZlbnRIZWxwZXJfLmFkZExpc3RlbmVyS2V5KGxheWVyVWlkLCBsaXN0ZW4obGF5ZXIuZ2V0TGF5ZXJzKCksICdyZW1vdmUnLCB0aGlzLmhhbmRsZUxheWVyc1JlbW92ZV8sIHRoaXMpKTtcbiAgICBsYXllci5nZXRMYXllcnMoKS5mb3JFYWNoKGZ1bmN0aW9uIChsYXllcikge1xuICAgICAgX3RoaXMyLnJlZ2lzdGVyTGF5ZXJfKGxheWVyKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBpZiAodGhpcy5sYXllclZpc2liaWxpdHkpIHtcbiAgICAgIGlmIChsYXllci5nZXRWaXNpYmxlKCkpIHtcbiAgICAgICAgdGhpcy51cGRhdGVfKGxheWVyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY2xvc2VBbGxfKGxheWVyKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGxpc3RlbmVyS2V5ID0gbGlzdGVuKGxheWVyLCAnY2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmIChsYXllci5nZXRWaXNpYmxlKCkpIHtcbiAgICAgICAgICBfdGhpczIudXBkYXRlXyhsYXllcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMyLmNsb3NlQWxsXyhsYXllcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5ldmVudEhlbHBlcl8uYWRkTGlzdGVuZXJLZXkobGF5ZXJVaWQsIGxpc3RlbmVyS2V5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zaG93QWxsXyhsYXllcik7XG4gICAgfVxuICB9XG59O1xuXG5EaXNjbGFpbWVyQ29udHJvbGxlci5wcm90b3R5cGUudW5yZWdpc3RlckxheWVyXyA9IGZ1bmN0aW9uIChsYXllcikge1xuICB2YXIgX3RoaXMzID0gdGhpcztcblxuICB2YXIgbGF5ZXJVaWQgPSBvbFV0aWxHZXRVaWQobGF5ZXIpO1xuXG4gIGlmIChsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJHcm91cCkge1xuICAgIHRoaXMuZXZlbnRIZWxwZXJfLmNsZWFyTGlzdGVuZXJLZXkobGF5ZXJVaWQpO1xuICAgIGxheWVyLmdldExheWVycygpLmZvckVhY2goZnVuY3Rpb24gKGxheWVyKSB7XG4gICAgICByZXR1cm4gX3RoaXMzLnVucmVnaXN0ZXJMYXllcl8obGF5ZXIpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuY2xvc2VBbGxfKGxheWVyKTtcbiAgfVxufTtcblxuRGlzY2xhaW1lckNvbnRyb2xsZXIucHJvdG90eXBlLiRvbkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5kYXRhTGF5ZXJHcm91cF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGF0YUxheWVyR3JvdXAnKTtcbiAgfVxuXG4gIHRoaXMudW5yZWdpc3RlckxheWVyXyh0aGlzLmRhdGFMYXllckdyb3VwXyk7XG59O1xuXG5EaXNjbGFpbWVyQ29udHJvbGxlci5wcm90b3R5cGUuc2hvd0Rpc2NsYWltZXJNZXNzYWdlXyA9IGZ1bmN0aW9uIChsYXllclVpZCwgbXNnKSB7XG4gIG1zZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfLmdldFN0cmluZyhtc2cpO1xuXG4gIGlmICh0aGlzLmV4dGVybmFsKSB7XG4gICAgaWYgKCF0aGlzLm1zZ3NfLmluY2x1ZGVzKG1zZykpIHtcbiAgICAgIHRoaXMubXNnc18ucHVzaChtc2cpO1xuICAgIH1cblxuICAgIHRoaXMubXNnID0gXCJcIiArIHRoaXMuc2NlXy50cnVzdEFzSHRtbCh0aGlzLm1zZ3NfLmpvaW4oJzxiciAvPicpKTtcbiAgICB0aGlzLnZpc2liaWxpdHkgPSB0cnVlO1xuICB9IGVsc2Uge1xuICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgbXNnOiBtc2csXG4gICAgICBsYXllclVpZDogbGF5ZXJVaWQsXG4gICAgICB0YXJnZXQ6IHRoaXMuZWxlbWVudF8sXG4gICAgICB0eXBlOiBNZXNzYWdlVHlwZS5XQVJOSU5HXG4gICAgfTtcblxuICAgIGlmICh0aGlzLnBvcHVwKSB7XG4gICAgICBvcHRpb25zLnBvcHVwID0gdGhpcy5wb3B1cDtcbiAgICB9XG5cbiAgICB0aGlzLmRpc2NsYWltZXJfLmFsZXJ0KG9wdGlvbnMpO1xuICB9XG59O1xuXG5EaXNjbGFpbWVyQ29udHJvbGxlci5wcm90b3R5cGUuY2xvc2VBbGxfID0gZnVuY3Rpb24gKGxheWVyKSB7XG4gIHZhciBkaXNjbGFpbWVycyA9IGxheWVyLmdldCgnZGlzY2xhaW1lcnMnKTtcblxuICBpZiAoZGlzY2xhaW1lcnMpIHtcbiAgICB2YXIgbGF5ZXJVaWQgPSBvbFV0aWxHZXRVaWQobGF5ZXIpO1xuXG4gICAgZm9yICh2YXIga2V5IGluIGRpc2NsYWltZXJzKSB7XG4gICAgICB2YXIgdWlkID0gbGF5ZXJVaWQgKyBcIi1cIiArIGtleTtcbiAgICAgIHRoaXMuY2xvc2VEaXNjbGFpbWVyTWVzc2FnZV8odWlkLCBkaXNjbGFpbWVyc1trZXldKTtcbiAgICB9XG4gIH1cbn07XG5cbkRpc2NsYWltZXJDb250cm9sbGVyLnByb3RvdHlwZS5zaG93QWxsXyA9IGZ1bmN0aW9uIChsYXllcikge1xuICB2YXIgZGlzY2xhaW1lcnMgPSBsYXllci5nZXQoJ2Rpc2NsYWltZXJzJyk7XG5cbiAgaWYgKGRpc2NsYWltZXJzKSB7XG4gICAgdmFyIGxheWVyVWlkID0gb2xVdGlsR2V0VWlkKGxheWVyKTtcblxuICAgIGZvciAodmFyIGtleSBpbiBkaXNjbGFpbWVycykge1xuICAgICAgdmFyIHVpZCA9IGxheWVyVWlkICsgXCItXCIgKyBrZXk7XG4gICAgICB0aGlzLnNob3dEaXNjbGFpbWVyTWVzc2FnZV8odWlkLCBkaXNjbGFpbWVyc1trZXldKTtcbiAgICB9XG4gIH1cbn07XG5cbkRpc2NsYWltZXJDb250cm9sbGVyLnByb3RvdHlwZS51cGRhdGVfID0gZnVuY3Rpb24gKGxheWVyKSB7XG4gIHZhciBkaXNjbGFpbWVycyA9IGxheWVyLmdldCgnZGlzY2xhaW1lcnMnKTtcblxuICBpZiAoZGlzY2xhaW1lcnMpIHtcbiAgICBpZiAoJ2FsbCcgaW4gZGlzY2xhaW1lcnMpIHtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KE9iamVjdC5rZXlzKGRpc2NsYWltZXJzKS5sZW5ndGggPT09IDEpO1xuICAgICAgdGhpcy5zaG93QWxsXyhsYXllcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBsYXllcldNUyA9IGxheWVyO1xuICAgICAgdmFyIHNvdXJjZVdNUyA9IGxheWVyV01TLmdldFNvdXJjZSgpO1xuXG4gICAgICBpZiAoc291cmNlV01TLmdldFBhcmFtcykge1xuICAgICAgICB2YXIgbGF5ZXJzID0gc291cmNlV01TLmdldFBhcmFtcygpWydMQVlFUlMnXTtcbiAgICAgICAgdmFyIGxheWVyVWlkID0gb2xVdGlsR2V0VWlkKGxheWVyKTtcblxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGlzY2xhaW1lcnMpIHtcbiAgICAgICAgICB2YXIgdWlkID0gbGF5ZXJVaWQgKyBcIi1cIiArIGtleTtcblxuICAgICAgICAgIGlmIChsYXllcnMuaW5kZXhPZihrZXkpICE9PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5zaG93RGlzY2xhaW1lck1lc3NhZ2VfKHVpZCwgZGlzY2xhaW1lcnNba2V5XSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VEaXNjbGFpbWVyTWVzc2FnZV8odWlkLCBkaXNjbGFpbWVyc1trZXldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbkRpc2NsYWltZXJDb250cm9sbGVyLnByb3RvdHlwZS5jbG9zZURpc2NsYWltZXJNZXNzYWdlXyA9IGZ1bmN0aW9uIChsYXllclVpZCwgbXNnKSB7XG4gIG1zZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfLmdldFN0cmluZyhtc2cpO1xuXG4gIGlmICh0aGlzLmV4dGVybmFsKSB7XG4gICAgdGhpcy52aXNpYmlsaXR5ID0gZmFsc2U7XG4gICAgdGhpcy5tc2dzXy5sZW5ndGggPSAwO1xuICAgIHRoaXMubXNnID0gJyc7XG4gIH0gZWxzZSB7XG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICBtc2c6IG1zZyxcbiAgICAgIGxheWVyVWlkOiBsYXllclVpZCxcbiAgICAgIHRhcmdldDogdGhpcy5lbGVtZW50XyxcbiAgICAgIHR5cGU6IE1lc3NhZ2VUeXBlLldBUk5JTkdcbiAgICB9O1xuXG4gICAgaWYgKHRoaXMucG9wdXApIHtcbiAgICAgIG9wdGlvbnMucG9wdXAgPSB0aGlzLnBvcHVwO1xuICAgIH1cblxuICAgIHRoaXMuZGlzY2xhaW1lcl8uY2xvc2Uob3B0aW9ucyk7XG4gIH1cbn07XG5cbnZhciBkaXNjbGFpbWVyQ29tcG9uZW50ID0ge1xuICBjb250cm9sbGVyOiBEaXNjbGFpbWVyQ29udHJvbGxlcixcbiAgYmluZGluZ3M6IHtcbiAgICAnbGF5ZXJWaXNpYmlsaXR5JzogJzw/Z21mRGlzY2xhaW1lckxheWVyVmlzaWJpbGl0eScsXG4gICAgJ3BvcHVwJzogJzw/Z21mRGlzY2xhaW1lclBvcHVwJyxcbiAgICAnbWFwJzogJz1nbWZEaXNjbGFpbWVyTWFwJyxcbiAgICAnZXh0ZXJuYWwnOiAnPD9nbWZEaXNjbGFpbWVyRXh0ZXJuYWwnLFxuICAgICd2aXNpYmlsaXR5JzogJz0/Z21mRGlzY2xhaW1lckV4dGVybmFsVmlzaWJpbGl0eScsXG4gICAgJ21zZyc6ICc9P2dtZkRpc2NsYWltZXJFeHRlcm5hbE1zZydcbiAgfVxufTtcbm1vZHVsZS5jb21wb25lbnQoJ2dtZkRpc2NsYWltZXInLCBkaXNjbGFpbWVyQ29tcG9uZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaikge1xub2JqIHx8IChvYmogPSB7fSk7XG52YXIgX190LCBfX3AgPSAnJztcbndpdGggKG9iaikge1xuX19wICs9ICc8bmdlby1kcmF3ZmVhdHVyZVxcbiAgICBuZ2VvLWJ0bi1ncm91cFxcbiAgICBjbGFzcz1cImJ0bi1ncm91cFwiXFxuICAgIG5nZW8tZHJhd2ZlYXR1cmUtYWN0aXZlPVwiZWZDdHJsLmRyYXdBY3RpdmVcIlxcbiAgICBuZ2VvLWRyYXdmZWF0dXJlLW1hcD1cImVmQ3RybC5tYXBcIlxcbiAgICBuZ2VvLWRyYXdmZWF0dXJlLXNob3dtZWFzdXJlPVwiZWZDdHJsLnNob3dNZWFzdXJlXCI+XFxuICA8YVxcbiAgICBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIlxcbiAgICB0aXRsZT1cInt7XFwnRHJhdyBhIHBvaW50IG9uIHRoZSBtYXBcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgIGhyZWZcXG4gICAgbmdlby1idG5cXG4gICAgbmdlby1kcmF3cG9pbnRcXG4gICAgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgbmdlby1kcmF3ZmVhdHVyZS1wb2ludFwiXFxuICAgIG5nLWNsYXNzPVwie2FjdGl2ZTogZGZDdHJsLmRyYXdQb2ludC5hY3RpdmV9XCJcXG4gICAgbmctbW9kZWw9XCJkZkN0cmwuZHJhd1BvaW50LmFjdGl2ZVwiPlxcbiAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9wb2ludC5zdmc/dmlld2JveCZoZWlnaHQ9MWVtJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbidcXG4gIDwvYT5cXG4gIDxhXFxuICAgIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXFxuICAgIHRpdGxlPVwie3tcXCdEcmF3IGEgbGluZSBvbiB0aGUgbWFwXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICBocmVmXFxuICAgIG5nZW8tYnRuXFxuICAgIG5nZW8tbWVhc3VyZWxlbmd0aFxcbiAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBuZ2VvLWRyYXdmZWF0dXJlLWxpbmVzdHJpbmdcIlxcbiAgICBuZy1jbGFzcz1cInthY3RpdmU6IGRmQ3RybC5tZWFzdXJlTGVuZ3RoLmFjdGl2ZX1cIlxcbiAgICBuZy1tb2RlbD1cImRmQ3RybC5tZWFzdXJlTGVuZ3RoLmFjdGl2ZVwiPlxcbiAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9saW5lLnN2Zz92aWV3Ym94JmhlaWdodD0xZW0nKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgPC9hPlxcbiAgPGFcXG4gICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgdGl0bGU9XCJ7e1xcJ0RyYXcgYSBwb2x5Z29uIG9uIHRoZSBtYXBcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgIGhyZWZcXG4gICAgbmdlby1idG5cXG4gICAgbmdlby1tZWFzdXJlYXJlYVxcbiAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBuZ2VvLWRyYXdmZWF0dXJlLXBvbHlnb25cIlxcbiAgICBuZy1jbGFzcz1cInthY3RpdmU6IGRmQ3RybC5tZWFzdXJlQXJlYS5hY3RpdmV9XCJcXG4gICAgbmctbW9kZWw9XCJkZkN0cmwubWVhc3VyZUFyZWEuYWN0aXZlXCI+XFxuICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL3BvbHlnb24uc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICA8L2E+XFxuICA8YVxcbiAgICBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIlxcbiAgICB0aXRsZT1cInt7XFwnRHJhdyBhIGNpcmNsZSBvbiB0aGUgbWFwXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICBocmVmXFxuICAgIG5nZW8tYnRuXFxuICAgIG5nZW8tbWVhc3VyZWF6aW11dFxcbiAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBuZ2VvLWRyYXdmZWF0dXJlLWNpcmNsZVwiXFxuICAgIG5nLWNsYXNzPVwie2FjdGl2ZTogZGZDdHJsLm1lYXN1cmVBemltdXQuYWN0aXZlfVwiXFxuICAgIG5nLW1vZGVsPVwiZGZDdHJsLm1lYXN1cmVBemltdXQuYWN0aXZlXCI+XFxuICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL2NpcmNsZS5zdmc/dmlld2JveCZoZWlnaHQ9MWVtJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbidcXG4gIDwvYT5cXG4gIDxhXFxuICAgIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXFxuICAgIHRpdGxlPVwie3tcXCdEcmF3IGEgcmVjdGFuZ2xlIG9uIHRoZSBtYXBcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgIGhyZWZcXG4gICAgbmdlby1idG5cXG4gICAgbmdlby1kcmF3cmVjdGFuZ2xlXFxuICAgIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IG5nZW8tZHJhd2ZlYXR1cmUtcmVjdGFuZ2xlXCJcXG4gICAgbmctY2xhc3M9XCJ7YWN0aXZlOiBkZkN0cmwuZHJhd1JlY3RhbmdsZS5hY3RpdmV9XCJcXG4gICAgbmctbW9kZWw9XCJkZkN0cmwuZHJhd1JlY3RhbmdsZS5hY3RpdmVcIj5cXG4gICAgJyArXG4oKF9fdCA9IChyZXF1aXJlKCdnbWYvaWNvbnMvcmVjdGFuZ2xlLnN2Zz92aWV3Ym94JmhlaWdodD0xZW0nKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgPC9hPlxcbiAgPGFcXG4gICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgdGl0bGU9XCJ7e1xcJ0RyYXcgYSB0ZXh0IGxhYmVsIG9uIHRoZSBtYXBcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgIGhyZWZcXG4gICAgbmdlby1idG5cXG4gICAgbmdlby1kcmF3dGV4dFxcbiAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBuZ2VvLWRyYXdmZWF0dXJlLXRleHRcIlxcbiAgICBuZy1jbGFzcz1cInthY3RpdmU6IGRmQ3RybC5kcmF3VGV4dC5hY3RpdmV9XCJcXG4gICAgbmctbW9kZWw9XCJkZkN0cmwuZHJhd1RleHQuYWN0aXZlXCI+XFxuICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL3RleHQuc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICA8L2E+XFxuPC9uZ2VvLWRyYXdmZWF0dXJlPlxcblxcbjxkaXYgbmctc3dpdGNoPVwiZWZDdHJsLnNlbGVjdGVkRmVhdHVyZVwiPlxcblxcbiAgPGhyIGNsYXNzPVwiZ21mLWRyYXdmZWF0dXJlLXNlcGFyYXRvclwiIG5nLXNob3c9XCJlZkN0cmwuZ2V0RmVhdHVyZXNBcnJheSgpLmxlbmd0aCA+IDBcIj5cXG4gIDxkaXYgbmctc3dpdGNoLXdoZW49XCJudWxsXCI+XFxuICAgIDxkaXYgbmctc2hvdz1cImVmQ3RybC5nZXRGZWF0dXJlc0FycmF5KCkubGVuZ3RoID4gMFwiPlxcbiAgICAgIDxkaXYgY2xhc3M9XCJuZ2VvLWRyYXdmZWF0dXJlLWFjdGlvbmJ1dHRvbnNcIj5cXG4gICAgICAgIDxidXR0b25cXG4gICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgICBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJcXG4gICAgICAgICAgICBhcmlhLWhhc3BvcHVwPVwidHJ1ZVwiXFxuICAgICAgICAgICAgYXJpYS1leHBhbmRlZD1cImZhbHNlXCJcXG4gICAgICAgICAgICBuZ2VvLWV4cG9ydGZlYXR1cmVzXFxuICAgICAgICAgICAgbmdlby1leHBvcnRmZWF0dXJlcy1mZWF0dXJlcz1cImVmQ3RybC5mZWF0dXJlc1wiXFxuICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLWxpbmsgYnRuLXNtIGRyb3Bkb3duLXRvZ2dsZVwiPlxcbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLWZpbGUtZXhwb3J0XCI+PC9zcGFuPlxcbiAgICAgICAgICB7e1xcJ0V4cG9ydFxcJyB8IHRyYW5zbGF0ZX19XFxuICAgICAgICA8L2J1dHRvbj5cXG4gICAgICAgIDxidXR0b25cXG4gICAgICAgICAgICBuZy1jbGljaz1cImVmQ3RybC5jbGVhckZlYXR1cmVzKClcIlxcbiAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1saW5rIGJ0bi1zbVwiPlxcbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLXRyYXNoXCI+PC9zcGFuPlxcbiAgICAgICAgICB7e1xcJ0RlbGV0ZSBBbGxcXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgICAgPC9idXR0b24+XFxuICAgICAgPC9kaXY+XFxuXFxuICAgICAgPGRpdiBjbGFzcz1cImdtZi1lb2xcIj48L2Rpdj5cXG5cXG4gICAgICA8ZGl2IGNsYXNzPVwiZ21mLWRyYXdmZWF0dXJlLWZlYXR1cmVsaXN0IGxpc3QtZ3JvdXAgbGlzdC1ncm91cC1zbVwiPlxcbiAgICAgICAgPGJ1dHRvblxcbiAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtXCJcXG4gICAgICAgICAgICBuZy1yZXBlYXQ9XCJmZWF0dXJlIGluIGVmQ3RybC5nZXRGZWF0dXJlc0FycmF5KClcIlxcbiAgICAgICAgICAgIG5nLWNsaWNrPVwiZWZDdHJsLnNlbGVjdEZlYXR1cmVGcm9tTGlzdChmZWF0dXJlKTtcIj5cXG4gICAgICAgICAge3sgZmVhdHVyZS5nZXQoZWZDdHJsLm5hbWVQcm9wZXJ0eSkgfX1cXG4gICAgICAgIDwvYnV0dG9uPlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG5cXG4gIDwvZGl2PlxcblxcbiAgPGRpdiBuZy1zd2l0Y2gtZGVmYXVsdD5cXG5cXG4gICAgPGJ1dHRvblxcbiAgICAgICAgbmctY2xpY2s9XCJlZkN0cmwuc2VsZWN0ZWRGZWF0dXJlID0gbnVsbDtcIlxcbiAgICAgICAgY2xhc3M9XCJidG4gYnRuLWxpbmsgYnRuLXNtXCI+XFxuICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS1hcnJvdy1sZWZ0XCI+PC9zcGFuPlxcbiAgICAgIHt7XFwnTGlzdFxcJyB8IHRyYW5zbGF0ZX19XFxuICAgIDwvYnV0dG9uPlxcbiAgICA8ZGl2IGNsYXNzPVwibmdlby1kcmF3ZmVhdHVyZS1hY3Rpb25idXR0b25zXCI+XFxuICAgICAgPGJ1dHRvblxcbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiXFxuICAgICAgICAgIGFyaWEtaGFzcG9wdXA9XCJ0cnVlXCJcXG4gICAgICAgICAgYXJpYS1leHBhbmRlZD1cImZhbHNlXCJcXG4gICAgICAgICAgbmdlby1leHBvcnRmZWF0dXJlc1xcbiAgICAgICAgICBuZ2VvLWV4cG9ydGZlYXR1cmVzLWZlYXR1cmVzPVwiZWZDdHJsLnNlbGVjdGVkRmVhdHVyZXNcIlxcbiAgICAgICAgICBjbGFzcz1cImJ0biBidG4tbGluayBidG4tc20gZHJvcGRvd24tdG9nZ2xlXCI+XFxuICAgICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLWZpbGUtZXhwb3J0XCI+PC9zcGFuPlxcbiAgICAgICAge3tcXCdFeHBvcnRcXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgIDwvYnV0dG9uPlxcbiAgICAgIDxidXR0b25cXG4gICAgICAgICAgbmctY2xpY2s9XCJlZkN0cmwucmVtb3ZlRmVhdHVyZShlZkN0cmwuc2VsZWN0ZWRGZWF0dXJlKTtcIlxcbiAgICAgICAgICBjbGFzcz1cImJ0biBidG4tbGluayBidG4tc21cIj5cXG4gICAgICAgIDxzcGFuIGNsYXNzPVwiZmEgZmEtdHJhc2hcIj48L3NwYW4+XFxuICAgICAgICB7e1xcJ0RlbGV0ZVxcJyB8IHRyYW5zbGF0ZX19XFxuICAgICAgPC9idXR0b24+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8ZGl2IGNsYXNzPVwiZ21mLWVvbFwiPjwvZGl2PlxcblxcbiAgICA8Z21mLWZlYXR1cmVzdHlsZVxcbiAgICAgIGdtZi1mZWF0dXJlc3R5bGUtZmVhdHVyZT1cImVmQ3RybC5zZWxlY3RlZEZlYXR1cmVcIj5cXG4gICAgPC9nbWYtZmVhdHVyZXN0eWxlPlxcbiAgPC9kaXY+XFxuXFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsIkNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwiZ2V0dGV4dENhdGFsb2dcIiwgXCJuZ2VvRmVhdHVyZUhlbHBlclwiLCBcIm5nZW9GZWF0dXJlc1wiLCBcIm5nZW9Ub29sQWN0aXZhdGVNZ3JcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZEcmF3aW5nRmVhdHVyZVN0eWxlQ29tcG9uZW50IGZyb20gJ2dtZi9kcmF3aW5nL2ZlYXR1cmVTdHlsZUNvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb0dlb21ldHJ5VHlwZSBmcm9tICduZ2VvL0dlb21ldHJ5VHlwZS5qcyc7XG5pbXBvcnQgbmdlb01lbnUgZnJvbSAnbmdlby9NZW51LmpzJztcbmltcG9ydCBuZ2VvRWRpdGluZ0V4cG9ydGZlYXR1cmVzQ29tcG9uZW50IGZyb20gJ25nZW8vZWRpdGluZy9leHBvcnRmZWF0dXJlc0NvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb01pc2NCdG5Db21wb25lbnQgZnJvbSAnbmdlby9taXNjL2J0bkNvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb0RyYXdDb21wb25lbnQgZnJvbSAnbmdlby9kcmF3L2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzIGZyb20gJ25nZW8vZm9ybWF0L0ZlYXR1cmVQcm9wZXJ0aWVzLmpzJztcbmltcG9ydCBuZ2VvSW50ZXJhY3Rpb25Nb2RpZnkgZnJvbSAnbmdlby9pbnRlcmFjdGlvbi9Nb2RpZnkuanMnO1xuaW1wb3J0IG5nZW9JbnRlcmFjdGlvblJvdGF0ZSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL1JvdGF0ZS5qcyc7XG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uVHJhbnNsYXRlIGZyb20gJ25nZW8vaW50ZXJhY3Rpb24vVHJhbnNsYXRlLmpzJztcbmltcG9ydCB7IGludGVyYWN0aW9uRGVjb3JhdGlvbiBhcyBuZ2VvTWlzY0RlY29yYXRlSW50ZXJhY3Rpb24gfSBmcm9tICduZ2VvL21pc2MvZGVjb3JhdGUuanMnO1xuaW1wb3J0IG5nZW9NaXNjRmVhdHVyZUhlbHBlciBmcm9tICduZ2VvL21pc2MvRmVhdHVyZUhlbHBlci5qcyc7XG5pbXBvcnQgbmdlb01pc2NUb29sQWN0aXZhdGUgZnJvbSAnbmdlby9taXNjL1Rvb2xBY3RpdmF0ZS5qcyc7XG5pbXBvcnQgbmdlb01pc2NUb29sQWN0aXZhdGVNZ3IgZnJvbSAnbmdlby9taXNjL1Rvb2xBY3RpdmF0ZU1nci5qcyc7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4sIHVubGlzdGVuQnlLZXkgfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sQ29sbGVjdGlvbiBmcm9tICdvbC9Db2xsZWN0aW9uLmpzJztcbmltcG9ydCBvbFN0eWxlRmlsbCBmcm9tICdvbC9zdHlsZS9GaWxsLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xuaW1wb3J0IG9sU3R5bGVUZXh0IGZyb20gJ29sL3N0eWxlL1RleHQuanMnO1xuaW1wb3J0IHsgQ29sbGVjdGlvbkV2ZW50IH0gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgTWFwQnJvd3NlckV2ZW50IGZyb20gJ29sL01hcEJyb3dzZXJFdmVudC5qcyc7XG5pbXBvcnQgRmVhdHVyZSBmcm9tICdvbC9GZWF0dXJlLmpzJztcbmltcG9ydCAnYm9vdHN0cmFwL2pzL3NyYy9kcm9wZG93bi5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0dtZkRyYXdGZWF0dXJlQ29tcG9uZW50JywgW2dtZkRyYXdpbmdGZWF0dXJlU3R5bGVDb21wb25lbnQubmFtZSwgbmdlb0VkaXRpbmdFeHBvcnRmZWF0dXJlc0NvbXBvbmVudC5uYW1lLCBuZ2VvTWlzY0J0bkNvbXBvbmVudC5uYW1lLCBuZ2VvRHJhd0NvbXBvbmVudC5uYW1lLCBuZ2VvTWlzY0ZlYXR1cmVIZWxwZXIubmFtZSwgbmdlb01pc2NUb29sQWN0aXZhdGVNZ3IubmFtZV0pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdnbWYvZHJhd2luZy9kcmF3RmVhdHVyZUNvbXBvbmVudCcsIHJlcXVpcmUoJy4vZHJhd0ZlYXR1cmVDb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcblxuZnVuY3Rpb24gZHJhd2luZkRyYXdGZWF0dXJlQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIGNvbnRyb2xsZXI6ICdHbWZEcmF3ZmVhdHVyZUNvbnRyb2xsZXIgYXMgZWZDdHJsJyxcbiAgICBzY29wZToge1xuICAgICAgJ2FjdGl2ZSc6ICc9Z21mRHJhd2ZlYXR1cmVBY3RpdmUnLFxuICAgICAgJ21hcCc6ICc8Z21mRHJhd2ZlYXR1cmVNYXAnLFxuICAgICAgJ3Nob3dNZWFzdXJlJzogJz0/Z21mRHJhd2ZlYXR1cmVTaG93bWVhc3VyZSdcbiAgICB9LFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgdGVtcGxhdGVVcmw6ICdnbWYvZHJhd2luZy9kcmF3RmVhdHVyZUNvbXBvbmVudCdcbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnZ21mRHJhd2ZlYXR1cmUnLCBkcmF3aW5mRHJhd0ZlYXR1cmVDb21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKCRzY29wZSwgJHRpbWVvdXQsIGdldHRleHRDYXRhbG9nLCBuZ2VvRmVhdHVyZUhlbHBlciwgbmdlb0ZlYXR1cmVzLCBuZ2VvVG9vbEFjdGl2YXRlTWdyKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgdGhpcy5tYXAgPSBudWxsO1xuICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLmRyYXdBY3RpdmUgPSBmYWxzZTtcbiAgdGhpcy5kcmF3VG9vbEFjdGl2YXRlID0gbmV3IG5nZW9NaXNjVG9vbEFjdGl2YXRlKHRoaXMsICdkcmF3QWN0aXZlJyk7XG4gIHRoaXMubWFwU2VsZWN0QWN0aXZlID0gdHJ1ZTtcbiAgdGhpcy5sb25nUHJlc3NUaW1lb3V0XyA9IG51bGw7XG4gIHRoaXMubWFwU2VsZWN0VG9vbEFjdGl2YXRlID0gbmV3IG5nZW9NaXNjVG9vbEFjdGl2YXRlKHRoaXMsICdtYXBTZWxlY3RBY3RpdmUnKTtcbiAgdGhpcy5zY29wZV8gPSAkc2NvcGU7XG4gIHRoaXMudGltZW91dF8gPSAkdGltZW91dDtcbiAgdGhpcy5mZWF0dXJlSGVscGVyXyA9IG5nZW9GZWF0dXJlSGVscGVyO1xuICB0aGlzLmZlYXR1cmVzID0gbmdlb0ZlYXR1cmVzO1xuICB0aGlzLm5nZW9Ub29sQWN0aXZhdGVNZ3JfID0gbmdlb1Rvb2xBY3RpdmF0ZU1ncjtcbiAgdGhpcy5zZWxlY3RlZEZlYXR1cmUgPSBudWxsO1xuICB0aGlzLnNlbGVjdGVkRmVhdHVyZXMgPSBuZXcgb2xDb2xsZWN0aW9uKCk7XG4gIHRoaXMuaW50ZXJhY3Rpb25zXyA9IG5ldyBvbENvbGxlY3Rpb24oKTtcbiAgdGhpcy5tb2RpZnlfID0gbmV3IG5nZW9JbnRlcmFjdGlvbk1vZGlmeSh7XG4gICAgZmVhdHVyZXM6IHRoaXMuc2VsZWN0ZWRGZWF0dXJlcyxcbiAgICBzdHlsZTogbmdlb0ZlYXR1cmVIZWxwZXIuZ2V0VmVydGV4U3R5bGUoZmFsc2UpXG4gIH0pO1xuICB0aGlzLmludGVyYWN0aW9uc18ucHVzaCh0aGlzLm1vZGlmeV8pO1xuICB0aGlzLm1lbnVfID0gbnVsbDtcbiAgdGhpcy5tZW51TGlzdGVuZXJLZXlfID0gbnVsbDtcbiAgdGhpcy5tb2RpZnlUb29sQWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUodGhpcy5tb2RpZnlfLCAnYWN0aXZlJyk7XG4gIHRoaXMudHJhbnNsYXRlXyA9IG5ldyBuZ2VvSW50ZXJhY3Rpb25UcmFuc2xhdGUoe1xuICAgIGZlYXR1cmVzOiB0aGlzLnNlbGVjdGVkRmVhdHVyZXMsXG4gICAgc3R5bGU6IG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgdGV4dDogbmV3IG9sU3R5bGVUZXh0KHtcbiAgICAgICAgdGV4dDogXCJcXHVGMEIyXCIsXG4gICAgICAgIGZvbnQ6ICc5MDAgMThweCBcIkZvbnQgQXdlc29tZSA1IEZyZWVcIicsXG4gICAgICAgIGZpbGw6IG5ldyBvbFN0eWxlRmlsbCh7XG4gICAgICAgICAgY29sb3I6ICcjN2E3YTdhJ1xuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9KVxuICB9KTtcbiAgdGhpcy5pbnRlcmFjdGlvbnNfLnB1c2godGhpcy50cmFuc2xhdGVfKTtcbiAgdGhpcy5yb3RhdGVfID0gbmV3IG5nZW9JbnRlcmFjdGlvblJvdGF0ZSh7XG4gICAgZmVhdHVyZXM6IHRoaXMuc2VsZWN0ZWRGZWF0dXJlcyxcbiAgICBzdHlsZTogbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICB0ZXh0OiBuZXcgb2xTdHlsZVRleHQoe1xuICAgICAgICB0ZXh0OiBcIlxcdUYwMUVcIixcbiAgICAgICAgZm9udDogJzkwMCAxOHB4IFwiRm9udCBBd2Vzb21lIDUgRnJlZVwiJyxcbiAgICAgICAgZmlsbDogbmV3IG9sU3R5bGVGaWxsKHtcbiAgICAgICAgICBjb2xvcjogJyM3YTdhN2EnXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH0pO1xuICB0aGlzLmludGVyYWN0aW9uc18ucHVzaCh0aGlzLnJvdGF0ZV8pO1xuICB0aGlzLmluaXRpYWxpemVJbnRlcmFjdGlvbnNfKCk7XG4gIHRoaXMucm90YXRlVG9vbEFjdGl2YXRlID0gbmV3IG5nZW9NaXNjVG9vbEFjdGl2YXRlKHRoaXMucm90YXRlXywgJ2FjdGl2ZScpO1xuICB0aGlzLnRyYW5zbGF0ZVRvb2xBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSh0aGlzLnRyYW5zbGF0ZV8sICdhY3RpdmUnKTtcbiAgdGhpcy5saXN0ZW5lcktleXNfID0gW107XG4gIHRoaXMubWFwTGlzdGVuZXJLZXlzXyA9IFtdO1xuICB0aGlzLmxpc3RTZWxlY3Rpb25JblByb2dyZXNzXyA9IGZhbHNlO1xuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuYWN0aXZlO1xuICB9LCB0aGlzLmhhbmRsZUFjdGl2ZUNoYW5nZV8uYmluZCh0aGlzKSk7XG4gICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5kcmF3QWN0aXZlO1xuICB9LCBmdW5jdGlvbiAoYWN0aXZlKSB7XG4gICAgaWYgKGFjdGl2ZSkge1xuICAgICAgX3RoaXMuc2VsZWN0ZWRGZWF0dXJlID0gbnVsbDtcbiAgICB9XG4gIH0pO1xuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuc2VsZWN0ZWRGZWF0dXJlO1xuICB9LCBmdW5jdGlvbiAobmV3RmVhdHVyZSwgcHJldmlvdXNGZWF0dXJlKSB7XG4gICAgaWYgKCFfdGhpcy5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICBfdGhpcy5zZWxlY3RlZEZlYXR1cmVzLmNsZWFyKCk7XG5cbiAgICBpZiAocHJldmlvdXNGZWF0dXJlKSB7XG4gICAgICBfdGhpcy5mZWF0dXJlSGVscGVyXy5zZXRTdHlsZShwcmV2aW91c0ZlYXR1cmUpO1xuXG4gICAgICBfdGhpcy51bnJlZ2lzdGVySW50ZXJhY3Rpb25zXygpO1xuICAgIH1cblxuICAgIGlmIChuZXdGZWF0dXJlKSB7XG4gICAgICBfdGhpcy5mZWF0dXJlSGVscGVyXy5zZXRTdHlsZShuZXdGZWF0dXJlLCB0cnVlKTtcblxuICAgICAgX3RoaXMuc2VsZWN0ZWRGZWF0dXJlcy5wdXNoKG5ld0ZlYXR1cmUpO1xuXG4gICAgICBfdGhpcy5yZWdpc3RlckludGVyYWN0aW9uc18oKTtcblxuICAgICAgaWYgKF90aGlzLmxpc3RTZWxlY3Rpb25JblByb2dyZXNzXykge1xuICAgICAgICBfdGhpcy5mZWF0dXJlSGVscGVyXy5maXRNYXBUb0ZlYXR1cmUobmV3RmVhdHVyZSwgX3RoaXMubWFwKTtcblxuICAgICAgICBfdGhpcy5saXN0U2VsZWN0aW9uSW5Qcm9ncmVzc18gPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgX3RoaXMuY2xvc2VNZW51XygpO1xuICAgIH1cbiAgfSk7XG4gICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5tYXBTZWxlY3RBY3RpdmU7XG4gIH0sIHRoaXMuaGFuZGxlTWFwU2VsZWN0QWN0aXZlQ2hhbmdlXy5iaW5kKHRoaXMpKTtcbiAgdGhpcy5uYW1lUHJvcGVydHkgPSBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuTkFNRTtcbiAgdGhpcy5nZXR0ZXh0Q2F0YWxvZ18gPSBnZXR0ZXh0Q2F0YWxvZztcbn1cblxuQ29udHJvbGxlci5wcm90b3R5cGUuY2xvc2VNZW51XyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMubWVudV8pIHtcbiAgICBpZiAoIXRoaXMubWFwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm1lbnVMaXN0ZW5lcktleV8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtZW51TGlzdGVuZXJLZXknKTtcbiAgICB9XG5cbiAgICB0aGlzLm1hcC5yZW1vdmVPdmVybGF5KHRoaXMubWVudV8pO1xuICAgIHRoaXMubWVudV8gPSBudWxsO1xuICAgIHVubGlzdGVuQnlLZXkodGhpcy5tZW51TGlzdGVuZXJLZXlfKTtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaW5pdGlhbGl6ZUludGVyYWN0aW9uc18gPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuaW50ZXJhY3Rpb25zXy5mb3JFYWNoKGZ1bmN0aW9uIChpbnRlcmFjdGlvbikge1xuICAgIGludGVyYWN0aW9uLnNldEFjdGl2ZShmYWxzZSk7XG4gICAgbmdlb01pc2NEZWNvcmF0ZUludGVyYWN0aW9uKGludGVyYWN0aW9uKTtcbiAgfSk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5yZWdpc3RlckludGVyYWN0aW9uc18gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIHRoaXMuaW50ZXJhY3Rpb25zXy5mb3JFYWNoKGZ1bmN0aW9uIChpbnRlcmFjdGlvbikge1xuICAgIGlmICghX3RoaXMyLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIF90aGlzMi5tYXAuYWRkSW50ZXJhY3Rpb24oaW50ZXJhY3Rpb24pO1xuICB9KTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnVucmVnaXN0ZXJJbnRlcmFjdGlvbnNfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMzID0gdGhpcztcblxuICB0aGlzLmludGVyYWN0aW9uc18uZm9yRWFjaChmdW5jdGlvbiAoaW50ZXJhY3Rpb24pIHtcbiAgICBpZiAoIV90aGlzMy5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICBfdGhpczMubWFwLnJlbW92ZUludGVyYWN0aW9uKGludGVyYWN0aW9uKTtcbiAgfSk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVBY3RpdmVDaGFuZ2VfID0gZnVuY3Rpb24gKGFjdGl2ZSkge1xuICB2YXIga2V5cyA9IHRoaXMubGlzdGVuZXJLZXlzXztcbiAgdmFyIGRyYXdVaWQgPSBbJ2RyYXctJywgb2xVdGlsR2V0VWlkKHRoaXMpXS5qb2luKCctJyk7XG4gIHZhciBvdGhlclVpZCA9IFsnb3RoZXItJywgb2xVdGlsR2V0VWlkKHRoaXMpXS5qb2luKCctJyk7XG4gIHZhciB0b29sTWdyID0gdGhpcy5uZ2VvVG9vbEFjdGl2YXRlTWdyXztcblxuICBpZiAoYWN0aXZlKSB7XG4gICAga2V5cy5wdXNoKGxpc3Rlbih0aGlzLmZlYXR1cmVzLCAnYWRkJywgdGhpcy5oYW5kbGVGZWF0dXJlc0FkZF8sIHRoaXMpKTtcbiAgICBrZXlzLnB1c2gobGlzdGVuKHRoaXMuZmVhdHVyZXMsICdyZW1vdmUnLCB0aGlzLmhhbmRsZUZlYXR1cmVzUmVtb3ZlXywgdGhpcykpO1xuICAgIGtleXMucHVzaChsaXN0ZW4odGhpcy50cmFuc2xhdGVfLCAndHJhbnNsYXRlZW5kJywgdGhpcy5oYW5kbGVUcmFuc2xhdGVFbmRfLCB0aGlzKSk7XG4gICAga2V5cy5wdXNoKGxpc3Rlbih0aGlzLnJvdGF0ZV8sICdyb3RhdGVlbmQnLCB0aGlzLmhhbmRsZVJvdGF0ZUVuZF8sIHRoaXMpKTtcbiAgICB0b29sTWdyLnJlZ2lzdGVyVG9vbChkcmF3VWlkLCB0aGlzLmRyYXdUb29sQWN0aXZhdGUsIGZhbHNlKTtcbiAgICB0b29sTWdyLnJlZ2lzdGVyVG9vbChkcmF3VWlkLCB0aGlzLm1hcFNlbGVjdFRvb2xBY3RpdmF0ZSwgdHJ1ZSk7XG4gICAgdG9vbE1nci5yZWdpc3RlclRvb2wob3RoZXJVaWQsIHRoaXMuZHJhd1Rvb2xBY3RpdmF0ZSwgZmFsc2UpO1xuICAgIHRvb2xNZ3IucmVnaXN0ZXJUb29sKG90aGVyVWlkLCB0aGlzLm1vZGlmeVRvb2xBY3RpdmF0ZSwgdHJ1ZSk7XG4gICAgdG9vbE1nci5yZWdpc3RlclRvb2wob3RoZXJVaWQsIHRoaXMudHJhbnNsYXRlVG9vbEFjdGl2YXRlLCBmYWxzZSk7XG4gICAgdG9vbE1nci5yZWdpc3RlclRvb2wob3RoZXJVaWQsIHRoaXMucm90YXRlVG9vbEFjdGl2YXRlLCBmYWxzZSk7XG4gICAgdGhpcy5tYXBTZWxlY3RBY3RpdmUgPSB0cnVlO1xuICAgIHRoaXMubW9kaWZ5Xy5zZXRBY3RpdmUodHJ1ZSk7XG4gIH0gZWxzZSB7XG4gICAga2V5cy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgIGtleXMubGVuZ3RoID0gMDtcbiAgICB0b29sTWdyLnVucmVnaXN0ZXJUb29sKGRyYXdVaWQsIHRoaXMuZHJhd1Rvb2xBY3RpdmF0ZSk7XG4gICAgdG9vbE1nci51bnJlZ2lzdGVyVG9vbChkcmF3VWlkLCB0aGlzLm1hcFNlbGVjdFRvb2xBY3RpdmF0ZSk7XG4gICAgdG9vbE1nci51bnJlZ2lzdGVyVG9vbChvdGhlclVpZCwgdGhpcy5kcmF3VG9vbEFjdGl2YXRlKTtcbiAgICB0b29sTWdyLnVucmVnaXN0ZXJUb29sKG90aGVyVWlkLCB0aGlzLm1vZGlmeVRvb2xBY3RpdmF0ZSk7XG4gICAgdG9vbE1nci51bnJlZ2lzdGVyVG9vbChvdGhlclVpZCwgdGhpcy50cmFuc2xhdGVUb29sQWN0aXZhdGUpO1xuICAgIHRvb2xNZ3IudW5yZWdpc3RlclRvb2wob3RoZXJVaWQsIHRoaXMucm90YXRlVG9vbEFjdGl2YXRlKTtcbiAgICB0aGlzLmRyYXdBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLm1vZGlmeV8uc2V0QWN0aXZlKGZhbHNlKTtcbiAgICB0aGlzLm1hcFNlbGVjdEFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMuc2VsZWN0ZWRGZWF0dXJlID0gbnVsbDtcbiAgICB0aGlzLmNsb3NlTWVudV8oKTtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc2VsZWN0RmVhdHVyZUZyb21MaXN0ID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgdGhpcy5saXN0U2VsZWN0aW9uSW5Qcm9ncmVzc18gPSB0cnVlO1xuICB0aGlzLnNlbGVjdGVkRmVhdHVyZSA9IGZlYXR1cmU7XG4gIHRoaXMuZHJhd0FjdGl2ZSA9IGZhbHNlO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0RmVhdHVyZXNBcnJheSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMuZmVhdHVyZXMuZ2V0QXJyYXkoKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmNsZWFyRmVhdHVyZXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICB2YXIgbXNnID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdEbyB5b3UgcmVhbGx5IHdhbnQgdG8gZGVsZXRlIGFsbCB0aGUgZmVhdHVyZXM/Jyk7XG5cbiAgaWYgKGNvbmZpcm0obXNnKSkge1xuICAgIHRoaXMuZmVhdHVyZXMuY2xlYXIoKTtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUucmVtb3ZlRmVhdHVyZSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICB2YXIgbXNnID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdEbyB5b3UgcmVhbGx5IHdhbnQgdG8gZGVsZXRlIHRoZSBzZWxlY3RlZCBmZWF0dXJlPycpO1xuXG4gIGlmIChjb25maXJtKG1zZykpIHtcbiAgICB0aGlzLmZlYXR1cmVzLnJlbW92ZShmZWF0dXJlKTtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlRmVhdHVyZXNBZGRfID0gZnVuY3Rpb24gKGV2dCkge1xuICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICBpZiAoZXZ0IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgdGhpcy50aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpczQuc2VsZWN0ZWRGZWF0dXJlID0gZXZ0LmVsZW1lbnQ7XG4gICAgICBfdGhpczQuZHJhd0FjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICBfdGhpczQuc2NvcGVfLiRhcHBseSgpO1xuICAgIH0pO1xuICB9XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVGZWF0dXJlc1JlbW92ZV8gPSBmdW5jdGlvbiAoZXZ0KSB7XG4gIHRoaXMuc2VsZWN0ZWRGZWF0dXJlID0gbnVsbDtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZU1hcFNlbGVjdEFjdGl2ZUNoYW5nZV8gPSBmdW5jdGlvbiAoYWN0aXZlKSB7XG4gIGlmICghdGhpcy5tYXApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gIH1cblxuICB2YXIgbWFwRGl2ID0gdGhpcy5tYXAuZ2V0Vmlld3BvcnQoKTtcblxuICBpZiAoIW1hcERpdikge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXBEaXYnKTtcbiAgfVxuXG4gIGlmIChhY3RpdmUpIHtcbiAgICB0aGlzLm1hcExpc3RlbmVyS2V5c18ucHVzaChsaXN0ZW4odGhpcy5tYXAsICdjbGljaycsIHRoaXMuaGFuZGxlTWFwQ2xpY2tfLCB0aGlzKSk7XG4gICAgdGhpcy5tYXBMaXN0ZW5lcktleXNfLnB1c2gobGlzdGVuKG1hcERpdiwgJ2NvbnRleHRtZW51JywgdGhpcy5oYW5kbGVNYXBDb250ZXh0TWVudV8sIHRoaXMpKTtcbiAgICB0aGlzLm1hcExpc3RlbmVyS2V5c18ucHVzaChsaXN0ZW4obWFwRGl2LCAndG91Y2hzdGFydCcsIHRoaXMuaGFuZGxlTWFwVG91Y2hTdGFydF8sIHRoaXMpKTtcbiAgICB0aGlzLm1hcExpc3RlbmVyS2V5c18ucHVzaChsaXN0ZW4obWFwRGl2LCAndG91Y2htb3ZlJywgdGhpcy5oYW5kbGVNYXBUb3VjaEVuZF8sIHRoaXMpKTtcbiAgICB0aGlzLm1hcExpc3RlbmVyS2V5c18ucHVzaChsaXN0ZW4obWFwRGl2LCAndG91Y2hlbmQnLCB0aGlzLmhhbmRsZU1hcFRvdWNoRW5kXywgdGhpcykpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMubWFwTGlzdGVuZXJLZXlzXy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICB9XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVNYXBDbGlja18gPSBmdW5jdGlvbiAoZXZ0KSB7XG4gIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gIGlmIChldnQgaW5zdGFuY2VvZiBNYXBCcm93c2VyRXZlbnQpIHtcbiAgICBpZiAoIXRoaXMubWFwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgdmFyIHBpeGVsID0gZXZ0LnBpeGVsO1xuICAgIHZhciBmZWF0dXJlID0gdGhpcy5tYXAuZm9yRWFjaEZlYXR1cmVBdFBpeGVsKHBpeGVsLCBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgdmFyIHJldCA9IG51bGw7XG5cbiAgICAgIGlmIChmZWF0dXJlIGluc3RhbmNlb2YgRmVhdHVyZSkge1xuICAgICAgICBpZiAoX3RoaXM1LmZlYXR1cmVzLmdldEFycmF5KCkuaW5jbHVkZXMoZmVhdHVyZSkpIHtcbiAgICAgICAgICByZXQgPSBmZWF0dXJlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXQ7XG4gICAgfSwge1xuICAgICAgaGl0VG9sZXJhbmNlOiA1LFxuICAgICAgbGF5ZXJGaWx0ZXI6IHVuZGVmaW5lZFxuICAgIH0pO1xuICAgIGZlYXR1cmUgPSBmZWF0dXJlID8gZmVhdHVyZSA6IG51bGw7XG5cbiAgICBpZiAoZmVhdHVyZSA9PT0gdGhpcy5zZWxlY3RlZEZlYXR1cmUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnNlbGVjdGVkRmVhdHVyZSA9IGZlYXR1cmU7XG4gICAgdGhpcy5zY29wZV8uJGFwcGx5KCk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZU1hcFRvdWNoU3RhcnRfID0gZnVuY3Rpb24gKGV2dCkge1xuICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICB0aGlzLmxvbmdQcmVzc1RpbWVvdXRfID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgIF90aGlzNi5oYW5kbGVNYXBDb250ZXh0TWVudV8oZXZ0KTtcbiAgfSwgNTAwKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZU1hcFRvdWNoRW5kXyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgaWYgKCF0aGlzLmxvbmdQcmVzc1RpbWVvdXRfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGxvbmdQcmVzc1RpbWVvdXQnKTtcbiAgfVxuXG4gIGNsZWFyVGltZW91dCh0aGlzLmxvbmdQcmVzc1RpbWVvdXRfKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZU1hcENvbnRleHRNZW51XyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgaWYgKGV2dCBpbnN0YW5jZW9mIEV2ZW50KSB7XG4gICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICAgIHZhciBwaXhlbCA9IHRoaXMubWFwLmdldEV2ZW50UGl4ZWwoZXZ0KTtcbiAgICB2YXIgY29vcmRpbmF0ZSA9IHRoaXMubWFwLmdldENvb3JkaW5hdGVGcm9tUGl4ZWwocGl4ZWwpO1xuICAgIHZhciBmZWF0dXJlID0gdGhpcy5tYXAuZm9yRWFjaEZlYXR1cmVBdFBpeGVsKHBpeGVsLCBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgaWYgKGZlYXR1cmUgaW5zdGFuY2VvZiBGZWF0dXJlKSB7XG4gICAgICAgIHZhciByZXQgPSBudWxsO1xuXG4gICAgICAgIGlmIChfdGhpczcuZmVhdHVyZXMuZ2V0QXJyYXkoKS5pbmNsdWRlcyhmZWF0dXJlKSkge1xuICAgICAgICAgIHJldCA9IGZlYXR1cmU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGhpdFRvbGVyYW5jZTogNyxcbiAgICAgIGxheWVyRmlsdGVyOiB1bmRlZmluZWRcbiAgICB9KTtcbiAgICBmZWF0dXJlID0gZmVhdHVyZSA/IGZlYXR1cmUgOiBudWxsO1xuXG4gICAgaWYgKGZlYXR1cmUpIHtcbiAgICAgIHRoaXMuY2xvc2VNZW51XygpO1xuICAgICAgdmFyIGFjdGlvbnMgPSBbXTtcbiAgICAgIHZhciByZXNvbHV0aW9uID0gdGhpcy5tYXAuZ2V0VmlldygpLmdldFJlc29sdXRpb24oKTtcblxuICAgICAgaWYgKHJlc29sdXRpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVzb2x1dGlvbicpO1xuICAgICAgfVxuXG4gICAgICB2YXIgdmVydGV4SW5mbyA9IHRoaXMuZmVhdHVyZUhlbHBlcl8uZ2V0VmVydGV4SW5mb0F0Q29vcmRpbmF0ZShmZWF0dXJlLCBjb29yZGluYXRlLCByZXNvbHV0aW9uKTtcblxuICAgICAgaWYgKCF2ZXJ0ZXhJbmZvKSB7XG4gICAgICAgIHZhciB0eXBlID0gdGhpcy5mZWF0dXJlSGVscGVyXy5nZXRUeXBlKGZlYXR1cmUpO1xuXG4gICAgICAgIGlmICh0eXBlID09IG5nZW9HZW9tZXRyeVR5cGUuQ0lSQ0xFIHx8IHR5cGUgPT0gbmdlb0dlb21ldHJ5VHlwZS5MSU5FX1NUUklORyB8fCB0eXBlID09IG5nZW9HZW9tZXRyeVR5cGUuUE9MWUdPTiB8fCB0eXBlID09IG5nZW9HZW9tZXRyeVR5cGUuUkVDVEFOR0xFKSB7XG4gICAgICAgICAgYWN0aW9ucyA9IGFjdGlvbnMuY29uY2F0KFt7XG4gICAgICAgICAgICBjbHM6ICdmYXMgZmEtYXJyb3dzLWFsdCcsXG4gICAgICAgICAgICBsYWJlbDogZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdNb3ZlJyksXG4gICAgICAgICAgICBuYW1lOiAnbW92ZSdcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBjbHM6ICdmYXMgZmEtdW5kbyBmYS1mbGlwLWhvcml6b250YWwnLFxuICAgICAgICAgICAgbGFiZWw6IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnUm90YXRlJyksXG4gICAgICAgICAgICBuYW1lOiAncm90YXRlJ1xuICAgICAgICAgIH1dKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBhY3Rpb25zID0gYWN0aW9ucy5jb25jYXQoW3tcbiAgICAgICAgY2xzOiAnZmEgZmEtdHJhc2gnLFxuICAgICAgICBsYWJlbDogdmVydGV4SW5mbyA/IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnRGVsZXRlIHZlcnRleCcpIDogZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdEZWxldGUnKSxcbiAgICAgICAgbmFtZTogJ2RlbGV0ZSdcbiAgICAgIH1dKTtcbiAgICAgIHRoaXMubWVudV8gPSBuZXcgbmdlb01lbnUoe1xuICAgICAgICBhY3Rpb25zOiBhY3Rpb25zXG4gICAgICB9KTtcbiAgICAgIHRoaXMubWVudUxpc3RlbmVyS2V5XyA9IGxpc3Rlbih0aGlzLm1lbnVfLCAnYWN0aW9uY2xpY2snLCB0aGlzLmhhbmRsZU1lbnVBY3Rpb25DbGlja18uYmluZCh0aGlzLCB2ZXJ0ZXhJbmZvKSwgdGhpcyk7XG4gICAgICB0aGlzLm1hcC5hZGRPdmVybGF5KHRoaXMubWVudV8pO1xuICAgICAgdGhpcy5tZW51Xy5vcGVuKGNvb3JkaW5hdGUpO1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfVxuXG4gICAgaWYgKGZlYXR1cmUgPT09IHRoaXMuc2VsZWN0ZWRGZWF0dXJlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5tb2RpZnlfLnNldEFjdGl2ZSh0cnVlKTtcbiAgICB0aGlzLnNlbGVjdGVkRmVhdHVyZSA9IGZlYXR1cmU7XG4gICAgdGhpcy5zY29wZV8uJGFwcGx5KCk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZU1lbnVBY3Rpb25DbGlja18gPSBmdW5jdGlvbiAodmVydGV4SW5mbywgZXZ0KSB7XG4gIHZhciBhY3Rpb24gPSBldnQuZGV0YWlsLmFjdGlvbjtcblxuICBpZiAoIXRoaXMuc2VsZWN0ZWRGZWF0dXJlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNlbGVjdGVkRmVhdHVyZScpO1xuICB9XG5cbiAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICBjYXNlICdkZWxldGUnOlxuICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkRmVhdHVyZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc2VsZWN0ZWRGZWF0dXJlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh2ZXJ0ZXhJbmZvKSB7XG4gICAgICAgIHRoaXMuZmVhdHVyZUhlbHBlcl8ucmVtb3ZlVmVydGV4KHRoaXMuc2VsZWN0ZWRGZWF0dXJlLCB2ZXJ0ZXhJbmZvKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVtb3ZlRmVhdHVyZSh0aGlzLnNlbGVjdGVkRmVhdHVyZSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdtb3ZlJzpcbiAgICAgIHRoaXMudHJhbnNsYXRlXy5zZXRBY3RpdmUodHJ1ZSk7XG4gICAgICB0aGlzLnNjb3BlXy4kYXBwbHkoKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAncm90YXRlJzpcbiAgICAgIHRoaXMucm90YXRlXy5zZXRBY3RpdmUodHJ1ZSk7XG4gICAgICB0aGlzLnNjb3BlXy4kYXBwbHkoKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUubG9nKFwiRklYTUUgLSBzdXBwb3J0OiBcIiArIGFjdGlvbik7XG4gICAgICBicmVhaztcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlVHJhbnNsYXRlRW5kXyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgdGhpcy50cmFuc2xhdGVfLnNldEFjdGl2ZShmYWxzZSk7XG4gIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlUm90YXRlRW5kXyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgdGhpcy5yb3RhdGVfLnNldEFjdGl2ZShmYWxzZSk7XG4gIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xufTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ0dtZkRyYXdmZWF0dXJlQ29udHJvbGxlcicsIENvbnRyb2xsZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXYgbmctaWY9XCJmc0N0cmwuZmVhdHVyZSAmJiBmc0N0cmwudHlwZVwiPlxcbiAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cXG4gICAgPGlucHV0XFxuICAgICAgICBuZy1tb2RlbD1cImZzQ3RybC5nZXRTZXROYW1lXCJcXG4gICAgICAgIG5nLW1vZGVsLW9wdGlvbnM9XCJ7Z2V0dGVyU2V0dGVyOiB0cnVlfVwiXFxuICAgICAgICBuZy1hdHRyLXBsYWNlaG9sZGVyPVwie3tcXCdOYW1lXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIi8+XFxuICA8L2Rpdj5cXG4gIDxkaXZcXG4gICAgICBuZy1pZj1cImZzQ3RybC50eXBlICE9PSBcXCdUZXh0XFwnXCJcXG4gICAgICBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cXG4gICAgICAgIDxpbnB1dFxcbiAgICAgICAgICBpZD1cImdtZi1mZWF0dXJlc3R5bGUtc2hvd2xhYmVsLXt7Ojpmc0N0cmwudWlkfX1cIlxcbiAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxcbiAgICAgICAgICBuZy1tb2RlbD1cImZzQ3RybC5nZXRTZXRTaG93TGFiZWxcIlxcbiAgICAgICAgICBuZy1tb2RlbC1vcHRpb25zPVwie2dldHRlclNldHRlcjogdHJ1ZX1cIi8+XFxuICAgICAgICA8bGFiZWxcXG4gICAgICAgICAgbmctc3dpdGNoPVwiZnNDdHJsLnR5cGVcIlxcbiAgICAgICAgICBmb3I9XCJnbWYtZmVhdHVyZXN0eWxlLXNob3dsYWJlbC17ezo6ZnNDdHJsLnVpZH19XCJcXG4gICAgICAgICAgY2xhc3M9XCJjb2wtZm9ybS1sYWJlbFwiPlxcbiAgICAgICAgICB7e1xcJ0Rpc3BsYXkgbGFiZWxcXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgICAgPC9sYWJlbD5cXG4gIDwvZGl2PlxcbiAgPGRpdlxcbiAgICAgIG5nLWlmPVwiZnNDdHJsLnR5cGUgIT09IFxcJ1RleHRcXCdcIlxcbiAgICAgIGNsYXNzPVwiZm9ybS1ncm91cFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgICBpZD1cImdtZi1mZWF0dXJlc3R5bGUtc2hvd21lYXN1cmUte3s6OmZzQ3RybC51aWR9fVwiXFxuICAgICAgICAgIHR5cGU9XCJjaGVja2JveFwiXFxuICAgICAgICAgIG5nLW1vZGVsPVwiZnNDdHJsLmdldFNldFNob3dNZWFzdXJlXCJcXG4gICAgICAgICAgbmctbW9kZWwtb3B0aW9ucz1cIntnZXR0ZXJTZXR0ZXI6IHRydWV9XCIvPlxcbiAgICAgIDxsYWJlbFxcbiAgICAgICAgICBuZy1zd2l0Y2g9XCJmc0N0cmwudHlwZVwiXFxuICAgICAgICAgIGZvcj1cImdtZi1mZWF0dXJlc3R5bGUtc2hvd21lYXN1cmUte3s6OmZzQ3RybC51aWR9fVwiXFxuICAgICAgICAgIGNsYXNzPVwiY29sLWZvcm0tbGFiZWxcIj5cXG4gICAgICAgIDxzcGFuIG5nLXN3aXRjaC13aGVuPVwiQ2lyY2xlXCI+XFxuICAgICAgICAgIHt7XFwnRGlzcGxheSBhemltdXRoIGFuZCByYWRpdXNcXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgPHNwYW4gbmctc3dpdGNoLXdoZW49XCJQb2x5Z29uXCI+XFxuICAgICAgICAgIHt7XFwnRGlzcGxheSBzdXJmYWNlXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgICAgIDwvc3Bhbj5cXG4gICAgICAgIDxzcGFuIG5nLXN3aXRjaC13aGVuPVwiUmVjdGFuZ2xlXCI+XFxuICAgICAgICAgIHt7XFwnRGlzcGxheSBzdXJmYWNlXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgICAgIDwvc3Bhbj5cXG4gICAgICAgIDxzcGFuIG5nLXN3aXRjaC13aGVuPVwiTGluZVN0cmluZ1wiPlxcbiAgICAgICAgICB7e1xcJ0Rpc3BsYXkgbGVuZ3RoXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgICAgIDwvc3Bhbj5cXG4gICAgICAgIDxzcGFuIG5nLXN3aXRjaC13aGVuPVwiUG9pbnRcIj5cXG4gICAgICAgICAge3tcXCdEaXNwbGF5IGNvb3JkaW5hdGVzXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgICAgIDwvc3Bhbj5cXG4gICAgICA8L2xhYmVsPlxcbiAgICAgIDxlbSBjbGFzcz1cInRleHQtbXV0ZWRcIj5cXG4gICAgICAgICh7eyBmc0N0cmwubWVhc3VyZSB9fSlcXG4gICAgICA8L2VtPlxcbiAgPC9kaXY+XFxuPC9kaXY+XFxuPGRpdiBuZy1pZj1cImZzQ3RybC5mZWF0dXJlICYmIGZzQ3RybC50eXBlXCI+XFxuXFxuICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxcbiAgICA8ZGl2XFxuICAgICAgICBuZ2VvLWNvbG9ycGlja2VyPVwiXCJcXG4gICAgICAgIG5nZW8tY29sb3JwaWNrZXItY29sb3I9XCJmc0N0cmwuY29sb3JcIlxcbiAgICAgICAgY2xhc3M9XCJjb2wtbWQtMTJcIj5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXZcXG4gICAgICBuZy1pZj1cImZzQ3RybC50eXBlID09PSBcXCdQb2ludFxcJ1wiXFxuICAgICAgY2xhc3M9XCJmb3JtLWdyb3VwIGZvcm0tZ3JvdXAtbm9tYXJnaW5cIj5cXG4gICAgPGxhYmVsIGNsYXNzPVwiY29sLWZvcm0tbGFiZWwgY29sLW1kLTRcIj57e1xcJ1NpemVcXCcgfCB0cmFuc2xhdGV9fTwvbGFiZWw+XFxuICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtOFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgICB0eXBlPVwicmFuZ2VcIlxcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgIG1pbj1cIjNcIlxcbiAgICAgICAgICBtYXg9XCIyMFwiXFxuICAgICAgICAgIHN0ZXA9XCIxXCJcXG4gICAgICAgICAgbmctbW9kZWw9XCJmc0N0cmwuZ2V0U2V0U2l6ZVwiXFxuICAgICAgICAgIG5nLW1vZGVsLW9wdGlvbnM9XCJ7Z2V0dGVyU2V0dGVyOiB0cnVlfVwiXFxuICAgICAgICAgIC8+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2XFxuICAgICAgbmctaWY9XCJmc0N0cmwudHlwZSA9PT0gXFwnVGV4dFxcJ1wiXFxuICAgICAgY2xhc3M9XCJmb3JtLWdyb3VwIGZvcm0tZ3JvdXAtbm9tYXJnaW5cIj5cXG4gICAgPGxhYmVsIGNsYXNzPVwiY29sLWZvcm0tbGFiZWwgY29sLW1kLTRcIj57e1xcJ1NpemVcXCcgfCB0cmFuc2xhdGV9fTwvbGFiZWw+XFxuICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtOFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgICB0eXBlPVwicmFuZ2VcIlxcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgIG1pbj1cIjhcIlxcbiAgICAgICAgICBtYXg9XCIzMFwiXFxuICAgICAgICAgIHN0ZXA9XCIxXCJcXG4gICAgICAgICAgbmctbW9kZWw9XCJmc0N0cmwuZ2V0U2V0U2l6ZVwiXFxuICAgICAgICAgIG5nLW1vZGVsLW9wdGlvbnM9XCJ7Z2V0dGVyU2V0dGVyOiB0cnVlfVwiXFxuICAgICAgICAgIC8+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2XFxuICAgICAgbmctaWY9XCJmc0N0cmwudHlwZSA9PT0gXFwnQ2lyY2xlXFwnIHx8IGZzQ3RybC50eXBlID09PSBcXCdMaW5lU3RyaW5nXFwnIHx8IGZzQ3RybC50eXBlID09PSBcXCdQb2x5Z29uXFwnIHx8IGZzQ3RybC50eXBlID09PSBcXCdSZWN0YW5nbGVcXCdcIlxcbiAgICAgIGNsYXNzPVwiZm9ybS1ncm91cCBmb3JtLWdyb3VwLW5vbWFyZ2luXCI+XFxuICAgIDxsYWJlbCBjbGFzcz1cImNvbC1mb3JtLWxhYmVsIGNvbC1tZC00XCI+e3tcXCdTdHJva2VcXCcgfCB0cmFuc2xhdGV9fTwvbGFiZWw+XFxuICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtOFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgICB0eXBlPVwicmFuZ2VcIlxcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgIG1pbj1cIjAuNVwiXFxuICAgICAgICAgIG1heD1cIjVcIlxcbiAgICAgICAgICBzdGVwPVwiMC41XCJcXG4gICAgICAgICAgbmctbW9kZWw9XCJmc0N0cmwuZ2V0U2V0U3Ryb2tlXCJcXG4gICAgICAgICAgbmctbW9kZWwtb3B0aW9ucz1cIntnZXR0ZXJTZXR0ZXI6IHRydWV9XCJcXG4gICAgICAgICAgLz5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXZcXG4gICAgICBuZy1pZj1cImZzQ3RybC50eXBlID09PSBcXCdDaXJjbGVcXCcgfHwgZnNDdHJsLnR5cGUgPT09IFxcJ1BvbHlnb25cXCcgfHwgZnNDdHJsLnR5cGUgPT09IFxcJ1JlY3RhbmdsZVxcJ1wiXFxuICAgICAgY2xhc3M9XCJmb3JtLWdyb3VwIGZvcm0tZ3JvdXAtbm9tYXJnaW5cIj5cXG4gICAgPGxhYmVsIGNsYXNzPVwiY29sLWZvcm0tbGFiZWwgY29sLW1kLTRcIj57e1xcJ09wYWNpdHlcXCcgfCB0cmFuc2xhdGV9fTwvbGFiZWw+XFxuICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtOFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgICB0eXBlPVwicmFuZ2VcIlxcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgIG1pbj1cIjBcIlxcbiAgICAgICAgICBtYXg9XCIxXCJcXG4gICAgICAgICAgc3RlcD1cIjAuMDVcIlxcbiAgICAgICAgICBuZy1tb2RlbD1cImZzQ3RybC5nZXRTZXRPcGFjaXR5XCJcXG4gICAgICAgICAgbmctbW9kZWwtb3B0aW9ucz1cIntnZXR0ZXJTZXR0ZXI6IHRydWV9XCJcXG4gICAgICAgICAgLz5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXZcXG4gICAgICBuZy1pZj1cImZzQ3RybC50eXBlID09PSBcXCdUZXh0XFwnXCJcXG4gICAgICBjbGFzcz1cImZvcm0tZ3JvdXAgZm9ybS1ncm91cC1ub21hcmdpblwiPlxcbiAgICA8bGFiZWwgY2xhc3M9XCJjb2wtZm9ybS1sYWJlbCBjb2wtbWQtNFwiPnt7XFwnQW5nbGVcXCcgfCB0cmFuc2xhdGV9fTwvbGFiZWw+XFxuICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtOFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgICB0eXBlPVwicmFuZ2VcIlxcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgIG1pbj1cIi0xODBcIlxcbiAgICAgICAgICBtYXg9XCIxODBcIlxcbiAgICAgICAgICBzdGVwPVwiMjIuNVwiXFxuICAgICAgICAgIG5nLW1vZGVsPVwiZnNDdHJsLmdldFNldEFuZ2xlXCJcXG4gICAgICAgICAgbmctbW9kZWwtb3B0aW9ucz1cIntnZXR0ZXJTZXR0ZXI6IHRydWV9XCJcXG4gICAgICAgICAgLz5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG5cXG48L2Rpdj5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwibmdlb0ZlYXR1cmVIZWxwZXJcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IGdldFVpZCBhcyBvbFV0aWxHZXRVaWQgfSBmcm9tICdvbC91dGlsLmpzJztcbmltcG9ydCB7IGxpc3RlbiwgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzIGZyb20gJ25nZW8vZm9ybWF0L0ZlYXR1cmVQcm9wZXJ0aWVzLmpzJztcbmltcG9ydCBuZ2VvTWlzY0NvbG9ycGlja2VyQ29tcG9uZW50IGZyb20gJ25nZW8vbWlzYy9jb2xvcnBpY2tlckNvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb01pc2NGZWF0dXJlSGVscGVyIGZyb20gJ25nZW8vbWlzYy9GZWF0dXJlSGVscGVyLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mRHJhd2luZ0ZlYXR1cmVTdHlsZScsIFtuZ2VvTWlzY0NvbG9ycGlja2VyQ29tcG9uZW50Lm5hbWUsIG5nZW9NaXNjRmVhdHVyZUhlbHBlci5uYW1lXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi9kcmF3aW5nL2ZlYXR1cmVTdHlsZUNvbXBvbmVudCcsIHJlcXVpcmUoJy4vZmVhdHVyZVN0eWxlQ29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5cbmZ1bmN0aW9uIGRyYXdpbmdEcmF3RmVhdHVyZUNvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBjb250cm9sbGVyOiAnR21mRmVhdHVyZXN0eWxlQ29udHJvbGxlciBhcyBmc0N0cmwnLFxuICAgIHNjb3BlOiB7XG4gICAgICAnZmVhdHVyZSc6ICc9Z21mRmVhdHVyZXN0eWxlRmVhdHVyZSdcbiAgICB9LFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgdGVtcGxhdGVVcmw6ICdnbWYvZHJhd2luZy9mZWF0dXJlU3R5bGVDb21wb25lbnQnXG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ2dtZkZlYXR1cmVzdHlsZScsIGRyYXdpbmdEcmF3RmVhdHVyZUNvbXBvbmVudCk7XG5cbmZ1bmN0aW9uIENvbnRyb2xsZXIoJHNjb3BlLCBuZ2VvRmVhdHVyZUhlbHBlcikge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHRoaXMudWlkID0gb2xVdGlsR2V0VWlkKHRoaXMpO1xuICB0aGlzLmZlYXR1cmUgPSBudWxsO1xuICB0aGlzLnNjb3BlXyA9ICRzY29wZTtcbiAgdGhpcy5mZWF0dXJlSGVscGVyXyA9IG5nZW9GZWF0dXJlSGVscGVyO1xuICB0aGlzLmNvbG9yID0gdW5kZWZpbmVkO1xuICB0aGlzLmxhYmVsID0gdW5kZWZpbmVkO1xuICB0aGlzLm1lYXN1cmUgPSB1bmRlZmluZWQ7XG4gICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5jb2xvcjtcbiAgfSwgdGhpcy5oYW5kbGVDb2xvclNldF8uYmluZCh0aGlzKSk7XG4gIHRoaXMuZmVhdHVyZUxpc3RlbmVyS2V5c18gPSBbXTtcbiAgdGhpcy50eXBlO1xuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuZmVhdHVyZTtcbiAgfSwgdGhpcy5oYW5kbGVGZWF0dXJlU2V0Xy5iaW5kKHRoaXMpKTtcbn1cblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlRmVhdHVyZVNldF8gPSBmdW5jdGlvbiAobmV3RmVhdHVyZSwgcHJldmlvdXNGZWF0dXJlKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIHZhciBrZXlzID0gdGhpcy5mZWF0dXJlTGlzdGVuZXJLZXlzXztcblxuICBpZiAocHJldmlvdXNGZWF0dXJlKSB7XG4gICAga2V5cy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgIGtleXMubGVuZ3RoID0gMDtcbiAgICB0aGlzLnR5cGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5jb2xvciA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1lYXN1cmUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5sYWJlbCA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmIChuZXdGZWF0dXJlKSB7XG4gICAgW25nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5BTkdMRSwgbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLkNPTE9SLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuTkFNRSwgbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNIT1dfTEFCRUwsIG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5PUEFDSVRZLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU0hPV19NRUFTVVJFLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU0laRSwgbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNUUk9LRV0uZm9yRWFjaChmdW5jdGlvbiAocHJvcE5hbWUpIHtcbiAgICAgIGtleXMucHVzaChsaXN0ZW4obmV3RmVhdHVyZSwgXCJjaGFuZ2U6XCIgKyBwcm9wTmFtZSwgX3RoaXMyLmhhbmRsZUZlYXR1cmVDaGFuZ2VfLCBfdGhpczIpKTtcbiAgICB9KTtcbiAgICB2YXIgZ2VvbWV0cnkgPSBuZXdGZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICBrZXlzLnB1c2gobGlzdGVuKGdlb21ldHJ5LCAnY2hhbmdlJywgdGhpcy5oYW5kbGVHZW9tZXRyeUNoYW5nZV8sIHRoaXMpKTtcbiAgICB0aGlzLnR5cGUgPSB0aGlzLmZlYXR1cmVIZWxwZXJfLmdldFR5cGUobmV3RmVhdHVyZSk7XG4gICAgdGhpcy5jb2xvciA9IHRoaXMuZmVhdHVyZUhlbHBlcl8uZ2V0Q29sb3JQcm9wZXJ0eShuZXdGZWF0dXJlKTtcbiAgICB0aGlzLm1lYXN1cmUgPSB0aGlzLmZlYXR1cmVIZWxwZXJfLmdldE1lYXN1cmUobmV3RmVhdHVyZSk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZUNvbG9yU2V0XyA9IGZ1bmN0aW9uIChuZXdDb2xvcikge1xuICBpZiAodGhpcy5mZWF0dXJlICYmIG5ld0NvbG9yKSB7XG4gICAgdmFyIGN1cnJlbnRDb2xvciA9IHRoaXMuZmVhdHVyZS5nZXQobmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLkNPTE9SKTtcblxuICAgIGlmIChjdXJyZW50Q29sb3IgIT09IG5ld0NvbG9yKSB7XG4gICAgICB0aGlzLmZlYXR1cmUuc2V0KG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5DT0xPUiwgbmV3Q29sb3IpO1xuICAgIH1cbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0U2V0QW5nbGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgcmV0dXJuIHRoaXMuZ2V0U2V0UHJvcGVydHlfKG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5BTkdMRSwgdmFsdWUpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0U2V0TmFtZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gdGhpcy5nZXRTZXRQcm9wZXJ0eV8obmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLk5BTUUsIHZhbHVlKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldFNldFNob3dMYWJlbCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gdGhpcy5nZXRTZXRQcm9wZXJ0eV8obmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNIT1dfTEFCRUwsIHZhbHVlKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldFNldE9wYWNpdHkgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgcmV0dXJuIHRoaXMuZ2V0U2V0UHJvcGVydHlfKG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5PUEFDSVRZLCB2YWx1ZSk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5nZXRTZXRTaG93TWVhc3VyZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gdGhpcy5nZXRTZXRQcm9wZXJ0eV8obmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNIT1dfTUVBU1VSRSwgdmFsdWUpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0U2V0U2l6ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gdGhpcy5nZXRTZXRQcm9wZXJ0eV8obmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNJWkUsIHZhbHVlKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldFNldFN0cm9rZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gdGhpcy5nZXRTZXRQcm9wZXJ0eV8obmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNUUk9LRSwgdmFsdWUpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0U2V0UHJvcGVydHlfID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgaWYgKCF0aGlzLmZlYXR1cmUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZScpO1xuICB9XG5cbiAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzLmZlYXR1cmUuc2V0KGtleSwgdmFsdWUpO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuZmVhdHVyZS5nZXQoa2V5KTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZUZlYXR1cmVDaGFuZ2VfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZTtcblxuICBpZiAoIWZlYXR1cmUpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLmZlYXR1cmVIZWxwZXJfLnNldFN0eWxlKGZlYXR1cmUsIHRydWUpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlR2VvbWV0cnlDaGFuZ2VfID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMuZmVhdHVyZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlJyk7XG4gIH1cblxuICB0aGlzLm1lYXN1cmUgPSB0aGlzLmZlYXR1cmVIZWxwZXJfLmdldE1lYXN1cmUodGhpcy5mZWF0dXJlKTtcbiAgdmFyIHNob3dNZWFzdXJlID0gdGhpcy5mZWF0dXJlSGVscGVyXy5nZXRTaG93TWVhc3VyZVByb3BlcnR5KHRoaXMuZmVhdHVyZSk7XG5cbiAgaWYgKHNob3dNZWFzdXJlKSB7XG4gICAgdGhpcy5oYW5kbGVGZWF0dXJlQ2hhbmdlXygpO1xuICB9XG5cbiAgdGhpcy5zY29wZV8uJGFwcGx5KCk7XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignR21mRmVhdHVyZXN0eWxlQ29udHJvbGxlcicsIENvbnRyb2xsZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IGdtZkRyYXdpbmdEcmF3RmVhdHVyZUNvbXBvbmVudCBmcm9tICdnbWYvZHJhd2luZy9kcmF3RmVhdHVyZUNvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mRHJhd2luZ0ZlYXR1cmVTdHlsZUNvbXBvbmVudCBmcm9tICdnbWYvZHJhd2luZy9mZWF0dXJlU3R5bGVDb21wb25lbnQuanMnO1xuZXhwb3J0IGRlZmF1bHQgYW5ndWxhci5tb2R1bGUoJ2dtZkRyYXdpbmdNb2R1bGUnLCBbZ21mRHJhd2luZ0RyYXdGZWF0dXJlQ29tcG9uZW50Lm5hbWUsIGdtZkRyYXdpbmdGZWF0dXJlU3R5bGVDb21wb25lbnQubmFtZV0pOyIsIkVkaXRpbmdFZGl0RmVhdHVyZS4kaW5qZWN0ID0gW1wiJGh0dHBcIiwgXCJnbWZMYXllcnNVcmxcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBvbEZvcm1hdEdlb0pTT04gZnJvbSAnb2wvZm9ybWF0L0dlb0pTT04uanMnO1xuaW1wb3J0IHsgYXBwZW5kUGFyYW1zIGFzIG9sVXJpQXBwZW5kUGFyYW1zIH0gZnJvbSAnb2wvdXJpLmpzJztcbmV4cG9ydCBmdW5jdGlvbiBFZGl0aW5nRWRpdEZlYXR1cmUoJGh0dHAsIGdtZkxheWVyc1VybCkge1xuICB0aGlzLmh0dHBfID0gJGh0dHA7XG4gIHRoaXMuYmFzZVVybF8gPSBnbWZMYXllcnNVcmw7XG59XG5cbkVkaXRpbmdFZGl0RmVhdHVyZS5wcm90b3R5cGUuZ2V0RmVhdHVyZXNJbkV4dGVudCA9IGZ1bmN0aW9uIChsYXllcklkcywgZXh0ZW50KSB7XG4gIHZhciB1cmwgPSBvbFVyaUFwcGVuZFBhcmFtcyh0aGlzLmJhc2VVcmxfICsgXCIvXCIgKyBsYXllcklkcy5qb2luKCcsJyksIHtcbiAgICAnYmJveCc6IGV4dGVudC5qb2luKCcsJylcbiAgfSk7XG4gIHJldHVybiB0aGlzLmh0dHBfLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIG5ldyBvbEZvcm1hdEdlb0pTT04oKS5yZWFkRmVhdHVyZXMocmVzcG9uc2UuZGF0YSk7XG4gIH0pO1xufTtcblxuRWRpdGluZ0VkaXRGZWF0dXJlLnByb3RvdHlwZS5nZXRGZWF0dXJlc1dpdGhDb21wYXJpc29uRmlsdGVycyA9IGZ1bmN0aW9uIChsYXllcklkcywgZmlsdGVycykge1xuICB2YXIgcHJvcGVydGllcyA9IFtdO1xuICB2YXIgcGFyYW1zID0ge307XG5cbiAgZm9yICh2YXIgX2l0ZXJhdG9yID0gZmlsdGVycywgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvciksIF9pID0gMCwgX2l0ZXJhdG9yID0gX2lzQXJyYXkgPyBfaXRlcmF0b3IgOiBfaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICB2YXIgX3JlZjtcblxuICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgaWYgKF9pID49IF9pdGVyYXRvci5sZW5ndGgpIGJyZWFrO1xuICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICB9IGVsc2Uge1xuICAgICAgX2kgPSBfaXRlcmF0b3IubmV4dCgpO1xuICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgIH1cblxuICAgIHZhciBmaWx0ZXIgPSBfcmVmO1xuICAgIHBhcmFtc1tmaWx0ZXIucHJvcGVydHkgKyBcIl9fXCIgKyBmaWx0ZXIub3BlcmF0b3JdID0gZmlsdGVyLnZhbHVlO1xuICAgIHByb3BlcnRpZXMucHVzaChmaWx0ZXIucHJvcGVydHkpO1xuICB9XG5cbiAgcGFyYW1zLnF1ZXJ5YWJsZSA9IHByb3BlcnRpZXMuam9pbignLCcpO1xuICB2YXIgdXJsID0gb2xVcmlBcHBlbmRQYXJhbXModGhpcy5iYXNlVXJsXyArIFwiL1wiICsgbGF5ZXJJZHMuam9pbignLCcpLCBwYXJhbXMpO1xuICByZXR1cm4gdGhpcy5odHRwXy5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIHJldHVybiBuZXcgb2xGb3JtYXRHZW9KU09OKCkucmVhZEZlYXR1cmVzKHJlc3BvbnNlLmRhdGEpO1xuICB9KTtcbn07XG5cbkVkaXRpbmdFZGl0RmVhdHVyZS5wcm90b3R5cGUuaW5zZXJ0RmVhdHVyZXMgPSBmdW5jdGlvbiAobGF5ZXJJZCwgZmVhdHVyZXMpIHtcbiAgdmFyIHVybCA9IHRoaXMuYmFzZVVybF8gKyBcIi9cIiArIGxheWVySWQ7XG4gIHZhciBnZW9KU09OID0gbmV3IG9sRm9ybWF0R2VvSlNPTigpLndyaXRlRmVhdHVyZXMoZmVhdHVyZXMpO1xuICByZXR1cm4gdGhpcy5odHRwXy5wb3N0KHVybCwgZ2VvSlNPTiwge1xuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vZ2VvK2pzb24nXG4gICAgfSxcbiAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWVcbiAgfSk7XG59O1xuXG5FZGl0aW5nRWRpdEZlYXR1cmUucHJvdG90eXBlLnVwZGF0ZUZlYXR1cmUgPSBmdW5jdGlvbiAobGF5ZXJJZCwgZmVhdHVyZSkge1xuICB2YXIgdXJsID0gdGhpcy5iYXNlVXJsXyArIFwiL1wiICsgbGF5ZXJJZC50b1N0cmluZygpICsgXCIvXCIgKyBmZWF0dXJlLmdldElkKCk7XG4gIHZhciBnZW9KU09OID0gbmV3IG9sRm9ybWF0R2VvSlNPTigpLndyaXRlRmVhdHVyZShmZWF0dXJlKTtcbiAgcmV0dXJuIHRoaXMuaHR0cF8ucHV0KHVybCwgZ2VvSlNPTiwge1xuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vZ2VvK2pzb24nXG4gICAgfSxcbiAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWVcbiAgfSk7XG59O1xuXG5FZGl0aW5nRWRpdEZlYXR1cmUucHJvdG90eXBlLmRlbGV0ZUZlYXR1cmUgPSBmdW5jdGlvbiAobGF5ZXJJZCwgZmVhdHVyZSkge1xuICB2YXIgdXJsID0gdGhpcy5iYXNlVXJsXyArIFwiL1wiICsgbGF5ZXJJZC50b1N0cmluZygpICsgXCIvXCIgKyBmZWF0dXJlLmdldElkKCk7XG4gIHJldHVybiB0aGlzLmh0dHBfLmRlbGV0ZSh1cmwsIHtcbiAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWVcbiAgfSk7XG59O1xuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZkVkaXRGZWF0dXJlJywgW10pO1xubW9kdWxlLnNlcnZpY2UoJ2dtZkVkaXRGZWF0dXJlJywgRWRpdGluZ0VkaXRGZWF0dXJlKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmV4cG9ydCB2YXIgRWRpdGluZ0VudW1lcmF0ZUF0dHJpYnV0ZVNlcnZpY2UgPSBmdW5jdGlvbiAoKSB7XG4gIEVkaXRpbmdFbnVtZXJhdGVBdHRyaWJ1dGVTZXJ2aWNlLiRpbmplY3QgPSBbXCIkaHR0cFwiLCBcImdtZkxheWVyc1VybFwiXTtcblxuICBmdW5jdGlvbiBFZGl0aW5nRW51bWVyYXRlQXR0cmlidXRlU2VydmljZSgkaHR0cCwgZ21mTGF5ZXJzVXJsKSB7XG4gICAgdGhpcy5odHRwXyA9ICRodHRwO1xuICAgIHRoaXMuYmFzZVVybF8gPSBnbWZMYXllcnNVcmw7XG4gICAgdGhpcy5wcm9taXNlc18gPSB7fTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBFZGl0aW5nRW51bWVyYXRlQXR0cmlidXRlU2VydmljZS5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmdldEF0dHJpYnV0ZVZhbHVlcyA9IGZ1bmN0aW9uIGdldEF0dHJpYnV0ZVZhbHVlcyhkYXRhU291cmNlLCBhdHRyaWJ1dGUpIHtcbiAgICB2YXIgcHJvbWlzZUlkID0gZGF0YVNvdXJjZS5pZCArIFwiX1wiICsgYXR0cmlidXRlO1xuICAgIHZhciBuYW1lID0gZGF0YVNvdXJjZS5uYW1lO1xuXG4gICAgaWYgKCF0aGlzLnByb21pc2VzX1twcm9taXNlSWRdKSB7XG4gICAgICB2YXIgdXJsID0gdGhpcy5iYXNlVXJsXyArIFwiL1wiICsgbmFtZSArIFwiL3ZhbHVlcy9cIiArIGF0dHJpYnV0ZTtcbiAgICAgIHRoaXMucHJvbWlzZXNfW3Byb21pc2VJZF0gPSB0aGlzLmh0dHBfLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcbiAgICAgICAgcmV0dXJuIHJlc3AuZGF0YS5pdGVtcztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnByb21pc2VzX1twcm9taXNlSWRdO1xuICB9O1xuXG4gIHJldHVybiBFZGl0aW5nRW51bWVyYXRlQXR0cmlidXRlU2VydmljZTtcbn0oKTtcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mRW51bWVyYXRlQXR0cmlidXRlJywgW10pO1xubW9kdWxlLnNlcnZpY2UoJ2dtZkVudW1lcmF0ZUF0dHJpYnV0ZScsIEVkaXRpbmdFbnVtZXJhdGVBdHRyaWJ1dGVTZXJ2aWNlKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJFZGl0aW5nU25hcHBpbmdTZXJ2aWNlLiRpbmplY3QgPSBbXCIkaHR0cFwiLCBcIiRxXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRpbmplY3RvclwiLCBcIiR0aW1lb3V0XCIsIFwiZ21mVGhlbWVzXCIsIFwiZ21mVHJlZU1hbmFnZXJcIl07XG5cbmZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZMYXllcnRyZWVUcmVlTWFuYWdlciBmcm9tICdnbWYvbGF5ZXJ0cmVlL1RyZWVNYW5hZ2VyLmpzJztcbmltcG9ydCBnbWZUaGVtZVRoZW1lcywgeyBUaGVtZU5vZGVUeXBlLCBnZXRTbmFwcGluZ0NvbmZpZyB9IGZyb20gJ2dtZi90aGVtZS9UaGVtZXMuanMnO1xuaW1wb3J0IG5nZW9MYXllcnRyZWVDb250cm9sbGVyLCB7IGdldEZpcnN0UGFyZW50VHJlZSB9IGZyb20gJ25nZW8vbGF5ZXJ0cmVlL0NvbnRyb2xsZXIuanMnO1xuaW1wb3J0IHsgREVGQVVMVF9HRU9NRVRSWV9OQU1FIH0gZnJvbSAnbmdlby9kYXRhc291cmNlL09HQy5qcyc7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4sIHVubGlzdGVuQnlLZXkgfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sQ29sbGVjdGlvbiBmcm9tICdvbC9Db2xsZWN0aW9uLmpzJztcbmltcG9ydCBvbEZvcm1hdFdGUyBmcm9tICdvbC9mb3JtYXQvV0ZTLmpzJztcbmltcG9ydCBvbEludGVyYWN0aW9uU25hcCBmcm9tICdvbC9pbnRlcmFjdGlvbi9TbmFwLmpzJztcbmV4cG9ydCBmdW5jdGlvbiBFZGl0aW5nU25hcHBpbmdTZXJ2aWNlKCRodHRwLCAkcSwgJHJvb3RTY29wZSwgJGluamVjdG9yLCAkdGltZW91dCwgZ21mVGhlbWVzLCBnbWZUcmVlTWFuYWdlcikge1xuICB0aGlzLmh0dHBfID0gJGh0dHA7XG4gIHRoaXMucV8gPSAkcTtcbiAgdGhpcy5yb290U2NvcGVfID0gJHJvb3RTY29wZTtcbiAgdGhpcy50aW1lb3V0XyA9ICR0aW1lb3V0O1xuICB0aGlzLmluamVjdG9yXyA9ICRpbmplY3RvcjtcbiAgdGhpcy5nbWZUaGVtZXNfID0gZ21mVGhlbWVzO1xuICB0aGlzLmdtZlRyZWVNYW5hZ2VyXyA9IGdtZlRyZWVNYW5hZ2VyO1xuICB0aGlzLmNhY2hlXyA9IHt9O1xuICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgdGhpcy5tYXBfID0gbnVsbDtcbiAgdGhpcy5tYXBWaWV3Q2hhbmdlUHJvbWlzZV8gPSBudWxsO1xuICB0aGlzLm9nY1NlcnZlcnNfID0gbnVsbDtcbiAgdGhpcy5uZ2VvU25hcHBpbmdTb3VyY2VfID0gdGhpcy5pbmplY3Rvcl8uaGFzKCduZ2VvU25hcHBpbmdTb3VyY2UnKSA/IHRoaXMuaW5qZWN0b3JfLmdldCgnbmdlb1NuYXBwaW5nU291cmNlJykgOiB1bmRlZmluZWQ7XG59XG5cbnZhciBDdXN0b21TbmFwID0gZnVuY3Rpb24gKF9vbEludGVyYWN0aW9uU25hcCkge1xuICBfaW5oZXJpdHNMb29zZShDdXN0b21TbmFwLCBfb2xJbnRlcmFjdGlvblNuYXApO1xuXG4gIGZ1bmN0aW9uIEN1c3RvbVNuYXAob3B0aW9ucykge1xuICAgIHZhciBfdGhpcztcblxuICAgIF90aGlzID0gX29sSW50ZXJhY3Rpb25TbmFwLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICBfdGhpcy5zZXRBY3RpdmUoZXZ0LmtleUNvZGUgIT09IDE3KTtcbiAgICB9KTtcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuc2V0QWN0aXZlKHRydWUpO1xuICAgIH0pO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBDdXN0b21TbmFwO1xufShvbEludGVyYWN0aW9uU25hcCk7XG5cbkVkaXRpbmdTbmFwcGluZ1NlcnZpY2UucHJvdG90eXBlLmVuc3VyZVNuYXBJbnRlcmFjdGlvbnNPblRvcCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLm1hcF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gIH1cblxuICB2YXIgbWFwID0gdGhpcy5tYXBfO1xuICB2YXIgaXRlbTtcblxuICBmb3IgKHZhciB1aWQgaW4gdGhpcy5jYWNoZV8pIHtcbiAgICBpdGVtID0gdGhpcy5jYWNoZV9bdWlkXTtcblxuICAgIGlmIChpdGVtLmFjdGl2ZSkge1xuICAgICAgaWYgKCFpdGVtLmludGVyYWN0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBpdGVtLmludGVyYWN0aW9uJyk7XG4gICAgICB9XG5cbiAgICAgIG1hcC5yZW1vdmVJbnRlcmFjdGlvbihpdGVtLmludGVyYWN0aW9uKTtcbiAgICAgIG1hcC5hZGRJbnRlcmFjdGlvbihpdGVtLmludGVyYWN0aW9uKTtcbiAgICB9XG4gIH1cbn07XG5cbkVkaXRpbmdTbmFwcGluZ1NlcnZpY2UucHJvdG90eXBlLnNldE1hcCA9IGZ1bmN0aW9uIChtYXApIHtcbiAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgdmFyIGtleXMgPSB0aGlzLmxpc3RlbmVyS2V5c187XG5cbiAgaWYgKHRoaXMubWFwXykge1xuICAgIGlmICghdGhpcy50cmVlQ3RybHNVbnJlZ2lzdGVyXykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHRyZWVDdHJsc1VucmVnaXN0ZXInKTtcbiAgICB9XG5cbiAgICB0aGlzLnRyZWVDdHJsc1VucmVnaXN0ZXJfKCk7XG4gICAgdGhpcy51bnJlZ2lzdGVyQWxsVHJlZUN0cmxfKCk7XG4gICAga2V5cy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgIGtleXMubGVuZ3RoID0gMDtcbiAgfVxuXG4gIHRoaXMubWFwXyA9IG1hcDtcblxuICBpZiAobWFwKSB7XG4gICAgdGhpcy50cmVlQ3RybHNVbnJlZ2lzdGVyXyA9IHRoaXMucm9vdFNjb3BlXy4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChfdGhpczIuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsKSB7XG4gICAgICAgIHJldHVybiBfdGhpczIuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsLmNoaWxkcmVuO1xuICAgICAgfVxuICAgIH0sIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgX3RoaXMyLnRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCFfdGhpczIuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgX3RoaXMyLnVucmVnaXN0ZXJBbGxUcmVlQ3RybF8oKTtcblxuICAgICAgICAgIF90aGlzMi5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwudHJhdmVyc2VEZXB0aEZpcnN0KF90aGlzMi5yZWdpc3RlclRyZWVDdHJsXy5iaW5kKF90aGlzMikpO1xuICAgICAgICB9XG4gICAgICB9LCAwKTtcbiAgICB9KTtcbiAgICBrZXlzLnB1c2gobGlzdGVuKHRoaXMuZ21mVGhlbWVzXywgJ2NoYW5nZScsIHRoaXMuaGFuZGxlVGhlbWVzQ2hhbmdlXywgdGhpcyksIGxpc3RlbihtYXAsICdtb3ZlZW5kJywgdGhpcy5oYW5kbGVNYXBNb3ZlRW5kXywgdGhpcykpO1xuICB9XG59O1xuXG5FZGl0aW5nU25hcHBpbmdTZXJ2aWNlLnByb3RvdHlwZS5oYW5kbGVUaGVtZXNDaGFuZ2VfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMzID0gdGhpcztcblxuICB0aGlzLm9nY1NlcnZlcnNfID0gbnVsbDtcbiAgdGhpcy5nbWZUaGVtZXNfLmdldE9nY1NlcnZlcnNPYmplY3QoKS50aGVuKGZ1bmN0aW9uIChvZ2NTZXJ2ZXJzKSB7XG4gICAgX3RoaXMzLm9nY1NlcnZlcnNfID0gb2djU2VydmVycztcbiAgfSk7XG59O1xuXG5FZGl0aW5nU25hcHBpbmdTZXJ2aWNlLnByb3RvdHlwZS5yZWdpc3RlclRyZWVDdHJsXyA9IGZ1bmN0aW9uICh0cmVlQ3RybCkge1xuICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICB2YXIgbm9kZSA9IHRyZWVDdHJsLm5vZGU7XG4gIHZhciBncm91cE5vZGUgPSBub2RlO1xuXG4gIGlmIChncm91cE5vZGUuY2hpbGRyZW4pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBub2RlID0gdHJlZUN0cmwubm9kZTtcbiAgdmFyIHNuYXBwaW5nQ29uZmlnID0gZ2V0U25hcHBpbmdDb25maWcobm9kZSk7XG5cbiAgaWYgKHNuYXBwaW5nQ29uZmlnKSB7XG4gICAgdmFyIHdmc0NvbmZpZyA9IHRoaXMuZ2V0V0ZTQ29uZmlnXyh0cmVlQ3RybCk7XG5cbiAgICBpZiAod2ZzQ29uZmlnKSB7XG4gICAgICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKHRyZWVDdHJsKTtcbiAgICAgIHZhciBzdGF0ZVdhdGNoZXJVbnJlZ2lzdGVyID0gdGhpcy5yb290U2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfdGhpczQuaXNTbmFwcGluZ0FjdGl2ZUZvclRyZWVDdHJsXyh0cmVlQ3RybCk7XG4gICAgICB9LCB0aGlzLmhhbmRsZVRyZWVDdHJsU3RhdGVDaGFuZ2VfLmJpbmQodGhpcywgdHJlZUN0cmwpKTtcbiAgICAgIHZhciBvZ2NTZXJ2ZXIgPSB0aGlzLmdldE9HQ1NlcnZlcl8odHJlZUN0cmwpO1xuXG4gICAgICBpZiAoIW9nY1NlcnZlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb2djU2VydmVyJyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY2FjaGVfW3VpZF0gPSB7XG4gICAgICAgIGFjdGl2ZTogZmFsc2UsXG4gICAgICAgIGZlYXR1cmVOUzogb2djU2VydmVyLndmc0ZlYXR1cmVOUyxcbiAgICAgICAgZmVhdHVyZVByZWZpeDogJ2ZlYXR1cmUnLFxuICAgICAgICBmZWF0dXJlczogbmV3IG9sQ29sbGVjdGlvbigpLFxuICAgICAgICBpbnRlcmFjdGlvbjogbnVsbCxcbiAgICAgICAgbWF4RmVhdHVyZXM6IDUwLFxuICAgICAgICByZXF1ZXN0RGVmZXJyZWQ6IG51bGwsXG4gICAgICAgIHNuYXBwaW5nQ29uZmlnOiBzbmFwcGluZ0NvbmZpZyxcbiAgICAgICAgdHJlZUN0cmw6IHRyZWVDdHJsLFxuICAgICAgICB3ZnNDb25maWc6IHdmc0NvbmZpZyxcbiAgICAgICAgc3RhdGVXYXRjaGVyVW5yZWdpc3Rlcjogc3RhdGVXYXRjaGVyVW5yZWdpc3RlclxuICAgICAgfTtcbiAgICAgIHRoaXMuaGFuZGxlVHJlZUN0cmxTdGF0ZUNoYW5nZV8odHJlZUN0cmwsIHRoaXMuaXNTbmFwcGluZ0FjdGl2ZUZvclRyZWVDdHJsXyh0cmVlQ3RybCkpO1xuICAgIH1cbiAgfVxufTtcblxuRWRpdGluZ1NuYXBwaW5nU2VydmljZS5wcm90b3R5cGUudW5yZWdpc3RlckFsbFRyZWVDdHJsXyA9IGZ1bmN0aW9uICgpIHtcbiAgZm9yICh2YXIgdWlkIGluIHRoaXMuY2FjaGVfKSB7XG4gICAgdmFyIGl0ZW0gPSB0aGlzLmNhY2hlX1t1aWRdO1xuXG4gICAgaWYgKGl0ZW0pIHtcbiAgICAgIGl0ZW0uc3RhdGVXYXRjaGVyVW5yZWdpc3RlcigpO1xuICAgICAgdGhpcy5kZWFjdGl2YXRlSXRlbV8oaXRlbSk7XG4gICAgICBkZWxldGUgdGhpcy5jYWNoZV9bdWlkXTtcbiAgICB9XG4gIH1cbn07XG5cbkVkaXRpbmdTbmFwcGluZ1NlcnZpY2UucHJvdG90eXBlLmdldE9HQ1NlcnZlcl8gPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIGdtZkxheWVyID0gdHJlZUN0cmwubm9kZTtcblxuICBpZiAoZ21mTGF5ZXIudHlwZSAhPT0gVGhlbWVOb2RlVHlwZS5XTVMpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHZhciBnbWZMYXllcldNUyA9IGdtZkxheWVyO1xuICB2YXIgb2djU2VydmVyTmFtZTtcbiAgdmFyIGdtZkdyb3VwID0gdHJlZUN0cmwucGFyZW50Lm5vZGU7XG5cbiAgaWYgKGdtZkdyb3VwLm1peGVkKSB7XG4gICAgb2djU2VydmVyTmFtZSA9IGdtZkxheWVyV01TLm9nY1NlcnZlcjtcbiAgfSBlbHNlIHtcbiAgICB2YXIgZmlyc3RUcmVlQ3RybCA9IGdldEZpcnN0UGFyZW50VHJlZSh0cmVlQ3RybCk7XG4gICAgdmFyIGZpcnN0Tm9kZSA9IGZpcnN0VHJlZUN0cmwubm9kZTtcbiAgICBvZ2NTZXJ2ZXJOYW1lID0gZmlyc3ROb2RlLm9nY1NlcnZlcjtcbiAgfVxuXG4gIGlmICghb2djU2VydmVyTmFtZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgaWYgKCF0aGlzLm9nY1NlcnZlcnNfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9nY1NlcnZlcnMnKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzLm9nY1NlcnZlcnNfW29nY1NlcnZlck5hbWVdO1xufTtcblxuRWRpdGluZ1NuYXBwaW5nU2VydmljZS5wcm90b3R5cGUuZ2V0V0ZTQ29uZmlnXyA9IGZ1bmN0aW9uICh0cmVlQ3RybCkge1xuICBpZiAodGhpcy5vZ2NTZXJ2ZXJzXyA9PT0gbnVsbCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmFyIGdtZkxheWVyID0gdHJlZUN0cmwubm9kZTtcblxuICBpZiAoZ21mTGF5ZXIudHlwZSAhPT0gVGhlbWVOb2RlVHlwZS5XTVMpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHZhciBnbWZMYXllcldNUyA9IGdtZkxheWVyO1xuICB2YXIgZmVhdHVyZVR5cGVzID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDAsIGlpID0gZ21mTGF5ZXJXTVMuY2hpbGRMYXllcnMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgIGlmIChnbWZMYXllcldNUy5jaGlsZExheWVyc1tpXS5xdWVyeWFibGUpIHtcbiAgICAgIGZlYXR1cmVUeXBlcy5wdXNoKGdtZkxheWVyV01TLmNoaWxkTGF5ZXJzW2ldLm5hbWUpO1xuICAgIH1cbiAgfVxuXG4gIGlmICghZmVhdHVyZVR5cGVzLmxlbmd0aCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmFyIG9nY1NlcnZlciA9IHRoaXMuZ2V0T0dDU2VydmVyXyh0cmVlQ3RybCk7XG5cbiAgaWYgKCFvZ2NTZXJ2ZXIgfHwgIW9nY1NlcnZlci53ZnNTdXBwb3J0KSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB2YXIgdXJsV2ZzID0gb2djU2VydmVyLnVybFdmcztcblxuICBpZiAoIXVybFdmcykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB1cmxXZnMnKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZmVhdHVyZVR5cGVzOiBmZWF0dXJlVHlwZXMuam9pbignLCcpLFxuICAgIHVybDogdXJsV2ZzXG4gIH07XG59O1xuXG5FZGl0aW5nU25hcHBpbmdTZXJ2aWNlLnByb3RvdHlwZS5pc1NuYXBwaW5nQWN0aXZlRm9yVHJlZUN0cmxfID0gZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gIGlmICh0cmVlQ3RybC5nZXRTdGF0ZSgpICE9PSAnb24nKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKHRyZWVDdHJsLnByb3BlcnRpZXMuc25hcHBpbmcgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICh0eXBlb2YgdHJlZUN0cmwucHJvcGVydGllcy5zbmFwcGluZyAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIHNuYXBwaW5nQWN0aXZlIHR5cGUnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJlZUN0cmwucHJvcGVydGllcy5zbmFwcGluZztcbiAgfVxuXG4gIHZhciBub2RlID0gdHJlZUN0cmwubm9kZTtcbiAgdmFyIGNvbmZpZyA9IGdldFNuYXBwaW5nQ29uZmlnKG5vZGUpO1xuICByZXR1cm4gY29uZmlnICE9PSBudWxsICYmIGNvbmZpZy5hY3RpdmF0ZWQ7XG59O1xuXG5FZGl0aW5nU25hcHBpbmdTZXJ2aWNlLnByb3RvdHlwZS5oYW5kbGVUcmVlQ3RybFN0YXRlQ2hhbmdlXyA9IGZ1bmN0aW9uICh0cmVlQ3RybCwgbmV3VmFsKSB7XG4gIHZhciB1aWQgPSBvbFV0aWxHZXRVaWQodHJlZUN0cmwpO1xuICB2YXIgaXRlbSA9IHRoaXMuY2FjaGVfW3VpZF07XG4gIG5ld1ZhbCA/IHRoaXMuYWN0aXZhdGVJdGVtXyhpdGVtKSA6IHRoaXMuZGVhY3RpdmF0ZUl0ZW1fKGl0ZW0pO1xufTtcblxuRWRpdGluZ1NuYXBwaW5nU2VydmljZS5wcm90b3R5cGUuYWN0aXZhdGVJdGVtXyA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gIGlmICghdGhpcy5tYXBfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICB9XG5cbiAgaWYgKGl0ZW0uYWN0aXZlKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG1hcCA9IHRoaXMubWFwXztcbiAgdmFyIGludGVyYWN0aW9uID0gbmV3IEN1c3RvbVNuYXAoe1xuICAgIGVkZ2U6IGl0ZW0uc25hcHBpbmdDb25maWcuZWRnZSxcbiAgICBmZWF0dXJlczogaXRlbS5mZWF0dXJlcyxcbiAgICBwaXhlbFRvbGVyYW5jZTogaXRlbS5zbmFwcGluZ0NvbmZpZy50b2xlcmFuY2UsXG4gICAgdmVydGV4OiBpdGVtLnNuYXBwaW5nQ29uZmlnLnZlcnRleFxuICB9KTtcbiAgbWFwLmFkZEludGVyYWN0aW9uKGludGVyYWN0aW9uKTtcbiAgaXRlbS5pbnRlcmFjdGlvbiA9IGludGVyYWN0aW9uO1xuICBpdGVtLmFjdGl2ZSA9IHRydWU7XG4gIHRoaXMubG9hZEl0ZW1GZWF0dXJlc18oaXRlbSk7XG59O1xuXG5FZGl0aW5nU25hcHBpbmdTZXJ2aWNlLnByb3RvdHlwZS5kZWFjdGl2YXRlSXRlbV8gPSBmdW5jdGlvbiAoaXRlbSkge1xuICBpZiAoIXRoaXMubWFwXykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgfVxuXG4gIGlmICghaXRlbS5hY3RpdmUpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgbWFwID0gdGhpcy5tYXBfO1xuICB2YXIgaW50ZXJhY3Rpb24gPSBpdGVtLmludGVyYWN0aW9uO1xuXG4gIGlmICghaW50ZXJhY3Rpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgaW50ZXJhY3Rpb24nKTtcbiAgfVxuXG4gIG1hcC5yZW1vdmVJbnRlcmFjdGlvbihpbnRlcmFjdGlvbik7XG4gIGl0ZW0uaW50ZXJhY3Rpb24gPSBudWxsO1xuICBpdGVtLmZlYXR1cmVzLmNsZWFyKCk7XG5cbiAgaWYgKGl0ZW0ucmVxdWVzdERlZmVycmVkKSB7XG4gICAgaXRlbS5yZXF1ZXN0RGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgIGl0ZW0ucmVxdWVzdERlZmVycmVkID0gbnVsbDtcbiAgfVxuXG4gIGl0ZW0uYWN0aXZlID0gZmFsc2U7XG4gIHRoaXMucmVmcmVzaFNuYXBwaW5nU291cmNlXygpO1xufTtcblxuRWRpdGluZ1NuYXBwaW5nU2VydmljZS5wcm90b3R5cGUubG9hZEFsbEl0ZW1zXyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5tYXBWaWV3Q2hhbmdlUHJvbWlzZV8gPSBudWxsO1xuICB2YXIgaXRlbTtcblxuICBmb3IgKHZhciB1aWQgaW4gdGhpcy5jYWNoZV8pIHtcbiAgICBpdGVtID0gdGhpcy5jYWNoZV9bdWlkXTtcblxuICAgIGlmIChpdGVtLmFjdGl2ZSkge1xuICAgICAgdGhpcy5sb2FkSXRlbUZlYXR1cmVzXyhpdGVtKTtcbiAgICB9XG4gIH1cbn07XG5cbkVkaXRpbmdTbmFwcGluZ1NlcnZpY2UucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMubG9hZEFsbEl0ZW1zXygpO1xufTtcblxuRWRpdGluZ1NuYXBwaW5nU2VydmljZS5wcm90b3R5cGUubG9hZEl0ZW1GZWF0dXJlc18gPSBmdW5jdGlvbiAoaXRlbSkge1xuICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICBpZiAoIXRoaXMubWFwXykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgfVxuXG4gIGlmIChpdGVtLnJlcXVlc3REZWZlcnJlZCkge1xuICAgIGl0ZW0ucmVxdWVzdERlZmVycmVkLnJlc29sdmUoKTtcbiAgfVxuXG4gIHZhciBtYXAgPSB0aGlzLm1hcF87XG4gIHZhciB2aWV3ID0gbWFwLmdldFZpZXcoKTtcbiAgdmFyIHNpemUgPSBtYXAuZ2V0U2l6ZSgpO1xuXG4gIGlmICghc2l6ZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBzaXplJyk7XG4gIH1cblxuICB2YXIgZXh0ZW50ID0gdmlldy5jYWxjdWxhdGVFeHRlbnQoc2l6ZSk7XG4gIHZhciBwcm9qQ29kZSA9IHZpZXcuZ2V0UHJvamVjdGlvbigpLmdldENvZGUoKTtcbiAgdmFyIGZlYXR1cmVUeXBlcyA9IGl0ZW0ud2ZzQ29uZmlnLmZlYXR1cmVUeXBlcy5zcGxpdCgnLCcpO1xuICB2YXIgZ2V0RmVhdHVyZU9wdGlvbnMgPSB7XG4gICAgc3JzTmFtZTogcHJvakNvZGUsXG4gICAgZmVhdHVyZU5TOiBpdGVtLmZlYXR1cmVOUyxcbiAgICBmZWF0dXJlUHJlZml4OiBpdGVtLmZlYXR1cmVQcmVmaXgsXG4gICAgZmVhdHVyZVR5cGVzOiBmZWF0dXJlVHlwZXMsXG4gICAgb3V0cHV0Rm9ybWF0OiAnR01MMycsXG4gICAgYmJveDogZXh0ZW50LFxuICAgIGdlb21ldHJ5TmFtZTogREVGQVVMVF9HRU9NRVRSWV9OQU1FLFxuICAgIG1heEZlYXR1cmVzOiBpdGVtLm1heEZlYXR1cmVzXG4gIH07XG4gIHZhciB3ZnNGb3JtYXQgPSBuZXcgb2xGb3JtYXRXRlMoKTtcbiAgdmFyIHhtbFNlcmlhbGl6ZXIgPSBuZXcgWE1MU2VyaWFsaXplcigpO1xuICB2YXIgZmVhdHVyZVJlcXVlc3RYbWwgPSB3ZnNGb3JtYXQud3JpdGVHZXRGZWF0dXJlKGdldEZlYXR1cmVPcHRpb25zKTtcbiAgdmFyIGZlYXR1cmVSZXF1ZXN0ID0geG1sU2VyaWFsaXplci5zZXJpYWxpemVUb1N0cmluZyhmZWF0dXJlUmVxdWVzdFhtbCk7XG4gIHZhciB1cmwgPSBpdGVtLndmc0NvbmZpZy51cmw7XG4gIGl0ZW0ucmVxdWVzdERlZmVycmVkID0gdGhpcy5xXy5kZWZlcigpO1xuICB0aGlzLmh0dHBfLnBvc3QodXJsLCBmZWF0dXJlUmVxdWVzdCwge1xuICAgIHRpbWVvdXQ6IGl0ZW0ucmVxdWVzdERlZmVycmVkLnByb21pc2VcbiAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICBpdGVtLnJlcXVlc3REZWZlcnJlZCA9IG51bGw7XG4gICAgaXRlbS5mZWF0dXJlcy5jbGVhcigpO1xuICAgIHZhciByZWFkRmVhdHVyZXMgPSBuZXcgb2xGb3JtYXRXRlMoKS5yZWFkRmVhdHVyZXMocmVzcG9uc2UuZGF0YSk7XG5cbiAgICBpZiAocmVhZEZlYXR1cmVzKSB7XG4gICAgICBpdGVtLmZlYXR1cmVzLmV4dGVuZChyZWFkRmVhdHVyZXMpO1xuXG4gICAgICBfdGhpczUucmVmcmVzaFNuYXBwaW5nU291cmNlXygpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5FZGl0aW5nU25hcHBpbmdTZXJ2aWNlLnByb3RvdHlwZS5oYW5kbGVNYXBNb3ZlRW5kXyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMubWFwVmlld0NoYW5nZVByb21pc2VfKSB7XG4gICAgdGhpcy50aW1lb3V0Xy5jYW5jZWwodGhpcy5tYXBWaWV3Q2hhbmdlUHJvbWlzZV8pO1xuICB9XG5cbiAgdGhpcy5tYXBWaWV3Q2hhbmdlUHJvbWlzZV8gPSB0aGlzLnRpbWVvdXRfKHRoaXMubG9hZEFsbEl0ZW1zXy5iaW5kKHRoaXMpLCA0MDApO1xufTtcblxuRWRpdGluZ1NuYXBwaW5nU2VydmljZS5wcm90b3R5cGUucmVmcmVzaFNuYXBwaW5nU291cmNlXyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMubmdlb1NuYXBwaW5nU291cmNlXyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5uZ2VvU25hcHBpbmdTb3VyY2VfLmNsZWFyKCk7XG5cbiAgZm9yICh2YXIgdWlkIGluIHRoaXMuY2FjaGVfKSB7XG4gICAgdmFyIGl0ZW0gPSB0aGlzLmNhY2hlX1t1aWRdO1xuXG4gICAgaWYgKGl0ZW0uZmVhdHVyZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmVzJyk7XG4gICAgfVxuXG4gICAgaWYgKGl0ZW0uYWN0aXZlKSB7XG4gICAgICB0aGlzLm5nZW9TbmFwcGluZ1NvdXJjZV8uYWRkRmVhdHVyZXMoaXRlbS5mZWF0dXJlcy5nZXRBcnJheSgpKTtcbiAgICB9XG4gIH1cbn07XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mU25hcHBpbmcnLCBbZ21mTGF5ZXJ0cmVlVHJlZU1hbmFnZXIubmFtZSwgZ21mVGhlbWVUaGVtZXMubmFtZSwgbmdlb0xheWVydHJlZUNvbnRyb2xsZXIubmFtZV0pO1xubW9kdWxlLnNlcnZpY2UoJ2dtZlNuYXBwaW5nJywgRWRpdGluZ1NuYXBwaW5nU2VydmljZSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiRWRpdGluZ1hTREF0dHJpYnV0ZVNlcnZpY2UuJGluamVjdCA9IFtcIiRodHRwXCIsIFwiZ21mTGF5ZXJzVXJsXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb0Zvcm1hdFhTREF0dHJpYnV0ZSBmcm9tICduZ2VvL2Zvcm1hdC9YU0RBdHRyaWJ1dGUuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIEVkaXRpbmdYU0RBdHRyaWJ1dGVTZXJ2aWNlKCRodHRwLCBnbWZMYXllcnNVcmwpIHtcbiAgdGhpcy5odHRwXyA9ICRodHRwO1xuICB0aGlzLmJhc2VVcmxfID0gZ21mTGF5ZXJzVXJsO1xuICB0aGlzLnByb21pc2VzXyA9IHt9O1xufVxuXG5FZGl0aW5nWFNEQXR0cmlidXRlU2VydmljZS5wcm90b3R5cGUuZ2V0QXR0cmlidXRlcyA9IGZ1bmN0aW9uIChpZCkge1xuICBpZiAoIXRoaXMucHJvbWlzZXNfW2lkXSkge1xuICAgIHZhciB1cmwgPSB0aGlzLmJhc2VVcmxfICsgXCIvXCIgKyBpZCArIFwiL21kLnhzZFwiO1xuICAgIHRoaXMucHJvbWlzZXNfW2lkXSA9IHRoaXMuaHR0cF8uZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgICAgcmV0dXJuIG5ldyBuZ2VvRm9ybWF0WFNEQXR0cmlidXRlKCkucmVhZChyZXNwLmRhdGEpO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMucHJvbWlzZXNfW2lkXTtcbn07XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mWFNEQXR0cmlidXRlcycsIFtdKTtcbm1vZHVsZS5zZXJ2aWNlKCdnbWZYU0RBdHRyaWJ1dGVzJywgRWRpdGluZ1hTREF0dHJpYnV0ZVNlcnZpY2UpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXY+XFxuICA8ZGl2IG5nLXN3aXRjaD1cImVmQ3RybC5mZWF0dXJlXCI+XFxuICAgIDxhXFxuICAgICAgbmctc3dpdGNoLXdoZW49XCJudWxsXCJcXG4gICAgICBuZy1pZj1cImVmQ3RybC5nZW9tVHlwZVwiXFxuICAgICAgaHJlZlxcbiAgICAgIG5nZW8tYnRuXFxuICAgICAgbmdlby1jcmVhdGVmZWF0dXJlXFxuICAgICAgbmdlby1jcmVhdGVmZWF0dXJlLWFjdGl2ZT1cImVmQ3RybC5jcmVhdGVBY3RpdmVcIlxcbiAgICAgIG5nZW8tY3JlYXRlZmVhdHVyZS1mZWF0dXJlcz1cIjo6ZWZDdHJsLmZlYXR1cmVzXCJcXG4gICAgICBuZ2VvLWNyZWF0ZWZlYXR1cmUtZ2VvbS10eXBlPVwiOjplZkN0cmwuZ2VvbVR5cGVcIlxcbiAgICAgIG5nZW8tY3JlYXRlZmVhdHVyZS1tYXA9XCI6OmVmQ3RybC5tYXBcIlxcbiAgICAgIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0XCJcXG4gICAgICBuZy1jbGFzcz1cInthY3RpdmU6IGVmQ3RybC5jcmVhdGVBY3RpdmV9XCJcXG4gICAgICBuZy1tb2RlbD1cImVmQ3RybC5jcmVhdGVBY3RpdmVcIj5cXG4gICAgICA8c3BhbiBuZy1zd2l0Y2g9XCI6OmVmQ3RybC5nZW9tVHlwZVwiPlxcbiAgICAgICAgPHNwYW4gbmctc3dpdGNoLXdoZW49XCJQb2ludFwiPlxcbiAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9wb2ludC5zdmc/dmlld2JveCZoZWlnaHQ9MWVtJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbidcXG4gICAgICAgICAge3tcXCdEcmF3IG5ldyBwb2ludFxcJyB8IHRyYW5zbGF0ZX19XFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgICA8c3BhbiBuZy1zd2l0Y2gtd2hlbj1cIk11bHRpUG9pbnRcIj5cXG4gICAgICAgICAgJyArXG4oKF9fdCA9IChyZXF1aXJlKCdnbWYvaWNvbnMvcG9pbnQuc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICAgICAgICAgIHt7XFwnRHJhdyBuZXcgcG9pbnRcXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgPHNwYW4gbmctc3dpdGNoLXdoZW49XCJMaW5lU3RyaW5nXCI+XFxuICAgICAgICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL2xpbmUuc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICAgICAgICAgIHt7XFwnRHJhdyBuZXcgbGluZXN0cmluZ1xcJyB8IHRyYW5zbGF0ZX19XFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgICA8c3BhbiBuZy1zd2l0Y2gtd2hlbj1cIk11bHRpTGluZVN0cmluZ1wiPlxcbiAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9saW5lLnN2Zz92aWV3Ym94JmhlaWdodD0xZW0nKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgICAgICAgICB7e1xcJ0RyYXcgbmV3IGxpbmVzdHJpbmdcXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgPHNwYW4gbmctc3dpdGNoLXdoZW49XCJQb2x5Z29uXCI+XFxuICAgICAgICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL3BvbHlnb24uc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICAgICAgICAgIHt7XFwnRHJhdyBuZXcgcG9seWdvblxcJyB8IHRyYW5zbGF0ZX19XFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgICA8c3BhbiBuZy1zd2l0Y2gtd2hlbj1cIk11bHRpUG9seWdvblwiPlxcbiAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9wb2x5Z29uLnN2Zz92aWV3Ym94JmhlaWdodD0xZW0nKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgICAgICAgICB7e1xcJ0RyYXcgbmV3IHBvbHlnb25cXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgICAgPC9zcGFuPlxcbiAgICAgIDwvc3Bhbj5cXG4gICAgPC9hPlxcbiAgICA8ZGl2IG5nLXN3aXRjaC1kZWZhdWx0PlxcbiAgICAgIDxmb3JtXFxuICAgICAgICBub3ZhbGlkYXRlXFxuICAgICAgICBuYW1lPVwiZm9ybVwiXFxuICAgICAgICBjbGFzcz1cImZvcm0gZ21mLWVkaXRmZWF0dXJlLWF0dHJpYnV0ZXMtY29udGFpbmVyXCJcXG4gICAgICAgIG5nLWlmPVwiZWZDdHJsLmF0dHJpYnV0ZXNcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1zbS0xMlwiPlxcbiAgICAgICAgICAgIDxhXFxuICAgICAgICAgICAgICBjbGFzcz1cImNsb3NlXCJcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiZWZDdHJsLmNhbmNlbCgpXCJcXG4gICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwiZWZDdHJsLnBlbmRpbmdcIlxcbiAgICAgICAgICAgICAgdGl0bGU9XCJ7e1xcJ0NhbmNlbCBtb2RpZmljYXRpb25zXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICAgICAgICAgICAgaHJlZj4mdGltZXM7PC9hPlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPG5nZW8tYXR0cmlidXRlc1xcbiAgICAgICAgICBuZ2VvLWF0dHJpYnV0ZXMtYXR0cmlidXRlcz1cIjo6ZWZDdHJsLmF0dHJpYnV0ZXNcIlxcbiAgICAgICAgICBuZ2VvLWF0dHJpYnV0ZXMtZGlzYWJsZWQ9XCJlZkN0cmwucGVuZGluZ1wiXFxuICAgICAgICAgIG5nZW8tYXR0cmlidXRlcy1mZWF0dXJlPVwiOjplZkN0cmwuZmVhdHVyZVwiPlxcbiAgICAgICAgPC9uZ2VvLWF0dHJpYnV0ZXM+XFxuICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXFxuICAgICAgICAgIHZhbHVlPVwie3tcXCdTYXZlXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICAgICAgICBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRlZmF1bHQgZ21mLWVkaXRmZWF0dXJlLWJ0bi1zYXZlXCJcXG4gICAgICAgICAgbmctY2xpY2s9XCJmb3JtLiR2YWxpZCAmJiBlZkN0cmwuc2F2ZSgpXCJcXG4gICAgICAgICAgbmctZGlzYWJsZWQ9XCIhZWZDdHJsLmRpcnR5IHx8IGVmQ3RybC5wZW5kaW5nXCJcXG4gICAgICAgICAgdGl0bGU9XCJ7e1xcJ1NhdmUgbW9kaWZpY2F0aW9uc1xcJyB8IHRyYW5zbGF0ZX19XCI+PC9pbnB1dD5cXG4gICAgICAgIDxhXFxuICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCBnbWYtZWRpdGZlYXR1cmUtYnRuLWNhbmNlbFwiXFxuICAgICAgICAgIG5nLWNsaWNrPVwiZWZDdHJsLmNvbmZpcm1DYW5jZWwoKVwiXFxuICAgICAgICAgIG5nLWRpc2FibGVkPVwiZWZDdHJsLnBlbmRpbmdcIlxcbiAgICAgICAgICB0aXRsZT1cInt7XFwnQ2FuY2VsIG1vZGlmaWNhdGlvbnNcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgICAgICAgIGhyZWY+e3tcXCdDYW5jZWxcXCcgfCB0cmFuc2xhdGV9fTwvYT5cXG4gICAgICAgIDxidXR0b25cXG4gICAgICAgICAgY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1saW5rIGdtZi1lZGl0ZmVhdHVyZS1idG4tZGVsZXRlXCJcXG4gICAgICAgICAgbmctY2xpY2s9XCJlZkN0cmwuZGVsZXRlKClcIlxcbiAgICAgICAgICBuZy1kaXNhYmxlZD1cImVmQ3RybC5wZW5kaW5nXCJcXG4gICAgICAgICAgbmctc2hvdz1cImVmQ3RybC5mZWF0dXJlSWRcIlxcbiAgICAgICAgICB0aXRsZT1cInt7XFwnRGVsZXRlIHRoaXMgZmVhdHVyZVxcJyB8IHRyYW5zbGF0ZX19XCI+XFxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZmEgZmEtdHJhc2hcIj48L3NwYW4+XFxuICAgICAgICAgIHt7XFwnRGVsZXRlXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgICAgIDwvYnV0dG9uPlxcbiAgICAgIDwvZm9ybT5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG4gIDxuZ2VvLW1vZGFsIG5nLW1vZGVsPVwiZWZDdHJsLnVuc2F2ZWRNb2RpZmljYXRpb25zTW9kYWxTaG93blwiPlxcbiAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyIHVpLWRyYWdnYWJsZS1oYW5kbGVcIj5cXG4gICAgICA8aDQgY2xhc3M9XCJtb2RhbC10aXRsZVwiPnt7XFwnVW5zYXZlZCBtb2RpZmljYXRpb25zIVxcJyB8IHRyYW5zbGF0ZX19PC9oND5cXG4gICAgICA8YnV0dG9uXFxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICBjbGFzcz1cImNsb3NlXCJcXG4gICAgICAgICAgZGF0YS1kaXNtaXNzPVwibW9kYWxcIlxcbiAgICAgICAgICBhcmlhLWxhYmVsPVwie3tcXCdDbG9zZVxcJyB8IHRyYW5zbGF0ZX19XCI+XFxuICAgICAgICA8c3BhbiBhcmlhLWhpZGRlbj1cInRydWVcIj4mdGltZXM7PC9zcGFuPlxcbiAgICAgIDwvYnV0dG9uPlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cXG4gICAgICB7e1xcJ1RoZXJlIGFyZSB1bnNhdmVkIGNoYW5nZXMuXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cXG4gICAgICA8YnV0dG9uXFxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdFwiXFxuICAgICAgICAgIGRhdGEtZGlzbWlzcz1cIm1vZGFsXCJcXG4gICAgICAgICAgbmctY2xpY2s9XCJlZkN0cmwuY29udGludWVXaXRob3V0U2F2aW5nKClcIj5cXG4gICAgICAgIHt7XFwnQ29udGludWUgd2l0aG91dCBzYXZpbmdcXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgIDwvYnV0dG9uPlxcbiAgICAgIDxidXR0b25cXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgICAgIGNsYXNzPVwiYnRuIHByaW1lXCJcXG4gICAgICAgICAgZGF0YS1kaXNtaXNzPVwibW9kYWxcIj5cXG4gICAgICAgIHt7XFwnQ2FuY2VsXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgICA8L2J1dHRvbj5cXG4gICAgICA8YnV0dG9uXFxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdFwiXFxuICAgICAgICAgIGRhdGEtZGlzbWlzcz1cIm1vZGFsXCJcXG4gICAgICAgICAgbmctY2xpY2s9XCJlZkN0cmwuc3VibWl0KClcIj5cXG4gICAgICAgIHt7XFwnU2F2ZVxcJyB8IHRyYW5zbGF0ZX19XFxuICAgICAgPC9idXR0b24+XFxuICAgIDwvZGl2PlxcbiAgPC9uZ2VvLW1vZGFsPlxcbiAgPG5nZW8tbW9kYWwgbmctbW9kZWw9XCJlZkN0cmwuc2hvd1NlcnZlckVycm9yXCI+XFxuICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXIgdWktZHJhZ2dhYmxlLWhhbmRsZVwiPnt7XFwnU2VydmVyIGVycm9yLlxcJyB8IHRyYW5zbGF0ZX19PC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+e3tlZkN0cmwuc2VydmVyRXJyb3JUeXBlfX08YnI+XFxuICAgIHt7ZWZDdHJsLnNlcnZlckVycm9yTWVzc2FnZSB8fCAoXFwnVW5leHBlY3RlZCBzZXJ2ZXIgZXJyb3IuXFwnIHwgdHJhbnNsYXRlKX19PC9kaXY+XFxuICA8L25nZW8tbW9kYWw+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsIkNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRlbGVtZW50XCIsIFwiJHFcIiwgXCIkc2NvcGVcIiwgXCIkdGltZW91dFwiLCBcImdldHRleHRDYXRhbG9nXCIsIFwiZ21mRWRpdEZlYXR1cmVcIiwgXCJnbWZTbmFwcGluZ1wiLCBcImdtZlhTREF0dHJpYnV0ZXNcIiwgXCJuZ2VvRXZlbnRIZWxwZXJcIiwgXCJuZ2VvRmVhdHVyZUhlbHBlclwiLCBcIm5nZW9MYXllckhlbHBlclwiLCBcIm5nZW9Ub29sQWN0aXZhdGVNZ3JcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZFZGl0aW5nRWRpdEZlYXR1cmUgZnJvbSAnZ21mL2VkaXRpbmcvRWRpdEZlYXR1cmUuanMnO1xuaW1wb3J0IGdtZkVkaXRpbmdTbmFwcGluZyBmcm9tICdnbWYvZWRpdGluZy9TbmFwcGluZy5qcyc7XG5pbXBvcnQgZ21mRWRpdGluZ1hTREF0dHJpYnV0ZXMgZnJvbSAnZ21mL2VkaXRpbmcvWFNEQXR0cmlidXRlcy5qcyc7XG5pbXBvcnQgeyBnZXRMYXllciBhcyBzeW5jTGF5ZXJ0cmVlTWFwR2V0TGF5ZXIgfSBmcm9tICdnbWYvbGF5ZXJ0cmVlL1N5bmNMYXllcnRyZWVNYXAuanMnO1xuaW1wb3J0IERhdGVGb3JtYXR0ZXIgZnJvbSAnbmdlby9taXNjL3BocC1kYXRlLWZvcm1hdHRlci5qcyc7XG5pbXBvcnQgJ2pxdWVyeS1kYXRldGltZXBpY2tlci9qcXVlcnkuZGF0ZXRpbWVwaWNrZXIuanMnO1xuaW1wb3J0ICdqcXVlcnktZGF0ZXRpbWVwaWNrZXIvanF1ZXJ5LmRhdGV0aW1lcGlja2VyLmNzcyc7XG5pbXBvcnQgbmdlb0VkaXRpbmdBdHRyaWJ1dGVzQ29tcG9uZW50IGZyb20gJ25nZW8vZWRpdGluZy9hdHRyaWJ1dGVzQ29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvRWRpdGluZ0NyZWF0ZWZlYXR1cmVDb21wb25lbnQgZnJvbSAnbmdlby9lZGl0aW5nL2NyZWF0ZWZlYXR1cmVDb21wb25lbnQuanMnO1xuaW1wb3J0IHsgZGVsZXRlQ29uZGl0aW9uIH0gZnJvbSAnbmdlby91dGlscy5qcyc7XG5pbXBvcnQgeyBnZXRHZW9tZXRyeUF0dHJpYnV0ZSB9IGZyb20gJ25nZW8vZm9ybWF0L1hTREF0dHJpYnV0ZS5qcyc7XG5pbXBvcnQgbmdlb0dlb21ldHJ5VHlwZSBmcm9tICduZ2VvL0dlb21ldHJ5VHlwZS5qcyc7XG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uUm90YXRlIGZyb20gJ25nZW8vaW50ZXJhY3Rpb24vUm90YXRlLmpzJztcbmltcG9ydCBuZ2VvSW50ZXJhY3Rpb25UcmFuc2xhdGUgZnJvbSAnbmdlby9pbnRlcmFjdGlvbi9UcmFuc2xhdGUuanMnO1xuaW1wb3J0IG5nZW9NYXBMYXllckhlbHBlciBmcm9tICduZ2VvL21hcC9MYXllckhlbHBlci5qcyc7XG5pbXBvcnQgbmdlb01lbnUgZnJvbSAnbmdlby9NZW51LmpzJztcbmltcG9ydCBuZ2VvTWVzc2FnZU1vZGFsQ29tcG9uZW50IGZyb20gJ25nZW8vbWVzc2FnZS9tb2RhbENvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb01pc2NCdG5Db21wb25lbnQgZnJvbSAnbmdlby9taXNjL2J0bkNvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBpbnRlcmFjdGlvbkRlY29yYXRpb24gYXMgbmdlb01pc2NEZWNvcmF0ZUludGVyYWN0aW9uIH0gZnJvbSAnbmdlby9taXNjL2RlY29yYXRlLmpzJztcbmltcG9ydCBuZ2VvTWlzY0V2ZW50SGVscGVyIGZyb20gJ25nZW8vbWlzYy9FdmVudEhlbHBlci5qcyc7XG5pbXBvcnQgbmdlb01pc2NGZWF0dXJlSGVscGVyIGZyb20gJ25nZW8vbWlzYy9GZWF0dXJlSGVscGVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSBmcm9tICduZ2VvL21pc2MvVG9vbEFjdGl2YXRlLmpzJztcbmltcG9ydCBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZU1nciBmcm9tICduZ2VvL21pc2MvVG9vbEFjdGl2YXRlTWdyLmpzJztcbmltcG9ydCB7IGdldFVpZCBhcyBvbFV0aWxHZXRVaWQgfSBmcm9tICdvbC91dGlsLmpzJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4sIHVubGlzdGVuQnlLZXkgfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0ICogYXMgb2xFeHRlbnQgZnJvbSAnb2wvZXh0ZW50LmpzJztcbmltcG9ydCBvbEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgb2xGb3JtYXRHZW9KU09OIGZyb20gJ29sL2Zvcm1hdC9HZW9KU09OLmpzJztcbmltcG9ydCBvbEludGVyYWN0aW9uTW9kaWZ5IGZyb20gJ29sL2ludGVyYWN0aW9uL01vZGlmeS5qcyc7XG5pbXBvcnQgb2xMYXllckltYWdlIGZyb20gJ29sL2xheWVyL0ltYWdlLmpzJztcbmltcG9ydCBvbExheWVyVGlsZSBmcm9tICdvbC9sYXllci9UaWxlLmpzJztcbmltcG9ydCBvbFN0eWxlRmlsbCBmcm9tICdvbC9zdHlsZS9GaWxsLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xuaW1wb3J0IG9sU3R5bGVUZXh0IGZyb20gJ29sL3N0eWxlL1RleHQuanMnO1xuaW1wb3J0IE1hcEJyb3dzZXJFdmVudCBmcm9tICdvbC9NYXBCcm93c2VyRXZlbnQuanMnO1xuaW1wb3J0IHsgQ29sbGVjdGlvbkV2ZW50IH0gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgVmVjdG9yU291cmNlIGZyb20gJ29sL3NvdXJjZS9WZWN0b3IuanMnO1xuZXhwb3J0IHZhciBFZGl0aW5nU3RhdGUgPSB7XG4gIElETEU6ICdpZGxlJyxcbiAgREVBQ1RJVkFURV9FWEVDVVRFOiAnZGVhY3RpdmF0ZV9leGVjdXRlJyxcbiAgREVBQ1RJVkFURV9QRU5ESU5HOiAnZGVhY3RpdmF0ZV9wZW5kaW5nJyxcbiAgU1RPUF9FRElUSU5HX0VYRUNVVEU6ICdzdG9wX2VkaXRpbmdfZXhlY3V0ZScsXG4gIFNUT1BfRURJVElOR19QRU5ESU5HOiAnc3RvcF9lZGl0aW5nX3BlbmRpbmcnXG59O1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdHbWZFZGl0aW5nRmVhdHVyZUNvbXBvbmVudCcsIFtnbWZFZGl0aW5nRWRpdEZlYXR1cmUubmFtZSwgZ21mRWRpdGluZ1NuYXBwaW5nLm5hbWUsIGdtZkVkaXRpbmdYU0RBdHRyaWJ1dGVzLm5hbWUsIG5nZW9FZGl0aW5nQXR0cmlidXRlc0NvbXBvbmVudC5uYW1lLCBuZ2VvRWRpdGluZ0NyZWF0ZWZlYXR1cmVDb21wb25lbnQubmFtZSwgbmdlb01hcExheWVySGVscGVyLm5hbWUsIG5nZW9NZXNzYWdlTW9kYWxDb21wb25lbnQubmFtZSwgbmdlb01pc2NCdG5Db21wb25lbnQubmFtZSwgbmdlb01pc2NFdmVudEhlbHBlci5uYW1lLCBuZ2VvTWlzY0ZlYXR1cmVIZWxwZXIubmFtZSwgbmdlb01pc2NUb29sQWN0aXZhdGVNZ3IubmFtZV0pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdnbWYvZWRpdGluZy9lZGl0RmVhdHVyZUNvbXBvbmVudCcsIHJlcXVpcmUoJy4vZWRpdEZlYXR1cmVDb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcblxuZnVuY3Rpb24gZWRpdGluZ0VkaXRGZWF0dXJlQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIGNvbnRyb2xsZXI6ICdHbWZFZGl0ZmVhdHVyZUNvbnRyb2xsZXIgYXMgZWZDdHJsJyxcbiAgICBzY29wZToge1xuICAgICAgJ2RpcnR5JzogJz1nbWZFZGl0ZmVhdHVyZURpcnR5JyxcbiAgICAgICdlZGl0YWJsZVRyZWVDdHJsJzogJz1nbWZFZGl0ZmVhdHVyZUVkaXRhYmxldHJlZWN0cmwnLFxuICAgICAgJ21hcCc6ICc8Z21mRWRpdGZlYXR1cmVNYXAnLFxuICAgICAgJ3N0YXRlJzogJz1nbWZFZGl0ZmVhdHVyZVN0YXRlJyxcbiAgICAgICd0b2xlcmFuY2UnOiAnPD9nbWZFZGl0ZmVhdHVyZVRvbGVyYW5jZScsXG4gICAgICAndmVjdG9yTGF5ZXInOiAnPGdtZkVkaXRmZWF0dXJlVmVjdG9yJyxcbiAgICAgICdjbG9zZUFmdGVyU2F2ZSc6ICc9P2dtZkVkaXRmZWF0dXJlQ2xvc2VhZnRlcnNhdmUnXG4gICAgfSxcbiAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgIHRlbXBsYXRlVXJsOiAnZ21mL2VkaXRpbmcvZWRpdEZlYXR1cmVDb21wb25lbnQnXG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ2dtZkVkaXRmZWF0dXJlJywgZWRpdGluZ0VkaXRGZWF0dXJlQ29tcG9uZW50KTtcblxuZnVuY3Rpb24gQ29udHJvbGxlcigkZWxlbWVudCwgJHEsICRzY29wZSwgJHRpbWVvdXQsIGdldHRleHRDYXRhbG9nLCBnbWZFZGl0RmVhdHVyZSwgZ21mU25hcHBpbmcsIGdtZlhTREF0dHJpYnV0ZXMsIG5nZW9FdmVudEhlbHBlciwgbmdlb0ZlYXR1cmVIZWxwZXIsIG5nZW9MYXllckhlbHBlciwgbmdlb1Rvb2xBY3RpdmF0ZU1ncikge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHRoaXMuZGlydHkgPSBmYWxzZTtcbiAgdGhpcy5lZGl0YWJsZVRyZWVDdHJsID0gbnVsbDtcbiAgdGhpcy5tYXAgPSBudWxsO1xuICB0aGlzLnN0YXRlID0gJyc7XG4gIHRoaXMudG9sZXJhbmNlID0gMDtcbiAgdGhpcy52ZWN0b3JMYXllciA9IG51bGw7XG4gIHRoaXMuY2xvc2VBZnRlclNhdmUgPSBmYWxzZTtcbiAgdGhpcy5lbGVtZW50XyA9ICRlbGVtZW50O1xuICB0aGlzLnFfID0gJHE7XG4gIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICB0aGlzLnRpbWVvdXRfID0gJHRpbWVvdXQ7XG4gIHRoaXMuZ2V0dGV4dENhdGFsb2dfID0gZ2V0dGV4dENhdGFsb2c7XG4gIHRoaXMuZ21mRWRpdEZlYXR1cmVfID0gZ21mRWRpdEZlYXR1cmU7XG4gIHRoaXMuZ21mU25hcHBpbmdfID0gZ21mU25hcHBpbmc7XG4gIHRoaXMuZ21mWFNEQXR0cmlidXRlc18gPSBnbWZYU0RBdHRyaWJ1dGVzO1xuICB0aGlzLm5nZW9FdmVudEhlbHBlcl8gPSBuZ2VvRXZlbnRIZWxwZXI7XG4gIHRoaXMubmdlb0ZlYXR1cmVIZWxwZXJfID0gbmdlb0ZlYXR1cmVIZWxwZXI7XG4gIHRoaXMubmdlb0xheWVySGVscGVyXyA9IG5nZW9MYXllckhlbHBlcjtcbiAgdGhpcy5uZ2VvVG9vbEFjdGl2YXRlTWdyXyA9IG5nZW9Ub29sQWN0aXZhdGVNZ3I7XG4gIHRoaXMuZWRpdGFibGVOb2RlXyA9IG51bGw7XG4gIHRoaXMuZWRpdGFibGVXTVNMYXllcl8gPSBudWxsO1xuICB0aGlzLmNvbmZpcm1EZWZlcnJlZF8gPSBudWxsO1xuICB0aGlzLnVuc2F2ZWRNb2RpZmljYXRpb25zTW9kYWxTaG93biA9IGZhbHNlO1xuICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICB0aGlzLmNyZWF0ZUFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLmNyZWF0ZVRvb2xBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSh0aGlzLCAnY3JlYXRlQWN0aXZlJyk7XG4gIHRoaXMubWFwU2VsZWN0QWN0aXZlID0gdHJ1ZTtcbiAgdGhpcy5tYXBTZWxlY3RUb29sQWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUodGhpcywgJ21hcFNlbGVjdEFjdGl2ZScpO1xuICB0aGlzLmZlYXR1cmUgPSBudWxsO1xuICB0aGlzLnNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5mZWF0dXJlO1xuICB9LCB0aGlzLmhhbmRsZUZlYXR1cmVDaGFuZ2VfLmJpbmQodGhpcykpO1xuICB0aGlzLmZlYXR1cmVJZCA9IHVuZGVmaW5lZDtcbiAgdGhpcy5mZWF0dXJlcyA9IG51bGw7XG4gIHRoaXMuaW50ZXJhY3Rpb25zXyA9IG5ldyBvbENvbGxlY3Rpb24oKTtcbiAgdGhpcy5tb2RpZnlfID0gbnVsbDtcbiAgdGhpcy5tb2RpZnlUb29sQWN0aXZhdGUgPSBudWxsO1xuICB0aGlzLm1lbnVfID0gbmV3IG5nZW9NZW51KHtcbiAgICBhY3Rpb25zOiBbe1xuICAgICAgY2xzOiAnZmFzIGZhLWFycm93cy1hbHQnLFxuICAgICAgbGFiZWw6IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnTW92ZScpLFxuICAgICAgbmFtZTogJ21vdmUnXG4gICAgfSwge1xuICAgICAgY2xzOiAnZmFzIGZhLXVuZG8gZmEtZmxpcC1ob3Jpem9udGFsJyxcbiAgICAgIGxhYmVsOiBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1JvdGF0ZScpLFxuICAgICAgbmFtZTogJ3JvdGF0ZSdcbiAgICB9XVxuICB9KTtcbiAgdGhpcy5tZW51VmVydGV4XyA9IG5ldyBuZ2VvTWVudSh7XG4gICAgYWN0aW9uczogW3tcbiAgICAgIGNsczogJ2ZhIGZhLXRyYXNoJyxcbiAgICAgIGxhYmVsOiBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0RlbGV0ZSB2ZXJ0ZXgnKSxcbiAgICAgIG5hbWU6ICdkZWxldGUnXG4gICAgfV1cbiAgfSk7XG4gIHRoaXMudHJhbnNsYXRlXyA9IG51bGw7XG4gIHRoaXMucm90YXRlXyA9IG51bGw7XG4gIHRoaXMucm90YXRlVG9vbEFjdGl2YXRlID0gbnVsbDtcbiAgdGhpcy50cmFuc2xhdGVUb29sQWN0aXZhdGUgPSBudWxsO1xuICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgdGhpcy5nZW9tTGlzdGVuZXJLZXlzXyA9IFtdO1xuICB0aGlzLm1hcExpc3RlbmVyS2V5c18gPSBbXTtcbiAgdGhpcy5hdHRyaWJ1dGVzID0gbnVsbDtcbiAgdGhpcy5nZW9tVHlwZSA9IG51bGw7XG4gIHRoaXMuc2hvd1NlcnZlckVycm9yID0gZmFsc2U7XG4gIHRoaXMuc2VydmVyRXJyb3JNZXNzYWdlID0gbnVsbDtcbiAgdGhpcy5zZXJ2ZXJFcnJvclR5cGUgPSBudWxsO1xuICB0aGlzLnZlcnRleEluZm9fID0gbnVsbDtcbn1cblxuQ29udHJvbGxlci5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgaWYgKCF0aGlzLm1hcCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgfVxuXG4gIHZhciBsYW5nID0gdGhpcy5nZXR0ZXh0Q2F0YWxvZ18uZ2V0Q3VycmVudExhbmd1YWdlKCk7XG4gICQuZGF0ZXRpbWVwaWNrZXIuc2V0TG9jYWxlKGxhbmcpO1xuICAkLmRhdGV0aW1lcGlja2VyLnNldERhdGVGb3JtYXR0ZXIobmV3IERhdGVGb3JtYXR0ZXIoKSk7XG4gIHRoaXMuZGlydHkgPSB0aGlzLmRpcnR5ID09PSB0cnVlO1xuXG4gIGlmICghdGhpcy5lZGl0YWJsZVRyZWVDdHJsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGVkaXRhYmxlVHJlZUN0cmwnKTtcbiAgfVxuXG4gIHRoaXMuZWRpdGFibGVOb2RlXyA9IHRoaXMuZWRpdGFibGVUcmVlQ3RybC5ub2RlO1xuXG4gIGlmICghdGhpcy52ZWN0b3JMYXllcikge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB2ZWN0b3JMYXllcicpO1xuICB9XG5cbiAgdmFyIHNvdXJjZSA9IHRoaXMudmVjdG9yTGF5ZXIuZ2V0U291cmNlKCk7XG5cbiAgaWYgKCEoc291cmNlIGluc3RhbmNlb2YgVmVjdG9yU291cmNlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignV3Jvbmcgc291cmNlJyk7XG4gIH1cblxuICB0aGlzLmZlYXR1cmVzID0gc291cmNlLmdldEZlYXR1cmVzQ29sbGVjdGlvbigpO1xuICB0aGlzLnRvbGVyYW5jZSA9IHRoaXMudG9sZXJhbmNlIHx8IDEwO1xuICB2YXIgbGF5ZXIgPSBzeW5jTGF5ZXJ0cmVlTWFwR2V0TGF5ZXIodGhpcy5lZGl0YWJsZVRyZWVDdHJsKTtcblxuICBpZiAobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVySW1hZ2UgfHwgbGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyVGlsZSkge1xuICAgIHRoaXMuZWRpdGFibGVXTVNMYXllcl8gPSBsYXllcjtcbiAgfVxuXG4gIHRoaXMubW9kaWZ5XyA9IG5ldyBvbEludGVyYWN0aW9uTW9kaWZ5KHtcbiAgICBkZWxldGVDb25kaXRpb246IGRlbGV0ZUNvbmRpdGlvbixcbiAgICBmZWF0dXJlczogdGhpcy5mZWF0dXJlcyxcbiAgICBzdHlsZTogdGhpcy5uZ2VvRmVhdHVyZUhlbHBlcl8uZ2V0VmVydGV4U3R5bGUoZmFsc2UpXG4gIH0pO1xuICB0aGlzLmludGVyYWN0aW9uc18ucHVzaCh0aGlzLm1vZGlmeV8pO1xuICB0aGlzLnJvdGF0ZV8gPSBuZXcgbmdlb0ludGVyYWN0aW9uUm90YXRlKHtcbiAgICBmZWF0dXJlczogdGhpcy5mZWF0dXJlcyxcbiAgICBzdHlsZTogbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICB0ZXh0OiBuZXcgb2xTdHlsZVRleHQoe1xuICAgICAgICB0ZXh0OiBcIlxcdUYwMUVcIixcbiAgICAgICAgZm9udDogJzkwMCAxOHB4IFwiRm9udCBBd2Vzb21lIDUgRnJlZVwiJyxcbiAgICAgICAgZmlsbDogbmV3IG9sU3R5bGVGaWxsKHtcbiAgICAgICAgICBjb2xvcjogJyM3YTdhN2EnXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH0pO1xuICB0aGlzLmludGVyYWN0aW9uc18ucHVzaCh0aGlzLnJvdGF0ZV8pO1xuICB0aGlzLnRyYW5zbGF0ZV8gPSBuZXcgbmdlb0ludGVyYWN0aW9uVHJhbnNsYXRlKHtcbiAgICBmZWF0dXJlczogdGhpcy5mZWF0dXJlcyxcbiAgICBzdHlsZTogbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICB0ZXh0OiBuZXcgb2xTdHlsZVRleHQoe1xuICAgICAgICB0ZXh0OiBcIlxcdUYwQjJcIixcbiAgICAgICAgZm9udDogJzkwMCAxOHB4IFwiRm9udCBBd2Vzb21lIDUgRnJlZVwiJyxcbiAgICAgICAgZmlsbDogbmV3IG9sU3R5bGVGaWxsKHtcbiAgICAgICAgICBjb2xvcjogJyM3YTdhN2EnXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH0pO1xuICB0aGlzLmludGVyYWN0aW9uc18ucHVzaCh0aGlzLnRyYW5zbGF0ZV8pO1xuICB0aGlzLmluaXRpYWxpemVJbnRlcmFjdGlvbnNfKCk7XG4gIHRoaXMubW9kaWZ5VG9vbEFjdGl2YXRlID0gbmV3IG5nZW9NaXNjVG9vbEFjdGl2YXRlKHRoaXMubW9kaWZ5XywgJ2FjdGl2ZScpO1xuICB0aGlzLnJvdGF0ZVRvb2xBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSh0aGlzLnJvdGF0ZV8sICdhY3RpdmUnKTtcbiAgdGhpcy50cmFuc2xhdGVUb29sQWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUodGhpcy50cmFuc2xhdGVfLCAnYWN0aXZlJyk7XG4gIHRoaXMubWFwLmFkZE92ZXJsYXkodGhpcy5tZW51Xyk7XG4gIHRoaXMubWFwLmFkZE92ZXJsYXkodGhpcy5tZW51VmVydGV4Xyk7XG4gIHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIF90aGlzMi5jcmVhdGVBY3RpdmU7XG4gIH0sIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xuICAgIGlmIChuZXdWYWwpIHtcbiAgICAgIF90aGlzMi5nbWZTbmFwcGluZ18uZW5zdXJlU25hcEludGVyYWN0aW9uc09uVG9wKCk7XG4gICAgfVxuICB9KTtcbiAgdGhpcy5zY29wZV8uJG9uKCckZGVzdHJveScsIHRoaXMuaGFuZGxlRGVzdHJveV8uYmluZCh0aGlzKSk7XG4gIHZhciB1aWQgPSBvbFV0aWxHZXRVaWQodGhpcyk7XG4gIHRoaXMubmdlb0V2ZW50SGVscGVyXy5hZGRMaXN0ZW5lcktleSh1aWQsIGxpc3Rlbih0aGlzLmZlYXR1cmVzLCAnYWRkJywgdGhpcy5oYW5kbGVGZWF0dXJlQWRkXywgdGhpcykpO1xuICB0aGlzLnNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpczIubWFwU2VsZWN0QWN0aXZlO1xuICB9LCB0aGlzLmhhbmRsZU1hcFNlbGVjdEFjdGl2ZUNoYW5nZV8uYmluZCh0aGlzKSk7XG4gIHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIF90aGlzMi5zdGF0ZTtcbiAgfSwgZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgIHZhciBzdGF0ZSA9IEVkaXRpbmdTdGF0ZTtcblxuICAgIGlmIChuZXdWYWx1ZSA9PT0gc3RhdGUuU1RPUF9FRElUSU5HX1BFTkRJTkcpIHtcbiAgICAgIGlmIChfdGhpczIuZmVhdHVyZSAmJiBfdGhpczIuZGlydHkpIHtcbiAgICAgICAgX3RoaXMyLmNvbmZpcm1DYW5jZWwoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczIudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMyLnN0YXRlID0gc3RhdGUuU1RPUF9FRElUSU5HX0VYRUNVVEU7XG5cbiAgICAgICAgICAgIF90aGlzMi5zY29wZV8uJGFwcGx5KCk7XG4gICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpczIuc3RhdGUgPSBzdGF0ZS5TVE9QX0VESVRJTkdfRVhFQ1VURTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG5ld1ZhbHVlID09PSBzdGF0ZS5ERUFDVElWQVRFX1BFTkRJTkcpIHtcbiAgICAgIGlmIChfdGhpczIuZmVhdHVyZSAmJiBfdGhpczIuZGlydHkpIHtcbiAgICAgICAgX3RoaXMyLmNvbmZpcm1DYW5jZWwoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczIudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMyLnN0YXRlID0gc3RhdGUuREVBQ1RJVkFURV9FWEVDVVRFO1xuXG4gICAgICAgICAgICBfdGhpczIuc2NvcGVfLiRhcHBseSgpO1xuICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXMyLnN0YXRlID0gc3RhdGUuREVBQ1RJVkFURV9FWEVDVVRFO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIF90aGlzMi51bnNhdmVkTW9kaWZpY2F0aW9uc01vZGFsU2hvd247XG4gIH0sIGZ1bmN0aW9uIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICBpZiAob2xkVmFsdWUgJiYgIW5ld1ZhbHVlKSB7XG4gICAgICBfdGhpczIuc3RhdGUgPSBFZGl0aW5nU3RhdGUuSURMRTtcbiAgICB9XG4gIH0pO1xuICB0aGlzLmdtZlhTREF0dHJpYnV0ZXNfLmdldEF0dHJpYnV0ZXModGhpcy5lZGl0YWJsZU5vZGVfLmlkKS50aGVuKHRoaXMuc2V0QXR0cmlidXRlc18uYmluZCh0aGlzKSk7XG4gIHRoaXMudG9nZ2xlXyh0cnVlKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gIGlmICghdGhpcy5hdHRyaWJ1dGVzKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGF0dHJpYnV0ZXMnKTtcbiAgfVxuXG4gIGlmICghdGhpcy5mZWF0dXJlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmUnKTtcbiAgfVxuXG4gIGlmICghdGhpcy5lZGl0YWJsZU5vZGVfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGVkaXRhYmxlTm9kZScpO1xuICB9XG5cbiAgdmFyIGZlYXR1cmUgPSB0aGlzLmZlYXR1cmUuY2xvbmUoKTtcbiAgZmVhdHVyZS5zZXRJZCh0aGlzLmZlYXR1cmUuZ2V0SWQoKSk7XG4gIHZhciBpZCA9IHRoaXMuZmVhdHVyZUlkO1xuICB0aGlzLnBlbmRpbmcgPSB0cnVlO1xuICB2YXIgZGF0ZUZvcm1hdHRlciA9IG5ldyBEYXRlRm9ybWF0dGVyKCk7XG5cbiAgZm9yICh2YXIgX2l0ZXJhdG9yID0gdGhpcy5hdHRyaWJ1dGVzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgIHZhciBfcmVmO1xuXG4gICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICBfcmVmID0gX2l0ZXJhdG9yW19pKytdO1xuICAgIH0gZWxzZSB7XG4gICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICBpZiAoX2kuZG9uZSkgYnJlYWs7XG4gICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgfVxuXG4gICAgdmFyIGF0dHJpYnV0ZSA9IF9yZWY7XG5cbiAgICBpZiAoYXR0cmlidXRlLmZvcm1hdCkge1xuICAgICAgaWYgKHRoaXMuZmVhdHVyZS5nZXQoYXR0cmlidXRlLm5hbWUpKSB7XG4gICAgICAgIHZhciBuYW1lID0gdGhpcy5mZWF0dXJlLmdldChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgIHZhciB2YWx1ZSA9IGRhdGVGb3JtYXR0ZXIucGFyc2VEYXRlKG5hbWUsIGF0dHJpYnV0ZS5mb3JtYXQpO1xuXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkYXRlJyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIganNvbkZvcm1hdCA9ICdZLW0tZFxcXFxUSDppOnMnO1xuXG4gICAgICAgIGlmIChhdHRyaWJ1dGUudHlwZSA9PT0gJ2RhdGUnKSB7XG4gICAgICAgICAganNvbkZvcm1hdCA9ICdZLW0tZCc7XG4gICAgICAgIH0gZWxzZSBpZiAoYXR0cmlidXRlLnR5cGUgPT09ICd0aW1lJykge1xuICAgICAgICAgIGpzb25Gb3JtYXQgPSAnSDppOnMnO1xuICAgICAgICB9IGVsc2UgaWYgKGF0dHJpYnV0ZS50eXBlID09PSAnZGF0ZXRpbWUnKSB7XG4gICAgICAgICAgdmFsdWUuc2V0TWludXRlcyh2YWx1ZS5nZXRNaW51dGVzKCkgKyB2YWx1ZS5nZXRUaW1lem9uZU9mZnNldCgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZlYXR1cmUuc2V0KGF0dHJpYnV0ZS5uYW1lLCBkYXRlRm9ybWF0dGVyLmZvcm1hdERhdGUodmFsdWUsIGpzb25Gb3JtYXQpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZlYXR1cmUuc2V0KGF0dHJpYnV0ZS5uYW1lLCBudWxsKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgcHJvbWlzZSA9IGlkID8gdGhpcy5nbWZFZGl0RmVhdHVyZV8udXBkYXRlRmVhdHVyZSh0aGlzLmVkaXRhYmxlTm9kZV8uaWQsIGZlYXR1cmUpIDogdGhpcy5nbWZFZGl0RmVhdHVyZV8uaW5zZXJ0RmVhdHVyZXModGhpcy5lZGl0YWJsZU5vZGVfLmlkLCBbZmVhdHVyZV0pO1xuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgX3RoaXMzLmRpcnR5ID0gZmFsc2U7XG5cbiAgICBfdGhpczMuaGFuZGxlRWRpdEZlYXR1cmVfKHJlc3BvbnNlKTtcblxuICAgIF90aGlzMy5nbWZTbmFwcGluZ18ucmVmcmVzaCgpO1xuXG4gICAgaWYgKF90aGlzMy5jbG9zZUFmdGVyU2F2ZSkge1xuICAgICAgX3RoaXMzLmNhbmNlbCgpO1xuICAgIH1cbiAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgX3RoaXMzLnNob3dTZXJ2ZXJFcnJvciA9IHRydWU7XG4gICAgX3RoaXMzLnNlcnZlckVycm9yVHlwZSA9IFwiZXJyb3IgdHlwZSA6IFwiICsgcmVzcG9uc2UuZGF0YS5lcnJvcl90eXBlO1xuICAgIF90aGlzMy5zZXJ2ZXJFcnJvck1lc3NhZ2UgPSBcImVycm9yIG1lc3NhZ2UgOiBcIiArIHJlc3BvbnNlLmRhdGEubWVzc2FnZTtcbiAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgX3RoaXMzLnBlbmRpbmcgPSBmYWxzZTtcbiAgfSk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5mZWF0dXJlcykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlcycpO1xuICB9XG5cbiAgdGhpcy5kaXJ0eSA9IGZhbHNlO1xuICB0aGlzLmZlYXR1cmUgPSBudWxsO1xuICB0aGlzLmZlYXR1cmVzLmNsZWFyKCk7XG4gIHRoaXMubWVudV8uY2xvc2UoKTtcbiAgdGhpcy5tZW51VmVydGV4Xy5jbG9zZSgpO1xuICB0aGlzLnVuc2F2ZWRNb2RpZmljYXRpb25zTW9kYWxTaG93biA9IGZhbHNlO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuY29uZmlybUNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgcmV0dXJuIHRoaXMuY2hlY2tGb3JNb2RpZmljYXRpb25zXygpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgIF90aGlzNC5jYW5jZWwoKTtcbiAgfSk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5jaGVja0Zvck1vZGlmaWNhdGlvbnNfID0gZnVuY3Rpb24gKHNjb3BlQXBwbHkpIHtcbiAgdGhpcy5jb25maXJtRGVmZXJyZWRfID0gdGhpcy5xXy5kZWZlcigpO1xuXG4gIGlmICh0aGlzLmZlYXR1cmUgJiYgdGhpcy5kaXJ0eSkge1xuICAgIHRoaXMudW5zYXZlZE1vZGlmaWNhdGlvbnNNb2RhbFNob3duID0gdHJ1ZTtcblxuICAgIGlmIChzY29wZUFwcGx5KSB7XG4gICAgICB0aGlzLnNjb3BlXy4kYXBwbHkoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5jb25maXJtRGVmZXJyZWRfLnJlc29sdmUoKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzLmNvbmZpcm1EZWZlcnJlZF8ucHJvbWlzZTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmNvbnRpbnVlV2l0aG91dFNhdmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLmNvbmZpcm1EZWZlcnJlZF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY29uZmlybURlZmVycmVkXycpO1xuICB9XG5cbiAgdGhpcy5jYW5jZWwoKTtcbiAgdGhpcy5jb25maXJtRGVmZXJyZWRfLnJlc29sdmUoKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgaWYgKCF0aGlzLmVkaXRhYmxlTm9kZV8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZWRpdGFibGVOb2RlXycpO1xuICB9XG5cbiAgaWYgKCF0aGlzLmZlYXR1cmUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZScpO1xuICB9XG5cbiAgdmFyIG1zZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfLmdldFN0cmluZygnRG8geW91IHJlYWxseSB3YW50IHRvIGRlbGV0ZSB0aGUgc2VsZWN0ZWQgZmVhdHVyZT8nKTtcblxuICBpZiAoY29uZmlybShtc2cpKSB7XG4gICAgdGhpcy5wZW5kaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmdtZkVkaXRGZWF0dXJlXy5kZWxldGVGZWF0dXJlKHRoaXMuZWRpdGFibGVOb2RlXy5pZCwgdGhpcy5mZWF0dXJlKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgaWYgKCFfdGhpczUuZWRpdGFibGVXTVNMYXllcl8pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGVkaXRhYmxlV01TTGF5ZXJfJyk7XG4gICAgICB9XG5cbiAgICAgIF90aGlzNS5kaXJ0eSA9IGZhbHNlO1xuICAgICAgX3RoaXM1LnBlbmRpbmcgPSBmYWxzZTtcblxuICAgICAgX3RoaXM1Lm5nZW9MYXllckhlbHBlcl8ucmVmcmVzaFdNU0xheWVyKF90aGlzNS5lZGl0YWJsZVdNU0xheWVyXyk7XG5cbiAgICAgIF90aGlzNS5jYW5jZWwoKTtcbiAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIF90aGlzNS5zaG93U2VydmVyRXJyb3IgPSB0cnVlO1xuICAgICAgX3RoaXM1LnBlbmRpbmcgPSBmYWxzZTtcbiAgICAgIF90aGlzNS5zZXJ2ZXJFcnJvclR5cGUgPSBcImVycm9yIHR5cGUgOiBcIiArIHJlc3BvbnNlLmRhdGEuZXJyb3JfdHlwZTtcbiAgICAgIF90aGlzNS5zZXJ2ZXJFcnJvck1lc3NhZ2UgPSBcImVycm9yIG1lc3NhZ2UgOiBcIiArIHJlc3BvbnNlLmRhdGEubWVzc2FnZTtcbiAgICB9KTtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc3VibWl0ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICB0aGlzLnRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICBfdGhpczYuZWxlbWVudF8uZmluZCgnaW5wdXRbdHlwZT1cInN1Ym1pdFwiXScpLmNsaWNrKCk7XG4gIH0sIDApO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlRWRpdEZlYXR1cmVfID0gZnVuY3Rpb24gKHJlc3ApIHtcbiAgdmFyIGZlYXR1cmVzID0gbmV3IG9sRm9ybWF0R2VvSlNPTigpLnJlYWRGZWF0dXJlcyhyZXNwLmRhdGEpO1xuXG4gIGlmIChmZWF0dXJlcy5sZW5ndGgpIHtcbiAgICBpZiAoIXRoaXMuZWRpdGFibGVXTVNMYXllcl8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBlZGl0YWJsZVdNU0xheWVyXycpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5mZWF0dXJlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZScpO1xuICAgIH1cblxuICAgIHRoaXMuZmVhdHVyZS5zZXRJZChmZWF0dXJlc1swXS5nZXRJZCgpKTtcbiAgICB0aGlzLm5nZW9MYXllckhlbHBlcl8ucmVmcmVzaFdNU0xheWVyKHRoaXMuZWRpdGFibGVXTVNMYXllcl8pO1xuICB9XG5cbiAgaWYgKHRoaXMuY29uZmlybURlZmVycmVkXykge1xuICAgIHRoaXMuY29uZmlybURlZmVycmVkXy5yZXNvbHZlKCk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnNldEF0dHJpYnV0ZXNfID0gZnVuY3Rpb24gKGF0dHJpYnV0ZXMpIHtcbiAgdGhpcy5hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcblxuICBmb3IgKHZhciBfaXRlcmF0b3IyID0gYXR0cmlidXRlcywgX2lzQXJyYXkyID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IyKSwgX2kyID0gMCwgX2l0ZXJhdG9yMiA9IF9pc0FycmF5MiA/IF9pdGVyYXRvcjIgOiBfaXRlcmF0b3IyW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgdmFyIF9yZWYyO1xuXG4gICAgaWYgKF9pc0FycmF5Mikge1xuICAgICAgaWYgKF9pMiA+PSBfaXRlcmF0b3IyLmxlbmd0aCkgYnJlYWs7XG4gICAgICBfcmVmMiA9IF9pdGVyYXRvcjJbX2kyKytdO1xuICAgIH0gZWxzZSB7XG4gICAgICBfaTIgPSBfaXRlcmF0b3IyLm5leHQoKTtcbiAgICAgIGlmIChfaTIuZG9uZSkgYnJlYWs7XG4gICAgICBfcmVmMiA9IF9pMi52YWx1ZTtcbiAgICB9XG5cbiAgICB2YXIgYXR0cmlidXRlID0gX3JlZjI7XG5cbiAgICBpZiAoYXR0cmlidXRlLnR5cGUgPT0gJ2RhdGUnKSB7XG4gICAgICBhdHRyaWJ1dGUuZm9ybWF0ID0gJ1ktbS1kJztcbiAgICAgIGF0dHJpYnV0ZS5tYXNrID0gJzk5OTktMTktMzknO1xuICAgIH0gZWxzZSBpZiAoYXR0cmlidXRlLnR5cGUgPT0gJ3RpbWUnKSB7XG4gICAgICBhdHRyaWJ1dGUuZm9ybWF0ID0gJ0g6aSc7XG4gICAgICBhdHRyaWJ1dGUubWFzayA9ICcyOTo1OSc7XG4gICAgfSBlbHNlIGlmIChhdHRyaWJ1dGUudHlwZSA9PSAnZGF0ZXRpbWUnKSB7XG4gICAgICBhdHRyaWJ1dGUuZm9ybWF0ID0gJ1ktbS1kIEg6aSc7XG4gICAgICBhdHRyaWJ1dGUubWFzayA9ICc5OTk5LTE5LTM5IDI5OjU5JztcbiAgICB9XG4gIH1cblxuICB2YXIgZ2VvbUF0dHIgPSBnZXRHZW9tZXRyeUF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZXMpO1xuXG4gIGlmIChnZW9tQXR0ciAmJiBnZW9tQXR0ci5nZW9tVHlwZSkge1xuICAgIHRoaXMuZ2VvbVR5cGUgPSBnZW9tQXR0ci5nZW9tVHlwZTtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlRmVhdHVyZUFkZF8gPSBmdW5jdGlvbiAoZXZ0KSB7XG4gIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gIGlmIChldnQgaW5zdGFuY2VvZiBDb2xsZWN0aW9uRXZlbnQpIHtcbiAgICB0aGlzLmZlYXR1cmUgPSBudWxsO1xuICAgIHRoaXMudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCFfdGhpczcuYXR0cmlidXRlcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgYXR0cmlidXRlcycpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZmVhdHVyZSA9IGV2dC5lbGVtZW50O1xuXG4gICAgICBpZiAoIShmZWF0dXJlIGluc3RhbmNlb2Ygb2xGZWF0dXJlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGZlYXR1cmUgdHlwZScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGF0ZUZvcm1hdHRlciA9IG5ldyBEYXRlRm9ybWF0dGVyKCk7XG5cbiAgICAgIGZvciAodmFyIF9pdGVyYXRvcjMgPSBfdGhpczcuYXR0cmlidXRlcywgX2lzQXJyYXkzID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IzKSwgX2kzID0gMCwgX2l0ZXJhdG9yMyA9IF9pc0FycmF5MyA/IF9pdGVyYXRvcjMgOiBfaXRlcmF0b3IzW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgIHZhciBfcmVmMztcblxuICAgICAgICBpZiAoX2lzQXJyYXkzKSB7XG4gICAgICAgICAgaWYgKF9pMyA+PSBfaXRlcmF0b3IzLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgX3JlZjMgPSBfaXRlcmF0b3IzW19pMysrXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfaTMgPSBfaXRlcmF0b3IzLm5leHQoKTtcbiAgICAgICAgICBpZiAoX2kzLmRvbmUpIGJyZWFrO1xuICAgICAgICAgIF9yZWYzID0gX2kzLnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IF9yZWYzO1xuXG4gICAgICAgIGlmIChhdHRyaWJ1dGUuZm9ybWF0KSB7XG4gICAgICAgICAgaWYgKGZlYXR1cmUuZ2V0KGF0dHJpYnV0ZS5uYW1lKSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdm9pZCAwO1xuXG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlLnR5cGUgPT09ICdkYXRldGltZScpIHtcbiAgICAgICAgICAgICAgdmFsdWUgPSBuZXcgRGF0ZShmZWF0dXJlLmdldChhdHRyaWJ1dGUubmFtZSkpO1xuICAgICAgICAgICAgICB2YWx1ZS5zZXRNaW51dGVzKHZhbHVlLmdldE1pbnV0ZXMoKSAtIHZhbHVlLmdldFRpbWV6b25lT2Zmc2V0KCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIGpzb25Gb3JtYXQgPSAnJztcblxuICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLnR5cGUgPT09ICdkYXRlJykge1xuICAgICAgICAgICAgICAgIGpzb25Gb3JtYXQgPSAnWS1tLWQnO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGF0dHJpYnV0ZS50eXBlID09PSAndGltZScpIHtcbiAgICAgICAgICAgICAgICBqc29uRm9ybWF0ID0gJ0g6aTpzJztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBuYW1lID0gZmVhdHVyZS5nZXQoYXR0cmlidXRlLm5hbWUpO1xuXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgbmFtZSB0eXBlJyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGVGb3JtYXR0ZXIucGFyc2VEYXRlKG5hbWUsIGpzb25Gb3JtYXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmZWF0dXJlLnNldChhdHRyaWJ1dGUubmFtZSwgZGF0ZUZvcm1hdHRlci5mb3JtYXREYXRlKHZhbHVlLCBhdHRyaWJ1dGUuZm9ybWF0KSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZlYXR1cmUuc2V0KGF0dHJpYnV0ZS5uYW1lLCBudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgX3RoaXM3LmZlYXR1cmUgPSBmZWF0dXJlO1xuICAgICAgX3RoaXM3LmNyZWF0ZUFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICBpZiAoIWZlYXR1cmUuZ2V0SWQoKSkge1xuICAgICAgICBfdGhpczcuZGlydHkgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBfdGhpczcuc2NvcGVfLiRhcHBseSgpO1xuICAgIH0sIDApO1xuICB9XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS50b2dnbGVfID0gZnVuY3Rpb24gKGFjdGl2ZSkge1xuICBpZiAoIXRoaXMubW9kaWZ5VG9vbEFjdGl2YXRlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1vZGlmeVRvb2xBY3RpdmF0ZScpO1xuICB9XG5cbiAgaWYgKCF0aGlzLnRyYW5zbGF0ZVRvb2xBY3RpdmF0ZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB0cmFuc2xhdGVUb29sQWN0aXZhdGUnKTtcbiAgfVxuXG4gIGlmICghdGhpcy5yb3RhdGVUb29sQWN0aXZhdGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgcm90YXRlVG9vbEFjdGl2YXRlJyk7XG4gIH1cblxuICBpZiAoIXRoaXMubW9kaWZ5Xykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtb2RpZnknKTtcbiAgfVxuXG4gIGlmICghdGhpcy5lZGl0YWJsZVRyZWVDdHJsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGVkaXRhYmxlVHJlZUN0cmwnKTtcbiAgfVxuXG4gIHZhciBrZXlzID0gdGhpcy5saXN0ZW5lcktleXNfO1xuICB2YXIgY3JlYXRlVWlkID0gWydjcmVhdGUtJywgb2xVdGlsR2V0VWlkKHRoaXMpXS5qb2luKCctJyk7XG4gIHZhciBvdGhlclVpZCA9IFsnb3RoZXItJywgb2xVdGlsR2V0VWlkKHRoaXMpXS5qb2luKCctJyk7XG4gIHZhciB0b29sTWdyID0gdGhpcy5uZ2VvVG9vbEFjdGl2YXRlTWdyXztcblxuICBpZiAoYWN0aXZlKSB7XG4gICAgaWYgKCF0aGlzLnRyYW5zbGF0ZV8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB0cmFuc2xhdGUnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMucm90YXRlXykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJvdGF0ZScpO1xuICAgIH1cblxuICAgIGtleXMucHVzaChsaXN0ZW4odGhpcy5tZW51XywgJ2FjdGlvbmNsaWNrJywgdGhpcy5oYW5kbGVNZW51QWN0aW9uQ2xpY2tfLCB0aGlzKSk7XG4gICAga2V5cy5wdXNoKGxpc3Rlbih0aGlzLm1lbnVWZXJ0ZXhfLCAnYWN0aW9uY2xpY2snLCB0aGlzLmhhbmRsZU1lbnVWZXJ0ZXhBY3Rpb25DbGlja18sIHRoaXMpKTtcbiAgICBrZXlzLnB1c2gobGlzdGVuKHRoaXMudHJhbnNsYXRlXywgJ3RyYW5zbGF0ZWVuZCcsIHRoaXMuaGFuZGxlVHJhbnNsYXRlRW5kXywgdGhpcykpO1xuICAgIGtleXMucHVzaChsaXN0ZW4odGhpcy5yb3RhdGVfLCAncm90YXRlZW5kJywgdGhpcy5oYW5kbGVSb3RhdGVFbmRfLCB0aGlzKSk7XG4gICAgdG9vbE1nci5yZWdpc3RlclRvb2woY3JlYXRlVWlkLCB0aGlzLmNyZWF0ZVRvb2xBY3RpdmF0ZSwgZmFsc2UpO1xuICAgIHRvb2xNZ3IucmVnaXN0ZXJUb29sKGNyZWF0ZVVpZCwgdGhpcy5tYXBTZWxlY3RUb29sQWN0aXZhdGUsIHRydWUpO1xuICAgIHRvb2xNZ3IucmVnaXN0ZXJUb29sKG90aGVyVWlkLCB0aGlzLmNyZWF0ZVRvb2xBY3RpdmF0ZSwgZmFsc2UpO1xuICAgIHRvb2xNZ3IucmVnaXN0ZXJUb29sKG90aGVyVWlkLCB0aGlzLm1vZGlmeVRvb2xBY3RpdmF0ZSwgdHJ1ZSk7XG4gICAgdG9vbE1nci5yZWdpc3RlclRvb2wob3RoZXJVaWQsIHRoaXMudHJhbnNsYXRlVG9vbEFjdGl2YXRlLCBmYWxzZSk7XG4gICAgdG9vbE1nci5yZWdpc3RlclRvb2wob3RoZXJVaWQsIHRoaXMucm90YXRlVG9vbEFjdGl2YXRlLCBmYWxzZSk7XG4gIH0gZWxzZSB7XG4gICAga2V5cy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgIGtleXMubGVuZ3RoID0gMDtcbiAgICB0b29sTWdyLnVucmVnaXN0ZXJUb29sKGNyZWF0ZVVpZCwgdGhpcy5jcmVhdGVUb29sQWN0aXZhdGUpO1xuICAgIHRvb2xNZ3IudW5yZWdpc3RlclRvb2woY3JlYXRlVWlkLCB0aGlzLm1hcFNlbGVjdFRvb2xBY3RpdmF0ZSk7XG4gICAgdG9vbE1nci51bnJlZ2lzdGVyVG9vbChvdGhlclVpZCwgdGhpcy5jcmVhdGVUb29sQWN0aXZhdGUpO1xuICAgIHRvb2xNZ3IudW5yZWdpc3RlclRvb2wob3RoZXJVaWQsIHRoaXMubW9kaWZ5VG9vbEFjdGl2YXRlKTtcbiAgICB0b29sTWdyLnVucmVnaXN0ZXJUb29sKG90aGVyVWlkLCB0aGlzLnRyYW5zbGF0ZVRvb2xBY3RpdmF0ZSk7XG4gICAgdG9vbE1nci51bnJlZ2lzdGVyVG9vbChvdGhlclVpZCwgdGhpcy5yb3RhdGVUb29sQWN0aXZhdGUpO1xuICAgIHRoaXMuY3JlYXRlQWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5jYW5jZWwoKTtcbiAgfVxuXG4gIHRoaXMubW9kaWZ5Xy5zZXRBY3RpdmUoYWN0aXZlKTtcbiAgdGhpcy5tYXBTZWxlY3RBY3RpdmUgPSBhY3RpdmU7XG4gIHRoaXMuZWRpdGFibGVUcmVlQ3RybC5wcm9wZXJ0aWVzLmVkaXRpbmcgPSBhY3RpdmU7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVNYXBTZWxlY3RBY3RpdmVDaGFuZ2VfID0gZnVuY3Rpb24gKGFjdGl2ZSkge1xuICBpZiAoIXRoaXMubWFwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICB9XG5cbiAgdmFyIG1hcERpdiA9IHRoaXMubWFwLmdldFZpZXdwb3J0KCk7XG5cbiAgaWYgKCFtYXBEaXYpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwRGl2Jyk7XG4gIH1cblxuICBpZiAoYWN0aXZlKSB7XG4gICAgdGhpcy5tYXBMaXN0ZW5lcktleXNfLnB1c2gobGlzdGVuKHRoaXMubWFwLCAnY2xpY2snLCB0aGlzLmhhbmRsZU1hcENsaWNrXywgdGhpcyksIGxpc3RlbihtYXBEaXYsICdjb250ZXh0bWVudScsIHRoaXMuaGFuZGxlTWFwQ29udGV4dE1lbnVfLCB0aGlzKSk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5tYXBMaXN0ZW5lcktleXNfLmZvckVhY2godW5saXN0ZW5CeUtleSk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZU1hcENsaWNrXyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgaWYgKGV2dCBpbnN0YW5jZW9mIE1hcEJyb3dzZXJFdmVudCkge1xuICAgIGlmICghdGhpcy5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICB2YXIgY29vcmRpbmF0ZSA9IGV2dC5jb29yZGluYXRlO1xuICAgIHZhciBwaXhlbCA9IGV2dC5waXhlbDtcbiAgICB2YXIgZmVhdHVyZSA9IHRoaXMubWFwLmZvckVhY2hGZWF0dXJlQXRQaXhlbChwaXhlbCwgZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgIGlmICghKGZlYXR1cmUgaW5zdGFuY2VvZiBvbEZlYXR1cmUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZmVhdHVyZSB0eXBlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghX3RoaXM4LmZlYXR1cmVzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlcycpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmV0ID0gbnVsbDtcblxuICAgICAgaWYgKF90aGlzOC5mZWF0dXJlcy5nZXRBcnJheSgpLmluY2x1ZGVzKGZlYXR1cmUpKSB7XG4gICAgICAgIHJldCA9IGZlYXR1cmU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXQ7XG4gICAgfSwge1xuICAgICAgaGl0VG9sZXJhbmNlOiA1LFxuICAgICAgbGF5ZXJGaWx0ZXI6IHVuZGVmaW5lZFxuICAgIH0pO1xuXG4gICAgaWYgKGZlYXR1cmUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmNoZWNrRm9yTW9kaWZpY2F0aW9uc18odHJ1ZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIV90aGlzOC5tYXApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIV90aGlzOC5lZGl0YWJsZU5vZGVfKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBlZGl0YWJsZU5vZGUnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG1hcCA9IF90aGlzOC5tYXA7XG4gICAgICB2YXIgdmlldyA9IG1hcC5nZXRWaWV3KCk7XG4gICAgICB2YXIgcmVzb2x1dGlvbiA9IHZpZXcuZ2V0UmVzb2x1dGlvbigpO1xuXG4gICAgICBpZiAocmVzb2x1dGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyByZXNvbHV0aW9uJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBidWZmZXIgPSByZXNvbHV0aW9uICogX3RoaXM4LnRvbGVyYW5jZTtcbiAgICAgIHZhciBleHRlbnQgPSBvbEV4dGVudC5idWZmZXIoW2Nvb3JkaW5hdGVbMF0sIGNvb3JkaW5hdGVbMV0sIGNvb3JkaW5hdGVbMF0sIGNvb3JkaW5hdGVbMV1dLCBidWZmZXIpO1xuXG4gICAgICBfdGhpczguZ21mRWRpdEZlYXR1cmVfLmdldEZlYXR1cmVzSW5FeHRlbnQoW190aGlzOC5lZGl0YWJsZU5vZGVfLmlkXSwgZXh0ZW50KS50aGVuKF90aGlzOC5oYW5kbGVHZXRGZWF0dXJlc18uYmluZChfdGhpczgpKTtcblxuICAgICAgX3RoaXM4LmNhbmNlbCgpO1xuXG4gICAgICBfdGhpczgucGVuZGluZyA9IHRydWU7XG4gICAgfSk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZU1hcENvbnRleHRNZW51XyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgaWYgKGV2dCBpbnN0YW5jZW9mIEV2ZW50KSB7XG4gICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIHZhciBwaXhlbCA9IHRoaXMubWFwLmdldEV2ZW50UGl4ZWwoZXZ0KTtcbiAgICB2YXIgY29vcmRpbmF0ZSA9IHRoaXMubWFwLmdldENvb3JkaW5hdGVGcm9tUGl4ZWwocGl4ZWwpO1xuICAgIHZhciBmZWF0dXJlID0gdGhpcy5tYXAuZm9yRWFjaEZlYXR1cmVBdFBpeGVsKHBpeGVsLCBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgaWYgKCEoZmVhdHVyZSBpbnN0YW5jZW9mIG9sRmVhdHVyZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBmZWF0dXJlIHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFfdGhpczkuZmVhdHVyZXMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmVzJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciByZXQgPSBudWxsO1xuXG4gICAgICBpZiAoX3RoaXM5LmZlYXR1cmVzLmdldEFycmF5KCkuaW5jbHVkZXMoZmVhdHVyZSkpIHtcbiAgICAgICAgcmV0ID0gZmVhdHVyZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9LCB7XG4gICAgICBoaXRUb2xlcmFuY2U6IDcsXG4gICAgICBsYXllckZpbHRlcjogdW5kZWZpbmVkXG4gICAgfSk7XG4gICAgZmVhdHVyZSA9IGZlYXR1cmUgPyBmZWF0dXJlIDogbnVsbDtcbiAgICB0aGlzLm1lbnVfLmNsb3NlKCk7XG4gICAgdGhpcy5tZW51VmVydGV4Xy5jbG9zZSgpO1xuICAgIHRoaXMudmVydGV4SW5mb18gPSBudWxsO1xuXG4gICAgaWYgKGZlYXR1cmUgaW5zdGFuY2VvZiBvbEZlYXR1cmUpIHtcbiAgICAgIHZhciByZXNvbHV0aW9ucyA9IHRoaXMubWFwLmdldFZpZXcoKS5nZXRSZXNvbHV0aW9uKCk7XG5cbiAgICAgIGlmICghcmVzb2x1dGlvbnMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJlc29sdXRpb25zJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciB2ZXJ0ZXhJbmZvID0gdGhpcy5uZ2VvRmVhdHVyZUhlbHBlcl8uZ2V0VmVydGV4SW5mb0F0Q29vcmRpbmF0ZShmZWF0dXJlLCBjb29yZGluYXRlLCByZXNvbHV0aW9ucyk7XG5cbiAgICAgIGlmICh2ZXJ0ZXhJbmZvKSB7XG4gICAgICAgIHRoaXMudmVydGV4SW5mb18gPSB2ZXJ0ZXhJbmZvO1xuICAgICAgICB0aGlzLm1lbnVWZXJ0ZXhfLm9wZW4oY29vcmRpbmF0ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdHlwZSA9IHRoaXMubmdlb0ZlYXR1cmVIZWxwZXJfLmdldFR5cGUoZmVhdHVyZSk7XG5cbiAgICAgICAgaWYgKHR5cGUgPT09IG5nZW9HZW9tZXRyeVR5cGUuUE9MWUdPTiB8fCB0eXBlID09PSBuZ2VvR2VvbWV0cnlUeXBlLk1VTFRJX1BPTFlHT04gfHwgdHlwZSA9PT0gbmdlb0dlb21ldHJ5VHlwZS5MSU5FX1NUUklORyB8fCB0eXBlID09PSBuZ2VvR2VvbWV0cnlUeXBlLk1VTFRJX0xJTkVfU1RSSU5HKSB7XG4gICAgICAgICAgdGhpcy5tZW51Xy5vcGVuKGNvb3JkaW5hdGUpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlR2V0RmVhdHVyZXNfID0gZnVuY3Rpb24gKGZlYXR1cmVzKSB7XG4gIHZhciBfdGhpczEwID0gdGhpcztcblxuICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgdGhpcy50aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFfdGhpczEwLmZlYXR1cmVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZXMnKTtcbiAgICB9XG5cbiAgICBpZiAoZmVhdHVyZXMubGVuZ3RoKSB7XG4gICAgICB2YXIgZmVhdHVyZSA9IGZlYXR1cmVzWzBdO1xuICAgICAgX3RoaXMxMC5mZWF0dXJlID0gZmVhdHVyZTtcblxuICAgICAgX3RoaXMxMC5mZWF0dXJlcy5wdXNoKGZlYXR1cmUpO1xuICAgIH1cbiAgfSwgMCk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5pbml0aWFsaXplSW50ZXJhY3Rpb25zXyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5pbnRlcmFjdGlvbnNfLmZvckVhY2goZnVuY3Rpb24gKGludGVyYWN0aW9uKSB7XG4gICAgaW50ZXJhY3Rpb24uc2V0QWN0aXZlKGZhbHNlKTtcbiAgICBuZ2VvTWlzY0RlY29yYXRlSW50ZXJhY3Rpb24oaW50ZXJhY3Rpb24pO1xuICB9KTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnJlZ2lzdGVySW50ZXJhY3Rpb25zXyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzMTEgPSB0aGlzO1xuXG4gIHRoaXMuaW50ZXJhY3Rpb25zXy5mb3JFYWNoKGZ1bmN0aW9uIChpbnRlcmFjdGlvbikge1xuICAgIGlmICghX3RoaXMxMS5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICBfdGhpczExLm1hcC5hZGRJbnRlcmFjdGlvbihpbnRlcmFjdGlvbik7XG4gIH0pO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUudW5yZWdpc3RlckludGVyYWN0aW9uc18gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczEyID0gdGhpcztcblxuICB0aGlzLmludGVyYWN0aW9uc18uZm9yRWFjaChmdW5jdGlvbiAoaW50ZXJhY3Rpb24pIHtcbiAgICBpZiAoIV90aGlzMTIubWFwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgX3RoaXMxMi5tYXAucmVtb3ZlSW50ZXJhY3Rpb24oaW50ZXJhY3Rpb24pO1xuICB9KTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZUZlYXR1cmVDaGFuZ2VfID0gZnVuY3Rpb24gKG5ld0ZlYXR1cmUsIG9sZEZlYXR1cmUpIHtcbiAgdmFyIF90aGlzMTMgPSB0aGlzO1xuXG4gIHZhciBnZW9tO1xuXG4gIGlmIChvbGRGZWF0dXJlKSB7XG4gICAgdGhpcy5nZW9tTGlzdGVuZXJLZXlzXy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgIHRoaXMudW5yZWdpc3RlckludGVyYWN0aW9uc18oKTtcbiAgfVxuXG4gIGlmIChuZXdGZWF0dXJlKSB7XG4gICAgdGhpcy5mZWF0dXJlSWQgPSBuZXdGZWF0dXJlLmdldElkKCk7XG4gICAgZ2VvbSA9IG5ld0ZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcbiAgICB0aGlzLmdlb21MaXN0ZW5lcktleXNfLnB1c2gobGlzdGVuKG5ld0ZlYXR1cmUsICdwcm9wZXJ0eWNoYW5nZScsIHRoaXMuaGFuZGxlRmVhdHVyZVByb3BlcnR5Q2hhbmdlXywgdGhpcyksIGxpc3RlbihnZW9tLCAnY2hhbmdlJywgdGhpcy5oYW5kbGVGZWF0dXJlR2VvbWV0cnlDaGFuZ2VfLCB0aGlzKSk7XG4gICAgdGhpcy5yZWdpc3RlckludGVyYWN0aW9uc18oKTtcbiAgICB0aGlzLmdtZlNuYXBwaW5nXy5lbnN1cmVTbmFwSW50ZXJhY3Rpb25zT25Ub3AoKTtcblxuICAgIGlmICh0aGlzLmZlYXR1cmVJZCkge1xuICAgICAgdGhpcy50aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMTMuZGlydHkgPSBmYWxzZTtcblxuICAgICAgICBfdGhpczEzLnNjb3BlXy4kYXBwbHkoKTtcbiAgICAgIH0sIDApO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aGlzLmZlYXR1cmVJZCA9IHVuZGVmaW5lZDtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlRmVhdHVyZVByb3BlcnR5Q2hhbmdlXyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5kaXJ0eSA9IHRydWU7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVGZWF0dXJlR2VvbWV0cnlDaGFuZ2VfID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmRpcnR5ID0gdHJ1ZTtcbiAgdGhpcy5zY29wZV8uJGFwcGx5KCk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVNZW51QWN0aW9uQ2xpY2tfID0gZnVuY3Rpb24gKGV2dCkge1xuICB2YXIgYWN0aW9uID0gZXZ0LmRldGFpbC5hY3Rpb247XG5cbiAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICBjYXNlICdtb3ZlJzpcbiAgICAgIGlmICghdGhpcy50cmFuc2xhdGVfKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB0cmFuc2xhdGUnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy50cmFuc2xhdGVfLnNldEFjdGl2ZSh0cnVlKTtcbiAgICAgIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdyb3RhdGUnOlxuICAgICAgaWYgKCF0aGlzLnJvdGF0ZV8pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJvdGF0ZScpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnJvdGF0ZV8uc2V0QWN0aXZlKHRydWUpO1xuICAgICAgdGhpcy5zY29wZV8uJGFwcGx5KCk7XG4gICAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICBicmVhaztcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlTWVudVZlcnRleEFjdGlvbkNsaWNrXyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgdmFyIGFjdGlvbiA9IGV2dC5kZXRhaWwuYWN0aW9uO1xuXG4gIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgIGlmICghdGhpcy5mZWF0dXJlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy52ZXJ0ZXhJbmZvXykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdmVydGV4SW5mbycpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZTtcbiAgICAgIHZhciB2ZXJ0ZXhJbmZvID0gdGhpcy52ZXJ0ZXhJbmZvXztcbiAgICAgIHRoaXMubmdlb0ZlYXR1cmVIZWxwZXJfLnJlbW92ZVZlcnRleChmZWF0dXJlLCB2ZXJ0ZXhJbmZvKTtcbiAgICAgIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xuICAgICAgYnJlYWs7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgYnJlYWs7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZVRyYW5zbGF0ZUVuZF8gPSBmdW5jdGlvbiAoZXZ0KSB7XG4gIGlmICghdGhpcy50cmFuc2xhdGVfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHRyYW5zbGF0ZScpO1xuICB9XG5cbiAgdGhpcy50cmFuc2xhdGVfLnNldEFjdGl2ZShmYWxzZSk7XG4gIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaGFuZGxlUm90YXRlRW5kXyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgaWYgKCF0aGlzLnJvdGF0ZV8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgcm90YXRlJyk7XG4gIH1cblxuICB0aGlzLnJvdGF0ZV8uc2V0QWN0aXZlKGZhbHNlKTtcbiAgdGhpcy5zY29wZV8uJGFwcGx5KCk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVEZXN0cm95XyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLmZlYXR1cmVzKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmVzJyk7XG4gIH1cblxuICB0aGlzLmZlYXR1cmVzLmNsZWFyKCk7XG4gIHRoaXMuaGFuZGxlRmVhdHVyZUNoYW5nZV8obnVsbCwgdGhpcy5mZWF0dXJlKTtcbiAgdGhpcy5mZWF0dXJlID0gbnVsbDtcbiAgdmFyIHVpZCA9IG9sVXRpbEdldFVpZCh0aGlzKTtcbiAgdGhpcy5uZ2VvRXZlbnRIZWxwZXJfLmNsZWFyTGlzdGVuZXJLZXkodWlkKTtcbiAgdGhpcy50b2dnbGVfKGZhbHNlKTtcbiAgdGhpcy5oYW5kbGVNYXBTZWxlY3RBY3RpdmVDaGFuZ2VfKGZhbHNlKTtcbiAgdGhpcy51bnJlZ2lzdGVySW50ZXJhY3Rpb25zXygpO1xufTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ0dtZkVkaXRmZWF0dXJlQ29udHJvbGxlcicsIENvbnRyb2xsZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXZcXG4gICAgbmctc3dpdGNoPVwiZWZzQ3RybC5zZWxlY3RlZEVkaXRhYmxlVHJlZUN0cmxcIj5cXG5cXG4gIDxkaXYgbmctc3dpdGNoLXdoZW49XCJudWxsXCI+XFxuICAgIDxzZWxlY3RcXG4gICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgIG5nLW1vZGVsPVwiZWZzQ3RybC5zZWxlY3RlZEVkaXRhYmxlVHJlZUN0cmxcIlxcbiAgICAgICAgbmctc2hvdz1cImVmc0N0cmwuZWRpdGFibGVUcmVlQ3RybHMubGVuZ3RoID4gMFwiXFxuICAgICAgICBuZy1vcHRpb25zPVwidHJlZUN0cmwubm9kZS5uYW1lIHwgdHJhbnNsYXRlIGZvciB0cmVlQ3RybCBpbiBlZnNDdHJsLmVkaXRhYmxlVHJlZUN0cmxzXCI+XFxuICAgICAgPG9wdGlvbiB2YWx1ZT1cIlwiIHRyYW5zbGF0ZT4tLSBDaG9vc2UgYSBsYXllciAtLTwvb3B0aW9uPlxcbiAgICA8L3NlbGVjdD5cXG4gICAgPHNwYW5cXG4gICAgICBuZy1zaG93PVwiZWZzQ3RybC5lZGl0YWJsZVRyZWVDdHJscy5sZW5ndGggPT0gMFwiXFxuICAgICAgdHJhbnNsYXRlPk5vIGVkaXRhYmxlIGxheWVyIGF2YWlsYWJsZSE8L3NwYW4+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXYgbmctc3dpdGNoLWRlZmF1bHQ+XFxuICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cXG4gICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTEyXCI+XFxuICAgICAgICA8c3BhbiB0cmFuc2xhdGU+Q3VycmVudGx5IGVkaXRpbmc6IDwvc3Bhbj5cXG4gICAgICAgIDxiPnt7IGVmc0N0cmwuc2VsZWN0ZWRFZGl0YWJsZVRyZWVDdHJsLm5vZGUubmFtZSB8IHRyYW5zbGF0ZSB9fTwvYj5cXG4gICAgICAgIDxzcGFuIGNsYXNzPVwiZmEgZmEtZWRpdFwiPjwvc3Bhbj5cXG4gICAgICAgIDxicj5cXG4gICAgICAgIDxidXR0b25cXG4gICAgICAgICAgICBuZy1jbGljaz1cImVmc0N0cmwuc3RvcEVkaXRpbmcoKVwiXFxuICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLWxpbmsgYnRuLXNtIHB1bGwtcmlnaHRcIj5cXG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS10aW1lc1wiPjwvc3Bhbj5cXG4gICAgICAgICAge3tcXCdTdG9wIGVkaXRpbmdcXCcgfCB0cmFuc2xhdGV9fVxcbiAgICAgICAgPC9idXR0b24+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8Z21mLWVkaXRmZWF0dXJlXFxuICAgICAgICBnbWYtZWRpdGZlYXR1cmUtZGlydHk9XCJlZnNDdHJsLmRpcnR5XCJcXG4gICAgICAgIGdtZi1lZGl0ZmVhdHVyZS1lZGl0YWJsZXRyZWVjdHJsPVwiOjplZnNDdHJsLnNlbGVjdGVkRWRpdGFibGVUcmVlQ3RybFwiXFxuICAgICAgICBnbWYtZWRpdGZlYXR1cmUtbWFwPVwiOjplZnNDdHJsLm1hcFwiXFxuICAgICAgICBnbWYtZWRpdGZlYXR1cmUtc3RhdGU9XCJlZnNDdHJsLnN0YXRlXCJcXG4gICAgICAgIGdtZi1lZGl0ZmVhdHVyZS10b2xlcmFuY2U9XCI6OmVmc0N0cmwudG9sZXJhbmNlXCJcXG4gICAgICAgIGdtZi1lZGl0ZmVhdHVyZS12ZWN0b3I9XCI6OmVmc0N0cmwudmVjdG9yTGF5ZXJcIlxcbiAgICAgICAgZ21mLWVkaXRmZWF0dXJlLWNsb3NlYWZ0ZXJzYXZlPVwiOjplZnNDdHJsLmNsb3NlQWZ0ZXJTYXZlXCI+XFxuICAgIDwvZ21mLWVkaXRmZWF0dXJlPlxcblxcbiAgPC9kaXY+XFxuXFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsIkNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwiZ21mVGhlbWVzXCIsIFwiZ21mVHJlZU1hbmFnZXJcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZFZGl0aW5nRWRpdEZlYXR1cmVDb21wb25lbnQsIHsgRWRpdGluZ1N0YXRlIH0gZnJvbSAnZ21mL2VkaXRpbmcvZWRpdEZlYXR1cmVDb21wb25lbnQuanMnO1xuaW1wb3J0IGdtZkxheWVydHJlZVRyZWVNYW5hZ2VyIGZyb20gJ2dtZi9sYXllcnRyZWUvVHJlZU1hbmFnZXIuanMnO1xuaW1wb3J0IGdtZlRoZW1lVGhlbWVzIGZyb20gJ2dtZi90aGVtZS9UaGVtZXMuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdHbWZFZGl0aW5nRmVhdHVyZVNlbGVjdG9yQ29tcG9uZW50JywgW2dtZkVkaXRpbmdFZGl0RmVhdHVyZUNvbXBvbmVudC5uYW1lLCBnbWZMYXllcnRyZWVUcmVlTWFuYWdlci5uYW1lLCBnbWZUaGVtZVRoZW1lcy5uYW1lXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi9lZGl0aW5nL2VkaXRGZWF0dXJlU2VsZWN0b3JDb21wb25lbnQnLCByZXF1aXJlKCcuL2VkaXRGZWF0dXJlU2VsZWN0b3JDb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcblxuZnVuY3Rpb24gZWRpdGluZ0VkaXRGZWF0dXJlQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIGNvbnRyb2xsZXI6ICdHbWZFZGl0ZmVhdHVyZXNlbGVjdG9yQ29udHJvbGxlciBhcyBlZnNDdHJsJyxcbiAgICBzY29wZToge1xuICAgICAgJ2FjdGl2ZSc6ICc9Z21mRWRpdGZlYXR1cmVzZWxlY3RvckFjdGl2ZScsXG4gICAgICAnbWFwJzogJzxnbWZFZGl0ZmVhdHVyZXNlbGVjdG9yTWFwJyxcbiAgICAgICd0b2xlcmFuY2UnOiAnPD9nbWZFZGl0ZmVhdHVyZXNlbGVjdG9yVG9sZXJhbmNlJyxcbiAgICAgICd2ZWN0b3JMYXllcic6ICc8Z21mRWRpdGZlYXR1cmVzZWxlY3RvclZlY3RvcicsXG4gICAgICAnc2VsZWN0ZWRFZGl0YWJsZVRyZWVDdHJsJzogJz0/Z21mRWRpdGZlYXR1cmVzZWxlY3RvclRyZWUnLFxuICAgICAgJ2Nsb3NlQWZ0ZXJTYXZlJzogJz0/Z21mRWRpdGZlYXR1cmVzZWxlY3RvckNsb3NlYWZ0ZXJzYXZlJ1xuICAgIH0sXG4gICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICB0ZW1wbGF0ZVVybDogJ2dtZi9lZGl0aW5nL2VkaXRGZWF0dXJlU2VsZWN0b3JDb21wb25lbnQnXG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ2dtZkVkaXRmZWF0dXJlc2VsZWN0b3InLCBlZGl0aW5nRWRpdEZlYXR1cmVDb21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKCRzY29wZSwgJHRpbWVvdXQsIGdtZlRoZW1lcywgZ21mVHJlZU1hbmFnZXIpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLmFjdGl2ZSA9IHRoaXMuYWN0aXZlID09PSB0cnVlO1xuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuYWN0aXZlO1xuICB9LCB0aGlzLmhhbmRsZUFjdGl2ZUNoYW5nZV8uYmluZCh0aGlzKSk7XG4gIHRoaXMubWFwID0gbnVsbDtcbiAgdGhpcy50b2xlcmFuY2UgPSBudWxsO1xuICB0aGlzLnZlY3RvckxheWVyID0gbnVsbDtcbiAgdGhpcy5jbG9zZUFmdGVyU2F2ZSA9IGZhbHNlO1xuICB0aGlzLnNjb3BlXyA9ICRzY29wZTtcbiAgdGhpcy4kdGltZW91dF8gPSAkdGltZW91dDtcbiAgdGhpcy5nbWZUaGVtZXNfID0gZ21mVGhlbWVzO1xuICB0aGlzLmdtZlRyZWVNYW5hZ2VyXyA9IGdtZlRyZWVNYW5hZ2VyO1xuXG4gIHZhciB1cGRhdGVFZGl0YWJsZVRyZWVDdHJscyA9IGZ1bmN0aW9uIHVwZGF0ZUVkaXRhYmxlVHJlZUN0cmxzKHZhbHVlKSB7XG4gICAgX3RoaXMuJHRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICB2YXIgZWRpdGFibGVzID0gX3RoaXMuZWRpdGFibGVUcmVlQ3RybHM7XG4gICAgICAgIGVkaXRhYmxlcy5sZW5ndGggPSAwO1xuXG4gICAgICAgIGlmIChfdGhpcy5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwpIHtcbiAgICAgICAgICBfdGhpcy5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwudHJhdmVyc2VEZXB0aEZpcnN0KGZ1bmN0aW9uICh0cmVlQ3RybCkge1xuICAgICAgICAgICAgdmFyIGdtZkxheWVyID0gdHJlZUN0cmwubm9kZTtcblxuICAgICAgICAgICAgaWYgKGdtZkxheWVyLmVkaXRhYmxlKSB7XG4gICAgICAgICAgICAgIGVkaXRhYmxlcy5wdXNoKHRyZWVDdHJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIDApO1xuICB9O1xuXG4gIHRoaXMudHJlZUN0cmxzV2F0Y2hlclVucmVnaXN0ZXJfID0gJHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oZnVuY3Rpb24gKCkge1xuICAgIGlmIChnbWZUcmVlTWFuYWdlci5yb290Q3RybCkge1xuICAgICAgcmV0dXJuIGdtZlRyZWVNYW5hZ2VyLnJvb3RDdHJsLmNoaWxkcmVuO1xuICAgIH1cblxuICAgIHJldHVybiBbXTtcbiAgfSwgdXBkYXRlRWRpdGFibGVUcmVlQ3RybHMpO1xuICB0aGlzLmRpcnR5ID0gZmFsc2U7XG4gIHRoaXMuZWRpdGFibGVUcmVlQ3RybHMgPSBbXTtcbiAgdGhpcy5zZWxlY3RlZEVkaXRhYmxlVHJlZUN0cmwgPSBudWxsO1xuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuc2VsZWN0ZWRFZGl0YWJsZVRyZWVDdHJsO1xuICB9LCBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgX3RoaXMuZGlydHkgPSBmYWxzZTtcbiAgICBfdGhpcy5zdGF0ZSA9IEVkaXRpbmdTdGF0ZS5JRExFO1xuICB9KTtcbiAgdGhpcy5zdGF0ZSA9IEVkaXRpbmdTdGF0ZS5JRExFO1xuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuc3RhdGU7XG4gIH0sIGZ1bmN0aW9uIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICBpZiAobmV3VmFsdWUgPT09IEVkaXRpbmdTdGF0ZS5TVE9QX0VESVRJTkdfRVhFQ1VURSB8fCBuZXdWYWx1ZSA9PT0gRWRpdGluZ1N0YXRlLkRFQUNUSVZBVEVfRVhFQ1VURSkge1xuICAgICAgX3RoaXMuc2VsZWN0ZWRFZGl0YWJsZVRyZWVDdHJsID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAobmV3VmFsdWUgPT09IEVkaXRpbmdTdGF0ZS5ERUFDVElWQVRFX0VYRUNVVEUpIHtcbiAgICAgIF90aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH1cbiAgfSk7XG4gICRzY29wZS4kb24oJyRkZXN0cm95JywgdGhpcy5oYW5kbGVEZXN0cm95Xy5iaW5kKHRoaXMpKTtcbn1cblxuQ29udHJvbGxlci5wcm90b3R5cGUuc3RvcEVkaXRpbmcgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuc3RhdGUgPSBFZGl0aW5nU3RhdGUuU1RPUF9FRElUSU5HX1BFTkRJTkc7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVBY3RpdmVDaGFuZ2VfID0gZnVuY3Rpb24gKGFjdGl2ZSkge1xuICB2YXIgX3RoaXMyID0gdGhpcztcblxuICBpZiAoIWFjdGl2ZSkge1xuICAgIGlmICghdGhpcy5kaXJ0eSkge1xuICAgICAgdGhpcy5zdG9wRWRpdGluZygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiR0aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMi5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIF90aGlzMi5zdG9wRWRpdGluZygpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVEZXN0cm95XyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy50cmVlQ3RybHNXYXRjaGVyVW5yZWdpc3Rlcl8oKTtcbn07XG5cbm1vZHVsZS5jb250cm9sbGVyKCdHbWZFZGl0ZmVhdHVyZXNlbGVjdG9yQ29udHJvbGxlcicsIENvbnRyb2xsZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IGdtZkVkaXRpbmdFZGl0RmVhdHVyZSBmcm9tICdnbWYvZWRpdGluZy9FZGl0RmVhdHVyZS5qcyc7XG5pbXBvcnQgZ21mRWRpdGluZ0VkaXRGZWF0dXJlQ29tcG9uZW50IGZyb20gJ2dtZi9lZGl0aW5nL2VkaXRGZWF0dXJlQ29tcG9uZW50LmpzJztcbmltcG9ydCBnbWZFZGl0aW5nRWRpdEZlYXR1cmVTZWxlY3RvckNvbXBvbmVudCBmcm9tICdnbWYvZWRpdGluZy9lZGl0RmVhdHVyZVNlbGVjdG9yQ29tcG9uZW50LmpzJztcbmltcG9ydCBnbWZFZGl0aW5nRW51bWVyYXRlQXR0cmlidXRlIGZyb20gJ2dtZi9lZGl0aW5nL0VudW1lcmF0ZUF0dHJpYnV0ZS5qcyc7XG5pbXBvcnQgZ21mRWRpdGluZ1NuYXBwaW5nIGZyb20gJ2dtZi9lZGl0aW5nL1NuYXBwaW5nLmpzJztcbmltcG9ydCBnbWZFZGl0aW5nWFNEQXR0cmlidXRlcyBmcm9tICdnbWYvZWRpdGluZy9YU0RBdHRyaWJ1dGVzLmpzJztcbmV4cG9ydCBkZWZhdWx0IGFuZ3VsYXIubW9kdWxlKCdnbWZFZGl0aW5nTW9kdWxlJywgW2dtZkVkaXRpbmdFZGl0RmVhdHVyZS5uYW1lLCBnbWZFZGl0aW5nRWRpdEZlYXR1cmVDb21wb25lbnQubmFtZSwgZ21mRWRpdGluZ0VkaXRGZWF0dXJlU2VsZWN0b3JDb21wb25lbnQubmFtZSwgZ21mRWRpdGluZ0VudW1lcmF0ZUF0dHJpYnV0ZS5uYW1lLCBnbWZFZGl0aW5nU25hcHBpbmcubmFtZSwgZ21mRWRpdGluZ1hTREF0dHJpYnV0ZXMubmFtZV0pOyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyByZW1vdmUgYXMgcmVtb3ZlRnJvbUFycmF5IH0gZnJvbSAnb2wvYXJyYXkuanMnO1xuZXhwb3J0IHZhciBTYXZlZEZpbHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgU2F2ZWRGaWx0ZXIuJGluamVjdCA9IFtcIiRyb290U2NvcGVcIl07XG5cbiAgZnVuY3Rpb24gU2F2ZWRGaWx0ZXIoJHJvb3RTY29wZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB0aGlzLnJvb3RTY29wZV8gPSAkcm9vdFNjb3BlO1xuICAgIHRoaXMuY3VycmVudERhdGFTb3VyY2VJZF8gPSBudWxsO1xuICAgIHRoaXMuY3VycmVudERhdGFTb3VyY2VJdGVtc18gPSBbXTtcbiAgICB0aGlzLmxvY2FsU3RvcmFnZUtleV8gPSAnZ21mX3NhdmVkZmlsdGVycyc7XG4gICAgdGhpcy51c2VMb2NhbFN0b3JhZ2VfID0gdHJ1ZTtcblxuICAgIHRyeSB7XG4gICAgICBpZiAoJ2xvY2FsU3RvcmFnZScgaW4gd2luZG93KSB7XG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2VbJ3Rlc3QnXSA9ICcnO1xuICAgICAgICBkZWxldGUgd2luZG93LmxvY2FsU3RvcmFnZVsndGVzdCddO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy51c2VMb2NhbFN0b3JhZ2VfID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB0aGlzLnVzZUxvY2FsU3RvcmFnZV8gPSBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLml0ZW1zXyA9IFtdO1xuICAgIHRoaXMucm9vdFNjb3BlXy4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5pdGVtcztcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5yZVBvcHVsYXRlQ3VycmVudERhdGFTb3VyY2VJdGVtc18oKTtcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLnVzZUxvY2FsU3RvcmFnZV8pIHtcbiAgICAgIHRoaXMubG9hZEl0ZW1zRnJvbUxvY2FsU3RvcmFnZV8oKTtcbiAgICB9XG4gIH1cblxuICB2YXIgX3Byb3RvID0gU2F2ZWRGaWx0ZXIucHJvdG90eXBlO1xuXG4gIF9wcm90by5sb2FkSXRlbXNGcm9tTG9jYWxTdG9yYWdlXyA9IGZ1bmN0aW9uIGxvYWRJdGVtc0Zyb21Mb2NhbFN0b3JhZ2VfKCkge1xuICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlW3RoaXMubG9jYWxTdG9yYWdlS2V5X10pIHtcbiAgICAgIHZhciBpdGVtcyA9IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZVt0aGlzLmxvY2FsU3RvcmFnZUtleV9dKTtcblxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGl0ZW1zKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGl0ZW1zIHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5pdGVtc18gPSBpdGVtcztcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmluZGV4T2ZJdGVtID0gZnVuY3Rpb24gaW5kZXhPZkl0ZW0obmFtZSwgaWQpIHtcbiAgICB2YXIgaXRlbTtcbiAgICB2YXIgaWR4ID0gLTE7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLml0ZW1zXy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICBpdGVtID0gdGhpcy5pdGVtc1tpXTtcblxuICAgICAgaWYgKGl0ZW0uZGF0YVNvdXJjZUlkID09PSBpZCAmJiBpdGVtLm5hbWUgPT09IG5hbWUpIHtcbiAgICAgICAgaWR4ID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGlkeDtcbiAgfTtcblxuICBfcHJvdG8uc2F2ZSA9IGZ1bmN0aW9uIHNhdmUoaXRlbSkge1xuICAgIHZhciBpZHggPSB0aGlzLmluZGV4T2ZJdGVtKGl0ZW0ubmFtZSwgaXRlbS5kYXRhU291cmNlSWQpO1xuXG4gICAgaWYgKGlkeCAhPT0gLTEpIHtcbiAgICAgIHRoaXMuaXRlbXNbaWR4XSA9IGl0ZW07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy51c2VMb2NhbFN0b3JhZ2VfKSB7XG4gICAgICB0aGlzLnNhdmVJdGVtc0luTG9jYWxTdG9yYWdlXygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKGl0ZW0pIHtcbiAgICB2YXIgZm91bmQgPSByZW1vdmVGcm9tQXJyYXkodGhpcy5pdGVtcywgaXRlbSk7XG5cbiAgICBpZiAoZm91bmQgJiYgdGhpcy51c2VMb2NhbFN0b3JhZ2VfKSB7XG4gICAgICB0aGlzLnNhdmVJdGVtc0luTG9jYWxTdG9yYWdlXygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uc2F2ZUl0ZW1zSW5Mb2NhbFN0b3JhZ2VfID0gZnVuY3Rpb24gc2F2ZUl0ZW1zSW5Mb2NhbFN0b3JhZ2VfKCkge1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2VbdGhpcy5sb2NhbFN0b3JhZ2VLZXlfXSA9IEpTT04uc3RyaW5naWZ5KHRoaXMuaXRlbXMpO1xuICB9O1xuXG4gIF9wcm90by5yZVBvcHVsYXRlQ3VycmVudERhdGFTb3VyY2VJdGVtc18gPSBmdW5jdGlvbiByZVBvcHVsYXRlQ3VycmVudERhdGFTb3VyY2VJdGVtc18oKSB7XG4gICAgdGhpcy5jdXJyZW50RGF0YVNvdXJjZUl0ZW1zXy5sZW5ndGggPSAwO1xuXG4gICAgaWYgKHRoaXMuY3VycmVudERhdGFTb3VyY2VJZF8gIT09IG51bGwpIHtcbiAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IHRoaXMuaXRlbXMsIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IpLCBfaSA9IDAsIF9pdGVyYXRvciA9IF9pc0FycmF5ID8gX2l0ZXJhdG9yIDogX2l0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgIHZhciBfcmVmO1xuXG4gICAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICAgIGlmIChfaSA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICBfcmVmID0gX2l0ZXJhdG9yW19pKytdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9pID0gX2l0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgICBpZiAoX2kuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGl0ZW0gPSBfcmVmO1xuXG4gICAgICAgIGlmIChpdGVtLmRhdGFTb3VyY2VJZCA9PT0gdGhpcy5jdXJyZW50RGF0YVNvdXJjZUlkXykge1xuICAgICAgICAgIHRoaXMuY3VycmVudERhdGFTb3VyY2VJdGVtc18ucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfY3JlYXRlQ2xhc3MoU2F2ZWRGaWx0ZXIsIFt7XG4gICAga2V5OiBcImN1cnJlbnREYXRhU291cmNlSXRlbXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhU291cmNlSXRlbXNfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjdXJyZW50RGF0YVNvdXJjZUlkXCIsXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQoaWQpIHtcbiAgICAgIHRoaXMuY3VycmVudERhdGFTb3VyY2VJZF8gPSBpZDtcbiAgICAgIHRoaXMucmVQb3B1bGF0ZUN1cnJlbnREYXRhU291cmNlSXRlbXNfKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIml0ZW1zXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5pdGVtc187XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFNhdmVkRmlsdGVyO1xufSgpO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZTYXZlZEZpbHRlcnMnLCBbXSk7XG5tb2R1bGUuc2VydmljZSgnZ21mU2F2ZWRGaWx0ZXJzJywgU2F2ZWRGaWx0ZXIpO1xuZXhwb3J0IGZ1bmN0aW9uIFNhdmVkRmlsdGVySXRlbSgpIHt9XG5TYXZlZEZpbHRlckl0ZW0ucHJvdG90eXBlLmNvbmRpdGlvbjtcblNhdmVkRmlsdGVySXRlbS5wcm90b3R5cGUuY3VzdG9tUnVsZXM7XG5TYXZlZEZpbHRlckl0ZW0ucHJvdG90eXBlLmRhdGFTb3VyY2VJZDtcblNhdmVkRmlsdGVySXRlbS5wcm90b3R5cGUuZGlyZWN0ZWRSdWxlcztcblNhdmVkRmlsdGVySXRlbS5wcm90b3R5cGUubmFtZTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuaW1wb3J0IGdtZkF1dGhlbnRpY2F0aW9uU2VydmljZSBmcm9tICdnbWYvYXV0aGVudGljYXRpb24vU2VydmljZS5qcyc7XG5pbXBvcnQgZ21mRGF0YXNvdXJjZURhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkIGZyb20gJ2dtZi9kYXRhc291cmNlL0RhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkLmpzJztcbmltcG9ydCBnbWZEYXRhc291cmNlSGVscGVyIGZyb20gJ2dtZi9kYXRhc291cmNlL0hlbHBlci5qcyc7XG5pbXBvcnQgR21mRGF0YXNvdXJjZU9HQyBmcm9tICdnbWYvZGF0YXNvdXJjZS9PR0MuanMnO1xuaW1wb3J0IGdtZkZpbHRlcnNTYXZlZEZpbHRlcnMgZnJvbSAnZ21mL2ZpbHRlcnMvU2F2ZWRGaWx0ZXJzLmpzJztcbmltcG9ydCBuZ2VvTWVzc2FnZU1vZGFsQ29tcG9uZW50IGZyb20gJ25nZW8vbWVzc2FnZS9tb2RhbENvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb01lc3NhZ2VOb3RpZmljYXRpb24gZnJvbSAnbmdlby9tZXNzYWdlL05vdGlmaWNhdGlvbi5qcyc7XG5pbXBvcnQgeyBNZXNzYWdlVHlwZSB9IGZyb20gJ25nZW8vbWVzc2FnZS9NZXNzYWdlLmpzJztcbmltcG9ydCBuZ2VvRmlsdGVyUnVsZUhlbHBlciBmcm9tICduZ2VvL2ZpbHRlci9SdWxlSGVscGVyLmpzJztcbmltcG9ydCBuZ2VvRmlsdGVyQ29tcG9uZW50IGZyb20gJ25nZW8vZmlsdGVyL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4sIHVubGlzdGVuQnlLZXkgfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IHsgcmVtb3ZlIGFzIHJlbW92ZUZyb21BcnJheSB9IGZyb20gJ29sL2FycmF5LmpzJztcbmltcG9ydCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXlNZ3IgZnJvbSAnbmdlby9tYXAvRmVhdHVyZU92ZXJsYXlNZ3IuanMnO1xuaW1wb3J0ICdib290c3RyYXAvanMvc3JjL2Ryb3Bkb3duLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mRmlsdGVyc2VsZWN0b3InLCBbZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlLm5hbWUsIGdtZkRhdGFzb3VyY2VEYXRhU291cmNlQmVpbmdGaWx0ZXJlZC5uYW1lLCBnbWZEYXRhc291cmNlSGVscGVyLm5hbWUsIG5nZW9NYXBGZWF0dXJlT3ZlcmxheU1nci5uYW1lLCBuZ2VvTWVzc2FnZU5vdGlmaWNhdGlvbi5uYW1lLCBuZ2VvTWVzc2FnZU1vZGFsQ29tcG9uZW50Lm5hbWUsIG5nZW9GaWx0ZXJSdWxlSGVscGVyLm5hbWUsIG5nZW9GaWx0ZXJDb21wb25lbnQubmFtZSwgZ21mRmlsdGVyc1NhdmVkRmlsdGVycy5uYW1lXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi9maWx0ZXJzL2ZpbHRlcnNlbGVjdG9yY29tcG9uZW50JywgcmVxdWlyZSgnLi9maWx0ZXJzZWxlY3RvcmNvbXBvbmVudC5odG1sJykpO1xufV0pO1xubW9kdWxlLnZhbHVlKCdnbWZGaWx0ZXJzZWxlY3RvclRlbXBsYXRlVXJsJywgZnVuY3Rpb24gKCRhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSAkYXR0cnMuZ21mRmlsdGVyc2VsZWN0b3JUZW1wbGF0ZVVybDtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICdnbWYvZmlsdGVycy9maWx0ZXJzZWxlY3RvcmNvbXBvbmVudCc7XG59KTtcbmdtZkZpbHRlcnNlbGVjdG9yVGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRhdHRyc1wiLCBcImdtZkZpbHRlcnNlbGVjdG9yVGVtcGxhdGVVcmxcIl07XG5cbmZ1bmN0aW9uIGdtZkZpbHRlcnNlbGVjdG9yVGVtcGxhdGVVcmwoJGF0dHJzLCBnbWZGaWx0ZXJzZWxlY3RvclRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBnbWZGaWx0ZXJzZWxlY3RvclRlbXBsYXRlVXJsKCRhdHRycyk7XG59XG5cbnZhciBGaWx0ZXJTZWxlY3RvckNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIEZpbHRlclNlbGVjdG9yQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJHRpbWVvdXRcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcImdtZkRhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkXCIsIFwiZ21mRGF0YVNvdXJjZXNIZWxwZXJcIiwgXCJnbWZTYXZlZEZpbHRlcnNcIiwgXCJnbWZVc2VyXCIsIFwibmdlb05vdGlmaWNhdGlvblwiLCBcIm5nZW9GZWF0dXJlT3ZlcmxheU1nclwiLCBcIm5nZW9SdWxlSGVscGVyXCJdO1xuXG4gIGZ1bmN0aW9uIEZpbHRlclNlbGVjdG9yQ29udHJvbGxlcigkc2NvcGUsICR0aW1lb3V0LCBnZXR0ZXh0Q2F0YWxvZywgZ21mRGF0YVNvdXJjZUJlaW5nRmlsdGVyZWQsIGdtZkRhdGFTb3VyY2VzSGVscGVyLCBnbWZTYXZlZEZpbHRlcnMsIGdtZlVzZXIsIG5nZW9Ob3RpZmljYXRpb24sIG5nZW9GZWF0dXJlT3ZlcmxheU1nciwgbmdlb1J1bGVIZWxwZXIpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLm1hcCA9IG51bGw7XG4gICAgdGhpcy50b29sR3JvdXAgPSBudWxsO1xuICAgIHRoaXMudGltZW91dF8gPSAkdGltZW91dDtcbiAgICB0aGlzLmdldHRleHRDYXRhbG9nXyA9IGdldHRleHRDYXRhbG9nO1xuICAgIHRoaXMuZ21mRGF0YVNvdXJjZUJlaW5nRmlsdGVyZWQgPSBnbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZDtcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5nbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZC5kYXRhU291cmNlO1xuICAgIH0sIHRoaXMuaGFuZGxlU2VsZWN0ZWREYXRhU291cmNlQ2hhbmdlXy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmdtZkRhdGFTb3VyY2VzSGVscGVyXyA9IGdtZkRhdGFTb3VyY2VzSGVscGVyO1xuICAgIHRoaXMuZ21mU2F2ZWRGaWx0ZXJzID0gZ21mU2F2ZWRGaWx0ZXJzO1xuICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5nbWZTYXZlZEZpbHRlcnMuY3VycmVudERhdGFTb3VyY2VJdGVtcztcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoX3RoaXMuZ21mU2F2ZWRGaWx0ZXJzLmN1cnJlbnREYXRhU291cmNlSXRlbXMubGVuZ3RoID09PSAwICYmIF90aGlzLnNhdmVGaWx0ZXJNYW5hZ2VNb2RhbFNob3duKSB7XG4gICAgICAgIF90aGlzLnNhdmVGaWx0ZXJNYW5hZ2VNb2RhbFNob3duID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5nbWZVc2VyXyA9IGdtZlVzZXI7XG4gICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMuZ21mVXNlcl8uZnVuY3Rpb25hbGl0aWVzO1xuICAgIH0sIHRoaXMuaGFuZGxlR21mVXNlckZ1bmN0aW9uYWxpdGllc0NoYW5nZV8uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5uZ2VvTm90aWZpY2F0aW9uXyA9IG5nZW9Ob3RpZmljYXRpb247XG4gICAgdGhpcy5mZWF0dXJlT3ZlcmxheSA9IG5nZW9GZWF0dXJlT3ZlcmxheU1nci5nZXRGZWF0dXJlT3ZlcmxheSgpO1xuICAgIHRoaXMubmdlb1J1bGVIZWxwZXJfID0gbmdlb1J1bGVIZWxwZXI7XG4gICAgdGhpcy5hUnVsZUlzQWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5jdXN0b21SdWxlcyA9IG51bGw7XG4gICAgdGhpcy5kaXJlY3RlZFJ1bGVzID0gbnVsbDtcbiAgICB0aGlzLmZpbHRyYWJsZURhdGFTb3VyY2VzID0gW107XG4gICAgdGhpcy5maWx0cmFibGVMYXllck5vZGVOYW1lc18gPSBudWxsO1xuICAgIHRoaXMuZ21mRGF0YVNvdXJjZXNfID0gZ21mRGF0YVNvdXJjZXNIZWxwZXIuY29sbGVjdGlvbjtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgICB0aGlzLnJlYWR5RGF0YVNvdXJjZSA9IG51bGw7XG4gICAgdGhpcy5ydWxlQ2FjaGVfID0ge307XG4gICAgdGhpcy5zYXZlRmlsdGVyU2F2ZU1vZGFsU2hvd24gPSBmYWxzZTtcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5zYXZlRmlsdGVyU2F2ZU1vZGFsU2hvd247XG4gICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuc2F2ZUZpbHRlck5hbWUgPSAnJztcbiAgICB9KTtcbiAgICB0aGlzLnNhdmVGaWx0ZXJOYW1lID0gJyc7XG4gICAgdGhpcy5zYXZlRmlsdGVyTWFuYWdlTW9kYWxTaG93biA9IGZhbHNlO1xuICAgIHRoaXMuZW5hYmxlRGF0YVNvdXJjZVJlZ2lzdHJhdGlvbl8gPSBmYWxzZTtcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5lbmFibGVEYXRhU291cmNlUmVnaXN0cmF0aW9uXztcbiAgICB9LCB0aGlzLmhhbmRsZUVuYWJsZURhdGFTb3VyY2VSZWdpc3RyYXRpb25DaGFuZ2VfLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZGVmYXVsdEZpbHRyYWJsZURhdGFTb3VyY2VOYW1lXyA9IG51bGw7XG4gICAgdGhpcy50b2dnbGVEYXRhU291cmNlUmVnaXN0cmF0aW9uXygpO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IEZpbHRlclNlbGVjdG9yQ29udHJvbGxlci5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmhhbmRsZUdtZlVzZXJGdW5jdGlvbmFsaXRpZXNDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlR21mVXNlckZ1bmN0aW9uYWxpdGllc0NoYW5nZV8oKSB7XG4gICAgdmFyIHVzckZ1bmMgPSB0aGlzLmdtZlVzZXJfLmZ1bmN0aW9uYWxpdGllcztcblxuICAgIGlmICh1c3JGdW5jICYmIHVzckZ1bmMuZmlsdGVyYWJsZV9sYXllcnMpIHtcbiAgICAgIHRoaXMuZmlsdHJhYmxlTGF5ZXJOb2RlTmFtZXNfID0gdXNyRnVuYy5maWx0ZXJhYmxlX2xheWVycztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5maWx0cmFibGVMYXllck5vZGVOYW1lc18gPSBudWxsO1xuICAgIH1cblxuICAgIGlmICh1c3JGdW5jICYmIHVzckZ1bmMucHJlc2V0X2xheWVyX2ZpbHRlciAmJiB1c3JGdW5jLnByZXNldF9sYXllcl9maWx0ZXJbMF0pIHtcbiAgICAgIHRoaXMuZGVmYXVsdEZpbHRyYWJsZURhdGFTb3VyY2VOYW1lXyA9IHVzckZ1bmMucHJlc2V0X2xheWVyX2ZpbHRlclswXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kZWZhdWx0RmlsdHJhYmxlRGF0YVNvdXJjZU5hbWVfID0gbnVsbDtcbiAgICB9XG5cbiAgICB0aGlzLnRvZ2dsZURhdGFTb3VyY2VSZWdpc3RyYXRpb25fKCk7XG4gIH07XG5cbiAgX3Byb3RvLnRvZ2dsZURhdGFTb3VyY2VSZWdpc3RyYXRpb25fID0gZnVuY3Rpb24gdG9nZ2xlRGF0YVNvdXJjZVJlZ2lzdHJhdGlvbl8oKSB7XG4gICAgdmFyIG5ld0RhdGFTb3VyY2VSZWdpc3RyYXRpb24gPSAhIXRoaXMuZmlsdHJhYmxlTGF5ZXJOb2RlTmFtZXNfO1xuXG4gICAgaWYgKHRoaXMuZW5hYmxlRGF0YVNvdXJjZVJlZ2lzdHJhdGlvbl8gIT09IG5ld0RhdGFTb3VyY2VSZWdpc3RyYXRpb24pIHtcbiAgICAgIHRoaXMuZW5hYmxlRGF0YVNvdXJjZVJlZ2lzdHJhdGlvbl8gPSBuZXdEYXRhU291cmNlUmVnaXN0cmF0aW9uO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRW5hYmxlRGF0YVNvdXJjZVJlZ2lzdHJhdGlvbkNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVFbmFibGVEYXRhU291cmNlUmVnaXN0cmF0aW9uQ2hhbmdlXyhyZWdpc3Rlcikge1xuICAgIHZhciBrZXlzID0gdGhpcy5saXN0ZW5lcktleXNfO1xuXG4gICAgaWYgKHJlZ2lzdGVyKSB7XG4gICAgICBrZXlzLnB1c2gobGlzdGVuKHRoaXMuZ21mRGF0YVNvdXJjZXNfLCAnYWRkJywgdGhpcy5oYW5kbGVEYXRhU291cmNlc0FkZF8sIHRoaXMpLCBsaXN0ZW4odGhpcy5nbWZEYXRhU291cmNlc18sICdyZW1vdmUnLCB0aGlzLmhhbmRsZURhdGFTb3VyY2VzUmVtb3ZlXywgdGhpcykpO1xuICAgICAgdGhpcy5nbWZEYXRhU291cmNlc18uZm9yRWFjaCh0aGlzLnJlZ2lzdGVyRGF0YVNvdXJjZV8uYmluZCh0aGlzKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGtleXMuZm9yRWFjaCh1bmxpc3RlbkJ5S2V5KTtcbiAgICAgIGtleXMubGVuZ3RoID0gMDtcbiAgICAgIHRoaXMuZmlsdHJhYmxlRGF0YVNvdXJjZXMubGVuZ3RoID0gMDtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZURhdGFTb3VyY2VzQWRkXyA9IGZ1bmN0aW9uIGhhbmRsZURhdGFTb3VyY2VzQWRkXyhldnQpIHtcbiAgICBpZiAoZXZ0IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgICB2YXIgZGF0YVNvdXJjZSA9IGV2dC5lbGVtZW50O1xuXG4gICAgICBpZiAoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIEdtZkRhdGFzb3VyY2VPR0MpIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlckRhdGFTb3VyY2VfKGRhdGFTb3VyY2UpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRGF0YVNvdXJjZXNSZW1vdmVfID0gZnVuY3Rpb24gaGFuZGxlRGF0YVNvdXJjZXNSZW1vdmVfKGV2dCkge1xuICAgIGlmIChldnQgaW5zdGFuY2VvZiBDb2xsZWN0aW9uRXZlbnQpIHtcbiAgICAgIHZhciBkYXRhU291cmNlID0gZXZ0LmVsZW1lbnQ7XG5cbiAgICAgIGlmIChkYXRhU291cmNlIGluc3RhbmNlb2YgR21mRGF0YXNvdXJjZU9HQykge1xuICAgICAgICB0aGlzLnVucmVnaXN0ZXJEYXRhU291cmNlXyhkYXRhU291cmNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnJlZ2lzdGVyRGF0YVNvdXJjZV8gPSBmdW5jdGlvbiByZWdpc3RlckRhdGFTb3VyY2VfKGRhdGFTb3VyY2UpIHtcbiAgICBpZiAoZGF0YVNvdXJjZS5maWx0cmFibGUgPT09IG51bGwpIHtcbiAgICAgIGRhdGFTb3VyY2UuZmlsdHJhYmxlID0gdGhpcy5pc0RhdGFTb3VyY2VGaWx0cmFibGVfKGRhdGFTb3VyY2UpO1xuICAgIH1cblxuICAgIGlmIChkYXRhU291cmNlLmZpbHRyYWJsZSkge1xuICAgICAgdGhpcy5maWx0cmFibGVEYXRhU291cmNlcy5wdXNoKGRhdGFTb3VyY2UpO1xuXG4gICAgICBpZiAodGhpcy5kZWZhdWx0RmlsdHJhYmxlRGF0YVNvdXJjZU5hbWVfICE9PSB1bmRlZmluZWQgJiYgZGF0YVNvdXJjZS5uYW1lID09PSB0aGlzLmRlZmF1bHRGaWx0cmFibGVEYXRhU291cmNlTmFtZV8pIHtcbiAgICAgICAgdGhpcy5nbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZC5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnVucmVnaXN0ZXJEYXRhU291cmNlXyA9IGZ1bmN0aW9uIHVucmVnaXN0ZXJEYXRhU291cmNlXyhkYXRhU291cmNlKSB7XG4gICAgaWYgKGRhdGFTb3VyY2UuZmlsdHJhYmxlKSB7XG4gICAgICByZW1vdmVGcm9tQXJyYXkodGhpcy5maWx0cmFibGVEYXRhU291cmNlcywgZGF0YVNvdXJjZSk7XG5cbiAgICAgIGlmICh0aGlzLmdtZkRhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkLmRhdGFTb3VyY2UgPT09IGRhdGFTb3VyY2UpIHtcbiAgICAgICAgdGhpcy5nbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZC5kYXRhU291cmNlID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmlzRGF0YVNvdXJjZUZpbHRyYWJsZV8gPSBmdW5jdGlvbiBpc0RhdGFTb3VyY2VGaWx0cmFibGVfKGRhdGFTb3VyY2UsIG9wdF9ub3RpZnkpIHtcbiAgICBpZiAoIXRoaXMuZmlsdHJhYmxlTGF5ZXJOb2RlTmFtZXNfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmlsdHJhYmxlTGF5ZXJOb2RlTmFtZXMnKTtcbiAgICB9XG5cbiAgICB2YXIgZmlsdHJhYmxlID0gdHJ1ZTtcbiAgICB2YXIgZ2V0dGV4dCA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICAgIHZhciBub3RpZnkgPSBvcHRfbm90aWZ5ICE9PSBmYWxzZTtcbiAgICB2YXIgbmFtZXMgPSB0aGlzLmZpbHRyYWJsZUxheWVyTm9kZU5hbWVzXztcbiAgICB2YXIgbXNncyA9IFtdO1xuXG4gICAgaWYgKG5hbWVzLmluY2x1ZGVzKGRhdGFTb3VyY2UubmFtZSkpIHtcbiAgICAgIGlmICghZGF0YVNvdXJjZS5zdXBwb3J0c1dGUykge1xuICAgICAgICBtc2dzLnB1c2goZ2V0dGV4dC5nZXRTdHJpbmcoJ1RoZSBkYXRhIHNvdXJjZSBkb2VzblxcJ3Qgc3VwcG9ydCBXRlMsIHdoaWNoIGlzIHJlcXVpcmVkICcgKyAndG8gZmV0Y2ggdGhlIGF0dHJpYnV0ZXMgdG8gYnVpbGQgdGhlIGZpbHRlciBydWxlcy4nKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICghZGF0YVNvdXJjZS53ZnNMYXllcnMgfHwgIWRhdGFTb3VyY2Uud2ZzTGF5ZXJzLmxlbmd0aCkge1xuICAgICAgICBtc2dzLnB1c2goZ2V0dGV4dC5nZXRTdHJpbmcoJ1RoZSBkYXRhIHNvdXJjZSBtdXN0IGhhdmUgb25seSAxIHdmc0xheWVyIGRlZmluZWQuJykpO1xuICAgICAgfSBlbHNlIGlmICghZGF0YVNvdXJjZS53ZnNMYXllcnNbMF0ucXVlcnlhYmxlKSB7XG4gICAgICAgIG1zZ3MucHVzaChnZXR0ZXh0LmdldFN0cmluZygnVGhlIHdmc0xheWVyIHdpdGhpbiB0aGUgZGF0YSBzb3VyY2UgbXVzdCBiZSBxdWVyeWFibGUuJykpO1xuICAgICAgfVxuXG4gICAgICBmaWx0cmFibGUgPSAhbXNncy5sZW5ndGg7XG5cbiAgICAgIGlmIChub3RpZnkgJiYgIWZpbHRyYWJsZSkge1xuICAgICAgICB2YXIgcDEgPSBnZXR0ZXh0LmdldFN0cmluZyhcIlRoZSBmb2xsb3dpbmcgZGF0YSBzb3VyY2UgaXMgbWFya2VkIGFzIGJlaW5nIGZpbHRyYWJsZSxcXG4gICAgICAgICAgYnV0IGlzIG1pc3Npbmcgc29tZSByZXF1aXJlbWVudHM6IFwiKTtcbiAgICAgICAgdmFyIHAyID0gZGF0YVNvdXJjZS5uYW1lICsgXCIgKFwiICsgZGF0YVNvdXJjZS5pZCArIFwiKS5cIjtcbiAgICAgICAgdmFyIHAzID0gZ2V0dGV4dC5nZXRTdHJpbmcoXCJQbGVhc2UsIGNvbnRhY3QgeW91ciBhZG1pbmlzdHJhdG9yIGFib3V0IHRoaXMuXFxuICAgICAgICAgIEhlcmUgYXJlIHRoZSByZWFzb25zOiBcIik7XG4gICAgICAgIG1zZ3MudW5zaGlmdChwMSArIFwiIFwiICsgcDIgKyBcIiBcIiArIHAzKTtcbiAgICAgICAgY29uc29sZS53YXJuKG1zZ3Muam9pbignICcpKTtcbiAgICAgICAgdGhpcy5uZ2VvTm90aWZpY2F0aW9uXy5ub3RpZnkoe1xuICAgICAgICAgIG1zZzogbXNncy5qb2luKCcgJyksXG4gICAgICAgICAgdHlwZTogTWVzc2FnZVR5cGUuV0FSTklOR1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZmlsdHJhYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbHRyYWJsZTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlU2VsZWN0ZWREYXRhU291cmNlQ2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZVNlbGVjdGVkRGF0YVNvdXJjZUNoYW5nZV8oZGF0YVNvdXJjZSkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdGhpcy5hUnVsZUlzQWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5jdXN0b21SdWxlcyA9IG51bGw7XG4gICAgdGhpcy5kaXJlY3RlZFJ1bGVzID0gbnVsbDtcbiAgICB0aGlzLnJlYWR5RGF0YVNvdXJjZSA9IG51bGw7XG4gICAgdGhpcy5nbWZTYXZlZEZpbHRlcnMuY3VycmVudERhdGFTb3VyY2VJZCA9IG51bGw7XG5cbiAgICBpZiAoIWRhdGFTb3VyY2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XG4gICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XG4gICAgfVxuXG4gICAgdGhpcy5nbWZEYXRhU291cmNlc0hlbHBlcl8ucHJlcGFyZUZpbHRyYWJsZURhdGFTb3VyY2UoZGF0YVNvdXJjZSkudGhlbihmdW5jdGlvbiAoZGF0YVNvdXJjZSkge1xuICAgICAgdmFyIGl0ZW0gPSBfdGhpczIuZ2V0UnVsZUNhY2hlSXRlbV8oZGF0YVNvdXJjZSk7XG5cbiAgICAgIGlmICghaXRlbSkge1xuICAgICAgICBpdGVtID0ge1xuICAgICAgICAgIGN1c3RvbVJ1bGVzOiBbXSxcbiAgICAgICAgICBkaXJlY3RlZFJ1bGVzOiBbXVxuICAgICAgICB9O1xuXG4gICAgICAgIF90aGlzMi5zZXRSdWxlQ2FjaGVJdGVtXyhkYXRhU291cmNlLCBpdGVtKTtcblxuICAgICAgICBpZiAoZGF0YVNvdXJjZS5nbWZMYXllci5tZXRhZGF0YSAmJiBkYXRhU291cmNlLmdtZkxheWVyLm1ldGFkYXRhLmRpcmVjdGVkRmlsdGVyQXR0cmlidXRlcyAmJiBkYXRhU291cmNlLmdtZkxheWVyLm1ldGFkYXRhLmRpcmVjdGVkRmlsdGVyQXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICB2YXIgZGlyZWN0ZWRBdHRyaWJ1dGVzID0gZGF0YVNvdXJjZS5nbWZMYXllci5tZXRhZGF0YS5kaXJlY3RlZEZpbHRlckF0dHJpYnV0ZXM7XG4gICAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBkYXRhU291cmNlLmF0dHJpYnV0ZXM7XG5cbiAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBhdHRyaWJ1dGVzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICAgICAgdmFyIF9yZWY7XG5cbiAgICAgICAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gX3JlZjtcblxuICAgICAgICAgICAgaWYgKGRpcmVjdGVkQXR0cmlidXRlcy5pbmNsdWRlcyhhdHRyaWJ1dGUubmFtZSkpIHtcbiAgICAgICAgICAgICAgaXRlbS5kaXJlY3RlZFJ1bGVzLnB1c2goX3RoaXMyLm5nZW9SdWxlSGVscGVyXy5jcmVhdGVSdWxlRnJvbUF0dHJpYnV0ZShhdHRyaWJ1dGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgX3RoaXMyLmN1c3RvbVJ1bGVzID0gaXRlbS5jdXN0b21SdWxlcztcbiAgICAgIF90aGlzMi5kaXJlY3RlZFJ1bGVzID0gaXRlbS5kaXJlY3RlZFJ1bGVzO1xuICAgICAgX3RoaXMyLnJlYWR5RGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG4gICAgICBfdGhpczIuZ21mU2F2ZWRGaWx0ZXJzLmN1cnJlbnREYXRhU291cmNlSWQgPSBkYXRhU291cmNlLmlkO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5nZXRSdWxlQ2FjaGVJdGVtXyA9IGZ1bmN0aW9uIGdldFJ1bGVDYWNoZUl0ZW1fKGRhdGFTb3VyY2UpIHtcbiAgICByZXR1cm4gdGhpcy5ydWxlQ2FjaGVfW2RhdGFTb3VyY2UuaWRdIHx8IG51bGw7XG4gIH07XG5cbiAgX3Byb3RvLnNldFJ1bGVDYWNoZUl0ZW1fID0gZnVuY3Rpb24gc2V0UnVsZUNhY2hlSXRlbV8oZGF0YVNvdXJjZSwgaXRlbSkge1xuICAgIHRoaXMucnVsZUNhY2hlX1tkYXRhU291cmNlLmlkXSA9IGl0ZW07XG4gIH07XG5cbiAgX3Byb3RvLnNhdmVGaWx0ZXJTaG93TW9kYWwgPSBmdW5jdGlvbiBzYXZlRmlsdGVyU2hvd01vZGFsKCkge1xuICAgIHRoaXMuc2F2ZUZpbHRlclNhdmVNb2RhbFNob3duID0gdHJ1ZTtcbiAgfTtcblxuICBfcHJvdG8uc2F2ZUZpbHRlclNhdmUgPSBmdW5jdGlvbiBzYXZlRmlsdGVyU2F2ZSgpIHtcbiAgICBpZiAoIXRoaXMucmVhZHlEYXRhU291cmNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVhZHlEYXRhU291cmNlJyk7XG4gICAgfVxuXG4gICAgdmFyIG5hbWUgPSB0aGlzLnNhdmVGaWx0ZXJOYW1lO1xuICAgIHZhciBkYXRhU291cmNlID0gdGhpcy5yZWFkeURhdGFTb3VyY2U7XG4gICAgdmFyIGRhdGFTb3VyY2VJZCA9IGRhdGFTb3VyY2UuaWQ7XG4gICAgdmFyIGFscmVhZHlFeGlzdCA9IHRoaXMuZ21mU2F2ZWRGaWx0ZXJzLmluZGV4T2ZJdGVtKG5hbWUsIGRhdGFTb3VyY2VJZCkgIT09IC0xO1xuICAgIHZhciBjb25kaXRpb24gPSBkYXRhU291cmNlLmZpbHRlckNvbmRpdGlvbjtcbiAgICB2YXIgbXNnID0gdGhpcy5nZXR0ZXh0Q2F0YWxvZ18uZ2V0U3RyaW5nKFwiQSBmaWx0ZXIgd2l0aCB0aGUgc2FtZSBuYW1lIGFscmVhZHkgZXhpc3RzLlxcbiAgICAgIERvIHlvdSB3YW50IHRvIG92ZXJ3cml0ZSBpdD9cIik7XG5cbiAgICBpZiAoIWFscmVhZHlFeGlzdCB8fCBjb25maXJtKG1zZykpIHtcbiAgICAgIHZhciBjdXN0b21SdWxlcyA9IHRoaXMuY3VzdG9tUnVsZXMgPyB0aGlzLm5nZW9SdWxlSGVscGVyXy5zZXJpYWxpemVSdWxlcyh0aGlzLmN1c3RvbVJ1bGVzKSA6IFtdO1xuICAgICAgdmFyIGRpcmVjdGVkUnVsZXMgPSB0aGlzLmRpcmVjdGVkUnVsZXMgPyB0aGlzLm5nZW9SdWxlSGVscGVyXy5zZXJpYWxpemVSdWxlcyh0aGlzLmRpcmVjdGVkUnVsZXMpIDogW107XG4gICAgICB2YXIgaXRlbSA9IHtcbiAgICAgICAgY29uZGl0aW9uOiBjb25kaXRpb24sXG4gICAgICAgIGN1c3RvbVJ1bGVzOiBjdXN0b21SdWxlcyxcbiAgICAgICAgZGF0YVNvdXJjZUlkOiBkYXRhU291cmNlSWQsXG4gICAgICAgIGRpcmVjdGVkUnVsZXM6IGRpcmVjdGVkUnVsZXMsXG4gICAgICAgIG5hbWU6IG5hbWVcbiAgICAgIH07XG4gICAgICB0aGlzLmdtZlNhdmVkRmlsdGVycy5zYXZlKGl0ZW0pO1xuICAgICAgdGhpcy5zYXZlRmlsdGVyU2F2ZU1vZGFsU2hvd24gPSBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnNhdmVGaWx0ZXJMb2FkSXRlbSA9IGZ1bmN0aW9uIHNhdmVGaWx0ZXJMb2FkSXRlbShmaWx0ZXJJdGVtKSB7XG4gICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICBpZiAoIXRoaXMucmVhZHlEYXRhU291cmNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVhZHlEYXRhU291cmNlJyk7XG4gICAgfVxuXG4gICAgdmFyIGRhdGFTb3VyY2UgPSB0aGlzLnJlYWR5RGF0YVNvdXJjZTtcbiAgICB0aGlzLmN1c3RvbVJ1bGVzID0gbnVsbDtcbiAgICB0aGlzLmRpcmVjdGVkUnVsZXMgPSBudWxsO1xuICAgIHZhciBjdXN0b21SdWxlcyA9IHRoaXMubmdlb1J1bGVIZWxwZXJfLmNyZWF0ZVJ1bGVzKGZpbHRlckl0ZW0uY3VzdG9tUnVsZXMpO1xuICAgIHZhciBkaXJlY3RlZFJ1bGVzID0gdGhpcy5uZ2VvUnVsZUhlbHBlcl8uY3JlYXRlUnVsZXMoZmlsdGVySXRlbS5kaXJlY3RlZFJ1bGVzKTtcbiAgICB0aGlzLnRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzMy5jdXN0b21SdWxlcyA9IGN1c3RvbVJ1bGVzO1xuICAgICAgX3RoaXMzLmRpcmVjdGVkUnVsZXMgPSBkaXJlY3RlZFJ1bGVzO1xuICAgICAgZGF0YVNvdXJjZS5maWx0ZXJDb25kaXRpb24gPSBmaWx0ZXJJdGVtLmNvbmRpdGlvbjtcblxuICAgICAgdmFyIGNhY2hlSXRlbSA9IF90aGlzMy5nZXRSdWxlQ2FjaGVJdGVtXyhkYXRhU291cmNlKTtcblxuICAgICAgaWYgKCFjYWNoZUl0ZW0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNhY2hlSXRlbScpO1xuICAgICAgfVxuXG4gICAgICBjYWNoZUl0ZW0uY3VzdG9tUnVsZXMgPSBjdXN0b21SdWxlcztcbiAgICAgIGNhY2hlSXRlbS5kaXJlY3RlZFJ1bGVzID0gZGlyZWN0ZWRSdWxlcztcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uc2F2ZUZpbHRlck1hbmFnZSA9IGZ1bmN0aW9uIHNhdmVGaWx0ZXJNYW5hZ2UoKSB7XG4gICAgdGhpcy5zYXZlRmlsdGVyTWFuYWdlTW9kYWxTaG93biA9IHRydWU7XG4gIH07XG5cbiAgX3Byb3RvLnNhdmVGaWx0ZXJSZW1vdmVJdGVtID0gZnVuY3Rpb24gc2F2ZUZpbHRlclJlbW92ZUl0ZW0oaXRlbSkge1xuICAgIHRoaXMuZ21mU2F2ZWRGaWx0ZXJzLnJlbW92ZShpdGVtKTtcbiAgfTtcblxuICByZXR1cm4gRmlsdGVyU2VsZWN0b3JDb250cm9sbGVyO1xufSgpO1xuXG5tb2R1bGUuY29tcG9uZW50KCdnbWZGaWx0ZXJzZWxlY3RvcicsIHtcbiAgYmluZGluZ3M6IHtcbiAgICBhY3RpdmU6ICc9JyxcbiAgICBtYXA6ICc8JyxcbiAgICB0b29sR3JvdXA6ICc8JyxcbiAgICBmaWx0ZXJJc0FwcGxpZWQ6ICc9J1xuICB9LFxuICBjb250cm9sbGVyOiBGaWx0ZXJTZWxlY3RvckNvbnRyb2xsZXIsXG4gIHRlbXBsYXRlVXJsOiBnbWZGaWx0ZXJzZWxlY3RvclRlbXBsYXRlVXJsXG59KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaikge1xub2JqIHx8IChvYmogPSB7fSk7XG52YXIgX190LCBfX3AgPSAnJztcbndpdGggKG9iaikge1xuX19wICs9ICc8ZGl2XFxuICAgIGNsYXNzPVwiZm9ybS1ncm91cFwiXFxuICAgIG5nLXN3aXRjaD1cIiRjdHJsLmZpbHRyYWJsZURhdGFTb3VyY2VzLmxlbmd0aFwiPlxcbiAgPHNwYW4gbmctc3dpdGNoLXdoZW49XCIwXCIgdHJhbnNsYXRlPk5vIGZpbHRyYWJsZSBsYXllciBhdmFpbGFibGUhPC9zcGFuPlxcbiAgPHNlbGVjdFxcbiAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICBuZy1kaXNhYmxlZD1cIiRjdHJsLmFSdWxlSXNBY3RpdmVcIlxcbiAgICAgIG5nLXN3aXRjaC1kZWZhdWx0XFxuICAgICAgbmctbW9kZWw9XCIkY3RybC5nbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZC5kYXRhU291cmNlXCJcXG4gICAgICBuZy1vcHRpb25zPVwiZGF0YVNvdXJjZS5uYW1lIHwgdHJhbnNsYXRlIGZvciBkYXRhU291cmNlIGluICRjdHJsLmZpbHRyYWJsZURhdGFTb3VyY2VzXCI+XFxuICAgIDxvcHRpb24gdmFsdWU9XCJcIiB0cmFuc2xhdGU+LS0gTGF5ZXIgdG8gZmlsdGVyIC0tPC9vcHRpb24+XFxuICA8L3NlbGVjdD5cXG5cXG4gIDxkaXYgbmctaWY9XCIkY3RybC5jdXN0b21SdWxlcyAmJiAkY3RybC5kaXJlY3RlZFJ1bGVzICYmICRjdHJsLnJlYWR5RGF0YVNvdXJjZVwiPlxcbiAgICA8aHIgY2xhc3M9XCJnbWYtZmlsdGVyc2VsZWN0b3Itc2VwYXJhdG9yXCIgLz5cXG5cXG4gICAgPGRpdiBjbGFzcz1cImRyb3Bkb3duIGdtZi1maWx0ZXJzZWxlY3Rvci1zYXZlZGZpbHRlcnNcIj5cXG4gICAgICA8YnV0dG9uXFxuICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1saW5rIGRyb3Bkb3duLXRvZ2dsZSBuZ2VvLWZpbHRlci1jb25kaXRpb24tYnV0dG9uXCJcXG4gICAgICAgICAgbmctY2xhc3M9XCJ7ZGlzYWJsZWQ6ICRjdHJsLmFSdWxlSXNBY3RpdmUgfHwgJGN0cmwuZ21mU2F2ZWRGaWx0ZXJzLmN1cnJlbnREYXRhU291cmNlSXRlbXMubGVuZ3RoID09PSAwfVwiXFxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJcXG4gICAgICAgICAgbmctZGlzYWJsZWQ9XCIkY3RybC5hUnVsZUlzQWN0aXZlIHx8ICRjdHJsLmdtZlNhdmVkRmlsdGVycy5jdXJyZW50RGF0YVNvdXJjZUl0ZW1zLmxlbmd0aCA9PT0gMFwiPlxcbiAgICAgICAgPHNwYW4gdHJhbnNsYXRlPlNhdmVkPC9zcGFuPlxcbiAgICAgIDwvYnV0dG9uPlxcbiAgICAgIDx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIj5cXG4gICAgICAgIDxsaSBuZy1yZXBlYXQ9XCJpdGVtIGluICRjdHJsLmdtZlNhdmVkRmlsdGVycy5jdXJyZW50RGF0YVNvdXJjZUl0ZW1zXCI+XFxuICAgICAgICAgIDxhXFxuICAgICAgICAgICAgICBocmVmXFxuICAgICAgICAgICAgICBuZy1jbGljaz1cIiRjdHJsLnNhdmVGaWx0ZXJMb2FkSXRlbShpdGVtKVwiPlxcbiAgICAgICAgICAgIDxzcGFuPnt7OjppdGVtLm5hbWV9fTwvc3Bhbj5cXG4gICAgICAgICAgPC9hPlxcbiAgICAgICAgPC9saT5cXG4gICAgICAgIDxsaSByb2xlPVwic2VwYXJhdG9yXCIgY2xhc3M9XCJkaXZpZGVyXCI+PC9saT5cXG4gICAgICAgIDxsaT5cXG4gICAgICAgICAgPGFcXG4gICAgICAgICAgICAgIGhyZWZcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuc2F2ZUZpbHRlck1hbmFnZSgpXCI+XFxuICAgICAgICAgICAgPHNwYW4gdHJhbnNsYXRlPk1hbmFnZSBzYXZlZCBmaWx0ZXJzPC9zcGFuPlxcbiAgICAgICAgICA8L2E+XFxuICAgICAgICA8L2xpPlxcbiAgICAgIDwvdWw+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8bmdlby1maWx0ZXJcXG4gICAgICAgIGEtcnVsZS1pcy1hY3RpdmU9XCIkY3RybC5hUnVsZUlzQWN0aXZlXCJcXG4gICAgICAgIGN1c3RvbS1ydWxlcz1cIiRjdHJsLmN1c3RvbVJ1bGVzXCJcXG4gICAgICAgIGRhdGFzb3VyY2U9XCIkY3RybC5yZWFkeURhdGFTb3VyY2VcIlxcbiAgICAgICAgZGlyZWN0ZWQtcnVsZXM9XCIkY3RybC5kaXJlY3RlZFJ1bGVzXCJcXG4gICAgICAgIGZlYXR1cmUtb3ZlcmxheT1cIiRjdHJsLmZlYXR1cmVPdmVybGF5XCJcXG4gICAgICAgIGZpbHRlci1pcy1hcHBsaWVkPVwiJGN0cmwuZmlsdGVySXNBcHBsaWVkXCJcXG4gICAgICAgIG1hcD1cIiRjdHJsLm1hcFwiXFxuICAgICAgICB0b29sLWdyb3VwPVwiJGN0cmwudG9vbEdyb3VwXCI+XFxuICAgIDwvbmdlby1maWx0ZXI+XFxuXFxuICAgIDxkaXY+XFxuICAgICAgPGJ1dHRvblxcbiAgICAgICAgICBjbGFzcz1cImJ0biBidG4tbGluayBnbWYtZmlsdGVyc2VsZWN0b3Itc2F2ZWJ0blwiXFxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICBuZy1jbGljaz1cIiEkY3RybC5hUnVsZUlzQWN0aXZlICYmICRjdHJsLnNhdmVGaWx0ZXJTaG93TW9kYWwoKVwiXFxuICAgICAgICAgIG5nLWRpc2FibGVkPVwiJGN0cmwuYVJ1bGVJc0FjdGl2ZVwiPlxcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS1zYXZlXCI+PC9zcGFuPlxcbiAgICAgICAgPHNwYW4gdHJhbnNsYXRlPlNhdmU8L3NwYW4+XFxuICAgICAgPC9idXR0b24+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuXFxuICA8bmdlby1tb2RhbCBuZy1tb2RlbD1cIiRjdHJsLnNhdmVGaWx0ZXJTYXZlTW9kYWxTaG93blwiPlxcbiAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyIHVpLWRyYWdnYWJsZS1oYW5kbGVcIj5cXG4gICAgICA8aDQgY2xhc3M9XCJtb2RhbC10aXRsZVwiPnt7XFwnU2F2ZSBmaWx0ZXJcXCcgfCB0cmFuc2xhdGV9fTwvaDQ+XFxuICAgICAgPGJ1dHRvblxcbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgY2xhc3M9XCJjbG9zZVwiXFxuICAgICAgICAgIGRhdGEtZGlzbWlzcz1cIm1vZGFsXCJcXG4gICAgICAgICAgYXJpYS1sYWJlbD1cInt7XFwnQ2xvc2VcXCcgfCB0cmFuc2xhdGV9fVwiPlxcbiAgICAgICAgPHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+JnRpbWVzOzwvc3Bhbj5cXG4gICAgICA8L2J1dHRvbj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XFxuICAgICAgPHAgY2xhc3M9XCJnbWYtZmlsdGVyc2VsZWN0b3Itc2F2ZWZpbHRlci1kZXNjXCIgdHJhbnNsYXRlPlxcbiAgICAgICAgWW91IGNhbiBzYXZlIHRoZSBmaWx0ZXIgdGhhdCB5b3UgY3JlYXRlZCB0byByZS1sb2FkIGl0IGxhdGVyLlxcbiAgICAgIDwvcD5cXG4gICAgICA8aW5wdXRcXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgIG5hbWU9XCJuYW1lXCJcXG4gICAgICAgICAgbmctbW9kZWw9XCIkY3RybC5zYXZlRmlsdGVyTmFtZVwiXFxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwie3tcXCdGaWx0ZXIgbmFtZVxcJyB8IHRyYW5zbGF0ZX19XCIgLz5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cXG4gICAgICA8YnV0dG9uXFxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdFwiXFxuICAgICAgICAgIGRhdGEtZGlzbWlzcz1cIm1vZGFsXCI+e3tcXCdDYW5jZWxcXCcgfCB0cmFuc2xhdGV9fTwvYnV0dG9uPlxcbiAgICAgIDxidXR0b25cXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuc2F2ZUZpbHRlclNhdmUoKVwiXFxuICAgICAgICAgIG5nLWRpc2FibGVkPVwiJGN0cmwuc2F2ZUZpbHRlck5hbWUgPT09IFxcJ1xcJ1wiXFxuICAgICAgICAgIGNsYXNzPVwiYnRuIHByaW1lXCI+e3tcXCdTYXZlXFwnIHwgdHJhbnNsYXRlfX08L2J1dHRvbj5cXG4gICAgPC9kaXY+XFxuICA8L25nZW8tbW9kYWw+XFxuXFxuICA8bmdlby1tb2RhbCBuZy1tb2RlbD1cIiRjdHJsLnNhdmVGaWx0ZXJNYW5hZ2VNb2RhbFNob3duXCI+XFxuICAgIDxkaXYgY2xhc3M9XCJnbWYtZmlsdGVyc2VsZWN0b3ItbWFuYWdlZmlsdGVyLW1vZGFsXCI+XFxuICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlciB1aS1kcmFnZ2FibGUtaGFuZGxlXCI+XFxuICAgICAgICA8aDQgY2xhc3M9XCJtb2RhbC10aXRsZVwiPnt7XFwnTWFuYWdlIGZpbHRlcnNcXCcgfCB0cmFuc2xhdGV9fTwvaDQ+XFxuICAgICAgICA8YnV0dG9uXFxuICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgICAgICAgY2xhc3M9XCJjbG9zZVwiXFxuICAgICAgICAgICAgZGF0YS1kaXNtaXNzPVwibW9kYWxcIlxcbiAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJ7e1xcJ0Nsb3NlXFwnIHwgdHJhbnNsYXRlfX1cIj5cXG4gICAgICAgICAgPHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+JnRpbWVzOzwvc3Bhbj5cXG4gICAgICAgIDwvYnV0dG9uPlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XFxuICAgICAgICA8dWw+XFxuICAgICAgICAgIDxsaSBuZy1yZXBlYXQ9XCJpdGVtIGluICRjdHJsLmdtZlNhdmVkRmlsdGVycy5jdXJyZW50RGF0YVNvdXJjZUl0ZW1zXCI+XFxuICAgICAgICAgICAgPHNwYW4+e3s6Oml0ZW0ubmFtZX19PC9zcGFuPlxcbiAgICAgICAgICAgIDxhXFxuICAgICAgICAgICAgICAgIGhyZWZcXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCIkY3RybC5zYXZlRmlsdGVyUmVtb3ZlSXRlbShpdGVtKVwiPlxcbiAgICAgICAgICAgICAgICB7eyBcXCdEZWxldGVcXCcgfCB0cmFuc2xhdGUgfX1cXG4gICAgICAgICAgICA8L2E+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImdtZi1lb2xcIj48L2Rpdj5cXG4gICAgICAgICAgPC9saT5cXG4gICAgICAgIDwvdWw+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxcbiAgICAgICAgPGJ1dHRvblxcbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0XCJcXG4gICAgICAgICAgICBkYXRhLWRpc21pc3M9XCJtb2RhbFwiPnt7XFwnQ2xvc2VcXCcgfCB0cmFuc2xhdGV9fTwvYnV0dG9uPlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gIDwvbmdlby1tb2RhbD5cXG5cXG48L2Rpdj5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mRmlsdGVyc0ZpbHRlcnNlbGVjdG9yQ29tcG9uZW50IGZyb20gJ2dtZi9maWx0ZXJzL2ZpbHRlcnNlbGVjdG9yQ29tcG9uZW50LmpzJztcbmltcG9ydCBnbWZGaWx0ZXJzU2F2ZWRGaWx0ZXJzIGZyb20gJ2dtZi9maWx0ZXJzL1NhdmVkRmlsdGVycy5qcyc7XG5leHBvcnQgZGVmYXVsdCBhbmd1bGFyLm1vZHVsZSgnZ21mRmlsdGVyc01vZHVsZScsIFtnbWZGaWx0ZXJzRmlsdGVyc2VsZWN0b3JDb21wb25lbnQubmFtZSwgZ21mRmlsdGVyc1NhdmVkRmlsdGVycy5uYW1lXSk7IiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB3aWR0aD1cXFwiMTZcXFwiIGhlaWdodD1cXFwiMTZcXFwiPjxwYXRoIGQ9XFxcIk0xLjE0IDhjMC0xLjI0Mi4zMDgtMi4zODMuOTItMy40MzJhNi44MzcgNi44MzcgMCAwMTIuNDk2LTIuNDk2IDYuNjg0IDYuNjg0IDAgMDEzLjQzMi0uOTJjMS4yNDIgMCAyLjM4My4zMDggMy40MzIuOTJhNi44MzcgNi44MzcgMCAwMTIuNDk2IDIuNDk2Yy42MTIgMS4wNDkuOTIgMi4xOS45MiAzLjQzMmE2LjY4IDYuNjggMCAwMS0uNTc3IDIuNzQ2Yy40MDkuNDQ0LjY1MSAxLjAzOS41OTMgMS42NTMtLjA2IDEuMDY0LS45NTYgMi4wMjItMi4wMjggMi4wOWEyLjI1NCAyLjI1NCAwIDAxLTEuNTkxLS40NjcgNi42ODIgNi42ODIgMCAwMS0zLjI0NS44MjYgNi42ODQgNi42ODQgMCAwMS0zLjQzMi0uOTIgNi44MzcgNi44MzcgMCAwMS0yLjQ5Ni0yLjQ5NkE2LjY4NCA2LjY4NCAwIDAxMS4xNCA4em0xLjEzOCAwYzAgLjc3Mi4xNSAxLjUxLjQ1MyAyLjIxNWE1LjcwNyA1LjcwNyAwIDAwMS4yMTYgMS44MSA1LjgxNiA1LjgxNiAwIDAwMS44MjYgMS4yMTcgNS41MzMgNS41MzMgMCAwMDIuMjE1LjQ2OGMuNzczLS4wMDEgMS41MS0uMTY2IDIuMjE1LS40NjguMTEtLjA0OC4yMjItLjEwNC4zMjgtLjE1Ni0uMDAzLS4wMDctLjAxNC0uMDEtLjAxNi0uMDE2YTIuMjExIDIuMjExIDAgMDEtLjE1Ni0uODc0Yy0uMDA4LTEuMjYgMS4yMy0yLjM0OSAyLjQ4LTIuMTg0LjE0NS4wMTQuMjg1LjA1LjQyMi4wOTQuMDA0LjAwMS4wMS0uMDAyLjAxNSAwIC4yNzQtLjY3LjQyMS0xLjM3My40MjEtMi4xMDYgMC0uNzczLS4xNjQtMS41MTEtLjQ2OC0yLjIxNWE1LjgwMSA1LjgwMSAwIDAwLTEuMjE2LTEuODI1IDUuNzExIDUuNzExIDAgMDAtMS44MS0xLjIxNyA1LjU1MyA1LjU1MyAwIDAwLTIuMjE1LS40NTMgNS41MyA1LjUzIDAgMDAtMi4yMTUuNDUzQTUuODA1IDUuODA1IDAgMDAzLjk0NyAzLjk2YTUuNzg2IDUuNzg2IDAgMDAtMS4yMTYgMS44MjVBNS41NDMgNS41NDMgMCAwMDIuMjc4IDh6bTkuNDM4IDQuMjQzYS43ODQuNzg0IDAgMDAuMTEuNDIxLjk3Ljk3IDAgMDAuMDQ2LjA3OC44NzMuODczIDAgMDAuMjAzLjIwM2MuMDE3LjAxMy4wMy4wMzUuMDQ3LjA0Ny4wMS4wMDcuMDIxLjAxLjAzMS4wMTZhLjc3OS43NzkgMCAwMC44MTEuMDYyYy4zNy0uMTU5LjU3OS0uNTk1LjUxNS0uOTgzdi0uMDE1YS43NTEuNzUxIDAgMDAtLjE3Mi0uMzYuNzkyLjc5MiAwIDAwLS4xNTYtLjE1NWMtLjAyLS4wMTUtLjA0LS4wMTgtLjA2Mi0uMDMxYS45MzEuOTMxIDAgMDAtLjExLS4wNjNjLS4wNC0uMDE3LS4wODEtLjAzNS0uMTI0LS4wNDctLjAyNi0uMDA3LS4wNTEtLjAxLS4wNzgtLjAxNWExLjA3OCAxLjA3OCAwIDAwLS4yMTgtLjAxNmMuMDA0LS4wMDYuMDExLS4wMS4wMTUtLjAxNWEuOC44IDAgMDAtLjU2MS4yMzQuODc0Ljg3NCAwIDAwLS4yOTcuNjR6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAxNiAxNlxcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk0xLjE0IDhjMC0xLjI0Mi4zMDgtMi4zODMuOTItMy40MzJhNi44MzcgNi44MzcgMCAwMTIuNDk2LTIuNDk2IDYuNjg0IDYuNjg0IDAgMDEzLjQzMi0uOTJjMS4yNDIgMCAyLjM4My4zMDggMy40MzIuOTJhNi44MzcgNi44MzcgMCAwMTIuNDk2IDIuNDk2Yy42MTIgMS4wNDkuOTIgMi4xOS45MiAzLjQzMmE2LjY4IDYuNjggMCAwMS0uNTc3IDIuNzQ2Yy40MDkuNDQ0LjY1MSAxLjAzOS41OTMgMS42NTMtLjA2IDEuMDY0LS45NTYgMi4wMjItMi4wMjggMi4wOWEyLjI1NCAyLjI1NCAwIDAxLTEuNTkxLS40NjcgNi42ODIgNi42ODIgMCAwMS0zLjI0NS44MjYgNi42ODQgNi42ODQgMCAwMS0zLjQzMi0uOTIgNi44MzcgNi44MzcgMCAwMS0yLjQ5Ni0yLjQ5NkE2LjY4NCA2LjY4NCAwIDAxMS4xNCA4em0xLjEzOCAwYzAgLjc3Mi4xNSAxLjUxLjQ1MyAyLjIxNWE1LjcwNyA1LjcwNyAwIDAwMS4yMTYgMS44MSA1LjgxNiA1LjgxNiAwIDAwMS44MjYgMS4yMTcgNS41MzMgNS41MzMgMCAwMDIuMjE1LjQ2OGMuNzczLS4wMDEgMS41MS0uMTY2IDIuMjE1LS40NjguMTEtLjA0OC4yMjItLjEwNC4zMjgtLjE1Ni0uMDAzLS4wMDctLjAxNC0uMDEtLjAxNi0uMDE2YTIuMjExIDIuMjExIDAgMDEtLjE1Ni0uODc0Yy0uMDA4LTEuMjYgMS4yMy0yLjM0OSAyLjQ4LTIuMTg0LjE0NS4wMTQuMjg1LjA1LjQyMi4wOTQuMDA0LjAwMS4wMS0uMDAyLjAxNSAwIC4yNzQtLjY3LjQyMS0xLjM3My40MjEtMi4xMDYgMC0uNzczLS4xNjQtMS41MTEtLjQ2OC0yLjIxNWE1LjgwMSA1LjgwMSAwIDAwLTEuMjE2LTEuODI1IDUuNzExIDUuNzExIDAgMDAtMS44MS0xLjIxNyA1LjU1MyA1LjU1MyAwIDAwLTIuMjE1LS40NTMgNS41MyA1LjUzIDAgMDAtMi4yMTUuNDUzQTUuODA1IDUuODA1IDAgMDAzLjk0NyAzLjk2YTUuNzg2IDUuNzg2IDAgMDAtMS4yMTYgMS44MjVBNS41NDMgNS41NDMgMCAwMDIuMjc4IDh6bTkuNDM4IDQuMjQzYS43ODQuNzg0IDAgMDAuMTEuNDIxLjk3Ljk3IDAgMDAuMDQ2LjA3OC44NzMuODczIDAgMDAuMjAzLjIwM2MuMDE3LjAxMy4wMy4wMzUuMDQ3LjA0Ny4wMS4wMDcuMDIxLjAxLjAzMS4wMTZhLjc3OS43NzkgMCAwMC44MTEuMDYyYy4zNy0uMTU5LjU3OS0uNTk1LjUxNS0uOTgzdi0uMDE1YS43NTEuNzUxIDAgMDAtLjE3Mi0uMzYuNzkyLjc5MiAwIDAwLS4xNTYtLjE1NWMtLjAyLS4wMTUtLjA0LS4wMTgtLjA2Mi0uMDMxYS45MzEuOTMxIDAgMDAtLjExLS4wNjNjLS4wNC0uMDE3LS4wODEtLjAzNS0uMTI0LS4wNDctLjAyNi0uMDA3LS4wNTEtLjAxLS4wNzgtLjAxNWExLjA3OCAxLjA3OCAwIDAwLS4yMTgtLjAxNmMuMDA0LS4wMDYuMDExLS4wMS4wMTUtLjAxNWEuOC44IDAgMDAtLjU2MS4yMzQuODc0Ljg3NCAwIDAwLS4yOTcuNjR6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAxMyAxM1xcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk02LjQ1OCA5LjYzYy0xLjUyMS4wMS0yLjkyNS0xLjI0Ni0zLjA3Mi0yLjc1OC0uMTU2LTEuMjcuNTMzLTIuNjAzIDEuNjg5LTMuMTYyLjk4NC0uNTA2IDIuMjQ4LS40NTQgMy4xNi4xODQuOTYyLjY0MiAxLjU0MiAxLjg0IDEuMzcxIDIuOTk4LS4xNCAxLjEyMS0uOTIxIDIuMTQtMS45ODYgMi41My0uMzY5LjE0My0uNzY1LjIxNy0xLjE2Mi4yMDl6bS0uMDI0LTEuMTAyYy45OTcuMDUyIDEuOTQ5LS43NDggMi4wNzUtMS43MzYuMTIzLS44NDktLjM0NC0xLjc1Ni0xLjEyNC0yLjEyLS44MTEtLjM5NS0xLjg5Mi0uMTgxLTIuNDUzLjUzOC0uNjA3LjcyMi0uNjE5IDEuODguMDExIDIuNTkyLjM2Ni40MzMuOTIxLjcxNSAxLjQ5MS43MjZ6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAyMCAyMFxcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk0xOS45ODQgNi4yNTZMMTAgMS4yNjQuMDE2IDYuMjU2IDEwIDExLjI0OGw5Ljk4NC00Ljk5MnpNMTAgMi45MjFsNi42NyAzLjMzNUwxMCA5LjU5MSAzLjMzIDYuMjU2IDEwIDIuOTIxek0xNy45ODQgOWwyIC45OTlMMTAgMTQuOTkyLjAxNiAxMGwyLTFMMTAgMTIuOTkyem0wIDMuNzQzbDIgMUwxMCAxOC43MzYuMDE2IDEzLjc0NGwyLTFMMTAgMTYuNzM2elxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB3aWR0aD1cXFwiMTZcXFwiIGhlaWdodD1cXFwiMTZcXFwiPjxwYXRoIGQ9XFxcIk02LjYyNi4yNjdDNS4zNjYuMjYgNC4yNyAxLjQ5OCA0LjQzNiAyLjc1Yy4xMDkgMS4xNTMgMS4yMTYgMi4xMjkgMi4zODQgMi4wMTcgMS4wNjQtLjA2IDIuMDMxLS45NiAyLjEtMi4wMzEuMS0uOTc1LS40OTctMS45NzctMS40MjQtMi4zMTNhMi4xOTggMi4xOTggMCAwMC0uODctLjE1NXptLjA0NiAxLjM2NGMuNjA1LS4wMyAxLjA5NS43LjgxOSAxLjI0NC0uMjE1LjQ5OC0uOTMuNzEtMS4zNTMuMzQ0LS4zOTItLjMtLjQ3My0uOTQtLjExMi0xLjI5My4xNi0uMTguNC0uMjk0LjY0NS0uMjk1ek0zLjkxNiA4LjM5N2MtMS4yNTYtLjAwNy0yLjM1MyAxLjIyNS0yLjE5IDIuNDc1LjEwNCAxLjE2IDEuMjIzIDIuMTQyIDIuMzk3IDIuMDIzIDEuMDYyLS4wNjYgMi4wMTktLjk2MiAyLjA4Ny0yLjAzNi4wOTMtLjkzMi0uNDQ2LTEuODkyLTEuMzEyLTIuMjU5YTIuMTkyIDIuMTkyIDAgMDAtLjk4My0uMjAzem0uMDQ4IDEuMzYzYy42MTItLjAyOCAxLjEwNC43MTYuODA3IDEuMjY2LS4yMjguNDkzLS45NC42ODItMS4zNTUuMzEzLS4zNzctLjMtLjQ1Ny0uOTIzLS4xMDYtMS4yNzZhLjg4OS44ODkgMCAwMS42NTQtLjMwM3ptOC4wNSAxLjQ2N2MtMS4yNS0uMDIzLTIuMzUzIDEuMTc4LTIuMjI0IDIuNDIyLjA3NSAxLjE2NSAxLjE3OSAyLjE3NCAyLjM1OCAyLjA3OCAxLjA3LS4wNDMgMi4wNS0uOTM2IDIuMTMtMi4wMTYuMTAzLS45MzYtLjQzNC0xLjkwNS0xLjMwMS0yLjI3OC0uMzAxLS4xNC0uNjMxLS4yMTQtLjk2My0uMjA3em0uMDA4IDEuMzY0Yy42MTUtLjAzNyAxLjExNS43MDguODIxIDEuMjYtLjIxNy40NzgtLjkwNi42ODQtMS4zMjIuMzQ0LS40MjQtLjI5Ny0uNS0uOTc2LS4xMTMtMS4zMzJhLjg3OS44NzkgMCAwMS42MTUtLjI3MnptLTYuODEtMi4xNjNjLS4xNDMuNDE3LS4yODIuODMyLS40MzQgMS4yNDUgMS45Mi42NyAzLjg0IDEuMzMzIDUuNzU1IDIuMDExLjE1My0uNDMyLjI5Ni0uODYzLjQ1NS0xLjI5My0xLjkyLS42Ny0zLjg0MS0xLjMzNS01Ljc1OS0yLjAxMWwtLjAxNy4wNDh6bS40MjYtNi44NzRDNC45NzMgNS40MzYgNC4zMTMgNy4zMiAzLjY0MiA5LjJjLjQzMi4xNS44NjMuMzAyIDEuMjkyLjQ1OC42NjgtMS44OTkgMS4zMzYtMy43OTggMi4wMTItNS42OTQtLjQzMi0uMTUtLjg2Mi0uMzAxLTEuMjktLjQ1OGwtLjAxOC4wNDd6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAxNiAxNlxcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk02LjYyNi4yNjdDNS4zNjYuMjYgNC4yNyAxLjQ5OCA0LjQzNiAyLjc1Yy4xMDkgMS4xNTMgMS4yMTYgMi4xMjkgMi4zODQgMi4wMTcgMS4wNjQtLjA2IDIuMDMxLS45NiAyLjEtMi4wMzEuMS0uOTc1LS40OTctMS45NzctMS40MjQtMi4zMTNhMi4xOTggMi4xOTggMCAwMC0uODctLjE1NXptLjA0NiAxLjM2NGMuNjA1LS4wMyAxLjA5NS43LjgxOSAxLjI0NC0uMjE1LjQ5OC0uOTMuNzEtMS4zNTMuMzQ0LS4zOTItLjMtLjQ3My0uOTQtLjExMi0xLjI5My4xNi0uMTguNC0uMjk0LjY0NS0uMjk1ek0zLjkxNiA4LjM5N2MtMS4yNTYtLjAwNy0yLjM1MyAxLjIyNS0yLjE5IDIuNDc1LjEwNCAxLjE2IDEuMjIzIDIuMTQyIDIuMzk3IDIuMDIzIDEuMDYyLS4wNjYgMi4wMTktLjk2MiAyLjA4Ny0yLjAzNi4wOTMtLjkzMi0uNDQ2LTEuODkyLTEuMzEyLTIuMjU5YTIuMTkyIDIuMTkyIDAgMDAtLjk4My0uMjAzem0uMDQ4IDEuMzYzYy42MTItLjAyOCAxLjEwNC43MTYuODA3IDEuMjY2LS4yMjguNDkzLS45NC42ODItMS4zNTUuMzEzLS4zNzctLjMtLjQ1Ny0uOTIzLS4xMDYtMS4yNzZhLjg4OS44ODkgMCAwMS42NTQtLjMwM3ptOC4wNSAxLjQ2N2MtMS4yNS0uMDIzLTIuMzUzIDEuMTc4LTIuMjI0IDIuNDIyLjA3NSAxLjE2NSAxLjE3OSAyLjE3NCAyLjM1OCAyLjA3OCAxLjA3LS4wNDMgMi4wNS0uOTM2IDIuMTMtMi4wMTYuMTAzLS45MzYtLjQzNC0xLjkwNS0xLjMwMS0yLjI3OC0uMzAxLS4xNC0uNjMxLS4yMTQtLjk2My0uMjA3em0uMDA4IDEuMzY0Yy42MTUtLjAzNyAxLjExNS43MDguODIxIDEuMjYtLjIxNy40NzgtLjkwNi42ODQtMS4zMjIuMzQ0LS40MjQtLjI5Ny0uNS0uOTc2LS4xMTMtMS4zMzJhLjg3OS44NzkgMCAwMS42MTUtLjI3MnptLTYuODEtMi4xNjNjLS4xNDMuNDE3LS4yODIuODMyLS40MzQgMS4yNDUgMS45Mi42NyAzLjg0IDEuMzMzIDUuNzU1IDIuMDExLjE1My0uNDMyLjI5Ni0uODYzLjQ1NS0xLjI5My0xLjkyLS42Ny0zLjg0MS0xLjMzNS01Ljc1OS0yLjAxMWwtLjAxNy4wNDh6bS40MjYtNi44NzRDNC45NzMgNS40MzYgNC4zMTMgNy4zMiAzLjY0MiA5LjJjLjQzMi4xNS44NjMuMzAyIDEuMjkyLjQ1OC42NjgtMS44OTkgMS4zMzYtMy43OTggMi4wMTItNS42OTQtLjQzMi0uMTUtLjg2Mi0uMzAxLTEuMjktLjQ1OGwtLjAxOC4wNDd6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHdpZHRoPVxcXCIxNlxcXCIgaGVpZ2h0PVxcXCIxNlxcXCI+PHBhdGggZD1cXFwiTTcuOTQ4IDEwLjI1Yy0xLjI2LjAwOS0yLjM0OS0xLjIzLTIuMTg0LTIuNDguMTEtMS4xNTMgMS4yMTgtMi4xMjQgMi4zODctMi4wMTMgMS4wNjQuMDYgMi4wMjIuOTU2IDIuMDkgMi4wMjguMS45NzUtLjQ5MiAxLjk3My0xLjQyIDIuMzFhMi4yMTEgMi4yMTEgMCAwMS0uODczLjE1NXptLjA0Ny0xLjM1N2MuNjA2LjAzIDEuMTAzLS43MDMuODI3LTEuMjQ4LS4yMTUtLjQ5OS0uOTM0LS43MDktMS4zNTctLjM0My0uMzkzLjMtLjQ3Ljk0MS0uMTEgMS4yOTUuMTYuMTguMzk1LjI5NS42NC4yOTZ6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAxNiAxNlxcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk03Ljk0OCAxMC4yNWMtMS4yNi4wMDktMi4zNDktMS4yMy0yLjE4NC0yLjQ4LjExLTEuMTUzIDEuMjE4LTIuMTI0IDIuMzg3LTIuMDEzIDEuMDY0LjA2IDIuMDIyLjk1NiAyLjA5IDIuMDI4LjEuOTc1LS40OTIgMS45NzMtMS40MiAyLjMxYTIuMjExIDIuMjExIDAgMDEtLjg3My4xNTV6bS4wNDctMS4zNTdjLjYwNi4wMyAxLjEwMy0uNzAzLjgyNy0xLjI0OC0uMjE1LS40OTktLjkzNC0uNzA5LTEuMzU3LS4zNDMtLjM5My4zLS40Ny45NDEtLjExIDEuMjk1LjE2LjE4LjM5NS4yOTUuNjQuMjk2elxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB3aWR0aD1cXFwiMTZcXFwiIGhlaWdodD1cXFwiMTZcXFwiPjxwYXRoIGQ9XFxcIk01LjA0NS0uMDI5Yy0xLjI2LS4wMDgtMi4zNSAxLjIzLTIuMTg0IDIuNDguMDYuNjMyLjQzIDEuMjAyLjkzNiAxLjU3Ni0uNDc5IDEuMzU4LS45NjggMi43MTQtMS40NSA0LjA3Mi0xLjI1Ny0uMDA4LTIuMzYzIDEuMjMtMi4yIDIuNDguMTA1IDEuMTYgMS4yMjggMi4xMyAyLjQwMiAyLjAxMmEyLjI5NSAyLjI5NSAwIDAwMS40NS0uNjdjMS4yNzMuNTMgMi41NTMgMS4wNTYgMy44MjMgMS41OWExLjk5MiAxLjk5MiAwIDAwMCAuNDM4Yy4wNzQgMS4xNjUgMS4xNzYgMi4xNyAyLjM1NSAyLjA3NCAxLjA3LS4wNDIgMi4wNTctLjkzMiAyLjEzOC0yLjAxMmEyLjI5NSAyLjI5NSAwIDAwLS40NTMtMS42MDdjLjQzNS0uNTkzLjg3My0xLjE4NiAxLjMxLTEuNzc4LjE4Ni4wNC4zNjkuMDQ3LjU2Mi4wMzEgMS4wNjctLjA0NyAyLjA0LS45MzUgMi4xMjItMi4wMTIuMTEtLjk2NC0uNDY0LTEuOTU5LTEuMzczLTIuMzFhMi4yMDIgMi4yMDIgMCAwMC0uMzQzLS4xMDggNDQ0LjI3IDQ0NC4yNyAwIDAxLS4xMjUtMS44NTdjLjc0My0uMzEzIDEuMzI2LTEuMDM2IDEuMzg4LTEuODU2LjExLS45NjQtLjQ2My0xLjk1OC0xLjM3Mi0yLjMwOWEyLjE5NiAyLjE5NiAwIDAwLS45Mi0uMTcyYy0uMDggMC0uMTU4LS4wMDgtLjIzNSAwLS44NDEuMDk4LTEuNTY1Ljc1LTEuODQgMS41NDUtMS4yNi0uMDA0LTIuNTMtLjAwOS0zLjc5MS0uMDE2QzcuMDQ1LjkxOCA2LjU2NC4zNjEgNS45MTkuMTI3YTIuMjExIDIuMjExIDAgMDAtLjg3NC0uMTU2em0uMDQ3IDEuMzU3Yy42MDUtLjAzIDEuMTAzLjcwNC44MjcgMS4yNDgtLjIxNS40OTktLjkzNC43MS0xLjM1OC4zNDMtLjM5Mi0uMjk5LS40Ny0uOTQtLjEwOS0xLjI5NGEuODc0Ljg3NCAwIDAxLjY0LS4yOTd6bTguMDguMDYzYy42Mi0uMDI2IDEuMDk5LjcxOS43OTYgMS4yNjMtLjIzMi40OTgtLjk2Ny42OTItMS4zNzMuMjk3LS4zNjEtLjMwOC0uNDMxLS45MzktLjA3OC0xLjI4YS44OTkuODk5IDAgMDEuNjU2LS4yOHpNNy4yNDYgMi45MTljMS4yNTcuMDA1IDIuNTE3LjAyNCAzLjc3NS4wMzJhMi4zMzMgMi4zMzMgMCAwMDEuNjIyIDEuNTEzYy4wNDMuNjI0LjA4NCAxLjI0OC4xMjUgMS44NzItLjg3Ny4zNzYtMS41MTEgMS4zMjItMS4zODggMi4yOTMuMDQyLjQ4Mi4yNjcuOTQuNTkyIDEuMjk1LS40MTYuNTY3LS44MjYgMS4xMzYtMS4yNDggMS43YTIuMDQ1IDIuMDQ1IDAgMDAtLjY3LS4xMDl2LjAxNmMtLjYzMi0uMDEyLTEuMjM1LjI4Ny0xLjY1NC43NDgtMS4yNi0uNTI1LTIuNTE3LTEuMDYzLTMuNzc1LTEuNTkuMDA1LS4wNDMuMDEzLS4wODMuMDE1LS4xMjZhMi4yNzQgMi4yNzQgMCAwMC0uOTY3LTIuMDc0Yy40NzItMS4zNDIuOTQ0LTIuNjg1IDEuNDItNC4wMjUuMDUyIDAgLjEwNC4wMDUuMTU2IDAgLjg5OC0uMDUgMS43Mi0uNyAxLjk5Ny0xLjU0NXptNi4zOCA0LjYwMmMuNjItLjAyNSAxLjA5OC43Mi43OTYgMS4yNjQtLjIzMy40OTctLjk2Ny42OTEtMS4zNzMuMjk2LS4zNjItLjMwOC0uNDMyLS45MzgtLjA3OC0xLjI3OWEuODk5Ljg5OSAwIDAxLjY1NS0uMjh6TTIuMzkzIDkuNDU2Yy42MTItLjAyOCAxLjEwOS43MjkuODExIDEuMjgtLjIyOC40OTMtLjk0Mi42OC0xLjM1Ny4zMTEtLjM3Ny0uMy0uNDYtLjkyNi0uMTEtMS4yOGEuOS45IDAgMDEuNjU2LS4zMTF6bTcuNjYgMy40MzJjLjYxNS0uMDM3IDEuMTIuNzExLjgyNiAxLjI2My0uMjE3LjQ4LS45MS42ODQtMS4zMjYuMzQ0LS40MjMtLjI5Ny0uNDk1LS45ODYtLjEwOS0xLjM0MmEuODU3Ljg1NyAwIDAxLjYwOS0uMjY1elxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB2aWV3Qm94PVxcXCIwIDAgMTYgMTZcXFwiIHdpZHRoPVxcXCIxZW1cXFwiIGhlaWdodD1cXFwiMWVtXFxcIj48cGF0aCBkPVxcXCJNNS4wNDUtLjAyOWMtMS4yNi0uMDA4LTIuMzUgMS4yMy0yLjE4NCAyLjQ4LjA2LjYzMi40MyAxLjIwMi45MzYgMS41NzYtLjQ3OSAxLjM1OC0uOTY4IDIuNzE0LTEuNDUgNC4wNzItMS4yNTctLjAwOC0yLjM2MyAxLjIzLTIuMiAyLjQ4LjEwNSAxLjE2IDEuMjI4IDIuMTMgMi40MDIgMi4wMTJhMi4yOTUgMi4yOTUgMCAwMDEuNDUtLjY3YzEuMjczLjUzIDIuNTUzIDEuMDU2IDMuODIzIDEuNTlhMS45OTIgMS45OTIgMCAwMDAgLjQzOGMuMDc0IDEuMTY1IDEuMTc2IDIuMTcgMi4zNTUgMi4wNzQgMS4wNy0uMDQyIDIuMDU3LS45MzIgMi4xMzgtMi4wMTJhMi4yOTUgMi4yOTUgMCAwMC0uNDUzLTEuNjA3Yy40MzUtLjU5My44NzMtMS4xODYgMS4zMS0xLjc3OC4xODYuMDQuMzY5LjA0Ny41NjIuMDMxIDEuMDY3LS4wNDcgMi4wNC0uOTM1IDIuMTIyLTIuMDEyLjExLS45NjQtLjQ2NC0xLjk1OS0xLjM3My0yLjMxYTIuMjAyIDIuMjAyIDAgMDAtLjM0My0uMTA4IDQ0NC4yNyA0NDQuMjcgMCAwMS0uMTI1LTEuODU3Yy43NDMtLjMxMyAxLjMyNi0xLjAzNiAxLjM4OC0xLjg1Ni4xMS0uOTY0LS40NjMtMS45NTgtMS4zNzItMi4zMDlhMi4xOTYgMi4xOTYgMCAwMC0uOTItLjE3MmMtLjA4IDAtLjE1OC0uMDA4LS4yMzUgMC0uODQxLjA5OC0xLjU2NS43NS0xLjg0IDEuNTQ1LTEuMjYtLjAwNC0yLjUzLS4wMDktMy43OTEtLjAxNkM3LjA0NS45MTggNi41NjQuMzYxIDUuOTE5LjEyN2EyLjIxMSAyLjIxMSAwIDAwLS44NzQtLjE1NnptLjA0NyAxLjM1N2MuNjA1LS4wMyAxLjEwMy43MDQuODI3IDEuMjQ4LS4yMTUuNDk5LS45MzQuNzEtMS4zNTguMzQzLS4zOTItLjI5OS0uNDctLjk0LS4xMDktMS4yOTRhLjg3NC44NzQgMCAwMS42NC0uMjk3em04LjA4LjA2M2MuNjItLjAyNiAxLjA5OS43MTkuNzk2IDEuMjYzLS4yMzIuNDk4LS45NjcuNjkyLTEuMzczLjI5Ny0uMzYxLS4zMDgtLjQzMS0uOTM5LS4wNzgtMS4yOGEuODk5Ljg5OSAwIDAxLjY1Ni0uMjh6TTcuMjQ2IDIuOTE5YzEuMjU3LjAwNSAyLjUxNy4wMjQgMy43NzUuMDMyYTIuMzMzIDIuMzMzIDAgMDAxLjYyMiAxLjUxM2MuMDQzLjYyNC4wODQgMS4yNDguMTI1IDEuODcyLS44NzcuMzc2LTEuNTExIDEuMzIyLTEuMzg4IDIuMjkzLjA0Mi40ODIuMjY3Ljk0LjU5MiAxLjI5NS0uNDE2LjU2Ny0uODI2IDEuMTM2LTEuMjQ4IDEuN2EyLjA0NSAyLjA0NSAwIDAwLS42Ny0uMTA5di4wMTZjLS42MzItLjAxMi0xLjIzNS4yODctMS42NTQuNzQ4LTEuMjYtLjUyNS0yLjUxNy0xLjA2My0zLjc3NS0xLjU5LjAwNS0uMDQzLjAxMy0uMDgzLjAxNS0uMTI2YTIuMjc0IDIuMjc0IDAgMDAtLjk2Ny0yLjA3NGMuNDcyLTEuMzQyLjk0NC0yLjY4NSAxLjQyLTQuMDI1LjA1MiAwIC4xMDQuMDA1LjE1NiAwIC44OTgtLjA1IDEuNzItLjcgMS45OTctMS41NDV6bTYuMzggNC42MDJjLjYyLS4wMjUgMS4wOTguNzIuNzk2IDEuMjY0LS4yMzMuNDk3LS45NjcuNjkxLTEuMzczLjI5Ni0uMzYyLS4zMDgtLjQzMi0uOTM4LS4wNzgtMS4yNzlhLjg5OS44OTkgMCAwMS42NTUtLjI4ek0yLjM5MyA5LjQ1NmMuNjEyLS4wMjggMS4xMDkuNzI5LjgxMSAxLjI4LS4yMjguNDkzLS45NDIuNjgtMS4zNTcuMzExLS4zNzctLjMtLjQ2LS45MjYtLjExLTEuMjhhLjkuOSAwIDAxLjY1Ni0uMzExem03LjY2IDMuNDMyYy42MTUtLjAzNyAxLjEyLjcxMS44MjYgMS4yNjMtLjIxNy40OC0uOTEuNjg0LTEuMzI2LjM0NC0uNDIzLS4yOTctLjQ5NS0uOTg2LS4xMDktMS4zNDJhLjg1Ny44NTcgMCAwMS42MDktLjI2NXpcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgd2lkdGg9XFxcIjE2XFxcIiBoZWlnaHQ9XFxcIjE2XFxcIj48cGF0aCBkPVxcXCJNMi4zMTcgMTQuNDkxYTIuMjAzIDIuMjAzIDAgMDEtLjg3NC0uMTU2Qy4yNTcgMTMuOTEtLjM0MyAxMi4zOC4yNDIgMTEuMjYyYTIuMjY1IDIuMjY1IDAgMDExLjI4LTEuMTM5bC0uMDE2LTQuMjU4Yy0uMDItLjAwOC0uMDQyLS4wMDgtLjA2My0uMDE2Qy4yNTggNS40MjQtLjM0MyAzLjg5NC4yNDMgMi43NzYuNzQgMS43MzEgMi4xMTUgMS4xOTQgMy4xNzQgMS43Yy41NzIuMjQ2IDEuMDA3Ljc0NyAxLjIxNyAxLjMyNkwxMS42IDMuMDFjLjAyOC0uMDc3LjA1NS0uMTYuMDkzLS4yMzQuNS0xLjA0NSAxLjg3NC0xLjU4MiAyLjkzMy0xLjA3Ni45NzkuNDIyIDEuNTg0IDEuNTkgMS4yOCAyLjYyYTIuMzAyIDIuMzAyIDAgMDEtMS40NjcgMS41NzZsLjAxNiA0LjIyOGMuMDU3LjAyLjExNS4wMzUuMTcxLjA2Mi45NzkuNDIyIDEuNTg0IDEuNTkgMS4yOCAyLjYyMS0uMjQuOTUtMS4xNTEgMS42ODgtMi4xMzcgMS42ODVhMi4yMDMgMi4yMDMgMCAwMS0uODc0LS4xNTZjLS42MjUtLjIyNC0xLjA4My0uNzU3LTEuMjk1LTEuMzczbC03LjIwNy4wMTVjLS4zMDIuODY0LTEuMTUxIDEuNTE2LTIuMDc1IDEuNTEzem0tLjE0LTEuMzU3Yy41MDguMDUyIDEuMDQ1LS40Mi45ODItLjk1MS0uMDMtLjU0Mi0uNjMtLjk3OC0xLjE1NC0uNzgtLjQ3Mi4xNDYtLjc2NC43MTMtLjU0NyAxLjE3LjA4OS4yMjMuMjcuNDEzLjUuNDk5YS43OS43OSAwIDAwLjIxOC4wNjJ6bTExLjQ1IDBjLjUwOS4wNTIgMS4wNDUtLjQyLjk4Mi0uOTUxLS4wMy0uNTQyLS42My0uOTc4LTEuMTU0LS43OC0uNDcyLjE0Ni0uNzY0LjcxMy0uNTQ2IDEuMTcuMDg4LjIyMy4yNy40MTMuNDk5LjQ5OWEuNzkuNzkgMCAwMC4yMTguMDYyek00LjM5IDExLjUyN2w3LjE5Mi0uMDE1Yy4wMy0uMDg0LjA2Ny0uMTcuMTA5LS4yNS4yNTktLjU0Mi43NDctLjk0NCAxLjMxLTEuMTM5VjUuODhjLS4wMzYtLjAxMi0uMDczLS4wMTctLjEwOS0uMDMxLS42MjgtLjIyNS0xLjA4NS0uNzY4LTEuMjk1LTEuMzg4SDQuNDA3YTIuMzM0IDIuMzM0IDAgMDEtMS40MiAxLjQzNWwuMDE1IDQuMjI3Yy4wNTYuMDIuMTE4LjAzNy4xNzIuMDYzLjU3Ni4yNDggMS4wMDkuNzU3IDEuMjE3IDEuMzQyem0tMi4yMTUtNi44OGMuNTEuMDUyIDEuMDQ2LS40Mi45ODMtLjk1LS4wMy0uNTQzLS42My0uOTc5LTEuMTU0LS43ODEtLjQ3Mi4xNDYtLjc2NC43MTQtLjU0NyAxLjE3LjA4OS4yMjQuMjcuNDE0LjUuNWEuNzkuNzkgMCAwMC4yMTguMDYyem0xMS40NSAwYy41MS4wNTIgMS4wNDYtLjQyLjk4My0uOTUtLjAzLS41NDMtLjYzLS45NzktMS4xNTQtLjc4MS0uNDcyLjE0Ni0uNzY0LjcxNC0uNTQ2IDEuMTcuMDg4LjIyNC4yNy40MTQuNDk5LjVhLjc5Ljc5IDAgMDAuMjE4LjA2MnpcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgdmlld0JveD1cXFwiMCAwIDE2IDE2XFxcIiB3aWR0aD1cXFwiMWVtXFxcIiBoZWlnaHQ9XFxcIjFlbVxcXCI+PHBhdGggZD1cXFwiTTIuMzE3IDE0LjQ5MWEyLjIwMyAyLjIwMyAwIDAxLS44NzQtLjE1NkMuMjU3IDEzLjkxLS4zNDMgMTIuMzguMjQyIDExLjI2MmEyLjI2NSAyLjI2NSAwIDAxMS4yOC0xLjEzOWwtLjAxNi00LjI1OGMtLjAyLS4wMDgtLjA0Mi0uMDA4LS4wNjMtLjAxNkMuMjU4IDUuNDI0LS4zNDMgMy44OTQuMjQzIDIuNzc2Ljc0IDEuNzMxIDIuMTE1IDEuMTk0IDMuMTc0IDEuN2MuNTcyLjI0NiAxLjAwNy43NDcgMS4yMTcgMS4zMjZMMTEuNiAzLjAxYy4wMjgtLjA3Ny4wNTUtLjE2LjA5My0uMjM0LjUtMS4wNDUgMS44NzQtMS41ODIgMi45MzMtMS4wNzYuOTc5LjQyMiAxLjU4NCAxLjU5IDEuMjggMi42MmEyLjMwMiAyLjMwMiAwIDAxLTEuNDY3IDEuNTc2bC4wMTYgNC4yMjhjLjA1Ny4wMi4xMTUuMDM1LjE3MS4wNjIuOTc5LjQyMiAxLjU4NCAxLjU5IDEuMjggMi42MjEtLjI0Ljk1LTEuMTUxIDEuNjg4LTIuMTM3IDEuNjg1YTIuMjAzIDIuMjAzIDAgMDEtLjg3NC0uMTU2Yy0uNjI1LS4yMjQtMS4wODMtLjc1Ny0xLjI5NS0xLjM3M2wtNy4yMDcuMDE1Yy0uMzAyLjg2NC0xLjE1MSAxLjUxNi0yLjA3NSAxLjUxM3ptLS4xNC0xLjM1N2MuNTA4LjA1MiAxLjA0NS0uNDIuOTgyLS45NTEtLjAzLS41NDItLjYzLS45NzgtMS4xNTQtLjc4LS40NzIuMTQ2LS43NjQuNzEzLS41NDcgMS4xNy4wODkuMjIzLjI3LjQxMy41LjQ5OWEuNzkuNzkgMCAwMC4yMTguMDYyem0xMS40NSAwYy41MDkuMDUyIDEuMDQ1LS40Mi45ODItLjk1MS0uMDMtLjU0Mi0uNjMtLjk3OC0xLjE1NC0uNzgtLjQ3Mi4xNDYtLjc2NC43MTMtLjU0NiAxLjE3LjA4OC4yMjMuMjcuNDEzLjQ5OS40OTlhLjc5Ljc5IDAgMDAuMjE4LjA2MnpNNC4zOSAxMS41MjdsNy4xOTItLjAxNWMuMDMtLjA4NC4wNjctLjE3LjEwOS0uMjUuMjU5LS41NDIuNzQ3LS45NDQgMS4zMS0xLjEzOVY1Ljg4Yy0uMDM2LS4wMTItLjA3My0uMDE3LS4xMDktLjAzMS0uNjI4LS4yMjUtMS4wODUtLjc2OC0xLjI5NS0xLjM4OEg0LjQwN2EyLjMzNCAyLjMzNCAwIDAxLTEuNDIgMS40MzVsLjAxNSA0LjIyN2MuMDU2LjAyLjExOC4wMzcuMTcyLjA2My41NzYuMjQ4IDEuMDA5Ljc1NyAxLjIxNyAxLjM0MnptLTIuMjE1LTYuODhjLjUxLjA1MiAxLjA0Ni0uNDIuOTgzLS45NS0uMDMtLjU0My0uNjMtLjk3OS0xLjE1NC0uNzgxLS40NzIuMTQ2LS43NjQuNzE0LS41NDcgMS4xNy4wODkuMjI0LjI3LjQxNC41LjVhLjc5Ljc5IDAgMDAuMjE4LjA2MnptMTEuNDUgMGMuNTEuMDUyIDEuMDQ2LS40Mi45ODMtLjk1LS4wMy0uNTQzLS42My0uOTc5LTEuMTU0LS43ODEtLjQ3Mi4xNDYtLjc2NC43MTQtLjU0NiAxLjE3LjA4OC4yMjQuMjcuNDE0LjQ5OS41YS43OS43OSAwIDAwLjIxOC4wNjJ6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAxNSAxNVxcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk01LjExMSAwYy0uNjkyIDAtMS4zNTguMTM4LTEuOTkuNDA3YTUuMDc2IDUuMDc2IDAgMDAtMS42MjUgMS4wODljLS40NTguNDU3LS44Mi45OTQtMS4wOSAxLjYyNkE1LjA0NSA1LjA0NSAwIDAwMCA1LjExMkMwIDUuODAyLjEzOCA2LjQ2OC40MDcgNy4xYTUuMDc2IDUuMDc2IDAgMDAxLjA4OSAxLjYyN2MuNDU3LjQ1Ny45OTQuODIgMS42MjYgMS4wODlhNS4wNDUgNS4wNDUgMCAwMDEuOTkuNDA2YzEuMDY0IDAgMi4wMjItLjMgMi44ODktLjlsMi40OTcgMi40ODNhLjg2Mi44NjIgMCAwMC42NTQuMjc2Yy4yNTEgMCAuNDY5LS4wOTIuNjUzLS4yNzZhLjg5My44OTMgMCAwMC4yNzYtLjY1My44ODMuODgzIDAgMDAtLjI2MS0uNjU0TDkuMzIyIDguMDAxYy4zMjQtLjQ2OC41NjMtLjk1Ni43MTItMS40ODEtLjAwMy0uMDM0LS4wMTUtLjA3LS4wMTUtLjEwMiAwLS4xMDQuMDM3LS4yMTEuMDU4LS4zMmgtLjMzNGMtLjQxNyAwLS45NDEtLjI0Ny0xLjIwNS0uNTUxLS4wNjUtLjA3NS0uMTM1LS4xNTQtLjE4OS0uMjQ3YTMuMTAzIDMuMTAzIDAgMDEtLjk0NCAyLjEwNWMtLjYzNi42MzctMS4zOTkuOTU4LTIuMjk0Ljk1OS0uODk1IDAtMS42NTctLjMyMi0yLjI5NC0uOTU5cy0uOTU4LTEuMzk5LS45NTgtMi4yOTQuMzIxLTEuNjU3Ljk1OC0yLjI5NCAxLjM5OS0uOTU5IDIuMjk0LS45NThjLjg5NSAwIDEuNjU4LjMyMiAyLjI5NC45NTguMzE1LjMxNS41NjcuNjUzLjcyNiAxLjAzLjAyNC0uMzc4LjE4LS43NjkuNDA3LTEuMDNhMS43OCAxLjc4IDAgMDEuODU3LS41MDggNS4wMDYgNS4wMDYgMCAwMC0uNjY4LS44MTNBNS4wNzYgNS4wNzYgMCAwMDcuMS40MDYgNS4wNDUgNS4wNDUgMCAwMDUuMTExIDB6TTE1IDQuMTgycTAgLjIxLS4xNDMuMzUzbC0yLjUyNCAyLjUyNHEtLjE1Mi4xNDMtLjM1My4xNDMtLjE5OCAwLS4zNS0uMTQzbC0uMjktLjI5MXEtLjE0Ny0uMTQ4LS4xNDctLjM1M3QuMTQ3LS4zNTNsMS4xMzYtMS4xMzZoLTIuNzNxLS4yIDAtLjMyNy0uMTQ1LS4xMjYtLjE0Ni0uMTI2LS4zNTF2LS40OTZxMC0uMjA2LjEyNi0uMzUxLjEyNi0uMTQ2LjMyOC0uMTQ2aDIuNzI5bC0xLjEzNi0xLjE0cS0uMTQ3LS4xMzktLjE0Ny0uMzQ4IDAtLjIxLjE0Ny0uMzVsLjI5LS4yOXEuMTQ4LS4xNDcuMzUtLjE0Ny4yMDUgMCAuMzUzLjE0N2wyLjUyNCAyLjUyNHEuMTQzLjEzNi4xNDMuMzQ5elxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB2aWV3Qm94PVxcXCIwIDAgMTMgMTNcXFwiIHdpZHRoPVxcXCIxZW1cXFwiIGhlaWdodD1cXFwiMWVtXFxcIj48cGF0aCBkPVxcXCJNNi41MTMuNjE0bC02LjUgMy4yNSA2LjUgMy4yNSA2LjUtMy4yNS02LjUtMy4yNXptMCAxLjA3OGw0LjM0MiAyLjE3Mi00LjM0MiAyLjE3MkwyLjE3IDMuODY0bDQuMzQzLTIuMTcyem01LjE5OCA2LjM5NmwxLjMwMi42NS02LjUgMy4yNS02LjUtMy4yNSAxLjMwMi0uNjUgNS4xOTggMi42ek0xLjMxNSA1LjY1bC0xLjMwMi42NTEgMi4xMTQgMS4wNTcgMS4zLS42NXptMTAuMzk2IDBMOS41OTkgNi43MDhsMS4zMDIuNjUxIDIuMTEyLTEuMDU4ek04LjEyNyA3LjQ0M2wtMS42MTQuODA3LTEuMTM2LS41NjgtMS4zMDIuNjUgMi40MzggMS4yMiAyLjQzNy0xLjIyLTEuMy0uNjV6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAxNiAxNlxcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk0xNC4zMzQgNi4zNDd2MS45OTZoLTEuOTk3djQuNjQ5aC0xLjk5NlY4LjM0M0g4LjM0NFY2LjM0N2g1Ljk5ek0xLjY2NiAzLjAwOGg4LjY3NHYxLjk5N0g3djcuOTg3SDUuMDA0VjUuMDA1SDEuNjY2VjMuMDA4elxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cXG4gIDxzZWxlY3RcXG4gICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICBuZy1tb2RlbD1cIiRjdHJsLm1vZGVcIlxcbiAgICBuZy1vcHRpb25zPVwibW9kZSB8IHRyYW5zbGF0ZSBmb3IgbW9kZSBpbiAkY3RybC5tb2Rlc1wiXFxuICAgIG5nLWNsaWNrPVwiJGN0cmwuaGFzRXJyb3IgPSBmYWxzZVwiPlxcbiAgPC9zZWxlY3Q+XFxuPC9kaXY+XFxuXFxuPGRpdj5cXG5cXG4gIDxmb3JtXFxuICAgIG5hbWU9XCJpZHNsX2Zvcm1cIlxcbiAgICBub3ZhbGlkYXRlXFxuICAgIG5nLXNob3c9XCIkY3RybC5tb2RlID09PSBcXCdMb2NhbFxcJ1wiPlxcbiAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxcbiAgICAgIDxkaXYgY2xhc3M9XCJpbnB1dC1ncm91cFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cImN1c3RvbS1maWxlXCI+XFxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwiZmlsZVwiIGNsYXNzPVwiY3VzdG9tLWZpbGUtaW5wdXRcIiByZXF1aXJlZD5cXG4gICAgICAgICAgPGxhYmVsIGNsYXNzPVwiY3VzdG9tLWZpbGUtbGFiZWxcIiB0cmFuc2xhdGU+Tm8gZmlsZTwvbGFiZWw+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGJ1dHRvblxcbiAgICAgICAgY2xhc3M9XCJidG4gcHJpbWUgZm9ybS1jb250cm9sXCJcXG4gICAgICAgIG5nLWNsYXNzPVwie1xcJ2hhcy1lcnJvclxcJzogJGN0cmwuaGFzRXJyb3J9XCJcXG4gICAgICAgIHRpdGxlPVwie3tcXCdMb2FkIGEgZmlsZSBmcm9tIGxvY2FsXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICAgICAgdHlwZT1cInN1Ym1pdFwiXFxuICAgICAgICBuZy1jbGljaz1cImlkc2xfZm9ybS4kdmFsaWQgJiYgJGN0cmwubG9hZCgpXCJcXG4gICAgICAgIG5nLWRpc2FibGVkPVwiJGN0cmwuZmlsZSA9PT0gdW5kZWZpbmVkIHx8ICRjdHJsLmhhc0Vycm9yXCJcXG4gICAgICA+XFxuICAgICAgICA8c3BhbiBuZy1pZj1cIiEkY3RybC5oYXNFcnJvclwiPnt7XFwnTG9hZCBsb2NhbCBmaWxlXFwnIHwgdHJhbnNsYXRlfX08L3NwYW4+XFxuICAgICAgICA8c3BhbiBuZy1pZj1cIiRjdHJsLmhhc0Vycm9yXCI+e3tcXCdVbmFibGUgdG8gbG9hZCB0aGUgZmlsZVxcJyB8IHRyYW5zbGF0ZX19PC9zcGFuPlxcbiAgICAgIDwvYnV0dG9uPlxcbiAgICA8L2Rpdj5cXG4gIDwvZm9ybT5cXG5cXG4gIDxmb3JtXFxuICAgIG5hbWU9XCJpZHNjX2Zvcm1cIlxcbiAgICBub3ZhbGlkYXRlXFxuICAgIG5nLXNob3c9XCIkY3RybC5tb2RlID09PSBcXCdPbmxpbmVcXCdcIj5cXG4gICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXAgZ21mLWltcG9ydGRhdGFzb3VyY2UtdXJsLWZvcm0tZ3JvdXBcIj5cXG4gICAgICA8aW5wdXRcXG4gICAgICAgIGF1dG9jb21wbGV0ZT1cIm9mZlwiXFxuICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICBuYW1lPVwidXJsXCJcXG4gICAgICAgIHBsYWNlaG9sZGVyPVwie3tcXCdDaG9vc2Ugb3IgZW50ZXIgb25saW5lIHJlc291cmNlIFVSTFxcJyB8IHRyYW5zbGF0ZX19XCJcXG4gICAgICAgIHJlcXVpcmVkXFxuICAgICAgICB0eXBlPVwidXJsXCJcXG4gICAgICAgIG5nLWRpc2FibGVkPVwiJGN0cmwucGVuZGluZ1wiXFxuICAgICAgICBuZy1tb2RlbD1cIiRjdHJsLnVybFwiXFxuICAgICAgLz5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XFxuICAgICAgPGJ1dHRvblxcbiAgICAgICAgY2xhc3M9XCJidG4gcHJpbWUgZm9ybS1jb250cm9sIGdtZi1pbXBvcnRkYXRhc291cmNlLWNvbm5lY3QtYnRuXCJcXG4gICAgICAgIG5nLWNsYXNzPVwie1xcJ2hhcy1lcnJvclxcJzogJGN0cmwuaGFzRXJyb3J9XCJcXG4gICAgICAgIHRpdGxlPVwie3tcXCdDb25uZWN0IHRvIG9ubGluZSByZXNvdXJjZVxcJyB8IHRyYW5zbGF0ZX19XCJcXG4gICAgICAgIHR5cGU9XCJzdWJtaXRcIlxcbiAgICAgICAgbmctY2xpY2s9XCJpZHNjX2Zvcm0uJHZhbGlkICYmICRjdHJsLmNvbm5lY3QoKVwiXFxuICAgICAgICBuZy1kaXNhYmxlZD1cImlkc2NfZm9ybS4kaW52YWxpZCB8fCAkY3RybC5wZW5kaW5nXCJcXG4gICAgICA+XFxuICAgICAgICA8c3BhblxcbiAgICAgICAgICBuZy1pZj1cIiRjdHJsLnBlbmRpbmdcIlxcbiAgICAgICAgPnt7XFwnQ29ubmVjdGluZywgcGxlYXNlIHdhaXQuLi5cXCcgfCB0cmFuc2xhdGV9fTwvc3Bhbj5cXG4gICAgICAgIDxzcGFuXFxuICAgICAgICAgIG5nLWlmPVwiISRjdHJsLnBlbmRpbmcgJiYgJGN0cmwuaGFzRXJyb3JcIlxcbiAgICAgICAgPnt7XFwnRmFpbGVkIHRvIGNvbm5lY3RcXCcgfCB0cmFuc2xhdGV9fTwvc3Bhbj5cXG4gICAgICAgIDxzcGFuXFxuICAgICAgICAgIG5nLWlmPVwiISRjdHJsLnBlbmRpbmcgJiYgISRjdHJsLmhhc0Vycm9yXCJcXG4gICAgICAgID57e1xcJ0Nvbm5lY3RcXCcgfCB0cmFuc2xhdGV9fTwvc3Bhbj5cXG4gICAgICA8L2J1dHRvbj5cXG4gICAgPC9kaXY+XFxuICA8L2Zvcm0+XFxuXFxuPC9kaXY+XFxuXFxuPGRpdlxcbiAgY2xhc3M9XCJnbWYtaW1wb3J0ZGF0YXNvdXJjZS1sYXllcnNcIlxcbiAgbmctaWY9XCIkY3RybC53bXNDYXBhYmlsaXRpZXMgIT09IG51bGwgfHwgJGN0cmwud210c0NhcGFiaWxpdGllcyAhPT0gbnVsbFwiPlxcbiAgPGhyIC8+XFxuICA8aW5wdXRcXG4gICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICBwbGFjZWhvbGRlcj1cInt7XFwnU2VhcmNoXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICBuZy1kaXNhYmxlZD1cIiRjdHJsLnBlbmRpbmdcIlxcbiAgICBuZy1tb2RlbD1cIiRjdHJsLnNlYXJjaFRleHRcIlxcbiAgICBuZy1tb2RlbC1vcHRpb25zPVwieyBkZWJvdW5jZTogMjUwIH1cIlxcbiAgICBuZy1jaGFuZ2U9XCIkY3RybC5zZWFyY2goKVwiXFxuICAvPlxcbiAgPGdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZVxcbiAgICBjYXBhYmlsaXRpZXM9XCI6OiRjdHJsLndtc0NhcGFiaWxpdGllc1wiXFxuICAgIGxheWVyPVwiOjokY3RybC53bXNDYXBhYmlsaXRpZXMuQ2FwYWJpbGl0eS5MYXllclwiXFxuICAgIHVybD1cIjo6JGN0cmwudXJsXCJcXG4gICAgbmctaWY9XCIkY3RybC53bXNDYXBhYmlsaXRpZXMgIT09IG51bGxcIj5cXG4gIDwvZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlPlxcbiAgPGdtZi13bXRzY2FwYWJpbGl0eWxheWVydHJlZVxcbiAgICBjYXBhYmlsaXRpZXM9XCI6OiRjdHJsLndtdHNDYXBhYmlsaXRpZXNcIlxcbiAgICBsYXllcnM9XCI6OiRjdHJsLndtdHNDYXBhYmlsaXRpZXMuQ29udGVudHMuTGF5ZXJcIlxcbiAgICB1cmw9XCI6OiRjdHJsLnVybFwiXFxuICAgIG5nLWlmPVwiJGN0cmwud210c0NhcGFiaWxpdGllcyAhPT0gbnVsbFwiPlxcbiAgPC9nbWYtd210c2NhcGFiaWxpdHlsYXllcnRyZWU+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mRGF0YXNvdXJjZUV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyIGZyb20gJ2dtZi9kYXRhc291cmNlL0V4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyLmpzJztcbmltcG9ydCBnbWZJbXBvcnRXbXNDYXBhYmlsaXR5TGF5ZXJ0cmVlQ29tcG9uZW50IGZyb20gJ2dtZi9pbXBvcnQvd21zQ2FwYWJpbGl0eUxheWVydHJlZUNvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mSW1wb3J0V210c0NhcGFiaWxpdHlMYXllcnRyZWVDb21wb25lbnQgZnJvbSAnZ21mL2ltcG9ydC93bXRzQ2FwYWJpbGl0eUxheWVydHJlZUNvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb1F1ZXJ5UXVlcmVudCBmcm9tICduZ2VvL3F1ZXJ5L1F1ZXJlbnQuanMnO1xuaW1wb3J0IHsgZ3Vlc3NTZXJ2aWNlVHlwZUJ5VXJsLCBUeXBlIH0gZnJvbSAnbmdlby9kYXRhc291cmNlL09HQy5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZkltcG9ydGRhdGFzb3VyY2UnLCBbZ21mRGF0YXNvdXJjZUV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyLm5hbWUsIGdtZkltcG9ydFdtc0NhcGFiaWxpdHlMYXllcnRyZWVDb21wb25lbnQubmFtZSwgZ21mSW1wb3J0V210c0NhcGFiaWxpdHlMYXllcnRyZWVDb21wb25lbnQubmFtZSwgbmdlb1F1ZXJ5UXVlcmVudC5uYW1lXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi9pbXBvcnQvaW1wb3J0ZGF0YXNvdXJjZUNvbXBvbmVudCcsIHJlcXVpcmUoJy4vaW1wb3J0ZGF0YXNvdXJjZUNvbXBvbmVudC5odG1sJykpO1xufV0pO1xubW9kdWxlLnZhbHVlKCdnbWZJbXBvcnRkYXRhc291cmNlVGVtcGxhdGVVcmwnLCBmdW5jdGlvbiAoJGF0dHJzKSB7XG4gIHZhciB0ZW1wbGF0ZVVybCA9ICRhdHRycy5nbWZJbXBvcnRkYXRhc291cmNlVGVtcGxhdGVVcmw7XG4gIHJldHVybiB0ZW1wbGF0ZVVybCAhPT0gdW5kZWZpbmVkID8gdGVtcGxhdGVVcmwgOiAnZ21mL2ltcG9ydC9pbXBvcnRkYXRhc291cmNlQ29tcG9uZW50Jztcbn0pO1xuZ21mSW1wb3J0ZGF0YXNvdXJjZVRlbXBsYXRlVXJsLiRpbmplY3QgPSBbXCIkYXR0cnNcIiwgXCJnbWZJbXBvcnRkYXRhc291cmNlVGVtcGxhdGVVcmxcIl07XG5cbmZ1bmN0aW9uIGdtZkltcG9ydGRhdGFzb3VyY2VUZW1wbGF0ZVVybCgkYXR0cnMsIGdtZkltcG9ydGRhdGFzb3VyY2VUZW1wbGF0ZVVybCkge1xuICByZXR1cm4gZ21mSW1wb3J0ZGF0YXNvdXJjZVRlbXBsYXRlVXJsKCRhdHRycyk7XG59XG5cbnZhciBNb2RlID0ge1xuICBMT0NBTDogJ0xvY2FsJyxcbiAgT05MSU5FOiAnT25saW5lJ1xufTtcblxudmFyIENvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIENvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRlbGVtZW50XCIsIFwiJGZpbHRlclwiLCBcIiRpbmplY3RvclwiLCBcIiRzY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwiZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXJcIiwgXCJuZ2VvUXVlcmVudFwiXTtcblxuICBmdW5jdGlvbiBDb250cm9sbGVyKCRlbGVtZW50LCAkZmlsdGVyLCAkaW5qZWN0b3IsICRzY29wZSwgJHRpbWVvdXQsIGdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyLCBuZ2VvUXVlcmVudCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB0aGlzLm1hcCA9IG51bGw7XG4gICAgdGhpcy5lbGVtZW50XyA9ICRlbGVtZW50O1xuICAgIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICAgIHRoaXMudGltZW91dF8gPSAkdGltZW91dDtcbiAgICB0aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXyA9IGdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyO1xuICAgIHRoaXMubmdlb1F1ZXJlbnRfID0gbmdlb1F1ZXJlbnQ7XG4gICAgdGhpcy5maWxlID0gbnVsbDtcbiAgICB0aGlzLnNlYXJjaFRleHQgPSBudWxsO1xuICAgIHRoaXMudXJsID0gbnVsbDtcbiAgICB0aGlzLmZpbGVJbnB1dF8gPSAkZWxlbWVudC5maW5kKCdpbnB1dFt0eXBlPWZpbGVdJyk7XG4gICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgIHRoaXMuaGFzRXJyb3JQcm9taXNlXyA9IG51bGw7XG4gICAgdGhpcy5tb2RlID0gTW9kZS5PTkxJTkU7XG4gICAgdGhpcy5tb2RlcyA9IFtNb2RlLkxPQ0FMLCBNb2RlLk9OTElORV07XG4gICAgdmFyIGdldHRleHRDYXRhbG9nID0gJGluamVjdG9yLmdldCgnZ2V0dGV4dENhdGFsb2cnKTtcbiAgICBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0xvY2FsJyk7XG4gICAgZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdPbmxpbmUnKTtcbiAgICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnVuaXRQcmVmaXhGb3JtYXRfID0gJGZpbHRlcignbmdlb1VuaXRQcmVmaXgnKTtcbiAgICB0aGlzLndtc0NhcGFiaWxpdGllcyA9IG51bGw7XG4gICAgdGhpcy53bXRzQ2FwYWJpbGl0aWVzID0gbnVsbDtcbiAgICB0aGlzLnNlcnZlcnNFbmdpbmVfID0gbnVsbDtcbiAgICB2YXIgc2VydmVycyA9ICRpbmplY3Rvci5oYXMoJ2dtZkV4dGVybmFsT0dDU2VydmVycycpID8gJGluamVjdG9yLmdldCgnZ21mRXh0ZXJuYWxPR0NTZXJ2ZXJzJykgOiBudWxsO1xuXG4gICAgaWYgKHNlcnZlcnMpIHtcbiAgICAgIHZhciBzZXJ2ZXJVcmxzID0gc2VydmVycy5tYXAoZnVuY3Rpb24gKHNlcnZlcikge1xuICAgICAgICByZXR1cm4gc2VydmVyLnVybDtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5zZXJ2ZXJzRW5naW5lXyA9IG5ldyBCbG9vZGhvdW5kKHtcbiAgICAgICAgZGF0dW1Ub2tlbml6ZXI6IGZ1bmN0aW9uIGRhdHVtVG9rZW5pemVyKGRhdHVtKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBkYXR1bSAhPSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBkYXR1bSB0eXBlJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIG9yaWdpbmFsRGF0dW1Ub2tlbml6ZXJzID0gQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2UoZGF0dW0pO1xuXG4gICAgICAgICAgaWYgKCFvcmlnaW5hbERhdHVtVG9rZW5pemVycykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9yaWdpbmFsRGF0dW1Ub2tlbml6ZXJzJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGRhdHVtVG9rZW5pemVycyA9IFtdO1xuXG4gICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gb3JpZ2luYWxEYXR1bVRva2VuaXplcnMsIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IpLCBfaSA9IDAsIF9pdGVyYXRvciA9IF9pc0FycmF5ID8gX2l0ZXJhdG9yIDogX2l0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgICAgICB2YXIgX3JlZjtcblxuICAgICAgICAgICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICAgICAgICAgIGlmIChfaSA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIF9pID0gX2l0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBvcmlnaW5hbERhdHVtVG9rZW5pemVyID0gX3JlZjtcbiAgICAgICAgICAgIHZhciBpID0gMDtcblxuICAgICAgICAgICAgd2hpbGUgKGkgKyAxIDwgb3JpZ2luYWxEYXR1bVRva2VuaXplci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgZGF0dW1Ub2tlbml6ZXJzLnB1c2gob3JpZ2luYWxEYXR1bVRva2VuaXplci5zdWJzdHIoaSwgb3JpZ2luYWxEYXR1bVRva2VuaXplci5sZW5ndGgpKTtcbiAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBkYXR1bVRva2VuaXplcnM7XG4gICAgICAgIH0sXG4gICAgICAgIHF1ZXJ5VG9rZW5pemVyOiBCbG9vZGhvdW5kLnRva2VuaXplcnMud2hpdGVzcGFjZSxcbiAgICAgICAgbG9jYWw6IHNlcnZlclVybHNcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuZmlsZUlucHV0Xy5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGZpbGVJbnB1dCA9IF90aGlzLmZpbGVJbnB1dF9bMF07XG4gICAgICB2YXIgZmlsZXMgPSBmaWxlSW5wdXQuZmlsZXM7XG4gICAgICBfdGhpcy5maWxlID0gZmlsZXMgJiYgZmlsZXNbMF0gPyBmaWxlc1swXSA6IG51bGw7XG5cbiAgICAgIGlmIChfdGhpcy5maWxlKSB7XG4gICAgICAgIF90aGlzLmhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICQoZmlsZUlucHV0KS5uZXh0KCcuY3VzdG9tLWZpbGUtbGFiZWwnKS5odG1sKF90aGlzLmZpbGVOYW1lQW5kU2l6ZSk7XG4gICAgICB9XG5cbiAgICAgIF90aGlzLnNjb3BlXy4kYXBwbHkoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uJG9uSW5pdCA9IGZ1bmN0aW9uICRvbkluaXQoKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB0aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXy5tYXAgPSB0aGlzLm1hcDtcblxuICAgIGlmICh0aGlzLnNlcnZlcnNFbmdpbmVfKSB7XG4gICAgICB2YXIgc2VydmVyc0VuZ2luZVdpdGhEZWZhdWx0cyA9IGZ1bmN0aW9uIHNlcnZlcnNFbmdpbmVXaXRoRGVmYXVsdHMocXVlcnksIHN5bmMpIHtcbiAgICAgICAgaWYgKCFfdGhpczIuc2VydmVyc0VuZ2luZV8pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc2VydmVyc0VuZ2luZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHF1ZXJ5ID09PSAnJykge1xuICAgICAgICAgIHN5bmMoX3RoaXMyLnNlcnZlcnNFbmdpbmVfLmFsbCgpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpczIuc2VydmVyc0VuZ2luZV8uc2VhcmNoKHF1ZXJ5LCBzeW5jKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdGhpcy50aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciAkdXJsSW5wdXQgPSBfdGhpczIuZWxlbWVudF8uZmluZCgnaW5wdXRbbmFtZT11cmxdJyk7XG5cbiAgICAgICAgdmFyICRjb25uZWN0QnRuID0gX3RoaXMyLmVsZW1lbnRfLmZpbmQoJ2J1dHRvbi5nbWYtaW1wb3J0ZGF0YXNvdXJjZS1jb25uZWN0LWJ0bicpO1xuXG4gICAgICAgICR1cmxJbnB1dC50eXBlYWhlYWQoe1xuICAgICAgICAgIGhpbnQ6IHRydWUsXG4gICAgICAgICAgaGlnaGxpZ2h0OiB0cnVlLFxuICAgICAgICAgIG1pbkxlbmd0aDogMFxuICAgICAgICB9LCB7XG4gICAgICAgICAgbmFtZTogJ3VybCcsXG4gICAgICAgICAgc291cmNlOiBzZXJ2ZXJzRW5naW5lV2l0aERlZmF1bHRzXG4gICAgICAgIH0pLmJpbmQoJ3R5cGVhaGVhZDpzZWxlY3QnLCBmdW5jdGlvbiAoZXYsIHN1Z2dlc3Rpb24pIHtcbiAgICAgICAgICBfdGhpczIudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMyLnVybCA9IHN1Z2dlc3Rpb247XG5cbiAgICAgICAgICAgIF90aGlzMi5zY29wZV8uJGFwcGx5KCk7XG5cbiAgICAgICAgICAgICRjb25uZWN0QnRuLmZvY3VzKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdCgpIHtcbiAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgIGlmICghdGhpcy51cmwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB1cmwnKTtcbiAgICB9XG5cbiAgICB2YXIgdXJsID0gdGhpcy51cmw7XG4gICAgdmFyIHNlcnZpY2VUeXBlID0gZ3Vlc3NTZXJ2aWNlVHlwZUJ5VXJsKHVybCk7XG4gICAgdGhpcy5zdGFydFdvcmtpbmdfKCk7XG5cbiAgICBpZiAoc2VydmljZVR5cGUgPT09IFR5cGUuV01TKSB7XG4gICAgICB0aGlzLm5nZW9RdWVyZW50Xy53bXNHZXRDYXBhYmlsaXRpZXModXJsKS50aGVuKGZ1bmN0aW9uICh3bXNDYXBhYmlsaXRpZXMpIHtcbiAgICAgICAgX3RoaXMzLndtc0NhcGFiaWxpdGllcyA9IHdtc0NhcGFiaWxpdGllcztcblxuICAgICAgICBfdGhpczMuc3RvcFdvcmtpbmdfKCk7XG5cbiAgICAgICAgX3RoaXMzLnNlYXJjaCgpO1xuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczMuc3RvcFdvcmtpbmdfKHRydWUpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChzZXJ2aWNlVHlwZSA9PT0gVHlwZS5XTVRTKSB7XG4gICAgICB0aGlzLm5nZW9RdWVyZW50Xy53bXRzR2V0Q2FwYWJpbGl0aWVzKHVybCkudGhlbihmdW5jdGlvbiAod210c0NhcGFiaWxpdGllcykge1xuICAgICAgICBfdGhpczMud210c0NhcGFiaWxpdGllcyA9IHdtdHNDYXBhYmlsaXRpZXM7XG5cbiAgICAgICAgX3RoaXMzLnN0b3BXb3JraW5nXygpO1xuXG4gICAgICAgIF90aGlzMy5zZWFyY2goKTtcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMzLnN0b3BXb3JraW5nXyh0cnVlKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMzLnN0b3BXb3JraW5nXyh0cnVlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ubG9hZCA9IGZ1bmN0aW9uIGxvYWQoKSB7XG4gICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICBpZiAoIXRoaXMuZmlsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZpbGUnKTtcbiAgICB9XG5cbiAgICB2YXIgZmlsZSA9IHRoaXMuZmlsZTtcbiAgICB0aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXy5jcmVhdGVBbmRBZGREYXRhU291cmNlRnJvbUZpbGUoZmlsZSwgZnVuY3Rpb24gKHN1Y2Nlc3MpIHtcbiAgICAgIGlmICghc3VjY2Vzcykge1xuICAgICAgICBfdGhpczQuaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5zZWFyY2ggPSBmdW5jdGlvbiBzZWFyY2goKSB7XG4gICAgaWYgKHRoaXMud21zQ2FwYWJpbGl0aWVzICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmZpbHRlckxheWVyKHRoaXMud21zQ2FwYWJpbGl0aWVzLkNhcGFiaWxpdHkuTGF5ZXIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLndtdHNDYXBhYmlsaXRpZXMgIT09IG51bGwpIHtcbiAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB0aGlzLndtdHNDYXBhYmlsaXRpZXMuQ29udGVudHMuTGF5ZXIsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICB2YXIgX3JlZjI7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5Mikge1xuICAgICAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWYyID0gX2l0ZXJhdG9yMltfaTIrK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICAgICAgaWYgKF9pMi5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmMiA9IF9pMi52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBsYXllciA9IF9yZWYyO1xuICAgICAgICB0aGlzLmZpbHRlckxheWVyKGxheWVyKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmZpbHRlckxheWVyID0gZnVuY3Rpb24gZmlsdGVyTGF5ZXIobGF5ZXIsIHZpc2libGUpIHtcbiAgICBpZiAodmlzaWJsZSA9PT0gdm9pZCAwKSB7XG4gICAgICB2aXNpYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgbGF5ZXIuX3Zpc2libGUgPSB2aXNpYmxlO1xuICAgIGxheWVyLl9zZWFyY2hNYXRjaCA9IG51bGw7XG4gICAgbGF5ZXIuX2V4cGFuZGVkID0gZmFsc2U7XG5cbiAgICBpZiAoIXRoaXMuc2VhcmNoVGV4dCkge1xuICAgICAgbGF5ZXIuX3Zpc2libGUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgaW5kZXggPSBsYXllci5UaXRsZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGhpcy5zZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkpO1xuXG4gICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICBsYXllci5fc2VhcmNoUHJlZml4ID0gbGF5ZXIuVGl0bGUuc3Vic3RyaW5nKDAsIGluZGV4KTtcbiAgICAgICAgbGF5ZXIuX3NlYXJjaE1hdGNoID0gbGF5ZXIuVGl0bGUuc3Vic3RyaW5nKGluZGV4LCBpbmRleCArIHRoaXMuc2VhcmNoVGV4dC5sZW5ndGgpO1xuICAgICAgICBsYXllci5fc2VhcmNoU3VmZml4ID0gbGF5ZXIuVGl0bGUuc3Vic3RyaW5nKGluZGV4ICsgdGhpcy5zZWFyY2hUZXh0Lmxlbmd0aCk7XG4gICAgICAgIGxheWVyLl92aXNpYmxlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgY2hpbGRWaXNpYmxlID0gZmFsc2U7XG5cbiAgICBpZiAobGF5ZXIuTGF5ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IGxheWVyLkxheWVyLCBfaXNBcnJheTMgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjMpLCBfaTMgPSAwLCBfaXRlcmF0b3IzID0gX2lzQXJyYXkzID8gX2l0ZXJhdG9yMyA6IF9pdGVyYXRvcjNbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgdmFyIF9yZWYzO1xuXG4gICAgICAgIGlmIChfaXNBcnJheTMpIHtcbiAgICAgICAgICBpZiAoX2kzID49IF9pdGVyYXRvcjMubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICBfcmVmMyA9IF9pdGVyYXRvcjNbX2kzKytdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9pMyA9IF9pdGVyYXRvcjMubmV4dCgpO1xuICAgICAgICAgIGlmIChfaTMuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgX3JlZjMgPSBfaTMudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY2hpbGQgPSBfcmVmMztcbiAgICAgICAgdGhpcy5maWx0ZXJMYXllcihjaGlsZCwgbGF5ZXIuX3Zpc2libGUpO1xuXG4gICAgICAgIGlmIChjaGlsZC5fdmlzaWJsZSkge1xuICAgICAgICAgIGNoaWxkVmlzaWJsZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hpbGQuX2V4cGFuZGVkIHx8IGNoaWxkLl9zZWFyY2hNYXRjaCkge1xuICAgICAgICAgIGxheWVyLl9leHBhbmRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2hpbGRWaXNpYmxlKSB7XG4gICAgICBsYXllci5fdmlzaWJsZSA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5zdGFydFdvcmtpbmdfID0gZnVuY3Rpb24gc3RhcnRXb3JraW5nXygpIHtcbiAgICB0aGlzLnBlbmRpbmcgPSB0cnVlO1xuICAgIHRoaXMuaGFzRXJyb3IgPSBmYWxzZTtcbiAgICB0aGlzLndtc0NhcGFiaWxpdGllcyA9IG51bGw7XG4gICAgdGhpcy53bXRzQ2FwYWJpbGl0aWVzID0gbnVsbDtcbiAgfTtcblxuICBfcHJvdG8uc3RvcFdvcmtpbmdfID0gZnVuY3Rpb24gc3RvcFdvcmtpbmdfKG9wdF9oYXNFcnJvcikge1xuICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgaWYgKG9wdF9oYXNFcnJvciA9PT0gdm9pZCAwKSB7XG4gICAgICBvcHRfaGFzRXJyb3IgPSBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcblxuICAgIGlmIChvcHRfaGFzRXJyb3IpIHtcbiAgICAgIHRoaXMuaGFzRXJyb3IgPSB0cnVlO1xuXG4gICAgICBpZiAodGhpcy5oYXNFcnJvclByb21pc2VfKSB7XG4gICAgICAgIHRoaXMudGltZW91dF8uY2FuY2VsKHRoaXMuaGFzRXJyb3JQcm9taXNlXyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaGFzRXJyb3JQcm9taXNlXyA9IHRoaXMudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczUuaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgX3RoaXM1Lmhhc0Vycm9yUHJvbWlzZV8gPSBudWxsO1xuICAgICAgfSwgMzAwMCk7XG4gICAgfVxuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhDb250cm9sbGVyLCBbe1xuICAgIGtleTogXCJmaWxlTmFtZUFuZFNpemVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIGlmICghdGhpcy5maWxlKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cblxuICAgICAgdmFyIG5hbWVBbmRTaXplID0gJyc7XG4gICAgICB2YXIgZmlsZSA9IHRoaXMuZmlsZTtcblxuICAgICAgaWYgKGZpbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgZmlsZVNpemUgPSB0aGlzLnVuaXRQcmVmaXhGb3JtYXRfKGZpbGUuc2l6ZSwgJ28nKTtcbiAgICAgICAgbmFtZUFuZFNpemUgPSBmaWxlLm5hbWUgKyBcIiwgXCIgKyBmaWxlU2l6ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5hbWVBbmRTaXplO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBDb250cm9sbGVyO1xufSgpO1xuXG5tb2R1bGUuY29tcG9uZW50KCdnbWZJbXBvcnRkYXRhc291cmNlJywge1xuICBiaW5kaW5nczoge1xuICAgICdtYXAnOiAnPCdcbiAgfSxcbiAgY29udHJvbGxlcjogQ29udHJvbGxlcixcbiAgdGVtcGxhdGVVcmw6IGdtZkltcG9ydGRhdGFzb3VyY2VUZW1wbGF0ZVVybFxufSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mSW1wb3J0SW1wb3J0ZGF0YXNvdXJjZUNvbXBvbmVudCBmcm9tICdnbWYvaW1wb3J0L2ltcG9ydGRhdGFzb3VyY2VDb21wb25lbnQuanMnO1xuaW1wb3J0IGdtZkltcG9ydFdtc0NhcGFiaWxpdHlMYXllcnRyZWVDb21wb25lbnQgZnJvbSAnZ21mL2ltcG9ydC93bXNDYXBhYmlsaXR5TGF5ZXJ0cmVlQ29tcG9uZW50LmpzJztcbmltcG9ydCBnbWZJbXBvcnRXbXRzQ2FwYWJpbGl0eUxheWVydHJlZUNvbXBvbmVudCBmcm9tICdnbWYvaW1wb3J0L3dtdHNDYXBhYmlsaXR5TGF5ZXJ0cmVlQ29tcG9uZW50LmpzJztcbmltcG9ydCAnLi9pbXBvcnQuc2Nzcyc7XG5leHBvcnQgZGVmYXVsdCBhbmd1bGFyLm1vZHVsZSgnZ21mSW1wb3J0TW9kdWxlJywgW2dtZkltcG9ydEltcG9ydGRhdGFzb3VyY2VDb21wb25lbnQubmFtZSwgZ21mSW1wb3J0V21zQ2FwYWJpbGl0eUxheWVydHJlZUNvbXBvbmVudC5uYW1lLCBnbWZJbXBvcnRXbXRzQ2FwYWJpbGl0eUxheWVydHJlZUNvbXBvbmVudC5uYW1lXSk7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPHVsPlxcbiAgPGxpXFxuICAgIG5nLXJlcGVhdD1cImxheWVyIGluIDo6JGN0cmwubGF5ZXIuTGF5ZXJcIlxcbiAgICBuZy1zaG93PVwibGF5ZXIuX3Zpc2libGVcIlxcbiAgPlxcblxcbiAgICA8ZGl2XFxuICAgICAgY2xhc3M9XCJnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtaGVhZGVyXCJcXG4gICAgPlxcblxcbiAgICA8c3BhblxcbiAgICAgIGNsYXNzPVwiZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLXBvcG92ZXItY29udGFpbmVyXCJcXG4gICAgICBuZy1pZj1cIjo6KGxheWVyLk5hbWUgIT09IHVuZGVmaW5lZCB8fCBsYXllci5BYnN0cmFjdCAhPT0gdW5kZWZpbmVkKVwiXFxuICAgICAgbmdlby1wb3BvdmVyXFxuICAgICAgbmdlby1wb3BvdmVyLWRpc21pc3M9XCIuY29udGVudFwiXFxuICAgICAgbmdlby1wb3BvdmVyLXBsYWNlbWVudD1cImxlZnRcIlxcbiAgICA+XFxuXFxuICAgICAgPHNwYW5cXG4gICAgICAgIG5nZW8tcG9wb3Zlci1hbmNob3JcXG4gICAgICAgIGNsYXNzPVwiZmEgZmEtY29nIGdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1hY3Rpb25zXCI+XFxuICAgICAgPC9zcGFuPlxcblxcbiAgICAgIDxkaXZcXG4gICAgICAgIGNsYXNzPVwiZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLXBvcG92ZXItY29udGVudFwiXFxuICAgICAgICBuZ2VvLXBvcG92ZXItY29udGVudD5cXG4gICAgICAgIDx1bD5cXG4gICAgICAgICAgPGxpXFxuICAgICAgICAgICAgICBuZy1pZj1cIjo6KGxheWVyLk5hbWUgIT09IHVuZGVmaW5lZClcIj5cXG4gICAgICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXBsdXMgZmEtZndcIj48L2k+XFxuICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgIGhyZWY9XCJcIlxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCIkY3RybC5jcmVhdGVBbmRBZGREYXRhU291cmNlKGxheWVyKTsgcG9wb3ZlckN0cmwuZGlzbWlzc1BvcG92ZXIoKVwiXFxuICAgICAgICAgICAgPlxcbiAgICAgICAgICAgICAgPHNwYW4gdHJhbnNsYXRlPkFkZCBsYXllcjwvc3Bhbj5cXG4gICAgICAgICAgICA8L2E+XFxuICAgICAgICAgIDwvbGk+XFxuICAgICAgICAgIDxsaVxcbiAgICAgICAgICAgICAgbmctaWY9XCI6OihsYXllci5BYnN0cmFjdCAhPT0gdW5kZWZpbmVkKVwiPlxcbiAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtdGgtbGlzdCBmYS1md1wiPjwvaT5cXG4gICAgICAgICAgICA8YVxcbiAgICAgICAgICAgICAgYXJpYS1leHBhbmRlZD1cImZhbHNlXCJcXG4gICAgICAgICAgICAgIGRhdGEtdG9nZ2xlPVwiY29sbGFwc2VcIlxcbiAgICAgICAgICAgICAgaHJlZj1cIiNnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtZGVzY3JpcHRpb24te3s6OiRjdHJsLmdldFVpZChsYXllcil9fVwiXFxuICAgICAgICAgICAgICBuZy1jbGljaz1cInBvcG92ZXJDdHJsLmRpc21pc3NQb3BvdmVyKClcIlxcbiAgICAgICAgICAgID5cXG4gICAgICAgICAgICAgIDxzcGFuIHRyYW5zbGF0ZT5PcGVuL0Nsb3NlIGRlc2NyaXB0aW9uPC9zcGFuPlxcbiAgICAgICAgICAgIDwvYT5cXG4gICAgICAgICAgPC9saT5cXG4gICAgICAgIDwvdWw+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvc3Bhbj5cXG5cXG4gICAgPGFcXG4gICAgICBhcmlhLWV4cGFuZGVkPVwie3sgbGF5ZXIuX2V4cGFuZGVkIH19XCJcXG4gICAgICBjbGFzcz1cImZhIGdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1leHBhbmQtbm9kZSBmYS1md1wiXFxuICAgICAgZGF0YS10b2dnbGU9XCJjb2xsYXBzZVwiXFxuICAgICAgaHJlZj1cIiNnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtY2hpbGRyZW4te3s6OiRjdHJsLmdldFVpZChsYXllcil9fVwiXFxuICAgICAgbmctaWY9XCI6OihsYXllci5MYXllciAhPT0gdW5kZWZpbmVkICYmIGxheWVyLkxheWVyLmxlbmd0aClcIlxcbiAgICA+PC9hPlxcblxcbiAgICA8c3BhblxcbiAgICAgIG5nLWlmPVwiOjoobGF5ZXIuTGF5ZXIgIT09IHVuZGVmaW5lZCAmJiBsYXllci5MYXllci5sZW5ndGgpXCJcXG4gICAgICBjbGFzcz1cImZhIGZhLWZ3IGdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1ncm91cFwiXFxuICAgID4nICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9sYXllcnMuc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nPC9zcGFuPlxcblxcbiAgICA8YVxcbiAgICAgIGNsYXNzPVwiZmEgZmEtY2lyY2xlLXRoaW4gZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLW5vLWljb24gZmEtZncgXCJcXG4gICAgICBuZy1pZj1cIjo6KGxheWVyLkxheWVyID09PSB1bmRlZmluZWQgfHwgbGF5ZXIuTGF5ZXIubGVuZ3RoID09PSAwKVwiXFxuICAgID48L2E+XFxuXFxuICAgIDxzcGFuXFxuICAgICAgY2xhc3M9XCJnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtdGl0bGVcIlxcbiAgICAgIG5nLWlmPVwiIWxheWVyLl9zZWFyY2hNYXRjaFwiXFxuICAgID57eyA6OmxheWVyLlRpdGxlIH19PC9zcGFuPlxcbiAgICA8c3BhblxcbiAgICAgIGNsYXNzPVwiZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLXRpdGxlXCJcXG4gICAgICBuZy1pZj1cImxheWVyLl9zZWFyY2hNYXRjaFwiXFxuICAgID57eyBsYXllci5fc2VhcmNoUHJlZml4IH19PHNwYW4gY2xhc3M9aGlnaGxpZ2h0Pnt7IGxheWVyLl9zZWFyY2hNYXRjaCB9fTwvc3Bhbj57eyBsYXllci5fc2VhcmNoU3VmZml4IH19PC9zcGFuPlxcblxcbiAgICA8ZGl2XFxuICAgICAgY2xhc3M9XCJjb2xsYXBzZSBnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtZGVzY3JpcHRpb25cIlxcbiAgICAgIGlkPVwiZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLWRlc2NyaXB0aW9uLXt7OjokY3RybC5nZXRVaWQobGF5ZXIpfX1cIlxcbiAgICAgIG5nLWlmPVwiOjoobGF5ZXIuQWJzdHJhY3QgIT09IHVuZGVmaW5lZClcIlxcbiAgICA+XFxuICAgICAgPGFcXG4gICAgICAgIGFyaWEtZXhwYW5kZWQ9XCJmYWxzZVwiXFxuICAgICAgICBjbGFzcz1cImdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1kZXNjcmlwdGlvbi10b2dnbGVcIlxcbiAgICAgICAgZGF0YS10b2dnbGU9XCJjb2xsYXBzZVwiXFxuICAgICAgICBocmVmPVwiI2dtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1kZXNjcmlwdGlvbi17ezo6JGN0cmwuZ2V0VWlkKGxheWVyKX19XCJcXG4gICAgICAgID5cXG4gICAgICAgIDxzcGFuIHRyYW5zbGF0ZT5IaWRlIGRlc2NyaXB0aW9uPC9zcGFuPlxcbiAgICAgIDwvYT5cXG4gICAgICA8c3BhblxcbiAgICAgICAgY2xhc3M9XCJnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtZGVzY3JpcHRpb24tY29udGVudFwiXFxuICAgICAgPnt7IDo6bGF5ZXIuQWJzdHJhY3QgfX08L3NwYW4+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8L2Rpdj5cXG5cXG4gICAgPGdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZVxcbiAgICAgICAgY2xhc3M9XCJjb2xsYXBzZVwiXFxuICAgICAgICBuZy1jbGFzcz1cImxheWVyLl9leHBhbmRlZCA/IFxcJ3Nob3dcXCcgOiBcXCdcXCdcIlxcbiAgICAgICAgaWQ9XCJnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtY2hpbGRyZW4te3s6OiRjdHJsLmdldFVpZChsYXllcil9fVwiXFxuICAgICAgICBjYXBhYmlsaXRpZXM9XCI6OiRjdHJsLmNhcGFiaWxpdGllc1wiXFxuICAgICAgICBsYXllcj1cIjo6bGF5ZXJcIlxcbiAgICAgICAgbmctaWY9XCI6OihsYXllci5MYXllciAhPT0gdW5kZWZpbmVkKVwiPlxcbiAgICA8L2dtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZT5cXG4gIDwvbGk+XFxuPC91bD5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mRGF0YXNvdXJjZUV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyIGZyb20gJ2dtZi9kYXRhc291cmNlL0V4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyLmpzJztcbmltcG9ydCBuZ2VvTWVzc2FnZVBvcHVwIGZyb20gJ25nZW8vbWVzc2FnZS9Qb3B1cC5qcyc7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvY29sbGFwc2UuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZXbXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZScsIFtnbWZEYXRhc291cmNlRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXIubmFtZSwgbmdlb01lc3NhZ2VQb3B1cC5uYW1lXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi9pbXBvcnQvd21zQ2FwYWJpbGl0eUxheWVydHJlZUNvbXBvbmVudCcsIHJlcXVpcmUoJy4vd21zQ2FwYWJpbGl0eUxheWVydHJlZUNvbXBvbmVudC5odG1sJykpO1xufV0pO1xubW9kdWxlLnZhbHVlKCdnbWZXbXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZVRlbXBsYXRlVXJsJywgZnVuY3Rpb24gKCRhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSAkYXR0cnMuZ21mV21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGVUZW1wbGF0ZVVybDtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICdnbWYvaW1wb3J0L3dtc0NhcGFiaWxpdHlMYXllcnRyZWVDb21wb25lbnQnO1xufSk7XG5nbWZXbXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZVRlbXBsYXRlVXJsLiRpbmplY3QgPSBbXCIkYXR0cnNcIiwgXCJnbWZXbXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZVRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBnbWZXbXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZVRlbXBsYXRlVXJsKCRhdHRycywgZ21mV21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGVUZW1wbGF0ZVVybCkge1xuICByZXR1cm4gZ21mV21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGVUZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG52YXIgQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXJcIl07XG5cbiAgZnVuY3Rpb24gQ29udHJvbGxlcihnbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcikge1xuICAgIHRoaXMuY2FwYWJpbGl0aWVzID0ge307XG4gICAgdGhpcy5sYXllciA9IHt9O1xuICAgIHRoaXMudXJsID0gbnVsbDtcbiAgICB0aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXyA9IGdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IENvbnRyb2xsZXIucHJvdG90eXBlO1xuXG4gIF9wcm90by5jcmVhdGVBbmRBZGREYXRhU291cmNlID0gZnVuY3Rpb24gY3JlYXRlQW5kQWRkRGF0YVNvdXJjZShsYXllcikge1xuICAgIGlmICghdGhpcy51cmwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB1cmwnKTtcbiAgICB9XG5cbiAgICB0aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXy5jcmVhdGVBbmRBZGREYXRhU291cmNlRnJvbVdNU0NhcGFiaWxpdHkobGF5ZXIsIHRoaXMuY2FwYWJpbGl0aWVzLCB0aGlzLnVybCk7XG4gIH07XG5cbiAgX3Byb3RvLmdldFVpZCA9IGZ1bmN0aW9uIGdldFVpZChsYXllcikge1xuICAgIHJldHVybiBvbFV0aWxHZXRVaWQobGF5ZXIpO1xuICB9O1xuXG4gIHJldHVybiBDb250cm9sbGVyO1xufSgpO1xuXG5tb2R1bGUuY29tcG9uZW50KCdnbWZXbXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZScsIHtcbiAgYmluZGluZ3M6IHtcbiAgICAnY2FwYWJpbGl0aWVzJzogJzwnLFxuICAgICdsYXllcic6ICc8JyxcbiAgICAndXJsJzogJzwnXG4gIH0sXG4gIGNvbnRyb2xsZXI6IENvbnRyb2xsZXIsXG4gIHRlbXBsYXRlVXJsOiBnbWZXbXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZVRlbXBsYXRlVXJsXG59KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaikge1xub2JqIHx8IChvYmogPSB7fSk7XG52YXIgX190LCBfX3AgPSAnJztcbndpdGggKG9iaikge1xuX19wICs9ICc8dWw+XFxuICA8bGlcXG4gICAgbmctcmVwZWF0PVwibGF5ZXIgaW4gOjokY3RybC5sYXllcnNcIlxcbiAgICBuZy1zaG93PVwibGF5ZXIuX3Zpc2libGVcIlxcbiAgPlxcbiAgICA8ZGl2XFxuICAgICAgY2xhc3M9XCJnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtaGVhZGVyXCJcXG4gICAgPlxcblxcbiAgICAgIDxzcGFuXFxuICAgICAgICBjbGFzcz1cImdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1wb3BvdmVyLWNvbnRhaW5lclwiXFxuICAgICAgICBuZ2VvLXBvcG92ZXJcXG4gICAgICAgIG5nZW8tcG9wb3Zlci1kaXNtaXNzPVwiLmNvbnRlbnRcIlxcbiAgICAgICAgbmdlby1wb3BvdmVyLXBsYWNlbWVudD1cImxlZnRcIlxcbiAgICAgID5cXG4gICAgICAgIDxzcGFuXFxuICAgICAgICAgIG5nZW8tcG9wb3Zlci1hbmNob3JcXG4gICAgICAgICAgY2xhc3M9XCJmYSBmYS1jb2cgZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLWFjdGlvbnNcIj5cXG4gICAgICAgIDwvc3Bhbj5cXG5cXG4gICAgICAgIDxkaXZcXG4gICAgICAgICAgY2xhc3M9XCJnbWYtd21zY2FwYWJpbGl0eWxheWVydHJlZW5vZGUtcG9wb3Zlci1jb250ZW50XCJcXG4gICAgICAgICAgbmdlby1wb3BvdmVyLWNvbnRlbnRcXG4gICAgICAgID5cXG4gICAgICAgICAgPHVsPlxcbiAgICAgICAgICAgIDxsaT5cXG4gICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtcGx1cyBmYS1md1wiPjwvaT5cXG4gICAgICAgICAgICAgIDxhXFxuICAgICAgICAgICAgICAgIGhyZWY9XCJcIlxcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cIiRjdHJsLmNyZWF0ZUFuZEFkZERhdGFTb3VyY2UobGF5ZXIpOyBwb3BvdmVyQ3RybC5kaXNtaXNzUG9wb3ZlcigpXCJcXG4gICAgICAgICAgICAgID5cXG4gICAgICAgICAgICAgICAgPHNwYW4gdHJhbnNsYXRlPkFkZCBsYXllcjwvc3Bhbj5cXG4gICAgICAgICAgICAgIDwvYT5cXG4gICAgICAgICAgICA8L2xpPlxcbiAgICAgICAgICAgIDxsaVxcbiAgICAgICAgICAgICAgbmctaWY9XCI6OihsYXllci5BYnN0cmFjdCAhPT0gdW5kZWZpbmVkKVwiPlxcbiAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS10aC1saXN0IGZhLWZ3XCI+PC9pPlxcbiAgICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgICAgYXJpYS1leHBhbmRlZD1cImZhbHNlXCJcXG4gICAgICAgICAgICAgICAgZGF0YS10b2dnbGU9XCJjb2xsYXBzZVwiXFxuICAgICAgICAgICAgICAgIGhyZWY9XCIjZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLWRlc2NyaXB0aW9uLXt7OjokY3RybC5nZXRVaWQobGF5ZXIpfX1cIlxcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cInBvcG92ZXJDdHJsLmRpc21pc3NQb3BvdmVyKClcIlxcbiAgICAgICAgICAgICAgPlxcbiAgICAgICAgICAgICAgICA8c3BhbiB0cmFuc2xhdGU+T3Blbi9DbG9zZSBkZXNjcmlwdGlvbjwvc3Bhbj5cXG4gICAgICAgICAgICAgIDwvYT5cXG4gICAgICAgICAgICA8L2xpPlxcbiAgICAgICAgICA8L3VsPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9zcGFuPlxcblxcbiAgICAgIDxhIGNsYXNzPVwiZmEgZmEtY2lyY2xlLXRoaW4gZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLW5vLWljb24gZmEtZndcIj48L2E+XFxuICAgICAgPHNwYW5cXG4gICAgICAgIGNsYXNzPVwiZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLXRpdGxlXCJcXG4gICAgICAgIG5nLWlmPVwiIWxheWVyLl9zZWFyY2hNYXRjaFwiXFxuICAgICAgPnt7IDo6bGF5ZXIuVGl0bGUgfX08L3NwYW4+XFxuICAgICAgPHNwYW5cXG4gICAgICAgIGNsYXNzPVwiZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLXRpdGxlXCJcXG4gICAgICAgIG5nLWlmPVwibGF5ZXIuX3NlYXJjaE1hdGNoXCJcXG4gICAgICA+e3sgbGF5ZXIuX3NlYXJjaFByZWZpeCB9fTxzcGFuIGNsYXNzPWhpZ2hsaWdodD57eyBsYXllci5fc2VhcmNoTWF0Y2ggfX08L3NwYW4+e3sgbGF5ZXIuX3NlYXJjaFN1ZmZpeCB9fTwvc3Bhbj5cXG5cXG4gICAgICA8ZGl2XFxuICAgICAgICBjbGFzcz1cImNvbGxhcHNlIGdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1kZXNjcmlwdGlvblwiXFxuICAgICAgICBpZD1cImdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1kZXNjcmlwdGlvbi17ezo6JGN0cmwuZ2V0VWlkKGxheWVyKX19XCJcXG4gICAgICAgIG5nLWlmPVwiOjoobGF5ZXIuQWJzdHJhY3QgIT09IHVuZGVmaW5lZClcIlxcbiAgICAgID5cXG4gICAgICAgIDxhXFxuICAgICAgICAgIGFyaWEtZXhwYW5kZWQ9XCJmYWxzZVwiXFxuICAgICAgICAgIGNsYXNzPVwiZ21mLXdtc2NhcGFiaWxpdHlsYXllcnRyZWVub2RlLWRlc2NyaXB0aW9uLXRvZ2dsZVwiXFxuICAgICAgICAgIGRhdGEtdG9nZ2xlPVwiY29sbGFwc2VcIlxcbiAgICAgICAgICBocmVmPVwiI2dtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1kZXNjcmlwdGlvbi17ezo6JGN0cmwuZ2V0VWlkKGxheWVyKX19XCJcXG4gICAgICAgID5cXG4gICAgICAgICAgPHNwYW4gdHJhbnNsYXRlPkhpZGUgZGVzY3JpcHRpb248L3NwYW4+XFxuICAgICAgICA8L2E+XFxuICAgICAgICA8c3BhblxcbiAgICAgICAgICBjbGFzcz1cImdtZi13bXNjYXBhYmlsaXR5bGF5ZXJ0cmVlbm9kZS1kZXNjcmlwdGlvbi1jb250ZW50XCJcXG4gICAgICAgID57eyA6OmxheWVyLkFic3RyYWN0IH19PC9zcGFuPlxcblxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gIDwvbGk+XFxuPC91bD5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mRGF0YXNvdXJjZUV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyIGZyb20gJ2dtZi9kYXRhc291cmNlL0V4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyLmpzJztcbmltcG9ydCBuZ2VvTWVzc2FnZVBvcHVwIGZyb20gJ25nZW8vbWVzc2FnZS9Qb3B1cC5qcyc7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZldtdHNjYXBhYmlsaXR5bGF5ZXJ0cmVlJywgW2dtZkRhdGFzb3VyY2VFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlci5uYW1lLCBuZ2VvTWVzc2FnZVBvcHVwLm5hbWVdKTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnbmdlby9pbXBvcnQvd210c0NhcGFiaWxpdHlMYXllcnRyZWVDb21wb25lbnQnLCByZXF1aXJlKCcuL3dtdHNDYXBhYmlsaXR5TGF5ZXJ0cmVlQ29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5tb2R1bGUudmFsdWUoJ2dtZldtdHNjYXBhYmlsaXR5bGF5ZXJ0cmVUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uICgkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzLmdtZldtdHNjYXBhYmlsaXR5bGF5ZXJ0cmVUZW1wbGF0ZVVybDtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICduZ2VvL2ltcG9ydC93bXRzQ2FwYWJpbGl0eUxheWVydHJlZUNvbXBvbmVudCc7XG59KTtcbmdtZldtdHNjYXBhYmlsaXR5bGF5ZXJ0cmVUZW1wbGF0ZVVybC4kaW5qZWN0ID0gW1wiJGF0dHJzXCIsIFwiZ21mV210c2NhcGFiaWxpdHlsYXllcnRyZVRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBnbWZXbXRzY2FwYWJpbGl0eWxheWVydHJlVGVtcGxhdGVVcmwoJGF0dHJzLCBnbWZXbXRzY2FwYWJpbGl0eWxheWVydHJlVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIGdtZldtdHNjYXBhYmlsaXR5bGF5ZXJ0cmVUZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG52YXIgQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXJcIl07XG5cbiAgZnVuY3Rpb24gQ29udHJvbGxlcihnbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcikge1xuICAgIHRoaXMuY2FwYWJpbGl0aWVzID0ge307XG4gICAgdGhpcy5sYXllcnMgPSBbXTtcbiAgICB0aGlzLnVybCA9IG51bGw7XG4gICAgdGhpcy5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcl8gPSBnbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcjtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uY3JlYXRlQW5kQWRkRGF0YVNvdXJjZSA9IGZ1bmN0aW9uIGNyZWF0ZUFuZEFkZERhdGFTb3VyY2UobGF5ZXIpIHtcbiAgICBpZiAoIXRoaXMudXJsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdXJsJyk7XG4gICAgfVxuXG4gICAgdmFyIG1hbmFnZXIgPSB0aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXztcbiAgICBtYW5hZ2VyLmNyZWF0ZUFuZEFkZERhdGFTb3VyY2VGcm9tV01UU0NhcGFiaWxpdHkobGF5ZXIsIHRoaXMuY2FwYWJpbGl0aWVzLCB0aGlzLnVybCk7XG4gIH07XG5cbiAgX3Byb3RvLmdldFVpZCA9IGZ1bmN0aW9uIGdldFVpZChsYXllcikge1xuICAgIHJldHVybiBvbFV0aWxHZXRVaWQobGF5ZXIpO1xuICB9O1xuXG4gIHJldHVybiBDb250cm9sbGVyO1xufSgpO1xuXG5tb2R1bGUuY29tcG9uZW50KCdnbWZXbXRzY2FwYWJpbGl0eWxheWVydHJlZScsIHtcbiAgYmluZGluZ3M6IHtcbiAgICAnY2FwYWJpbGl0aWVzJzogJzwnLFxuICAgICdsYXllcnMnOiAnPCcsXG4gICAgJ3VybCc6ICc8J1xuICB9LFxuICBjb250cm9sbGVyOiBDb250cm9sbGVyLFxuICB0ZW1wbGF0ZVVybDogZ21mV210c2NhcGFiaWxpdHlsYXllcnRyZVRlbXBsYXRlVXJsXG59KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJleHBvcnQgdmFyIERBVEFMQVlFUkdST1VQX05BTUUgPSAnZGF0YSc7XG5leHBvcnQgdmFyIEVYVEVSTkFMTEFZRVJHUk9VUF9OQU1FID0gJ2V4dGVybmFsJztcbmV4cG9ydCB2YXIgQ09PUkRJTkFURVNfTEFZRVJfTkFNRSA9ICdnbWZDb29yZGluYXRlc0xheWVyTmFtZSc7XG5leHBvcnQgdmFyIFBlcm1hbGlua1BhcmFtID0ge1xuICBCR19MQVlFUjogJ2Jhc2VsYXllcl9yZWYnLFxuICBCR19MQVlFUl9PUEFDSVRZOiAnYmFzZWxheWVyX29wYWNpdHknLFxuICBFWFRFUk5BTF9EQVRBU09VUkNFU19OQU1FUzogJ2Vkc19uJyxcbiAgRVhURVJOQUxfREFUQVNPVVJDRVNfVVJMUzogJ2Vkc191JyxcbiAgRkVBVFVSRVM6ICdybF9mZWF0dXJlcycsXG4gIE1BUF9DUk9TU0hBSVI6ICdtYXBfY3Jvc3NoYWlyJyxcbiAgTUFQX1NXSVBFOiAnbWFwX3N3aXBlJyxcbiAgTUFQX1NXSVBFX1ZBTFVFOiAnbWFwX3N3aXBlX3ZhbHVlJyxcbiAgTUFQX1RPT0xUSVA6ICdtYXBfdG9vbHRpcCcsXG4gIE1BUF9YOiAnbWFwX3gnLFxuICBNQVBfWTogJ21hcF95JyxcbiAgTUFQX1o6ICdtYXBfem9vbScsXG4gIFRSRUVfR1JPVVBTOiAndHJlZV9ncm91cHMnLFxuICBXRlNfTEFZRVI6ICd3ZnNfbGF5ZXInLFxuICBXRlNfTkdST1VQUzogJ3dmc19uZ3JvdXBzJyxcbiAgV0ZTX1NIT1dfRkVBVFVSRVM6ICd3ZnNfc2hvd0ZlYXR1cmVzJ1xufTsiLCJTeW5jTGF5ZXJ0cmVlTWFwLiRpbmplY3QgPSBbXCIkcm9vdFNjb3BlXCIsIFwibmdlb0xheWVySGVscGVyXCIsIFwibmdlb1dNU1RpbWVcIiwgXCJnbWZUaGVtZXNcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZUaGVtZVRoZW1lcywgeyBnZXROb2RlTWluUmVzb2x1dGlvbiwgZ2V0Tm9kZU1heFJlc29sdXRpb24gfSBmcm9tICdnbWYvdGhlbWUvVGhlbWVzLmpzJztcbmltcG9ydCBuZ2VvTGF5ZXJ0cmVlQ29udHJvbGxlciwgeyBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24gfSBmcm9tICduZ2VvL2xheWVydHJlZS9Db250cm9sbGVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY1dNU1RpbWUgZnJvbSAnbmdlby9taXNjL1dNU1RpbWUuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0IG9sTGF5ZXJJbWFnZSBmcm9tICdvbC9sYXllci9JbWFnZS5qcyc7XG5pbXBvcnQgb2xMYXllclRpbGUgZnJvbSAnb2wvbGF5ZXIvVGlsZS5qcyc7XG5pbXBvcnQgR3JvdXAgZnJvbSAnb2wvbGF5ZXIvR3JvdXAuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIFN5bmNMYXllcnRyZWVNYXAoJHJvb3RTY29wZSwgbmdlb0xheWVySGVscGVyLCBuZ2VvV01TVGltZSwgZ21mVGhlbWVzKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgdGhpcy5sYXllckhlbHBlcl8gPSBuZ2VvTGF5ZXJIZWxwZXI7XG4gIHRoaXMubmdlb1dNU1RpbWVfID0gbmdlb1dNU1RpbWU7XG4gIHRoaXMub2djU2VydmVyc09iamVjdF8gPSBudWxsO1xuICBnbWZUaGVtZXMuZ2V0T2djU2VydmVyc09iamVjdCgpLnRoZW4oZnVuY3Rpb24gKG9nY1NlcnZlcnNPYmplY3QpIHtcbiAgICBfdGhpcy5vZ2NTZXJ2ZXJzT2JqZWN0XyA9IG9nY1NlcnZlcnNPYmplY3Q7XG4gIH0pO1xuICAkcm9vdFNjb3BlLiRvbignbmdlby1sYXllcnRyZWUtc3RhdGUnLCBmdW5jdGlvbiAobWFwLCB0cmVlQ3RybCwgZmlyc3RQYXJlbnQpIHtcbiAgICBfdGhpcy5zeW5jXyhmaXJzdFBhcmVudCk7XG4gIH0pO1xufVxuXG5TeW5jTGF5ZXJ0cmVlTWFwLnByb3RvdHlwZS5jcmVhdGVMYXllciA9IGZ1bmN0aW9uICh0cmVlQ3RybCwgbWFwLCBkYXRhTGF5ZXJHcm91cCwgb3B0X3Bvc2l0aW9uKSB7XG4gIHZhciBsYXllciA9IG51bGw7XG4gIHZhciBnbWZHcm91cCA9IHRyZWVDdHJsLm5vZGU7XG4gIHZhciBnbWZQYXJlbnRHcm91cCA9IHRyZWVDdHJsLnBhcmVudC5ub2RlO1xuXG4gIGlmIChnbWZHcm91cC5jaGlsZHJlbiAhPT0gdW5kZWZpbmVkICYmIGdtZkdyb3VwLm1peGVkKSB7XG4gICAgbGF5ZXIgPSB0aGlzLmNyZWF0ZUdyb3VwXyh0cmVlQ3RybCwgbWFwLCBkYXRhTGF5ZXJHcm91cCwgb3B0X3Bvc2l0aW9uKTtcbiAgfSBlbHNlIGlmIChnbWZHcm91cC5jaGlsZHJlbiA9PT0gdW5kZWZpbmVkICYmIGdtZlBhcmVudEdyb3VwLm1peGVkKSB7XG4gICAgbGF5ZXIgPSB0aGlzLmNyZWF0ZUxlYWZJbkFNaXhlZEdyb3VwXyh0cmVlQ3RybCwgbWFwKTtcbiAgfSBlbHNlIGlmIChnbWZHcm91cC5jaGlsZHJlbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5pbml0R21mTGF5ZXJJbkFOb3RNaXhlZEdyb3VwXyh0cmVlQ3RybCwgbWFwKTtcbiAgfSBlbHNlIGlmICh0cmVlQ3RybC5kZXB0aCA9PT0gMSAmJiAhZ21mR3JvdXAubWl4ZWQpIHtcbiAgICBsYXllciA9IHRoaXMuY3JlYXRlR3JvdXBfKHRyZWVDdHJsLCBtYXAsIGRhdGFMYXllckdyb3VwLCBvcHRfcG9zaXRpb24pO1xuICB9XG5cbiAgaWYgKGxheWVyICYmIHRyZWVDdHJsLm5vZGUubWV0YWRhdGEub3BhY2l0eSkge1xuICAgIGxheWVyLnNldE9wYWNpdHkodHJlZUN0cmwubm9kZS5tZXRhZGF0YS5vcGFjaXR5KTtcbiAgfVxuXG4gIHJldHVybiBsYXllcjtcbn07XG5cblN5bmNMYXllcnRyZWVNYXAucHJvdG90eXBlLnN5bmNfID0gZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIHRyZWVDdHJsLnRyYXZlcnNlRGVwdGhGaXJzdChmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgICB2YXIgZ21mR3JvdXAgPSB0cmVlQ3RybC5ub2RlO1xuXG4gICAgaWYgKHRyZWVDdHJsLmxheWVyICYmICFnbWZHcm91cC5taXhlZCkge1xuICAgICAgX3RoaXMyLnVwZGF0ZUxheWVyU3RhdGVfKHRyZWVDdHJsLmxheWVyLCB0cmVlQ3RybCk7XG5cbiAgICAgIHJldHVybiBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24uREVTQ0VORDtcbiAgICB9XG4gIH0pO1xufTtcblxuU3luY0xheWVydHJlZU1hcC5wcm90b3R5cGUudXBkYXRlTGF5ZXJTdGF0ZV8gPSBmdW5jdGlvbiAobGF5ZXIsIHRyZWVDdHJsKSB7XG4gIHZhciBnbWZHcm91cCA9IHRyZWVDdHJsLm5vZGU7XG4gIHZhciBnbWZMYXllciA9IHRyZWVDdHJsLm5vZGU7XG4gIHZhciBhY3RpdmUgPSB0cmVlQ3RybC5nZXRTdGF0ZSgpID09PSAnb24nO1xuXG4gIGlmIChnbWZMYXllci50eXBlID09PSAnV01UUycpIHtcbiAgICBsYXllci5zZXRWaXNpYmxlKGFjdGl2ZSk7XG4gIH0gZWxzZSBpZiAoIWdtZkdyb3VwLm1peGVkICYmIHRyZWVDdHJsLmRlcHRoID09PSAxKSB7XG4gICAgaWYgKCEobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVySW1hZ2UpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGRhdGFTb3VyY2UgdHlwZScpO1xuICAgIH1cblxuICAgIHZhciBuYW1lcyA9IFtdO1xuICAgIHZhciBzdHlsZXMgPSBbXTtcbiAgICB0cmVlQ3RybC50cmF2ZXJzZURlcHRoRmlyc3QoZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gICAgICB2YXIgZ21mR3JvdXAgPSB0cmVlQ3RybC5ub2RlO1xuXG4gICAgICBpZiAoZ21mR3JvdXAuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCAmJiB0cmVlQ3RybC5nZXRTdGF0ZSgpID09PSAnb24nKSB7XG4gICAgICAgIHZhciBnbWZMYXllcldNUyA9IHRyZWVDdHJsLm5vZGU7XG4gICAgICAgIG5hbWVzLnB1c2goZ21mTGF5ZXJXTVMubGF5ZXJzKTtcbiAgICAgICAgdmFyIHN0eWxlID0gZ21mTGF5ZXJXTVMuc3R5bGUgIT09IHVuZGVmaW5lZCA/IGdtZkxheWVyV01TLnN0eWxlIDogJyc7XG4gICAgICAgIHN0eWxlcy5wdXNoKHN0eWxlKTtcbiAgICAgICAgcmV0dXJuIExheWVydHJlZVZpc2l0b3JEZWNpc2lvbi5ERVNDRU5EO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKG5hbWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgbGF5ZXIuc2V0VmlzaWJsZShmYWxzZSk7XG4gICAgfVxuXG4gICAgbGF5ZXIuZ2V0U291cmNlKCkudXBkYXRlUGFyYW1zKHtcbiAgICAgICdMQVlFUlMnOiBuYW1lcy5yZXZlcnNlKCkuam9pbignLCcpLFxuICAgICAgJ1NUWUxFUyc6IHN0eWxlcy5yZXZlcnNlKCkuam9pbignLCcpXG4gICAgfSk7XG5cbiAgICBpZiAobmFtZXMubGVuZ3RoICE9PSAwKSB7XG4gICAgICBsYXllci5zZXRWaXNpYmxlKHRydWUpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoIShsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJJbWFnZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZGF0YVNvdXJjZSB0eXBlJyk7XG4gICAgfVxuXG4gICAgbGF5ZXIuc2V0VmlzaWJsZShhY3RpdmUpO1xuICB9XG59O1xuXG5TeW5jTGF5ZXJ0cmVlTWFwLnByb3RvdHlwZS5jcmVhdGVHcm91cF8gPSBmdW5jdGlvbiAodHJlZUN0cmwsIG1hcCwgZGF0YUxheWVyR3JvdXAsIG9wdF9wb3NpdGlvbikge1xuICB2YXIgZ3JvdXBOb2RlID0gdHJlZUN0cmwubm9kZTtcbiAgdmFyIGxheWVyID0gbnVsbDtcbiAgdmFyIGlzRmlyc3RMZXZlbEdyb3VwID0gdHJlZUN0cmwucGFyZW50LmlzUm9vdDtcbiAgdmFyIHByaW50TmF0aXZlQW5nbGUgPSB0cnVlO1xuXG4gIGlmIChncm91cE5vZGUubWV0YWRhdGEucHJpbnROYXRpdmVBbmdsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcHJpbnROYXRpdmVBbmdsZSA9IGdyb3VwTm9kZS5tZXRhZGF0YS5wcmludE5hdGl2ZUFuZ2xlO1xuICB9XG5cbiAgaWYgKGlzRmlyc3RMZXZlbEdyb3VwKSB7XG4gICAgbGF5ZXIgPSB0aGlzLmNyZWF0ZUxheWVyRnJvbUdyb3VwXyh0cmVlQ3RybCwgISFncm91cE5vZGUubWl4ZWQpO1xuICAgIHZhciBwb3NpdGlvbiA9IG9wdF9wb3NpdGlvbiB8fCAwO1xuICAgIGRhdGFMYXllckdyb3VwLmdldExheWVycygpLmluc2VydEF0KHBvc2l0aW9uLCBsYXllcik7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGluQU1peGVkR3JvdXAgPSAhdGhpcy5pc09uZVBhcmVudE5vdE1peGVkXyh0cmVlQ3RybCk7XG5cbiAgICBpZiAoaW5BTWl4ZWRHcm91cCkge1xuICAgICAgbGF5ZXIgPSB0aGlzLmNyZWF0ZUxheWVyRnJvbUdyb3VwXyh0cmVlQ3RybCwgdHJ1ZSk7XG4gICAgICB2YXIgbGF5ZXJHcm91cCA9IGdldExheWVyKHRyZWVDdHJsLnBhcmVudCk7XG5cbiAgICAgIGlmICghKGxheWVyR3JvdXAgaW5zdGFuY2VvZiBHcm91cCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBsYXllckdyb3VwIHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgbGF5ZXJHcm91cC5nZXRMYXllcnMoKS5pbnNlcnRBdCgwLCBsYXllcik7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFsYXllcikge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsYXllcicpO1xuICB9XG5cbiAgbGF5ZXIuc2V0KCdwcmludE5hdGl2ZUFuZ2xlJywgcHJpbnROYXRpdmVBbmdsZSk7XG4gIHJldHVybiBsYXllcjtcbn07XG5cblN5bmNMYXllcnRyZWVNYXAucHJvdG90eXBlLmNyZWF0ZUxheWVyRnJvbUdyb3VwXyA9IGZ1bmN0aW9uICh0cmVlQ3RybCwgbWl4ZWQpIHtcbiAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgdmFyIGxheWVyO1xuICB2YXIgZ3JvdXBOb2RlID0gdHJlZUN0cmwubm9kZTtcblxuICBpZiAobWl4ZWQpIHtcbiAgICBsYXllciA9IHRoaXMubGF5ZXJIZWxwZXJfLmNyZWF0ZUJhc2ljR3JvdXAoKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoIXRoaXMub2djU2VydmVyc09iamVjdF8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBvZ2NTZXJ2ZXJzT2JqZWN0Jyk7XG4gICAgfVxuXG4gICAgdmFyIHRpbWVQYXJhbSA9IHRoaXMuZ2V0VGltZVBhcmFtXyh0cmVlQ3RybCk7XG4gICAgdmFyIG9nY1NlcnZlciA9IHRoaXMub2djU2VydmVyc09iamVjdF9bZ3JvdXBOb2RlLm9nY1NlcnZlciB8fCAnJ107XG5cbiAgICBpZiAoIW9nY1NlcnZlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9nY1NlcnZlcicpO1xuICAgIH1cblxuICAgIGlmICghb2djU2VydmVyLnVybCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9nY1NlcnZlci51cmwnKTtcbiAgICB9XG5cbiAgICBpZiAoIW9nY1NlcnZlci50eXBlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb2djU2VydmVyLnR5cGUnKTtcbiAgICB9XG5cbiAgICBpZiAoIW9nY1NlcnZlci5pbWFnZVR5cGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBvZ2NTZXJ2ZXIuaW1hZ2VUeXBlJyk7XG4gICAgfVxuXG4gICAgbGF5ZXIgPSB0aGlzLmxheWVySGVscGVyXy5jcmVhdGVCYXNpY1dNU0xheWVyKG9nY1NlcnZlci51cmwsICcnLCBvZ2NTZXJ2ZXIuaW1hZ2VUeXBlLCBvZ2NTZXJ2ZXIudHlwZSwgdGltZVBhcmFtLCB1bmRlZmluZWQsIG9nY1NlcnZlci5jcmVkZW50aWFsID8gJ3VzZS1jcmVkZW50aWFscycgOiAnYW5vbnltb3VzJyk7XG4gICAgbGF5ZXIuc2V0KCdkYXRhU291cmNlSWQnLCBncm91cE5vZGUuaWQpO1xuICAgIHZhciBoYXNBY3RpdmVDaGlsZHJlbiA9IGZhbHNlO1xuICAgIHRyZWVDdHJsLnRyYXZlcnNlRGVwdGhGaXJzdChmdW5jdGlvbiAoY3RybCkge1xuICAgICAgX3RoaXMzLnVwZGF0ZUxheWVyUmVmZXJlbmNlc18oY3RybC5ub2RlLCBsYXllcik7XG5cbiAgICAgIGlmIChjdHJsLm5vZGUubWV0YWRhdGEuaXNDaGVja2VkKSB7XG4gICAgICAgIGN0cmwuc2V0U3RhdGUoJ29uJywgZmFsc2UpO1xuXG4gICAgICAgIF90aGlzMy51cGRhdGVMYXllclN0YXRlXyhsYXllciwgY3RybCk7XG5cbiAgICAgICAgaGFzQWN0aXZlQ2hpbGRyZW4gPSB0cnVlO1xuICAgICAgICByZXR1cm4gTGF5ZXJ0cmVlVmlzaXRvckRlY2lzaW9uLkRFU0NFTkQ7XG4gICAgICB9XG4gICAgfSk7XG4gICAgbGF5ZXIuc2V0VmlzaWJsZShoYXNBY3RpdmVDaGlsZHJlbik7XG4gICAgbGF5ZXIuc2V0KCdsYXllck5vZGVOYW1lJywgZ3JvdXBOb2RlLm5hbWUpO1xuICB9XG5cbiAgcmV0dXJuIGxheWVyO1xufTtcblxuU3luY0xheWVydHJlZU1hcC5wcm90b3R5cGUuY3JlYXRlTGVhZkluQU1peGVkR3JvdXBfID0gZnVuY3Rpb24gKHRyZWVDdHJsLCBtYXApIHtcbiAgdmFyIGdtZkxheWVyID0gdHJlZUN0cmwubm9kZTtcbiAgdmFyIGxheWVyO1xuXG4gIGlmIChnbWZMYXllci50eXBlID09PSAnV01UUycpIHtcbiAgICBsYXllciA9IHRoaXMuY3JlYXRlV01UU0xheWVyXyhnbWZMYXllcik7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCF0aGlzLm9nY1NlcnZlcnNPYmplY3RfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb2djU2VydmVyc09iamVjdCcpO1xuICAgIH1cblxuICAgIHZhciBnbWZMYXllcldNUyA9IGdtZkxheWVyO1xuICAgIHZhciB0aW1lUGFyYW0gPSB0aGlzLmdldFRpbWVQYXJhbV8odHJlZUN0cmwpO1xuICAgIHZhciBvZ2NTZXJ2ZXIgPSB0aGlzLm9nY1NlcnZlcnNPYmplY3RfW2dtZkxheWVyV01TLm9nY1NlcnZlcl07XG5cbiAgICBpZiAoIW9nY1NlcnZlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9nY1NlcnZlcicpO1xuICAgIH1cblxuICAgIGlmICghb2djU2VydmVyLnVybCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9nY1NlcnZlci51cmwnKTtcbiAgICB9XG5cbiAgICBpZiAoIW9nY1NlcnZlci50eXBlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb2djU2VydmVyLnR5cGUnKTtcbiAgICB9XG5cbiAgICBpZiAoIW9nY1NlcnZlci5pbWFnZVR5cGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBvZ2NTZXJ2ZXIuaW1hZ2VUeXBlJyk7XG4gICAgfVxuXG4gICAgaWYgKCFnbWZMYXllcldNUy5sYXllcnMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnbWZMYXllcldNUy5sYXllcnMnKTtcbiAgICB9XG5cbiAgICB2YXIgb3B0X3BhcmFtcyA9IHtcbiAgICAgIFNUWUxFUzogZ21mTGF5ZXJXTVMuc3R5bGVcbiAgICB9O1xuICAgIGxheWVyID0gdGhpcy5sYXllckhlbHBlcl8uY3JlYXRlQmFzaWNXTVNMYXllcihvZ2NTZXJ2ZXIudXJsLCBnbWZMYXllcldNUy5sYXllcnMsIG9nY1NlcnZlci5pbWFnZVR5cGUsIG9nY1NlcnZlci50eXBlLCB0aW1lUGFyYW0sIG9wdF9wYXJhbXMsIG9nY1NlcnZlci5jcmVkZW50aWFsID8gJ3VzZS1jcmVkZW50aWFscycgOiAnYW5vbnltb3VzJyk7XG4gIH1cblxuICBsYXllci5zZXQoJ2RhdGFTb3VyY2VJZCcsIGdtZkxheWVyLmlkKTtcbiAgbGF5ZXIuc2V0KCdsYXllck5vZGVOYW1lJywgZ21mTGF5ZXIubmFtZSk7XG4gIHRoaXMudXBkYXRlTGF5ZXJSZWZlcmVuY2VzXyhnbWZMYXllciwgbGF5ZXIpO1xuICB2YXIgY2hlY2tlZCA9IGdtZkxheWVyLm1ldGFkYXRhLmlzQ2hlY2tlZCA9PT0gdHJ1ZTtcblxuICBpZiAoY2hlY2tlZCkge1xuICAgIHRyZWVDdHJsLnNldFN0YXRlKCdvbicsIGZhbHNlKTtcbiAgfVxuXG4gIGxheWVyLnNldFZpc2libGUoY2hlY2tlZCk7XG4gIHZhciBsYXllckdyb3VwID0gZ2V0TGF5ZXIodHJlZUN0cmwucGFyZW50KTtcbiAgbGF5ZXJHcm91cC5nZXRMYXllcnMoKS5pbnNlcnRBdCgwLCBsYXllcik7XG4gIHJldHVybiBsYXllcjtcbn07XG5cblN5bmNMYXllcnRyZWVNYXAucHJvdG90eXBlLmluaXRHbWZMYXllckluQU5vdE1peGVkR3JvdXBfID0gZnVuY3Rpb24gKHRyZWVDdHJsLCBtYXApIHtcbiAgdmFyIGxlYWZOb2RlID0gdHJlZUN0cmwubm9kZTtcbiAgdmFyIGZpcnN0TGV2ZWxHcm91cCA9IHRoaXMuZ2V0Rmlyc3RMZXZlbEdyb3VwQ3RybF8odHJlZUN0cmwpO1xuXG4gIGlmICghZmlyc3RMZXZlbEdyb3VwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZpcnN0TGV2ZWxHcm91cCcpO1xuICB9XG5cbiAgdmFyIGxheWVyID0gZmlyc3RMZXZlbEdyb3VwLmxheWVyO1xuXG4gIGlmICghKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckltYWdlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgbGF5ZXIgdHlwZScpO1xuICB9XG5cbiAgaWYgKCEobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVySW1hZ2UpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBkYXRhU291cmNlIHR5cGUnKTtcbiAgfVxuXG4gIHRoaXMudXBkYXRlTGF5ZXJSZWZlcmVuY2VzXyhsZWFmTm9kZSwgbGF5ZXIpO1xuXG4gIGlmIChsZWFmTm9kZS5tZXRhZGF0YS5pc0NoZWNrZWQpIHtcbiAgICB0cmVlQ3RybC5zZXRTdGF0ZSgnb24nLCBmYWxzZSk7XG4gICAgdGhpcy51cGRhdGVMYXllclN0YXRlXyhsYXllciwgZmlyc3RMZXZlbEdyb3VwKTtcbiAgfSBlbHNlIHtcbiAgICB0cmVlQ3RybC5wYXJlbnQucmVmcmVzaFN0YXRlKCk7XG4gIH1cbn07XG5cblN5bmNMYXllcnRyZWVNYXAucHJvdG90eXBlLmNyZWF0ZVdNVFNMYXllcl8gPSBmdW5jdGlvbiAoZ21mTGF5ZXJXTVRTKSB7XG4gIHZhciBuZXdMYXllciA9IG5ldyBvbExheWVyVGlsZSgpO1xuXG4gIGlmICghZ21mTGF5ZXJXTVRTLnVybCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnbWZMYXllcldNVFMudXJsJyk7XG4gIH1cblxuICBpZiAoIWdtZkxheWVyV01UUy5sYXllcikge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnbWZMYXllcldNVFMubGF5ZXInKTtcbiAgfVxuXG4gIHZhciBtaW5SZXNvbHV0aW9uID0gZ2V0Tm9kZU1pblJlc29sdXRpb24oZ21mTGF5ZXJXTVRTKTtcbiAgdmFyIG1heFJlc29sdXRpb24gPSBnZXROb2RlTWF4UmVzb2x1dGlvbihnbWZMYXllcldNVFMpO1xuICB0aGlzLmxheWVySGVscGVyXy5jcmVhdGVXTVRTTGF5ZXJGcm9tQ2FwYWJpbGl0aXRlcyhnbWZMYXllcldNVFMudXJsLCBnbWZMYXllcldNVFMubGF5ZXIsIGdtZkxheWVyV01UUy5tYXRyaXhTZXQsIGdtZkxheWVyV01UUy5kaW1lbnNpb25zLCB1bmRlZmluZWQsIG1pblJlc29sdXRpb24sIG1heFJlc29sdXRpb24pLnRoZW4oZnVuY3Rpb24gKGxheWVyKSB7XG4gICAgbmV3TGF5ZXIuc2V0UHJvcGVydGllcyhsYXllci5nZXRQcm9wZXJ0aWVzKCkpO1xuICB9KTtcbiAgcmV0dXJuIG5ld0xheWVyO1xufTtcblxuU3luY0xheWVydHJlZU1hcC5wcm90b3R5cGUudXBkYXRlTGF5ZXJSZWZlcmVuY2VzXyA9IGZ1bmN0aW9uIChsZWFmTm9kZSwgbGF5ZXIpIHtcbiAgdmFyIGlkID0gb2xVdGlsR2V0VWlkKGxlYWZOb2RlKTtcbiAgdmFyIHF1ZXJ5U291cmNlSWRzID0gbGF5ZXIuZ2V0KCdxdWVyeVNvdXJjZUlkcycpIHx8IFtdO1xuICBxdWVyeVNvdXJjZUlkcy5wdXNoKGlkKTtcbiAgbGF5ZXIuc2V0KCdxdWVyeVNvdXJjZUlkcycsIHF1ZXJ5U291cmNlSWRzKTtcbiAgdmFyIGRpc2NsYWltZXIgPSBsZWFmTm9kZS5tZXRhZGF0YS5kaXNjbGFpbWVyO1xuXG4gIGlmIChkaXNjbGFpbWVyKSB7XG4gICAgdmFyIGRpc2NsYWltZXJzID0gbGF5ZXIuZ2V0KCdkaXNjbGFpbWVycycpIHx8IHt9O1xuICAgIHZhciBsYXllcnMgPSAnYWxsJztcblxuICAgIGlmICgnbGF5ZXJzJyBpbiBsZWFmTm9kZSkge1xuICAgICAgbGF5ZXJzID0gbGVhZk5vZGUubGF5ZXJzO1xuICAgIH1cblxuICAgIGRpc2NsYWltZXJzW2xheWVyc10gPSBsZWFmTm9kZS5tZXRhZGF0YS5kaXNjbGFpbWVyO1xuICAgIGxheWVyLnNldCgnZGlzY2xhaW1lcnMnLCBkaXNjbGFpbWVycyk7XG4gIH1cbn07XG5cblN5bmNMYXllcnRyZWVNYXAucHJvdG90eXBlLmdldFRpbWVQYXJhbV8gPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIHdtc1RpbWU7XG4gIHZhciB0aW1lUGFyYW07XG4gIHZhciBub2RlID0gdHJlZUN0cmwubm9kZTtcblxuICBpZiAobm9kZS50aW1lKSB7XG4gICAgd21zVGltZSA9IG5vZGUudGltZTtcbiAgfSBlbHNlIGlmIChub2RlLmNoaWxkcmVuKSB7XG4gICAgdHJlZUN0cmwudHJhdmVyc2VEZXB0aEZpcnN0KGZ1bmN0aW9uICh0cmVlQ3RybCkge1xuICAgICAgdmFyIG5vZGUgPSB0cmVlQ3RybC5ub2RlO1xuXG4gICAgICBpZiAobm9kZS5jaGlsZHJlbiA9PT0gdW5kZWZpbmVkICYmIG5vZGUudGltZSkge1xuICAgICAgICB3bXNUaW1lID0gbm9kZS50aW1lO1xuICAgICAgICByZXR1cm4gTGF5ZXJ0cmVlVmlzaXRvckRlY2lzaW9uLlNUT1A7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBpZiAod21zVGltZSkge1xuICAgIHZhciBvcHRpb25zID0gdGhpcy5uZ2VvV01TVGltZV8uZ2V0T3B0aW9ucyh3bXNUaW1lKTtcbiAgICB2YXIgdGltZVZhbHVlID0gb3B0aW9ucy52YWx1ZXM7XG4gICAgdmFyIHRpbWVWYWx1ZXMgPSBvcHRpb25zLnZhbHVlcztcbiAgICB0aW1lUGFyYW0gPSB0aGlzLm5nZW9XTVNUaW1lXy5mb3JtYXRXTVNUaW1lUGFyYW0od21zVGltZSwge1xuICAgICAgc3RhcnQ6IHRpbWVWYWx1ZXNbMF0gfHwgdGltZVZhbHVlLFxuICAgICAgZW5kOiB0aW1lVmFsdWVzWzFdXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gdGltZVBhcmFtO1xufTtcblxuU3luY0xheWVydHJlZU1hcC5wcm90b3R5cGUuaXNPbmVQYXJlbnROb3RNaXhlZF8gPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIHRyZWUgPSB0cmVlQ3RybC5wYXJlbnQ7XG4gIHZhciBpc09uZVBhcmVudE5vdE1peCA9IGZhbHNlO1xuXG4gIGRvIHtcbiAgICB2YXIgZ21mR3JvdXAgPSB0cmVlLm5vZGU7XG4gICAgaXNPbmVQYXJlbnROb3RNaXggPSBnbWZHcm91cC5taXhlZCA9PT0gZmFsc2U7XG4gICAgdHJlZSA9IHRyZWUucGFyZW50O1xuICB9IHdoaWxlICh0cmVlLnBhcmVudCAmJiAhaXNPbmVQYXJlbnROb3RNaXgpO1xuXG4gIHJldHVybiBpc09uZVBhcmVudE5vdE1peDtcbn07XG5cblN5bmNMYXllcnRyZWVNYXAucHJvdG90eXBlLmdldEZpcnN0TGV2ZWxHcm91cEN0cmxfID0gZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gIHZhciB0cmVlID0gdHJlZUN0cmw7XG5cbiAgd2hpbGUgKCF0cmVlLnBhcmVudC5pc1Jvb3QpIHtcbiAgICB0cmVlID0gdHJlZS5wYXJlbnQ7XG4gIH1cblxuICByZXR1cm4gdHJlZTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMYXllcih0cmVlQ3RybCkge1xuICB2YXIgdHJlZSA9IHRyZWVDdHJsO1xuICB2YXIgbGF5ZXIgPSBudWxsO1xuXG4gIHdoaWxlICghdHJlZS5pc1Jvb3QgJiYgbGF5ZXIgPT09IG51bGwpIHtcbiAgICBpZiAodHJlZS5sYXllcikge1xuICAgICAgbGF5ZXIgPSB0cmVlLmxheWVyO1xuICAgIH1cblxuICAgIHRyZWUgPSB0cmVlLnBhcmVudDtcbiAgfVxuXG4gIGlmICghbGF5ZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbGF5ZXInKTtcbiAgfVxuXG4gIHJldHVybiBsYXllcjtcbn1cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mU3luY0xheWVydHJlZU1hcCcsIFtnbWZUaGVtZVRoZW1lcy5uYW1lLCBuZ2VvTGF5ZXJ0cmVlQ29udHJvbGxlci5uYW1lLCBuZ2VvTWlzY1dNU1RpbWUubmFtZV0pO1xubW9kdWxlLnNlcnZpY2UoJ2dtZlN5bmNMYXllcnRyZWVNYXAnLCBTeW5jTGF5ZXJ0cmVlTWFwKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJMYXllcnRyZWVUcmVlTWFuYWdlci4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIiwgXCIkaW5qZWN0b3JcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIm5nZW9MYXllckhlbHBlclwiLCBcIm5nZW9Ob3RpZmljYXRpb25cIiwgXCJnbWZUaGVtZXNcIiwgXCJuZ2VvU3RhdGVNYW5hZ2VyXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBQZXJtYWxpbmtQYXJhbSB9IGZyb20gJ2dtZi9pbmRleC5qcyc7XG5pbXBvcnQgZ21mVGhlbWVUaGVtZXMsIHsgZmluZEdyb3VwQnlOYW1lLCBmaW5kR3JvdXBCeUxheWVyTm9kZU5hbWUgfSBmcm9tICdnbWYvdGhlbWUvVGhlbWVzLmpzJztcbmltcG9ydCBuZ2VvTGF5ZXJ0cmVlQ29udHJvbGxlciwgeyBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24sIExheWVydHJlZUNvbnRyb2xsZXIgfSBmcm9tICduZ2VvL2xheWVydHJlZS9Db250cm9sbGVyLmpzJztcbmltcG9ydCB7IE1lc3NhZ2VUeXBlIH0gZnJvbSAnbmdlby9tZXNzYWdlL01lc3NhZ2UuanMnO1xuaW1wb3J0IG5nZW9NZXNzYWdlTm90aWZpY2F0aW9uIGZyb20gJ25nZW8vbWVzc2FnZS9Ob3RpZmljYXRpb24uanMnO1xuaW1wb3J0IG5nZW9TdGF0ZW1hbmFnZXJTZXJ2aWNlIGZyb20gJ25nZW8vc3RhdGVtYW5hZ2VyL1NlcnZpY2UuanMnO1xuaW1wb3J0IHsgbGlzdGVuIH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmV4cG9ydCBmdW5jdGlvbiBMYXllcnRyZWVUcmVlTWFuYWdlcigkdGltZW91dCwgJGluamVjdG9yLCBnZXR0ZXh0Q2F0YWxvZywgbmdlb0xheWVySGVscGVyLCBuZ2VvTm90aWZpY2F0aW9uLCBnbWZUaGVtZXMsIG5nZW9TdGF0ZU1hbmFnZXIpIHtcbiAgdGhpcy4kdGltZW91dF8gPSAkdGltZW91dDtcbiAgdGhpcy4kaW5qZWN0b3JfID0gJGluamVjdG9yO1xuICB0aGlzLmdldHRleHRDYXRhbG9nXyA9IGdldHRleHRDYXRhbG9nO1xuICB0aGlzLmxheWVySGVscGVyXyA9IG5nZW9MYXllckhlbHBlcjtcbiAgdGhpcy5uZ2VvTm90aWZpY2F0aW9uXyA9IG5nZW9Ob3RpZmljYXRpb247XG4gIHRoaXMuZ21mVGhlbWVzXyA9IGdtZlRoZW1lcztcbiAgdGhpcy5yb290ID0ge1xuICAgIGNoaWxkcmVuOiBbXVxuICB9O1xuICB0aGlzLnJvb3RDdHJsID0gbnVsbDtcbiAgdGhpcy5udW1iZXJPZkdyb3Vwc1RvQWRkSW5UaGlzRGlnZXN0TG9vcCA9IDA7XG4gIHRoaXMuZ3JvdXBzVG9BZGRJblRoaXNEaWdlc3RMb29wXyA9IFtdO1xuICB0aGlzLnByb21pc2VGb3JHcm91cHNUb0FkZEluVGhpc0RpZ2VzdExvb3BfID0gbnVsbDtcbiAgdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXyA9IG5nZW9TdGF0ZU1hbmFnZXI7XG4gIHRoaXMuaW5pdGlhbExldmVsRmlyc3RHcm91cHNfID0gdW5kZWZpbmVkO1xuICB0aGlzLm9nY1NlcnZlcnNfID0gbnVsbDtcbiAgbGlzdGVuKHRoaXMuZ21mVGhlbWVzXywgJ2NoYW5nZScsIHRoaXMuaGFuZGxlVGhlbWVzQ2hhbmdlXywgdGhpcyk7XG59XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5oYW5kbGVUaGVtZXNDaGFuZ2VfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHRoaXMuZ21mVGhlbWVzXy5nZXRPZ2NTZXJ2ZXJzT2JqZWN0KCkudGhlbihmdW5jdGlvbiAob2djU2VydmVycykge1xuICAgIF90aGlzLm9nY1NlcnZlcnNfID0gb2djU2VydmVycztcbiAgfSk7XG5cbiAgaWYgKHRoaXMucm9vdEN0cmwgJiYgdGhpcy5yb290Q3RybC5jaGlsZHJlbikge1xuICAgIHRoaXMuZ21mVGhlbWVzXy5nZXRUaGVtZXNPYmplY3QoKS50aGVuKGZ1bmN0aW9uICh0aGVtZXMpIHtcbiAgICAgIF90aGlzLnJlZnJlc2hGaXJzdExldmVsR3JvdXBzXyh0aGVtZXMpO1xuICAgIH0pO1xuICB9XG59O1xuXG5MYXllcnRyZWVUcmVlTWFuYWdlci5wcm90b3R5cGUuc2V0Rmlyc3RMZXZlbEdyb3VwcyA9IGZ1bmN0aW9uIChmaXJzdExldmVsR3JvdXBzKSB7XG4gIHRoaXMucm9vdC5jaGlsZHJlbi5sZW5ndGggPSAwO1xuICB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLmRlbGV0ZVBhcmFtKFBlcm1hbGlua1BhcmFtLlRSRUVfR1JPVVBTKTtcbiAgcmV0dXJuIHRoaXMuYWRkRmlyc3RMZXZlbEdyb3VwcyhmaXJzdExldmVsR3JvdXBzKTtcbn07XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5hZGRGaXJzdExldmVsR3JvdXBzID0gZnVuY3Rpb24gKGZpcnN0TGV2ZWxHcm91cHMsIG9wdF9hZGQsIG9wdF9zaWxlbnQpIHtcbiAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgdmFyIGdyb3VwTm90QWRkZWQgPSBbXTtcbiAgZmlyc3RMZXZlbEdyb3Vwcy5zbGljZSgpLnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuICAgIGlmICghX3RoaXMyLmFkZEZpcnN0TGV2ZWxHcm91cF8oZ3JvdXApKSB7XG4gICAgICBncm91cE5vdEFkZGVkLnB1c2goZ3JvdXApO1xuICAgIH1cbiAgfSk7XG5cbiAgaWYgKGdyb3VwTm90QWRkZWQubGVuZ3RoID4gMCAmJiAhb3B0X3NpbGVudCkge1xuICAgIHRoaXMubm90aWZ5Q2FudEFkZEdyb3Vwc18oZ3JvdXBOb3RBZGRlZCk7XG4gIH1cblxuICByZXR1cm4gZ3JvdXBOb3RBZGRlZC5sZW5ndGggPT09IDA7XG59O1xuXG5MYXllcnRyZWVUcmVlTWFuYWdlci5wcm90b3R5cGUuc2V0SW5pdGlhbEZpcnN0TGV2ZWxHcm91cHMgPSBmdW5jdGlvbiAoZmlyc3RHcm91cHMpIHtcbiAgdGhpcy5pbml0aWFsTGV2ZWxGaXJzdEdyb3Vwc18gPSBmaXJzdEdyb3Vwcztcbn07XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5yZW9yZGVyQ2hpbGRfID0gZnVuY3Rpb24gKGFycmF5LCBvbGRfaW5kZXgsIG5ld19pbmRleCkge1xuICBhcnJheS5zcGxpY2UobmV3X2luZGV4LCAwLCBhcnJheS5zcGxpY2Uob2xkX2luZGV4LCAxKVswXSk7XG59O1xuXG5MYXllcnRyZWVUcmVlTWFuYWdlci5wcm90b3R5cGUudXBkYXRlVHJlZUdyb3Vwc1N0YXRlXyA9IGZ1bmN0aW9uIChncm91cHMpIHtcbiAgdmFyIHRyZWVHcm91cHNQYXJhbSA9IHt9O1xuICB0cmVlR3JvdXBzUGFyYW1bUGVybWFsaW5rUGFyYW0uVFJFRV9HUk9VUFNdID0gZ3JvdXBzLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgIHJldHVybiBub2RlLm5hbWU7XG4gIH0pLmpvaW4oJywnKTtcbiAgdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy51cGRhdGVTdGF0ZSh0cmVlR3JvdXBzUGFyYW0pO1xuXG4gIGlmICh0aGlzLiRpbmplY3Rvcl8uaGFzKCdnbWZQZXJtYWxpbmsnKSkge1xuICAgIHRoaXMuJGluamVjdG9yXy5nZXQoJ2dtZlBlcm1hbGluaycpLmNsZWFuUGFyYW1zKGdyb3Vwcyk7XG4gIH1cbn07XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5hZGRGaXJzdExldmVsR3JvdXBfID0gZnVuY3Rpb24gKGdyb3VwKSB7XG4gIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gIHZhciBhbHJlYWR5QWRkZWQgPSBmYWxzZTtcbiAgdmFyIGdyb3VwSUQgPSBncm91cC5pZDtcbiAgdGhpcy5yb290LmNoaWxkcmVuLnNvbWUoZnVuY3Rpb24gKHJvb3RDaGlsZCkge1xuICAgIGlmIChncm91cElEID09PSByb290Q2hpbGQuaWQpIHtcbiAgICAgIGFscmVhZHlBZGRlZCA9IHRydWU7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sIHRoaXMpO1xuICB0aGlzLmdyb3Vwc1RvQWRkSW5UaGlzRGlnZXN0TG9vcF8uc29tZShmdW5jdGlvbiAoZ3JwKSB7XG4gICAgaWYgKGdyb3VwSUQgPT09IGdycC5pZCkge1xuICAgICAgYWxyZWFkeUFkZGVkID0gdHJ1ZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSwgdGhpcyk7XG5cbiAgaWYgKGFscmVhZHlBZGRlZCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHRoaXMuZ3JvdXBzVG9BZGRJblRoaXNEaWdlc3RMb29wXy5wdXNoKGdyb3VwKTtcbiAgdGhpcy5udW1iZXJPZkdyb3Vwc1RvQWRkSW5UaGlzRGlnZXN0TG9vcCA9IDA7XG5cbiAgaWYgKHRoaXMucHJvbWlzZUZvckdyb3Vwc1RvQWRkSW5UaGlzRGlnZXN0TG9vcF8gIT09IG51bGwpIHtcbiAgICB0aGlzLiR0aW1lb3V0Xy5jYW5jZWwodGhpcy5wcm9taXNlRm9yR3JvdXBzVG9BZGRJblRoaXNEaWdlc3RMb29wXyk7XG4gIH1cblxuICB0aGlzLnByb21pc2VGb3JHcm91cHNUb0FkZEluVGhpc0RpZ2VzdExvb3BfID0gdGhpcy4kdGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgIF90aGlzMy5udW1iZXJPZkdyb3Vwc1RvQWRkSW5UaGlzRGlnZXN0TG9vcCA9IF90aGlzMy5ncm91cHNUb0FkZEluVGhpc0RpZ2VzdExvb3BfLmxlbmd0aDtcblxuICAgIF90aGlzMy5ncm91cHNUb0FkZEluVGhpc0RpZ2VzdExvb3BfLmZvckVhY2goZnVuY3Rpb24gKGdycCkge1xuICAgICAgX3RoaXMzLnJvb3QuY2hpbGRyZW4udW5zaGlmdChncnApO1xuXG4gICAgICBfdGhpczMucm9vdC5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCwgb2xkX2luZGV4KSB7XG4gICAgICAgIGlmIChfdGhpczMuaW5pdGlhbExldmVsRmlyc3RHcm91cHNfICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB2YXIgbmV3X2luZGV4ID0gX3RoaXMzLmluaXRpYWxMZXZlbEZpcnN0R3JvdXBzXy5maW5kSW5kZXgoZnVuY3Rpb24gKGZpcnN0TGV2ZWxHcm91cCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0TGV2ZWxHcm91cC5pZCA9PT0gZ3JvdXAuaWQ7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAobmV3X2luZGV4ICE9PSAtMSAmJiBuZXdfaW5kZXggIT09IG9sZF9pbmRleCkge1xuICAgICAgICAgICAgX3RoaXMzLnJlb3JkZXJDaGlsZF8oX3RoaXMzLnJvb3QuY2hpbGRyZW4sIG9sZF9pbmRleCwgbmV3X2luZGV4KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgX3RoaXMzLmluaXRpYWxMZXZlbEZpcnN0R3JvdXBzXyA9IHVuZGVmaW5lZDtcblxuICAgIF90aGlzMy51cGRhdGVUcmVlR3JvdXBzU3RhdGVfKF90aGlzMy5yb290LmNoaWxkcmVuKTtcblxuICAgIF90aGlzMy5ncm91cHNUb0FkZEluVGhpc0RpZ2VzdExvb3BfLmxlbmd0aCA9IDA7XG4gICAgX3RoaXMzLnByb21pc2VGb3JHcm91cHNUb0FkZEluVGhpc0RpZ2VzdExvb3BfID0gbnVsbDtcbiAgfSk7XG4gIHJldHVybiB0cnVlO1xufTtcblxuTGF5ZXJ0cmVlVHJlZU1hbmFnZXIucHJvdG90eXBlLmFkZEdyb3VwQnlOYW1lID0gZnVuY3Rpb24gKGdyb3VwTmFtZSwgb3B0X2FkZCkge1xuICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICB0aGlzLmdtZlRoZW1lc18uZ2V0VGhlbWVzT2JqZWN0KCkudGhlbihmdW5jdGlvbiAodGhlbWVzKSB7XG4gICAgdmFyIGdyb3VwID0gZmluZEdyb3VwQnlOYW1lKHRoZW1lcywgZ3JvdXBOYW1lKTtcblxuICAgIGlmIChncm91cCkge1xuICAgICAgX3RoaXM0LmFkZEZpcnN0TGV2ZWxHcm91cHMoW2dyb3VwXSwgb3B0X2FkZCwgZmFsc2UpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5MYXllcnRyZWVUcmVlTWFuYWdlci5wcm90b3R5cGUuYWRkR3JvdXBCeUxheWVyTmFtZSA9IGZ1bmN0aW9uIChsYXllck5hbWUsIG9wdF9hZGQsIG9wdF9zaWxlbnQpIHtcbiAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgdGhpcy5nbWZUaGVtZXNfLmdldFRoZW1lc09iamVjdCgpLnRoZW4oZnVuY3Rpb24gKHRoZW1lcykge1xuICAgIHZhciBncm91cCA9IGZpbmRHcm91cEJ5TGF5ZXJOb2RlTmFtZSh0aGVtZXMsIGxheWVyTmFtZSk7XG5cbiAgICBpZiAoZ3JvdXApIHtcbiAgICAgIHZhciBncm91cEFkZGVkID0gX3RoaXM1LmFkZEZpcnN0TGV2ZWxHcm91cHMoW2dyb3VwXSwgb3B0X2FkZCwgb3B0X3NpbGVudCk7XG5cbiAgICAgIF90aGlzNS4kdGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdHJlZUN0cmwgPSBfdGhpczUuZ2V0VHJlZUN0cmxCeU5vZGVJZChncm91cC5pZCk7XG5cbiAgICAgICAgaWYgKCF0cmVlQ3RybCkge1xuICAgICAgICAgIGNvbnNvbGUud2FybignVHJlZSBjb250cm9sbGVyIG5vdCBmb3VuZCwgdW5hYmxlIHRvIGFkZCB0aGUgZ3JvdXAnKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgdHJlZUN0cmxUb0FjdGl2ZSA9IG51bGw7XG4gICAgICAgIHRyZWVDdHJsLnRyYXZlcnNlRGVwdGhGaXJzdChmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgICAgICAgICBpZiAodHJlZUN0cmwubm9kZS5uYW1lID09PSBsYXllck5hbWUpIHtcbiAgICAgICAgICAgIHRyZWVDdHJsVG9BY3RpdmUgPSB0cmVlQ3RybDtcbiAgICAgICAgICAgIHJldHVybiBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24uU1RPUDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChncm91cEFkZGVkKSB7XG4gICAgICAgICAgdHJlZUN0cmwuc2V0U3RhdGUoJ29mZicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRyZWVDdHJsVG9BY3RpdmUgaW5zdGFuY2VvZiBMYXllcnRyZWVDb250cm9sbGVyKSB7XG4gICAgICAgICAgdHJlZUN0cmxUb0FjdGl2ZS5zZXRTdGF0ZSgnb24nKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn07XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5yZW1vdmVHcm91cCA9IGZ1bmN0aW9uIChncm91cCkge1xuICB2YXIgY2hpbGRyZW4gPSB0aGlzLnJvb3QuY2hpbGRyZW47XG4gIHZhciBpbmRleCA9IDAsXG4gICAgICBmb3VuZCA9IGZhbHNlO1xuICBjaGlsZHJlbi5zb21lKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgIGlmIChjaGlsZC5uYW1lID09PSBncm91cC5uYW1lKSB7XG4gICAgICByZXR1cm4gZm91bmQgPSB0cnVlO1xuICAgIH1cblxuICAgIGluZGV4Kys7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcblxuICBpZiAoZm91bmQpIHtcbiAgICBjaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIHRoaXMudXBkYXRlVHJlZUdyb3Vwc1N0YXRlXyhjaGlsZHJlbik7XG4gIH1cbn07XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gIHdoaWxlICh0aGlzLnJvb3QuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgdGhpcy5yZW1vdmVHcm91cCh0aGlzLnJvb3QuY2hpbGRyZW5bMF0pO1xuICB9XG59O1xuXG5MYXllcnRyZWVUcmVlTWFuYWdlci5wcm90b3R5cGUuY2xvbmVHcm91cE5vZGVfID0gZnVuY3Rpb24gKGdyb3VwLCBuYW1lcykge1xuICB2YXIgY2xvbmUgPSBPYmplY3QuYXNzaWduKHt9LCBncm91cCk7XG4gIHRoaXMudG9nZ2xlTm9kZUNoZWNrXyhjbG9uZSwgbmFtZXMpO1xuICByZXR1cm4gY2xvbmU7XG59O1xuXG5MYXllcnRyZWVUcmVlTWFuYWdlci5wcm90b3R5cGUudG9nZ2xlTm9kZUNoZWNrXyA9IGZ1bmN0aW9uIChub2RlLCBuYW1lcykge1xuICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICB2YXIgZ3JvdXBOb2RlID0gbm9kZTtcblxuICBpZiAoIWdyb3VwTm9kZS5jaGlsZHJlbikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGdyb3VwTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZE5vZGUpIHtcbiAgICB2YXIgY2hpbGRHcm91cE5vZGUgPSBjaGlsZE5vZGU7XG5cbiAgICBpZiAoY2hpbGRHcm91cE5vZGUuY2hpbGRyZW4pIHtcbiAgICAgIF90aGlzNi50b2dnbGVOb2RlQ2hlY2tfKGNoaWxkR3JvdXBOb2RlLCBuYW1lcyk7XG4gICAgfSBlbHNlIGlmIChjaGlsZE5vZGUubWV0YWRhdGEpIHtcbiAgICAgIGNoaWxkTm9kZS5tZXRhZGF0YS5pc0NoZWNrZWQgPSBuYW1lcy5pbmNsdWRlcyhjaGlsZE5vZGUubmFtZSk7XG4gICAgfVxuICB9KTtcbn07XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5ub3RpZnlDYW50QWRkR3JvdXBzXyA9IGZ1bmN0aW9uIChncm91cHMpIHtcbiAgdmFyIG5hbWVzID0gW107XG4gIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICBncm91cHMuZm9yRWFjaChmdW5jdGlvbiAoZ3JvdXApIHtcbiAgICBuYW1lcy5wdXNoKGdldHRleHRDYXRhbG9nLmdldFN0cmluZyhncm91cC5uYW1lKSk7XG4gIH0pO1xuICB2YXIgbXNnID0gbmFtZXMubGVuZ3RoIDwgMiA/IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnZ3JvdXAgaXMgYWxyZWFkeSBsb2FkZWQuJykgOiBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ2dyb3VwcyBhcmUgYWxyZWFkeSBsb2FkZWQuJyk7XG4gIHRoaXMubmdlb05vdGlmaWNhdGlvbl8ubm90aWZ5KHtcbiAgICBtc2c6IG5hbWVzLmpvaW4oJywgJykgKyBcIiBcIiArIG1zZyxcbiAgICB0eXBlOiBNZXNzYWdlVHlwZS5JTkZPUk1BVElPTlxuICB9KTtcbn07XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5nZXRUcmVlQ3RybEJ5Tm9kZUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gIHZhciBjb3JyZXNwb25kaW5nVHJlZUN0cmwgPSBudWxsO1xuXG4gIGlmICh0aGlzLnJvb3RDdHJsICYmIHRoaXMucm9vdEN0cmwudHJhdmVyc2VEZXB0aEZpcnN0KSB7XG4gICAgdGhpcy5yb290Q3RybC50cmF2ZXJzZURlcHRoRmlyc3QoZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gICAgICBpZiAodHJlZUN0cmwubm9kZS5pZCA9PT0gaWQpIHtcbiAgICAgICAgY29ycmVzcG9uZGluZ1RyZWVDdHJsID0gdHJlZUN0cmw7XG4gICAgICAgIHJldHVybiBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24uU1RPUDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBjb3JyZXNwb25kaW5nVHJlZUN0cmw7XG59O1xuXG5MYXllcnRyZWVUcmVlTWFuYWdlci5wcm90b3R5cGUuZ2V0T2djU2VydmVyID0gZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gIGlmICghdGhpcy5vZ2NTZXJ2ZXJzXykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBvZ2NTZXJ2ZXJzJyk7XG4gIH1cblxuICB2YXIgZ21mUGFyZW50R3JvdXAgPSB0cmVlQ3RybC5wYXJlbnQubm9kZTtcblxuICBpZiAoZ21mUGFyZW50R3JvdXAubWl4ZWQpIHtcbiAgICB2YXIgZ21mTGF5ZXJXTVMgPSB0cmVlQ3RybC5ub2RlO1xuXG4gICAgaWYgKCFnbWZMYXllcldNUy5vZ2NTZXJ2ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnbWZMYXllcldNUy5vZ2NTZXJ2ZXInKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5vZ2NTZXJ2ZXJzX1tnbWZMYXllcldNUy5vZ2NTZXJ2ZXJdO1xuICB9IGVsc2Uge1xuICAgIHZhciBmaXJzdExldmVsR3JvdXBDdHJsID0gdHJlZUN0cmw7XG5cbiAgICB3aGlsZSAoIWZpcnN0TGV2ZWxHcm91cEN0cmwucGFyZW50LmlzUm9vdCkge1xuICAgICAgZmlyc3RMZXZlbEdyb3VwQ3RybCA9IGZpcnN0TGV2ZWxHcm91cEN0cmwucGFyZW50O1xuICAgIH1cblxuICAgIHZhciBnbWZHcm91cCA9IGZpcnN0TGV2ZWxHcm91cEN0cmwubm9kZTtcblxuICAgIGlmICghZ21mR3JvdXAub2djU2VydmVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ21mR3JvdXAub2djU2VydmVyJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMub2djU2VydmVyc19bZ21mR3JvdXAub2djU2VydmVyXTtcbiAgfVxufTtcblxuTGF5ZXJ0cmVlVHJlZU1hbmFnZXIucHJvdG90eXBlLnJlZnJlc2hGaXJzdExldmVsR3JvdXBzXyA9IGZ1bmN0aW9uICh0aGVtZXMpIHtcbiAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgaWYgKCF0aGlzLnJvb3RDdHJsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJvb3RDdHJsJyk7XG4gIH1cblxuICB2YXIgZmlyc3RMZXZlbEdyb3Vwc0Z1bGxTdGF0ZSA9IHt9O1xuICB0aGlzLnJvb3RDdHJsLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgICB2YXIgbmFtZSA9IHRyZWVDdHJsLm5vZGUubmFtZTtcbiAgICBmaXJzdExldmVsR3JvdXBzRnVsbFN0YXRlW25hbWVdID0gX3RoaXM3LmdldEZpcnN0TGV2ZWxHcm91cEZ1bGxTdGF0ZV8odHJlZUN0cmwpO1xuICB9KTtcbiAgdmFyIG5vZGVzVG9SZXN0b3JlID0gW107XG4gIHRoaXMucm9vdC5jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcbiAgICB2YXIgbmFtZSA9IG5vZGUubmFtZTtcbiAgICB2YXIgbm9kZVRvUmVzdG9yZSA9IGZpbmRHcm91cEJ5TmFtZSh0aGVtZXMsIG5hbWUpO1xuXG4gICAgaWYgKG5vZGVUb1Jlc3RvcmUpIHtcbiAgICAgIHZhciBmdWxsU3RhdGUgPSBmaXJzdExldmVsR3JvdXBzRnVsbFN0YXRlW25hbWVdO1xuXG4gICAgICBpZiAoZnVsbFN0YXRlKSB7XG4gICAgICAgIF90aGlzNy5zZXROb2RlTWV0YWRhdGFGcm9tRnVsbFN0YXRlXyhub2RlVG9SZXN0b3JlLCBmdWxsU3RhdGUpO1xuICAgICAgfVxuXG4gICAgICBub2Rlc1RvUmVzdG9yZS5wdXNoKG5vZGVUb1Jlc3RvcmUpO1xuICAgIH1cbiAgfSk7XG4gIHRoaXMuc2V0Rmlyc3RMZXZlbEdyb3Vwcyhub2Rlc1RvUmVzdG9yZSk7XG4gIHRoaXMuJHRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICBfdGhpczcudXBkYXRlVHJlZUdyb3Vwc1N0YXRlXyhfdGhpczcucm9vdC5jaGlsZHJlbik7XG4gIH0pO1xufTtcblxuTGF5ZXJ0cmVlVHJlZU1hbmFnZXIucHJvdG90eXBlLmdldEZpcnN0TGV2ZWxHcm91cEZ1bGxTdGF0ZV8gPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgdmFyIGNoaWxkcmVuID0ge307XG4gIHRyZWVDdHJsLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICBjaGlsZHJlbltjaGlsZC5ub2RlLm5hbWVdID0gX3RoaXM4LmdldEZpcnN0TGV2ZWxHcm91cEZ1bGxTdGF0ZV8oY2hpbGQpO1xuICB9KTtcbiAgdmFyIGlzQ2hlY2tlZCwgaXNFeHBhbmRlZCwgaXNMZWdlbmRFeHBhbmRlZDtcblxuICBpZiAodHJlZUN0cmwuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgIHZhciBub2RlRWxlbWVudCA9ICQoXCIjZ21mLWxheWVydHJlZS1sYXllci1ncm91cC1cIiArIHRyZWVDdHJsLnVpZCk7XG5cbiAgICBpZiAobm9kZUVsZW1lbnQpIHtcbiAgICAgIGlzRXhwYW5kZWQgPSBub2RlRWxlbWVudC5oYXNDbGFzcygnc2hvdycpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpc0NoZWNrZWQgPSB0cmVlQ3RybC5nZXRTdGF0ZSgpO1xuXG4gICAgaWYgKGlzQ2hlY2tlZCA9PT0gJ29uJykge1xuICAgICAgaXNDaGVja2VkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGlzQ2hlY2tlZCA9PT0gJ29mZicpIHtcbiAgICAgIGlzQ2hlY2tlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpc0NoZWNrZWQgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdmFyIGxlZ2VuZEVsZW1lbnQgPSAkKFwiI2dtZi1sYXllcnRyZWUtbm9kZS1cIiArIHRyZWVDdHJsLnVpZCArIFwiLWxlZ2VuZFwiKTtcblxuICAgIGlmIChsZWdlbmRFbGVtZW50KSB7XG4gICAgICBpc0xlZ2VuZEV4cGFuZGVkID0gbGVnZW5kRWxlbWVudC5pcygnOnZpc2libGUnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNoaWxkcmVuOiBjaGlsZHJlbixcbiAgICBpc0NoZWNrZWQ6IGlzQ2hlY2tlZCxcbiAgICBpc0V4cGFuZGVkOiBpc0V4cGFuZGVkLFxuICAgIGlzTGVnZW5kRXhwYW5kZWQ6IGlzTGVnZW5kRXhwYW5kZWRcbiAgfTtcbn07XG5cbkxheWVydHJlZVRyZWVNYW5hZ2VyLnByb3RvdHlwZS5zZXROb2RlTWV0YWRhdGFGcm9tRnVsbFN0YXRlXyA9IGZ1bmN0aW9uIChub2RlLCBmdWxsU3RhdGUpIHtcbiAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgaWYgKCFmdWxsU3RhdGUpIHtcbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuXG4gIHZhciBncm91cE5vZGUgPSBub2RlO1xuXG4gIGlmIChncm91cE5vZGUuY2hpbGRyZW4pIHtcbiAgICBncm91cE5vZGUuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgX3RoaXM5LnNldE5vZGVNZXRhZGF0YUZyb21GdWxsU3RhdGVfKGNoaWxkLCBmdWxsU3RhdGUuY2hpbGRyZW5bY2hpbGQubmFtZV0pO1xuICAgIH0pO1xuICB9XG5cbiAgdmFyIG1ldGFkYXRhID0gbm9kZS5tZXRhZGF0YTtcbiAgbWV0YWRhdGEuaXNDaGVja2VkID0gZnVsbFN0YXRlLmlzQ2hlY2tlZDtcbiAgbWV0YWRhdGEuaXNFeHBhbmRlZCA9IGZ1bGxTdGF0ZS5pc0V4cGFuZGVkO1xuICBtZXRhZGF0YS5pc0xlZ2VuZEV4cGFuZGVkID0gZnVsbFN0YXRlLmlzTGVnZW5kRXhwYW5kZWQ7XG4gIHJldHVybiBub2RlO1xufTtcblxudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZUcmVlTWFuYWdlcicsIFtnbWZUaGVtZVRoZW1lcy5uYW1lLCBuZ2VvTGF5ZXJ0cmVlQ29udHJvbGxlci5uYW1lLCBuZ2VvTWVzc2FnZU5vdGlmaWNhdGlvbi5uYW1lLCBuZ2VvU3RhdGVtYW5hZ2VyU2VydmljZS5uYW1lXSk7XG5tb2R1bGUuc2VydmljZSgnZ21mVHJlZU1hbmFnZXInLCBMYXllcnRyZWVUcmVlTWFuYWdlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdlxcbiAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1yb290LXRvb2xzXCJcXG4gICBuZy1pZj1cImxheWVydHJlZUN0cmwuaXNSb290XCI+XFxuICA8YVxcbiAgICAgaHJlZlxcbiAgICAgbmctaWY9XCJnbWZMYXllcnRyZWVDdHJsLm5vZGVzQ291bnQoKSA+IDBcIlxcbiAgICAgbmctY2xpY2s9XCJnbWZMYXllcnRyZWVDdHJsLnJlbW92ZUFsbE5vZGVzKClcIj5cXG4gICAgPHNwYW4gY2xhc3M9XCJmYSBmYS10cmFzaFwiPjwvc3Bhbj4ge3tcXCdDbGVhciBhbGxcXCcgfCB0cmFuc2xhdGV9fVxcbiAgPC9hPlxcbjwvZGl2PlxcbjxkaXZcXG4gIG5nLWlmPVwiOjohbGF5ZXJ0cmVlQ3RybC5pc1Jvb3RcIlxcbiAgaWQ9XCJnbWYtbGF5ZXJ0cmVlLW5vZGUte3s6OmxheWVydHJlZUN0cmwudWlkfX1cIlxcbiAgbmctY2xhc3M9XCJbbGF5ZXJ0cmVlQ3RybC5ub2RlLmNoaWxkcmVuID8gXFwnZ21mLWxheWVydHJlZS1ncm91cFxcJyA6IFxcJ2dtZi1sYXllcnRyZWUtbGVhZlxcJywgXFwnZ21mLWxheWVydHJlZS1kZXB0aC1cXCcgKyBsYXllcnRyZWVDdHJsLmRlcHRoLCBnbWZMYXllcnRyZWVDdHJsLmdldFJlc29sdXRpb25TdHlsZShsYXllcnRyZWVDdHJsLm5vZGUpLCBnbWZMYXllcnRyZWVDdHJsLmdldE5vZGVTdGF0ZShsYXllcnRyZWVDdHJsKV1cIj5cXG5cXG4gIDxkaXZcXG4gICAgY2xhc3M9XCJuZ2VvLXNvcnRhYmxlLWhhbmRsZVwiXFxuICAgIG5nLXNob3c9XCJsYXllcnRyZWVDdHJsLmRlcHRoID09PSAxICYmIGxheWVydHJlZUN0cmwucGFyZW50LmNoaWxkcmVuLmxlbmd0aCA+IDFcIj5cXG4gICAgPGkgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLXNvcnRhYmxlLWhhbmRsZS1pY29uIGZhIGZhLWVsbGlwc2lzLXZcIj48L2k+XFxuICA8L2Rpdj5cXG5cXG4gIDxhXFxuICAgIG5nLWlmPVwiOjpsYXllcnRyZWVDdHJsLm5vZGUuY2hpbGRyZW5cIlxcbiAgICBkYXRhLXRvZ2dsZT1cImNvbGxhcHNlXCJcXG4gICAgaHJlZj1cIiNnbWYtbGF5ZXJ0cmVlLWxheWVyLWdyb3VwLXt7OjpsYXllcnRyZWVDdHJsLnVpZH19XCJcXG4gICAgYXJpYS1leHBhbmRlZD1cInt7OjpsYXllcnRyZWVDdHJsLm5vZGUubWV0YWRhdGEuaXNFeHBhbmRlZH19XCJcXG4gICAgY2xhc3M9XCJmYSBnbWYtbGF5ZXJ0cmVlLWV4cGFuZC1ub2RlIGZhLWZ3XCI+XFxuICA8L2E+XFxuXFxuICA8YVxcbiAgICBocmVmXFxuICAgIG5nLWNsaWNrPVwiOjpnbWZMYXllcnRyZWVDdHJsLnRvZ2dsZUFjdGl2ZShsYXllcnRyZWVDdHJsKVwiXFxuICAgIG5nLWlmPVwiOjohbGF5ZXJ0cmVlQ3RybC5ub2RlLmNoaWxkcmVuICYmIGdtZkxheWVydHJlZUN0cmwuZ2V0TGVnZW5kSWNvblVSTChsYXllcnRyZWVDdHJsKVwiXFxuICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1sYXllci1pY29uXCJcXG4gID5cXG4gICAgPGRpdj48IS0tVGhpcyBkaXYgaXMgcmVxdWlyZWQgZm9yIGZsZXggaXNzdWVzIHdpdGggSUUxMS0tPlxcbiAgICAgIDxpbWdcXG4gICAgICAgIG5nLWlmPVwiOjoobGVnZW5kSWNvblVybD1nbWZMYXllcnRyZWVDdHJsLmdldExlZ2VuZEljb25VUkwobGF5ZXJ0cmVlQ3RybCkpXCJcXG4gICAgICAgIG5nLXNyYz1cInt7OjpsZWdlbmRJY29uVXJsfX1cIj5cXG4gICAgICA8L2ltZz5cXG4gICAgPC9kaXY+XFxuICA8L2E+XFxuICA8YVxcbiAgICBocmVmXFxuICAgIG5nLWNsaWNrPVwiOjpnbWZMYXllcnRyZWVDdHJsLnRvZ2dsZUFjdGl2ZShsYXllcnRyZWVDdHJsKVwiXFxuICAgIG5nLWlmPVwiOjohbGF5ZXJ0cmVlQ3RybC5ub2RlLmNoaWxkcmVuICYmICFnbWZMYXllcnRyZWVDdHJsLmdldExlZ2VuZEljb25VUkwobGF5ZXJ0cmVlQ3RybClcIlxcbiAgICBjbGFzcz1cImdtZi1sYXllcnRyZWUtbGF5ZXItaWNvbiBnbWYtbGF5ZXJ0cmVlLW5vLWxheWVyLWljb25cIlxcbiAgPicgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL2RvdC5zdmc/dmlld2JveCZoZWlnaHQ9MWVtJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbic8L2E+XFxuXFxuICA8YVxcbiAgICBocmVmXFxuICAgIG5nLWNsaWNrPVwiOjpnbWZMYXllcnRyZWVDdHJsLnRvZ2dsZUFjdGl2ZShsYXllcnRyZWVDdHJsKVwiXFxuICAgIG5nLWlmPVwibGF5ZXJ0cmVlQ3RybC5ub2RlLmNoaWxkcmVuICYmIGxheWVydHJlZUN0cmwubGF5ZXIubG9hZGluZ1wiXFxuICAgIGNsYXNzPVwiZmEgZmEtZncgZmEtcmVmcmVzaCBmYS1zeW5jIGZhLXNwaW5cIlxcbiAgPjwvYT5cXG4gIDxhXFxuICAgIGhyZWZcXG4gICAgbmctY2xpY2s9XCI6OmdtZkxheWVydHJlZUN0cmwudG9nZ2xlQWN0aXZlKGxheWVydHJlZUN0cmwpXCJcXG4gICAgbmctaWY9XCJsYXllcnRyZWVDdHJsLm5vZGUuY2hpbGRyZW4gJiYgIWxheWVydHJlZUN0cmwubGF5ZXIubG9hZGluZ1wiXFxuICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1zdGF0ZSBnbWYtbm90LWludGVybWVkaWF0ZVwiXFxuICA+JyArXG4oKF9fdCA9IChyZXF1aXJlKCdnbWYvaWNvbnMvbGF5ZXJzLnN2Zz92aWV3Ym94JmhlaWdodD0xZW0nKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJzwvYT5cXG4gIDxhXFxuICAgIGhyZWZcXG4gICAgbmctY2xpY2s9XCI6OmdtZkxheWVydHJlZUN0cmwudG9nZ2xlQWN0aXZlKGxheWVydHJlZUN0cmwpXCJcXG4gICAgbmctaWY9XCJsYXllcnRyZWVDdHJsLm5vZGUuY2hpbGRyZW4gJiYgIWxheWVydHJlZUN0cmwubGF5ZXIubG9hZGluZ1wiXFxuICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1zdGF0ZSBnbWYtaW50ZXJtZWRpYXRlXCJcXG4gID4nICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9zdGFjay1pbmRldGVybWluYXRlLnN2Zz92aWV3Ym94JmhlaWdodD0xZW0nKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJzwvYT5cXG5cXG4gIDxhXFxuICAgIGhyZWZcXG4gICAgZGF0YS1zZW50cnk9XCJpZDp7e2xheWVydHJlZUN0cmwubm9kZS5pZH19XCJcXG4gICAgbmctY2xpY2s9XCI6OmdtZkxheWVydHJlZUN0cmwudG9nZ2xlQWN0aXZlKGxheWVydHJlZUN0cmwpXCJcXG4gICAgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLW5hbWVcIlxcbiAgICBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIlxcbiAgICBkYXRhLXBsYWNlbWVudD1cInRvcFwiXFxuICAgIHRpdGxlPVwie3tsYXllcnRyZWVDdHJsLm5vZGUubmFtZSB8IHRyYW5zbGF0ZX19XCI+XFxuXFxuICAgIHt7bGF5ZXJ0cmVlQ3RybC5ub2RlLm5hbWUgfCB0cmFuc2xhdGV9fVxcblxcbiAgICA8aSBuZy1pZj1cImdtZkxheWVydHJlZUN0cmwuZ21mTGF5ZXJCZWluZ1N3aXBlLmxheWVyICYmIGdtZkxheWVydHJlZUN0cmwuZ21mTGF5ZXJCZWluZ1N3aXBlLmxheWVyID09PSBsYXllcnRyZWVDdHJsLmxheWVyXCI+XFxuICAgICAgJyArXG4oKF9fdCA9IChyZXF1aXJlKCduZ2VvL2ljb25zL3N3aXBlLnN2Zz92aWV3Ym94JndpZHRoPTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICAgIDwvaT5cXG5cXG4gICAgPGlcXG4gICAgICBjbGFzcz1cImdtZi1sYXllcnRyZWUtem9vbVwiXFxuICAgICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgICBkYXRhLXBsYWNlbWVudD1cImJvdHRvbVwiXFxuICAgICAgZGF0YS10aXRsZT1cInt7XFwnTm90IHZpc2libGUgYXQgY3VycmVudCBzY2FsZS4gQ2xpY2sgdG8gem9vbS5cXCd8dHJhbnNsYXRlfX1cIlxcbiAgICAgIG5nLWNsaWNrPVwiOjpnbWZMYXllcnRyZWVDdHJsLnpvb21Ub1Jlc29sdXRpb24obGF5ZXJ0cmVlQ3RybCk7ICRldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XCJcXG4gICAgICBuZy1pZj1cImdtZkxheWVydHJlZUN0cmwuZ2V0Tm9kZVN0YXRlKGxheWVydHJlZUN0cmwpID09IFxcJ29uXFwnXCJcXG4gICAgPicgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL3NlYXJjaC1nby5zdmc/dmlld2JveCZoZWlnaHQ9MWVtJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbic8L2k+XFxuXFxuICAgIDxzcGFuXFxuICAgICAgbmdlby1wb3BvdmVyXFxuICAgICAgbmdlby1wb3BvdmVyLWRpc21pc3M9XCIuY29udGVudFwiXFxuICAgICAgbmctaWY9XCJnbWZMYXllcnRyZWVDdHJsLmdldE5vZGVTdGF0ZShsYXllcnRyZWVDdHJsKSAhPT0gXFwnb2ZmXFwnICYmIGxheWVydHJlZUN0cmwubm9kZS50aW1lICYmIGxheWVydHJlZUN0cmwubm9kZS50aW1lLm1vZGUgIT09IFxcJ2Rpc2FibGVkXFwnXCI+XFxuXFxuICAgICAgPHNwYW5cXG4gICAgICAgIG5nZW8tcG9wb3Zlci1hbmNob3JcXG4gICAgICAgIGNsYXNzPVwiZmFyIGZhLWNsb2NrXCJcXG4gICAgICAgIG5nLWNsaWNrPVwiJGV2ZW50LnByZXZlbnREZWZhdWx0KCk7ICRldmVudC5zdG9wUHJvcGFnYXRpb24oKVwiPlxcbiAgICAgIDwvc3Bhbj5cXG5cXG4gICAgICA8ZGl2IG5nZW8tcG9wb3Zlci1jb250ZW50PlxcbiAgICAgICAgPG5nZW8tZGF0ZS1waWNrZXJcXG4gICAgICAgICAgbmctaWY9XCI6OmxheWVydHJlZUN0cmwubm9kZS50aW1lLndpZGdldCA9PT0gXFwnZGF0ZXBpY2tlclxcJ1wiXFxuICAgICAgICAgIHRpbWU9XCJsYXllcnRyZWVDdHJsLm5vZGUudGltZVwiXFxuICAgICAgICAgIG9uLWRhdGUtc2VsZWN0ZWQ9XCJnbWZMYXllcnRyZWVDdHJsLnVwZGF0ZVdNU1RpbWVMYXllclN0YXRlKGxheWVydHJlZUN0cmwsIHRpbWUpXCI+XFxuICAgICAgICA8L25nZW8tZGF0ZS1waWNrZXI+XFxuXFxuICAgICAgICA8Z21mLXRpbWUtc2xpZGVyXFxuICAgICAgICAgIG5nLWlmPVwiOjpsYXllcnRyZWVDdHJsLm5vZGUudGltZS53aWRnZXQgPT09IFxcJ3NsaWRlclxcJ1wiXFxuICAgICAgICAgIGdtZi10aW1lLXNsaWRlci10aW1lPVwibGF5ZXJ0cmVlQ3RybC5ub2RlLnRpbWVcIlxcbiAgICAgICAgICBnbWYtdGltZS1zbGlkZXItb24tZGF0ZS1zZWxlY3RlZD1cImdtZkxheWVydHJlZUN0cmwudXBkYXRlV01TVGltZUxheWVyU3RhdGUobGF5ZXJ0cmVlQ3RybCwgdGltZSlcIj5cXG4gICAgICAgIDwvZ21mLXRpbWUtc2xpZGVyPlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L3NwYW4+XFxuXFxuICAgIDxzcGFuXFxuICAgICAgY2xhc3M9XCJmYSBmYS1lZGl0XCJcXG4gICAgICBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIlxcbiAgICAgIGRhdGEtcGxhY2VtZW50PVwicmlnaHRcIlxcbiAgICAgIHRpdGxlPVwie3tcXCdDdXJyZW50bHkgZWRpdGluZyB0aGlzIGxheWVyXFwnfHRyYW5zbGF0ZX19XCJcXG4gICAgICBuZy1pZj1cImxheWVydHJlZUN0cmwucHJvcGVydGllcy5lZGl0aW5nXCI+XFxuICAgIDwvc3Bhbj5cXG5cXG4gICAgPHNwYW5cXG4gICAgICBjbGFzcz1cImZhcyBmYS1tYWduZXRcIlxcbiAgICAgIG5nLWlmPVwibGF5ZXJ0cmVlQ3RybC5ub2RlLm1ldGFkYXRhLnNuYXBwaW5nQ29uZmlnXCJcXG4gICAgICBuZy1jbGFzcz1cImdtZkxheWVydHJlZUN0cmwuaXNTbmFwcGluZ0FjdGl2YXRlZChsYXllcnRyZWVDdHJsKSA/IFxcJ29uXFwnIDogXFwnb2ZmXFwnXCJcXG4gICAgICBuZy1jbGljaz1cImdtZkxheWVydHJlZUN0cmwudG9nZ2xlU25hcHBpbmcobGF5ZXJ0cmVlQ3RybCk7ICRldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XCJcXG4gICAgPlxcbiAgICA8L3NwYW4+XFxuICA8L2E+XFxuXFxuICA8c3BhbiBjbGFzcz1cImdtZi1sYXllcnRyZWUtcmlnaHQtYnV0dG9uc1wiPlxcbiAgICA8YVxcbiAgICAgIGhyZWY9XCJcIlxcbiAgICAgIG5nLWlmPVwiOjpsYXllcnRyZWVDdHJsLmRlcHRoID09IDFcIlxcbiAgICAgIG5nLWNsaWNrPVwiZ21mTGF5ZXJ0cmVlQ3RybC5yZW1vdmVOb2RlKGxheWVydHJlZUN0cmwubm9kZSlcIj5cXG4gICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLXRyYXNoXCI+PC9zcGFuPlxcbiAgICA8L2E+XFxuXFxuICAgIDxhXFxuICAgICAgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLW5vZGUtbWVudS1idG5cIlxcbiAgICAgIGhyZWY9XCJcIlxcbiAgICAgIG5nLWlmPVwiOjpnbWZMYXllcnRyZWVDdHJsLnN1cHBvcnRzQ3VzdG9taXphdGlvbihsYXllcnRyZWVDdHJsKVwiXFxuICAgICAgbmctY2xpY2s9XCI6OmdtZkxheWVydHJlZUN0cmwudG9nZ2xlTm9kZUxlZ2VuZChcXCcjZ21mLWxheWVydHJlZS1ub2RlLW1lbnUtXFwnICsgbGF5ZXJ0cmVlQ3RybC51aWQpXCI+XFxuICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS1jb2dcIj48L3NwYW4+XFxuICAgIDwvYT5cXG5cXG4gICAgPHNwYW5cXG4gICAgICBuZ2VvLXBvcG92ZXJcXG4gICAgICBuZy1pZj1cIjo6KGxheWVydHJlZUN0cmwuZGVwdGggPT09IDEgJiYgIWxheWVydHJlZUN0cmwubm9kZS5taXhlZCkgfHwgKGxheWVydHJlZUN0cmwuZGVwdGggPiAxICYmIGxheWVydHJlZUN0cmwucGFyZW50Lm5vZGUubWl4ZWQgJiYgIWxheWVydHJlZUN0cmwubm9kZS5jaGlsZHJlbikgfHwgKGdtZkxheWVydHJlZUN0cmwuZ2V0TGVnZW5kc09iamVjdChsYXllcnRyZWVDdHJsKSAmJiBsYXllcnRyZWVDdHJsLm5vZGUubWV0YWRhdGEubGVnZW5kKSB8fCBsYXllcnRyZWVDdHJsLmdldERhdGFTb3VyY2UoKS5maWx0cmFibGVcIiBuZ2VvLXBvcG92ZXItZGlzbWlzcz1cIi5jb250ZW50XCI+XFxuXFxuICAgICAgPHNwYW5cXG4gICAgICAgIG5nZW8tcG9wb3Zlci1hbmNob3JcXG4gICAgICAgIGNsYXNzPVwiZXh0cmEtYWN0aW9ucyBmYSBmYS1jb2dcIj5cXG4gICAgICA8L3NwYW4+XFxuXFxuICAgICAgPGRpdiBuZ2VvLXBvcG92ZXItY29udGVudD5cXG4gICAgICAgIDx1bD5cXG4gICAgICAgICAgPGxpIG5nLWlmPVwiOjoobGF5ZXJ0cmVlQ3RybC5kZXB0aCA9PT0gMSAmJiAhbGF5ZXJ0cmVlQ3RybC5ub2RlLm1peGVkKSB8fCAobGF5ZXJ0cmVlQ3RybC5kZXB0aCA+IDEgJiYgbGF5ZXJ0cmVlQ3RybC5wYXJlbnQubm9kZS5taXhlZClcIj5cXG4gICAgICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXRpbnQgZmEtZndcIj48L2k+XFxuICAgICAgICAgICAgPHNwYW4+e3tcXCdPcGFjaXR5XFwnfHRyYW5zbGF0ZX19PC9zcGFuPlxcbiAgICAgICAgICAgIDxpbnB1dFxcbiAgICAgICAgICAgICAgY2xhc3M9XCJpbnB1dC1hY3Rpb25cIlxcbiAgICAgICAgICAgICAgdHlwZT1cInJhbmdlXCJcXG4gICAgICAgICAgICAgIG1pbj1cIjBcIlxcbiAgICAgICAgICAgICAgbWF4PVwiMVwiXFxuICAgICAgICAgICAgICBzdGVwPVwiMC4wMVwiXFxuICAgICAgICAgICAgICBuZy1tb2RlbD1cImxheWVydHJlZUN0cmwubGF5ZXIub3BhY2l0eVwiIC8+XFxuICAgICAgICAgIDwvbGk+XFxuICAgICAgICAgIDxsaSBuZy1pZj1cIjo6Z21mTGF5ZXJ0cmVlQ3RybC5nZXRMZWdlbmRzT2JqZWN0KGxheWVydHJlZUN0cmwpICYmIGxheWVydHJlZUN0cmwubm9kZS5tZXRhZGF0YS5sZWdlbmRcIj5cXG4gICAgICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXRoLWxpc3QgZmEtZndcIj48L2k+XFxuICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiOjpnbWZMYXllcnRyZWVDdHJsLnRvZ2dsZU5vZGVMZWdlbmQoXFwnI2dtZi1sYXllcnRyZWUtbm9kZS1cXCcgKyBsYXllcnRyZWVDdHJsLnVpZCArIFxcJy1sZWdlbmRcXCcpOyBwb3BvdmVyQ3RybC5kaXNtaXNzUG9wb3ZlcigpXCJcXG4gICAgICAgICAgICAgIGhyZWY9XCJcIj5cXG4gICAgICAgICAgICAgIHt7XFwnU2hvdy9oaWRlIGxlZ2VuZFxcJ3x0cmFuc2xhdGV9fVxcbiAgICAgICAgICAgIDwvYT5cXG4gICAgICAgICAgPC9saT5cXG4gICAgICAgICAgPGxpIG5nLWlmPVwiOjpnbWZMYXllcnRyZWVDdHJsLnN1cHBvcnRzT3BhY2l0eUNoYW5nZShsYXllcnRyZWVDdHJsKVwiPlxcbiAgICAgICAgICAgIDxpPicgK1xuKChfX3QgPSAocmVxdWlyZSgnbmdlby9pY29ucy9zd2lwZS5zdmc/dmlld2JveCZoZWlnaHQ9MWVtJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbic8L2k+XFxuICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiOjpnbWZMYXllcnRyZWVDdHJsLnRvZ2dsZVN3aXBlTGF5ZXIobGF5ZXJ0cmVlQ3RybCk7IHBvcG92ZXJDdHJsLmRpc21pc3NQb3BvdmVyKClcIlxcbiAgICAgICAgICAgICAgaHJlZj1cIlwiXFxuICAgICAgICAgICAgICBuZy1tb2RlbD1cImxheWVydHJlZUN0cmwubGF5ZXJcIlxcbiAgICAgICAgICAgICAgPlxcbiAgICAgICAgICAgICAge3tcXCdTd2lwZSB3aXRoIHRoaXMgbGF5ZXJcXCd8IHRyYW5zbGF0ZX19XFxuICAgICAgICAgICAgPC9hPlxcbiAgICAgICAgICA8L2xpPlxcbiAgICAgICAgICA8bGkgbmctaWY9XCJsYXllcnRyZWVDdHJsLmdldERhdGFTb3VyY2UoKSAmJiBsYXllcnRyZWVDdHJsLmdldERhdGFTb3VyY2UoKS5maWx0cmFibGVcIj5cXG4gICAgICAgICAgICA8aSBjbGFzcz1cImZhIGZhLWZpbHRlciBmYS1md1wiPjwvaT5cXG4gICAgICAgICAgICA8YVxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCJnbWZMYXllcnRyZWVDdHJsLnRvZ2dsZUZpbHRyYWJsZURhdGFTb3VyY2UobGF5ZXJ0cmVlQ3RybC5nZXREYXRhU291cmNlKCkpXCJcXG4gICAgICAgICAgICAgIGhyZWY9XCJcIj5cXG4gICAgICAgICAgICAgIHt7XFwnRmlsdGVyXFwnfHRyYW5zbGF0ZX19XFxuICAgICAgICAgICAgPC9hPlxcbiAgICAgICAgICA8L2xpPlxcbiAgICAgICAgPC91bD5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9zcGFuPlxcblxcbiAgICA8c3BhblxcbiAgICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1tZXRhZGF0YVwiXFxuICAgICAgbmctaWY9XCI6OmxheWVydHJlZUN0cmwubm9kZS5tZXRhZGF0YS5tZXRhZGF0YVVybFwiPlxcblxcbiAgICAgIDxzcGFuIG5nLWlmPVwiOjpnbWZMYXllcnRyZWVDdHJsLm9wZW5MaW5rc0luTmV3V2luZG93ID09PSB0cnVlXCI+XFxuICAgICAgICA8YVxcbiAgICAgICAgICB0aXRsZT1cInt7XFwnTW9yZSBpbmZvcm1hdGlvblxcJ3x0cmFuc2xhdGV9fVwiXFxuICAgICAgICAgIGhyZWY9XCJ7ezo6bGF5ZXJ0cmVlQ3RybC5ub2RlLm1ldGFkYXRhLm1ldGFkYXRhVXJsfX1cIlxcbiAgICAgICAgICB0YXJnZXQ9XCJibGFua19cIj5cXG4gICAgICAgIDwvYT5cXG4gICAgICA8L3NwYW4+XFxuXFxuICAgICAgPHNwYW4gbmctaWY9XCI6OmdtZkxheWVydHJlZUN0cmwub3BlbkxpbmtzSW5OZXdXaW5kb3cgIT09IHRydWVcIj5cXG4gICAgICAgIDxhXFxuICAgICAgICAgIHRpdGxlPVwie3tcXCdNb3JlIGluZm9ybWF0aW9uXFwnfHRyYW5zbGF0ZX19XCJcXG4gICAgICAgICAgaHJlZj1cIlwiIG5nLWNsaWNrPVwiZ21mTGF5ZXJ0cmVlQ3RybC5kaXNwbGF5TWV0YWRhdGEobGF5ZXJ0cmVlQ3RybClcIj5cXG4gICAgICAgIDwvYT5cXG4gICAgICA8L3NwYW4+XFxuICAgIDwvc3Bhbj5cXG4gIDwvc3Bhbj5cXG48L2Rpdj5cXG5cXG48ZGl2XFxuICBjbGFzcz1cImdtZi1sYXllcnRyZWUtbm9kZS1tZW51XCJcXG4gIGlkPVwiZ21mLWxheWVydHJlZS1ub2RlLW1lbnUte3s6OmxheWVydHJlZUN0cmwudWlkfX1cIlxcbiAgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCJcXG4gIG5nLWlmPVwiOjpnbWZMYXllcnRyZWVDdHJsLnN1cHBvcnRzQ3VzdG9taXphdGlvbihsYXllcnRyZWVDdHJsKVwiPlxcblxcbiAgPGRpdiBuZy1pZj1cIjo6Z21mTGF5ZXJ0cmVlQ3RybC5zdXBwb3J0c09wYWNpdHlDaGFuZ2UobGF5ZXJ0cmVlQ3RybClcIj5cXG4gICAgPGkgY2xhc3M9XCJmYSBmYS10aW50IGZhLWZ3XCI+PC9pPlxcbiAgICA8c3Bhbj57e1xcJ09wYWNpdHlcXCd8dHJhbnNsYXRlfX08L3NwYW4+XFxuICAgIDxpbnB1dFxcbiAgICAgICAgY2xhc3M9XCJpbnB1dC1hY3Rpb25cIlxcbiAgICAgICAgdHlwZT1cInJhbmdlXCJcXG4gICAgICAgIG1pbj1cIjBcIlxcbiAgICAgICAgbWF4PVwiMVwiXFxuICAgICAgICBzdGVwPVwiMC4wMVwiXFxuICAgICAgICBuZy1tb2RlbD1cImxheWVydHJlZUN0cmwubGF5ZXIub3BhY2l0eVwiIC8+XFxuICA8L2Rpdj5cXG5cXG4gIDxhXFxuICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1ub2RlLW1lbnUtdG9nZ2xlbGVnZW5kXCJcXG4gICAgbmctaWY9XCI6OmdtZkxheWVydHJlZUN0cmwuc3VwcG9ydHNMZWdlbmQobGF5ZXJ0cmVlQ3RybClcIlxcbiAgICBuZy1jbGljaz1cIjo6Z21mTGF5ZXJ0cmVlQ3RybC50b2dnbGVOb2RlTGVnZW5kKFxcJyNnbWYtbGF5ZXJ0cmVlLW5vZGUtXFwnICsgbGF5ZXJ0cmVlQ3RybC51aWQgKyBcXCctbGVnZW5kXFwnKVwiXFxuICAgIGhyZWY9XCJcIj5cXG4gICAgPHNwYW5cXG4gICAgICAgIGNsYXNzPVwiZmEgZmEtdGgtbGlzdFwiPlxcbiAgICA8L3NwYW4+XFxuICAgIHt7XFwnU2hvdy9oaWRlIGxlZ2VuZFxcJ3x0cmFuc2xhdGV9fVxcbiAgPC9hPlxcbjwvZGl2PlxcbjxkaXZcXG4gIG5nLWlmPVwiOjohbGF5ZXJ0cmVlQ3RybC5pc1Jvb3QgJiYgZ21mTGF5ZXJ0cmVlQ3RybC5nZXRMZWdlbmRzT2JqZWN0KGxheWVydHJlZUN0cmwpICYmIGxheWVydHJlZUN0cmwubm9kZS5tZXRhZGF0YS5sZWdlbmRcIiBpZD1cImdtZi1sYXllcnRyZWUtbm9kZS17ezo6bGF5ZXJ0cmVlQ3RybC51aWR9fS1sZWdlbmRcIlxcbiAgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLWxlZ2VuZFwiXFxuICBuZy1jbGFzcz1cIltnbWZMYXllcnRyZWVDdHJsLmdldE5vZGVTdGF0ZShsYXllcnRyZWVDdHJsKSwgbGF5ZXJ0cmVlQ3RybC5ub2RlLm1ldGFkYXRhLmlzTGVnZW5kRXhwYW5kZWQgPyBcXCdzaG93XFwnIDogXFwnXFwnXVwiPlxcblxcbiAgPGFcXG4gICAgdGl0bGU9XCJ7e1xcJ0hpZGUgbGVnZW5kXFwnfHRyYW5zbGF0ZX19XCJcXG4gICAgbmctY2xpY2s9XCI6OmdtZkxheWVydHJlZUN0cmwudG9nZ2xlTm9kZUxlZ2VuZChcXCcjZ21mLWxheWVydHJlZS1ub2RlLVxcJyArIGxheWVydHJlZUN0cmwudWlkICsgXFwnLWxlZ2VuZFxcJylcIlxcbiAgICBocmVmPVwiXCI+XFxuICAgIHt7XFwnSGlkZSBsZWdlbmRcXCd8dHJhbnNsYXRlfX1cXG4gIDwvYT5cXG4gIDxkaXYgbmctaWY9XCJnbWZMYXllcnRyZWVDdHJsLmlzTm9kZUxlZ2VuZFZpc2libGUoXFwnI2dtZi1sYXllcnRyZWUtbm9kZS1cXCcgKyBsYXllcnRyZWVDdHJsLnVpZCArIFxcJy1sZWdlbmRcXCcpXCI+XFxuICAgIDxkaXYgbmctcmVwZWF0PVwiKHRpdGxlLCB1cmwpIGluIGdtZkxheWVydHJlZUN0cmwuZ2V0TGVnZW5kc09iamVjdChsYXllcnRyZWVDdHJsKVwiPlxcbiAgICAgIDxwIG5nLWlmPVwiZ21mTGF5ZXJ0cmVlQ3RybC5nZXROdW1iZXJPZkxlZ2VuZHNPYmplY3QobGF5ZXJ0cmVlQ3RybCkgPiAxXCI+e3t0aXRsZXx0cmFuc2xhdGV9fTwvcD5cXG4gICAgICA8aW1nIG5nLXNyYz1cInt7dXJsfX1cIj48L2ltZz5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG48L2Rpdj5cXG5cXG48dWxcXG4gICBjbGFzcz1cImdtZi1sYXllcnRyZWUtcm9vdC1leHRlcm5hbC1kYXRhc291cmNlc1wiXFxuICAgbmctaWY9XCJsYXllcnRyZWVDdHJsLmlzUm9vdCAmJiAoZ21mTGF5ZXJ0cmVlQ3RybC5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlci53bXNHcm91cHMubGVuZ3RoIHx8IGdtZkxheWVydHJlZUN0cmwuZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXIud210c0dyb3Vwcy5sZW5ndGggfHwgZ21mTGF5ZXJ0cmVlQ3RybC5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlci5maWxlR3JvdXAuZGF0YVNvdXJjZXMubGVuZ3RoKVwiPlxcbiAgPGdtZi1kYXRhc291cmNlZ3JvdXB0cmVlXFxuICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1ub2RlIGdtZi1sYXllcnRyZWUtZGVwdGgtMVwiXFxuICAgIG5nLXJlcGVhdD1cIndtdHNHcm91cCBpbiBnbWZMYXllcnRyZWVDdHJsLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyLndtdHNHcm91cHNcIlxcbiAgICBncm91cD1cIndtdHNHcm91cFwiXFxuICA+XFxuICA8L2dtZi1kYXRhc291cmNlZ3JvdXB0cmVlPlxcbiAgPGdtZi1kYXRhc291cmNlZ3JvdXB0cmVlXFxuICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1ub2RlIGdtZi1sYXllcnRyZWUtZGVwdGgtMVwiXFxuICAgIG5nLXJlcGVhdD1cIndtc0dyb3VwIGluIGdtZkxheWVydHJlZUN0cmwuZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXIud21zR3JvdXBzXCJcXG4gICAgZ3JvdXA9XCJ3bXNHcm91cFwiXFxuICA+XFxuICA8L2dtZi1kYXRhc291cmNlZ3JvdXB0cmVlPlxcbiAgPGdtZi1kYXRhc291cmNlZ3JvdXB0cmVlXFxuICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1ub2RlIGdtZi1sYXllcnRyZWUtZGVwdGgtMVwiXFxuICAgIG5nLWlmPVwiZ21mTGF5ZXJ0cmVlQ3RybC5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlci5maWxlR3JvdXAuZGF0YVNvdXJjZXMubGVuZ3RoXCJcXG4gICAgZ3JvdXA9XCJnbWZMYXllcnRyZWVDdHJsLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyLmZpbGVHcm91cFwiXFxuICA+XFxuICA8L2dtZi1kYXRhc291cmNlZ3JvdXB0cmVlPlxcbjwvdWw+XFxuXFxuPHVsXFxuICBpZD1cImdtZi1sYXllcnRyZWUtbGF5ZXItZ3JvdXAte3s6OmxheWVydHJlZUN0cmwudWlkfX1cIlxcbiAgbmctaWY9XCI6OmxheWVydHJlZUN0cmwubm9kZS5jaGlsZHJlblwiXFxuICBuZy1jbGFzcz1cIntjb2xsYXBzZTogIWxheWVydHJlZUN0cmwuaXNSb290LCBzaG93OiBsYXllcnRyZWVDdHJsLm5vZGUubWV0YWRhdGEuaXNFeHBhbmRlZH1cIlxcbiAgbmdlby1zb3J0YWJsZT1cIjo6bGF5ZXJ0cmVlQ3RybC5pc1Jvb3QgJiYgbGF5ZXJ0cmVlQ3RybC5ub2RlLmNoaWxkcmVuXCJcXG4gIG5nZW8tc29ydGFibGUtb3B0aW9ucz1cIntoYW5kbGVDbGFzc05hbWU6IFxcJ25nZW8tc29ydGFibGUtaGFuZGxlXFwnLCBkcmFnZ2VyQ2xhc3NOYW1lOiBcXCdnbWYtbGF5ZXJ0cmVlLWRyYWdnZXJcXCcsIHBsYWNlaG9sZGVyQ2xhc3NOYW1lIDogXFwnZ21mLWxheWVydHJlZS1jdXJyLWRyYWctaXRlbVxcJ31cIlxcbiAgbmdlby1zb3J0YWJsZS1jYWxsYmFjaz1cIjo6Z21mTGF5ZXJ0cmVlQ3RybC5hZnRlclJlb3JkZXJcIlxcbiAgbmdlby1zb3J0YWJsZS1jYWxsYmFjay1jdHg9XCI6OmdtZkxheWVydHJlZUN0cmxcIj5cXG5cXG4gIDxsaVxcbiAgICBjbGFzcz1cImdtZi1sYXllcnRyZWUtbm9kZVwiXFxuICAgIG5nLXJlcGVhdD1cIm5vZGUgaW4gbGF5ZXJ0cmVlQ3RybC5ub2RlLmNoaWxkcmVuXCJcXG4gICAgbmctY2xhc3M9XCJcXCdnbWYtbGF5ZXJ0cmVlLWRlcHRoLVxcJyArIGxheWVydHJlZUN0cmwuZGVwdGhcIlxcbiAgICBuZ2VvLWxheWVydHJlZT1cIm5vZGVcIlxcbiAgICBuZ2VvLWxheWVydHJlZS1ub3Ryb290XFxuICAgIG5nZW8tbGF5ZXJ0cmVlLW1hcD1cImxheWVydHJlZUN0cmwubWFwXCJcXG4gICAgbmdlby1sYXllcnRyZWUtbm9kZWxheWVyZXhwcj1cImxheWVydHJlZUN0cmwubm9kZWxheWVyRXhwclwiXFxuICAgIG5nZW8tbGF5ZXJ0cmVlLWxpc3RlbmVyc2V4cHI9XCJsYXllcnRyZWVDdHJsLmxpc3RlbmVyc0V4cHJcIj5cXG4gIDwvbGk+XFxuPC91bD5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkc2NvcGVcIiwgXCJuZ2VvTGF5ZXJIZWxwZXJcIiwgXCJnbWZMYXllckJlaW5nU3dpcGVcIiwgXCJnbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZFwiLCBcImdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXCIsIFwiZ21mUGVybWFsaW5rXCIsIFwiZ21mVHJlZU1hbmFnZXJcIiwgXCJnbWZTeW5jTGF5ZXJ0cmVlTWFwXCIsIFwibmdlb1dNU1RpbWVcIiwgXCJnbWZUaGVtZXNcIiwgXCIkdGltZW91dFwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgREFUQUxBWUVSR1JPVVBfTkFNRSB9IGZyb20gJ2dtZi9pbmRleC5qcyc7XG5pbXBvcnQgZ21mRGF0YXNvdXJjZURhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkIGZyb20gJ2dtZi9kYXRhc291cmNlL0RhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkLmpzJztcbmltcG9ydCBnbWZMYXllckJlaW5nU3dpcGUgZnJvbSAnZ21mL2RhdGFzb3VyY2UvTGF5ZXJCZWluZ1N3aXBlLmpzJztcbmltcG9ydCBnbWZEYXRhc291cmNlRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXIgZnJvbSAnZ21mL2RhdGFzb3VyY2UvRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXIuanMnO1xuaW1wb3J0IGdtZlBlcm1hbGlua1Blcm1hbGluayBmcm9tICdnbWYvcGVybWFsaW5rL1Blcm1hbGluay5qcyc7XG5pbXBvcnQgZ21mTGF5ZXJ0cmVlRGF0YXNvdXJjZUdyb3VwVHJlZUNvbXBvbmVudCBmcm9tICdnbWYvbGF5ZXJ0cmVlL2RhdGFzb3VyY2VHcm91cFRyZWVDb21wb25lbnQuanMnO1xuaW1wb3J0IGdtZkxheWVydHJlZVN5bmNMYXllcnRyZWVNYXAgZnJvbSAnZ21mL2xheWVydHJlZS9TeW5jTGF5ZXJ0cmVlTWFwLmpzJztcbmltcG9ydCBnbWZMYXllcnRyZWVUcmVlTWFuYWdlciBmcm9tICdnbWYvbGF5ZXJ0cmVlL1RyZWVNYW5hZ2VyLmpzJztcbmltcG9ydCBnbWZUaGVtZVRoZW1lcywgeyBnZXROb2RlTWluUmVzb2x1dGlvbiwgZ2V0Tm9kZU1heFJlc29sdXRpb24sIGdldFNuYXBwaW5nQ29uZmlnIH0gZnJvbSAnZ21mL3RoZW1lL1RoZW1lcy5qcyc7XG5pbXBvcnQgbmdlb0RhdGFzb3VyY2VPR0MsIHsgU2VydmVyVHlwZSB9IGZyb20gJ25nZW8vZGF0YXNvdXJjZS9PR0MuanMnO1xuaW1wb3J0IG5nZW9MYXllcnRyZWVDb21wb25lbnQgZnJvbSAnbmdlby9sYXllcnRyZWUvY29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvTGF5ZXJ0cmVlQ29udHJvbGxlciwgeyBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24gfSBmcm9tICduZ2VvL2xheWVydHJlZS9Db250cm9sbGVyLmpzJztcbmltcG9ydCBuZ2VvTWFwTGF5ZXJIZWxwZXIgZnJvbSAnbmdlby9tYXAvTGF5ZXJIZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9NaXNjU3luY0FycmF5cyBmcm9tICduZ2VvL21pc2Mvc3luY0FycmF5cy5qcyc7XG5pbXBvcnQgbmdlb01pc2NXTVNUaW1lIGZyb20gJ25nZW8vbWlzYy9XTVNUaW1lLmpzJztcbmltcG9ydCBvbExheWVyVGlsZSBmcm9tICdvbC9sYXllci9UaWxlLmpzJztcbmltcG9ydCBvbExheWVyTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvTGF5ZXIuanMnO1xuaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ29sL29iai5qcyc7XG5pbXBvcnQgb2xTb3VyY2VJbWFnZVdNUyBmcm9tICdvbC9zb3VyY2UvSW1hZ2VXTVMuanMnO1xuaW1wb3J0IG9sU291cmNlVGlsZVdNUyBmcm9tICdvbC9zb3VyY2UvVGlsZVdNUy5qcyc7XG5pbXBvcnQgb2xTb3VyY2VXTVRTIGZyb20gJ29sL3NvdXJjZS9XTVRTLmpzJztcbmltcG9ydCBMYXllckJhc2UgZnJvbSAnb2wvbGF5ZXIvQmFzZS5qcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvY29sbGFwc2UuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZMYXllcnRyZWVDb21wb25lbnQnLCBbZ21mRGF0YXNvdXJjZURhdGFTb3VyY2VCZWluZ0ZpbHRlcmVkLm5hbWUsIGdtZkRhdGFzb3VyY2VFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlci5uYW1lLCBnbWZQZXJtYWxpbmtQZXJtYWxpbmsubmFtZSwgZ21mTGF5ZXJ0cmVlRGF0YXNvdXJjZUdyb3VwVHJlZUNvbXBvbmVudC5uYW1lLCBnbWZMYXllcnRyZWVTeW5jTGF5ZXJ0cmVlTWFwLm5hbWUsIGdtZkxheWVydHJlZVRyZWVNYW5hZ2VyLm5hbWUsIGdtZlRoZW1lVGhlbWVzLm5hbWUsIG5nZW9MYXllcnRyZWVDb21wb25lbnQubmFtZSwgbmdlb0xheWVydHJlZUNvbnRyb2xsZXIubmFtZSwgbmdlb01hcExheWVySGVscGVyLm5hbWUsIG5nZW9NaXNjV01TVGltZS5uYW1lLCBnbWZMYXllckJlaW5nU3dpcGUubmFtZV0pO1xubW9kdWxlLnZhbHVlKCduZ2VvTGF5ZXJ0cmVlVGVtcGxhdGVVcmwnLCBmdW5jdGlvbiAoZWxlbWVudCwgYXR0cnMpIHtcbiAgcmV0dXJuICdnbWYvbGF5ZXJ0cmVlJztcbn0pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdnbWYvbGF5ZXJ0cmVlJywgcmVxdWlyZSgnLi9jb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcbm1vZHVsZS52YWx1ZSgnZ21mTGF5ZXJ0cmVlVGVtcGxhdGUnLCBmdW5jdGlvbiAoJGVsZW1lbnQsICRhdHRycykge1xuICB2YXIgc3ViVGVtcGxhdGVVcmwgPSAnZ21mL2xheWVydHJlZSc7XG4gIHJldHVybiAnPGRpdiBuZ2VvLWxheWVydHJlZT1cImdtZkxheWVydHJlZUN0cmwucm9vdFwiICcgKyAnbmdlby1sYXllcnRyZWUtbWFwPVwiZ21mTGF5ZXJ0cmVlQ3RybC5tYXBcIiAnICsgJ25nZW8tbGF5ZXJ0cmVlLW5vZGVsYXllcj1cImdtZkxheWVydHJlZUN0cmwuZ2V0TGF5ZXIodHJlZUN0cmwpXCIgJyArICduZ2VvLWxheWVydHJlZS1saXN0ZW5lcnM9XCJnbWZMYXllcnRyZWVDdHJsLmxpc3RlbmVycyh0cmVlU2NvcGUsIHRyZWVDdHJsKVwiICcgKyAoXCJuZ2VvLWxheWVydHJlZS10ZW1wbGF0ZXVybD1cXFwiXCIgKyBzdWJUZW1wbGF0ZVVybCArIFwiXFxcIj5cIikgKyAnPC9kaXY+Jztcbn0pO1xuZ21mTGF5ZXJ0cmVlVGVtcGxhdGUuJGluamVjdCA9IFtcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCIsIFwiZ21mTGF5ZXJ0cmVlVGVtcGxhdGVcIl07XG5cbmZ1bmN0aW9uIGdtZkxheWVydHJlZVRlbXBsYXRlKCRlbGVtZW50LCAkYXR0cnMsIGdtZkxheWVydHJlZVRlbXBsYXRlKSB7XG4gIHJldHVybiBnbWZMYXllcnRyZWVUZW1wbGF0ZSgkZWxlbWVudCwgJGF0dHJzKTtcbn1cblxudmFyIGxheWVydHJlZUNvbXBvbmVudCA9IHtcbiAgY29udHJvbGxlcjogJ0dtZkxheWVydHJlZUNvbnRyb2xsZXIgYXMgZ21mTGF5ZXJ0cmVlQ3RybCcsXG4gIGJpbmRpbmdzOiB7XG4gICAgJ21hcCc6ICc9Z21mTGF5ZXJ0cmVlTWFwJyxcbiAgICAnZGltZW5zaW9ucyc6ICc9P2dtZkxheWVydHJlZURpbWVuc2lvbnMnLFxuICAgICdvcGVuTGlua3NJbk5ld1dpbmRvdyc6ICc8P2dtZkxheWVydHJlZU9wZW5saW5rc2lubmV3d2luZG93J1xuICB9LFxuICB0ZW1wbGF0ZTogZ21mTGF5ZXJ0cmVlVGVtcGxhdGVcbn07XG5tb2R1bGUuY29tcG9uZW50KCdnbWZMYXllcnRyZWUnLCBsYXllcnRyZWVDb21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKCRlbGVtZW50LCAkc2NvcGUsIG5nZW9MYXllckhlbHBlciwgZ21mTGF5ZXJCZWluZ1N3aXBlLCBnbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZCwgZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXIsIGdtZlBlcm1hbGluaywgZ21mVHJlZU1hbmFnZXIsIGdtZlN5bmNMYXllcnRyZWVNYXAsIG5nZW9XTVNUaW1lLCBnbWZUaGVtZXMsICR0aW1lb3V0KSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgdGhpcy5tYXA7XG4gIHRoaXMuZGltZW5zaW9ucyA9IG51bGw7XG4gIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICB0aGlzLmxheWVySGVscGVyXyA9IG5nZW9MYXllckhlbHBlcjtcbiAgdGhpcy5nbWZMYXllckJlaW5nU3dpcGUgPSBnbWZMYXllckJlaW5nU3dpcGU7XG4gIHRoaXMuZ21mRGF0YVNvdXJjZUJlaW5nRmlsdGVyZWQgPSBnbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZDtcbiAgdGhpcy5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlciA9IGdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyO1xuICB0aGlzLmdtZlBlcm1hbGlua18gPSBnbWZQZXJtYWxpbms7XG4gIHRoaXMuZ21mVHJlZU1hbmFnZXJfID0gZ21mVHJlZU1hbmFnZXI7XG4gIHZhciByb290ID0gZ21mVHJlZU1hbmFnZXIucm9vdDtcblxuICBpZiAoIXJvb3QpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgcm9vdCcpO1xuICB9XG5cbiAgdGhpcy5yb290ID0gcm9vdDtcbiAgdGhpcy5nbWZTeW5jTGF5ZXJ0cmVlTWFwXyA9IGdtZlN5bmNMYXllcnRyZWVNYXA7XG4gIHRoaXMubmdlb1dNU1RpbWVfID0gbmdlb1dNU1RpbWU7XG4gIHRoaXMuZ3JvdXBOb2RlU3RhdGVzXyA9IHt9O1xuICB0aGlzLm9wZW5MaW5rc0luTmV3V2luZG93ID0gbnVsbDtcbiAgdGhpcy5kYXRhTGF5ZXJHcm91cF8gPSBudWxsO1xuICB0aGlzLmxheWVycyA9IFtdO1xuICB0aGlzLmdtZlRoZW1lc18gPSBnbWZUaGVtZXM7XG4gIHRoaXMuJHRpbWVvdXRfID0gJHRpbWVvdXQ7XG4gICRlbGVtZW50Lm9uKCdzaG93bi5icy5jb2xsYXBzZScsIGZ1bmN0aW9uICgpIHtcbiAgICBfdGhpcy5zY29wZV8uJGFwcGx5KCk7XG4gIH0pO1xufVxuXG5Db250cm9sbGVyLnByb3RvdHlwZS4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMyID0gdGhpcztcblxuICB0aGlzLm9wZW5MaW5rc0luTmV3V2luZG93ID0gdGhpcy5vcGVuTGlua3NJbk5ld1dpbmRvdyA9PT0gdHJ1ZTtcbiAgdGhpcy5kYXRhTGF5ZXJHcm91cF8gPSB0aGlzLmxheWVySGVscGVyXy5nZXRHcm91cEZyb21NYXAodGhpcy5tYXAsIERBVEFMQVlFUkdST1VQX05BTUUpO1xuICBuZ2VvTWlzY1N5bmNBcnJheXModGhpcy5kYXRhTGF5ZXJHcm91cF8uZ2V0TGF5ZXJzKCkuZ2V0QXJyYXkoKSwgdGhpcy5sYXllcnMsIHRydWUsIHRoaXMuc2NvcGVfLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pO1xuICB0aGlzLnNjb3BlXy4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMyLmxheWVycztcbiAgfSwgZnVuY3Rpb24gKCkge1xuICAgIF90aGlzMi5tYXAucmVuZGVyKCk7XG5cbiAgICBpZiAoX3RoaXMyLmdtZkxheWVyQmVpbmdTd2lwZS5sYXllciAmJiAhX3RoaXMyLmxheWVycy5pbmNsdWRlcyhfdGhpczIuZ21mTGF5ZXJCZWluZ1N3aXBlLmxheWVyKSkge1xuICAgICAgX3RoaXMyLmdtZkxheWVyQmVpbmdTd2lwZS5sYXllciA9IG51bGw7XG4gICAgfVxuICB9KTtcbiAgdGhpcy5zY29wZV8uJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgaWYgKF90aGlzMi5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwpIHtcbiAgICAgIHJldHVybiBfdGhpczIuZGltZW5zaW9ucztcbiAgICB9XG4gIH0sIGZ1bmN0aW9uIChkaW1lbnNpb25zKSB7XG4gICAgaWYgKGRpbWVuc2lvbnMpIHtcbiAgICAgIGlmICghX3RoaXMyLmdtZlRyZWVNYW5hZ2VyXy5yb290Q3RybCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsJyk7XG4gICAgICB9XG5cbiAgICAgIF90aGlzMi51cGRhdGVEaW1lbnNpb25zXyhfdGhpczIuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsKTtcbiAgICB9XG4gIH0pO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUudXBkYXRlRGltZW5zaW9uc18gPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgdHJlZUN0cmwudHJhdmVyc2VEZXB0aEZpcnN0KGZ1bmN0aW9uIChjdHJsKSB7XG4gICAgaWYgKGN0cmwubm9kZS5kaW1lbnNpb25zKSB7XG4gICAgICB2YXIgbGF5ZXIgPSBjdHJsLmxheWVyO1xuXG4gICAgICBpZiAoIShsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJMYXllcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBmZWF0dXJlIHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgX3RoaXMzLnVwZGF0ZUxheWVyRGltZW5zaW9uc18obGF5ZXIsIGN0cmwubm9kZSk7XG5cbiAgICAgIHJldHVybiBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24uREVTQ0VORDtcbiAgICB9XG4gIH0pO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUudXBkYXRlTGF5ZXJEaW1lbnNpb25zXyA9IGZ1bmN0aW9uIChsYXllciwgbm9kZSkge1xuICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICBpZiAodGhpcy5kaW1lbnNpb25zICYmIG5vZGUuZGltZW5zaW9ucykge1xuICAgIHZhciBkaW1lbnNpb25zID0ge307XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gbm9kZS5kaW1lbnNpb25zKSB7XG4gICAgICBpZiAobm9kZS5kaW1lbnNpb25zW2tleV0gPT09IG51bGwpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5kaW1lbnNpb25zW2tleV07XG5cbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBkaW1lbnNpb25zW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGltZW5zaW9uc1trZXldID0gbm9kZS5kaW1lbnNpb25zW2tleV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFpc0VtcHR5KGRpbWVuc2lvbnMpKSB7XG4gICAgICB2YXIgc291cmNlID0gbGF5ZXIuZ2V0U291cmNlKCk7XG5cbiAgICAgIGlmIChzb3VyY2UgaW5zdGFuY2VvZiBvbFNvdXJjZVdNVFMpIHtcbiAgICAgICAgc291cmNlLnVwZGF0ZURpbWVuc2lvbnMoZGltZW5zaW9ucyk7XG4gICAgICB9IGVsc2UgaWYgKHNvdXJjZSBpbnN0YW5jZW9mIG9sU291cmNlVGlsZVdNUyB8fCBzb3VyY2UgaW5zdGFuY2VvZiBvbFNvdXJjZUltYWdlV01TKSB7XG4gICAgICAgIHNvdXJjZS51cGRhdGVQYXJhbXMoZGltZW5zaW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsYXllci5vbmNlKCdjaGFuZ2U6c291cmNlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICghKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckxheWVyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBmZWF0dXJlIHR5cGUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdGhpczQudXBkYXRlTGF5ZXJEaW1lbnNpb25zXyhsYXllciwgbm9kZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0TGF5ZXIgPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgaWYgKCF0aGlzLmRhdGFMYXllckdyb3VwXykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkYXRhTGF5ZXJHcm91cCcpO1xuICB9XG5cbiAgdmFyIG9wdF9wb3NpdGlvbjtcblxuICBpZiAodHJlZUN0cmwucGFyZW50LmlzUm9vdCkge1xuICAgIHRoaXMuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsID0gdHJlZUN0cmwucGFyZW50O1xuICAgIG9wdF9wb3NpdGlvbiA9IHRoaXMuZ21mVHJlZU1hbmFnZXJfLnJvb3QuY2hpbGRyZW4ubGVuZ3RoIC0gdGhpcy5nbWZUcmVlTWFuYWdlcl8ubnVtYmVyT2ZHcm91cHNUb0FkZEluVGhpc0RpZ2VzdExvb3AgfHwgMDtcbiAgfVxuXG4gIHZhciBsYXllciA9IHRoaXMuZ21mU3luY0xheWVydHJlZU1hcF8uY3JlYXRlTGF5ZXIodHJlZUN0cmwsIHRoaXMubWFwLCB0aGlzLmRhdGFMYXllckdyb3VwXywgb3B0X3Bvc2l0aW9uKTtcblxuICBpZiAobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyTGF5ZXIpIHtcbiAgICB2YXIgbm9kZSA9IHRyZWVDdHJsLm5vZGU7XG4gICAgdGhpcy51cGRhdGVMYXllckRpbWVuc2lvbnNfKGxheWVyLCBub2RlKTtcbiAgfVxuXG4gIHJldHVybiBsYXllcjtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChzY29wZSwgdHJlZUN0cmwpIHtcbiAgaWYgKCF0aGlzLmRhdGFMYXllckdyb3VwXykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkYXRhTGF5ZXJHcm91cCcpO1xuICB9XG5cbiAgdmFyIGRhdGFMYXllckdyb3VwID0gdGhpcy5kYXRhTGF5ZXJHcm91cF87XG4gIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRyZWVDdHJsLmxheWVyKSB7XG4gICAgICBkYXRhTGF5ZXJHcm91cC5nZXRMYXllcnMoKS5yZW1vdmUodHJlZUN0cmwubGF5ZXIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS50b2dnbGVBY3RpdmUgPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIHN0YXRlID0gdHJlZUN0cmwuZ2V0U3RhdGUoKTtcblxuICBpZiAodHJlZUN0cmwubm9kZS5tZXRhZGF0YSAmJiB0cmVlQ3RybC5ub2RlLm1ldGFkYXRhLmV4Y2x1c2l2ZUdyb3VwKSB7XG4gICAgdHJlZUN0cmwuc2V0U3RhdGUoc3RhdGUgPT09ICdvZmYnID8gJ29uJyA6ICdvZmYnKTtcbiAgfSBlbHNlIHtcbiAgICB0cmVlQ3RybC5zZXRTdGF0ZShzdGF0ZSA9PT0gJ29uJyA/ICdvZmYnIDogJ29uJyk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldE5vZGVTdGF0ZSA9IGZ1bmN0aW9uICh0cmVlQ3RybCkge1xuICByZXR1cm4gdHJlZUN0cmwuZ2V0U3RhdGUoKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnVwZGF0ZVdNU1RpbWVMYXllclN0YXRlID0gZnVuY3Rpb24gKGxheWVydHJlZUN0cmwsIHRpbWUpIHtcbiAgaWYgKCF0aW1lKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGRhdGFTb3VyY2UgPSBsYXllcnRyZWVDdHJsLmdldERhdGFTb3VyY2UoKTtcblxuICBpZiAoZGF0YVNvdXJjZSkge1xuICAgIGlmICghKGRhdGFTb3VyY2UgaW5zdGFuY2VvZiBuZ2VvRGF0YXNvdXJjZU9HQykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZGF0YVNvdXJjZSB0eXBlJyk7XG4gICAgfVxuXG4gICAgZGF0YVNvdXJjZS50aW1lUmFuZ2VWYWx1ZSA9IHRpbWU7XG4gIH0gZWxzZSBpZiAobGF5ZXJ0cmVlQ3RybC5jaGlsZHJlbikge1xuICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGxheWVydHJlZUN0cmwuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgdGhpcy51cGRhdGVXTVNUaW1lTGF5ZXJTdGF0ZShsYXllcnRyZWVDdHJsLmNoaWxkcmVuW2ldLCB0aW1lKTtcbiAgICB9XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldExlZ2VuZEljb25VUkwgPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIGljb25VcmwgPSB0cmVlQ3RybC5ub2RlLm1ldGFkYXRhLmljb25Vcmw7XG5cbiAgaWYgKGljb25VcmwgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBpY29uVXJsO1xuICB9XG5cbiAgdmFyIGdtZkdyb3VwID0gdHJlZUN0cmwubm9kZTtcblxuICBpZiAoZ21mR3JvdXAuY2hpbGRyZW4gIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgZ21mTGF5ZXIgPSB0cmVlQ3RybC5ub2RlO1xuXG4gIGlmIChnbWZMYXllci50eXBlICE9PSAnV01TJykge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgZ21mTGF5ZXJXTVMgPSBnbWZMYXllcjtcbiAgdmFyIGxlZ2VuZFJ1bGUgPSBnbWZMYXllcldNUy5tZXRhZGF0YS5sZWdlbmRSdWxlO1xuXG4gIGlmIChsZWdlbmRSdWxlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgdmFyIGxheWVyTmFtZSA9IGdtZkxheWVyV01TLmxheWVycy5zcGxpdCgnLCcpWzBdO1xuICB2YXIgZ21mT2djU2VydmVyID0gdGhpcy5nbWZUcmVlTWFuYWdlcl8uZ2V0T2djU2VydmVyKHRyZWVDdHJsKTtcbiAgcmV0dXJuIHRoaXMubGF5ZXJIZWxwZXJfLmdldFdNU0xlZ2VuZFVSTChnbWZPZ2NTZXJ2ZXIudXJsLCBsYXllck5hbWUsIHVuZGVmaW5lZCwgbGVnZW5kUnVsZSwgMjAsIDIwKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldExlZ2VuZHNPYmplY3QgPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgdmFyIGxlZ2VuZHNPYmplY3QgPSB7fTtcblxuICBpZiAodHJlZUN0cmwubm9kZS5jaGlsZHJlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB2YXIgZ21mTGF5ZXIgPSB0cmVlQ3RybC5ub2RlO1xuICB2YXIgZ21mTGF5ZXJEZWZhdWx0TmFtZSA9IGdtZkxheWVyLm5hbWU7XG5cbiAgaWYgKGdtZkxheWVyLm1ldGFkYXRhLmxlZ2VuZEltYWdlKSB7XG4gICAgbGVnZW5kc09iamVjdFtnbWZMYXllckRlZmF1bHROYW1lXSA9IGdtZkxheWVyLm1ldGFkYXRhLmxlZ2VuZEltYWdlO1xuICAgIHJldHVybiBsZWdlbmRzT2JqZWN0O1xuICB9XG5cbiAgdmFyIGxheWVyID0gdHJlZUN0cmwubGF5ZXI7XG5cbiAgaWYgKGdtZkxheWVyLnR5cGUgPT09ICdXTVRTJykge1xuICAgIGlmICghKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllclRpbGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGxheWVyJyk7XG4gICAgfVxuXG4gICAgdmFyIHdtdHNMZWdlbmRVUkwgPSB0aGlzLmxheWVySGVscGVyXy5nZXRXTVRTTGVnZW5kVVJMKGxheWVyKTtcblxuICAgIGlmICh3bXRzTGVnZW5kVVJMICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGxlZ2VuZHNPYmplY3RbZ21mTGF5ZXJEZWZhdWx0TmFtZV0gPSB3bXRzTGVnZW5kVVJMO1xuICAgIH1cblxuICAgIHJldHVybiB3bXRzTGVnZW5kVVJMID8gbGVnZW5kc09iamVjdCA6IG51bGw7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGdtZkxheWVyV01TID0gZ21mTGF5ZXI7XG4gICAgdmFyIGxheWVyc05hbWVzID0gZ21mTGF5ZXJXTVMubGF5ZXJzO1xuICAgIHZhciBnbWZPZ2NTZXJ2ZXIgPSB0aGlzLmdtZlRyZWVNYW5hZ2VyXy5nZXRPZ2NTZXJ2ZXIodHJlZUN0cmwpO1xuICAgIHZhciBzY2FsZSA9IHRoaXMuZ2V0U2NhbGVfKCk7XG5cbiAgICBpZiAoZ21mT2djU2VydmVyLnR5cGUgIT09IFNlcnZlclR5cGUuUUdJU1NFUlZFUikge1xuICAgICAgdmFyIGxheWVyTmFtZXNMaXN0ID0gbGF5ZXJzTmFtZXMuc3BsaXQoJywnKTtcbiAgICAgIGxheWVyTmFtZXNMaXN0LmZvckVhY2goZnVuY3Rpb24gKGxheWVyTmFtZSkge1xuICAgICAgICB2YXIgd210c0xlZ2VuZFVSTCA9IF90aGlzNS5sYXllckhlbHBlcl8uZ2V0V01TTGVnZW5kVVJMKGdtZk9nY1NlcnZlci51cmwsIGxheWVyTmFtZSwgc2NhbGUpO1xuXG4gICAgICAgIGlmICghd210c0xlZ2VuZFVSTCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB3bXRzTGVnZW5kVVJMJyk7XG4gICAgICAgIH1cblxuICAgICAgICBsZWdlbmRzT2JqZWN0W2xheWVyTmFtZV0gPSB3bXRzTGVnZW5kVVJMO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGxlZ2VuZHNPYmplY3Q7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldE51bWJlck9mTGVnZW5kc09iamVjdCA9IGZ1bmN0aW9uICh0cmVlQ3RybCkge1xuICB2YXIgbGVnZW5kc09iamVjdCA9IHRoaXMuZ2V0TGVnZW5kc09iamVjdCh0cmVlQ3RybCk7XG4gIHJldHVybiBsZWdlbmRzT2JqZWN0ID8gT2JqZWN0LmtleXMobGVnZW5kc09iamVjdCkubGVuZ3RoIDogMDtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldFNjYWxlXyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHZpZXcgPSB0aGlzLm1hcC5nZXRWaWV3KCk7XG4gIHZhciByZXNvbHV0aW9uID0gdmlldy5nZXRSZXNvbHV0aW9uKCk7XG5cbiAgaWYgKHJlc29sdXRpb24gPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyByZXNvbHV0aW9uJyk7XG4gIH1cblxuICB2YXIgbXB1ID0gdmlldy5nZXRQcm9qZWN0aW9uKCkuZ2V0TWV0ZXJzUGVyVW5pdCgpO1xuXG4gIGlmICghbXB1KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1wdScpO1xuICB9XG5cbiAgdmFyIGRwaSA9IDI1LjQgLyAwLjI4O1xuICByZXR1cm4gcmVzb2x1dGlvbiAqIG1wdSAqIDM5LjM3ICogZHBpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuaXNTbmFwcGluZ0FjdGl2YXRlZCA9IGZ1bmN0aW9uICh0cmVlQ3RybCkge1xuICBpZiAodHJlZUN0cmwucHJvcGVydGllcy5zbmFwcGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiB0cmVlQ3RybC5wcm9wZXJ0aWVzLnNuYXBwaW5nICE9PSAnYm9vbGVhbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3Jvbmcgc25hcHBpbmdBY3RpdmUgdHlwZScpO1xuICAgIH1cblxuICAgIHJldHVybiB0cmVlQ3RybC5wcm9wZXJ0aWVzLnNuYXBwaW5nO1xuICB9XG5cbiAgdmFyIG5vZGUgPSB0cmVlQ3RybC5ub2RlO1xuICB2YXIgY29uZmlnID0gZ2V0U25hcHBpbmdDb25maWcobm9kZSk7XG4gIHJldHVybiBjb25maWcgIT09IG51bGwgJiYgY29uZmlnLmFjdGl2YXRlZDtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnRvZ2dsZVNuYXBwaW5nID0gZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gIHRyZWVDdHJsLnByb3BlcnRpZXMuc25hcHBpbmcgPSAhdGhpcy5pc1NuYXBwaW5nQWN0aXZhdGVkKHRyZWVDdHJsKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmRpc3BsYXlNZXRhZGF0YSA9IGZ1bmN0aW9uICh0cmVlQ3RybCkge1xuICB2YXIgbm9kZSA9IHRyZWVDdHJsLm5vZGU7XG4gIHZhciBtZXRhZGF0YVVSTCA9IG5vZGUubWV0YWRhdGEubWV0YWRhdGFVcmw7XG5cbiAgaWYgKG1ldGFkYXRhVVJMICE9PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgZ21meCA9IHdpbmRvdy5nbWZ4O1xuXG4gICAgaWYgKGdtZngub3BlbklmcmFtZVBvcHVwKSB7XG4gICAgICBnbWZ4Lm9wZW5JZnJhbWVQb3B1cChtZXRhZGF0YVVSTCwgbm9kZS5uYW1lLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZmFsc2UpO1xuICAgIH1cbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuYWZ0ZXJSZW9yZGVyID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICBpZiAoIXRoaXMuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdtZlRyZWVNYW5hZ2VyXy5yb290Q3RybCcpO1xuICB9XG5cbiAgdmFyIGdtZlJvb3RHcm91cCA9IHRoaXMuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsLm5vZGU7XG4gIHZhciBncm91cE5vZGVzID0gZ21mUm9vdEdyb3VwLmNoaWxkcmVuO1xuICB2YXIgY3VycmVudFRyZWVDdHJscyA9IHRoaXMuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsLmNoaWxkcmVuO1xuICB2YXIgdHJlZUN0cmxzID0gW107XG4gIGdyb3VwTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgIGN1cnJlbnRUcmVlQ3RybHMuc29tZShmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgICAgIGlmICh0cmVlQ3RybC5ub2RlID09PSBub2RlKSB7XG4gICAgICAgIHRyZWVDdHJscy5wdXNoKHRyZWVDdHJsKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gIH0pO1xuICB0aGlzLmdtZlRyZWVNYW5hZ2VyXy5yb290Q3RybC5jaGlsZHJlbiA9IHRyZWVDdHJscztcbiAgdGhpcy5sYXllcnMubGVuZ3RoID0gMDtcbiAgdGhpcy5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICBpZiAoIShjaGlsZC5sYXllciBpbnN0YW5jZW9mIExheWVyQmFzZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgY2hpbGQubGF5ZXInKTtcbiAgICB9XG5cbiAgICBfdGhpczYubGF5ZXJzLnB1c2goY2hpbGQubGF5ZXIpO1xuICB9KTtcbiAgdGhpcy5nbWZQZXJtYWxpbmtfLnJlZnJlc2hGaXJzdExldmVsR3JvdXBzKCk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5yZW1vdmVOb2RlID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgdGhpcy5nbWZUcmVlTWFuYWdlcl8ucmVtb3ZlR3JvdXAobm9kZSk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5yZW1vdmVBbGxOb2RlcyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5nbWZUcmVlTWFuYWdlcl8ucmVtb3ZlQWxsKCk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5ub2Rlc0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5nbWZUcmVlTWFuYWdlcl8ucm9vdC5jaGlsZHJlbi5sZW5ndGg7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5nZXRSZXNvbHV0aW9uU3R5bGUgPSBmdW5jdGlvbiAoZ21mTGF5ZXIpIHtcbiAgdmFyIHJlc29sdXRpb24gPSB0aGlzLm1hcC5nZXRWaWV3KCkuZ2V0UmVzb2x1dGlvbigpO1xuXG4gIGlmIChyZXNvbHV0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVzb2x1dGlvbicpO1xuICB9XG5cbiAgdmFyIG1pblJlc29sdXRpb24gPSBnZXROb2RlTWluUmVzb2x1dGlvbihnbWZMYXllcik7XG5cbiAgaWYgKG1pblJlc29sdXRpb24gIT09IHVuZGVmaW5lZCAmJiByZXNvbHV0aW9uIDwgbWluUmVzb2x1dGlvbikge1xuICAgIHJldHVybiAnb3V0LW9mLXJlc29sdXRpb24nO1xuICB9XG5cbiAgdmFyIG1heFJlc29sdXRpb24gPSBnZXROb2RlTWF4UmVzb2x1dGlvbihnbWZMYXllcik7XG5cbiAgaWYgKG1heFJlc29sdXRpb24gIT09IHVuZGVmaW5lZCAmJiByZXNvbHV0aW9uID4gbWF4UmVzb2x1dGlvbikge1xuICAgIHJldHVybiAnb3V0LW9mLXJlc29sdXRpb24nO1xuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnpvb21Ub1Jlc29sdXRpb24gPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIGdtZkxheWVyID0gdHJlZUN0cmwubm9kZTtcbiAgdmFyIHZpZXcgPSB0aGlzLm1hcC5nZXRWaWV3KCk7XG4gIHZhciByZXNvbHV0aW9uID0gdmlldy5nZXRSZXNvbHV0aW9uKCk7XG5cbiAgaWYgKHJlc29sdXRpb24gPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyByZXNvbHV0aW9uJyk7XG4gIH1cblxuICB2YXIgbWluUmVzb2x1dGlvbiA9IGdldE5vZGVNaW5SZXNvbHV0aW9uKGdtZkxheWVyKTtcbiAgdmFyIGNvbnN0cmFpblJlc29sdXRpb24gPSB2aWV3LmdldENvbnN0cmFpbnRzKCkucmVzb2x1dGlvbjtcbiAgdmFyIHNpemUgPSB0aGlzLm1hcC5nZXRTaXplKCk7XG5cbiAgaWYgKHNpemUgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBzaXplJyk7XG4gIH1cblxuICBpZiAobWluUmVzb2x1dGlvbiAhPT0gdW5kZWZpbmVkICYmIHJlc29sdXRpb24gPCBtaW5SZXNvbHV0aW9uKSB7XG4gICAgdmlldy5zZXRSZXNvbHV0aW9uKGNvbnN0cmFpblJlc29sdXRpb24obWluUmVzb2x1dGlvbiwgMSwgc2l6ZSkpO1xuICB9IGVsc2Uge1xuICAgIHZhciBtYXhSZXNvbHV0aW9uID0gZ2V0Tm9kZU1heFJlc29sdXRpb24oZ21mTGF5ZXIpO1xuXG4gICAgaWYgKG1heFJlc29sdXRpb24gIT09IHVuZGVmaW5lZCAmJiByZXNvbHV0aW9uID4gbWF4UmVzb2x1dGlvbikge1xuICAgICAgdmlldy5zZXRSZXNvbHV0aW9uKGNvbnN0cmFpblJlc29sdXRpb24obWF4UmVzb2x1dGlvbiwgLTEsIHNpemUpKTtcbiAgICB9XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnRvZ2dsZVN3aXBlTGF5ZXIgPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgaWYgKCF0cmVlQ3RybC5sYXllcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ05vIGxheWVyJyk7XG4gIH0gZWxzZSBpZiAodGhpcy5nbWZMYXllckJlaW5nU3dpcGUubGF5ZXIgPT09IHRyZWVDdHJsLmxheWVyKSB7XG4gICAgdGhpcy5nbWZMYXllckJlaW5nU3dpcGUubGF5ZXIgPSBudWxsO1xuICAgIHRoaXMubWFwLnJlbmRlcigpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuZ21mTGF5ZXJCZWluZ1N3aXBlLmxheWVyID0gbnVsbDtcbiAgICB0aGlzLiR0aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpczcuZ21mTGF5ZXJCZWluZ1N3aXBlLmxheWVyID0gdHJlZUN0cmwubGF5ZXI7XG5cbiAgICAgIF90aGlzNy5tYXAucmVuZGVyKCk7XG4gICAgfSwgMCk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnRvZ2dsZU5vZGVMZWdlbmQgPSBmdW5jdGlvbiAobGVnZW5kTm9kZUlkKSB7XG4gIHZhciBkaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGxlZ2VuZE5vZGVJZCk7XG5cbiAgaWYgKGRpdikge1xuICAgIGRpdi5jbGFzc0xpc3QudG9nZ2xlKCdzaG93Jyk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnRvZ2dsZUZpbHRyYWJsZURhdGFTb3VyY2UgPSBmdW5jdGlvbiAoZHMpIHtcbiAgdGhpcy5nbWZEYXRhU291cmNlQmVpbmdGaWx0ZXJlZC5kYXRhU291cmNlID0gZHM7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5pc05vZGVMZWdlbmRWaXNpYmxlID0gZnVuY3Rpb24gKGxlZ2VuZE5vZGVJZCkge1xuICByZXR1cm4gJChsZWdlbmROb2RlSWQpLmlzKCc6dmlzaWJsZScpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc3VwcG9ydHNDdXN0b21pemF0aW9uID0gZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gIHJldHVybiAhdHJlZUN0cmwuaXNSb290ICYmICh0aGlzLnN1cHBvcnRzTGVnZW5kKHRyZWVDdHJsKSB8fCB0aGlzLnN1cHBvcnRzT3BhY2l0eUNoYW5nZSh0cmVlQ3RybCkpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc3VwcG9ydHNMZWdlbmQgPSBmdW5jdGlvbiAodHJlZUN0cmwpIHtcbiAgdmFyIG5vZGUgPSB0cmVlQ3RybC5ub2RlO1xuICByZXR1cm4gISFub2RlLm1ldGFkYXRhICYmICEhbm9kZS5tZXRhZGF0YS5sZWdlbmQgJiYgISF0aGlzLmdldExlZ2VuZHNPYmplY3QodHJlZUN0cmwpO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc3VwcG9ydHNPcGFjaXR5Q2hhbmdlID0gZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gIHZhciBub2RlID0gdHJlZUN0cmwubm9kZTtcbiAgdmFyIHBhcmVudE5vZGUgPSB0cmVlQ3RybC5wYXJlbnQubm9kZTtcbiAgcmV0dXJuICEhdHJlZUN0cmwubGF5ZXIgJiYgKHRyZWVDdHJsLmRlcHRoID09PSAxICYmICFub2RlLm1peGVkIHx8IHRyZWVDdHJsLmRlcHRoID4gMSAmJiBwYXJlbnROb2RlLm1peGVkKTtcbn07XG5cbm1vZHVsZS5jb250cm9sbGVyKCdHbWZMYXllcnRyZWVDb250cm9sbGVyJywgQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdlxcbiAgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLWdyb3VwIGdtZi1sYXllcnRyZWUtZGVwdGgtMSB7eyRjdHJsLmdyb3VwLnZpc2liaWxpdHlTdGF0ZX19XCJcXG4+XFxuICA8YVxcbiAgICBkYXRhLXRvZ2dsZT1cImNvbGxhcHNlXCJcXG4gICAgaHJlZj1cIiNnbWYtbGF5ZXJ0cmVlLWxheWVyLWdyb3VwLXt7OjokY3RybC5nZXRHcm91cFVpZCgpfX1cIlxcbiAgICBhcmlhLWV4cGFuZGVkPVwidHJ1ZVwiXFxuICAgIGNsYXNzPVwiZmEgZ21mLWxheWVydHJlZS1leHBhbmQtbm9kZSBmYS1md1wiPlxcbiAgPC9hPlxcblxcbiAgPGFcXG4gICAgY2xhc3M9XCJmYSBmYS1mdyBnbWYtbGF5ZXJ0cmVlLXN0YXRlXCJcXG4gICAgaHJlZlxcbiAgICBuZy1jbGljaz1cIiRjdHJsLnRvZ2dsZSgpXCJcXG4gID4nICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9sYXllcnMuc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nPC9hPlxcblxcbiAgPGFcXG4gICAgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLW5hbWVcIlxcbiAgICBocmVmXFxuICAgIG5nLWNsaWNrPVwiJGN0cmwudG9nZ2xlKClcIlxcbiAgPlxcbiAgICA8c3Bhbj57eyRjdHJsLmdyb3VwLnRpdGxlIHwgdHJhbnNsYXRlfX08L3NwYW4+XFxuICA8L2E+XFxuXFxuICA8c3BhbiBjbGFzcz1cImdtZi1sYXllcnRyZWUtcmlnaHQtYnV0dG9uc1wiPlxcbiAgICA8YVxcbiAgICAgIGhyZWY9XCJcIlxcbiAgICAgIG5nLWNsaWNrPVwiJGN0cmwucmVtb3ZlKClcIj5cXG4gICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLXRyYXNoXCI+PC9zcGFuPlxcbiAgICA8L2E+XFxuICA8L3NwYW4+XFxuPC9kaXY+XFxuXFxuPHVsXFxuICBpZD1cImdtZi1sYXllcnRyZWUtbGF5ZXItZ3JvdXAte3s6OiRjdHJsLmdldEdyb3VwVWlkKCl9fVwiXFxuICBjbGFzcz1cImNvbGxhcHNlIGluXCJcXG4+XFxuICA8bGlcXG4gICAgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLW5vZGUgZ21mLWxheWVydHJlZS1kZXB0aC0yXCJcXG4gICAgbmctY2xhc3M9XCJbZGF0YVNvdXJjZS52aXNpYmxlID8gXFwnb25cXCcgOiBcXCdvZmZcXCddXCJcXG4gICAgbmctcmVwZWF0PVwiZGF0YVNvdXJjZSBpbiAkY3RybC5ncm91cC5kYXRhU291cmNlc1wiXFxuICA+XFxuICAgIDxkaXYgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLWxlYWZcIj5cXG4gICAgICA8YVxcbiAgICAgICAgaHJlZlxcbiAgICAgICAgbmctY2xpY2s9XCIkY3RybC50b2dnbGVEYXRhU291cmNlKGRhdGFTb3VyY2UpXCJcXG4gICAgICAgIGNsYXNzPVwiZ21mLWxheWVydHJlZS1sYXllci1pY29uIGdtZi1sYXllcnRyZWUtbm8tbGF5ZXItaWNvblwiXFxuICAgICAgPlxcbiAgICAgIDwvYT5cXG4gICAgICA8YVxcbiAgICAgICAgY2xhc3M9XCJnbWYtbGF5ZXJ0cmVlLW5hbWVcIlxcbiAgICAgICAgaHJlZlxcbiAgICAgICAgbmctY2xpY2s9XCIkY3RybC50b2dnbGVEYXRhU291cmNlKGRhdGFTb3VyY2UpXCJcXG4gICAgICA+XFxuICAgICAgICA8c3Bhbj57e2RhdGFTb3VyY2UubmFtZSB8IHRyYW5zbGF0ZX19PC9zcGFuPlxcbiAgICAgIDwvYT5cXG5cXG4gICAgICA8c3BhbiBjbGFzcz1cImdtZi1sYXllcnRyZWUtcmlnaHQtYnV0dG9uc1wiPlxcbiAgICAgICAgPGFcXG4gICAgICAgICAgaHJlZj1cIlwiXFxuICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwucmVtb3ZlRGF0YVNvdXJjZShkYXRhU291cmNlKVwiPlxcbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLXRyYXNoXCI+PC9zcGFuPlxcbiAgICAgICAgPC9hPlxcbiAgICAgIDwvc3Bhbj5cXG4gICAgPC9kaXY+XFxuICA8L2xpPlxcbjwvdWw+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlRGF0YVNvdXJjZXMgZnJvbSAnbmdlby9kYXRhc291cmNlL0RhdGFTb3VyY2VzLmpzJztcbmltcG9ydCB7IGdldFVpZCBhcyBvbFV0aWxHZXRVaWQgfSBmcm9tICdvbC91dGlsLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mTGF5ZXJ0cmVlRGF0YXNvdXJjZUdyb3VwVHJlZUNvbXBvbmVudCcsIFtuZ2VvRGF0YXNvdXJjZURhdGFTb3VyY2VzLm5hbWVdKTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZ21mL2xheWVydHJlZS9kYXRhc291cmNlR3JvdXBUcmVlQ29tcG9uZW50JywgcmVxdWlyZSgnLi9kYXRhc291cmNlR3JvdXBUcmVlQ29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5tb2R1bGUudmFsdWUoJ2dtZkxheWVydHJlZURhdGFzb3VyY2VHcm91cFRyZWVUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uICgkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzWydnbWZMYXllcnRyZWVEYXRhc291cmNlR3JvdXBUcmVlVGVtcGxhdGVVcmwnXTtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICdnbWYvbGF5ZXJ0cmVlL2RhdGFzb3VyY2VHcm91cFRyZWVDb21wb25lbnQnO1xufSk7XG5nbWZMYXllcnRyZWVEYXRhc291cmNlR3JvdXBUcmVlVGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRhdHRyc1wiLCBcImdtZkxheWVydHJlZURhdGFzb3VyY2VHcm91cFRyZWVUZW1wbGF0ZVVybFwiXTtcblxuZnVuY3Rpb24gZ21mTGF5ZXJ0cmVlRGF0YXNvdXJjZUdyb3VwVHJlZVRlbXBsYXRlVXJsKCRhdHRycywgZ21mTGF5ZXJ0cmVlRGF0YXNvdXJjZUdyb3VwVHJlZVRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBnbWZMYXllcnRyZWVEYXRhc291cmNlR3JvdXBUcmVlVGVtcGxhdGVVcmwoJGF0dHJzKTtcbn1cblxudmFyIENvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIENvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIm5nZW9EYXRhU291cmNlc1wiXTtcblxuICBmdW5jdGlvbiBDb250cm9sbGVyKCRzY29wZSwgbmdlb0RhdGFTb3VyY2VzKSB7XG4gICAgdGhpcy5ncm91cCA9IG51bGw7XG4gICAgdGhpcy5zY29wZV8gPSAkc2NvcGU7XG4gICAgdGhpcy5kYXRhU291cmNlc18gPSBuZ2VvRGF0YVNvdXJjZXMuY29sbGVjdGlvbjtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZ2V0R3JvdXBVaWQgPSBmdW5jdGlvbiBnZXRHcm91cFVpZCgpIHtcbiAgICByZXR1cm4gXCJkYXRhc291cmNlZ3JvdXB0cmVlLVwiICsgb2xVdGlsR2V0VWlkKHRoaXMuZ3JvdXApO1xuICB9O1xuXG4gIF9wcm90by50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7XG4gICAgaWYgKCF0aGlzLmdyb3VwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ3JvdXAnKTtcbiAgICB9XG5cbiAgICB0aGlzLmdyb3VwLnRvZ2dsZVZpc2liaWxpdHlTdGF0ZSgpO1xuICB9O1xuXG4gIF9wcm90by50b2dnbGVEYXRhU291cmNlID0gZnVuY3Rpb24gdG9nZ2xlRGF0YVNvdXJjZShkYXRhU291cmNlKSB7XG4gICAgZGF0YVNvdXJjZS52aXNpYmxlID0gIWRhdGFTb3VyY2UudmlzaWJsZTtcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgIGlmICghdGhpcy5ncm91cCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdyb3VwJyk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IHRoaXMuZ3JvdXAuZGF0YVNvdXJjZXMubGVuZ3RoIC0gMSwgaWkgPSAwOyBpID49IGlpOyBpLS0pIHtcbiAgICAgIHRoaXMuZGF0YVNvdXJjZXNfLnJlbW92ZSh0aGlzLmdyb3VwLmRhdGFTb3VyY2VzW2ldKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZURhdGFTb3VyY2UgPSBmdW5jdGlvbiByZW1vdmVEYXRhU291cmNlKGRhdGFTb3VyY2UpIHtcbiAgICB0aGlzLmRhdGFTb3VyY2VzXy5yZW1vdmUoZGF0YVNvdXJjZSk7XG4gIH07XG5cbiAgcmV0dXJuIENvbnRyb2xsZXI7XG59KCk7XG5cbm1vZHVsZS5jb21wb25lbnQoJ2dtZkRhdGFzb3VyY2Vncm91cHRyZWUnLCB7XG4gIGJpbmRpbmdzOiB7XG4gICAgJ2dyb3VwJzogJzwnXG4gIH0sXG4gIGNvbnRyb2xsZXI6IENvbnRyb2xsZXIsXG4gIHRlbXBsYXRlVXJsOiBnbWZMYXllcnRyZWVEYXRhc291cmNlR3JvdXBUcmVlVGVtcGxhdGVVcmxcbn0pO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IGdtZkxheWVydHJlZUNvbXBvbmVudCBmcm9tICdnbWYvbGF5ZXJ0cmVlL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mTGF5ZXJ0cmVlRGF0YXNvdXJjZUdyb3VwVHJlZUNvbXBvbmVudCBmcm9tICdnbWYvbGF5ZXJ0cmVlL2RhdGFzb3VyY2VHcm91cFRyZWVDb21wb25lbnQuanMnO1xuaW1wb3J0IGdtZkxheWVydHJlZVN5bmNMYXllcnRyZWVNYXAgZnJvbSAnZ21mL2xheWVydHJlZS9TeW5jTGF5ZXJ0cmVlTWFwLmpzJztcbmltcG9ydCBnbWZMYXllcnRyZWVUaW1lU2xpZGVyQ29tcG9uZW50IGZyb20gJ2dtZi9sYXllcnRyZWUvdGltZVNsaWRlckNvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mTGF5ZXJ0cmVlVHJlZU1hbmFnZXIgZnJvbSAnZ21mL2xheWVydHJlZS9UcmVlTWFuYWdlci5qcyc7XG5pbXBvcnQgJy4vY29tbW9uLnNjc3MnO1xuZXhwb3J0IGRlZmF1bHQgYW5ndWxhci5tb2R1bGUoJ2dtZkxheWVydHJlZU1vZHVsZScsIFtnbWZMYXllcnRyZWVDb21wb25lbnQubmFtZSwgZ21mTGF5ZXJ0cmVlRGF0YXNvdXJjZUdyb3VwVHJlZUNvbXBvbmVudC5uYW1lLCBnbWZMYXllcnRyZWVTeW5jTGF5ZXJ0cmVlTWFwLm5hbWUsIGdtZkxheWVydHJlZVRpbWVTbGlkZXJDb21wb25lbnQubmFtZSwgZ21mTGF5ZXJ0cmVlVHJlZU1hbmFnZXIubmFtZV0pOyIsIkNvbnRyb2xsZXIuJGluamVjdCA9IFtcIm5nZW9XTVNUaW1lXCIsIFwibmdlb0RlYm91bmNlXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb01pc2NXTVNUaW1lIGZyb20gJ25nZW8vbWlzYy9XTVNUaW1lLmpzJztcbmltcG9ydCBuZ2VvTWlzY0RlYm91bmNlIGZyb20gJ25nZW8vbWlzYy9kZWJvdW5jZS5qcyc7XG5pbXBvcnQgJ2pxdWVyeS11aS91aS93aWRnZXRzL3NsaWRlci5qcyc7XG5pbXBvcnQgJ25nZW8vc2Fzcy9qcXVlcnktdWkuc2Nzcyc7XG5pbXBvcnQgJ2FuZ3VsYXItdWktc2xpZGVyJztcbmltcG9ydCAnLi90aW1lc2xpZGVyLnNjc3MnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZMYXllcnRyZWVUaW1lU2xpZGVyQ29tcG9uZW50JywgW25nZW9NaXNjV01TVGltZS5uYW1lLCBuZ2VvTWlzY0RlYm91bmNlLm5hbWUsICd1aS5zbGlkZXInXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi9sYXllcnRyZWUvdGltZXNsaWRlckNvbXBvbmVudCcsIHJlcXVpcmUoJy4vdGltZXNsaWRlckNvbXBvbmVudC5odG1sJykpO1xufV0pO1xuXG5mdW5jdGlvbiBsYXllcnRyZWVUaW1lU2xpZGVyQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7XG4gICAgICBvbkRhdGVTZWxlY3RlZDogJyZnbWZUaW1lU2xpZGVyT25EYXRlU2VsZWN0ZWQnLFxuICAgICAgdGltZTogJz1nbWZUaW1lU2xpZGVyVGltZSdcbiAgICB9LFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgY29udHJvbGxlcjogJ2dtZlRpbWVTbGlkZXJDb250cm9sbGVyIGFzIHNsaWRlckN0cmwnLFxuICAgIHJlc3RyaWN0OiAnQUUnLFxuICAgIHRlbXBsYXRlVXJsOiAnZ21mL2xheWVydHJlZS90aW1lc2xpZGVyQ29tcG9uZW50JyxcbiAgICBsaW5rOiB7XG4gICAgICBwcmU6IGZ1bmN0aW9uIHByZUxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJsKSB7XG4gICAgICAgIGlmICghY3RybCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjdHJsJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjdHJsLmluaXQoKTtcbiAgICAgICAgY3RybC5zbGlkZXJPcHRpb25zLnN0b3AgPSBvblNsaWRlclJlbGVhc2VkXztcbiAgICAgICAgY3RybC5zbGlkZXJPcHRpb25zLnNsaWRlID0gY3RybC5uZ2VvRGVib3VuY2VfKG9uU2xpZGVyUmVsZWFzZWRfLCAzMDAsIHRydWUpO1xuXG4gICAgICAgIGZ1bmN0aW9uIG9uU2xpZGVyUmVsZWFzZWRfKGUsIHNsaWRlclVpKSB7XG4gICAgICAgICAgaWYgKCFjdHJsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY3RybCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGN0cmwub25EYXRlU2VsZWN0ZWQoe1xuICAgICAgICAgICAgdGltZTogY29tcHV0ZURhdGVzXyhlLCBzbGlkZXJVaSlcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVEYXRlc18oZSwgc2xpZGVyVWkpIHtcbiAgICAgICAgICBpZiAoIWN0cmwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjdHJsJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHNEYXRlLCBlRGF0ZSwgd21zdGltZTtcblxuICAgICAgICAgIGlmIChzbGlkZXJVaS52YWx1ZXMpIHtcbiAgICAgICAgICAgIHNEYXRlID0gbmV3IERhdGUoY3RybC5nZXRDbG9zZXN0VmFsdWVfKHNsaWRlclVpLnZhbHVlc1swXSkpO1xuICAgICAgICAgICAgZURhdGUgPSBuZXcgRGF0ZShjdHJsLmdldENsb3Nlc3RWYWx1ZV8oc2xpZGVyVWkudmFsdWVzWzFdKSk7XG4gICAgICAgICAgICBjdHJsLmRhdGVzID0gW3NEYXRlLCBlRGF0ZV07XG4gICAgICAgICAgICB3bXN0aW1lID0ge1xuICAgICAgICAgICAgICBzdGFydDogc0RhdGUuZ2V0VGltZSgpLFxuICAgICAgICAgICAgICBlbmQ6IGVEYXRlLmdldFRpbWUoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc0RhdGUgPSBuZXcgRGF0ZShjdHJsLmdldENsb3Nlc3RWYWx1ZV8oc2xpZGVyVWkudmFsdWUpKTtcbiAgICAgICAgICAgIGN0cmwuZGF0ZXMgPSBzRGF0ZTtcbiAgICAgICAgICAgIHdtc3RpbWUgPSB7XG4gICAgICAgICAgICAgIHN0YXJ0OiBzRGF0ZS5nZXRUaW1lKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgcmV0dXJuIHdtc3RpbWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ2dtZlRpbWVTbGlkZXInLCBsYXllcnRyZWVUaW1lU2xpZGVyQ29tcG9uZW50KTtcblxuZnVuY3Rpb24gQ29udHJvbGxlcihuZ2VvV01TVGltZSwgbmdlb0RlYm91bmNlKSB7XG4gIHRoaXMubmdlb1dNU1RpbWVfID0gbmdlb1dNU1RpbWU7XG4gIHRoaXMubmdlb0RlYm91bmNlXyA9IG5nZW9EZWJvdW5jZTtcblxuICB0aGlzLm9uRGF0ZVNlbGVjdGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH07XG5cbiAgdGhpcy50aW1lID0gbnVsbDtcbiAgdGhpcy5pc01vZGVSYW5nZSA9IGZhbHNlO1xuICB0aGlzLm1pblZhbHVlID0gLTE7XG4gIHRoaXMubWF4VmFsdWUgPSA5OTk5OTk7XG4gIHRoaXMudGltZVZhbHVlTGlzdCA9IG51bGw7XG4gIHRoaXMuc2xpZGVyT3B0aW9ucyA9IG51bGw7XG4gIHRoaXMuZGF0ZXMgPSBbXTtcbn1cblxuQ29udHJvbGxlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLnRpbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdGltZScpO1xuICB9XG5cbiAgdmFyIGluaXRpYWxPcHRpb25zXyA9IHRoaXMubmdlb1dNU1RpbWVfLmdldE9wdGlvbnModGhpcy50aW1lKTtcbiAgdGhpcy5pc01vZGVSYW5nZSA9IHRoaXMudGltZS5tb2RlID09PSAncmFuZ2UnO1xuICB0aGlzLm1pblZhbHVlID0gaW5pdGlhbE9wdGlvbnNfLm1pbkRhdGU7XG4gIHRoaXMubWF4VmFsdWUgPSBpbml0aWFsT3B0aW9uc18ubWF4RGF0ZTtcbiAgdmFyIHZhbHVlcyA9IGluaXRpYWxPcHRpb25zXy52YWx1ZXM7XG5cbiAgaWYgKHRoaXMuaXNNb2RlUmFuZ2UpIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBPcHRpb25zIHZhbHVlcycpO1xuICAgIH1cblxuICAgIHRoaXMuZGF0ZXMgPSBbdmFsdWVzWzBdLCB2YWx1ZXNbMV1dO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuZGF0ZXMgPSBpbml0aWFsT3B0aW9uc18udmFsdWVzO1xuICB9XG5cbiAgdGhpcy50aW1lVmFsdWVMaXN0ID0gdGhpcy5nZXRUaW1lVmFsdWVMaXN0XygpO1xuICB0aGlzLnNsaWRlck9wdGlvbnMgPSB7XG4gICAgcmFuZ2U6IHRoaXMuaXNNb2RlUmFuZ2UsXG4gICAgbWluOiB0aGlzLm1pblZhbHVlLFxuICAgIG1heDogdGhpcy5tYXhWYWx1ZVxuICB9O1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0VGltZVZhbHVlTGlzdF8gPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy50aW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHRpbWUnKTtcbiAgfVxuXG4gIHZhciB3bXNUaW1lID0gdGhpcy50aW1lO1xuICB2YXIgdGltZVZhbHVlTGlzdCA9IFtdO1xuICB2YXIgbWluRGF0ZSA9IG5ldyBEYXRlKHRoaXMubWluVmFsdWUpO1xuICB2YXIgbWF4RGF0ZSA9IG5ldyBEYXRlKHRoaXMubWF4VmFsdWUpO1xuXG4gIGlmICh3bXNUaW1lLnZhbHVlcykge1xuICAgIHRpbWVWYWx1ZUxpc3QgPSBbXTtcbiAgICB3bXNUaW1lLnZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgICB0aW1lVmFsdWVMaXN0LnB1c2gobmV3IERhdGUoZGF0ZSkuZ2V0VGltZSgpKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgbWF4TmJWYWx1ZXMgPSAxMDI0O1xuICAgIHZhciBlbmREYXRlID0gbmV3IERhdGUobWluRGF0ZS5nZXRUaW1lKCkpO1xuICAgIGVuZERhdGUuc2V0RnVsbFllYXIobWluRGF0ZS5nZXRGdWxsWWVhcigpICsgbWF4TmJWYWx1ZXMgKiB3bXNUaW1lLmludGVydmFsWzBdKTtcbiAgICBlbmREYXRlLnNldE1vbnRoKG1pbkRhdGUuZ2V0TW9udGgoKSArIG1heE5iVmFsdWVzICogd21zVGltZS5pbnRlcnZhbFsxXSwgbWluRGF0ZS5nZXREYXRlKCkgKyBtYXhOYlZhbHVlcyAqIHdtc1RpbWUuaW50ZXJ2YWxbMl0pO1xuICAgIGVuZERhdGUuc2V0U2Vjb25kcyhtaW5EYXRlLmdldFNlY29uZHMoKSArIG1heE5iVmFsdWVzICogd21zVGltZS5pbnRlcnZhbFszXSk7XG5cbiAgICBpZiAoZW5kRGF0ZSA+IG1heERhdGUpIHtcbiAgICAgIHRpbWVWYWx1ZUxpc3QgPSBbXTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7OyBpKyspIHtcbiAgICAgICAgdmFyIG5leHREYXRlID0gbmV3IERhdGUobWluRGF0ZS5nZXRUaW1lKCkpO1xuICAgICAgICBuZXh0RGF0ZS5zZXRGdWxsWWVhcihtaW5EYXRlLmdldEZ1bGxZZWFyKCkgKyBpICogd21zVGltZS5pbnRlcnZhbFswXSk7XG4gICAgICAgIG5leHREYXRlLnNldE1vbnRoKG1pbkRhdGUuZ2V0TW9udGgoKSArIGkgKiB3bXNUaW1lLmludGVydmFsWzFdLCBtaW5EYXRlLmdldERhdGUoKSArIGkgKiB3bXNUaW1lLmludGVydmFsWzJdKTtcbiAgICAgICAgbmV4dERhdGUuc2V0U2Vjb25kcyhtaW5EYXRlLmdldFNlY29uZHMoKSArIGkgKiB3bXNUaW1lLmludGVydmFsWzNdKTtcblxuICAgICAgICBpZiAobmV4dERhdGUgPD0gbWF4RGF0ZSkge1xuICAgICAgICAgIHRpbWVWYWx1ZUxpc3QucHVzaChuZXh0RGF0ZS5nZXRUaW1lKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRpbWVWYWx1ZUxpc3Q7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5nZXRDbG9zZXN0VmFsdWVfID0gZnVuY3Rpb24gKHRpbWVzdGFtcCkge1xuICBpZiAoIXRoaXMudGltZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB0aW1lJyk7XG4gIH1cblxuICBpZiAodGltZXN0YW1wIDw9IHRoaXMubWluVmFsdWUpIHtcbiAgICByZXR1cm4gdGhpcy5taW5WYWx1ZTtcbiAgfVxuXG4gIGlmICh0aW1lc3RhbXAgPj0gdGhpcy5tYXhWYWx1ZSkge1xuICAgIHJldHVybiB0aGlzLm1heFZhbHVlO1xuICB9XG5cbiAgaWYgKHRoaXMudGltZVZhbHVlTGlzdCkge1xuICAgIHZhciBpbmRleDtcbiAgICB2YXIgbGVmdEluZGV4ID0gMDtcbiAgICB2YXIgcmlnaHRJbmRleCA9IHRoaXMudGltZVZhbHVlTGlzdC5sZW5ndGggLSAxO1xuXG4gICAgd2hpbGUgKHJpZ2h0SW5kZXggLSBsZWZ0SW5kZXggPiAxKSB7XG4gICAgICBpbmRleCA9IE1hdGguZmxvb3IoKGxlZnRJbmRleCArIHJpZ2h0SW5kZXgpIC8gMik7XG5cbiAgICAgIGlmICh0aGlzLnRpbWVWYWx1ZUxpc3RbaW5kZXhdID49IHRpbWVzdGFtcCkge1xuICAgICAgICByaWdodEluZGV4ID0gaW5kZXg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZWZ0SW5kZXggPSBpbmRleDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgbGVmdERpc3RhbmNlID0gTWF0aC5hYnModGhpcy50aW1lVmFsdWVMaXN0W2xlZnRJbmRleF0gLSB0aW1lc3RhbXApO1xuICAgIHZhciByaWdodERpc3RhbmNlID0gTWF0aC5hYnModGhpcy50aW1lVmFsdWVMaXN0W3JpZ2h0SW5kZXhdIC0gdGltZXN0YW1wKTtcbiAgICByZXR1cm4gdGhpcy50aW1lVmFsdWVMaXN0W2xlZnREaXN0YW5jZSA8IHJpZ2h0RGlzdGFuY2UgPyBsZWZ0SW5kZXggOiByaWdodEluZGV4XTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgdGFyZ2V0RGF0ZSA9IG5ldyBEYXRlKHRpbWVzdGFtcCk7XG4gICAgdmFyIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHRoaXMubWluVmFsdWUpO1xuICAgIHZhciBiZXN0RGF0ZSA9IG5ldyBEYXRlKHRoaXMubWluVmFsdWUpO1xuICAgIHZhciBtYXhEYXRlID0gbmV3IERhdGUodGhpcy5tYXhWYWx1ZSk7XG4gICAgdmFyIGJlc3REaXN0YW5jZSA9IE1hdGguYWJzKHRhcmdldERhdGUuZ2V0VGltZSgpIC0gYmVzdERhdGUuZ2V0VGltZSgpKTtcblxuICAgIGZvciAodmFyIGkgPSAxOzsgaSsrKSB7XG4gICAgICB2YXIgbmV4dCA9IG5ldyBEYXRlKHN0YXJ0RGF0ZS5nZXRUaW1lKCkpO1xuICAgICAgbmV4dC5zZXRGdWxsWWVhcihzdGFydERhdGUuZ2V0RnVsbFllYXIoKSArIGkgKiB0aGlzLnRpbWUuaW50ZXJ2YWxbMF0pO1xuICAgICAgbmV4dC5zZXRNb250aChzdGFydERhdGUuZ2V0TW9udGgoKSArIGkgKiB0aGlzLnRpbWUuaW50ZXJ2YWxbMV0sIHN0YXJ0RGF0ZS5nZXREYXRlKCkgKyBpICogdGhpcy50aW1lLmludGVydmFsWzJdKTtcbiAgICAgIG5leHQuc2V0U2Vjb25kcyhzdGFydERhdGUuZ2V0U2Vjb25kcygpICsgaSAqIHRoaXMudGltZS5pbnRlcnZhbFszXSk7XG5cbiAgICAgIGlmIChuZXh0ID4gbWF4RGF0ZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgdmFyIGRpc3RhbmNlID0gTWF0aC5hYnModGFyZ2V0RGF0ZS5nZXRUaW1lKCkgLSBuZXh0LmdldFRpbWUoKSk7XG5cbiAgICAgIGlmIChkaXN0YW5jZSA8PSBiZXN0RGlzdGFuY2UpIHtcbiAgICAgICAgYmVzdERhdGUgPSBuZXh0O1xuICAgICAgICBiZXN0RGlzdGFuY2UgPSBkaXN0YW5jZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBiZXN0RGF0ZS5nZXRUaW1lKCk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldExvY2FsaXplZERhdGUgPSBmdW5jdGlvbiAodGltZSkge1xuICBpZiAoIXRoaXMudGltZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB0aW1lJyk7XG4gIH1cblxuICByZXR1cm4gdGhpcy5uZ2VvV01TVGltZV8uZm9ybWF0VGltZVZhbHVlKHRpbWUsIHRoaXMudGltZS5yZXNvbHV0aW9uKTtcbn07XG5cbm1vZHVsZS5jb250cm9sbGVyKCdnbWZUaW1lU2xpZGVyQ29udHJvbGxlcicsIENvbnRyb2xsZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXYgY2xhc3M9XCJnbWYtdGltZS1zbGlkZXJcIj5cXG5cXG4gIDxkaXZcXG4gICAgdWktc2xpZGVyPVwic2xpZGVyQ3RybC5zbGlkZXJPcHRpb25zXCJcXG4gICAgbmctbW9kZWw9XCJzbGlkZXJDdHJsLmRhdGVzXCI+XFxuICAgIDxzcGFuXFxuICAgICAgY2xhc3M9XCJ1aS1zbGlkZXItaGFuZGxlIHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbFwiXFxuICAgICAgdGFiaW5kZXg9XCIwXCJcXG4gICAgICBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIlxcbiAgICAgIHRpdGxlPVwiXCI+XFxuICAgIDwvc3Bhbj5cXG4gIDwvZGl2PlxcblxcbiAgPGRpdiBjbGFzcz1cImdtZi10aW1lLXNsaWRlci1kaXNwbGF5ZWQtZGF0ZXNcIj5cXG4gICAgPGRpdlxcbiAgICAgIGNsYXNzPVwiZ21mLXRpbWUtc2xpZGVyLXN0YXJ0LWRhdGVcIlxcbiAgICAgIG5nLWlmPVwiOjpzbGlkZXJDdHJsLnRpbWUubW9kZSA9PT0gXFwncmFuZ2VcXCdcIj5cXG4gICAgICA8c3Bhbj57e3NsaWRlckN0cmwuZ2V0TG9jYWxpemVkRGF0ZShzbGlkZXJDdHJsLmRhdGVzWzBdKX19PC9zcGFuPlxcbiAgICA8L2Rpdj5cXG5cXG4gICAgPGRpdlxcbiAgICAgIGNsYXNzPVwiZ21mLXRpbWUtc2xpZGVyLXN0YXJ0LWRhdGVcIlxcbiAgICAgIG5nLWlmPVwiOjpzbGlkZXJDdHJsLnRpbWUubW9kZSA9PT0gXFwndmFsdWVcXCdcIj5cXG4gICAgICA8c3Bhbj57e3NsaWRlckN0cmwuZ2V0TG9jYWxpemVkRGF0ZShzbGlkZXJDdHJsLmRhdGVzKX19PC9zcGFuPlxcbiAgICA8L2Rpdj5cXG5cXG4gICAgPGRpdlxcbiAgICAgIGNsYXNzPVwiZ21mLXRpbWUtc2xpZGVyLWVuZC1kYXRlXCJcXG4gICAgICBuZy1pZj1cIjo6c2xpZGVyQ3RybC50aW1lLm1vZGUgPT09IFxcJ3JhbmdlXFwnXCI+XFxuICAgICAgPHNwYW4+e3tzbGlkZXJDdHJsLmdldExvY2FsaXplZERhdGUoc2xpZGVyQ3RybC5kYXRlc1sxXSl9fTwvc3Bhbj5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG5cXG48L2Rpdj5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdlxcbiAgICBuZ2VvLW1hcD1cImN0cmwubWFwXCJcXG4gICAgbmdlby1tYXAtbWFuYWdlLXJlc2l6ZT1cImN0cmwubWFuYWdlUmVzaXplXCJcXG4gICAgbmdlby1tYXAtcmVzaXplLXRyYW5zaXRpb249XCJjdHJsLnJlc2l6ZVRyYW5zaXRpb25cIj5cXG48L2Rpdj5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wibmdlb0ZlYXR1cmVPdmVybGF5TWdyXCIsIFwiZ21mUGVybWFsaW5rXCIsIFwiZ21mU25hcHBpbmdcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZQZXJtYWxpbmtNb2R1bGUgZnJvbSAnZ21mL3Blcm1hbGluay9tb2R1bGUuanMnO1xuaW1wb3J0IGdtZkVkaXRpbmdTbmFwcGluZyBmcm9tICdnbWYvZWRpdGluZy9TbmFwcGluZy5qcyc7XG5pbXBvcnQgbmdlb01hcE1vZHVsZSBmcm9tICduZ2VvL21hcC9tb2R1bGUuanMnO1xuaW1wb3J0IG5nZW9NYXBGZWF0dXJlT3ZlcmxheU1nciBmcm9tICduZ2VvL21hcC9GZWF0dXJlT3ZlcmxheU1nci5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZk1hcENvbXBvbmVudCcsIFtnbWZQZXJtYWxpbmtNb2R1bGUubmFtZSwgZ21mRWRpdGluZ1NuYXBwaW5nLm5hbWUsIG5nZW9NYXBNb2R1bGUubmFtZSwgbmdlb01hcEZlYXR1cmVPdmVybGF5TWdyLm5hbWVdKTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZ21mL21hcCcsIHJlcXVpcmUoJy4vY29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5cbmZ1bmN0aW9uIGdtZk1hcENvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBzY29wZToge1xuICAgICAgJ21hcCc6ICc8Z21mTWFwTWFwJyxcbiAgICAgICdtYW5hZ2VSZXNpemUnOiAnPGdtZk1hcE1hbmFnZVJlc2l6ZScsXG4gICAgICAncmVzaXplVHJhbnNpdGlvbic6ICc8Z21mTWFwUmVzaXplVHJhbnNpdGlvbidcbiAgICB9LFxuICAgIGNvbnRyb2xsZXI6ICdHbWZNYXBDb250cm9sbGVyIGFzIGN0cmwnLFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgdGVtcGxhdGVVcmw6ICdnbWYvbWFwJ1xuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCdnbWZNYXAnLCBnbWZNYXBDb21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKG5nZW9GZWF0dXJlT3ZlcmxheU1nciwgZ21mUGVybWFsaW5rLCBnbWZTbmFwcGluZykge1xuICB0aGlzLm1hcCA9IG51bGw7XG4gIHRoaXMubWFuYWdlUmVzaXplID0gbnVsbDtcbiAgdGhpcy5yZXNpemVUcmFuc2l0aW9uID0gbnVsbDtcbiAgdGhpcy5uZ2VvRmVhdHVyZU92ZXJsYXlNZ3JfID0gbmdlb0ZlYXR1cmVPdmVybGF5TWdyO1xuICB0aGlzLmdtZlBlcm1hbGlua18gPSBnbWZQZXJtYWxpbms7XG4gIHRoaXMuZ21mU25hcHBpbmdfID0gZ21mU25hcHBpbmc7XG59XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5tYXApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gIH1cblxuICB0aGlzLm5nZW9GZWF0dXJlT3ZlcmxheU1ncl8uaW5pdCh0aGlzLm1hcCk7XG4gIHRoaXMuZ21mUGVybWFsaW5rXy5zZXRNYXAodGhpcy5tYXApO1xuICB0aGlzLmdtZlNuYXBwaW5nXy5zZXRNYXAodGhpcy5tYXApO1xufTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ0dtZk1hcENvbnRyb2xsZXInLCBDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZNYXBDb21wb25lbnQgZnJvbSAnZ21mL21hcC9jb21wb25lbnQuanMnO1xuaW1wb3J0IGdtZk1hcE1vdXNlcG9zaXRpb25Db21wb25lbnQgZnJvbSAnZ21mL21hcC9tb3VzZXBvc2l0aW9uQ29tcG9uZW50LmpzJztcbmV4cG9ydCBkZWZhdWx0IGFuZ3VsYXIubW9kdWxlKCdnbWZNYXBNb2R1bGUnLCBbZ21mTWFwQ29tcG9uZW50Lm5hbWUsIGdtZk1hcE1vdXNlcG9zaXRpb25Db21wb25lbnQubmFtZV0pOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXYgY2xhc3M9XCJidG4tZ3JvdXAgZHJvcHVwXCI+XFxuICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGRyb3Bkb3duLXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIiBhcmlhLWV4cGFuZGVkPVwiZmFsc2VcIj5cXG4gICAgPHNwYW4gY2xhc3M9XCJnbWYtbW91c2Vwb3NpdGlvbi1jb250cm9sLXRhcmdldFwiPjwvc3Bhbj5cXG4gIDwvYnV0dG9uPlxcbiAgPHVsIGNsYXNzPVwiZHJvcGRvd24tbWVudSBkcm9wZG93bi1tZW51LXJpZ2h0XCIgcm9sZT1cIm1lbnVcIj5cXG4gICAgPGxpIGNsYXNzPVwiZHJvcGRvd24taGVhZGVyXCIgdHJhbnNsYXRlPkNvb3JkaW5hdGUgc3lzdGVtczwvbGk+XFxuICAgIDxsaSBuZy1yZXBlYXQ9XCJwcm9qaXRlbSBpbiA6OmN0cmwucHJvamVjdGlvbnNcIj5cXG4gICAgICA8YSBocmVmIG5nLWNsaWNrPVwiY3RybC5zZXRQcm9qZWN0aW9uKHByb2ppdGVtKVwiPlxcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS1md1wiIG5nLWNsYXNzPVwie1xcJ2ZhLWNoZWNrXFwnOiBjdHJsLnByb2plY3Rpb24gPT0gcHJvaml0ZW19XCI+PC9zcGFuPlxcbiAgICAgICAge3s6OnByb2ppdGVtLmxhYmVsfX1cXG4gICAgICA8L2E+XFxuICAgIDwvbGk+XFxuICA8L3VsPlxcbjwvZGl2Plxcbic7XG5cbn1cbnJldHVybiBfX3Bcbn0iLCJDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkZWxlbWVudFwiLCBcIiRmaWx0ZXJcIiwgXCIkc2NvcGVcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9NaXNjRmlsdGVycyBmcm9tICduZ2VvL21pc2MvZmlsdGVycy5qcyc7XG5pbXBvcnQgb2xDb250cm9sTW91c2VQb3NpdGlvbiBmcm9tICdvbC9jb250cm9sL01vdXNlUG9zaXRpb24uanMnO1xuaW1wb3J0ICdib290c3RyYXAvanMvc3JjL2Ryb3Bkb3duLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mTWFwTW91c2Vwb3NpdGlvbicsIFtuZ2VvTWlzY0ZpbHRlcnMubmFtZV0pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdnbWYvbWFwL21vdXNlcG9zaXRpb25Db21wb25lbnQnLCByZXF1aXJlKCcuL21vdXNlcG9zaXRpb25Db21wb25lbnQuaHRtbCcpKTtcbn1dKTtcbm1vZHVsZS52YWx1ZSgnZ21mTWFwTW91c2Vwb3NpdGlvblRlbXBsYXRlVXJsJywgZnVuY3Rpb24gKCRhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSAkYXR0cnMuZ21mTWFwTW91c2Vwb3NpdGlvblRlbXBsYXRlVXJsO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ2dtZi9tYXAvbW91c2Vwb3NpdGlvbkNvbXBvbmVudCc7XG59KTtcbmdtZk1hcE1vdXNlcG9zaXRpb25UZW1wbGF0ZVVybC4kaW5qZWN0ID0gW1wiJGF0dHJzXCIsIFwiZ21mTWFwTW91c2Vwb3NpdGlvblRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBnbWZNYXBNb3VzZXBvc2l0aW9uVGVtcGxhdGVVcmwoJGF0dHJzLCBnbWZNYXBNb3VzZXBvc2l0aW9uVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIGdtZk1hcE1vdXNlcG9zaXRpb25UZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG52YXIgbWFwTW91c2Vwb3NpdGlvbkNvbXBvbmVudCA9IHtcbiAgY29udHJvbGxlcjogJ2dtZk1vdXNlcG9zaXRpb25Db250cm9sbGVyIGFzIGN0cmwnLFxuICBiaW5kaW5nczoge1xuICAgICdtYXAnOiAnPGdtZk1vdXNlcG9zaXRpb25NYXAnLFxuICAgICdwcm9qZWN0aW9ucyc6ICc8Z21mTW91c2Vwb3NpdGlvblByb2plY3Rpb25zJ1xuICB9LFxuICB0ZW1wbGF0ZVVybDogZ21mTWFwTW91c2Vwb3NpdGlvblRlbXBsYXRlVXJsXG59O1xubW9kdWxlLmNvbXBvbmVudCgnZ21mTW91c2Vwb3NpdGlvbicsIG1hcE1vdXNlcG9zaXRpb25Db21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKCRlbGVtZW50LCAkZmlsdGVyLCAkc2NvcGUsIGdldHRleHRDYXRhbG9nKSB7XG4gIHRoaXMubWFwID0gbnVsbDtcbiAgdGhpcy5wcm9qZWN0aW9ucyA9IFtdO1xuICB0aGlzLnByb2plY3Rpb24gPSBudWxsO1xuICB0aGlzLiRzY29wZV8gPSAkc2NvcGU7XG4gIHRoaXMuZ2V0dGV4dENhdGFsb2dfID0gZ2V0dGV4dENhdGFsb2c7XG4gIHRoaXMuJGVsZW1lbnRfID0gJGVsZW1lbnQ7XG4gIHRoaXMuJGZpbHRlcl8gPSAkZmlsdGVyO1xuICB0aGlzLmNvbnRyb2xfID0gbnVsbDtcbn1cblxuQ29udHJvbGxlci5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLiRzY29wZV8uJG9uKCdnZXR0ZXh0TGFuZ3VhZ2VDaGFuZ2VkJywgZnVuY3Rpb24gKCkge1xuICAgIF90aGlzLmluaXRPbENvbnRyb2xfKCk7XG4gIH0pO1xuICB0aGlzLmluaXRPbENvbnRyb2xfKCk7XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5pbml0T2xDb250cm9sXyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgaWYgKCF0aGlzLm1hcCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgfVxuXG4gIGlmICh0aGlzLmNvbnRyb2xfICE9PSBudWxsKSB7XG4gICAgdGhpcy5tYXAucmVtb3ZlQ29udHJvbCh0aGlzLmNvbnRyb2xfKTtcbiAgfVxuXG4gIHZhciBmb3JtYXRGbiA9IGZ1bmN0aW9uIGZvcm1hdEZuKGNvb3JkaW5hdGVzKSB7XG4gICAgaWYgKCFfdGhpczIucHJvamVjdGlvbikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHByb2plY3Rpb24nKTtcbiAgICB9XG5cbiAgICB2YXIgZmlsdGVyQW5kQXJncyA9IF90aGlzMi5wcm9qZWN0aW9uLmZpbHRlci5zcGxpdCgnOicpO1xuXG4gICAgdmFyIHNoaWZ0ZWRGaWx0ZXJBbmRBcmdzID0gZmlsdGVyQW5kQXJncy5zaGlmdCgpO1xuXG4gICAgaWYgKCFzaGlmdGVkRmlsdGVyQW5kQXJncykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNoaWZ0ZWRGaWx0ZXJBbmRBcmdzJyk7XG4gICAgfVxuXG4gICAgdmFyIGZpbHRlciA9IF90aGlzMi4kZmlsdGVyXyhzaGlmdGVkRmlsdGVyQW5kQXJncyk7XG5cbiAgICBpZiAodHlwZW9mIGZpbHRlciAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGZpbHRlciB0eXBlJyk7XG4gICAgfVxuXG4gICAgdmFyIGFyZ3MgPSBmaWx0ZXJBbmRBcmdzO1xuICAgIGFyZ3MudW5zaGlmdChjb29yZGluYXRlcyk7XG4gICAgcmV0dXJuIGZpbHRlci5hcHBseShfdGhpczIsIGFyZ3MpO1xuICB9O1xuXG4gIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICB0aGlzLmNvbnRyb2xfID0gbmV3IG9sQ29udHJvbE1vdXNlUG9zaXRpb24oe1xuICAgIGNsYXNzTmFtZTogJ2dtZi1tb3VzZXBvc2l0aW9uLWNvbnRyb2wnLFxuICAgIGNvb3JkaW5hdGVGb3JtYXQ6IGZvcm1hdEZuLFxuICAgIHRhcmdldDogdGhpcy4kZWxlbWVudF8uZmluZCgnLmdtZi1tb3VzZXBvc2l0aW9uLWNvbnRyb2wtdGFyZ2V0JykuZ2V0KDApLFxuICAgIHVuZGVmaW5lZEhUTUw6IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQ29vcmRpbmF0ZXMnKVxuICB9KTtcbiAgdGhpcy5zZXRQcm9qZWN0aW9uKHRoaXMucHJvamVjdGlvbnNbMF0pO1xuICB0aGlzLm1hcC5hZGRDb250cm9sKHRoaXMuY29udHJvbF8pO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc2V0UHJvamVjdGlvbiA9IGZ1bmN0aW9uIChwcm9qZWN0aW9uKSB7XG4gIGlmICghdGhpcy5jb250cm9sXykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjb250cm9sJyk7XG4gIH1cblxuICB0aGlzLmNvbnRyb2xfLnNldFByb2plY3Rpb24ocHJvamVjdGlvbi5jb2RlKTtcbiAgdGhpcy5wcm9qZWN0aW9uID0gcHJvamVjdGlvbjtcbn07XG5cbm1vZHVsZS5jb250cm9sbGVyKCdnbWZNb3VzZXBvc2l0aW9uQ29udHJvbGxlcicsIENvbnRyb2xsZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIlBlcm1hbGlua1NlcnZpY2UuJGluamVjdCA9IFtcIiRxXCIsIFwiJHRpbWVvdXRcIiwgXCIkcm9vdFNjb3BlXCIsIFwiJGluamVjdG9yXCIsIFwibmdlb0RlYm91bmNlXCIsIFwiZ2V0dGV4dENhdGFsb2dcIiwgXCJuZ2VvRXZlbnRIZWxwZXJcIiwgXCJuZ2VvU3RhdGVNYW5hZ2VyXCIsIFwibmdlb0xvY2F0aW9uXCIsIFwiZ21mTGF5ZXJCZWluZ1N3aXBlXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBQZXJtYWxpbmtQYXJhbSB9IGZyb20gJ2dtZi9pbmRleC5qcyc7XG5pbXBvcnQgZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlIGZyb20gJ2dtZi9hdXRoZW50aWNhdGlvbi9TZXJ2aWNlLmpzJztcbmltcG9ydCBnbWZMYXllckJlaW5nU3dpcGUgZnJvbSAnZ21mL2RhdGFzb3VyY2UvTGF5ZXJCZWluZ1N3aXBlLmpzJztcbmltcG9ydCBnbWZUaGVtZU1hbmFnZXIsIHsgVGhlbWVFdmVudFR5cGUgfSBmcm9tICdnbWYvdGhlbWUvTWFuYWdlci5qcyc7XG5pbXBvcnQgZ21mVGhlbWVUaGVtZXMsIHsgZmluZFRoZW1lQnlOYW1lLCBmaW5kR3JvdXBCeU5hbWUgfSBmcm9tICdnbWYvdGhlbWUvVGhlbWVzLmpzJztcbmltcG9ydCBuZ2VvUG9wb3ZlciBmcm9tICduZ2VvL1BvcG92ZXIuanMnO1xuaW1wb3J0IG5nZW9EcmF3RmVhdHVyZXMgZnJvbSAnbmdlby9kcmF3L2ZlYXR1cmVzLmpzJztcbmltcG9ydCBuZ2VvRGF0YXNvdXJjZUdyb3VwIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9Hcm91cC5qcyc7XG5pbXBvcnQgbmdlb0RhdGFzb3VyY2VPR0MsIHsgZ3Vlc3NTZXJ2aWNlVHlwZUJ5VXJsLCBUeXBlIH0gZnJvbSAnbmdlby9kYXRhc291cmNlL09HQy5qcyc7XG5pbXBvcnQgeyBQZXJtYWxpbmszZFBhcmFtIH0gZnJvbSAnbmdlby9vbGNzL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgbmdlb0Zvcm1hdEZlYXR1cmVIYXNoIGZyb20gJ25nZW8vZm9ybWF0L0ZlYXR1cmVIYXNoLmpzJztcbmltcG9ydCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMgZnJvbSAnbmdlby9mb3JtYXQvRmVhdHVyZVByb3BlcnRpZXMuanMnO1xuaW1wb3J0IG5nZW9NaXNjRGVib3VuY2UgZnJvbSAnbmdlby9taXNjL2RlYm91bmNlLmpzJztcbmltcG9ydCBuZ2VvTWlzY0V2ZW50SGVscGVyIGZyb20gJ25nZW8vbWlzYy9FdmVudEhlbHBlci5qcyc7XG5pbXBvcnQgbmdlb1N0YXRlbWFuYWdlck1vZHVsZSBmcm9tICduZ2VvL3N0YXRlbWFuYWdlci9tb2R1bGUuanMnO1xuaW1wb3J0IG5nZW9TdGF0ZW1hbmFnZXJTZXJ2aWNlIGZyb20gJ25nZW8vc3RhdGVtYW5hZ2VyL1NlcnZpY2UuanMnO1xuaW1wb3J0IG5nZW9MYXllcnRyZWVDb250cm9sbGVyLCB7IExheWVydHJlZVZpc2l0b3JEZWNpc2lvbiB9IGZyb20gJ25nZW8vbGF5ZXJ0cmVlL0NvbnRyb2xsZXIuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0IHsgbGlzdGVuLCB1bmxpc3RlbkJ5S2V5IH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgb2xHZW9tTXVsdGlQb2ludCBmcm9tICdvbC9nZW9tL011bHRpUG9pbnQuanMnO1xuaW1wb3J0IG9sR2VvbVBvaW50IGZyb20gJ29sL2dlb20vUG9pbnQuanMnO1xuaW1wb3J0IG9sU3R5bGVJY29uIGZyb20gJ29sL3N0eWxlL0ljb24uanMnO1xuaW1wb3J0IG9sU3R5bGVTdHlsZSBmcm9tICdvbC9zdHlsZS9TdHlsZS5qcyc7XG5pbXBvcnQgb2xMYXllckdyb3VwIGZyb20gJ29sL2xheWVyL0dyb3VwLmpzJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuZXhwb3J0IHZhciBPcGVuTGF5ZXJzTGF5ZXJQcm9wZXJ0aWVzID0ge1xuICBPUEFDSVRZOiAnb3BhY2l0eSdcbn07XG52YXIgRXh0RFNTZXBhcmF0b3IgPSB7XG4gIExJU1Q6ICcsJyxcbiAgTkFNRVM6ICc7J1xufTtcbnZhciBQYXJhbVByZWZpeCA9IHtcbiAgRElNRU5TSU9OUzogJ2RpbV8nLFxuICBUUkVFX0VOQUJMRTogJ3RyZWVfZW5hYmxlXycsXG4gIFRSRUVfR1JPVVBfTEFZRVJTOiAndHJlZV9ncm91cF9sYXllcnNfJyxcbiAgVFJFRV9HUk9VUF9PUEFDSVRZOiAndHJlZV9ncm91cF9vcGFjaXR5XycsXG4gIFRSRUVfT1BBQ0lUWTogJ3RyZWVfb3BhY2l0eV8nLFxuICBXRlM6ICd3ZnNfJ1xufTtcbmV4cG9ydCBmdW5jdGlvbiBQZXJtYWxpbmtTZXJ2aWNlKCRxLCAkdGltZW91dCwgJHJvb3RTY29wZSwgJGluamVjdG9yLCBuZ2VvRGVib3VuY2UsIGdldHRleHRDYXRhbG9nLCBuZ2VvRXZlbnRIZWxwZXIsIG5nZW9TdGF0ZU1hbmFnZXIsIG5nZW9Mb2NhdGlvbiwgZ21mTGF5ZXJCZWluZ1N3aXBlKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgdGhpcy5xXyA9ICRxO1xuICB0aGlzLnJvb3RTY29wZV8gPSAkcm9vdFNjb3BlO1xuICB0aGlzLiR0aW1lb3V0XyA9ICR0aW1lb3V0O1xuICB0aGlzLm1hcFZpZXdQcm9wZXJ0eUNoYW5nZUV2ZW50S2V5XyA9IG51bGw7XG4gIHRoaXMubmdlb0RlYm91bmNlXyA9IG5nZW9EZWJvdW5jZTtcbiAgdGhpcy5uZ2VvRXZlbnRIZWxwZXJfID0gbmdlb0V2ZW50SGVscGVyO1xuICB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfID0gbmdlb1N0YXRlTWFuYWdlcjtcbiAgdGhpcy5uZ2VvRmVhdHVyZXNfID0gJGluamVjdG9yLmhhcygnbmdlb0ZlYXR1cmVzJykgPyAkaW5qZWN0b3IuZ2V0KCduZ2VvRmVhdHVyZXMnKSA6IG51bGw7XG4gIHRoaXMubmdlb0JhY2tncm91bmRMYXllck1ncl8gPSAkaW5qZWN0b3IuaGFzKCduZ2VvQmFja2dyb3VuZExheWVyTWdyJykgPyAkaW5qZWN0b3IuZ2V0KCduZ2VvQmFja2dyb3VuZExheWVyTWdyJykgOiBudWxsO1xuICB0aGlzLmdtZkxheWVyQmVpbmdTd2lwZV8gPSBnbWZMYXllckJlaW5nU3dpcGU7XG4gIHZhciBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IgPSAkaW5qZWN0b3IuaGFzKCduZ2VvRmVhdHVyZU92ZXJsYXlNZ3InKSA/ICRpbmplY3Rvci5nZXQoJ25nZW9GZWF0dXJlT3ZlcmxheU1ncicpIDogbnVsbDtcbiAgdGhpcy5mZWF0dXJlT3ZlcmxheV8gPSBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IgPyBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IuZ2V0RmVhdHVyZU92ZXJsYXkoKSA6IG51bGw7XG4gIHRoaXMuZmVhdHVyZUhlbHBlcl8gPSAkaW5qZWN0b3IuaGFzKCduZ2VvRmVhdHVyZUhlbHBlcicpID8gJGluamVjdG9yLmdldCgnbmdlb0ZlYXR1cmVIZWxwZXInKSA6IG51bGw7XG4gIHRoaXMubmdlb1F1ZXJlbnRfID0gJGluamVjdG9yLmhhcygnbmdlb1F1ZXJlbnQnKSA/ICRpbmplY3Rvci5nZXQoJ25nZW9RdWVyZW50JykgOiBudWxsO1xuICB2YXIgZ21mUGVybWFsaW5rT3B0aW9ucyA9ICRpbmplY3Rvci5oYXMoJ2dtZlBlcm1hbGlua09wdGlvbnMnKSA/ICRpbmplY3Rvci5nZXQoJ2dtZlBlcm1hbGlua09wdGlvbnMnKSA6IHt9O1xuXG4gIGlmIChnbWZQZXJtYWxpbmtPcHRpb25zLnVzZUxvY2FsU3RvcmFnZSA9PT0gdHJ1ZSkge1xuICAgIHRoaXMubmdlb1N0YXRlTWFuYWdlcl8uc2V0VXNlTG9jYWxTdG9yYWdlKHRydWUpO1xuICB9XG5cbiAgdGhpcy5jcm9zc2hhaXJFbmFibGVkQnlEZWZhdWx0XyA9ICEhZ21mUGVybWFsaW5rT3B0aW9ucy5jcm9zc2hhaXJFbmFibGVkQnlEZWZhdWx0O1xuICB0aGlzLnBvaW50UmVjZW50ZXJab29tXyA9IGdtZlBlcm1hbGlua09wdGlvbnMucG9pbnRSZWNlbnRlclpvb207XG4gIHRoaXMuZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXJfID0gJGluamVjdG9yLmhhcygnZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXInKSA/ICRpbmplY3Rvci5nZXQoJ2dtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyJykgOiBudWxsO1xuICB0aGlzLmdtZlRoZW1lc18gPSAkaW5qZWN0b3IuaGFzKCdnbWZUaGVtZXMnKSA/ICRpbmplY3Rvci5nZXQoJ2dtZlRoZW1lcycpIDogbnVsbDtcbiAgdGhpcy5nbWZPYmplY3RFZGl0aW5nTWFuYWdlcl8gPSAkaW5qZWN0b3IuaGFzKCdnbWZPYmplY3RFZGl0aW5nTWFuYWdlcicpID8gJGluamVjdG9yLmdldCgnZ21mT2JqZWN0RWRpdGluZ01hbmFnZXInKSA6IG51bGw7XG4gIHRoaXMuZ21mVGhlbWVNYW5hZ2VyXyA9ICRpbmplY3Rvci5oYXMoJ2dtZlRoZW1lTWFuYWdlcicpID8gJGluamVjdG9yLmdldCgnZ21mVGhlbWVNYW5hZ2VyJykgOiBudWxsO1xuICB0aGlzLmRlZmF1bHRUaGVtZV8gPSAkaW5qZWN0b3IuaGFzKCdkZWZhdWx0VGhlbWUnKSA/ICRpbmplY3Rvci5nZXQoJ2RlZmF1bHRUaGVtZScpIDogdW5kZWZpbmVkO1xuICB0aGlzLmdtZlRyZWVNYW5hZ2VyXyA9ICRpbmplY3Rvci5oYXMoJ2dtZlRyZWVNYW5hZ2VyJykgPyAkaW5qZWN0b3IuZ2V0KCdnbWZUcmVlTWFuYWdlcicpIDogbnVsbDtcbiAgdGhpcy5uZ2VvTG9jYXRpb25fID0gbmdlb0xvY2F0aW9uO1xuICB0aGlzLm5nZW9XZnNQZXJtYWxpbmtfID0gJGluamVjdG9yLmhhcygnbmdlb1dmc1Blcm1hbGluaycpID8gJGluamVjdG9yLmdldCgnbmdlb1dmc1Blcm1hbGluaycpIDogbnVsbDtcbiAgdGhpcy5nbWZVc2VyXyA9ICRpbmplY3Rvci5oYXMoJ2dtZlVzZXInKSA/ICRpbmplY3Rvci5nZXQoJ2dtZlVzZXInKSA6IG51bGw7XG4gIHRoaXMubWFwXyA9IG51bGw7XG4gIHRoaXMubmdlb0F1dG9Qcm9qZWN0aW9uXyA9ICRpbmplY3Rvci5oYXMoJ25nZW9BdXRvUHJvamVjdGlvbicpID8gJGluamVjdG9yLmdldCgnbmdlb0F1dG9Qcm9qZWN0aW9uJykgOiBudWxsO1xuICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgdGhpcy5zb3VyY2VQcm9qZWN0aW9uc18gPSBudWxsO1xuXG4gIGlmIChnbWZQZXJtYWxpbmtPcHRpb25zLnByb2plY3Rpb25Db2RlcyAhPT0gdW5kZWZpbmVkICYmIHRoaXMubmdlb0F1dG9Qcm9qZWN0aW9uXykge1xuICAgIHZhciBwcm9qZWN0aW9ucyA9IHRoaXMubmdlb0F1dG9Qcm9qZWN0aW9uXy5nZXRQcm9qZWN0aW9uTGlzdChnbWZQZXJtYWxpbmtPcHRpb25zLnByb2plY3Rpb25Db2Rlcyk7XG5cbiAgICBpZiAocHJvamVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5zb3VyY2VQcm9qZWN0aW9uc18gPSBwcm9qZWN0aW9ucztcbiAgICB9XG4gIH1cblxuICB0aGlzLmNyb3NzaGFpckZlYXR1cmVfID0gbnVsbDtcbiAgdGhpcy5jcm9zc2hhaXJTdHlsZV8gPSBbXTtcblxuICBpZiAoZ21mUGVybWFsaW5rT3B0aW9ucy5jcm9zc2hhaXJTdHlsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5jcm9zc2hhaXJTdHlsZV8gPSBnbWZQZXJtYWxpbmtPcHRpb25zLmNyb3NzaGFpclN0eWxlO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuY3Jvc3NoYWlyU3R5bGVfID0gW25ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgaW1hZ2U6IG5ldyBvbFN0eWxlSWNvbih7XG4gICAgICAgIHNyYzogJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsJyArIGJ0b2EocmVxdWlyZSgnZ21mL3Blcm1hbGluay9jcm9zc2hhaXIuc3ZnJykpXG4gICAgICB9KVxuICAgIH0pXTtcbiAgfVxuXG4gIHRoaXMubWFwVG9vbHRpcF8gPSBudWxsO1xuICB0aGlzLmZlYXR1cmVIYXNoRm9ybWF0XyA9IG5ldyBuZ2VvRm9ybWF0RmVhdHVyZUhhc2goe1xuICAgIHNldFN0eWxlOiBmYWxzZSxcbiAgICBlbmNvZGVTdHlsZXM6IGZhbHNlLFxuICAgIHByb3BlcnRpZXNUeXBlOiB7XG4gICAgICAnZmlsbENvbG9yJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLkNPTE9SLFxuICAgICAgJ2ZpbGxPcGFjaXR5Jzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLk9QQUNJVFksXG4gICAgICAnZm9udENvbG9yJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLkNPTE9SLFxuICAgICAgJ2ZvbnRTaXplJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNJWkUsXG4gICAgICAnaXNCb3gnOiBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuSVNfUkVDVEFOR0xFLFxuICAgICAgJ2lzQ2lyY2xlJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLklTX0NJUkNMRSxcbiAgICAgICdpc0xhYmVsJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLklTX1RFWFQsXG4gICAgICAnbmFtZSc6IG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5OQU1FLFxuICAgICAgJ3BvaW50UmFkaXVzJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNJWkUsXG4gICAgICAnc2hvd0xhYmVsJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNIT1dfTEFCRUwsXG4gICAgICAnc2hvd01lYXN1cmUnOiBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU0hPV19NRUFTVVJFLFxuICAgICAgJ3N0cm9rZUNvbG9yJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLkNPTE9SLFxuICAgICAgJ3N0cm9rZVdpZHRoJzogbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLlNUUk9LRVxuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlczoge1xuICAgICAgJ25hbWUnOiBmdW5jdGlvbiBuYW1lKGZlYXR1cmUpIHtcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gZmVhdHVyZS5nZXRHZW9tZXRyeSgpO1xuXG4gICAgICAgIGlmICghZ2VvbWV0cnkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoZ2VvbWV0cnkuZ2V0VHlwZSgpKTtcbiAgICAgIH0sXG4gICAgICAnZmlsbE9wYWNpdHknOiBmdW5jdGlvbiBmaWxsT3BhY2l0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAuNTtcbiAgICAgIH0sXG4gICAgICAnc2hvd0xhYmVsJzogZnVuY3Rpb24gc2hvd0xhYmVsKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuICAgICAgJ3Nob3dNZWFzdXJlJzogZnVuY3Rpb24gc2hvd01lYXN1cmUoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIGlmICh0aGlzLm5nZW9CYWNrZ3JvdW5kTGF5ZXJNZ3JfKSB7XG4gICAgbGlzdGVuKHRoaXMubmdlb0JhY2tncm91bmRMYXllck1ncl8sICdjaGFuZ2UnLCB0aGlzLmhhbmRsZUJhY2tncm91bmRMYXllck1hbmFnZXJDaGFuZ2VfLCB0aGlzKTtcbiAgfVxuXG4gIHRoaXMucm9vdFNjb3BlXy4kb24oJ25nZW8tbGF5ZXJ0cmVlLXN0YXRlJywgZnVuY3Rpb24gKGV2ZW50LCB0cmVlQ3RybCwgZmlyc3RQYXJlbnQpIHtcbiAgICB2YXIgbmV3U3RhdGUgPSB7fTtcblxuICAgIGlmIChmaXJzdFBhcmVudC5ub2RlLm1peGVkKSB7XG4gICAgICB2YXIgc3RhdGUgPSB0cmVlQ3RybC5nZXRTdGF0ZSgpO1xuXG4gICAgICBpZiAoc3RhdGUgIT09ICdvbicgJiYgc3RhdGUgIT09ICdvZmYnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3Jvbmcgc3RhdGUnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHZpc2libGUgPSBzdGF0ZSA9PT0gJ29uJztcbiAgICAgIHRyZWVDdHJsLnRyYXZlcnNlRGVwdGhGaXJzdChmdW5jdGlvbiAoY3RybCkge1xuICAgICAgICB2YXIgZ3JvdXBOb2RlID0gY3RybC5ub2RlO1xuXG4gICAgICAgIGlmIChncm91cE5vZGUuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHZhciBwYXJhbSA9IFBhcmFtUHJlZml4LlRSRUVfRU5BQkxFICsgY3RybC5ub2RlLm5hbWU7XG4gICAgICAgICAgbmV3U3RhdGVbcGFyYW1dID0gXCJcIiArIHZpc2libGU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgZ21mTGF5ZXJOYW1lcyA9IFtdO1xuICAgICAgZmlyc3RQYXJlbnQudHJhdmVyc2VEZXB0aEZpcnN0KGZ1bmN0aW9uIChjdHJsKSB7XG4gICAgICAgIHZhciBncm91cE5vZGUgPSB0cmVlQ3RybC5ub2RlO1xuXG4gICAgICAgIGlmIChncm91cE5vZGUuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCAmJiBjdHJsLmdldFN0YXRlKCkgPT09ICdvbicpIHtcbiAgICAgICAgICBnbWZMYXllck5hbWVzLnB1c2goY3RybC5ub2RlLm5hbWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIG5ld1N0YXRlW1wiXCIgKyBQYXJhbVByZWZpeC5UUkVFX0dST1VQX0xBWUVSUyArIGZpcnN0UGFyZW50Lm5vZGUubmFtZV0gPSBnbWZMYXllck5hbWVzLmpvaW4oJywnKTtcbiAgICB9XG5cbiAgICBfdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy51cGRhdGVTdGF0ZShuZXdTdGF0ZSk7XG4gIH0pO1xuICB0aGlzLnJvb3RTY29wZV8uJG9uKCduZ2VvLWxheWVydHJlZS1vcGFjaXR5JywgZnVuY3Rpb24gKGV2ZW50LCB0cmVlQ3RybCkge1xuICAgIHZhciBuZXdTdGF0ZSA9IHt9O1xuICAgIHZhciBvcGFjaXR5ID0gdHJlZUN0cmwubGF5ZXIuZ2V0T3BhY2l0eSgpO1xuICAgIHZhciBzdGF0ZU5hbWUgPSBcIlwiICsgKHRyZWVDdHJsLnBhcmVudC5ub2RlLm1peGVkID8gUGFyYW1QcmVmaXguVFJFRV9PUEFDSVRZIDogUGFyYW1QcmVmaXguVFJFRV9HUk9VUF9PUEFDSVRZKSArIHRyZWVDdHJsLm5vZGUubmFtZTtcbiAgICBuZXdTdGF0ZVtzdGF0ZU5hbWVdID0gb3BhY2l0eTtcblxuICAgIF90aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLnVwZGF0ZVN0YXRlKG5ld1N0YXRlKTtcbiAgfSk7XG4gIHZhciBmZWF0dXJlcyA9IHRoaXMuZ2V0RmVhdHVyZXMoKTtcblxuICBpZiAodGhpcy5uZ2VvRmVhdHVyZXNfKSB7XG4gICAgZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgaWYgKF90aGlzLmZlYXR1cmVIZWxwZXJfKSB7XG4gICAgICAgIF90aGlzLmZlYXR1cmVIZWxwZXJfLnNldFN0eWxlKGZlYXR1cmUpO1xuICAgICAgfVxuXG4gICAgICBfdGhpcy5hZGROZ2VvRmVhdHVyZV8oZmVhdHVyZSk7XG4gICAgfSk7XG4gICAgdGhpcy5uZ2VvRmVhdHVyZXNfLmV4dGVuZChmZWF0dXJlcyk7XG4gICAgbGlzdGVuKHRoaXMubmdlb0ZlYXR1cmVzXywgJ2FkZCcsIHRoaXMuaGFuZGxlTmdlb0ZlYXR1cmVzQWRkXywgdGhpcyk7XG4gICAgbGlzdGVuKHRoaXMubmdlb0ZlYXR1cmVzXywgJ3JlbW92ZScsIHRoaXMuaGFuZGxlTmdlb0ZlYXR1cmVzUmVtb3ZlXywgdGhpcyk7XG4gIH1cblxuICBpZiAodGhpcy5mZWF0dXJlSGVscGVyXykge1xuICAgIHRoaXMucm9vdFNjb3BlXy4kb24oJyRsb2NhbGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24gKCkge1xuICAgICAgZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICBpZiAoIV90aGlzLmZlYXR1cmVIZWxwZXJfKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmVIZWxwZXInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90aGlzLmZlYXR1cmVIZWxwZXJfLnNldFN0eWxlKGZlYXR1cmUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBpZiAodGhpcy5nbWZUaGVtZU1hbmFnZXJfKSB7XG4gICAgdGhpcy5yb290U2NvcGVfLiRvbihUaGVtZUV2ZW50VHlwZS5USEVNRV9OQU1FX1NFVCwgZnVuY3Rpb24gKGV2ZW50LCBuYW1lKSB7XG4gICAgICBfdGhpcy5zZXRUaGVtZUluVXJsXyhuYW1lKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMucm9vdFNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5nbWZMYXllckJlaW5nU3dpcGVfLmxheWVyO1xuICB9LCB0aGlzLmhhbmRsZUxheWVyQmVpbmdTd2lwZUNoYW5nZV8uYmluZCh0aGlzKSk7XG4gIHRoaXMucm9vdFNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5nbWZMYXllckJlaW5nU3dpcGVfLnN3aXBlVmFsdWU7XG4gIH0sIHRoaXMuaGFuZGxlTWFwU3dpcGVWYWx1ZV8uYmluZCh0aGlzKSk7XG4gIHRoaXMuc2V0RXh0ZXJuYWxEYXRhU291cmNlc1N0YXRlUHJvbWlzZV8gPSBudWxsO1xuXG4gIGlmICh0aGlzLm5nZW9RdWVyZW50XyAmJiB0aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXykge1xuICAgIHRoaXMuaW5pdEV4dGVybmFsRGF0YVNvdXJjZXNfKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIV90aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXInKTtcbiAgICAgIH1cblxuICAgICAgbGlzdGVuKF90aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXy53bXNHcm91cHNDb2xsZWN0aW9uLCAnYWRkJywgX3RoaXMuaGFuZGxlRXh0ZXJuYWxEU0dyb3VwQ29sbGVjdGlvbkFkZF8sIF90aGlzKTtcbiAgICAgIGxpc3RlbihfdGhpcy5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcl8ud21zR3JvdXBzQ29sbGVjdGlvbiwgJ3JlbW92ZScsIF90aGlzLmhhbmRsZUV4dGVybmFsRFNHcm91cENvbGxlY3Rpb25SZW1vdmVfLCBfdGhpcyk7XG4gICAgICBsaXN0ZW4oX3RoaXMuZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXJfLndtdHNHcm91cHNDb2xsZWN0aW9uLCAnYWRkJywgX3RoaXMuaGFuZGxlRXh0ZXJuYWxEU0dyb3VwQ29sbGVjdGlvbkFkZF8sIF90aGlzKTtcbiAgICAgIGxpc3RlbihfdGhpcy5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcl8ud210c0dyb3Vwc0NvbGxlY3Rpb24sICdyZW1vdmUnLCBfdGhpcy5oYW5kbGVFeHRlcm5hbERTR3JvdXBDb2xsZWN0aW9uUmVtb3ZlXywgX3RoaXMpO1xuXG4gICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBfdGhpcy5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcl8ud21zR3JvdXBzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICB2YXIgX3JlZjtcblxuICAgICAgICBpZiAoX2lzQXJyYXkpIHtcbiAgICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgICAgIF9yZWYgPSBfaS52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB3bXNHcm91cCA9IF9yZWY7XG5cbiAgICAgICAgX3RoaXMucmVnaXN0ZXJFeHRlcm5hbERTR3JvdXBfKHdtc0dyb3VwKTtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IF90aGlzLmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXy53bXRzR3JvdXBzLCBfaXNBcnJheTIgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjIpLCBfaTIgPSAwLCBfaXRlcmF0b3IyID0gX2lzQXJyYXkyID8gX2l0ZXJhdG9yMiA6IF9pdGVyYXRvcjJbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgdmFyIF9yZWYyO1xuXG4gICAgICAgIGlmIChfaXNBcnJheTIpIHtcbiAgICAgICAgICBpZiAoX2kyID49IF9pdGVyYXRvcjIubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICBfcmVmMiA9IF9pdGVyYXRvcjJbX2kyKytdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9pMiA9IF9pdGVyYXRvcjIubmV4dCgpO1xuICAgICAgICAgIGlmIChfaTIuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgX3JlZjIgPSBfaTIudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd210c0dyb3VwID0gX3JlZjI7XG5cbiAgICAgICAgX3RoaXMucmVnaXN0ZXJFeHRlcm5hbERTR3JvdXBfKHdtdHNHcm91cCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmluaXRMYXllcnNfKCk7XG59XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmhhbmRsZUxheWVyQmVpbmdTd2lwZUNoYW5nZV8gPSBmdW5jdGlvbiAobGF5ZXIsIG9sZExheWVyKSB7XG4gIGlmIChsYXllciA9PT0gb2xkTGF5ZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAobGF5ZXIpIHtcbiAgICB2YXIgb2JqZWN0ID0ge307XG4gICAgdmFyIG1hcFN3aXBlVmFsdWUgPSB0aGlzLmdtZkxheWVyQmVpbmdTd2lwZV8uc3dpcGVWYWx1ZTtcblxuICAgIGlmIChtYXBTd2lwZVZhbHVlID09PSBudWxsKSB7XG4gICAgICB0aGlzLmdtZkxheWVyQmVpbmdTd2lwZV8uc3dpcGVWYWx1ZSA9IDAuNTtcbiAgICB9XG5cbiAgICB2YXIgZGF0YVNvdXJjZUlkID0gbGF5ZXIuZ2V0KCdkYXRhU291cmNlSWQnKTtcbiAgICBvYmplY3RbUGVybWFsaW5rUGFyYW0uTUFQX1NXSVBFXSA9IGRhdGFTb3VyY2VJZDtcbiAgICBvYmplY3RbUGVybWFsaW5rUGFyYW0uTUFQX1NXSVBFX1ZBTFVFXSA9IG1hcFN3aXBlVmFsdWU7XG4gICAgdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy51cGRhdGVTdGF0ZShvYmplY3QpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMubmdlb1N0YXRlTWFuYWdlcl8uZGVsZXRlUGFyYW0oUGVybWFsaW5rUGFyYW0uTUFQX1NXSVBFKTtcbiAgICB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLmRlbGV0ZVBhcmFtKFBlcm1hbGlua1BhcmFtLk1BUF9TV0lQRV9WQUxVRSk7XG4gIH1cbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmhhbmRsZU1hcFN3aXBlVmFsdWVfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgbWFwU3dpcGVWYWx1ZSA9IHRoaXMuZ21mTGF5ZXJCZWluZ1N3aXBlXy5zd2lwZVZhbHVlO1xuICB2YXIgb2JqZWN0ID0ge307XG5cbiAgaWYgKG1hcFN3aXBlVmFsdWUgJiYgbWFwU3dpcGVWYWx1ZSAhPT0gbnVsbCAmJiBtYXBTd2lwZVZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICBvYmplY3RbUGVybWFsaW5rUGFyYW0uTUFQX1NXSVBFX1ZBTFVFXSA9IG1hcFN3aXBlVmFsdWU7XG4gICAgdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy51cGRhdGVTdGF0ZShvYmplY3QpO1xuICB9XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5nZXRNYXBDZW50ZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5tYXBfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICB9XG5cbiAgdmFyIHggPSB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLmdldEluaXRpYWxOdW1iZXJWYWx1ZShQZXJtYWxpbmtQYXJhbS5NQVBfWCk7XG4gIHZhciB5ID0gdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy5nZXRJbml0aWFsTnVtYmVyVmFsdWUoUGVybWFsaW5rUGFyYW0uTUFQX1kpO1xuXG4gIGlmICh4ICE9PSB1bmRlZmluZWQgJiYgeSAhPT0gdW5kZWZpbmVkICYmICFpc05hTih4KSAmJiAhaXNOYU4oeSkpIHtcbiAgICB2YXIgY2VudGVyID0gW3gsIHldO1xuXG4gICAgaWYgKHRoaXMuc291cmNlUHJvamVjdGlvbnNfICE9PSBudWxsICYmIHRoaXMubmdlb0F1dG9Qcm9qZWN0aW9uXykge1xuICAgICAgdmFyIHRhcmdldFByb2plY3Rpb24gPSB0aGlzLm1hcF8uZ2V0VmlldygpLmdldFByb2plY3Rpb24oKTtcbiAgICAgIHZhciByZXByb2plY3RlZENlbnRlciA9IHRoaXMubmdlb0F1dG9Qcm9qZWN0aW9uXy50cnlQcm9qZWN0aW9uc1dpdGhJbnZlcnNpb24oY2VudGVyLCB0YXJnZXRQcm9qZWN0aW9uLmdldEV4dGVudCgpLCB0YXJnZXRQcm9qZWN0aW9uLCB0aGlzLnNvdXJjZVByb2plY3Rpb25zXyk7XG5cbiAgICAgIGlmIChyZXByb2plY3RlZENlbnRlcikge1xuICAgICAgICByZXR1cm4gcmVwcm9qZWN0ZWRDZW50ZXI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNlbnRlcjtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuZ2V0TWFwWm9vbSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHpvb20gPSB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLmdldEluaXRpYWxOdW1iZXJWYWx1ZShQZXJtYWxpbmtQYXJhbS5NQVBfWik7XG4gIHJldHVybiB6b29tICE9PSB1bmRlZmluZWQgJiYgaXNOYU4oem9vbSkgPyB1bmRlZmluZWQgOiB6b29tO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuZ2V0TWFwQ3Jvc3NoYWlyID0gZnVuY3Rpb24gKCkge1xuICB2YXIgY3Jvc3NoYWlyID0gdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy5nZXRJbml0aWFsQm9vbGVhblZhbHVlKFBlcm1hbGlua1BhcmFtLk1BUF9DUk9TU0hBSVIpO1xuICByZXR1cm4gY3Jvc3NoYWlyID09PSB1bmRlZmluZWQgPyB0aGlzLmNyb3NzaGFpckVuYWJsZWRCeURlZmF1bHRfIDogY3Jvc3NoYWlyO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuc2V0TWFwQ3Jvc3NoYWlyID0gZnVuY3Rpb24gKG9wdF9jZW50ZXIpIHtcbiAgaWYgKCF0aGlzLm1hcF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gIH1cblxuICBpZiAoIXRoaXMuZmVhdHVyZU92ZXJsYXlfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmVPdmVybGF5Jyk7XG4gIH1cblxuICB2YXIgY3Jvc3NoYWlyQ29vcmRpbmF0ZTtcblxuICBpZiAob3B0X2NlbnRlcikge1xuICAgIGNyb3NzaGFpckNvb3JkaW5hdGUgPSBvcHRfY2VudGVyO1xuICB9IGVsc2Uge1xuICAgIGNyb3NzaGFpckNvb3JkaW5hdGUgPSB0aGlzLm1hcF8uZ2V0VmlldygpLmdldENlbnRlcigpO1xuICB9XG5cbiAgaWYgKCFBcnJheS5pc0FycmF5KGNyb3NzaGFpckNvb3JkaW5hdGUpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBjcm9zc2hhaXJDb29yZGluYXRlJyk7XG4gIH1cblxuICBpZiAodGhpcy5jcm9zc2hhaXJGZWF0dXJlXykge1xuICAgIHRoaXMuZmVhdHVyZU92ZXJsYXlfLnJlbW92ZUZlYXR1cmUodGhpcy5jcm9zc2hhaXJGZWF0dXJlXyk7XG4gIH1cblxuICB0aGlzLmNyb3NzaGFpckZlYXR1cmVfID0gbmV3IG9sRmVhdHVyZShuZXcgb2xHZW9tUG9pbnQoY3Jvc3NoYWlyQ29vcmRpbmF0ZSkpO1xuICB0aGlzLmNyb3NzaGFpckZlYXR1cmVfLnNldFN0eWxlKHRoaXMuY3Jvc3NoYWlyU3R5bGVfKTtcbiAgdGhpcy5mZWF0dXJlT3ZlcmxheV8uYWRkRmVhdHVyZSh0aGlzLmNyb3NzaGFpckZlYXR1cmVfKTtcbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmdldE1hcFRvb2x0aXAgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLmdldEluaXRpYWxTdHJpbmdWYWx1ZShQZXJtYWxpbmtQYXJhbS5NQVBfVE9PTFRJUCk7XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5zZXRNYXBUb29sdGlwID0gZnVuY3Rpb24gKHRvb2x0aXBUZXh0LCBvcHRfY2VudGVyKSB7XG4gIGlmICghdGhpcy5tYXBfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICB9XG5cbiAgdmFyIHRvb2x0aXBQb3NpdGlvbjtcblxuICBpZiAob3B0X2NlbnRlcikge1xuICAgIHRvb2x0aXBQb3NpdGlvbiA9IG9wdF9jZW50ZXI7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGNlbnRlciA9IHRoaXMubWFwXy5nZXRWaWV3KCkuZ2V0Q2VudGVyKCk7XG5cbiAgICBpZiAoIWNlbnRlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNlbnRlcicpO1xuICAgIH1cblxuICAgIHRvb2x0aXBQb3NpdGlvbiA9IGNlbnRlcjtcbiAgfVxuXG4gIGlmICghQXJyYXkuaXNBcnJheSh0b29sdGlwUG9zaXRpb24pKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyB0b29sdGlwUG9zaXRpb24gdHlwZScpO1xuICB9XG5cbiAgdmFyIGRpdiA9ICQoJzxkaXYvPicsIHtcbiAgICAnY2xhc3MnOiAnZ21mLXBlcm1hbGluay10b29sdGlwJyxcbiAgICAndGV4dCc6IHRvb2x0aXBUZXh0XG4gIH0pWzBdO1xuXG4gIGlmICh0aGlzLm1hcFRvb2x0aXBfICE9PSBudWxsKSB7XG4gICAgdGhpcy5tYXBfLnJlbW92ZU92ZXJsYXkodGhpcy5tYXBUb29sdGlwXyk7XG4gIH1cblxuICB0aGlzLm1hcFRvb2x0aXBfID0gbmV3IG5nZW9Qb3BvdmVyKHtcbiAgICBlbGVtZW50OiBkaXYsXG4gICAgcG9zaXRpb246IHRvb2x0aXBQb3NpdGlvblxuICB9KTtcbiAgdGhpcy5tYXBfLmFkZE92ZXJsYXkodGhpcy5tYXBUb29sdGlwXyk7XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5nZXRGZWF0dXJlcyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGYgPSB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLmdldEluaXRpYWxTdHJpbmdWYWx1ZShQZXJtYWxpbmtQYXJhbS5GRUFUVVJFUyk7XG5cbiAgaWYgKGYgIT09IHVuZGVmaW5lZCAmJiBmICE9PSAnJykge1xuICAgIHJldHVybiB0aGlzLmZlYXR1cmVIYXNoRm9ybWF0Xy5yZWFkRmVhdHVyZXMoZik7XG4gIH1cblxuICByZXR1cm4gW107XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5zZXREaW1lbnNpb25zID0gZnVuY3Rpb24gKGRpbWVuc2lvbnMpIHtcbiAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgdmFyIGtleXMgPSB0aGlzLm5nZW9Mb2NhdGlvbl8uZ2V0UGFyYW1LZXlzV2l0aFByZWZpeChQYXJhbVByZWZpeC5ESU1FTlNJT05TKTtcblxuICBmb3IgKHZhciBfaXRlcmF0b3IzID0ga2V5cywgX2lzQXJyYXkzID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IzKSwgX2kzID0gMCwgX2l0ZXJhdG9yMyA9IF9pc0FycmF5MyA/IF9pdGVyYXRvcjMgOiBfaXRlcmF0b3IzW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgdmFyIF9yZWYzO1xuXG4gICAgaWYgKF9pc0FycmF5Mykge1xuICAgICAgaWYgKF9pMyA+PSBfaXRlcmF0b3IzLmxlbmd0aCkgYnJlYWs7XG4gICAgICBfcmVmMyA9IF9pdGVyYXRvcjNbX2kzKytdO1xuICAgIH0gZWxzZSB7XG4gICAgICBfaTMgPSBfaXRlcmF0b3IzLm5leHQoKTtcbiAgICAgIGlmIChfaTMuZG9uZSkgYnJlYWs7XG4gICAgICBfcmVmMyA9IF9pMy52YWx1ZTtcbiAgICB9XG5cbiAgICB2YXIga2V5ID0gX3JlZjM7XG4gICAgdmFyIHZhbHVlID0gdGhpcy5uZ2VvTG9jYXRpb25fLmdldFBhcmFtKGtleSk7XG5cbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdmFsdWUnKTtcbiAgICB9XG5cbiAgICBkaW1lbnNpb25zW2tleS5zbGljZShQYXJhbVByZWZpeC5ESU1FTlNJT05TLmxlbmd0aCldID0gdmFsdWU7XG4gIH1cblxuICB0aGlzLnJvb3RTY29wZV8uJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRpbWVuc2lvbnM7XG4gIH0sIGZ1bmN0aW9uIChkaW1lbnNpb25zKSB7XG4gICAgdmFyIHBhcmFtcyA9IHt9O1xuXG4gICAgZm9yICh2YXIga2V5IGluIGRpbWVuc2lvbnMpIHtcbiAgICAgIHBhcmFtc1tQYXJhbVByZWZpeC5ESU1FTlNJT05TICsga2V5XSA9IGRpbWVuc2lvbnNba2V5XTtcbiAgICB9XG5cbiAgICBfdGhpczIubmdlb0xvY2F0aW9uXy51cGRhdGVQYXJhbXMocGFyYW1zKTtcbiAgfSk7XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5zZXRNYXAgPSBmdW5jdGlvbiAobWFwKSB7XG4gIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gIGlmIChtYXAgPT09IHRoaXMubWFwXykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLm1hcF8pIHtcbiAgICB0aGlzLnVucmVnaXN0ZXJNYXBfKCk7XG4gICAgdGhpcy5tYXBfID0gbnVsbDtcbiAgfVxuXG4gIGlmIChtYXApIHtcbiAgICB0aGlzLm1hcF8gPSBtYXA7XG5cbiAgICBpZiAodGhpcy5nbWZPYmplY3RFZGl0aW5nTWFuYWdlcl8pIHtcbiAgICAgIHRoaXMuZ21mT2JqZWN0RWRpdGluZ01hbmFnZXJfLmdldEZlYXR1cmUoKS50aGVuKGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgICAgIF90aGlzMy5yZWdpc3Rlck1hcF8obWFwLCBmZWF0dXJlKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlZ2lzdGVyTWFwXyhtYXAsIG51bGwpO1xuICAgIH1cbiAgfVxufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUucmVnaXN0ZXJNYXBfID0gZnVuY3Rpb24gKG1hcCwgb2VGZWF0dXJlKSB7XG4gIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gIHZhciB2aWV3ID0gbWFwLmdldFZpZXcoKTtcbiAgdmFyIGNlbnRlcjtcbiAgdmFyIGdlb20gPSB0eXBlb2Ygb2VGZWF0dXJlICE9PSAndW5kZWZpbmVkJyAmJiBvZUZlYXR1cmUgIT09IG51bGwgPyBvZUZlYXR1cmUuZ2V0R2VvbWV0cnkoKSA6IHVuZGVmaW5lZDtcblxuICBpZiAoZ2VvbSkge1xuICAgIHZhciBzaXplID0gbWFwLmdldFNpemUoKTtcblxuICAgIGlmICghc2l6ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNpemUnKTtcbiAgICB9XG5cbiAgICB2YXIgbWF4Wm9vbTtcblxuICAgIGlmIChnZW9tIGluc3RhbmNlb2Ygb2xHZW9tUG9pbnQgfHwgZ2VvbSBpbnN0YW5jZW9mIG9sR2VvbU11bHRpUG9pbnQpIHtcbiAgICAgIG1heFpvb20gPSB0aGlzLnBvaW50UmVjZW50ZXJab29tXztcbiAgICB9XG5cbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgIHNpemU6IHNpemVcbiAgICB9O1xuXG4gICAgaWYgKG1heFpvb20pIHtcbiAgICAgIG9wdGlvbnMubWF4Wm9vbSA9IG1heFpvb207XG4gICAgfVxuXG4gICAgdmlldy5maXQoZ2VvbS5nZXRFeHRlbnQoKSwgb3B0aW9ucyk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGVuYWJsZWQzZCA9IHRoaXMubmdlb1N0YXRlTWFuYWdlcl8uZ2V0SW5pdGlhbEJvb2xlYW5WYWx1ZShQZXJtYWxpbmszZFBhcmFtLkVOQUJMRUQpO1xuXG4gICAgaWYgKCFlbmFibGVkM2QpIHtcbiAgICAgIGNlbnRlciA9IHRoaXMuZ2V0TWFwQ2VudGVyKCk7XG5cbiAgICAgIGlmIChjZW50ZXIpIHtcbiAgICAgICAgdmlldy5zZXRDZW50ZXIoY2VudGVyKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHpvb20gPSB0aGlzLmdldE1hcFpvb20oKTtcblxuICAgICAgaWYgKHpvb20gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2aWV3LnNldFpvb20oem9vbSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdGhpcy5tYXBWaWV3UHJvcGVydHlDaGFuZ2VFdmVudEtleV8gPSBsaXN0ZW4odmlldywgJ3Byb3BlcnR5Y2hhbmdlJywgdGhpcy5uZ2VvRGVib3VuY2VfKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2VudGVyID0gdmlldy5nZXRDZW50ZXIoKTtcblxuICAgIGlmICghY2VudGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY2VudGVyJyk7XG4gICAgfVxuXG4gICAgdmFyIHpvb20gPSB2aWV3LmdldFpvb20oKTtcbiAgICB2YXIgb2JqZWN0ID0ge307XG4gICAgb2JqZWN0W1Blcm1hbGlua1BhcmFtLk1BUF9YXSA9IFwiXCIgKyBNYXRoLnJvdW5kKGNlbnRlclswXSk7XG4gICAgb2JqZWN0W1Blcm1hbGlua1BhcmFtLk1BUF9ZXSA9IFwiXCIgKyBNYXRoLnJvdW5kKGNlbnRlclsxXSk7XG4gICAgb2JqZWN0W1Blcm1hbGlua1BhcmFtLk1BUF9aXSA9IFwiXCIgKyB6b29tO1xuXG4gICAgX3RoaXM0Lm5nZW9TdGF0ZU1hbmFnZXJfLnVwZGF0ZVN0YXRlKG9iamVjdCk7XG4gIH0sIDMwMCwgdHJ1ZSksIHRoaXMpO1xuXG4gIGlmICh0aGlzLmdldE1hcENyb3NzaGFpcigpICYmIHRoaXMuZmVhdHVyZU92ZXJsYXlfKSB7XG4gICAgdGhpcy5zZXRNYXBDcm9zc2hhaXIoY2VudGVyKTtcbiAgfVxuXG4gIHZhciB0b29sdGlwVGV4dCA9IHRoaXMuZ2V0TWFwVG9vbHRpcCgpO1xuXG4gIGlmICh0b29sdGlwVGV4dCkge1xuICAgIHRoaXMuc2V0TWFwVG9vbHRpcCh0b29sdGlwVGV4dCwgY2VudGVyKTtcbiAgfVxuXG4gIHZhciB3ZnNQZXJtYWxpbmtEYXRhID0gdGhpcy5nZXRXZnNQZXJtYWxpbmtEYXRhXygpO1xuXG4gIGlmICh3ZnNQZXJtYWxpbmtEYXRhICE9PSBudWxsICYmIHRoaXMubmdlb1dmc1Blcm1hbGlua18pIHtcbiAgICB0aGlzLm5nZW9XZnNQZXJtYWxpbmtfLmlzc3VlKHdmc1Blcm1hbGlua0RhdGEsIG1hcCk7XG4gIH1cbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLnVucmVnaXN0ZXJNYXBfID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMubWFwVmlld1Byb3BlcnR5Q2hhbmdlRXZlbnRLZXlfKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcFZpZXdQcm9wZXJ0eUNoYW5nZUV2ZW50S2V5Jyk7XG4gIH1cblxuICB1bmxpc3RlbkJ5S2V5KHRoaXMubWFwVmlld1Byb3BlcnR5Q2hhbmdlRXZlbnRLZXlfKTtcbiAgdGhpcy5tYXBWaWV3UHJvcGVydHlDaGFuZ2VFdmVudEtleV8gPSBudWxsO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuZ2V0QmFja2dyb3VuZExheWVyID0gZnVuY3Rpb24gKGxheWVycykge1xuICB2YXIgbGF5ZXJOYW1lID0gdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy5nZXRJbml0aWFsU3RyaW5nVmFsdWUoUGVybWFsaW5rUGFyYW0uQkdfTEFZRVIpO1xuXG4gIGlmIChsYXllck5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgIGZvciAodmFyIF9pdGVyYXRvcjQgPSBsYXllcnMsIF9pc0FycmF5NCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNCksIF9pNCA9IDAsIF9pdGVyYXRvcjQgPSBfaXNBcnJheTQgPyBfaXRlcmF0b3I0IDogX2l0ZXJhdG9yNFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY0O1xuXG4gICAgICBpZiAoX2lzQXJyYXk0KSB7XG4gICAgICAgIGlmIChfaTQgPj0gX2l0ZXJhdG9yNC5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmNCA9IF9pdGVyYXRvcjRbX2k0KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k0ID0gX2l0ZXJhdG9yNC5uZXh0KCk7XG4gICAgICAgIGlmIChfaTQuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWY0ID0gX2k0LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgbGF5ZXIgPSBfcmVmNDtcblxuICAgICAgaWYgKGxheWVyLmdldCgnbGFiZWwnKSA9PT0gbGF5ZXJOYW1lKSB7XG4gICAgICAgIHJldHVybiBsYXllcjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmdldEJhY2tncm91bmRMYXllck9wYWNpdHkgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBvcGFjaXR5XyA9IHRoaXMubmdlb1N0YXRlTWFuYWdlcl8uZ2V0SW5pdGlhbE51bWJlclZhbHVlKFBlcm1hbGlua1BhcmFtLkJHX0xBWUVSX09QQUNJVFkpO1xuICByZXR1cm4gb3BhY2l0eV8gPT09IHVuZGVmaW5lZCA/IG51bGwgOiBvcGFjaXR5XyAvIDEwMDtcbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmhhbmRsZUJhY2tncm91bmRMYXllck1hbmFnZXJDaGFuZ2VfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICBpZiAoIXRoaXMubWFwXyB8fCAhdGhpcy5uZ2VvQmFja2dyb3VuZExheWVyTWdyXykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBsYXllciA9IHRoaXMubmdlb0JhY2tncm91bmRMYXllck1ncl8uZ2V0KHRoaXMubWFwXyk7XG5cbiAgaWYgKCFsYXllcikge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsYXllcicpO1xuICB9XG5cbiAgdmFyIGxheWVyTmFtZSA9IGxheWVyLmdldCgnbGFiZWwnKTtcblxuICBpZiAodHlwZW9mIGxheWVyTmFtZSAhPSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgbGF5ZXJOYW1lIHR5cGUnKTtcbiAgfVxuXG4gIHZhciBvYmplY3QgPSB7fTtcbiAgb2JqZWN0W1Blcm1hbGlua1BhcmFtLkJHX0xBWUVSXSA9IGxheWVyTmFtZTtcbiAgdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy51cGRhdGVTdGF0ZShvYmplY3QpO1xuICB2YXIgYmFja2dyb3VuZExheWVyID0gdGhpcy5uZ2VvQmFja2dyb3VuZExheWVyTWdyXy5nZXRPcGFjaXR5QmdMYXllcih0aGlzLm1hcF8pO1xuXG4gIGlmIChiYWNrZ3JvdW5kTGF5ZXIpIHtcbiAgICB2YXIgb3BhY2l0eSA9IHRoaXMuZ2V0QmFja2dyb3VuZExheWVyT3BhY2l0eSgpO1xuXG4gICAgaWYgKG9wYWNpdHkgIT09IG51bGwpIHtcbiAgICAgIGJhY2tncm91bmRMYXllci5zZXRPcGFjaXR5KG9wYWNpdHkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgX29wYWNpdHkgPSBiYWNrZ3JvdW5kTGF5ZXIuZ2V0T3BhY2l0eSgpO1xuXG4gICAgICB2YXIgX29iamVjdCA9IHt9O1xuICAgICAgX29iamVjdFtQZXJtYWxpbmtQYXJhbS5CR19MQVlFUl9PUEFDSVRZXSA9IFwiXCIgKyBfb3BhY2l0eSAqIDEwMDtcbiAgICAgIHRoaXMubmdlb1N0YXRlTWFuYWdlcl8udXBkYXRlU3RhdGUoX29iamVjdCk7XG4gICAgfVxuXG4gICAgbGlzdGVuKGJhY2tncm91bmRMYXllciwgJ2NoYW5nZTpvcGFjaXR5JywgZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIG9wYWNpdHkgPSBiYWNrZ3JvdW5kTGF5ZXIuZ2V0T3BhY2l0eSgpO1xuICAgICAgdmFyIG9iamVjdCA9IHt9O1xuICAgICAgb2JqZWN0W1Blcm1hbGlua1BhcmFtLkJHX0xBWUVSX09QQUNJVFldID0gXCJcIiArIG9wYWNpdHkgKiAxMDA7XG5cbiAgICAgIF90aGlzNS5uZ2VvU3RhdGVNYW5hZ2VyXy51cGRhdGVTdGF0ZShvYmplY3QpO1xuICAgIH0pO1xuICB9XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5yZWZyZXNoRmlyc3RMZXZlbEdyb3VwcyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLmdtZlRyZWVNYW5hZ2VyXykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghdGhpcy5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsJyk7XG4gIH1cblxuICB2YXIgZ3JvdXBOb2RlID0gdGhpcy5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwubm9kZTtcbiAgdmFyIGdyb3VwTm9kZXMgPSBncm91cE5vZGUuY2hpbGRyZW47XG4gIHZhciBvcmRlcmVkTmFtZXMgPSBncm91cE5vZGVzID8gZ3JvdXBOb2Rlcy5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS5uYW1lO1xuICB9KSA6IFtdO1xuICB2YXIgb2JqZWN0ID0ge307XG4gIG9iamVjdFtQZXJtYWxpbmtQYXJhbS5UUkVFX0dST1VQU10gPSBvcmRlcmVkTmFtZXMuam9pbignLCcpO1xuICB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLnVwZGF0ZVN0YXRlKG9iamVjdCk7XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS50aGVtZUluVXJsXyA9IGZ1bmN0aW9uIChwYXRoRWxlbWVudHMpIHtcbiAgdmFyIGluZGV4T2ZUaGVtZSA9IHBhdGhFbGVtZW50cy5pbmRleE9mKCd0aGVtZScpO1xuICByZXR1cm4gaW5kZXhPZlRoZW1lICE9IC0xICYmIGluZGV4T2ZUaGVtZSA9PSBwYXRoRWxlbWVudHMubGVuZ3RoIC0gMjtcbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLnNldFRoZW1lSW5VcmxfID0gZnVuY3Rpb24gKHRoZW1lTmFtZSkge1xuICB2YXIgcGF0aCA9IHRoaXMubmdlb0xvY2F0aW9uXy5nZXRQYXRoKCk7XG5cbiAgaWYgKCFwYXRoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHBhdGgnKTtcbiAgfVxuXG4gIGlmICh0aGVtZU5hbWUpIHtcbiAgICB2YXIgcGF0aEVsZW1lbnRzID0gcGF0aC5zcGxpdCgnLycpO1xuXG4gICAgaWYgKHBhdGhFbGVtZW50cy5sZW5ndGggPD0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBwYXRoRWxlbWVudHMnKTtcbiAgICB9XG5cbiAgICBpZiAocGF0aEVsZW1lbnRzW3BhdGhFbGVtZW50cy5sZW5ndGggLSAxXSA9PT0gJycpIHtcbiAgICAgIHBhdGhFbGVtZW50cy5zcGxpY2UocGF0aEVsZW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnRoZW1lSW5VcmxfKHBhdGhFbGVtZW50cykpIHtcbiAgICAgIHBhdGhFbGVtZW50c1twYXRoRWxlbWVudHMubGVuZ3RoIC0gMV0gPSB0aGVtZU5hbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhdGhFbGVtZW50cy5wdXNoKCd0aGVtZScsIHRoZW1lTmFtZSk7XG4gICAgfVxuXG4gICAgdGhpcy5uZ2VvTG9jYXRpb25fLnNldFBhdGgocGF0aEVsZW1lbnRzLmpvaW4oJy8nKSk7XG4gIH1cbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmRlZmF1bHRUaGVtZU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBwYXRoID0gdGhpcy5uZ2VvTG9jYXRpb25fLmdldFBhdGgoKTtcblxuICBpZiAoIXBhdGgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcGF0aCcpO1xuICB9XG5cbiAgdmFyIHBhdGhFbGVtZW50cyA9IHBhdGguc3BsaXQoJy8nKTtcblxuICBpZiAodGhpcy50aGVtZUluVXJsXyhwYXRoRWxlbWVudHMpKSB7XG4gICAgcmV0dXJuIGRlY29kZVVSSShwYXRoRWxlbWVudHNbcGF0aEVsZW1lbnRzLmxlbmd0aCAtIDFdKTtcbiAgfVxuXG4gIHZhciB0biA9IHRoaXMubmdlb1N0YXRlTWFuYWdlcl8uZ2V0SW5pdGlhbFN0cmluZ1ZhbHVlKCd0aGVtZScpO1xuXG4gIGlmICh0bikge1xuICAgIHJldHVybiB0bjtcbiAgfVxuXG4gIHZhciBkZWZhdWx0VGhlbWUgPSB0aGlzLmRlZmF1bHRUaGVtZU5hbWVGcm9tRnVuY3Rpb25hbGl0aWVzKCk7XG5cbiAgaWYgKGRlZmF1bHRUaGVtZSAhPT0gbnVsbCkge1xuICAgIHJldHVybiBkZWZhdWx0VGhlbWU7XG4gIH1cblxuICBpZiAodGhpcy5kZWZhdWx0VGhlbWVfKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVmYXVsdFRoZW1lXztcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuZGVmYXVsdFRoZW1lTmFtZUZyb21GdW5jdGlvbmFsaXRpZXMgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5nbWZVc2VyXykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmFyIGZ1bmN0aW9uYWxpdGllcyA9IHRoaXMuZ21mVXNlcl8uZnVuY3Rpb25hbGl0aWVzO1xuXG4gIGlmIChmdW5jdGlvbmFsaXRpZXMgJiYgJ2RlZmF1bHRfdGhlbWUnIGluIGZ1bmN0aW9uYWxpdGllcykge1xuICAgIHZhciBkZWZhdWx0VGhlbWUgPSBmdW5jdGlvbmFsaXRpZXMuZGVmYXVsdF90aGVtZTtcblxuICAgIGlmIChkZWZhdWx0VGhlbWUubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRUaGVtZVswXTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmluaXRMYXllcnNfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICB2YXIgaW5pdGlhbFVyaSA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICB2YXIgYXV0aGVudGljYXRpb25SZXF1aXJlZCA9IGZhbHNlO1xuXG4gIGlmICghdGhpcy5nbWZUaGVtZXNfKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5nbWZUaGVtZXNfLmdldFRoZW1lc09iamVjdCgpLnRoZW4oZnVuY3Rpb24gKHRoZW1lcykge1xuICAgIHZhciB0aGVtZU5hbWUgPSBfdGhpczYuZGVmYXVsdFRoZW1lTmFtZSgpO1xuXG4gICAgaWYgKF90aGlzNi5nbWZUaGVtZU1hbmFnZXJfKSB7XG4gICAgICBfdGhpczYuZ21mVGhlbWVNYW5hZ2VyXy5zZXRUaGVtZU5hbWUoX3RoaXM2LmdtZlRoZW1lTWFuYWdlcl8ubW9kZUZsdXNoID8gdGhlbWVOYW1lIDogJycpO1xuICAgIH1cblxuICAgIHZhciBmaXJzdExldmVsR3JvdXBzID0gW107XG4gICAgdmFyIHRoZW1lO1xuXG4gICAgdmFyIGdyb3Vwc05hbWVzID0gX3RoaXM2Lm5nZW9Mb2NhdGlvbl8uZ2V0UGFyYW0oUGVybWFsaW5rUGFyYW0uVFJFRV9HUk9VUFMpO1xuXG4gICAgaWYgKGdyb3Vwc05hbWVzID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoZW1lID0gZmluZFRoZW1lQnlOYW1lKHRoZW1lcywgdGhlbWVOYW1lKTtcblxuICAgICAgaWYgKHRoZW1lKSB7XG4gICAgICAgIGZpcnN0TGV2ZWxHcm91cHMgPSB0aGVtZS5jaGlsZHJlbjtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZ3JvdXBzTmFtZXMuc3BsaXQoJywnKS5mb3JFYWNoKGZ1bmN0aW9uIChncm91cE5hbWUpIHtcbiAgICAgICAgdmFyIGdyb3VwID0gZmluZEdyb3VwQnlOYW1lKHRoZW1lcywgZ3JvdXBOYW1lKTtcblxuICAgICAgICBpZiAoZ3JvdXApIHtcbiAgICAgICAgICBmaXJzdExldmVsR3JvdXBzLnB1c2goZ3JvdXApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF1dGhlbnRpY2F0aW9uUmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoX3RoaXM2LmdtZlRyZWVNYW5hZ2VyXykge1xuICAgICAgX3RoaXM2LmdtZlRyZWVNYW5hZ2VyXy5zZXRGaXJzdExldmVsR3JvdXBzKGZpcnN0TGV2ZWxHcm91cHMpO1xuICAgIH1cblxuICAgIF90aGlzNi4kdGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCFfdGhpczYuZ21mVHJlZU1hbmFnZXJfIHx8ICFfdGhpczYuZ21mVHJlZU1hbmFnZXJfLnJvb3RDdHJsKSB7XG4gICAgICAgIGlmIChhdXRoZW50aWNhdGlvblJlcXVpcmVkICYmIF90aGlzNi5nbWZVc2VyXyAmJiBfdGhpczYuZ21mVXNlcl8ucm9sZXMgPT09IG51bGwpIHtcbiAgICAgICAgICBfdGhpczYucm9vdFNjb3BlXy4kYnJvYWRjYXN0KCdhdXRoZW50aWNhdGlvbnJlcXVpcmVkJywge1xuICAgICAgICAgICAgdXJsOiBpbml0aWFsVXJpXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBsYXllckJlaW5nU3dpcGVWYWx1ZSA9IF90aGlzNi5uZ2VvU3RhdGVNYW5hZ2VyXy5nZXRJbml0aWFsTnVtYmVyVmFsdWUoUGVybWFsaW5rUGFyYW0uTUFQX1NXSVBFKTtcblxuICAgICAgdmFyIG1hcFN3aXBlVmFsdWUgPSBfdGhpczYubmdlb1N0YXRlTWFuYWdlcl8uZ2V0SW5pdGlhbE51bWJlclZhbHVlKFBlcm1hbGlua1BhcmFtLk1BUF9TV0lQRV9WQUxVRSk7XG5cbiAgICAgIHZhciB2aXNpdG9yID0gZnVuY3Rpb24gdmlzaXRvcih0cmVlQ3RybCkge1xuICAgICAgICBpZiAodHJlZUN0cmwuaXNSb290KSB7XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBncm91cE5vZGUgPSB0cmVlQ3RybC5ub2RlO1xuICAgICAgICB2YXIgcGFyZW50R3JvdXBOb2RlID0gdHJlZUN0cmwucGFyZW50Lm5vZGU7XG5cbiAgICAgICAgdmFyIG9wYWNpdHkgPSBfdGhpczYubmdlb1N0YXRlTWFuYWdlcl8uZ2V0SW5pdGlhbE51bWJlclZhbHVlKChwYXJlbnRHcm91cE5vZGUubWl4ZWQgPyBQYXJhbVByZWZpeC5UUkVFX09QQUNJVFkgOiBQYXJhbVByZWZpeC5UUkVFX0dST1VQX09QQUNJVFkpICsgdHJlZUN0cmwubm9kZS5uYW1lKTtcblxuICAgICAgICBpZiAodHJlZUN0cmwubGF5ZXIpIHtcbiAgICAgICAgICBpZiAob3BhY2l0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0cmVlQ3RybC5sYXllci5zZXRPcGFjaXR5KG9wYWNpdHkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChsYXllckJlaW5nU3dpcGVWYWx1ZSAhPT0gbnVsbCAmJiBsYXllckJlaW5nU3dpcGVWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRyZWVDdHJsLmxheWVyLmdldCgnZGF0YVNvdXJjZUlkJykgPT09IGxheWVyQmVpbmdTd2lwZVZhbHVlKSB7XG4gICAgICAgICAgICBpZiAobWFwU3dpcGVWYWx1ZSAhPT0gbnVsbCAmJiBtYXBTd2lwZVZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgX3RoaXM2LmdtZkxheWVyQmVpbmdTd2lwZV8uc3dpcGVWYWx1ZSA9IG1hcFN3aXBlVmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF90aGlzNi5nbWZMYXllckJlaW5nU3dpcGVfLmxheWVyID0gdHJlZUN0cmwubGF5ZXI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRyZWVDdHJsLnBhcmVudC5ub2RlICYmIHBhcmVudEdyb3VwTm9kZS5taXhlZCAmJiBncm91cE5vZGUuY2hpbGRyZW4gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdmFyIGVuYWJsZSA9IF90aGlzNi5uZ2VvU3RhdGVNYW5hZ2VyXy5nZXRJbml0aWFsQm9vbGVhblZhbHVlKFBhcmFtUHJlZml4LlRSRUVfRU5BQkxFICsgdHJlZUN0cmwubm9kZS5uYW1lKTtcblxuICAgICAgICAgIGlmIChlbmFibGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdHJlZUN0cmwuc2V0U3RhdGUoZW5hYmxlID8gJ29uJyA6ICdvZmYnLCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCFncm91cE5vZGUubWl4ZWQgJiYgdHJlZUN0cmwuZGVwdGggPT0gMSkge1xuICAgICAgICAgIHZhciBncm91cExheWVycyA9IF90aGlzNi5uZ2VvU3RhdGVNYW5hZ2VyXy5nZXRJbml0aWFsU3RyaW5nVmFsdWUoUGFyYW1QcmVmaXguVFJFRV9HUk9VUF9MQVlFUlMgKyB0cmVlQ3RybC5ub2RlLm5hbWUpO1xuXG4gICAgICAgICAgaWYgKGdyb3VwTGF5ZXJzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBncm91cExheWVyc0FycmF5ID0gZ3JvdXBMYXllcnMgPT0gJycgPyBbXSA6IGdyb3VwTGF5ZXJzLnNwbGl0KCcsJyk7XG5cbiAgICAgICAgICAgIHZhciBfdmlzaXRvciA9IGZ1bmN0aW9uIF92aXNpdG9yKHRyZWVDdHJsKSB7XG4gICAgICAgICAgICAgIHZhciBncm91cE5vZGUgPSB0cmVlQ3RybC5ub2RlO1xuXG4gICAgICAgICAgICAgIGlmIChncm91cE5vZGUuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHZhciBfZW5hYmxlID0gZ3JvdXBMYXllcnNBcnJheS5pbmNsdWRlcyh0cmVlQ3RybC5ub2RlLm5hbWUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKF9lbmFibGUpIHtcbiAgICAgICAgICAgICAgICAgIGdyb3VwTGF5ZXJzQXJyYXkuc3BsaWNlKGdyb3VwTGF5ZXJzQXJyYXkuaW5kZXhPZih0cmVlQ3RybC5ub2RlLm5hbWUpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0cmVlQ3RybC5zZXRTdGF0ZShfZW5hYmxlID8gJ29uJyA6ICdvZmYnLCBmYWxzZSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdHJlZUN0cmwudHJhdmVyc2VEZXB0aEZpcnN0KF92aXNpdG9yKTtcblxuICAgICAgICAgICAgaWYgKGdyb3VwTGF5ZXJzQXJyYXkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICBhdXRoZW50aWNhdGlvblJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIF90aGlzNi5nbWZUcmVlTWFuYWdlcl8ucm9vdEN0cmwudHJhdmVyc2VEZXB0aEZpcnN0KHZpc2l0b3IpO1xuXG4gICAgICB2YXIgZmlyc3RQYXJlbnRzID0gX3RoaXM2LmdtZlRyZWVNYW5hZ2VyXy5yb290Q3RybC5jaGlsZHJlbjtcbiAgICAgIGZpcnN0UGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChmaXJzdFBhcmVudCkge1xuICAgICAgICBmaXJzdFBhcmVudC50cmF2ZXJzZURlcHRoRmlyc3QoZnVuY3Rpb24gKHRyZWVDdHJsKSB7XG4gICAgICAgICAgaWYgKHRyZWVDdHJsLmdldFN0YXRlKCkgIT09ICdpbmRldGVybWluYXRlJykge1xuICAgICAgICAgICAgX3RoaXM2LnJvb3RTY29wZV8uJGJyb2FkY2FzdCgnbmdlby1sYXllcnRyZWUtc3RhdGUnLCB0cmVlQ3RybCwgZmlyc3RQYXJlbnQpO1xuXG4gICAgICAgICAgICByZXR1cm4gTGF5ZXJ0cmVlVmlzaXRvckRlY2lzaW9uLlNUT1A7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoYXV0aGVudGljYXRpb25SZXF1aXJlZCAmJiBfdGhpczYuZ21mVXNlcl8gJiYgX3RoaXM2LmdtZlVzZXJfLnJvbGVzID09PSBudWxsKSB7XG4gICAgICAgIF90aGlzNi5yb290U2NvcGVfLiRicm9hZGNhc3QoJ2F1dGhlbnRpY2F0aW9ucmVxdWlyZWQnLCB7XG4gICAgICAgICAgdXJsOiBpbml0aWFsVXJpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmhhbmRsZU5nZW9GZWF0dXJlc0FkZF8gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgaWYgKGV2ZW50IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgdmFyIGZlYXR1cmUgPSBldmVudC5lbGVtZW50O1xuXG4gICAgaWYgKCEoZmVhdHVyZSBpbnN0YW5jZW9mIG9sRmVhdHVyZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZmVhdHVyZSB0eXBlJyk7XG4gICAgfVxuXG4gICAgdGhpcy5hZGROZ2VvRmVhdHVyZV8oZmVhdHVyZSk7XG4gIH1cbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmhhbmRsZU5nZW9GZWF0dXJlc1JlbW92ZV8gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgaWYgKGV2ZW50IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgdmFyIGZlYXR1cmUgPSBldmVudC5lbGVtZW50O1xuXG4gICAgaWYgKCEoZmVhdHVyZSBpbnN0YW5jZW9mIG9sRmVhdHVyZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZmVhdHVyZSB0eXBlJyk7XG4gICAgfVxuXG4gICAgdGhpcy5yZW1vdmVOZ2VvRmVhdHVyZV8oZmVhdHVyZSk7XG4gIH1cbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmFkZE5nZW9GZWF0dXJlXyA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHZhciB1aWQgPSBvbFV0aWxHZXRVaWQoZmVhdHVyZSk7XG4gIHRoaXMubmdlb0V2ZW50SGVscGVyXy5hZGRMaXN0ZW5lcktleSh1aWQsIGxpc3RlbihmZWF0dXJlLCAnY2hhbmdlJywgdGhpcy5uZ2VvRGVib3VuY2VfKHRoaXMuaGFuZGxlTmdlb0ZlYXR1cmVzQ2hhbmdlXywgMjUwLCB0cnVlKSwgdGhpcykpO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUucmVtb3ZlTmdlb0ZlYXR1cmVfID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgdmFyIHVpZCA9IG9sVXRpbEdldFVpZChmZWF0dXJlKTtcbiAgdGhpcy5uZ2VvRXZlbnRIZWxwZXJfLmNsZWFyTGlzdGVuZXJLZXkodWlkKTtcbiAgdGhpcy5oYW5kbGVOZ2VvRmVhdHVyZXNDaGFuZ2VfKCk7XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5oYW5kbGVOZ2VvRmVhdHVyZXNDaGFuZ2VfID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMubmdlb0ZlYXR1cmVzXykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBmZWF0dXJlcyA9IHRoaXMubmdlb0ZlYXR1cmVzXy5nZXRBcnJheSgpO1xuICB2YXIgZGF0YSA9IHRoaXMuZmVhdHVyZUhhc2hGb3JtYXRfLndyaXRlRmVhdHVyZXMoZmVhdHVyZXMpO1xuICB2YXIgb2JqZWN0ID0ge307XG4gIG9iamVjdFtQZXJtYWxpbmtQYXJhbS5GRUFUVVJFU10gPSBkYXRhO1xuICB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLnVwZGF0ZVN0YXRlKG9iamVjdCk7XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5nZXRXZnNQZXJtYWxpbmtEYXRhXyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHdmc0xheWVyID0gdGhpcy5uZ2VvTG9jYXRpb25fLmdldFBhcmFtKFBlcm1hbGlua1BhcmFtLldGU19MQVlFUik7XG5cbiAgaWYgKCF3ZnNMYXllcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmFyIG51bUdyb3VwcyA9IHRoaXMubmdlb0xvY2F0aW9uXy5nZXRQYXJhbUFzSW50KFBlcm1hbGlua1BhcmFtLldGU19OR1JPVVBTKTtcbiAgdmFyIHBhcmFtS2V5cyA9IHRoaXMubmdlb0xvY2F0aW9uXy5nZXRQYXJhbUtleXNXaXRoUHJlZml4KFBhcmFtUHJlZml4LldGUyk7XG4gIHZhciBmaWx0ZXJHcm91cHMgPSBbXTtcbiAgdmFyIGZpbHRlckdyb3VwO1xuXG4gIGlmIChudW1Hcm91cHMgPT09IHVuZGVmaW5lZCkge1xuICAgIGZpbHRlckdyb3VwID0gdGhpcy5jcmVhdGVGaWx0ZXJHcm91cF8oUGFyYW1QcmVmaXguV0ZTLCBwYXJhbUtleXMpO1xuXG4gICAgaWYgKGZpbHRlckdyb3VwICE9PSBudWxsKSB7XG4gICAgICBmaWx0ZXJHcm91cHMucHVzaChmaWx0ZXJHcm91cCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtR3JvdXBzOyBpKyspIHtcbiAgICAgIGZpbHRlckdyb3VwID0gdGhpcy5jcmVhdGVGaWx0ZXJHcm91cF8oXCJcIiArIFBhcmFtUHJlZml4LldGUyArIGkgKyBcIl9cIiwgcGFyYW1LZXlzKTtcblxuICAgICAgaWYgKGZpbHRlckdyb3VwICE9PSBudWxsKSB7XG4gICAgICAgIGZpbHRlckdyb3Vwcy5wdXNoKGZpbHRlckdyb3VwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoZmlsdGVyR3JvdXBzLmxlbmd0aCA9PSAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB2YXIgc2hvd0ZlYXR1cmVzUGFyYW0gPSB0aGlzLm5nZW9Mb2NhdGlvbl8uZ2V0UGFyYW0oUGVybWFsaW5rUGFyYW0uV0ZTX1NIT1dfRkVBVFVSRVMpO1xuICB2YXIgc2hvd0ZlYXR1cmVzID0gIShzaG93RmVhdHVyZXNQYXJhbSA9PT0gJzAnIHx8IHNob3dGZWF0dXJlc1BhcmFtID09PSAnZmFsc2UnKTtcbiAgcmV0dXJuIHtcbiAgICB3ZnNUeXBlOiB3ZnNMYXllcixcbiAgICBzaG93RmVhdHVyZXM6IHNob3dGZWF0dXJlcyxcbiAgICBmaWx0ZXJHcm91cHM6IGZpbHRlckdyb3Vwc1xuICB9O1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuY3JlYXRlRmlsdGVyR3JvdXBfID0gZnVuY3Rpb24gKHByZWZpeCwgcGFyYW1LZXlzKSB7XG4gIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gIHZhciBmaWx0ZXJzID0gW107XG4gIHBhcmFtS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbUtleSkge1xuICAgIGlmIChwYXJhbUtleSA9PSBQZXJtYWxpbmtQYXJhbS5XRlNfTEFZRVIgfHwgcGFyYW1LZXkgPT0gUGVybWFsaW5rUGFyYW0uV0ZTX1NIT1dfRkVBVFVSRVMgfHwgcGFyYW1LZXkgPT0gUGVybWFsaW5rUGFyYW0uV0ZTX05HUk9VUFMgfHwgIXBhcmFtS2V5LnN0YXJ0c1dpdGgocHJlZml4KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciB2YWx1ZSA9IF90aGlzNy5uZ2VvTG9jYXRpb25fLmdldFBhcmFtKHBhcmFtS2V5KTtcblxuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgY29uZGl0aW9uID0gdmFsdWUuc3BsaXQoJywnKTtcbiAgICB2YXIgZmlsdGVyID0ge1xuICAgICAgcHJvcGVydHk6IHBhcmFtS2V5LnJlcGxhY2UocHJlZml4LCAnJyksXG4gICAgICBjb25kaXRpb246IGNvbmRpdGlvblxuICAgIH07XG4gICAgZmlsdGVycy5wdXNoKGZpbHRlcik7XG4gIH0pO1xuICByZXR1cm4gZmlsdGVycy5sZW5ndGggPiAwID8ge1xuICAgIGZpbHRlcnM6IGZpbHRlcnNcbiAgfSA6IG51bGw7XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5pbml0RXh0ZXJuYWxEYXRhU291cmNlc18gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczggPSB0aGlzO1xuXG4gIGlmICghdGhpcy5uZ2VvUXVlcmVudF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgbmdlb1F1ZXJlbnQnKTtcbiAgfVxuXG4gIGlmICghdGhpcy5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcl8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ21mRXh0ZXJuYWxEYXRhU291cmNlc01hbmFnZXInKTtcbiAgfVxuXG4gIHZhciBuZ2VvUXVlcmVudCA9IHRoaXMubmdlb1F1ZXJlbnRfO1xuICB2YXIgZ21mRXh0RFNNYW5hZ2VyID0gdGhpcy5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcl87XG4gIHZhciBwcm9taXNlcyA9IFtdO1xuICB2YXIgbGF5ZXJOYW1lc1N0cmluZyA9IHRoaXMubmdlb1N0YXRlTWFuYWdlcl8uZ2V0SW5pdGlhbFN0cmluZ1ZhbHVlKFBlcm1hbGlua1BhcmFtLkVYVEVSTkFMX0RBVEFTT1VSQ0VTX05BTUVTKTtcbiAgdmFyIHVybHNTdHJpbmcgPSB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLmdldEluaXRpYWxTdHJpbmdWYWx1ZShQZXJtYWxpbmtQYXJhbS5FWFRFUk5BTF9EQVRBU09VUkNFU19VUkxTKTtcblxuICBpZiAobGF5ZXJOYW1lc1N0cmluZyAmJiB1cmxzU3RyaW5nKSB7XG4gICAgdmFyIGxheWVyTmFtZXMgPSBsYXllck5hbWVzU3RyaW5nLnNwbGl0KEV4dERTU2VwYXJhdG9yLkxJU1QpO1xuICAgIHZhciB1cmxzID0gdXJsc1N0cmluZy5zcGxpdChFeHREU1NlcGFyYXRvci5MSVNUKTtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGksIGlpKSB7XG4gICAgICB2YXIgZ3JvdXBMYXllck5hbWVzU3RyaW5nID0gbGF5ZXJOYW1lc1tpXTtcblxuICAgICAgaWYgKCFncm91cExheWVyTmFtZXNTdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIFwiYnJlYWtcIjtcbiAgICAgIH1cblxuICAgICAgdmFyIGdyb3VwTGF5ZXJOYW1lcyA9IGdyb3VwTGF5ZXJOYW1lc1N0cmluZy5zcGxpdChFeHREU1NlcGFyYXRvci5OQU1FUyk7XG4gICAgICB2YXIgdXJsID0gdXJsc1tpXTtcbiAgICAgIHZhciBzZXJ2aWNlVHlwZSA9IGd1ZXNzU2VydmljZVR5cGVCeVVybCh1cmwpO1xuXG4gICAgICB2YXIgZ2V0Q2FwYWJpbGl0aWVzRGVmZXIgPSBfdGhpczgucV8uZGVmZXIoKTtcblxuICAgICAgcHJvbWlzZXMucHVzaChnZXRDYXBhYmlsaXRpZXNEZWZlci5wcm9taXNlKTtcblxuICAgICAgaWYgKHNlcnZpY2VUeXBlID09PSBUeXBlLldNUykge1xuICAgICAgICBuZ2VvUXVlcmVudC53bXNHZXRDYXBhYmlsaXRpZXModXJsKS50aGVuKGZ1bmN0aW9uIChjYXBhYmlsaXRpZXMpIHtcbiAgICAgICAgICBnZXRDYXBhYmlsaXRpZXNEZWZlci5yZXNvbHZlKHtcbiAgICAgICAgICAgIGNhcGFiaWxpdGllczogY2FwYWJpbGl0aWVzLFxuICAgICAgICAgICAgZ3JvdXBMYXllck5hbWVzOiBncm91cExheWVyTmFtZXMsXG4gICAgICAgICAgICBzZXJ2aWNlVHlwZTogc2VydmljZVR5cGUsXG4gICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgIH0pO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZ2V0Q2FwYWJpbGl0aWVzRGVmZXIucmVqZWN0KHtcbiAgICAgICAgICAgIGdyb3VwTGF5ZXJOYW1lczogZ3JvdXBMYXllck5hbWVzLFxuICAgICAgICAgICAgc2VydmljZVR5cGU6IHNlcnZpY2VUeXBlLFxuICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKHNlcnZpY2VUeXBlID09PSBUeXBlLldNVFMpIHtcbiAgICAgICAgbmdlb1F1ZXJlbnQud210c0dldENhcGFiaWxpdGllcyh1cmwpLnRoZW4oZnVuY3Rpb24gKGNhcGFiaWxpdGllcykge1xuICAgICAgICAgIGdldENhcGFiaWxpdGllc0RlZmVyLnJlc29sdmUoe1xuICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBjYXBhYmlsaXRpZXMsXG4gICAgICAgICAgICBncm91cExheWVyTmFtZXM6IGdyb3VwTGF5ZXJOYW1lcyxcbiAgICAgICAgICAgIHNlcnZpY2VUeXBlOiBzZXJ2aWNlVHlwZSxcbiAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBnZXRDYXBhYmlsaXRpZXNEZWZlci5yZWplY3Qoe1xuICAgICAgICAgICAgZ3JvdXBMYXllck5hbWVzOiBncm91cExheWVyTmFtZXMsXG4gICAgICAgICAgICBzZXJ2aWNlVHlwZTogc2VydmljZVR5cGUsXG4gICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdldENhcGFiaWxpdGllc0RlZmVyLnJlamVjdCh7XG4gICAgICAgICAgZ3JvdXBMYXllck5hbWVzOiBncm91cExheWVyTmFtZXMsXG4gICAgICAgICAgc2VydmljZVR5cGU6IHNlcnZpY2VUeXBlLFxuICAgICAgICAgIHVybDogdXJsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB1cmxzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgIHZhciBfcmV0ID0gX2xvb3AoaSwgaWkpO1xuXG4gICAgICBpZiAoX3JldCA9PT0gXCJicmVha1wiKSBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcy5xXy5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlcykge1xuICAgIGZvciAodmFyIF9pdGVyYXRvcjUgPSByZXNwb25zZXMsIF9pc0FycmF5NSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNSksIF9pNSA9IDAsIF9pdGVyYXRvcjUgPSBfaXNBcnJheTUgPyBfaXRlcmF0b3I1IDogX2l0ZXJhdG9yNVtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY1O1xuXG4gICAgICBpZiAoX2lzQXJyYXk1KSB7XG4gICAgICAgIGlmIChfaTUgPj0gX2l0ZXJhdG9yNS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmNSA9IF9pdGVyYXRvcjVbX2k1KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k1ID0gX2l0ZXJhdG9yNS5uZXh0KCk7XG4gICAgICAgIGlmIChfaTUuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWY1ID0gX2k1LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVzcG9uc2UgPSBfcmVmNTtcblxuICAgICAgaWYgKHJlc3BvbnNlLnNlcnZpY2VUeXBlID09PSBUeXBlLldNUykge1xuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3I2ID0gcmVzcG9uc2UuZ3JvdXBMYXllck5hbWVzLCBfaXNBcnJheTYgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjYpLCBfaTYgPSAwLCBfaXRlcmF0b3I2ID0gX2lzQXJyYXk2ID8gX2l0ZXJhdG9yNiA6IF9pdGVyYXRvcjZbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgICB2YXIgX3JlZjY7XG5cbiAgICAgICAgICBpZiAoX2lzQXJyYXk2KSB7XG4gICAgICAgICAgICBpZiAoX2k2ID49IF9pdGVyYXRvcjYubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICAgIF9yZWY2ID0gX2l0ZXJhdG9yNltfaTYrK107XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9pNiA9IF9pdGVyYXRvcjYubmV4dCgpO1xuICAgICAgICAgICAgaWYgKF9pNi5kb25lKSBicmVhaztcbiAgICAgICAgICAgIF9yZWY2ID0gX2k2LnZhbHVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBsYXllck5hbWUgPSBfcmVmNjtcbiAgICAgICAgICB2YXIgbGF5ZXJDYXAgPSBuZ2VvUXVlcmVudC53bXNGaW5kTGF5ZXJDYXBhYmlsaXR5KHJlc3BvbnNlLmNhcGFiaWxpdGllcy5DYXBhYmlsaXR5LkxheWVyLkxheWVyLCBsYXllck5hbWUpO1xuXG4gICAgICAgICAgaWYgKGxheWVyQ2FwKSB7XG4gICAgICAgICAgICBnbWZFeHREU01hbmFnZXIuY3JlYXRlQW5kQWRkRGF0YVNvdXJjZUZyb21XTVNDYXBhYmlsaXR5KGxheWVyQ2FwLCByZXNwb25zZS5jYXBhYmlsaXRpZXMsIHJlc3BvbnNlLnVybCk7XG4gICAgICAgICAgfSBlbHNlIHt9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc2VydmljZVR5cGUgPT09IFR5cGUuV01UUykge1xuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3I3ID0gcmVzcG9uc2UuZ3JvdXBMYXllck5hbWVzLCBfaXNBcnJheTcgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjcpLCBfaTcgPSAwLCBfaXRlcmF0b3I3ID0gX2lzQXJyYXk3ID8gX2l0ZXJhdG9yNyA6IF9pdGVyYXRvcjdbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgICB2YXIgX3JlZjc7XG5cbiAgICAgICAgICBpZiAoX2lzQXJyYXk3KSB7XG4gICAgICAgICAgICBpZiAoX2k3ID49IF9pdGVyYXRvcjcubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICAgIF9yZWY3ID0gX2l0ZXJhdG9yN1tfaTcrK107XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9pNyA9IF9pdGVyYXRvcjcubmV4dCgpO1xuICAgICAgICAgICAgaWYgKF9pNy5kb25lKSBicmVhaztcbiAgICAgICAgICAgIF9yZWY3ID0gX2k3LnZhbHVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBfbGF5ZXJOYW1lID0gX3JlZjc7XG5cbiAgICAgICAgICB2YXIgX2xheWVyQ2FwID0gbmdlb1F1ZXJlbnQud210c0ZpbmRMYXllckNhcGFiaWxpdHkocmVzcG9uc2UuY2FwYWJpbGl0aWVzLkNvbnRlbnRzLkxheWVyLCBfbGF5ZXJOYW1lKTtcblxuICAgICAgICAgIGlmIChfbGF5ZXJDYXApIHtcbiAgICAgICAgICAgIGdtZkV4dERTTWFuYWdlci5jcmVhdGVBbmRBZGREYXRhU291cmNlRnJvbVdNVFNDYXBhYmlsaXR5KF9sYXllckNhcCwgcmVzcG9uc2UuY2FwYWJpbGl0aWVzLCByZXNwb25zZS51cmwpO1xuICAgICAgICAgIH0gZWxzZSB7fVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCBmdW5jdGlvbiAocmVqZWN0aW9ucykge30pO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuaGFuZGxlRXh0ZXJuYWxEU0dyb3VwQ29sbGVjdGlvbkFkZF8gPSBmdW5jdGlvbiAoZXZ0KSB7XG4gIGlmIChldnQgaW5zdGFuY2VvZiBDb2xsZWN0aW9uRXZlbnQpIHtcbiAgICB2YXIgZ3JvdXAgPSBldnQuZWxlbWVudDtcblxuICAgIGlmICghKGdyb3VwIGluc3RhbmNlb2Ygbmdlb0RhdGFzb3VyY2VHcm91cCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZ3JvdXAgdHlwZScpO1xuICAgIH1cblxuICAgIHRoaXMucmVnaXN0ZXJFeHRlcm5hbERTR3JvdXBfKGdyb3VwKTtcbiAgICB0aGlzLnNldEV4dGVybmFsRGF0YVNvdXJjZXNTdGF0ZV8oKTtcbiAgfVxufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUucmVnaXN0ZXJFeHRlcm5hbERTR3JvdXBfID0gZnVuY3Rpb24gKGdyb3VwKSB7XG4gIHRoaXMubGlzdGVuZXJLZXlzXy5wdXNoKGxpc3Rlbihncm91cC5kYXRhU291cmNlc0NvbGxlY3Rpb24sICdhZGQnLCB0aGlzLnNldEV4dGVybmFsRGF0YVNvdXJjZXNTdGF0ZV8sIHRoaXMpLCBsaXN0ZW4oZ3JvdXAuZGF0YVNvdXJjZXNDb2xsZWN0aW9uLCAncmVtb3ZlJywgdGhpcy5zZXRFeHRlcm5hbERhdGFTb3VyY2VzU3RhdGVfLCB0aGlzKSk7XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5jb250YWluc0xheWVyTmFtZSA9IGZ1bmN0aW9uIChsYXllciwgbmFtZSkge1xuICBpZiAobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyR3JvdXApIHtcbiAgICBmb3IgKHZhciBfaXRlcmF0b3I4ID0gbGF5ZXIuZ2V0TGF5ZXJzKCkuZ2V0QXJyYXkoKSwgX2lzQXJyYXk4ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I4KSwgX2k4ID0gMCwgX2l0ZXJhdG9yOCA9IF9pc0FycmF5OCA/IF9pdGVyYXRvcjggOiBfaXRlcmF0b3I4W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjg7XG5cbiAgICAgIGlmIChfaXNBcnJheTgpIHtcbiAgICAgICAgaWYgKF9pOCA+PSBfaXRlcmF0b3I4Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWY4ID0gX2l0ZXJhdG9yOFtfaTgrK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaTggPSBfaXRlcmF0b3I4Lm5leHQoKTtcbiAgICAgICAgaWYgKF9pOC5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZjggPSBfaTgudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBsID0gX3JlZjg7XG5cbiAgICAgIGlmICghbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbGF5ZXInKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuY29udGFpbnNMYXllck5hbWUobCwgbmFtZSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBsYXllci5nZXQoJ2xheWVyTm9kZU5hbWUnKSA9PSBuYW1lO1xuICB9XG59O1xuXG5QZXJtYWxpbmtTZXJ2aWNlLnByb3RvdHlwZS5oYW5kbGVFeHRlcm5hbERTR3JvdXBDb2xsZWN0aW9uUmVtb3ZlXyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgIHZhciBncm91cCA9IGV2dC5lbGVtZW50O1xuXG4gICAgaWYgKCEoZ3JvdXAgaW5zdGFuY2VvZiBuZ2VvRGF0YXNvdXJjZUdyb3VwKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBncm91cCB0eXBlJyk7XG4gICAgfVxuXG4gICAgdGhpcy51bnJlZ2lzdGVyRXh0ZXJuYWxEU0dyb3VwXyhncm91cCk7XG4gICAgdGhpcy5zZXRFeHRlcm5hbERhdGFTb3VyY2VzU3RhdGVfKCk7XG4gIH1cbn07XG5cblBlcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLnVucmVnaXN0ZXJFeHRlcm5hbERTR3JvdXBfID0gZnVuY3Rpb24gKGdyb3VwKSB7XG4gIHRoaXMubGlzdGVuZXJLZXlzXy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuc2V0RXh0ZXJuYWxEYXRhU291cmNlc1N0YXRlXyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgaWYgKHRoaXMuc2V0RXh0ZXJuYWxEYXRhU291cmNlc1N0YXRlUHJvbWlzZV8pIHtcbiAgICB0aGlzLiR0aW1lb3V0Xy5jYW5jZWwodGhpcy5zZXRFeHRlcm5hbERhdGFTb3VyY2VzU3RhdGVQcm9taXNlXyk7XG4gIH1cblxuICB0aGlzLnNldEV4dGVybmFsRGF0YVNvdXJjZXNTdGF0ZVByb21pc2VfID0gdGhpcy4kdGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgIHZhciBfdGhpczkkbmdlb1N0YXRlTWFuYWc7XG5cbiAgICBpZiAoIV90aGlzOS5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcl8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcicpO1xuICAgIH1cblxuICAgIHZhciBuYW1lcyA9IFtdO1xuICAgIHZhciB1cmxzID0gW107XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3I5ID0gX3RoaXM5LmdtZkV4dGVybmFsRGF0YVNvdXJjZXNNYW5hZ2VyXy53bXNHcm91cHMsIF9pc0FycmF5OSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yOSksIF9pOSA9IDAsIF9pdGVyYXRvcjkgPSBfaXNBcnJheTkgPyBfaXRlcmF0b3I5IDogX2l0ZXJhdG9yOVtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY5O1xuXG4gICAgICBpZiAoX2lzQXJyYXk5KSB7XG4gICAgICAgIGlmIChfaTkgPj0gX2l0ZXJhdG9yOS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmOSA9IF9pdGVyYXRvcjlbX2k5KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k5ID0gX2l0ZXJhdG9yOS5uZXh0KCk7XG4gICAgICAgIGlmIChfaTkuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWY5ID0gX2k5LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgd21zR3JvdXAgPSBfcmVmOTtcbiAgICAgIHVybHMucHVzaCh3bXNHcm91cC51cmwpO1xuICAgICAgdmFyIHdtc0dyb3VwTGF5ZXJOYW1lcyA9IFtdO1xuXG4gICAgICBmb3IgKHZhciBfaXRlcmF0b3IxMSA9IHdtc0dyb3VwLmRhdGFTb3VyY2VzLCBfaXNBcnJheTExID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IxMSksIF9pMTEgPSAwLCBfaXRlcmF0b3IxMSA9IF9pc0FycmF5MTEgPyBfaXRlcmF0b3IxMSA6IF9pdGVyYXRvcjExW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgIHZhciBfcmVmMTE7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5MTEpIHtcbiAgICAgICAgICBpZiAoX2kxMSA+PSBfaXRlcmF0b3IxMS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWYxMSA9IF9pdGVyYXRvcjExW19pMTErK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2kxMSA9IF9pdGVyYXRvcjExLm5leHQoKTtcbiAgICAgICAgICBpZiAoX2kxMS5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmMTEgPSBfaTExLnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHdtc0RhdGFTb3VyY2UgPSBfcmVmMTE7XG5cbiAgICAgICAgaWYgKHdtc0RhdGFTb3VyY2UgaW5zdGFuY2VvZiBuZ2VvRGF0YXNvdXJjZU9HQykge1xuICAgICAgICAgIHZhciBsYXllck5hbWUgPSB3bXNEYXRhU291cmNlLmdldFdGU0xheWVyTmFtZXMoKVswXTtcbiAgICAgICAgICB3bXNHcm91cExheWVyTmFtZXMucHVzaChsYXllck5hbWUpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIG5hbWVzLnB1c2god21zR3JvdXBMYXllck5hbWVzLmpvaW4oRXh0RFNTZXBhcmF0b3IuTkFNRVMpKTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IxMCA9IF90aGlzOS5nbWZFeHRlcm5hbERhdGFTb3VyY2VzTWFuYWdlcl8ud210c0dyb3VwcywgX2lzQXJyYXkxMCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMTApLCBfaTEwID0gMCwgX2l0ZXJhdG9yMTAgPSBfaXNBcnJheTEwID8gX2l0ZXJhdG9yMTAgOiBfaXRlcmF0b3IxMFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYxMDtcblxuICAgICAgaWYgKF9pc0FycmF5MTApIHtcbiAgICAgICAgaWYgKF9pMTAgPj0gX2l0ZXJhdG9yMTAubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZjEwID0gX2l0ZXJhdG9yMTBbX2kxMCsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pMTAgPSBfaXRlcmF0b3IxMC5uZXh0KCk7XG4gICAgICAgIGlmIChfaTEwLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmMTAgPSBfaTEwLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgd210c0dyb3VwID0gX3JlZjEwO1xuICAgICAgdXJscy5wdXNoKHdtdHNHcm91cC51cmwpO1xuICAgICAgdmFyIHdtdHNHcm91cExheWVyTmFtZXMgPSBbXTtcblxuICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMTIgPSB3bXRzR3JvdXAuZGF0YVNvdXJjZXMsIF9pc0FycmF5MTIgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjEyKSwgX2kxMiA9IDAsIF9pdGVyYXRvcjEyID0gX2lzQXJyYXkxMiA/IF9pdGVyYXRvcjEyIDogX2l0ZXJhdG9yMTJbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgdmFyIF9yZWYxMjtcblxuICAgICAgICBpZiAoX2lzQXJyYXkxMikge1xuICAgICAgICAgIGlmIChfaTEyID49IF9pdGVyYXRvcjEyLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgX3JlZjEyID0gX2l0ZXJhdG9yMTJbX2kxMisrXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfaTEyID0gX2l0ZXJhdG9yMTIubmV4dCgpO1xuICAgICAgICAgIGlmIChfaTEyLmRvbmUpIGJyZWFrO1xuICAgICAgICAgIF9yZWYxMiA9IF9pMTIudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd210c0RhdGFTb3VyY2UgPSBfcmVmMTI7XG5cbiAgICAgICAgaWYgKCF3bXRzRGF0YVNvdXJjZS53bXRzTGF5ZXIpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgd210c0RhdGFTb3VyY2Uud210c0xheWVyJyk7XG4gICAgICAgIH1cblxuICAgICAgICB3bXRzR3JvdXBMYXllck5hbWVzLnB1c2god210c0RhdGFTb3VyY2Uud210c0xheWVyKTtcbiAgICAgIH1cblxuICAgICAgbmFtZXMucHVzaCh3bXRzR3JvdXBMYXllck5hbWVzLmpvaW4oRXh0RFNTZXBhcmF0b3IuTkFNRVMpKTtcbiAgICB9XG5cbiAgICBfdGhpczkubmdlb1N0YXRlTWFuYWdlcl8udXBkYXRlU3RhdGUoKF90aGlzOSRuZ2VvU3RhdGVNYW5hZyA9IHt9LCBfdGhpczkkbmdlb1N0YXRlTWFuYWdbUGVybWFsaW5rUGFyYW0uRVhURVJOQUxfREFUQVNPVVJDRVNfTkFNRVNdID0gbmFtZXMuam9pbihFeHREU1NlcGFyYXRvci5MSVNUKSwgX3RoaXM5JG5nZW9TdGF0ZU1hbmFnW1Blcm1hbGlua1BhcmFtLkVYVEVSTkFMX0RBVEFTT1VSQ0VTX1VSTFNdID0gdXJscy5qb2luKEV4dERTU2VwYXJhdG9yLkxJU1QpLCBfdGhpczkkbmdlb1N0YXRlTWFuYWcpKTtcblxuICAgIF90aGlzOS5zZXRFeHRlcm5hbERhdGFTb3VyY2VzU3RhdGVQcm9taXNlXyA9IG51bGw7XG4gIH0pO1xufTtcblxuUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuY2xlYW5QYXJhbXMgPSBmdW5jdGlvbiAoZ3JvdXBzKSB7XG4gIHZhciBfdGhpczEwID0gdGhpcztcblxuICB2YXIga2V5cyA9IHRoaXMubmdlb0xvY2F0aW9uXy5nZXRQYXJhbUtleXMoKTtcblxuICBmb3IgKHZhciBfaXRlcmF0b3IxMyA9IGtleXMsIF9pc0FycmF5MTMgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjEzKSwgX2kxMyA9IDAsIF9pdGVyYXRvcjEzID0gX2lzQXJyYXkxMyA/IF9pdGVyYXRvcjEzIDogX2l0ZXJhdG9yMTNbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICB2YXIgX3JlZjEzO1xuXG4gICAgaWYgKF9pc0FycmF5MTMpIHtcbiAgICAgIGlmIChfaTEzID49IF9pdGVyYXRvcjEzLmxlbmd0aCkgYnJlYWs7XG4gICAgICBfcmVmMTMgPSBfaXRlcmF0b3IxM1tfaTEzKytdO1xuICAgIH0gZWxzZSB7XG4gICAgICBfaTEzID0gX2l0ZXJhdG9yMTMubmV4dCgpO1xuICAgICAgaWYgKF9pMTMuZG9uZSkgYnJlYWs7XG4gICAgICBfcmVmMTMgPSBfaTEzLnZhbHVlO1xuICAgIH1cblxuICAgIHZhciBrZXkgPSBfcmVmMTM7XG5cbiAgICBpZiAoa2V5LnN0YXJ0c1dpdGgoUGFyYW1QcmVmaXguVFJFRV9HUk9VUF9MQVlFUlMpKSB7XG4gICAgICB2YXIgdmFsdWUgPSBrZXkuc3Vic3RyaW5nKFBhcmFtUHJlZml4LlRSRUVfR1JPVVBfTEFZRVJTLmxlbmd0aCk7XG5cbiAgICAgIGZvciAodmFyIF9pdGVyYXRvcjE1ID0gZ3JvdXBzLCBfaXNBcnJheTE1ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IxNSksIF9pMTUgPSAwLCBfaXRlcmF0b3IxNSA9IF9pc0FycmF5MTUgPyBfaXRlcmF0b3IxNSA6IF9pdGVyYXRvcjE1W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgIHZhciBfcmVmMTU7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5MTUpIHtcbiAgICAgICAgICBpZiAoX2kxNSA+PSBfaXRlcmF0b3IxNS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWYxNSA9IF9pdGVyYXRvcjE1W19pMTUrK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2kxNSA9IF9pdGVyYXRvcjE1Lm5leHQoKTtcbiAgICAgICAgICBpZiAoX2kxNS5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmMTUgPSBfaTE1LnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGdyb3VwID0gX3JlZjE1O1xuXG4gICAgICAgIGlmIChncm91cC5uYW1lID09IHZhbHVlKSB7XG4gICAgICAgICAgdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy5kZWxldGVQYXJhbShrZXkpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGtleS5zdGFydHNXaXRoKFBhcmFtUHJlZml4LlRSRUVfR1JPVVBfT1BBQ0lUWSkpIHtcbiAgICAgIHZhciBfdmFsdWUyID0ga2V5LnN1YnN0cmluZyhQYXJhbVByZWZpeC5UUkVFX0dST1VQX09QQUNJVFkubGVuZ3RoKTtcblxuICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMTYgPSBncm91cHMsIF9pc0FycmF5MTYgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjE2KSwgX2kxNiA9IDAsIF9pdGVyYXRvcjE2ID0gX2lzQXJyYXkxNiA/IF9pdGVyYXRvcjE2IDogX2l0ZXJhdG9yMTZbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgdmFyIF9yZWYxNjtcblxuICAgICAgICBpZiAoX2lzQXJyYXkxNikge1xuICAgICAgICAgIGlmIChfaTE2ID49IF9pdGVyYXRvcjE2Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgX3JlZjE2ID0gX2l0ZXJhdG9yMTZbX2kxNisrXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfaTE2ID0gX2l0ZXJhdG9yMTYubmV4dCgpO1xuICAgICAgICAgIGlmIChfaTE2LmRvbmUpIGJyZWFrO1xuICAgICAgICAgIF9yZWYxNiA9IF9pMTYudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX2dyb3VwID0gX3JlZjE2O1xuXG4gICAgICAgIGlmIChfZ3JvdXAubmFtZSA9PSBfdmFsdWUyKSB7XG4gICAgICAgICAgdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXy5kZWxldGVQYXJhbShrZXkpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdGhpcy4kdGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgIGlmICghX3RoaXMxMC5tYXBfKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGxheWVyID0gX3RoaXMxMC5tYXBfLmdldExheWVyR3JvdXAoKTtcblxuICAgIGlmICghbGF5ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsYXllcicpO1xuICAgIH1cblxuICAgIGZvciAodmFyIF9pdGVyYXRvcjE0ID0ga2V5cywgX2lzQXJyYXkxNCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMTQpLCBfaTE0ID0gMCwgX2l0ZXJhdG9yMTQgPSBfaXNBcnJheTE0ID8gX2l0ZXJhdG9yMTQgOiBfaXRlcmF0b3IxNFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYxNDtcblxuICAgICAgaWYgKF9pc0FycmF5MTQpIHtcbiAgICAgICAgaWYgKF9pMTQgPj0gX2l0ZXJhdG9yMTQubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZjE0ID0gX2l0ZXJhdG9yMTRbX2kxNCsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pMTQgPSBfaXRlcmF0b3IxNC5uZXh0KCk7XG4gICAgICAgIGlmIChfaTE0LmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmMTQgPSBfaTE0LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIga2V5ID0gX3JlZjE0O1xuXG4gICAgICBpZiAoa2V5LnN0YXJ0c1dpdGgoUGFyYW1QcmVmaXguVFJFRV9FTkFCTEUpKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGtleS5zdWJzdHJpbmcoUGFyYW1QcmVmaXguVFJFRV9FTkFCTEUubGVuZ3RoKTtcblxuICAgICAgICBpZiAoIV90aGlzMTAuY29udGFpbnNMYXllck5hbWUobGF5ZXIsIHZhbHVlKSkge1xuICAgICAgICAgIF90aGlzMTAubmdlb1N0YXRlTWFuYWdlcl8uZGVsZXRlUGFyYW0oa2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoa2V5LnN0YXJ0c1dpdGgoUGFyYW1QcmVmaXguVFJFRV9PUEFDSVRZKSkge1xuICAgICAgICB2YXIgX3ZhbHVlID0ga2V5LnN1YnN0cmluZyhQYXJhbVByZWZpeC5UUkVFX09QQUNJVFkubGVuZ3RoKTtcblxuICAgICAgICBpZiAoIV90aGlzMTAuY29udGFpbnNMYXllck5hbWUobGF5ZXIsIF92YWx1ZSkpIHtcbiAgICAgICAgICBfdGhpczEwLm5nZW9TdGF0ZU1hbmFnZXJfLmRlbGV0ZVBhcmFtKGtleSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZQZXJtYWxpbmsnLCBbZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlLm5hbWUsIGdtZlRoZW1lTWFuYWdlci5uYW1lLCBnbWZUaGVtZVRoZW1lcy5uYW1lLCBuZ2VvRHJhd0ZlYXR1cmVzLm5hbWUsIGdtZkxheWVyQmVpbmdTd2lwZS5uYW1lLCBuZ2VvTGF5ZXJ0cmVlQ29udHJvbGxlci5uYW1lLCBuZ2VvTWlzY0RlYm91bmNlLm5hbWUsIG5nZW9NaXNjRXZlbnRIZWxwZXIubmFtZSwgbmdlb1N0YXRlbWFuYWdlck1vZHVsZS5uYW1lXSk7XG5tb2R1bGUuc2VydmljZSgnZ21mUGVybWFsaW5rJywgUGVybWFsaW5rU2VydmljZSk7XG5tb2R1bGUudmFsdWUoJ2dtZlBlcm1hbGlua09wdGlvbnMnLCB7fSk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciByZWdleHAgPSBbXTtcblxuICBmb3IgKHZhciBrZXkxIGluIFBhcmFtUHJlZml4KSB7XG4gICAgcmVnZXhwLnB1c2gobmV3IFJlZ0V4cChQYXJhbVByZWZpeFtrZXkxXSArIFwiLipcIikpO1xuICB9XG5cbiAgZm9yICh2YXIga2V5MiBpbiBQZXJtYWxpbmtQYXJhbSkge1xuICAgIHJlZ2V4cC5wdXNoKG5ldyBSZWdFeHAoUGFyYW1QcmVmaXhba2V5Ml0pKTtcbiAgfVxuXG4gIG5nZW9TdGF0ZW1hbmFnZXJTZXJ2aWNlLnZhbHVlKCduZ2VvVXNlZEtleVJlZ2V4cCcsIHJlZ2V4cCk7XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiUGVybWFsaW5rU2hhcmVTZXJ2aWNlLiRpbmplY3QgPSBbXCIkaHR0cFwiLCBcImdtZlNob3J0ZW5lckNyZWF0ZVVybFwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuZXhwb3J0IGZ1bmN0aW9uIFBlcm1hbGlua1NoYXJlU2VydmljZSgkaHR0cCwgZ21mU2hvcnRlbmVyQ3JlYXRlVXJsKSB7XG4gIHRoaXMuJGh0dHBfID0gJGh0dHA7XG4gIHRoaXMuZ21mU2hvcnRlbmVyQ3JlYXRlVXJsXyA9IGdtZlNob3J0ZW5lckNyZWF0ZVVybDtcbn1cblxuUGVybWFsaW5rU2hhcmVTZXJ2aWNlLnByb3RvdHlwZS5nZXRTaG9ydFVybCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgdmFyIHBhcmFtcyA9IHtcbiAgICB1cmw6IHVybFxuICB9O1xuXG4gIGlmICghdGhpcy5nbWZTaG9ydGVuZXJDcmVhdGVVcmxfKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc2hvcnRfdXJsOiB1cmxcbiAgICAgIH0sXG4gICAgICBzdGF0dXM6IDIwMFxuICAgIH07XG4gIH1cblxuICByZXR1cm4gdGhpcy5wb3N0U2hvcnRVcmxfKHBhcmFtcyk7XG59O1xuXG5QZXJtYWxpbmtTaGFyZVNlcnZpY2UucHJvdG90eXBlLnNlbmRTaG9ydFVybCA9IGZ1bmN0aW9uIChzaG9ydFVybCwgZW1haWwsIG9wdF9tZXNzYWdlKSB7XG4gIHZhciBwYXJhbXMgPSB7XG4gICAgdXJsOiBzaG9ydFVybCxcbiAgICBlbWFpbDogZW1haWxcbiAgfTtcblxuICBpZiAob3B0X21lc3NhZ2UpIHtcbiAgICBwYXJhbXNbJ21lc3NhZ2UnXSA9IG9wdF9tZXNzYWdlO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMucG9zdFNob3J0VXJsXyhwYXJhbXMpO1xufTtcblxuUGVybWFsaW5rU2hhcmVTZXJ2aWNlLnByb3RvdHlwZS5wb3N0U2hvcnRVcmxfID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICByZXR1cm4gdGhpcy4kaHR0cF8ucG9zdCh0aGlzLmdtZlNob3J0ZW5lckNyZWF0ZVVybF8sICQucGFyYW0ocGFyYW1zKSwge1xuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ1xuICAgIH1cbiAgfSk7XG59O1xuXG5leHBvcnQgdmFyIFVSTF9NQVhfTEVOID0gMjA4MztcbmV4cG9ydCB2YXIgVVJMX1BBVEhfTUFYX0xFTiA9IDIwNDg7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZlNoYXJlU2VydmljZScsIFtdKTtcbm1vZHVsZS5zZXJ2aWNlKCdnbWZTaGFyZVNlcnZpY2UnLCBQZXJtYWxpbmtTaGFyZVNlcnZpY2UpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgd2lkdGg9XFxcIjIyXFxcIiBoZWlnaHQ9XFxcIjIyXFxcIj48cGF0aCBzdHlsZT1cXFwibGluZS1oZWlnaHQ6bm9ybWFsO3RleHQtaW5kZW50OjA7dGV4dC1hbGlnbjpzdGFydDt0ZXh0LWRlY29yYXRpb24tbGluZTpub25lO3RleHQtZGVjb3JhdGlvbi1zdHlsZTpzb2xpZDt0ZXh0LWRlY29yYXRpb24tY29sb3I6IzAwMDt0ZXh0LXRyYW5zZm9ybTpub25lO2Jsb2NrLXByb2dyZXNzaW9uOnRiO3doaXRlLXNwYWNlOm5vcm1hbDtpc29sYXRpb246YXV0bzttaXgtYmxlbmQtbW9kZTpub3JtYWw7c29saWQtY29sb3I6IzAwMDtzb2xpZC1vcGFjaXR5OjFcXFwiIGQ9XFxcIk0xMC45NjMuNDEzQTIuNSAyLjUgMCAwMDguNSAyLjk0OHY1LjU1SDIuOTVhMi41IDIuNSAwIDEwMCA1SDguNXY1LjU1NGEyLjUgMi41IDAgMTA1IDB2LTUuNTUzaDUuNTVhMi41IDIuNSAwIDEwMC01SDEzLjV2LTUuNTVBMi41IDIuNSAwIDAwMTAuOTYzLjQxMnpcXFwiIGNvbG9yPVxcXCIjMDAwXFxcIiBmb250LXdlaWdodD1cXFwiNDAwXFxcIiBmb250LWZhbWlseT1cXFwic2Fucy1zZXJpZlxcXCIgb3ZlcmZsb3c9XFxcInZpc2libGVcXFwiIGZpbGw9XFxcIiNmZmZcXFwiIGZpbGwtb3BhY2l0eT1cXFwiLjhcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCI+PC9wYXRoPjxwYXRoIGQ9XFxcIk0xMSAyLjk0OVYxOS4wNU0xOS4wNTEgMTFIMi45NVxcXCIgZmlsbD1cXFwibm9uZVxcXCIgc3Ryb2tlPVxcXCJyZWRcXFwiIHN0cm9rZS13aWR0aD1cXFwiMlxcXCIgc3Ryb2tlLWxpbmVjYXA9XFxcInJvdW5kXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZQZXJtYWxpbmtQZXJtYWxpbmsgZnJvbSAnZ21mL3Blcm1hbGluay9QZXJtYWxpbmsuanMnO1xuaW1wb3J0IGdtZlBlcm1hbGlua1NoYXJlU2VydmljZSBmcm9tICdnbWYvcGVybWFsaW5rL1NoYXJlU2VydmljZS5qcyc7XG5pbXBvcnQgZ21mUGVybWFsaW5rU2hhcmVDb21wb25lbnQgZnJvbSAnZ21mL3Blcm1hbGluay9zaGFyZUNvbXBvbmVudC5qcyc7XG5pbXBvcnQgJy4vc2hhcmUuc2Nzcyc7XG5leHBvcnQgZGVmYXVsdCBhbmd1bGFyLm1vZHVsZSgnZ21mUGVybWFsaW5rTW9kdWxlJywgW2dtZlBlcm1hbGlua1Blcm1hbGluay5uYW1lLCBnbWZQZXJtYWxpbmtTaGFyZVNlcnZpY2UubmFtZSwgZ21mUGVybWFsaW5rU2hhcmVDb21wb25lbnQubmFtZV0pOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXIgdWktZHJhZ2dhYmxlLWhhbmRsZVwiPlxcbiAgPGg0IGNsYXNzPVwibW9kYWwtdGl0bGVcIiB0cmFuc2xhdGU+U2hhcmUgdGhpcyBtYXA8L2g0PlxcbiAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJjbG9zZVwiIGRhdGEtZGlzbWlzcz1cIm1vZGFsXCIgYXJpYS1sYWJlbD1cIkNsb3NlXCI+PHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+JnRpbWVzOzwvc3Bhbj48L2J1dHRvbj5cXG48L2Rpdj5cXG48ZGl2IGNsYXNzPVwibW9kYWwtYm9keVwiPlxcbiAgPGZvcm0gcm9sZT1cImZvcm1cIiBuYW1lPVwiZ21mU2hhcmVGb3JtXCIgbm92YWxpZGF0ZT5cXG4gICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cXG4gICAgICA8bGFiZWwgZm9yPVwiZ21mU2hhcmVJbnB1dFNob3J0TGluay17ezo6JGN0cmwudWlkfX1cIiB0cmFuc2xhdGU+UGVybWFsaW5rPC9sYWJlbD5cXG4gICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZ21mU2hhcmVJbnB1dFNob3J0TGluay17ezo6JGN0cmwudWlkfX1cIiBvbmNsaWNrPVwidGhpcy5zZWxlY3QoKVwiIG5nLW1vZGVsPVwiJGN0cmwuc2hvcnRMaW5rXCIgcmVhZG9ubHk9XCJUcnVlXCI+XFxuICAgICAgPHAgY2xhc3M9XCJoZWxwLWJsb2NrXCIgdHJhbnNsYXRlPkNvcHkgdGhpcyBsaW5rIHRvIHNoYXJlIGl0LjwvcD5cXG4gICAgICA8cCBjbGFzcz1cInRleHQtZGFuZ2VyXCIgbmctaWY9XCIkY3RybC5zaG93TGVuZ3RoV2FybmluZ1wiPlxcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS1leGNsYW1hdGlvbi10cmlhbmdsZVwiPjwvc3Bhbj5cXG4gICAgICAgIHt7XFwnWW91IGhhdmUgYSBsb3Qgb2YgZHJhd24gZWxlbWVudHMgaW4gdGhpcyBtYXAuIFRoZSBhYm92ZSBsaW5rIG1heSBub3QgYmUgY29ycmVjdGx5IHN1cHBvcnRlZCBieSBzb21lIGJyb3dzZXJzLlxcJyB8IHRyYW5zbGF0ZX19XFxuICAgICAgPC9wPlxcbiAgICAgIDxwIGNsYXNzPVwidGV4dC1kYW5nZXJcIiBuZy1pZj1cIiRjdHJsLmVycm9yT25HZXRTaG9ydFVybFwiPlxcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS1leGNsYW1hdGlvblwiPjwvc3Bhbj5cXG4gICAgICAgIHt7XFwnRXJyb3IsIGNhbm5vdCBnZXQgdGhlIHNob3J0ZW5lZCBVUkwuXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgICA8L3A+XFxuICAgIDwvZGl2PlxcbiAgICA8aHIgbmctaWY9XCI6OiRjdHJsLmVuYWJsZUVtYWlsXCI+XFxuICAgIDxkaXYgY2xhc3M9XCJnbWYtc2hhcmUtZW1haWxcIiBuZy1pZj1cIjo6JGN0cmwuZW5hYmxlRW1haWxcIj5cXG4gICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxcbiAgICAgICAgPGxhYmVsIGZvcj1cImdtZlNoYXJlSW5wdXRFbWFpbC17ezo6JGN0cmwudWlkfX1cIiB0cmFuc2xhdGU+U2VuZCB0aGlzIGxpbmsgdG88L2xhYmVsPlxcbiAgICAgICAgPGlucHV0IHR5cGU9XCJlbWFpbFwiIGNsYXNzPVwiZm9ybS1jb250cm9sXCIgIG5hbWU9XCJpbnB1dEVtYWlsXCIgaWQ9XCJnbWZTaGFyZUlucHV0RW1haWwte3s6OiRjdHJsLnVpZH19XCIgcGxhY2Vob2xkZXI9XCJFLW1haWxcIiBuZy1tb2RlbD1cIiRjdHJsLmVtYWlsXCIgcmVxdWlyZWQ+XFxuICAgICAgICA8c3BhbiBuZy1zaG93PVwiZ21mU2hhcmVGb3JtLiRzdWJtaXR0ZWQgfHwgZ21mU2hhcmVGb3JtLmlucHV0RW1haWwuJHRvdWNoZWRcIj5cXG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJ0ZXh0LWRhbmdlclwiIG5nLXNob3c9XCJnbWZTaGFyZUZvcm0uaW5wdXRFbWFpbC4kZXJyb3IuZW1haWwgfHwgZ21mU2hhcmVGb3JtLmlucHV0RW1haWwuJGVycm9yLnJlcXVpcmVkXCI+XFxuICAgICAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1leGNsYW1hdGlvbi10cmlhbmdsZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cXG4gICAgICAgICAgICB7e1xcJ0ludmFsaWQgZW1haWwuXFwnIHwgdHJhbnNsYXRlfX08L3NwYW4+XFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cXG4gICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cImZvcm0tY29udHJvbFwiIG5nLWF0dHItcGxhY2Vob2xkZXI9XCJ7e1xcJ01lc3NhZ2UgKG9wdGlvbmFsKVxcJyB8wqB0cmFuc2xhdGUgfX1cIiBuZy1tb2RlbD1cIiRjdHJsLm1lc3NhZ2VcIj48L3RleHRhcmVhPlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxzcGFuIGNsYXNzPVwidGV4dC1zdWNjZXNzXCIgbmctaWY9XCIkY3RybC5zdWNjZXNzZnVsbHlTZW50XCI+XFxuICAgICAgICA8aSBjbGFzcz1cImZhIGZhLWNoZWNrXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxcbiAgICAgICAgICB7eyBcXCdMaW5rIHN1Y2Nlc3NmdWxseSBzZW50LlxcJyB8IHRyYW5zbGF0ZSB9fVxcbiAgICAgIDwvc3Bhbj5cXG4gICAgICA8c3BhbiBjbGFzcz1cInRleHQtZGFuZ2VyXCIgbmctaWY9XCIkY3RybC5lcnJvck9uc2VuZFwiPlxcbiAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1leGNsYW1hdGlvblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cXG4gICAgICAgICAge3sgXFwnRXJyb3IsIHRoZSBsaW5rIGhhcyBub3QgYmVlbiBzZW50LlxcJyB8IHRyYW5zbGF0ZSB9fVxcbiAgICAgIDwvc3Bhbj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XCJ0ZXh0LXJpZ2h0XCI+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHRcIiBkYXRhLWRpc21pc3M9XCJtb2RhbFwiIHRyYW5zbGF0ZT5DbG9zZTwvYnV0dG9uPlxcbiAgICAgIDxidXR0b24gbmctaWY9XCI6OiRjdHJsLmVuYWJsZUVtYWlsXCJcXG4gICAgICAgIHR5cGU9XCJzdWJtaXRcIiBjbGFzcz1cImJ0biBwcmltZVwiXFxuICAgICAgICBuZy1jbGljaz1cIiRjdHJsLnNlbmRTaG9ydFVybCgpXCJcXG4gICAgICAgIG5nLWRpc2FibGVkPVwiIWdtZlNoYXJlRm9ybS4kdmFsaWRcIlxcbiAgICAgICAgdHJhbnNsYXRlPlNlbmRcXG4gICAgICA8L2J1dHRvbj5cXG4gICAgPC9kaXY+XFxuICA8L2Zvcm0+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IGdtZlBlcm1hbGlua1NoYXJlU2VydmljZSwgeyBVUkxfTUFYX0xFTiwgVVJMX1BBVEhfTUFYX0xFTiB9IGZyb20gJ2dtZi9wZXJtYWxpbmsvU2hhcmVTZXJ2aWNlLmpzJztcbmltcG9ydCBuZ2VvU3RhdGVtYW5hZ2VyTG9jYXRpb24gZnJvbSAnbmdlby9zdGF0ZW1hbmFnZXIvTG9jYXRpb24uanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZQZXJtYWxpbmtTaGFyZUNvbXBvbmVudCcsIFtnbWZQZXJtYWxpbmtTaGFyZVNlcnZpY2UubmFtZSwgbmdlb1N0YXRlbWFuYWdlckxvY2F0aW9uLm5hbWVdKTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZ21mL3Blcm1hbGluay9zaGFyZUNvbXBvbmVudCcsIHJlcXVpcmUoJy4vc2hhcmVDb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcbm1vZHVsZS52YWx1ZSgnZ21mUGVybWFsaW5rU2hhcmVUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uICgkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzLmdtZlBlcm1hbGlua1NoYXJlVGVtcGxhdGVVcmw7XG4gIHJldHVybiB0ZW1wbGF0ZVVybCAhPT0gdW5kZWZpbmVkID8gdGVtcGxhdGVVcmwgOiAnZ21mL3Blcm1hbGluay9zaGFyZUNvbXBvbmVudCc7XG59KTtcbmdtZlBlcm1hbGlua1NoYXJlVGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRhdHRyc1wiLCBcImdtZlBlcm1hbGlua1NoYXJlVGVtcGxhdGVVcmxcIl07XG5cbmZ1bmN0aW9uIGdtZlBlcm1hbGlua1NoYXJlVGVtcGxhdGVVcmwoJGF0dHJzLCBnbWZQZXJtYWxpbmtTaGFyZVRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBnbWZQZXJtYWxpbmtTaGFyZVRlbXBsYXRlVXJsKCRhdHRycyk7XG59XG5cbnZhciBwZXJtYWxpbmtTaGFyZUNvbXBvbmVudCA9IHtcbiAgYmluZGluZ3M6IHtcbiAgICAnZW5hYmxlRW1haWwnOiAnPGdtZlNoYXJlRW1haWwnXG4gIH0sXG4gIGNvbnRyb2xsZXI6ICdHbWZTaGFyZUNvbnRyb2xsZXInLFxuICB0ZW1wbGF0ZVVybDogZ21mUGVybWFsaW5rU2hhcmVUZW1wbGF0ZVVybFxufTtcbm1vZHVsZS5jb21wb25lbnQoJ2dtZlNoYXJlJywgcGVybWFsaW5rU2hhcmVDb21wb25lbnQpO1xuXG52YXIgU2hhcmVDb21wb25lbnRDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICBTaGFyZUNvbXBvbmVudENvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIm5nZW9Mb2NhdGlvblwiLCBcImdtZlNoYXJlU2VydmljZVwiLCBcIiRxXCIsIFwiJGF0dHJzXCJdO1xuXG4gIGZ1bmN0aW9uIFNoYXJlQ29tcG9uZW50Q29udHJvbGxlcigkc2NvcGUsIG5nZW9Mb2NhdGlvbiwgZ21mU2hhcmVTZXJ2aWNlLCAkcSwgJGF0dHJzKSB7XG4gICAgdGhpcy51aWQgPSBvbFV0aWxHZXRVaWQodGhpcyk7XG4gICAgdGhpcy4kc2NvcGVfID0gJHNjb3BlO1xuICAgIHRoaXMuZ21mU2hhcmVTZXJ2aWNlXyA9IGdtZlNoYXJlU2VydmljZTtcbiAgICB0aGlzLiRxXyA9ICRxO1xuICAgIHRoaXMubmdlb0xvY2F0aW9uXyA9IG5nZW9Mb2NhdGlvbjtcbiAgICB0aGlzLmVuYWJsZUVtYWlsID0gZmFsc2U7XG4gICAgdGhpcy5zaG9ydExpbmsgPSAnJztcbiAgICB0aGlzLmVtYWlsID0gJyc7XG4gICAgdGhpcy5tZXNzYWdlID0gJyc7XG4gICAgdGhpcy5wZXJtYWxpbmtfID0gdGhpcy5uZ2VvTG9jYXRpb25fLmdldFVyaVN0cmluZygpO1xuICAgIHZhciBwYXRoID0gbmdlb0xvY2F0aW9uLmdldFBhdGgoKTtcblxuICAgIGlmICghcGF0aCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHBhdGgnKTtcbiAgICB9XG5cbiAgICB0aGlzLnNob3dMZW5ndGhXYXJuaW5nID0gdGhpcy5wZXJtYWxpbmtfLmxlbmd0aCA+IFVSTF9NQVhfTEVOIHx8IHBhdGgubGVuZ3RoID4gVVJMX1BBVEhfTUFYX0xFTjtcbiAgICB0aGlzLnN1Y2Nlc3NmdWxseVNlbnQgPSBmYWxzZTtcbiAgICB0aGlzLmVycm9yT25zZW5kID0gZmFsc2U7XG4gICAgdGhpcy5lcnJvck9uR2V0U2hvcnRVcmwgPSBmYWxzZTtcbiAgICB0aGlzLmdldFNob3J0VXJsKCk7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gU2hhcmVDb21wb25lbnRDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZ2V0U2hvcnRVcmwgPSBmdW5jdGlvbiBnZXRTaG9ydFVybCgpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdGhpcy4kcV8ud2hlbih0aGlzLmdtZlNoYXJlU2VydmljZV8uZ2V0U2hvcnRVcmwodGhpcy5wZXJtYWxpbmtfKSkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgICAgX3RoaXMuc2hvcnRMaW5rID0gcmVzcC5kYXRhLnNob3J0X3VybDtcbiAgICAgIF90aGlzLmVycm9yT25HZXRTaG9ydFVybCA9IGZhbHNlO1xuICAgIH0sIGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICBfdGhpcy5zaG9ydExpbmsgPSBfdGhpcy5wZXJtYWxpbmtfO1xuICAgICAgX3RoaXMuZXJyb3JPbkdldFNob3J0VXJsID0gdHJ1ZTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uc2VuZFNob3J0VXJsID0gZnVuY3Rpb24gc2VuZFNob3J0VXJsKCkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgaWYgKHRoaXMuJHNjb3BlXy5nbWZTaGFyZUZvcm0uJHZhbGlkKSB7XG4gICAgICB0aGlzLiRxXy53aGVuKHRoaXMuZ21mU2hhcmVTZXJ2aWNlXy5zZW5kU2hvcnRVcmwodGhpcy5wZXJtYWxpbmtfLCB0aGlzLmVtYWlsLCB0aGlzLm1lc3NhZ2UpKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICAgIF90aGlzMi5zdWNjZXNzZnVsbHlTZW50ID0gdHJ1ZTtcbiAgICAgIH0sIGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICAgIF90aGlzMi5lcnJvck9uc2VuZCA9IHRydWU7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFNoYXJlQ29tcG9uZW50Q29udHJvbGxlcjtcbn0oKTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ0dtZlNoYXJlQ29udHJvbGxlcicsIFNoYXJlQ29tcG9uZW50Q29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdiBjbGFzcz1cImdtZi1wcmludFwiPlxcbiAgPGRpdiBuZy1zaG93PVwiJGN0cmwuaXNTdGF0ZShcXCdDQVBBQklMSVRJRVNfTk9UX0xPQURFRFxcJykgIT09IHRydWUgJiYgJGN0cmwuaXNTdGF0ZShcXCdFUlJPUl9PTl9HRVRDQVBBQklMSVRJRVNcXCcpICE9PSB0cnVlXCI+XFxuICAgIDxkaXYgY2xhc3M9XCJnbWYtcHJpbnQtbGF5b3V0LXNlbGVjdG9yXCI+PG5nLXRyYW5zY2x1ZGUgLz48L2Rpdj5cXG4gICAgPGRpdlxcbiAgICAgIG5nLXJlcGVhdD1cImF0dHJpYnV0ZSBpbiAkY3RybC5sYXlvdXRJbmZvLnNpbXBsZUF0dHJpYnV0ZXNcIlxcbiAgICAgIGNsYXNzPVwiZ21mLXByaW50LWxheW91dGluZm8gZm9ybS1ncm91cFwiPlxcbiAgICAgIDxkaXYgbmctaWY9XCIkY3RybC5oaWRkZW5BdHRyaWJ1dGVOYW1lcyA9PT0gdW5kZWZpbmVkIHx8ICRjdHJsLmhpZGRlbkF0dHJpYnV0ZU5hbWVzLmluZGV4T2YoYXR0cmlidXRlLm5hbWUpIDwgMFwiPlxcbiAgICAgICAgPGlucHV0XFxuICAgICAgICAgIG5nLWlmPVwiYXR0cmlidXRlLnR5cGUgPT09IFxcJ251bWJlclxcJ1wiXFxuICAgICAgICAgIG5nLW1vZGVsPVwiYXR0cmlidXRlLnZhbHVlXCJcXG4gICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcXG4gICAgICAgICAgbmctYXR0ci1wbGFjZWhvbGRlcj1cInt7YXR0cmlidXRlLm5hbWUgfCB0cmFuc2xhdGV9fVwiPlxcblxcbiAgICAgICAgPGlucHV0XFxuICAgICAgICAgIG5nLWlmPVwiYXR0cmlidXRlLnR5cGUgPT09IFxcJ3RleHRcXCdcIlxcbiAgICAgICAgICBuZy1tb2RlbD1cImF0dHJpYnV0ZS52YWx1ZVwiXFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxcbiAgICAgICAgICBuZy1hdHRyLXBsYWNlaG9sZGVyPVwie3thdHRyaWJ1dGUubmFtZSB8IHRyYW5zbGF0ZX19XCI+XFxuXFxuICAgICAgICA8dGV4dGFyZWFcXG4gICAgICAgICAgbmctaWY9XCJhdHRyaWJ1dGUudHlwZSA9PT0gXFwndGV4dGFyZWFcXCdcIlxcbiAgICAgICAgICBuZy1tb2RlbD1cImF0dHJpYnV0ZS52YWx1ZVwiXFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgcm93PVwiM1wiXFxuICAgICAgICAgIG5nLWF0dHItcGxhY2Vob2xkZXI9XCJ7e2F0dHJpYnV0ZS5uYW1lIHwgdHJhbnNsYXRlfX1cIj48L3RleHRhcmVhPlxcblxcbiAgICAgICAgPGRpdlxcbiAgICAgICAgICBuZy1pZj1cImF0dHJpYnV0ZS50eXBlID09PSBcXCdjaGVja2JveFxcJ1wiXFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jaGVja1wiPlxcbiAgICAgICAgICA8bGFiZWwgY2xhc3M9XCJmb3JtLWNoZWNrLWxhYmVsXCI+XFxuICAgICAgICAgICAgPGlucHV0XFxuICAgICAgICAgICAgICBjbGFzcz1cImZvcm0tY2hlY2staW5wdXRcIlxcbiAgICAgICAgICAgICAgbmctbW9kZWw9XCJhdHRyaWJ1dGUudmFsdWVcIlxcbiAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCI+XFxuICAgICAgICAgICAgPHNwYW4+e3thdHRyaWJ1dGUubmFtZSB8IHRyYW5zbGF0ZX19PC9zcGFuPlxcbiAgICAgICAgICA8L2xhYmVsPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8ZGl2XFxuICAgICAgbmctc2hvdz1cIiRjdHJsLmxheW91dEluZm8ubGVnZW5kICE9PSB1bmRlZmluZWRcIlxcbiAgICAgIGNsYXNzPVwiZ21mLXByaW50LWxlZ2VuZCBjaGVja2JveFwiPlxcbiAgICAgIDxsYWJlbD5cXG4gICAgICAgIDxpbnB1dFxcbiAgICAgICAgICBuZy1tb2RlbD1cIiRjdHJsLmxheW91dEluZm8ubGVnZW5kXCJcXG4gICAgICAgICAgdHlwZT1cImNoZWNrYm94XCI+XFxuICAgICAgICA8c3BhbiB0cmFuc2xhdGU+TGVnZW5kPC9zcGFuPlxcbiAgICAgIDwvbGFiZWw+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8ZGl2IGNsYXNzPVwiZ21mLXByaW50LWxheW91dC1zZWxlY3RvclwiPlxcbiAgICAgIDxkaXZcXG4gICAgICAgIG5nLXNob3c9XCIkY3RybC5sYXlvdXRJbmZvLmxheW91dHMubGVuZ3RoICE9PSAxXCJcXG4gICAgICAgIGNsYXNzPVwiZm9ybS1ncm91cCByb3dcIj5cXG5cXG4gICAgICAgIDxsYWJlbFxcbiAgICAgICAgICBjbGFzcz1cImNvbC1mb3JtLWxhYmVsIGNvbC1tZC01XCJcXG4gICAgICAgICAgdHJhbnNsYXRlPkxheW91dDwvbGFiZWw+XFxuXFxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLW1kLTdcIj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImJ0bi1ncm91cCBidG4tYmxvY2tcIj5cXG4gICAgICAgICAgICA8YnV0dG9uXFxuICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGZvcm0tY29udHJvbCBkcm9wZG93bi10b2dnbGVcIlxcbiAgICAgICAgICAgICAgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiPlxcbiAgICAgICAgICAgICAgPHNwYW4+e3skY3RybC5sYXlvdXRJbmZvLmxheW91dCB8IHRyYW5zbGF0ZX19Jm5ic3A7PC9zcGFuPlxcbiAgICAgICAgICAgIDwvYnV0dG9uPlxcbiAgICAgICAgICAgIDx1bFxcbiAgICAgICAgICAgICAgY2xhc3M9XCJkcm9wZG93bi1tZW51IGRyb3Bkb3duLW1lbnUtcmlnaHQgYnRuLWJsb2NrXCJcXG4gICAgICAgICAgICAgIHJvbGU9XCJtZW51XCI+XFxuICAgICAgICAgICAgICA8bGkgbmctcmVwZWF0PVwibGF5b3V0IGluICRjdHJsLmxheW91dEluZm8ubGF5b3V0c1wiPlxcbiAgICAgICAgICAgICAgICA8YVxcbiAgICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuc2V0TGF5b3V0KGxheW91dClcIlxcbiAgICAgICAgICAgICAgICAgIGhyZWY9XCJcIj57e2xheW91dCB8IHRyYW5zbGF0ZX19PC9hPlxcbiAgICAgICAgICAgICAgPC9saT5cXG4gICAgICAgICAgICA8L3VsPlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcblxcbiAgICAgIDxkaXZcXG4gICAgICAgIG5nLXNob3c9XCIkY3RybC5sYXlvdXRJbmZvLnNjYWxlcy5sZW5ndGggIT09IDFcIlxcbiAgICAgICAgY2xhc3M9XCJnbWYtcHJpbnQtc2NhbGUtc2VsZWN0b3IgZm9ybS1ncm91cCByb3dcIj5cXG5cXG4gICAgICAgIDxsYWJlbFxcbiAgICAgICAgICBjbGFzcz1cImNvbC1mb3JtLWxhYmVsIGNvbC1tZC01XCJcXG4gICAgICAgICAgdHJhbnNsYXRlPlNjYWxlPC9sYWJlbD5cXG5cXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtN1wiPlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwIGJ0bi1ibG9ja1wiPlxcbiAgICAgICAgICAgIDxidXR0b25cXG4gICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgZm9ybS1jb250cm9sIGRyb3Bkb3duLXRvZ2dsZVwiXFxuICAgICAgICAgICAgICBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJcXG4gICAgICAgICAgICAgIGFyaWEtZXhwYW5kZWQ9XCJmYWxzZVwiPlxcbiAgICAgICAgICAgICAgPHNwYW4+e3skY3RybC5sYXlvdXRJbmZvLnNjYWxlIHwgbmdlb1NjYWxpZnl9fSZuYnNwOzwvc3Bhbj5cXG4gICAgICAgICAgICA8L2J1dHRvbj5cXG4gICAgICAgICAgICA8dWxcXG4gICAgICAgICAgICAgIGNsYXNzPVwiZHJvcGRvd24tbWVudSBkcm9wZG93bi1tZW51LXJpZ2h0IGJ0bi1ibG9ja1wiXFxuICAgICAgICAgICAgICByb2xlPVwibWVudVwiPlxcbiAgICAgICAgICAgICAgPGxpIG5nLXJlcGVhdD1cInNjYWxlIGluICRjdHJsLmxheW91dEluZm8uc2NhbGVzXCI+XFxuICAgICAgICAgICAgICAgIDxhXFxuICAgICAgICAgICAgICAgICAgbmctY2xpY2s9XCIkY3RybC5nZXRTZXRTY2FsZShzY2FsZSlcIlxcbiAgICAgICAgICAgICAgICAgIGhyZWY9XCJcIj57e3NjYWxlIHwgbmdlb1NjYWxpZnl9fTwvYT5cXG4gICAgICAgICAgICAgIDwvbGk+XFxuICAgICAgICAgICAgICA8c3BhbiBuZy1pZj1cIiRjdHJsLnNjYWxlSW5wdXRcIj5cXG4gICAgICAgICAgICAgICAgPGxpIGNsYXNzPVwiZHJvcGRvd24taGVhZGVyXCIgdHJhbnNsYXRlPk1hbnVhbCBlbnRyeTwvbGk+XFxuICAgICAgICAgICAgICAgIDxsaT5cXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZ21mLXByaW50LWN1c3RvbS1zY2FsZVwiPlxcbiAgICAgICAgICAgICAgICAgICAgMSA6IDxpbnB1dCBjbGFzcz1cImdtZi1wcmludC1jdXN0b20tc2NhbGUtaW5wdXRcIiB0eXBlPVwibnVtYmVyXCIgbWluPVwiMVwiIG5nLW1vZGVsPVwiJGN0cmwuZ2V0U2V0U2NhbGVcIiBuZy1tb2RlbC1vcHRpb25zPVwie2dldHRlclNldHRlcjogdHJ1ZX1cIj5cXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9saT5cXG4gICAgICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgICA8L3VsPlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcblxcbiAgICAgIDxkaXZcXG4gICAgICAgIG5nLXNob3c9XCIkY3RybC5sYXlvdXRJbmZvLmRwaXMubGVuZ3RoICE9PSAxXCJcXG4gICAgICAgIGNsYXNzPVwiZ21mLXByaW50LWRwaS1zZWxlY3RvciBmb3JtLWdyb3VwIHJvd1wiPlxcblxcbiAgICAgICAgPGxhYmVsXFxuICAgICAgICAgIGNsYXNzPVwiY29sLWZvcm0tbGFiZWwgY29sLW1kLTNcIlxcbiAgICAgICAgICB0cmFuc2xhdGU+RFBJPC9sYWJlbD5cXG5cXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtNVwiPlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwIGJ0bi1ibG9ja1wiPlxcbiAgICAgICAgICAgIDxidXR0b25cXG4gICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgZm9ybS1jb250cm9sIGRyb3Bkb3duLXRvZ2dsZVwiXFxuICAgICAgICAgICAgICBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJcXG4gICAgICAgICAgICAgIGFyaWEtZXhwYW5kZWQ9XCJmYWxzZVwiPlxcbiAgICAgICAgICAgICAgPHNwYW4+e3skY3RybC5sYXlvdXRJbmZvLmRwaX19Jm5ic3A7PC9zcGFuPlxcbiAgICAgICAgICAgIDwvYnV0dG9uPlxcbiAgICAgICAgICAgIDx1bFxcbiAgICAgICAgICAgICAgY2xhc3M9XCJkcm9wZG93bi1tZW51IGRyb3Bkb3duLW1lbnUtcmlnaHQgYnRuLWJsb2NrXCJcXG4gICAgICAgICAgICAgIHJvbGU9XCJtZW51XCI+XFxuICAgICAgICAgICAgICA8bGkgbmctcmVwZWF0PVwiZHBpIGluICRjdHJsLmxheW91dEluZm8uZHBpc1wiPlxcbiAgICAgICAgICAgICAgICA8YSBocmVmPVwiXCIgbmctY2xpY2s9XCIkY3RybC5zZXREcGkoZHBpKVwiPnt7ZHBpfX08L2E+XFxuICAgICAgICAgICAgICA8L2xpPlxcbiAgICAgICAgICAgIDwvdWw+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuXFxuICAgICAgPGRpdiBjbGFzcz1cImdtZi1wcmludC1yb3RhdGlvbi1zZWxlY3RvciBmb3JtLWdyb3VwIHJvd1wiPlxcbiAgICAgICAgPGxhYmVsXFxuICAgICAgICAgIGNsYXNzPVwiY29sLWZvcm0tbGFiZWwgY29sLW1kLTNcIlxcbiAgICAgICAgICB0cmFuc2xhdGU+Um90YXRpb248L2xhYmVsPlxcblxcbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1tZC01XCI+XFxuICAgICAgICAgIDxpbnB1dFxcbiAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sIGdtZi1wcmludC1yb3RhdGlvbi1pbnB1dFwiXFxuICAgICAgICAgICAgdHlwZT1cInJhbmdlXCJcXG4gICAgICAgICAgICB2YWx1ZT1cIjBcIlxcbiAgICAgICAgICAgIG1pbj1cIi0xODBcIlxcbiAgICAgICAgICAgIG1heD1cIjE4MFwiXFxuICAgICAgICAgICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgICAgICAgICB0aXRsZT1cInt7XFwnWW91IGNhbiBhbHNvIHVzZSBBbHQrU2hpZnQgb24gdGhlIG1hcFxcJyB8IHRyYW5zbGF0ZX19XCI+XFxuICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtNFwiPlxcbiAgICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbCBnbWYtcHJpbnQtcm90YXRpb24taW5wdXRcIlxcbiAgICAgICAgICAgIHR5cGU9XCJudW1iZXJcIlxcbiAgICAgICAgICAgIG1pbj1cIi0xODBcIlxcbiAgICAgICAgICAgIG1heD1cIjE4MFwiXFxuICAgICAgICAgICAgdmFsdWU9XCIwXCI+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG5cXG4gICAgPC9kaXY+XFxuXFxuICAgIDxkaXZcXG4gICAgICBuZy1zaG93PVwiJGN0cmwuc210cFN1cHBvcnRlZCAmJiAkY3RybC5zbXRwRW1haWxcIlxcbiAgICAgIGNsYXNzPVwiZ21mLXByaW50LXNtdHAgY2hlY2tib3hcIj5cXG4gICAgICA8bGFiZWw+XFxuICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgbmctZGlzYWJsZWQ9XCIkY3RybC5pc1N0YXRlKFxcJ1BSSU5USU5HXFwnKVwiXFxuICAgICAgICAgIG5nLW1vZGVsPVwiJGN0cmwuc210cEVuYWJsZWRcIlxcbiAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIj5cXG4gICAgICAgIDxzcGFuIHRyYW5zbGF0ZT5TZW5kIGZpbGUgYnkgZW1haWw8L3NwYW4+XFxuICAgICAgPC9sYWJlbD5cXG4gICAgPC9kaXY+XFxuXFxuICAgIDxkaXYgY2xhc3M9XCJnbWYtcHJpbnQtYWN0aW9ucyBmb3JtLWdyb3VwIHB1bGwtcmlnaHRcIj5cXG4gICAgICA8c3BhbiBuZy1zaG93PVwiJGN0cmwuaXNTdGF0ZShcXCdQUklOVElOR1xcJylcIj5cXG4gICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtcmVmcmVzaCBmYS1zcGlubmVyIGZhLXNwaW5cIj48L2k+XFxuICAgICAgPC9zcGFuPlxcblxcbiAgICAgIDxhXFxuICAgICAgICBuZy1zaG93PVwiJGN0cmwuaXNTdGF0ZShcXCdQUklOVElOR1xcJylcIlxcbiAgICAgICAgY2xhc3M9XCJnbWYtcHJpbnQtY2FuY2VsIGJ0biBidG4tbGlua1wiXFxuICAgICAgICBocmVmPVwiXCJcXG4gICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuY2FuY2VsKClcIlxcbiAgICAgICAgdHJhbnNsYXRlPkFib3J0PC9hPlxcblxcbiAgICAgIDxidXR0b25cXG4gICAgICAgIG5nLXNob3c9XCIkY3RybC5sYXlvdXRJbmZvLmZvcm1hdHMucG5nXCJcXG4gICAgICAgIGNsYXNzPVwiZ21mLXByaW50LWltYWdlIGJ0biBwcmltZVwiXFxuICAgICAgICBuZy1kaXNhYmxlZD1cIiRjdHJsLmlzU3RhdGUoXFwnUFJJTlRJTkdcXCcpXCJcXG4gICAgICAgIG5nLWNsaWNrPVwiJGN0cmwucHJpbnQoXFwncG5nXFwnKVwiIHRyYW5zbGF0ZT5JbWFnZTwvYnV0dG9uPlxcblxcbiAgICAgIDxidXR0b25cXG4gICAgICAgIG5nLXNob3c9XCIkY3RybC5sYXlvdXRJbmZvLmZvcm1hdHMucGRmXCJcXG4gICAgICAgIGNsYXNzPVwiZ21mLXByaW50LXBkZiBidG4gcHJpbWVcIlxcbiAgICAgICAgbmctZGlzYWJsZWQ9XCIkY3RybC5pc1N0YXRlKFxcJ1BSSU5USU5HXFwnKVwiXFxuICAgICAgICBuZy1jbGljaz1cIiRjdHJsLnByaW50KFxcJ3BkZlxcJylcIiB0cmFuc2xhdGU+UERGPC9idXR0b24+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8ZGl2XFxuICAgICAgbmctc2hvdz1cIiRjdHJsLmlzU3RhdGUoXFwnRVJST1JfT05fUkVQT1JUXFwnKVwiXFxuICAgICAgY2xhc3M9XCJnbWYtcHJpbnQtZXJyb3ItcmVwb3J0IGZvcm0tZ3JvdXAgcHVsbC1sZWZ0IHRleHQtZGFuZ2VyXCI+XFxuICAgICAgPHA+e3tcXCdFcnJvciBkdXJpbmcgdGhlIHByaW50LCBwbGVhc2UgdHJ5IGFnYWluLlxcJyB8IHRyYW5zbGF0ZX19PC9wPlxcbiAgICA8L2Rpdj5cXG4gIDwvZGl2PlxcblxcbiAgPGRpdlxcbiAgICBuZy1zaG93PVwiJGN0cmwuaXNTdGF0ZShcXCdDQVBBQklMSVRJRVNfTk9UX0xPQURFRFxcJylcIlxcbiAgICBjbGFzcz1cImdtZi1wcmludC13YWl0IGZvcm0tZ3JvdXAgcHVsbC1sZWZ0XCI+XFxuICAgIDxwPnt7XFwnQ29ubmVjdGluZyB0byB0aGUgcHJpbnQgc2VydmVyLCBwbGVhc2Ugd2FpdC5cXCcgfCB0cmFuc2xhdGV9fTwvcD5cXG4gIDwvZGl2PlxcblxcbiAgPGRpdlxcbiAgICBuZy1zaG93PVwiJGN0cmwuaXNTdGF0ZShcXCdFUlJPUl9PTl9HRVRDQVBBQklMSVRJRVNcXCcpXCJcXG4gICAgY2xhc3M9XCJnbWYtcHJpbnQtZXJyb3ItY2FwYWJpbGl0aWVzIGZvcm0tZ3JvdXAgcHVsbC1sZWZ0IHRleHQtZGFuZ2VyXCI+XFxuICAgIDxwPnt7XFwnVGhlIHByaW50IHNlcnZlciBpcyB1bmF2YWlsYWJsZS4gUGxlYXNlLCB0cnkgbGF0ZXIuXFwnIHwgdHJhbnNsYXRlfX08L3A+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXZcXG4gICAgbmctc2hvdz1cIiRjdHJsLnNtdHBNZXNzYWdlXCJcXG4gICAgY2xhc3M9XCJnbWYtcHJpbnQtc210cC1tZXNzYWdlIGZvcm0tZ3JvdXAgcHVsbC1sZWZ0XCI+XFxuICAgIDxidXR0b25cXG4gICAgICBjbGFzcz1cImJ0biBwcmltZVwiXFxuICAgICAgbmctY2xpY2s9XCIkY3RybC5jbG9zZVNtdHBNZXNzYWdlKClcIiB0cmFuc2xhdGU+Q2xvc2U8L2J1dHRvbj5cXG4gICAgPHA+e3tcXCdUaGUgZmlsZSB3aWxsIGJlIHNlbnQgdG8geW91ciBlbWFpbCB3aGVuIHJlYWR5LlxcJyB8IHRyYW5zbGF0ZX19PC9wPlxcbiAgPC9kaXY+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgREFUQUxBWUVSR1JPVVBfTkFNRSB9IGZyb20gJ2dtZi9pbmRleC5qcyc7XG5pbXBvcnQgZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlIGZyb20gJ2dtZi9hdXRoZW50aWNhdGlvbi9TZXJ2aWNlLmpzJztcbmltcG9ydCBNYXNrTGF5ZXIgZnJvbSAnbmdlby9wcmludC9NYXNrLmpzJztcbmltcG9ydCBnbWZUaGVtZVRoZW1lcywgeyBmaW5kR3JvdXBCeUxheWVyTm9kZU5hbWUsIGZpbmRPYmplY3RCeU5hbWUgfSBmcm9tICdnbWYvdGhlbWUvVGhlbWVzLmpzJztcbmltcG9ydCBuZ2VvTWFwTGF5ZXJIZWxwZXIgZnJvbSAnbmdlby9tYXAvTGF5ZXJIZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9NYXBGZWF0dXJlT3ZlcmxheU1nciBmcm9tICduZ2VvL21hcC9GZWF0dXJlT3ZlcmxheU1nci5qcyc7XG5pbXBvcnQgbmdlb01pc2NGZWF0dXJlSGVscGVyLCB7IGdldEZpbHRlcmVkRmVhdHVyZVZhbHVlcyB9IGZyb20gJ25nZW8vbWlzYy9GZWF0dXJlSGVscGVyLmpzJztcbmltcG9ydCBuZ2VvUHJpbnRTZXJ2aWNlIGZyb20gJ25nZW8vcHJpbnQvU2VydmljZS5qcyc7XG5pbXBvcnQgbmdlb1ByaW50VXRpbHMsIHsgSU5DSEVTX1BFUl9NRVRFUiwgRE9UU19QRVJfSU5DSCB9IGZyb20gJ25nZW8vcHJpbnQvVXRpbHMuanMnO1xuaW1wb3J0IG5nZW9RdWVyeU1hcFF1ZXJlbnQgZnJvbSAnbmdlby9xdWVyeS9NYXBRdWVyZW50LmpzJztcbmltcG9ydCB7IGxpc3RlbiwgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xMYXllckltYWdlIGZyb20gJ29sL2xheWVyL0ltYWdlLmpzJztcbmltcG9ydCBvbExheWVyVGlsZSBmcm9tICdvbC9sYXllci9UaWxlLmpzJztcbmltcG9ydCBvbExheWVyR3JvdXAgZnJvbSAnb2wvbGF5ZXIvR3JvdXAuanMnO1xuaW1wb3J0IG9sTWFwIGZyb20gJ29sL01hcC5qcyc7XG5pbXBvcnQgKiBhcyBvbE1hdGggZnJvbSAnb2wvbWF0aC5qcyc7XG5pbXBvcnQgSW1hZ2VXTVMgZnJvbSAnb2wvc291cmNlL0ltYWdlV01TLmpzJztcbmltcG9ydCBNYXBCcm93c2VyUG9pbnRlckV2ZW50IGZyb20gJ29sL01hcEJyb3dzZXJQb2ludGVyRXZlbnQuanMnO1xuaW1wb3J0ICdib290c3RyYXAvanMvc3JjL2Ryb3Bkb3duLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mUHJpbnRDb21wb25lbnQnLCBbZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlLm5hbWUsIGdtZlRoZW1lVGhlbWVzLm5hbWUsIG5nZW9NYXBMYXllckhlbHBlci5uYW1lLCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXlNZ3IubmFtZSwgbmdlb01pc2NGZWF0dXJlSGVscGVyLm5hbWUsIG5nZW9QcmludFNlcnZpY2UubmFtZSwgbmdlb1ByaW50VXRpbHMubmFtZSwgbmdlb1F1ZXJ5TWFwUXVlcmVudC5uYW1lXSk7XG5tb2R1bGUudmFsdWUoJ2dtZlByaW50VGVtcGxhdGVVcmwnLCBmdW5jdGlvbiAoZWxlbWVudCwgYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gYXR0cnMuZ21mUHJpbnRUZW1wbGF0ZXVybDtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICdnbWYvcHJpbnQnO1xufSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi9wcmludCcsIHJlcXVpcmUoJy4vY29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG52YXIgUHJpbnRTdGF0ZUVudW0gPSB7XG4gIE5PVF9JTl9VU0U6ICdub3RJblVzZScsXG4gIFBSSU5USU5HOiAncHJpbnRpbmcnLFxuICBFUlJPUl9PTl9SRVBPUlQ6ICdlcnJvck9uUmVwb3J0JyxcbiAgQ0FQQUJJTElUSUVTX05PVF9MT0FERUQ6ICdjYXBhYmlsaXRpZXNOb3RMb2FkZWQnLFxuICBFUlJPUl9PTl9HRVRDQVBBQklMSVRJRVM6ICdlcnJvck9uR2V0Q2FwYWJpbGl0aWVzJ1xufTtcbm1vZHVsZS52YWx1ZSgnZ21mUHJpbnRTdGF0ZScsIHtcbiAgc3RhdGU6IFByaW50U3RhdGVFbnVtLkNBUEFCSUxJVElFU19OT1RfTE9BREVEXG59KTtcbmdtZlByaW50VGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCIsIFwiZ21mUHJpbnRUZW1wbGF0ZVVybFwiXTtcblxuZnVuY3Rpb24gZ21mUHJpbnRUZW1wbGF0ZVVybCgkZWxlbWVudCwgJGF0dHJzLCBnbWZQcmludFRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBnbWZQcmludFRlbXBsYXRlVXJsKCRlbGVtZW50LCAkYXR0cnMpO1xufVxuXG52YXIgcHJpbnRDb21wb25lbnQgPSB7XG4gIGJpbmRpbmdzOiB7XG4gICAgJ21hcCc6ICc8Z21mUHJpbnRNYXAnLFxuICAgICdhY3RpdmUnOiAnPWdtZlByaW50QWN0aXZlJyxcbiAgICAncm90YXRlTWFzayc6ICc8P2dtZlByaW50Um90YXRlbWFzaycsXG4gICAgJ2ZpZWxkVmFsdWVzJzogJzw/Z21mUHJpbnRGaWVsZHZhbHVlcycsXG4gICAgJ2hpZGRlbkF0dHJpYnV0ZU5hbWVzJzogJzw/Z21mUHJpbnRIaWRkZW5hdHRyaWJ1dGVzJyxcbiAgICAnYXR0cmlidXRlc091dCc6ICc9P2dtZlByaW50QXR0cmlidXRlc091dCdcbiAgfSxcbiAgY29udHJvbGxlcjogJ0dtZlByaW50Q29udHJvbGxlcicsXG4gIHRlbXBsYXRlVXJsOiBnbWZQcmludFRlbXBsYXRlVXJsLFxuICB0cmFuc2NsdWRlOiB0cnVlXG59O1xubW9kdWxlLmNvbXBvbmVudCgnZ21mUHJpbnQnLCBwcmludENvbXBvbmVudCk7XG5leHBvcnQgdmFyIFByaW50Q29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgUHJpbnRDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkZWxlbWVudFwiLCBcIiRyb290U2NvcGVcIiwgXCIkc2NvcGVcIiwgXCIkdGltZW91dFwiLCBcIiRxXCIsIFwiJGluamVjdG9yXCIsIFwiZ2V0dGV4dENhdGFsb2dcIiwgXCJuZ2VvTGF5ZXJIZWxwZXJcIiwgXCJuZ2VvRmVhdHVyZU92ZXJsYXlNZ3JcIiwgXCJuZ2VvUHJpbnRVdGlsc1wiLCBcIm5nZW9DcmVhdGVQcmludFwiLCBcImdtZlByaW50VXJsXCIsIFwiZ21mQXV0aGVudGljYXRpb25TZXJ2aWNlXCIsIFwibmdlb1F1ZXJ5UmVzdWx0XCIsIFwiJGZpbHRlclwiLCBcImdtZlByaW50U3RhdGVcIiwgXCJnbWZUaGVtZXNcIl07XG5cbiAgZnVuY3Rpb24gUHJpbnRDb250cm9sbGVyKCRlbGVtZW50LCAkcm9vdFNjb3BlLCAkc2NvcGUsICR0aW1lb3V0LCAkcSwgJGluamVjdG9yLCBnZXR0ZXh0Q2F0YWxvZywgbmdlb0xheWVySGVscGVyLCBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IsIG5nZW9QcmludFV0aWxzLCBuZ2VvQ3JlYXRlUHJpbnQsIGdtZlByaW50VXJsLCBnbWZBdXRoZW50aWNhdGlvblNlcnZpY2UsIG5nZW9RdWVyeVJlc3VsdCwgJGZpbHRlciwgZ21mUHJpbnRTdGF0ZSwgZ21mVGhlbWVzKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHRoaXMuZ21mUHJpbnRTdGF0ZV8gPSBnbWZQcmludFN0YXRlO1xuICAgIHRoaXMudHJhbnNsYXRlXyA9ICRmaWx0ZXIoJ3RyYW5zbGF0ZScpO1xuICAgIHRoaXMubWFwID0gbnVsbDtcbiAgICB0aGlzLm1hc2tMYXllcl8gPSBuZXcgTWFza0xheWVyKCk7XG4gICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLnJvdGF0ZU1hc2sgPSBmYWxzZTtcbiAgICB0aGlzLmZpZWxkVmFsdWVzID0ge307XG4gICAgdGhpcy5hdHRyaWJ1dGVzT3V0ID0gW107XG4gICAgdGhpcy4kcm9vdFNjb3BlXyA9ICRyb290U2NvcGU7XG4gICAgdGhpcy4kc2NvcGVfID0gJHNjb3BlO1xuICAgIHRoaXMuJHRpbWVvdXRfID0gJHRpbWVvdXQ7XG4gICAgdGhpcy4kcV8gPSAkcTtcbiAgICB0aGlzLmdldHRleHRDYXRhbG9nXyA9IGdldHRleHRDYXRhbG9nO1xuICAgIHRoaXMubmdlb0xheWVySGVscGVyXyA9IG5nZW9MYXllckhlbHBlcjtcbiAgICB0aGlzLmZlYXR1cmVPdmVybGF5TGF5ZXJfID0gbmdlb0ZlYXR1cmVPdmVybGF5TWdyLmdldExheWVyKCk7XG4gICAgdGhpcy5uZ2VvUHJpbnRVdGlsc18gPSBuZ2VvUHJpbnRVdGlscztcbiAgICB0aGlzLm5nZW9QcmludF8gPSBuZ2VvQ3JlYXRlUHJpbnQoZ21mUHJpbnRVcmwpO1xuICAgIHRoaXMubmdlb1F1ZXJ5UmVzdWx0XyA9IG5nZW9RdWVyeVJlc3VsdDtcbiAgICB0aGlzLmdtZkF1dGhlbnRpY2F0aW9uU2VydmljZV8gPSBnbWZBdXRoZW50aWNhdGlvblNlcnZpY2U7XG4gICAgdGhpcy5nbWZUaGVtZXNfID0gZ21mVGhlbWVzO1xuICAgIHRoaXMuY2FjaGVWZXJzaW9uXyA9ICcwJztcblxuICAgIGlmICgkaW5qZWN0b3IuaGFzKCdjYWNoZVZlcnNpb24nKSkge1xuICAgICAgdGhpcy5jYWNoZVZlcnNpb25fID0gJGluamVjdG9yLmdldCgnY2FjaGVWZXJzaW9uJyk7XG4gICAgfVxuXG4gICAgdGhpcy5zY2FsZUlucHV0ID0gZmFsc2U7XG4gICAgdGhpcy5nbWZMZWdlbmRPcHRpb25zXyA9IHtcbiAgICAgIHVzZUJib3g6IHRydWUsXG4gICAgICBsYWJlbDoge30sXG4gICAgICBwYXJhbXM6IHt9XG4gICAgfTtcblxuICAgIGlmICgkaW5qZWN0b3IuaGFzKCdnbWZQcmludE9wdGlvbnMnKSkge1xuICAgICAgdmFyIG9wdGlvbnMgPSAkaW5qZWN0b3IuZ2V0KCdnbWZQcmludE9wdGlvbnMnKTtcblxuICAgICAgaWYgKG9wdGlvbnMuc2NhbGVJbnB1dCkge1xuICAgICAgICB0aGlzLnNjYWxlSW5wdXQgPSBvcHRpb25zLnNjYWxlSW5wdXQ7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLmxlZ2VuZCkge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZ21mTGVnZW5kT3B0aW9uc18sIG9wdGlvbnMubGVnZW5kKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnJlcXVlc3RDYW5jZWxlcl8gPSBudWxsO1xuICAgIHRoaXMuc3RhdHVzVGltZW91dFByb21pc2VfID0gbnVsbDtcbiAgICB0aGlzLm9uRHJhZ1ByZXZpb3VzTW91c2VQb3NpdGlvbl8gPSBudWxsO1xuICAgIHRoaXMucm90YXRpb25UaW1lb3V0UHJvbWlzZV8gPSBudWxsO1xuICAgIHRoaXMucG9pbnRlckRyYWdMaXN0ZW5lcktleV8gPSBudWxsO1xuICAgIHRoaXMubWFwVmlld1Jlc29sdXRpb25DaGFuZ2VLZXlfID0gbnVsbDtcbiAgICB0aGlzLmN1clJlZl8gPSAnJztcbiAgICB0aGlzLmZvcm1hdHNfID0gW107XG4gICAgdGhpcy5sYXlvdXRzXyA9IFtdO1xuICAgIHRoaXMubGF5b3V0XyA9IG51bGw7XG4gICAgdGhpcy5wYXBlclNpemVfID0gW107XG4gICAgdGhpcy5sYXlvdXRJbmZvID0ge307XG4gICAgdGhpcy5yb3RhdGlvbiA9IDA7XG4gICAgdGhpcy5zbXRwRW1haWwgPSBudWxsO1xuICAgIHRoaXMuc210cEVuYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLnNtdHBNZXNzYWdlID0gZmFsc2U7XG4gICAgdGhpcy5zbXRwU3VwcG9ydGVkID0gZmFsc2U7XG4gICAgdGhpcy5oaWRkZW5BdHRyaWJ1dGVOYW1lcyA9IFtdO1xuICAgIHRoaXMuc2NhbGVNYW51YWxseVNlbGVjdGVkXyA9IGZhbHNlO1xuICAgIHRoaXMucm90YXRpb25JbnB1dF8gPSAkZWxlbWVudC5maW5kKCcuZ21mLXByaW50LXJvdGF0aW9uLWlucHV0Jyk7XG4gICAgdGhpcy5yb3RhdGlvbklucHV0Xy5vbignaW5wdXQgY2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICB2YXIgcm90YXRpb24gPSAkKGV2ZW50LnRhcmdldCkudmFsKCk7XG5cbiAgICAgIGlmICh0eXBlb2Ygcm90YXRpb24gPT0gJ3N0cmluZycpIHtcbiAgICAgICAgX3RoaXMuc2V0Um90YXRpb24ocGFyc2VGbG9hdChyb3RhdGlvbikpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5wb3N0Y29tcG9zZUxpc3RlbmVyXyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIHRoaXMuY2FwYWJpbGl0aWVzXyA9IG51bGw7XG4gICAgdGhpcy5vZ2NTZXJ2ZXJzXyA9IG51bGw7XG4gICAgdGhpcy5jdXJyZW50VGhlbWVzXyA9IFtdO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IFByaW50Q29udHJvbGxlci5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLiRvbkluaXQgPSBmdW5jdGlvbiAkb25Jbml0KCkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIGxpc3Rlbih0aGlzLm1hcC5nZXRWaWV3KCksICdjaGFuZ2U6cm90YXRpb24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIF90aGlzMi51cGRhdGVSb3RhdGlvbl8oTWF0aC5yb3VuZChvbE1hdGgudG9EZWdyZWVzKGV2ZW50LnRhcmdldC5nZXRSb3RhdGlvbigpKSkpO1xuICAgIH0pO1xuICAgIHRoaXMuJHNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF90aGlzMi5nbWZBdXRoZW50aWNhdGlvblNlcnZpY2VfLmdldFJvbGVzSWRzKCkuam9pbignLCcpO1xuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzMi5nbWZQcmludFN0YXRlXy5zdGF0ZSA9IFByaW50U3RhdGVFbnVtLkNBUEFCSUxJVElFU19OT1RfTE9BREVEO1xuICAgICAgX3RoaXMyLmNhcGFiaWxpdGllc18gPSBudWxsO1xuICAgIH0pO1xuICAgIHRoaXMuJHNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF90aGlzMi5nbWZBdXRoZW50aWNhdGlvblNlcnZpY2VfLmdldEVtYWlsKCk7XG4gICAgfSwgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICBfdGhpczIuc210cEVtYWlsID0gbmV3VmFsdWU7XG4gICAgfSk7XG4gICAgdGhpcy4kc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMyLmFjdGl2ZTtcbiAgICB9LCBmdW5jdGlvbiAoYWN0aXZlKSB7XG4gICAgICBfdGhpczIudG9nZ2xlUHJpbnRQYW5lbF8oYWN0aXZlKTtcbiAgICB9KTtcbiAgICB0aGlzLiRyb290U2NvcGVfLiRvbignZ21mU3RhcnRQcmludCcsIGZ1bmN0aW9uIChldmVudCwgZm9ybWF0KSB7XG4gICAgICBfdGhpczIucHJpbnQoXCJcIiArIGZvcm1hdCk7XG4gICAgfSk7XG4gICAgdGhpcy4kcm9vdFNjb3BlXy4kb24oJ2dtZkNhbmNlbFByaW50JywgZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMyLmNhbmNlbCgpO1xuICAgIH0pO1xuICAgIHRoaXMuZ21mVGhlbWVzXy5nZXRPZ2NTZXJ2ZXJzT2JqZWN0KCkudGhlbihmdW5jdGlvbiAob2djU2VydmVyc09iamVjdCkge1xuICAgICAgX3RoaXMyLm9nY1NlcnZlcnNfID0gb2djU2VydmVyc09iamVjdDtcbiAgICB9KTtcbiAgICB0aGlzLmdtZlRoZW1lc18uZ2V0VGhlbWVzT2JqZWN0KCkudGhlbihmdW5jdGlvbiAoY3VycmVudFRoZW1lcykge1xuICAgICAgX3RoaXMyLmN1cnJlbnRUaGVtZXNfID0gY3VycmVudFRoZW1lcztcbiAgICB9KTtcblxuICAgIHZhciBnZXRTaXplRm4gPSBmdW5jdGlvbiBnZXRTaXplRm4oKSB7XG4gICAgICByZXR1cm4gX3RoaXMyLnBhcGVyU2l6ZV87XG4gICAgfTtcblxuICAgIHZhciBnZXRSb3RhdGlvbkZuO1xuXG4gICAgaWYgKHRoaXMucm90YXRlTWFzaykge1xuICAgICAgZ2V0Um90YXRpb25GbiA9IGZ1bmN0aW9uIGdldFJvdGF0aW9uRm4oKSB7XG4gICAgICAgIHJldHVybiBfdGhpczIucm90YXRpb247XG4gICAgICB9O1xuICAgIH1cblxuICAgIHRoaXMubWFza0xheWVyXy5nZXRTaXplID0gZ2V0U2l6ZUZuO1xuICAgIHRoaXMubWFza0xheWVyXy5nZXRTY2FsZSA9IHRoaXMuZ2V0U2NhbGVGbi5iaW5kKHRoaXMpO1xuICAgIHRoaXMubWFza0xheWVyXy5nZXRSb3RhdGlvbiA9IGdldFJvdGF0aW9uRm47XG4gIH07XG5cbiAgX3Byb3RvLmdldFNjYWxlRm4gPSBmdW5jdGlvbiBnZXRTY2FsZUZuKGZyYW1lU3RhdGUpIHtcbiAgICBpZiAodGhpcy5sYXlvdXRJbmZvLnNjYWxlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsYXlvdXRJbmZvLnNjYWxlJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmxheW91dEluZm8uc2NhbGVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbGF5b3V0SW5mby5zY2FsZXMnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuc2NhbGVNYW51YWxseVNlbGVjdGVkXyAmJiAodGhpcy5sYXlvdXRJbmZvLnNjYWxlID09PSAtMSB8fCB0aGlzLmxheW91dEluZm8uc2NhbGVzLmluY2x1ZGVzKHRoaXMubGF5b3V0SW5mby5zY2FsZSkpKSB7XG4gICAgICB2YXIgbWFwU2l6ZSA9IGZyYW1lU3RhdGUuc2l6ZTtcbiAgICAgIHZhciB2aWV3UmVzb2x1dGlvbiA9IGZyYW1lU3RhdGUudmlld1N0YXRlLnJlc29sdXRpb247XG4gICAgICB0aGlzLmxheW91dEluZm8uc2NhbGUgPSB0aGlzLmdldE9wdGltYWxTY2FsZV8obWFwU2l6ZSwgdmlld1Jlc29sdXRpb24pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmxheW91dEluZm8uc2NhbGU7XG4gIH07XG5cbiAgX3Byb3RvLnRvZ2dsZVByaW50UGFuZWxfID0gZnVuY3Rpb24gdG9nZ2xlUHJpbnRQYW5lbF8oYWN0aXZlKSB7XG4gICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICBpZiAoYWN0aXZlKSB7XG4gICAgICBpZiAoIXRoaXMuY2FwYWJpbGl0aWVzXykge1xuICAgICAgICB0aGlzLmdldENhcGFiaWxpdGllc18odGhpcy5nbWZBdXRoZW50aWNhdGlvblNlcnZpY2VfLmdldFJvbGVzSWRzKCkuam9pbignLCcpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF0aGlzLmNhcGFiaWxpdGllc18pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNhcGFiaWxpdGllcycpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNhcGFiaWxpdGllc18udGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgICAgICBpZiAoIV90aGlzMy5tYXApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIV90aGlzMy5hY3RpdmUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpczMuZ21mUHJpbnRTdGF0ZV8uc3RhdGUgPSBQcmludFN0YXRlRW51bS5OT1RfSU5fVVNFO1xuXG4gICAgICAgIF90aGlzMy5wYXJzZUNhcGFiaWxpdGllc18ocmVzcCk7XG5cbiAgICAgICAgX3RoaXMzLm1hcC5hZGRMYXllcihfdGhpczMubWFza0xheWVyXyk7XG5cbiAgICAgICAgX3RoaXMzLnBvaW50ZXJEcmFnTGlzdGVuZXJLZXlfID0gbGlzdGVuKF90aGlzMy5tYXAsICdwb2ludGVyZHJhZycsIF90aGlzMy5vblBvaW50ZXJEcmFnXywgX3RoaXMzKTtcbiAgICAgICAgX3RoaXMzLm1hcFZpZXdSZXNvbHV0aW9uQ2hhbmdlS2V5XyA9IGxpc3RlbihfdGhpczMubWFwLmdldFZpZXcoKSwgJ2NoYW5nZTpyZXNvbHV0aW9uJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzMy5zY2FsZU1hbnVhbGx5U2VsZWN0ZWRfID0gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIF90aGlzMy5tYXAucmVuZGVyKCk7XG4gICAgICB9LCBmdW5jdGlvbiAocmVzcCkge1xuICAgICAgICBfdGhpczMuZ21mUHJpbnRTdGF0ZV8uc3RhdGUgPSBQcmludFN0YXRlRW51bS5FUlJPUl9PTl9HRVRDQVBBQklMSVRJRVM7XG4gICAgICAgIF90aGlzMy5jYXBhYmlsaXRpZXNfID0gbnVsbDtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIXRoaXMubWFwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5tYXAucmVtb3ZlTGF5ZXIodGhpcy5tYXNrTGF5ZXJfKTtcblxuICAgICAgaWYgKHRoaXMucG9pbnRlckRyYWdMaXN0ZW5lcktleV8pIHtcbiAgICAgICAgdW5saXN0ZW5CeUtleSh0aGlzLnBvaW50ZXJEcmFnTGlzdGVuZXJLZXlfKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMubWFwVmlld1Jlc29sdXRpb25DaGFuZ2VLZXlfKSB7XG4gICAgICAgIHVubGlzdGVuQnlLZXkodGhpcy5tYXBWaWV3UmVzb2x1dGlvbkNoYW5nZUtleV8pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNldFJvdGF0aW9uKDApO1xuICAgICAgdGhpcy5tYXAucmVuZGVyKCk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5nZXRDYXBhYmlsaXRpZXNfID0gZnVuY3Rpb24gZ2V0Q2FwYWJpbGl0aWVzXyhyb2xlSWQpIHtcbiAgICB0aGlzLmNhcGFiaWxpdGllc18gPSB0aGlzLm5nZW9QcmludF8uZ2V0Q2FwYWJpbGl0aWVzKHtcbiAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZSxcbiAgICAgIHBhcmFtczoge1xuICAgICAgICAncm9sZSc6IHJvbGVJZCxcbiAgICAgICAgJ2NhY2hlX3ZlcnNpb24nOiB0aGlzLmNhY2hlVmVyc2lvbl9cbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8ucGFyc2VDYXBhYmlsaXRpZXNfID0gZnVuY3Rpb24gcGFyc2VDYXBhYmlsaXRpZXNfKHJlc3ApIHtcbiAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgIHZhciBkYXRhID0gcmVzcC5kYXRhO1xuICAgIHRoaXMuZm9ybWF0c18gPSBkYXRhLmZvcm1hdHMgfHwgW107XG4gICAgdGhpcy5sYXlvdXRzXyA9IGRhdGEubGF5b3V0cztcbiAgICB0aGlzLmxheW91dF8gPSBkYXRhLmxheW91dHNbMF07XG4gICAgdGhpcy5sYXlvdXRJbmZvLmxheW91dHMgPSBbXTtcbiAgICB0aGlzLmxheW91dHNfLmZvckVhY2goZnVuY3Rpb24gKGxheW91dCkge1xuICAgICAgX3RoaXM0LmxheW91dEluZm8ubGF5b3V0cy5wdXNoKGxheW91dC5uYW1lKTtcbiAgICB9KTtcbiAgICB0aGlzLnNtdHBTdXBwb3J0ZWQgPSBkYXRhLnNtdHAgJiYgZGF0YS5zbXRwLmVuYWJsZWQ7XG4gICAgdGhpcy51cGRhdGVGaWVsZHNfKCk7XG4gIH07XG5cbiAgX3Byb3RvLnVwZGF0ZUZpZWxkc18gPSBmdW5jdGlvbiB1cGRhdGVGaWVsZHNfKCkge1xuICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5sYXlvdXRfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbGF5b3V0Jyk7XG4gICAgfVxuXG4gICAgdGhpcy5sYXlvdXRJbmZvLmxheW91dCA9IHRoaXMubGF5b3V0Xy5uYW1lO1xuICAgIHZhciBtYXBJbmZvID0gdGhpcy5pc0F0dHJpYnV0ZUluQ3VycmVudExheW91dF8oJ21hcCcpO1xuXG4gICAgaWYgKCFtYXBJbmZvKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwSW5mbycpO1xuICAgIH1cblxuICAgIHZhciBjbGllbnRJbmZvID0gbWFwSW5mby5jbGllbnRJbmZvO1xuXG4gICAgaWYgKCFjbGllbnRJbmZvKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY2xpZW50SW5mbycpO1xuICAgIH1cblxuICAgIHRoaXMucGFwZXJTaXplXyA9IFtjbGllbnRJbmZvLndpZHRoLCBjbGllbnRJbmZvLmhlaWdodF07XG4gICAgdGhpcy51cGRhdGVDdXN0b21GaWVsZHNfKCk7XG4gICAgdmFyIGhhc0xlZ2VuZCA9IHRoaXMubGF5b3V0SW5mby5hdHRyaWJ1dGVzLmluY2x1ZGVzKCdsZWdlbmQnKTtcblxuICAgIGlmIChoYXNMZWdlbmQpIHtcbiAgICAgIHRoaXMuZmllbGRWYWx1ZXMubGVnZW5kID0gdGhpcy5maWVsZFZhbHVlcy5sZWdlbmQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRlbGV0ZSB0aGlzLmZpZWxkVmFsdWVzLmxlZ2VuZDtcbiAgICB9XG5cbiAgICB0aGlzLmxheW91dEluZm8uc2NhbGVzID0gY2xpZW50SW5mby5zY2FsZXMgfHwgW107XG4gICAgdGhpcy5sYXlvdXRJbmZvLmRwaXMgPSBjbGllbnRJbmZvLmRwaVN1Z2dlc3Rpb25zIHx8IFtdO1xuICAgIHZhciBtYXBTaXplID0gdGhpcy5tYXAuZ2V0U2l6ZSgpO1xuICAgIHZhciB2aWV3UmVzb2x1dGlvbiA9IHRoaXMubWFwLmdldFZpZXcoKS5nZXRSZXNvbHV0aW9uKCk7XG4gICAgdGhpcy5sYXlvdXRJbmZvLnNjYWxlID0gdGhpcy5nZXRPcHRpbWFsU2NhbGVfKG1hcFNpemUsIHZpZXdSZXNvbHV0aW9uKTtcbiAgICB0aGlzLmxheW91dEluZm8uZHBpID0gdGhpcy5sYXlvdXRJbmZvLmRwaSAmJiB0aGlzLmxheW91dEluZm8uZHBpcy5pbmRleE9mKHRoaXMubGF5b3V0SW5mby5kcGkpID4gMCA/IHRoaXMubGF5b3V0SW5mby5kcGkgOiB0aGlzLmxheW91dEluZm8uZHBpc1swXTtcbiAgICB0aGlzLmxheW91dEluZm8uZm9ybWF0cyA9IHt9O1xuICAgIHRoaXMuZm9ybWF0c18uZm9yRWFjaChmdW5jdGlvbiAoZm9ybWF0KSB7XG4gICAgICBfdGhpczUubGF5b3V0SW5mby5mb3JtYXRzW2Zvcm1hdF0gPSB0cnVlO1xuICAgIH0pO1xuICAgIHRoaXMuYXR0cmlidXRlc091dCA9IHRoaXMubGF5b3V0SW5mby5zaW1wbGVBdHRyaWJ1dGVzO1xuICAgIHRoaXMubWFwLnJlbmRlcigpO1xuICB9O1xuXG4gIF9wcm90by51cGRhdGVDdXN0b21GaWVsZHNfID0gZnVuY3Rpb24gdXBkYXRlQ3VzdG9tRmllbGRzXygpIHtcbiAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgIGlmICghdGhpcy5sYXlvdXRfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbGF5b3V0Jyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmxheW91dEluZm8uc2ltcGxlQXR0cmlidXRlcykge1xuICAgICAgdGhpcy5sYXlvdXRJbmZvLnNpbXBsZUF0dHJpYnV0ZXMgPSBbXTtcbiAgICB9XG5cbiAgICB0aGlzLmxheW91dEluZm8uYXR0cmlidXRlcyA9IFtdO1xuICAgIHZhciBzaW1wbGVBdHRyaWJ1dGVzID0gdGhpcy5sYXlvdXRJbmZvLnNpbXBsZUF0dHJpYnV0ZXM7XG4gICAgdmFyIHByZXZpb3VzQXR0cmlidXRlcyA9IHNpbXBsZUF0dHJpYnV0ZXMuc3BsaWNlKDAsIHNpbXBsZUF0dHJpYnV0ZXMubGVuZ3RoKTtcbiAgICB0aGlzLmxheW91dF8uYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgIF90aGlzNi5sYXlvdXRJbmZvLmF0dHJpYnV0ZXMucHVzaChhdHRyaWJ1dGUubmFtZSk7XG5cbiAgICAgIGlmICghYXR0cmlidXRlLmNsaWVudFBhcmFtcykge1xuICAgICAgICB2YXIgbmFtZSA9IFwiXCIgKyBhdHRyaWJ1dGUubmFtZTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IGF0dHJpYnV0ZS5kZWZhdWx0O1xuICAgICAgICB2YXIgdmFsdWUgPSBkZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCAmJiBkZWZhdWx0VmFsdWUgIT09ICcnID8gXCJcIiArIGRlZmF1bHRWYWx1ZSA6IG5hbWUgaW4gX3RoaXM2LmZpZWxkVmFsdWVzID8gXCJcIiArIF90aGlzNi5maWVsZFZhbHVlc1tuYW1lXSA6ICcnO1xuICAgICAgICB2YXIgcmF3VHlwZSA9IFwiXCIgKyBhdHRyaWJ1dGUudHlwZTtcbiAgICAgICAgdmFyIHR5cGU7XG5cbiAgICAgICAgc3dpdGNoIChyYXdUeXBlKSB7XG4gICAgICAgICAgY2FzZSAnU3RyaW5nJzpcbiAgICAgICAgICAgIHR5cGUgPSBuYW1lID09PSAnY29tbWVudHMnID8gJ3RleHRhcmVhJyA6ICd0ZXh0JztcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnQm9vbGVhbic6XG4gICAgICAgICAgICB0eXBlID0gJ2NoZWNrYm94JztcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnTnVtYmVyJzpcbiAgICAgICAgICAgIHR5cGUgPSAnbnVtYmVyJztcbiAgICAgICAgICAgIHZhciBudW1iZXJWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICAgICAgdmFsdWUgPSBpc05hTihudW1iZXJWYWx1ZSkgPyAnMCcgOiBcIlwiICsgdmFsdWU7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0eXBlID0gcmF3VHlwZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByZXZpb3VzQXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgaWYgKGMubmFtZSA9PT0gbmFtZSAmJiBjLnR5cGUgPT09IHR5cGUpIHtcbiAgICAgICAgICAgIHZhbHVlID0gYy52YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIF90aGlzNi5sYXlvdXRJbmZvLnNpbXBsZUF0dHJpYnV0ZXMucHVzaCh7XG4gICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uaXNBdHRyaWJ1dGVJbkN1cnJlbnRMYXlvdXRfID0gZnVuY3Rpb24gaXNBdHRyaWJ1dGVJbkN1cnJlbnRMYXlvdXRfKG5hbWUpIHtcbiAgICBpZiAoIXRoaXMubGF5b3V0Xykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGxheW91dCcpO1xuICAgIH1cblxuICAgIHZhciBhdHRyID0gbnVsbDtcbiAgICB0aGlzLmxheW91dF8uYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PT0gbmFtZSkge1xuICAgICAgICBhdHRyID0gYXR0cmlidXRlO1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBhdHRyO1xuICB9O1xuXG4gIF9wcm90by5zZXRSb3RhdGlvbiA9IGZ1bmN0aW9uIHNldFJvdGF0aW9uKHJvdGF0aW9uKSB7XG4gICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlUm90YXRpb25fKHJvdGF0aW9uKTtcblxuICAgIGlmICh0aGlzLnJvdGF0ZU1hc2spIHtcbiAgICAgIHRoaXMubWFwLnJlbmRlcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1hcC5nZXRWaWV3KCkuc2V0Um90YXRpb24ob2xNYXRoLnRvUmFkaWFucyh0aGlzLnJvdGF0aW9uKSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by51cGRhdGVSb3RhdGlvbl8gPSBmdW5jdGlvbiB1cGRhdGVSb3RhdGlvbl8ocm90YXRpb24pIHtcbiAgICB0aGlzLnJvdGF0aW9uID0gb2xNYXRoLmNsYW1wKHJvdGF0aW9uLCAtMTgwLCAxODApO1xuICAgIHRoaXMucm90YXRpb25JbnB1dF8udmFsKHRoaXMucm90YXRpb24udG9TdHJpbmcoKSk7XG4gIH07XG5cbiAgX3Byb3RvLm9uUG9pbnRlckRyYWdfID0gZnVuY3Rpb24gb25Qb2ludGVyRHJhZ18oZSkge1xuICAgIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gICAgaWYgKGUgaW5zdGFuY2VvZiBNYXBCcm93c2VyUG9pbnRlckV2ZW50ICYmIHRoaXMub25EcmFnUHJldmlvdXNNb3VzZVBvc2l0aW9uXyAmJiB0aGlzLm1hcCkge1xuICAgICAgdmFyIG9yaWdpbmFsRXZlbnQgPSBlLm9yaWdpbmFsRXZlbnQ7XG5cbiAgICAgIGlmIChvcmlnaW5hbEV2ZW50IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICB2YXIgbWFwQ2VudGVyID0gdGhpcy5tYXAuZ2V0VmlldygpLmdldENlbnRlcigpO1xuXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZSAmJiBvcmlnaW5hbEV2ZW50LmFsdEtleSAmJiBvcmlnaW5hbEV2ZW50LnNoaWZ0S2V5ICYmIG1hcENlbnRlcikge1xuICAgICAgICAgIHZhciBjZW50ZXIgPSB0aGlzLm1hcC5nZXRQaXhlbEZyb21Db29yZGluYXRlKG1hcENlbnRlcik7XG4gICAgICAgICAgdmFyIHBpeGVsID0gZS5waXhlbDtcblxuICAgICAgICAgIGlmICh0aGlzLnJvdGF0aW9uVGltZW91dFByb21pc2VfID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm9uRHJhZ1ByZXZpb3VzTW91c2VQb3NpdGlvbl8gPSBudWxsO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiR0aW1lb3V0Xy5jYW5jZWwodGhpcy5yb3RhdGlvblRpbWVvdXRQcm9taXNlXyk7XG4gICAgICAgICAgICB2YXIgcDB4ID0gdGhpcy5vbkRyYWdQcmV2aW91c01vdXNlUG9zaXRpb25fWzBdIC0gY2VudGVyWzBdO1xuICAgICAgICAgICAgdmFyIHAweSA9IHRoaXMub25EcmFnUHJldmlvdXNNb3VzZVBvc2l0aW9uX1sxXSAtIGNlbnRlclsxXTtcbiAgICAgICAgICAgIHZhciBwMXggPSBwaXhlbFswXSAtIGNlbnRlclswXTtcbiAgICAgICAgICAgIHZhciBwMXkgPSBwaXhlbFsxXSAtIGNlbnRlclsxXTtcbiAgICAgICAgICAgIHZhciBjZW50ZXJUb1AwID0gTWF0aC5zcXJ0KE1hdGgucG93KHAweCwgMikgKyBNYXRoLnBvdyhwMHksIDIpKTtcbiAgICAgICAgICAgIHZhciBjZW50ZXJUb1AxID0gTWF0aC5zcXJ0KE1hdGgucG93KHAxeCwgMikgKyBNYXRoLnBvdyhwMXksIDIpKTtcbiAgICAgICAgICAgIHZhciBzZW5zZSA9IHAweCAqIHAxeSAtIHAweSAqIHAxeCA+IDAgPyAxIDogLTE7XG4gICAgICAgICAgICB2YXIgYW5nbGUgPSAocDB4ICogcDF4ICsgcDB5ICogcDF5KSAvIChjZW50ZXJUb1AwICogY2VudGVyVG9QMSk7XG4gICAgICAgICAgICBhbmdsZSA9IGFuZ2xlIDw9IDEgPyBzZW5zZSAqIE1hdGguYWNvcyhhbmdsZSkgOiAwO1xuICAgICAgICAgICAgdmFyIGJvb3N0ID0gY2VudGVyVG9QMSAvIDIwMDtcbiAgICAgICAgICAgIHZhciBpbmNyZW1lbnQgPSBNYXRoLnJvdW5kKG9sTWF0aC50b0RlZ3JlZXMoYW5nbGUpICogYm9vc3QpO1xuICAgICAgICAgICAgdGhpcy5zZXRSb3RhdGlvbih0aGlzLnJvdGF0aW9uICsgaW5jcmVtZW50KTtcbiAgICAgICAgICAgIHRoaXMuJHNjb3BlXy4kZGlnZXN0KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5yb3RhdGlvblRpbWVvdXRQcm9taXNlXyA9IHRoaXMuJHRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzNy5yb3RhdGlvblRpbWVvdXRQcm9taXNlXyA9IG51bGw7XG4gICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgICB0aGlzLm9uRHJhZ1ByZXZpb3VzTW91c2VQb3NpdGlvbl8gPSBwaXhlbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ucHJpbnQgPSBmdW5jdGlvbiBwcmludChmb3JtYXQpIHtcbiAgICBpZiAoIXRoaXMubWFwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm9nY1NlcnZlcnNfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgb2djU2VydmVyc18nKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5nbWZQcmludFN0YXRlXy5zdGF0ZSA9PT0gUHJpbnRTdGF0ZUVudW0uUFJJTlRJTkcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnJlcXVlc3RDYW5jZWxlcl8gPSB0aGlzLiRxXy5kZWZlcigpO1xuICAgIHRoaXMuZ21mUHJpbnRTdGF0ZV8uc3RhdGUgPSBQcmludFN0YXRlRW51bS5QUklOVElORztcbiAgICB2YXIgbWFwU2l6ZSA9IHRoaXMubWFwLmdldFNpemUoKTtcbiAgICB2YXIgdmlld1Jlc29sdXRpb24gPSB0aGlzLm1hcC5nZXRWaWV3KCkuZ2V0UmVzb2x1dGlvbigpIHx8IDA7XG4gICAgdmFyIHNjYWxlID0gdGhpcy5sYXlvdXRJbmZvLnNjYWxlIHx8IHRoaXMuZ2V0T3B0aW1hbFNjYWxlXyhtYXBTaXplLCB2aWV3UmVzb2x1dGlvbik7XG4gICAgdmFyIGRhdGFzb3VyY2UgPSB0aGlzLmdldERhdGFTb3VyY2VfKCk7XG4gICAgdmFyIGN1c3RvbUF0dHJpYnV0ZXMgPSB7fTtcblxuICAgIGlmICh0aGlzLmxheW91dEluZm8uYXR0cmlidXRlcy5pbmNsdWRlcygnZGF0YXNvdXJjZScpKSB7XG4gICAgICBjdXN0b21BdHRyaWJ1dGVzLmRhdGFzb3VyY2UgPSBkYXRhc291cmNlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmxheW91dEluZm8uc2ltcGxlQXR0cmlidXRlcykge1xuICAgICAgdGhpcy5sYXlvdXRJbmZvLnNpbXBsZUF0dHJpYnV0ZXMuZm9yRWFjaChmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgY3VzdG9tQXR0cmlidXRlc1tmaWVsZC5uYW1lXSA9IGZpZWxkLnZhbHVlO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubGF5b3V0SW5mby5sZWdlbmQpIHtcbiAgICAgIHZhciBjZW50ZXIgPSB0aGlzLm1hcC5nZXRWaWV3KCkuZ2V0Q2VudGVyKCk7XG5cbiAgICAgIGlmICghY2VudGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjZW50ZXInKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGRlbHRhWCA9IHRoaXMucGFwZXJTaXplX1swXSAqIHNjYWxlIC8gMiAvIElOQ0hFU19QRVJfTUVURVIgLyBET1RTX1BFUl9JTkNIO1xuICAgICAgdmFyIGRlbHRhWSA9IHRoaXMucGFwZXJTaXplX1sxXSAqIHNjYWxlIC8gMiAvIElOQ0hFU19QRVJfTUVURVIgLyBET1RTX1BFUl9JTkNIO1xuICAgICAgdmFyIGJib3ggPSBbY2VudGVyWzBdIC0gZGVsdGFYLCBjZW50ZXJbMV0gLSBkZWx0YVksIGNlbnRlclswXSArIGRlbHRhWCwgY2VudGVyWzFdICsgZGVsdGFZXTtcbiAgICAgIHZhciBsZWdlbmQgPSB0aGlzLmdldExlZ2VuZF8oc2NhbGUsIHRoaXMubGF5b3V0SW5mby5kcGksIGJib3gpO1xuXG4gICAgICBpZiAobGVnZW5kICE9PSBudWxsKSB7XG4gICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMubGVnZW5kID0gbGVnZW5kO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdGhpcy5sYXlvdXRJbmZvLmRwaSAhPSAnbnVtYmVyJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBsYXlvdXRJbmZvLmRwaSB0eXBlJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB0aGlzLmxheW91dEluZm8ubGF5b3V0ICE9ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGxheW91dEluZm8ubGF5b3V0IHR5cGUnKTtcbiAgICB9XG5cbiAgICB2YXIgbWFwID0gbmV3IG9sTWFwKHt9KTtcbiAgICBtYXAuc2V0Vmlldyh0aGlzLm1hcC5nZXRWaWV3KCkpO1xuICAgIHZhciBvbF9sYXllcnMgPSB0aGlzLm5nZW9MYXllckhlbHBlcl8uZ2V0RmxhdExheWVycyh0aGlzLm1hcC5nZXRMYXllckdyb3VwKCkpO1xuICAgIHZhciBuZXdfb2xfbGF5ZXJzID0gW107XG4gICAgdmFyIHByaW50X25hdGl2ZV9hbmdsZSA9IHRydWU7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBvbF9sYXllcnMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgdmFyIGxheWVyID0gb2xfbGF5ZXJzW2ldO1xuICAgICAgdmFyIG1ldGFkYXRhID0gbGF5ZXIuZ2V0KCdtZXRhZGF0YScpO1xuXG4gICAgICBpZiAobWV0YWRhdGEpIHtcbiAgICAgICAgdmFyIHNlcnZlcl9uYW1lID0gbWV0YWRhdGEub2djU2VydmVyO1xuICAgICAgICB2YXIgbGF5ZXJfbmFtZXMgPSBtZXRhZGF0YS5wcmludExheWVycyB8fCBtZXRhZGF0YS5sYXllcnM7XG5cbiAgICAgICAgaWYgKHNlcnZlcl9uYW1lICYmIGxheWVyX25hbWVzKSB7XG4gICAgICAgICAgdmFyIHNlcnZlciA9IHRoaXMub2djU2VydmVyc19bc2VydmVyX25hbWVdO1xuXG4gICAgICAgICAgaWYgKHNlcnZlcikge1xuICAgICAgICAgICAgbGF5ZXIgPSB0aGlzLm5nZW9MYXllckhlbHBlcl8uY3JlYXRlQmFzaWNXTVNMYXllcihzZXJ2ZXIudXJsLCBsYXllcl9uYW1lcywgc2VydmVyLmltYWdlVHlwZSwgc2VydmVyLnR5cGUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwge1xuICAgICAgICAgICAgICBvcGFjaXR5OiBsYXllci5nZXQoJ29wYWNpdHknKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsYXllci5zZXRaSW5kZXgoLTIwMCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01pc3Npbmcgb2djU2VydmVyOicsIHNlcnZlcl9uYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckltYWdlICYmIGxheWVyLmdldCgncHJpbnROYXRpdmVBbmdsZScpID09PSBmYWxzZSkge1xuICAgICAgICBwcmludF9uYXRpdmVfYW5nbGUgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgbmV3X29sX2xheWVycy5wdXNoKGxheWVyKTtcbiAgICB9XG5cbiAgICB2YXIgZ3JvdXAgPSBuZXcgb2xMYXllckdyb3VwKHtcbiAgICAgIGxheWVyczogbmV3X29sX2xheWVyc1xuICAgIH0pO1xuICAgIGdyb3VwLnNldCgncHJpbnROYXRpdmVBbmdsZScsIHByaW50X25hdGl2ZV9hbmdsZSk7XG4gICAgbWFwLnNldExheWVyR3JvdXAoZ3JvdXApO1xuICAgIHZhciBlbWFpbCA9IHRoaXMuc210cFN1cHBvcnRlZCAmJiB0aGlzLnNtdHBFbWFpbCAmJiB0aGlzLnNtdHBFbmFibGVkID8gdGhpcy5zbXRwRW1haWwgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHNwZWMgPSB0aGlzLm5nZW9QcmludF8uY3JlYXRlU3BlYyhtYXAsIHNjYWxlLCB0aGlzLmxheW91dEluZm8uZHBpLCB0aGlzLmxheW91dEluZm8ubGF5b3V0LCBmb3JtYXQsIGN1c3RvbUF0dHJpYnV0ZXMsIGVtYWlsKTtcbiAgICB2YXIgbGF5ZXJzID0gW107XG4gICAgdGhpcy5uZ2VvUHJpbnRfLmVuY29kZUxheWVyKGxheWVycywgdGhpcy5mZWF0dXJlT3ZlcmxheUxheWVyXywgdmlld1Jlc29sdXRpb24pO1xuXG4gICAgaWYgKGxheWVycy5sZW5ndGggPiAwKSB7XG4gICAgICBzcGVjLmF0dHJpYnV0ZXMubWFwLmxheWVycy51bnNoaWZ0KGxheWVyc1swXSk7XG4gICAgfVxuXG4gICAgdGhpcy5uZ2VvUHJpbnRfLmNyZWF0ZVJlcG9ydChzcGVjLCB7XG4gICAgICB0aW1lb3V0OiB0aGlzLnJlcXVlc3RDYW5jZWxlcl8ucHJvbWlzZVxuICAgIH0pLnRoZW4odGhpcy5oYW5kbGVDcmVhdGVSZXBvcnRTdWNjZXNzXy5iaW5kKHRoaXMpLCB0aGlzLmhhbmRsZUNyZWF0ZVJlcG9ydEVycm9yXy5iaW5kKHRoaXMpKTtcbiAgICBtYXAuc2V0VGFyZ2V0KCcnKTtcbiAgfTtcblxuICBfcHJvdG8uY2FuY2VsID0gZnVuY3Rpb24gY2FuY2VsKCkge1xuICAgIGlmICh0aGlzLnJlcXVlc3RDYW5jZWxlcl8gIT09IG51bGwpIHtcbiAgICAgIHRoaXMucmVxdWVzdENhbmNlbGVyXy5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3RhdHVzVGltZW91dFByb21pc2VfICE9PSBudWxsKSB7XG4gICAgICB0aGlzLiR0aW1lb3V0Xy5jYW5jZWwodGhpcy5zdGF0dXNUaW1lb3V0UHJvbWlzZV8pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmN1clJlZl8ubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5uZ2VvUHJpbnRfLmNhbmNlbCh0aGlzLmN1clJlZl8pO1xuICAgIH1cblxuICAgIHRoaXMucmVzZXRQcmludFN0YXRlc18oKTtcbiAgfTtcblxuICBfcHJvdG8ucmVzZXRQcmludFN0YXRlc18gPSBmdW5jdGlvbiByZXNldFByaW50U3RhdGVzXyhvcHRfcHJpbnRTdGF0ZSkge1xuICAgIHRoaXMuZ21mUHJpbnRTdGF0ZV8uc3RhdGUgPSBvcHRfcHJpbnRTdGF0ZSB8fCBQcmludFN0YXRlRW51bS5OT1RfSU5fVVNFO1xuICAgIHRoaXMuY3VyUmVmXyA9ICcnO1xuICB9O1xuXG4gIF9wcm90by5nZXREYXRhU291cmNlXyA9IGZ1bmN0aW9uIGdldERhdGFTb3VyY2VfKCkge1xuICAgIHZhciBfdGhpczggPSB0aGlzO1xuXG4gICAgdmFyIGRhdGFzb3VyY2VBcnIgPSBbXTtcbiAgICB2YXIgc291cmNlcyA9IHRoaXMubmdlb1F1ZXJ5UmVzdWx0Xy5zb3VyY2VzO1xuICAgIHNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICB2YXIgZGF0YSA9IFtdO1xuICAgICAgdmFyIGNvbHVtbnMgPSBbXTtcbiAgICAgIHNvdXJjZS5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlLCBpKSB7XG4gICAgICAgIGlmICghZmVhdHVyZSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlJyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcHJvcGVydGllcyA9IGdldEZpbHRlcmVkRmVhdHVyZVZhbHVlcyhmZWF0dXJlKTtcblxuICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgIGNvbHVtbnMgPSBPYmplY3Qua2V5cyhwcm9wZXJ0aWVzKS5tYXAoZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpczgudHJhbnNsYXRlXyhwcm9wKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRhdGEucHVzaChPYmplY3Qua2V5cyhwcm9wZXJ0aWVzKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzW2tleV07XG4gICAgICAgIH0pKTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGRhdGFzb3VyY2VPYmogPSB7XG4gICAgICAgICAgdGl0bGU6IF90aGlzOC50cmFuc2xhdGVfKHNvdXJjZS5sYWJlbCksXG4gICAgICAgICAgdGFibGU6IHtcbiAgICAgICAgICAgIGNvbHVtbnM6IGNvbHVtbnMsXG4gICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBkYXRhc291cmNlQXJyLnB1c2goZGF0YXNvdXJjZU9iaik7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGFzb3VyY2VBcnI7XG4gIH07XG5cbiAgX3Byb3RvLmdldE9wdGltYWxTY2FsZV8gPSBmdW5jdGlvbiBnZXRPcHRpbWFsU2NhbGVfKG1hcFNpemUsIHZpZXdSZXNvbHV0aW9uKSB7XG4gICAgdmFyIHNjYWxlcyA9IHRoaXMubGF5b3V0SW5mby5zY2FsZXMuc2xpY2UoKTtcblxuICAgIGlmIChtYXBTaXplICE9PSB1bmRlZmluZWQgJiYgdmlld1Jlc29sdXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFyIHNjYWxlID0gdGhpcy5uZ2VvUHJpbnRVdGlsc18uZ2V0T3B0aW1hbFNjYWxlKG1hcFNpemUsIHZpZXdSZXNvbHV0aW9uLCB0aGlzLnBhcGVyU2l6ZV8sIHNjYWxlcy5yZXZlcnNlKCkpO1xuXG4gICAgICBpZiAoc2NhbGUgPiAwKSB7XG4gICAgICAgIHJldHVybiBzY2FsZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5sYXlvdXRJbmZvLnNjYWxlc1t0aGlzLmxheW91dEluZm8uc2NhbGVzLmxlbmd0aCAtIDFdO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVDcmVhdGVSZXBvcnRTdWNjZXNzXyA9IGZ1bmN0aW9uIGhhbmRsZUNyZWF0ZVJlcG9ydFN1Y2Nlc3NfKHJlc3ApIHtcbiAgICBpZiAodGhpcy5zbXRwU3VwcG9ydGVkICYmIHRoaXMuc210cEVtYWlsICYmIHRoaXMuc210cEVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc210cE1lc3NhZ2UgPSB0cnVlO1xuICAgICAgdGhpcy5yZXNldFByaW50U3RhdGVzXygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgcmVmID0gcmVzcC5kYXRhLnJlZjtcblxuICAgICAgaWYgKCFyZWYubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgcmVmJyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY3VyUmVmXyA9IHJlZjtcbiAgICAgIHRoaXMuZ2V0U3RhdHVzXyhyZWYpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uZ2V0U3RhdHVzXyA9IGZ1bmN0aW9uIGdldFN0YXR1c18ocmVmKSB7XG4gICAgdGhpcy5yZXF1ZXN0Q2FuY2VsZXJfID0gdGhpcy4kcV8uZGVmZXIoKTtcbiAgICB0aGlzLm5nZW9QcmludF8uZ2V0U3RhdHVzKHJlZiwge1xuICAgICAgdGltZW91dDogdGhpcy5yZXF1ZXN0Q2FuY2VsZXJfLnByb21pc2VcbiAgICB9KS50aGVuKHRoaXMuaGFuZGxlR2V0U3RhdHVzU3VjY2Vzc18uYmluZCh0aGlzLCByZWYpLCB0aGlzLmhhbmRsZUNyZWF0ZVJlcG9ydEVycm9yXy5iaW5kKHRoaXMpKTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlR2V0U3RhdHVzU3VjY2Vzc18gPSBmdW5jdGlvbiBoYW5kbGVHZXRTdGF0dXNTdWNjZXNzXyhyZWYsIHJlc3ApIHtcbiAgICB2YXIgX3RoaXM5ID0gdGhpcztcblxuICAgIHZhciBtZlJlc3AgPSByZXNwLmRhdGE7XG4gICAgdmFyIGRvbmUgPSBtZlJlc3AuZG9uZTtcblxuICAgIGlmIChkb25lKSB7XG4gICAgICBpZiAobWZSZXNwLnN0YXR1cyAhPSAnZXJyb3InKSB7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdGhpcy5uZ2VvUHJpbnRfLmdldFJlcG9ydFVybChyZWYpO1xuICAgICAgICB0aGlzLnJlc2V0UHJpbnRTdGF0ZXNfKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKG1mUmVzcC5lcnJvcik7XG4gICAgICAgIHRoaXMuaGFuZGxlQ3JlYXRlUmVwb3J0RXJyb3JfKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhdHVzVGltZW91dFByb21pc2VfID0gdGhpcy4kdGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczkuZ2V0U3RhdHVzXyhyZWYpO1xuICAgICAgfSwgMTAwMCwgZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlQ3JlYXRlUmVwb3J0RXJyb3JfID0gZnVuY3Rpb24gaGFuZGxlQ3JlYXRlUmVwb3J0RXJyb3JfKCkge1xuICAgIHRoaXMucmVzZXRQcmludFN0YXRlc18oUHJpbnRTdGF0ZUVudW0uRVJST1JfT05fUkVQT1JUKTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0TGVnZW5kXyA9IGZ1bmN0aW9uIGdldExlZ2VuZF8oc2NhbGUsIGRwaSwgYmJveCkge1xuICAgIHZhciBfdGhpczEwID0gdGhpcztcblxuICAgIGlmICghdGhpcy5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICB2YXIgbGVnZW5kID0ge1xuICAgICAgY2xhc3NlczogW11cbiAgICB9O1xuICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICAgIHZhciBkYXRhTGF5ZXJHcm91cCA9IHRoaXMubmdlb0xheWVySGVscGVyXy5nZXRHcm91cEZyb21NYXAodGhpcy5tYXAsIERBVEFMQVlFUkdST1VQX05BTUUpO1xuICAgIHZhciBsYXllcnMgPSB0aGlzLm5nZW9MYXllckhlbHBlcl8uZ2V0RmxhdExheWVycyhkYXRhTGF5ZXJHcm91cCk7XG4gICAgbGF5ZXJzLnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uIChsYXllcikge1xuICAgICAgaWYgKCFfdGhpczEwLm1hcCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBjbGFzc2VzID0gW107XG5cbiAgICAgIGlmIChsYXllci5nZXRWaXNpYmxlKCkgJiYgbGF5ZXIuZ2V0U291cmNlKCkpIHtcbiAgICAgICAgaWYgKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllclRpbGUpIHtcbiAgICAgICAgICB2YXIgbGF5ZXJOYW1lID0gXCJcIiArIGxheWVyLmdldCgnbGF5ZXJOb2RlTmFtZScpO1xuXG4gICAgICAgICAgdmFyIGljb25fZHBpID0gX3RoaXMxMC5nZXRNZXRhZGF0YUxlZ2VuZEltYWdlXyhsYXllck5hbWUsIGRwaSk7XG5cbiAgICAgICAgICBpZiAoIWljb25fZHBpKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gX3RoaXMxMC5uZ2VvTGF5ZXJIZWxwZXJfLmdldFdNVFNMZWdlbmRVUkwobGF5ZXIpO1xuXG4gICAgICAgICAgICBpZiAodXJsKSB7XG4gICAgICAgICAgICAgIGljb25fZHBpID0ge1xuICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgIGRwaTogNzJcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaWNvbl9kcGkpIHtcbiAgICAgICAgICAgIGNsYXNzZXMucHVzaCh7XG4gICAgICAgICAgICAgIG5hbWU6IGdldHRleHRDYXRhbG9nLmdldFN0cmluZyhsYXllck5hbWUpLFxuICAgICAgICAgICAgICBpY29uczogW2ljb25fZHBpLnVybF1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgc291cmNlID0gbGF5ZXIuZ2V0U291cmNlKCk7XG5cbiAgICAgICAgICBpZiAoIShzb3VyY2UgaW5zdGFuY2VvZiBJbWFnZVdNUykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV3Jvbmcgc291cmNlIHR5cGUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgbGF5ZXJOYW1lcyA9IHNvdXJjZS5nZXRQYXJhbXMoKS5MQVlFUlMuc3BsaXQoJywnKTtcbiAgICAgICAgICBsYXllck5hbWVzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIGlmICghX3RoaXMxMC5tYXApIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXNvdXJjZS5zZXJ2ZXJUeXBlXykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc291cmNlLnNlcnZlclR5cGVfJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpY29uX2RwaSA9IF90aGlzMTAuZ2V0TWV0YWRhdGFMZWdlbmRJbWFnZV8obmFtZSwgZHBpKTtcblxuICAgICAgICAgICAgdmFyIHR5cGUgPSBpY29uX2RwaSA/ICdpbWFnZScgOiBzb3VyY2Uuc2VydmVyVHlwZV87XG5cbiAgICAgICAgICAgIGlmICghaWNvbl9kcGkpIHtcbiAgICAgICAgICAgICAgdmFyIF91cmwgPSBfdGhpczEwLm5nZW9MYXllckhlbHBlcl8uZ2V0V01TTGVnZW5kVVJMKHNvdXJjZS5nZXRVcmwoKSwgbmFtZSwgc2NhbGUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHNvdXJjZS5zZXJ2ZXJUeXBlXywgZHBpLCBfdGhpczEwLmdtZkxlZ2VuZE9wdGlvbnNfLnVzZUJib3ggPyBiYm94IDogdW5kZWZpbmVkLCBfdGhpczEwLm1hcC5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpLmdldENvZGUoKSwgX3RoaXMxMC5nbWZMZWdlbmRPcHRpb25zXy5wYXJhbXNbc291cmNlLnNlcnZlclR5cGVfXSk7XG5cbiAgICAgICAgICAgICAgaWYgKCFfdXJsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHVybCcpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWNvbl9kcGkgPSB7XG4gICAgICAgICAgICAgICAgdXJsOiBfdXJsLFxuICAgICAgICAgICAgICAgIGRwaTogdHlwZSA9PT0gJ3FnaXMnID8gZHBpIDogNzJcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGljb25fZHBpICYmIG5hbWUubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgIGNsYXNzZXMucHVzaChPYmplY3QuYXNzaWduKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBfdGhpczEwLmdtZkxlZ2VuZE9wdGlvbnNfLmxhYmVsW3R5cGVdID09PSBmYWxzZSA/ICcnIDogZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKG5hbWUpLFxuICAgICAgICAgICAgICAgIGljb25zOiBbaWNvbl9kcGkudXJsXVxuICAgICAgICAgICAgICB9LCBpY29uX2RwaS5kcGkgIT0gNzIgPyB7XG4gICAgICAgICAgICAgICAgZHBpOiBpY29uX2RwaS5kcGlcbiAgICAgICAgICAgICAgfSA6IHt9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNsYXNzZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBsZWdlbmQuY2xhc3NlcyA9IGxlZ2VuZC5jbGFzc2VzLmNvbmNhdChjbGFzc2VzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gbGVnZW5kLmNsYXNzZXMubGVuZ3RoID4gMCA/IGxlZ2VuZCA6IG51bGw7XG4gIH07XG5cbiAgX3Byb3RvLmdldE1ldGFkYXRhTGVnZW5kSW1hZ2VfID0gZnVuY3Rpb24gZ2V0TWV0YWRhdGFMZWdlbmRJbWFnZV8obGF5ZXJOYW1lLCBkcGkpIHtcbiAgICBpZiAoZHBpID09PSB2b2lkIDApIHtcbiAgICAgIGRwaSA9IDcyO1xuICAgIH1cblxuICAgIHZhciBncm91cE5vZGUgPSBmaW5kR3JvdXBCeUxheWVyTm9kZU5hbWUodGhpcy5jdXJyZW50VGhlbWVzXywgbGF5ZXJOYW1lKTtcbiAgICB2YXIgZm91bmRfZHBpID0gZHBpO1xuICAgIHZhciBub2RlO1xuXG4gICAgaWYgKGdyb3VwTm9kZSAmJiBncm91cE5vZGUuY2hpbGRyZW4pIHtcbiAgICAgIG5vZGUgPSBmaW5kT2JqZWN0QnlOYW1lKGdyb3VwTm9kZS5jaGlsZHJlbiwgbGF5ZXJOYW1lKTtcbiAgICB9XG5cbiAgICB2YXIgbGVnZW5kSW1hZ2U7XG4gICAgdmFyIGhpRFBJTGVnZW5kSW1hZ2VzO1xuXG4gICAgaWYgKG5vZGUgJiYgbm9kZS5tZXRhZGF0YSkge1xuICAgICAgbGVnZW5kSW1hZ2UgPSBub2RlLm1ldGFkYXRhLmxlZ2VuZEltYWdlO1xuICAgICAgaGlEUElMZWdlbmRJbWFnZXMgPSBub2RlLm1ldGFkYXRhLmhpRFBJTGVnZW5kSW1hZ2VzO1xuICAgIH1cblxuICAgIHZhciBkaXN0ID0gTnVtYmVyLk1BWF9WQUxVRTtcblxuICAgIGlmIChsZWdlbmRJbWFnZSkge1xuICAgICAgZGlzdCA9IE1hdGguYWJzKE1hdGgubG9nKDcyIC8gZHBpKSk7XG4gICAgICBmb3VuZF9kcGkgPSA3MjtcbiAgICB9XG5cbiAgICBpZiAoaGlEUElMZWdlbmRJbWFnZXMpIHtcbiAgICAgIGZvciAodmFyIHN0cl9kcGkgaW4gaGlEUElMZWdlbmRJbWFnZXMpIHtcbiAgICAgICAgdmFyIG5ld19kcGkgPSBwYXJzZUZsb2F0KHN0cl9kcGkpO1xuICAgICAgICB2YXIgbmV3X2Rpc3QgPSBNYXRoLmFicyhNYXRoLmxvZyhuZXdfZHBpIC8gZHBpKSk7XG5cbiAgICAgICAgaWYgKG5ld19kaXN0IDwgZGlzdCkge1xuICAgICAgICAgIGRpc3QgPSBuZXdfZGlzdDtcbiAgICAgICAgICBmb3VuZF9kcGkgPSBuZXdfZHBpO1xuICAgICAgICAgIGxlZ2VuZEltYWdlID0gaGlEUElMZWdlbmRJbWFnZXNbc3RyX2RwaV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobGVnZW5kSW1hZ2UpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVybDogbGVnZW5kSW1hZ2UsXG4gICAgICAgIGRwaTogZm91bmRfZHBpXG4gICAgICB9O1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uc2V0TGF5b3V0ID0gZnVuY3Rpb24gc2V0TGF5b3V0KGxheW91dE5hbWUpIHtcbiAgICB2YXIgbGF5b3V0ID0gbnVsbDtcbiAgICB0aGlzLmxheW91dHNfLmZvckVhY2goZnVuY3Rpb24gKGwpIHtcbiAgICAgIGlmIChsLm5hbWUgPT09IGxheW91dE5hbWUpIHtcbiAgICAgICAgbGF5b3V0ID0gbDtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5sYXlvdXRfID0gbGF5b3V0O1xuICAgIHRoaXMudXBkYXRlRmllbGRzXygpO1xuICB9O1xuXG4gIF9wcm90by5nZXRTZXRTY2FsZSA9IGZ1bmN0aW9uIGdldFNldFNjYWxlKG9wdF9zY2FsZSkge1xuICAgIGlmIChvcHRfc2NhbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBtYXBTaXplID0gdGhpcy5tYXAuZ2V0U2l6ZSgpIHx8IFswLCAwXTtcbiAgICAgIHRoaXMubGF5b3V0SW5mby5zY2FsZSA9IG9wdF9zY2FsZTtcbiAgICAgIHZhciByZXMgPSB0aGlzLm5nZW9QcmludFV0aWxzXy5nZXRPcHRpbWFsUmVzb2x1dGlvbihtYXBTaXplLCB0aGlzLnBhcGVyU2l6ZV8sIG9wdF9zY2FsZSk7XG4gICAgICB2YXIgdmlldyA9IHRoaXMubWFwLmdldFZpZXcoKTtcbiAgICAgIHZhciBjb250cmFpblJlcyA9IHZpZXcuZ2V0Q29uc3RyYWludHMoKS5yZXNvbHV0aW9uKHJlcywgMSwgbWFwU2l6ZSk7XG4gICAgICB2aWV3LnNldFJlc29sdXRpb24oY29udHJhaW5SZXMpO1xuICAgICAgdGhpcy5tYXAucmVuZGVyKCk7XG4gICAgICB0aGlzLnNjYWxlTWFudWFsbHlTZWxlY3RlZF8gPSB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmxheW91dEluZm8uc2NhbGU7XG4gIH07XG5cbiAgX3Byb3RvLnNldERwaSA9IGZ1bmN0aW9uIHNldERwaShkcGkpIHtcbiAgICB0aGlzLmxheW91dEluZm8uZHBpID0gZHBpO1xuICB9O1xuXG4gIF9wcm90by5pc1N0YXRlID0gZnVuY3Rpb24gaXNTdGF0ZShzdGF0ZUVudW1LZXkpIHtcbiAgICByZXR1cm4gdGhpcy5nbWZQcmludFN0YXRlXy5zdGF0ZSA9PT0gUHJpbnRTdGF0ZUVudW1bc3RhdGVFbnVtS2V5XTtcbiAgfTtcblxuICBfcHJvdG8uY2xvc2VTbXRwTWVzc2FnZSA9IGZ1bmN0aW9uIGNsb3NlU210cE1lc3NhZ2UoKSB7XG4gICAgdGhpcy5zbXRwTWVzc2FnZSA9IGZhbHNlO1xuICB9O1xuXG4gIHJldHVybiBQcmludENvbnRyb2xsZXI7XG59KCk7XG5tb2R1bGUuY29udHJvbGxlcignR21mUHJpbnRDb250cm9sbGVyJywgUHJpbnRDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZQcmludENvbXBvbmVudCBmcm9tICdnbWYvcHJpbnQvY29tcG9uZW50LmpzJztcbmltcG9ydCAnLi9wcmludC5zY3NzJztcbmV4cG9ydCBkZWZhdWx0IGFuZ3VsYXIubW9kdWxlKCdnbWZQcmludE1vZHVsZScsIFtnbWZQcmludENvbXBvbmVudC5uYW1lXSk7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdlxcbiAgY2xhc3M9XCJnbWYtcHJvZmlsZS1jb250YWluZXIgcGFuZWxcIlxcbiAgbmctc2hvdz1cImN0cmwuYWN0aXZlXCI+XFxuXFxuICA8ZGl2XFxuICAgIGNsYXNzPVwibmdlby1wcm9maWxlXCJcXG4gICAgbmctc2hvdz1cIiFjdHJsLmlzRXJyb3JlZFwiXFxuICAgIG5nZW8tcHJvZmlsZT1cImN0cmwucHJvZmlsZURhdGFcIlxcbiAgICBuZ2VvLXByb2ZpbGUtaGlnaGxpZ2h0PVwiY3RybC5wcm9maWxlSGlnaGxpZ2h0XCJcXG4gICAgbmdlby1wcm9maWxlLW9wdGlvbnM9XCI6OmN0cmwucHJvZmlsZU9wdGlvbnNcIj5cXG4gIDwvZGl2PlxcblxcbiAgPHVsXFxuICAgIGNsYXNzPVwiZ21mLXByb2ZpbGUtbGVnZW5kXCJcXG4gICAgbmctc2hvdz1cIiFjdHJsLmlzRXJyb3JlZFwiPlxcblxcbiAgICA8bGkgbmctcmVwZWF0PVwibmFtZSBpbiA6OmN0cmwuZ2V0TGF5ZXJzTmFtZXMoKVwiPlxcbiAgICAgIDxpXFxuICAgICAgICBjbGFzcz1cImZhIGZhLW1pbnVzXCJcXG4gICAgICAgIG5nLXN0eWxlPVwiY3RybC5nZXRTdHlsZShuYW1lKVwiPjwvaT5cXG4gICAgICB7e25hbWUgfCB0cmFuc2xhdGV9fVxcbiAgICAgIDxzcGFuIG5nLWlmPVwiY3RybC5jdXJyZW50UG9pbnQuZWxldmF0aW9uc1tuYW1lXSAhPSBudWxsXCI+XFxuICAgICAge3tjdHJsLmN1cnJlbnRQb2ludC5lbGV2YXRpb25zW25hbWVdfX0mbmJzcDt7e2N0cmwuY3VycmVudFBvaW50LnlVbml0c319XFxuICAgICAgPC9zcGFuPlxcbiAgICA8L2xpPlxcbiAgPC91bD5cXG5cXG4gIDxkaXZcXG4gICAgY2xhc3M9XCJnbWYtcHJvZmlsZS1leHBvcnQgYnRuLWdyb3VwIGRyb3B1cFwiXFxuICAgIG5nLXNob3c9XCIhY3RybC5pc0Vycm9yZWRcIj5cXG5cXG4gICAgPGFcXG4gICAgICBjbGFzcz1cImRyb3Bkb3duLXRvZ2dsZVwiXFxuICAgICAgaHJlZj1cIlwiXFxuICAgICAgbmctc2hvdz1cImN0cmwucHJvZmlsZURhdGEubGVuZ3RoICE9PSAwXCJcXG4gICAgICBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJcXG4gICAgICBhcmlhLWV4cGFuZGVkPVwiZmFsc2VcIj5cXG4gICAgICB7e1xcJ0V4cG9ydFxcJyB8IHRyYW5zbGF0ZX19XFxuICAgIDwvYT5cXG5cXG4gICAgPHVsXFxuICAgICAgY2xhc3M9XCJkcm9wZG93bi1tZW51IGRyb3Bkb3duLW1lbnUtcmlnaHRcIlxcbiAgICAgIHJvbGU9XCJtZW51XCI+XFxuXFxuICAgICAgPGxpPlxcbiAgICAgIDxhXFxuICAgICAgICBocmVmPVwiXCJcXG4gICAgICAgIG5nLWNsaWNrPVwiOjpjdHJsLmRvd25sb2FkQ3N2KClcIj5cXG4gICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtdGFibGVcIj48L2k+Jm5ic3A7e3tcXCdEb3dubG9hZCBDU1ZcXCcgfCB0cmFuc2xhdGV9fTwvYT5cXG4gICAgICA8L2xpPlxcbiAgICA8L3VsPlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2XFxuICAgIGNsYXNzPVwiZ21mLXByb2ZpbGUtZXJyb3JcIlxcbiAgICBuZy1zaG93PVwiY3RybC5pc0Vycm9yZWRcIj5cXG5cXG4gICAgPHA+e3tcXCdUaGUgcHJvZmlsZSBzZXJ2aWNlIGRvZXMgbm90IHJlc3BvbmQsIHBsZWFzZSB0cnkgbGF0ZXIuXFwnIHwgdHJhbnNsYXRlfX08L3A+XFxuICA8L2Rpdj5cXG4gIDxkaXZcXG4gICAgY2xhc3M9XCJjbG9zZVwiXFxuICAgIG5nLWNsaWNrPVwiY3RybC5saW5lID0gbnVsbFwiPiZ0aW1lczs8L2Rpdj5cXG48L2Rpdj5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiUHJvZmlsZUNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRodHRwXCIsIFwiJGVsZW1lbnRcIiwgXCIkZmlsdGVyXCIsIFwiZ2V0dGV4dENhdGFsb2dcIiwgXCJuZ2VvRmVhdHVyZU92ZXJsYXlNZ3JcIiwgXCJnbWZQcm9maWxlSnNvblVybFwiLCBcIm5nZW9Dc3ZEb3dubG9hZFwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgbGlzdGVuLCB1bmxpc3RlbkJ5S2V5IH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgb2xPdmVybGF5IGZyb20gJ29sL092ZXJsYXkuanMnO1xuaW1wb3J0IG9sR2VvbUxpbmVTdHJpbmcgZnJvbSAnb2wvZ2VvbS9MaW5lU3RyaW5nLmpzJztcbmltcG9ydCBvbEdlb21Qb2ludCBmcm9tICdvbC9nZW9tL1BvaW50LmpzJztcbmltcG9ydCBvbFN0eWxlQ2lyY2xlIGZyb20gJ29sL3N0eWxlL0NpcmNsZS5qcyc7XG5pbXBvcnQgb2xTdHlsZUZpbGwgZnJvbSAnb2wvc3R5bGUvRmlsbC5qcyc7XG5pbXBvcnQgb2xTdHlsZVN0eWxlIGZyb20gJ29sL3N0eWxlL1N0eWxlLmpzJztcbmltcG9ydCBuZ2VvRG93bmxvYWRDc3YgZnJvbSAnbmdlby9kb3dubG9hZC9Dc3YuanMnO1xuaW1wb3J0IG5nZW9NYXBGZWF0dXJlT3ZlcmxheU1nciBmcm9tICduZ2VvL21hcC9GZWF0dXJlT3ZlcmxheU1nci5qcyc7XG5pbXBvcnQgbmdlb1Byb2ZpbGVFbGV2YXRpb25Db21wb25lbnQgZnJvbSAnbmdlby9wcm9maWxlL2VsZXZhdGlvbkNvbXBvbmVudC5qcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvZHJvcGRvd24uanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZQcm9maWxlJywgW25nZW9Eb3dubG9hZENzdi5uYW1lLCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXlNZ3IubmFtZSwgbmdlb1Byb2ZpbGVFbGV2YXRpb25Db21wb25lbnQubmFtZV0pO1xubW9kdWxlLnZhbHVlKCdnbWZQcm9maWxlVGVtcGxhdGVVcmwnLCBmdW5jdGlvbiAoJGVsZW1lbnQsICRhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSAkYXR0cnMuZ21mUHJvZmlsZVRlbXBsYXRldXJsO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ2dtZi9wcm9maWxlJztcbn0pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdnbWYvcHJvZmlsZScsIHJlcXVpcmUoJy4vY29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5nbWZQcm9maWxlVGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCIsIFwiZ21mUHJvZmlsZVRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBnbWZQcm9maWxlVGVtcGxhdGVVcmwoJGVsZW1lbnQsICRhdHRycywgZ21mUHJvZmlsZVRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBnbWZQcm9maWxlVGVtcGxhdGVVcmwoJGVsZW1lbnQsICRhdHRycyk7XG59XG5cbnZhciBwcm9maWxlQ29tcG9uZW50ID0ge1xuICBjb250cm9sbGVyOiAnR21mUHJvZmlsZUNvbnRyb2xsZXIgYXMgY3RybCcsXG4gIGJpbmRpbmdzOiB7XG4gICAgJ2FjdGl2ZSc6ICc9Z21mUHJvZmlsZUFjdGl2ZScsXG4gICAgJ2xpbmUnOiAnPWdtZlByb2ZpbGVMaW5lJyxcbiAgICAnZ2V0TWFwRm4nOiAnJj9nbWZQcm9maWxlTWFwJyxcbiAgICAnZ2V0TGluZXNDb25maWd1cmF0aW9uRm4nOiAnJmdtZlByb2ZpbGVMaW5lc2NvbmZpZ3VyYXRpb24nLFxuICAgICdnZXRIb3ZlclBvaW50U3R5bGVGbic6ICcmP2dtZlByb2ZpbGVIb3ZlcnBvaW50c3R5bGUnLFxuICAgICdnZXROYlBvaW50c0ZuJzogJyY/Z21mUHJvZmlsZU51bWJlcm9mcG9pbnRzJyxcbiAgICAnZ2V0T3B0aW9uc0ZuJzogJyY/Z21mUHJvZmlsZU9wdGlvbnMnXG4gIH0sXG4gIHRlbXBsYXRlVXJsOiBnbWZQcm9maWxlVGVtcGxhdGVVcmxcbn07XG5tb2R1bGUuY29tcG9uZW50KCdnbWZQcm9maWxlJywgcHJvZmlsZUNvbXBvbmVudCk7XG5leHBvcnQgZnVuY3Rpb24gUHJvZmlsZUNvbnRyb2xsZXIoJHNjb3BlLCAkaHR0cCwgJGVsZW1lbnQsICRmaWx0ZXIsIGdldHRleHRDYXRhbG9nLCBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IsIGdtZlByb2ZpbGVKc29uVXJsLCBuZ2VvQ3N2RG93bmxvYWQpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLiRzY29wZV8gPSAkc2NvcGU7XG4gIHRoaXMuJGh0dHBfID0gJGh0dHA7XG4gIHRoaXMuJGVsZW1lbnRfID0gJGVsZW1lbnQ7XG4gIHRoaXMuJGZpbHRlcl8gPSAkZmlsdGVyO1xuICB0aGlzLmdldHRleHRDYXRhbG9nXyA9IGdldHRleHRDYXRhbG9nO1xuICB0aGlzLnBvaW50SG92ZXJPdmVybGF5XyA9IG5nZW9GZWF0dXJlT3ZlcmxheU1nci5nZXRGZWF0dXJlT3ZlcmxheSgpO1xuICB0aGlzLmdtZlByb2ZpbGVKc29uVXJsXyA9IGdtZlByb2ZpbGVKc29uVXJsO1xuICB0aGlzLm5nZW9Dc3ZEb3dubG9hZF8gPSBuZ2VvQ3N2RG93bmxvYWQ7XG4gIHRoaXMubWFwXyA9IG51bGw7XG4gIHRoaXMubGluZXNDb25maWd1cmF0aW9uXyA9IG51bGw7XG4gIHRoaXMubGF5ZXJzTmFtZXNfID0gW107XG4gIHRoaXMubmJQb2ludHNfID0gMTAwO1xuICB0aGlzLmxpbmUgPSBudWxsO1xuICB0aGlzLnByb2ZpbGVEYXRhID0gW107XG4gIHRoaXMuY3VycmVudFBvaW50ID0ge1xuICAgIGVsZXZhdGlvbnM6IHt9XG4gIH07XG4gIHRoaXMucHJvZmlsZUhpZ2hsaWdodCA9IC0xO1xuICB0aGlzLm1lYXN1cmVUb29sdGlwXyA9IG51bGw7XG4gIHRoaXMubWVhc3VyZVRvb2x0aXBFbGVtZW50XyA9IG51bGw7XG4gIHRoaXMuc25hcHBlZFBvaW50XyA9IG5ldyBvbEZlYXR1cmUoKTtcbiAgdGhpcy5wb2ludEhvdmVyT3ZlcmxheV8uYWRkRmVhdHVyZSh0aGlzLnNuYXBwZWRQb2ludF8pO1xuICB0aGlzLnByb2ZpbGVMYWJlbHNfID0ge1xuICAgIHhBeGlzOiBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0Rpc3RhbmNlJyksXG4gICAgeUF4aXM6IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnRWxldmF0aW9uJylcbiAgfTtcbiAgdGhpcy5wcm9maWxlT3B0aW9ucyA9IG51bGw7XG4gIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gIHRoaXMucG9pbnRlck1vdmVLZXlfID0gbnVsbDtcbiAgdGhpcy5pc0Vycm9yZWQgPSBmYWxzZTtcblxuICB0aGlzLmdldE1hcEZuID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIHRoaXMuZ2V0TmJQb2ludHNGbiA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gMTAwO1xuICB9O1xuXG4gIHRoaXMuZ2V0SG92ZXJQb2ludFN0eWxlRm4gPSBudWxsO1xuXG4gIHRoaXMuZ2V0TGluZXNDb25maWd1cmF0aW9uRm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9O1xuXG4gIHRoaXMuZ2V0T3B0aW9uc0ZuID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7fTtcbiAgfTtcblxuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuYWN0aXZlO1xuICB9LCBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgaWYgKG9sZFZhbHVlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgX3RoaXMudXBkYXRlRXZlbnRzTGlzdGVuaW5nXygpO1xuICAgIH1cbiAgfSk7XG4gICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5saW5lO1xuICB9LCBmdW5jdGlvbiAobmV3TGluZSwgb2xkTGluZSkge1xuICAgIGlmIChvbGRMaW5lICE9PSBuZXdMaW5lKSB7XG4gICAgICBfdGhpcy51cGRhdGVfKCk7XG4gICAgfVxuICB9KTtcbiAgdGhpcy51cGRhdGVFdmVudHNMaXN0ZW5pbmdfKCk7XG59XG5cblByb2ZpbGVDb250cm9sbGVyLnByb3RvdHlwZS4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLm1hcF8gPSB0aGlzLmdldE1hcEZuKCk7XG4gIHRoaXMubmJQb2ludHNfID0gdGhpcy5nZXROYlBvaW50c0ZuKCk7XG4gIHZhciBob3ZlclBvaW50U3R5bGU7XG4gIHZhciBob3ZlclBvaW50U3R5bGVGbiA9IHRoaXMuZ2V0SG92ZXJQb2ludFN0eWxlRm47XG5cbiAgaWYgKGhvdmVyUG9pbnRTdHlsZUZuKSB7XG4gICAgaG92ZXJQb2ludFN0eWxlID0gaG92ZXJQb2ludFN0eWxlRm4oKTtcblxuICAgIGlmICghKGhvdmVyUG9pbnRTdHlsZSBpbnN0YW5jZW9mIG9sU3R5bGVTdHlsZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgaG92ZXJQb2ludFN0eWxlIHR5cGUnKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaG92ZXJQb2ludFN0eWxlID0gbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICBpbWFnZTogbmV3IG9sU3R5bGVDaXJjbGUoe1xuICAgICAgICBmaWxsOiBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgICAgIGNvbG9yOiAnI2ZmZmZmZidcbiAgICAgICAgfSksXG4gICAgICAgIHJhZGl1czogM1xuICAgICAgfSlcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMucG9pbnRIb3Zlck92ZXJsYXlfLnNldFN0eWxlKGhvdmVyUG9pbnRTdHlsZSk7XG4gIHRoaXMubGluZXNDb25maWd1cmF0aW9uXyA9IHRoaXMuZ2V0TGluZXNDb25maWd1cmF0aW9uRm4oKTtcblxuICBmb3IgKHZhciBuYW1lIGluIHRoaXMubGluZXNDb25maWd1cmF0aW9uXykge1xuICAgIHRoaXMubGF5ZXJzTmFtZXNfLnB1c2gobmFtZSk7XG4gICAgdmFyIGxpbmVDb25maWcgPSB0aGlzLmxpbmVzQ29uZmlndXJhdGlvbl9bbmFtZV07XG5cbiAgICBpZiAoIWxpbmVDb25maWcuekV4dHJhY3Rvcikge1xuICAgICAgdGhpcy5saW5lc0NvbmZpZ3VyYXRpb25fW25hbWVdLnpFeHRyYWN0b3IgPSB0aGlzLmdldFpGYWN0b3J5XyhuYW1lKTtcbiAgICB9XG4gIH1cblxuICB0aGlzLnByb2ZpbGVPcHRpb25zID0ge1xuICAgIGxpbmVzQ29uZmlndXJhdGlvbjogdGhpcy5saW5lc0NvbmZpZ3VyYXRpb25fLFxuICAgIGRpc3RhbmNlRXh0cmFjdG9yOiB0aGlzLmdldERpc3RfLFxuICAgIGhvdmVyQ2FsbGJhY2s6IHRoaXMuaG92ZXJDYWxsYmFja18uYmluZCh0aGlzKSxcbiAgICBvdXRDYWxsYmFjazogdGhpcy5vdXRDYWxsYmFja18uYmluZCh0aGlzKSxcbiAgICBpMThuOiB0aGlzLnByb2ZpbGVMYWJlbHNfXG4gIH07XG4gIHZhciBvcHRpb25zRm4gPSB0aGlzLmdldE9wdGlvbnNGbjtcblxuICBpZiAob3B0aW9uc0ZuKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBvcHRpb25zRm4oKTtcblxuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9wdGlvbnMnKTtcbiAgICB9XG5cbiAgICBPYmplY3QuYXNzaWduKHRoaXMucHJvZmlsZU9wdGlvbnMsIG9wdGlvbnMpO1xuICB9XG59O1xuXG5Qcm9maWxlQ29udHJvbGxlci5wcm90b3R5cGUudXBkYXRlXyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5pc0Vycm9yZWQgPSBmYWxzZTtcblxuICBpZiAodGhpcy5saW5lKSB7XG4gICAgdGhpcy5nZXRKc29uUHJvZmlsZV8oKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLnByb2ZpbGVEYXRhID0gW107XG4gIH1cblxuICB0aGlzLmFjdGl2ZSA9ICEhdGhpcy5saW5lO1xufTtcblxuUHJvZmlsZUNvbnRyb2xsZXIucHJvdG90eXBlLnVwZGF0ZUV2ZW50c0xpc3RlbmluZ18gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIGlmICh0aGlzLmFjdGl2ZSAmJiB0aGlzLm1hcF8gIT09IG51bGwpIHtcbiAgICB0aGlzLnBvaW50ZXJNb3ZlS2V5XyA9IGxpc3Rlbih0aGlzLm1hcF8sICdwb2ludGVybW92ZScsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgdmFyIGUgPSBldmVudDtcblxuICAgICAgaWYgKCFfdGhpczIubWFwXykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChlLmRyYWdnaW5nIHx8ICFfdGhpczIubGluZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBjb29yZGluYXRlID0gX3RoaXMyLm1hcF8uZ2V0RXZlbnRDb29yZGluYXRlKGUub3JpZ2luYWxFdmVudCk7XG5cbiAgICAgIHZhciBjbG9zZXN0UG9pbnQgPSBfdGhpczIubGluZS5nZXRDbG9zZXN0UG9pbnQoY29vcmRpbmF0ZSk7XG5cbiAgICAgIHZhciBldmVudFRvTGluZSA9IG5ldyBvbEdlb21MaW5lU3RyaW5nKFtjbG9zZXN0UG9pbnQsIGNvb3JkaW5hdGVdKTtcblxuICAgICAgdmFyIHJlc29sdXRpb24gPSBfdGhpczIubWFwXy5nZXRWaWV3KCkuZ2V0UmVzb2x1dGlvbigpO1xuXG4gICAgICBpZiAocmVzb2x1dGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyByZXNvbHV0aW9uJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBwaXhlbERpc3QgPSBldmVudFRvTGluZS5nZXRMZW5ndGgoKSAvIHJlc29sdXRpb247XG5cbiAgICAgIGlmIChwaXhlbERpc3QgPCAxNikge1xuICAgICAgICBfdGhpczIucHJvZmlsZUhpZ2hsaWdodCA9IF90aGlzMi5nZXREaXN0YW5jZU9uQUxpbmVfKGNsb3Nlc3RQb2ludCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpczIucHJvZmlsZUhpZ2hsaWdodCA9IC0xO1xuICAgICAgfVxuXG4gICAgICBfdGhpczIuJHNjb3BlXy4kYXBwbHkoKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBpZiAodGhpcy5wb2ludGVyTW92ZUtleV8pIHtcbiAgICAgIHVubGlzdGVuQnlLZXkodGhpcy5wb2ludGVyTW92ZUtleV8pO1xuICAgIH1cbiAgfVxufTtcblxuUHJvZmlsZUNvbnRyb2xsZXIucHJvdG90eXBlLmdldERpc3RhbmNlT25BTGluZV8gPSBmdW5jdGlvbiAocG9pbnRPbkxpbmUpIHtcbiAgaWYgKCF0aGlzLmxpbmUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbGluZScpO1xuICB9XG5cbiAgdmFyIHNlZ21lbnQ7XG4gIHZhciBkaXN0T25MaW5lID0gMDtcbiAgdmFyIGZha2VFeHRlbnQgPSBbcG9pbnRPbkxpbmVbMF0gLSAwLjUsIHBvaW50T25MaW5lWzFdIC0gMC41LCBwb2ludE9uTGluZVswXSArIDAuNSwgcG9pbnRPbkxpbmVbMV0gKyAwLjVdO1xuICB0aGlzLmxpbmUuZm9yRWFjaFNlZ21lbnQoZnVuY3Rpb24gKGZpcnN0UG9pbnQsIGxhc3RQb2ludCkge1xuICAgIHNlZ21lbnQgPSBuZXcgb2xHZW9tTGluZVN0cmluZyhbZmlyc3RQb2ludCwgbGFzdFBvaW50XSk7XG5cbiAgICBpZiAoc2VnbWVudC5pbnRlcnNlY3RzRXh0ZW50KGZha2VFeHRlbnQpKSB7XG4gICAgICBzZWdtZW50LnNldENvb3JkaW5hdGVzKFtmaXJzdFBvaW50LCBwb2ludE9uTGluZV0pO1xuICAgICAgcmV0dXJuIGRpc3RPbkxpbmUgKz0gc2VnbWVudC5nZXRMZW5ndGgoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGlzdE9uTGluZSArPSBzZWdtZW50LmdldExlbmd0aCgpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBkaXN0T25MaW5lO1xufTtcblxuUHJvZmlsZUNvbnRyb2xsZXIucHJvdG90eXBlLmhvdmVyQ2FsbGJhY2tfID0gZnVuY3Rpb24gKHBvaW50LCBkaXN0LCB4VW5pdHMsIGVsZXZhdGlvbnNSZWYsIHlVbml0cykge1xuICBpZiAodGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfICYmIHRoaXMubWVhc3VyZVRvb2x0aXBfKSB7XG4gICAgdmFyIGNvb3JkaW5hdGUgPSBbcG9pbnQueCwgcG9pbnQueV07XG4gICAgdGhpcy5jdXJyZW50UG9pbnQuZWxldmF0aW9ucyA9IGVsZXZhdGlvbnNSZWY7XG4gICAgdGhpcy5jdXJyZW50UG9pbnQuZGlzdGFuY2UgPSBkaXN0O1xuICAgIHRoaXMuY3VycmVudFBvaW50LnhVbml0cyA9IHhVbml0cztcbiAgICB0aGlzLmN1cnJlbnRQb2ludC55VW5pdHMgPSB5VW5pdHM7XG4gICAgdGhpcy5jdXJyZW50UG9pbnQuY29vcmRpbmF0ZSA9IGNvb3JkaW5hdGU7XG4gICAgdmFyIGdlb20gPSBuZXcgb2xHZW9tUG9pbnQoY29vcmRpbmF0ZSk7XG4gICAgdGhpcy5jcmVhdGVNZWFzdXJlVG9vbHRpcF8oKTtcbiAgICB0aGlzLm1lYXN1cmVUb29sdGlwRWxlbWVudF8uaW5uZXJIVE1MID0gdGhpcy5nZXRUb29sdGlwSFRNTF8oKTtcbiAgICB0aGlzLm1lYXN1cmVUb29sdGlwXy5zZXRQb3NpdGlvbihjb29yZGluYXRlKTtcbiAgICB0aGlzLnNuYXBwZWRQb2ludF8uc2V0R2VvbWV0cnkoZ2VvbSk7XG4gIH1cbn07XG5cblByb2ZpbGVDb250cm9sbGVyLnByb3RvdHlwZS5vdXRDYWxsYmFja18gPSBmdW5jdGlvbiAoKSB7XG4gIGRlbGV0ZSB0aGlzLmN1cnJlbnRQb2ludC5jb29yZGluYXRlO1xuICBkZWxldGUgdGhpcy5jdXJyZW50UG9pbnQuZGlzdGFuY2U7XG4gIHRoaXMuY3VycmVudFBvaW50LmVsZXZhdGlvbnMgPSB7fTtcbiAgZGVsZXRlIHRoaXMuY3VycmVudFBvaW50LnhVbml0cztcbiAgZGVsZXRlIHRoaXMuY3VycmVudFBvaW50LnlVbml0cztcbiAgdGhpcy5yZW1vdmVNZWFzdXJlVG9vbHRpcF8oKTtcbiAgdGhpcy5zbmFwcGVkUG9pbnRfLnNldEdlb21ldHJ5KHVuZGVmaW5lZCk7XG59O1xuXG5Qcm9maWxlQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0VG9vbHRpcEhUTUxfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0dGV4dENhdGFsb2cgPSB0aGlzLmdldHRleHRDYXRhbG9nXztcbiAgdmFyIHNlcGFyYXRvciA9ICcmbmJzcDs6ICc7XG4gIHZhciBlbGV2YXRpb25OYW1lLCB0cmFuc2xhdGVkRWxldmF0aW9uTmFtZTtcbiAgdmFyIGlubmVySFRNTCA9IFtdO1xuICB2YXIgbnVtYmVyID0gdGhpcy4kZmlsdGVyXygnbnVtYmVyJyk7XG4gIHZhciBEaXN0RGVjaW1hbCA9IHRoaXMuY3VycmVudFBvaW50LnhVbml0cyA9PT0gJ20nID8gMCA6IDI7XG4gIHZhciB2YWx1ZSA9IG51bWJlcih0aGlzLmN1cnJlbnRQb2ludC5kaXN0YW5jZSwgRGlzdERlY2ltYWwpO1xuICBpbm5lckhUTUwucHVzaCh0aGlzLnByb2ZpbGVMYWJlbHNfLnhBeGlzICsgXCIgXCIgKyBzZXBhcmF0b3IgKyBcIiBcIiArIHZhbHVlICsgXCImbmJzcDtcIiArIHRoaXMuY3VycmVudFBvaW50LnhVbml0cyk7XG5cbiAgZm9yIChlbGV2YXRpb25OYW1lIGluIHRoaXMuY3VycmVudFBvaW50LmVsZXZhdGlvbnMpIHtcbiAgICB0cmFuc2xhdGVkRWxldmF0aW9uTmFtZSA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZyhlbGV2YXRpb25OYW1lKTtcbiAgICB2YXIgaW50VmFsdWUgPSB0aGlzLmN1cnJlbnRQb2ludC5lbGV2YXRpb25zW2VsZXZhdGlvbk5hbWVdO1xuXG4gICAgdmFyIF92YWx1ZSA9IGludFZhbHVlID09PSBudWxsID8gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdubyB2YWx1ZScpIDogbnVtYmVyKGludFZhbHVlLCAwKSArIFwiJm5ic3A7XCIgKyB0aGlzLmN1cnJlbnRQb2ludC55VW5pdHM7XG5cbiAgICBpbm5lckhUTUwucHVzaCh0cmFuc2xhdGVkRWxldmF0aW9uTmFtZSArIFwiIFwiICsgc2VwYXJhdG9yICsgXCIgXCIgKyBfdmFsdWUpO1xuICB9XG5cbiAgcmV0dXJuIGlubmVySFRNTC5qb2luKCc8L2JyPicpO1xufTtcblxuUHJvZmlsZUNvbnRyb2xsZXIucHJvdG90eXBlLmNyZWF0ZU1lYXN1cmVUb29sdGlwXyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLm1hcF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gIH1cblxuICB0aGlzLnJlbW92ZU1lYXN1cmVUb29sdGlwXygpO1xuICB0aGlzLm1lYXN1cmVUb29sdGlwRWxlbWVudF8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgdGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfLmNsYXNzTmFtZSArPSAndG9vbHRpcCBuZ2VvLXRvb2x0aXAtbWVhc3VyZSc7XG4gIHRoaXMubWVhc3VyZVRvb2x0aXBfID0gbmV3IG9sT3ZlcmxheSh7XG4gICAgZWxlbWVudDogdGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfLFxuICAgIG9mZnNldDogWzAsIC0xNV0sXG4gICAgcG9zaXRpb25pbmc6ICdib3R0b20tY2VudGVyJ1xuICB9KTtcbiAgdGhpcy5tYXBfLmFkZE92ZXJsYXkodGhpcy5tZWFzdXJlVG9vbHRpcF8pO1xufTtcblxuUHJvZmlsZUNvbnRyb2xsZXIucHJvdG90eXBlLnJlbW92ZU1lYXN1cmVUb29sdGlwXyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMubWVhc3VyZVRvb2x0aXBFbGVtZW50XyAhPT0gbnVsbCkge1xuICAgIGlmICghdGhpcy5tYXBfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm1lYXN1cmVUb29sdGlwXykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1lYXN1cmVUb29sdGlwXycpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfLnBhcmVudE5vZGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtZWFzdXJlVG9vbHRpcEVsZW1lbnRfLnBhcmVudE5vZGUnKTtcbiAgICB9XG5cbiAgICB0aGlzLm1lYXN1cmVUb29sdGlwRWxlbWVudF8ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLm1lYXN1cmVUb29sdGlwRWxlbWVudF8pO1xuICAgIHRoaXMubWVhc3VyZVRvb2x0aXBFbGVtZW50XyA9IG51bGw7XG4gICAgdGhpcy5tYXBfLnJlbW92ZU92ZXJsYXkodGhpcy5tZWFzdXJlVG9vbHRpcF8pO1xuICB9XG59O1xuXG5Qcm9maWxlQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0U3R5bGUgPSBmdW5jdGlvbiAobGF5ZXJOYW1lKSB7XG4gIGlmICghdGhpcy5saW5lc0NvbmZpZ3VyYXRpb25fKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGxpbmVzQ29uZmlndXJhdGlvbicpO1xuICB9XG5cbiAgdmFyIGxpbmVDb25maWd1cmF0aW9uID0gdGhpcy5saW5lc0NvbmZpZ3VyYXRpb25fW2xheWVyTmFtZV07XG5cbiAgaWYgKCFsaW5lQ29uZmlndXJhdGlvbikge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgJ2NvbG9yJzogbGluZUNvbmZpZ3VyYXRpb24uY29sb3IgfHwgJyNGMDAnXG4gIH07XG59O1xuXG5Qcm9maWxlQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0TGF5ZXJzTmFtZXMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmxheWVyc05hbWVzXy5zbGljZSgwKTtcbn07XG5cblByb2ZpbGVDb250cm9sbGVyLnByb3RvdHlwZS5nZXRaRmFjdG9yeV8gPSBmdW5jdGlvbiAobGF5ZXJOYW1lKSB7XG4gIHZhciBnZXRaRm4gPSBmdW5jdGlvbiBnZXRaRm4oaXRlbSkge1xuICAgIGlmICgndmFsdWVzJyBpbiBpdGVtICYmIGxheWVyTmFtZSBpbiBpdGVtLnZhbHVlcyAmJiBpdGVtLnZhbHVlc1tsYXllck5hbWVdKSB7XG4gICAgICByZXR1cm4gcGFyc2VGbG9hdChpdGVtLnZhbHVlc1tsYXllck5hbWVdKTtcbiAgICB9XG5cbiAgICByZXR1cm4gTnVtYmVyLk5hTjtcbiAgfTtcblxuICByZXR1cm4gZ2V0WkZuO1xufTtcblxuUHJvZmlsZUNvbnRyb2xsZXIucHJvdG90eXBlLmdldERpc3RfID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgaWYgKCdkaXN0JyBpbiBpdGVtKSB7XG4gICAgcmV0dXJuIGl0ZW0uZGlzdDtcbiAgfVxuXG4gIHJldHVybiAwO1xufTtcblxuUHJvZmlsZUNvbnRyb2xsZXIucHJvdG90eXBlLmdldEpzb25Qcm9maWxlXyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLmxpbmUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbGluZScpO1xuICB9XG5cbiAgdmFyIGdlb20gPSB7XG4gICAgJ3R5cGUnOiAnTGluZVN0cmluZycsXG4gICAgJ2Nvb3JkaW5hdGVzJzogdGhpcy5saW5lLmdldENvb3JkaW5hdGVzKClcbiAgfTtcbiAgdmFyIHBhcmFtcyA9IHtcbiAgICAnbGF5ZXJzJzogdGhpcy5sYXllcnNOYW1lc18uam9pbignLCcpLFxuICAgICdnZW9tJzogSlNPTi5zdHJpbmdpZnkoZ2VvbSksXG4gICAgJ25iUG9pbnRzJzogdGhpcy5uYlBvaW50c19cbiAgfTtcbiAgdGhpcy4kaHR0cF8oe1xuICAgIHVybDogdGhpcy5nbWZQcm9maWxlSnNvblVybF8sXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgcGFyYW1TZXJpYWxpemVyOiAnJGh0dHBQYXJhbVNlcmlhbGl6ZXJKUUxpa2UnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ1xuICAgIH1cbiAgfSkudGhlbih0aGlzLmdldFByb2ZpbGVEYXRhU3VjY2Vzc18uYmluZCh0aGlzKSwgdGhpcy5nZXRQcm9maWxlRGF0YUVycm9yXy5iaW5kKHRoaXMpKTtcbn07XG5cblByb2ZpbGVDb250cm9sbGVyLnByb3RvdHlwZS5nZXRQcm9maWxlRGF0YVN1Y2Nlc3NfID0gZnVuY3Rpb24gKHJlc3ApIHtcbiAgdmFyIHByb2ZpbGVEYXRhID0gcmVzcC5kYXRhLnByb2ZpbGU7XG5cbiAgaWYgKHByb2ZpbGVEYXRhIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICB0aGlzLnByb2ZpbGVEYXRhID0gcHJvZmlsZURhdGE7XG4gIH1cbn07XG5cblByb2ZpbGVDb250cm9sbGVyLnByb3RvdHlwZS5nZXRQcm9maWxlRGF0YUVycm9yXyA9IGZ1bmN0aW9uIChyZXNwKSB7XG4gIHRoaXMuaXNFcnJvcmVkID0gdHJ1ZTtcbiAgY29uc29sZS5lcnJvcignQ2FuIG5vdCBnZXQgSlNPTiBwcm9maWxlLicpO1xufTtcblxuUHJvZmlsZUNvbnRyb2xsZXIucHJvdG90eXBlLmRvd25sb2FkQ3N2ID0gZnVuY3Rpb24gKCkge1xuICBpZiAodGhpcy5wcm9maWxlRGF0YS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaGVhZGVycyA9IFtdO1xuICB2YXIgaGFzRGlzdGFuY2UgPSBmYWxzZTtcbiAgdmFyIGZpcnN0UG9pbnQgPSB0aGlzLnByb2ZpbGVEYXRhWzBdO1xuXG4gIGlmICgnZGlzdCcgaW4gZmlyc3RQb2ludCkge1xuICAgIGhlYWRlcnMucHVzaCh7XG4gICAgICBuYW1lOiAnZGlzdGFuY2UnXG4gICAgfSk7XG4gICAgaGFzRGlzdGFuY2UgPSB0cnVlO1xuICB9XG5cbiAgdmFyIGxheWVycyA9IFtdO1xuXG4gIGZvciAodmFyIGxheWVyIGluIGZpcnN0UG9pbnQudmFsdWVzKSB7XG4gICAgaGVhZGVycy5wdXNoKHtcbiAgICAgICduYW1lJzogbGF5ZXJcbiAgICB9KTtcbiAgICBsYXllcnMucHVzaChsYXllcik7XG4gIH1cblxuICBoZWFkZXJzLnB1c2goe1xuICAgIG5hbWU6ICd4J1xuICB9KTtcbiAgaGVhZGVycy5wdXNoKHtcbiAgICBuYW1lOiAneSdcbiAgfSk7XG4gIHZhciByb3dzID0gdGhpcy5wcm9maWxlRGF0YS5tYXAoZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgdmFyIHJvdyA9IHt9O1xuXG4gICAgaWYgKGhhc0Rpc3RhbmNlKSB7XG4gICAgICByb3cuZGlzdGFuY2UgPSBwb2ludC5kaXN0O1xuICAgIH1cblxuICAgIGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYXllcikge1xuICAgICAgcm93W2xheWVyXSA9IHBvaW50LnZhbHVlc1tsYXllcl07XG4gICAgfSk7XG4gICAgcm93LnggPSBwb2ludC54O1xuICAgIHJvdy55ID0gcG9pbnQueTtcbiAgICByZXR1cm4gcm93O1xuICB9KTtcbiAgdGhpcy5uZ2VvQ3N2RG93bmxvYWRfLnN0YXJ0RG93bmxvYWQocm93cywgaGVhZGVycywgJ3Byb2ZpbGUuY3N2Jyk7XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignR21mUHJvZmlsZUNvbnRyb2xsZXInLCBQcm9maWxlQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJHRpbWVvdXRcIiwgXCJuZ2VvRmVhdHVyZU92ZXJsYXlNZ3JcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvbkRyYXcgZnJvbSAnb2wvaW50ZXJhY3Rpb24vRHJhdy5qcyc7XG5pbXBvcnQgb2xNYXAgZnJvbSAnb2wvTWFwLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xuaW1wb3J0IG9sU3R5bGVTdHJva2UgZnJvbSAnb2wvc3R5bGUvU3Ryb2tlLmpzJztcbmltcG9ydCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXlNZ3IgZnJvbSAnbmdlby9tYXAvRmVhdHVyZU92ZXJsYXlNZ3IuanMnO1xuaW1wb3J0IHsgaW50ZXJhY3Rpb25EZWNvcmF0aW9uIH0gZnJvbSAnbmdlby9taXNjL2RlY29yYXRlLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mRHJhd1Byb2ZpbGVMaW5lJywgW25nZW9NYXBGZWF0dXJlT3ZlcmxheU1nci5uYW1lXSk7XG5cbmZ1bmN0aW9uIHByb2ZpbGVEYXJ3TGluZUNvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBzY29wZTogdHJ1ZSxcbiAgICBjb250cm9sbGVyOiAnR21mRHJhd3Byb2ZpbGVsaW5lQ29udHJvbGxlciBhcyBjdHJsJyxcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICdnZXRNYXBGbic6ICcmZ21mRHJhd3Byb2ZpbGVsaW5lTWFwJyxcbiAgICAgICdsaW5lJzogJz1nbWZEcmF3cHJvZmlsZWxpbmVMaW5lJyxcbiAgICAgICdhY3RpdmUnOiAnPWdtZkRyYXdwcm9maWxlbGluZUFjdGl2ZScsXG4gICAgICAnZ2V0U3R5bGVGbic6ICcmP2dtZkRyYXdwcm9maWxlbGluZVN0eWxlJ1xuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnZ21mRHJhd3Byb2ZpbGVsaW5lJywgcHJvZmlsZURhcndMaW5lQ29tcG9uZW50KTtcblxuZnVuY3Rpb24gQ29udHJvbGxlcigkc2NvcGUsICR0aW1lb3V0LCBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLmxpbmUgPSBudWxsO1xuICB0aGlzLm1hcF8gPSBudWxsO1xuICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLmZlYXR1cmVzXyA9IG5ldyBvbENvbGxlY3Rpb24oKTtcbiAgdGhpcy5nZXRNYXBGbiA9IG51bGw7XG4gIHRoaXMuZ2V0U3R5bGVGbiA9IG51bGw7XG4gIHZhciBvdmVybGF5ID0gbmdlb0ZlYXR1cmVPdmVybGF5TWdyLmdldEZlYXR1cmVPdmVybGF5KCk7XG4gIG92ZXJsYXkuc2V0RmVhdHVyZXModGhpcy5mZWF0dXJlc18pO1xuICB2YXIgc3R5bGUgPSBuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICBzdHJva2U6IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICAgIGNvbG9yOiAnI2ZmY2MzMycsXG4gICAgICB3aWR0aDogMlxuICAgIH0pXG4gIH0pO1xuICBvdmVybGF5LnNldFN0eWxlKHN0eWxlKTtcbiAgdGhpcy5pbnRlcmFjdGlvbiA9IG5ldyBvbEludGVyYWN0aW9uRHJhdyh7XG4gICAgdHlwZTogJ0xpbmVTdHJpbmcnLFxuICAgIGZlYXR1cmVzOiB0aGlzLmZlYXR1cmVzX1xuICB9KTtcbiAgaW50ZXJhY3Rpb25EZWNvcmF0aW9uKHRoaXMuaW50ZXJhY3Rpb24pO1xuICB0aGlzLmludGVyYWN0aW9uLm9uKCdjaGFuZ2U6YWN0aXZlJywgZnVuY3Rpb24gKCkge1xuICAgIGlmIChfdGhpcy5pbnRlcmFjdGlvbi5nZXRBY3RpdmUoKSkge1xuICAgICAgX3RoaXMuY2xlYXJfKCk7XG4gICAgfVxuICB9KTtcbiAgdGhpcy5pbnRlcmFjdGlvbi5vbignZHJhd2VuZCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIF90aGlzLmxpbmUgPSBldmVudC5mZWF0dXJlLmdldEdlb21ldHJ5KCk7XG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuaW50ZXJhY3Rpb24uc2V0QWN0aXZlKGZhbHNlKTtcbiAgICB9LCAwKTtcbiAgfSk7XG4gICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5saW5lO1xuICB9LCBmdW5jdGlvbiAobmV3TGluZSwgb2xkTGluZSkge1xuICAgIGlmIChuZXdMaW5lID09PSBudWxsKSB7XG4gICAgICBfdGhpcy5jbGVhcl8oKTtcbiAgICB9XG4gIH0pO1xuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuYWN0aXZlO1xuICB9LCBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICBpZiAobmV3VmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICBfdGhpcy5jbGVhcl8oKTtcbiAgICB9XG5cbiAgICBfdGhpcy5pbnRlcmFjdGlvbi5zZXRBY3RpdmUoX3RoaXMuYWN0aXZlKTtcbiAgfSk7XG59XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5nZXRNYXBGbikge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZXRNYXBGbicpO1xuICB9XG5cbiAgdmFyIG1hcCA9IHRoaXMuZ2V0TWFwRm4oKTtcblxuICBpZiAoIShtYXAgaW5zdGFuY2VvZiBvbE1hcCkpIHtcbiAgICB0aHJvdyAnV3JvbmcgbWFwJztcbiAgfVxuXG4gIHRoaXMubWFwXyA9IG1hcDtcbiAgdGhpcy5tYXBfLmFkZEludGVyYWN0aW9uKHRoaXMuaW50ZXJhY3Rpb24pO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuY2xlYXJfID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmZlYXR1cmVzXy5jbGVhcigpO1xuICB0aGlzLmxpbmUgPSBudWxsO1xufTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ0dtZkRyYXdwcm9maWxlbGluZUNvbnRyb2xsZXInLCBDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZQcm9maWxlQ29tcG9uZW50IGZyb20gJ2dtZi9wcm9maWxlL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mUHJvZmlsZURyYXdMaW5lQ29tcG9uZW50IGZyb20gJ2dtZi9wcm9maWxlL2RyYXdMaW5lQ29tcG9uZW50LmpzJztcbmltcG9ydCAnLi9wcm9maWxlLnNjc3MnO1xuZXhwb3J0IGRlZmF1bHQgYW5ndWxhci5tb2R1bGUoJ2dtZlByb2ZpbGVNb2R1bGUnLCBbZ21mUHJvZmlsZUNvbXBvbmVudC5uYW1lLCBnbWZQcm9maWxlRHJhd0xpbmVDb21wb25lbnQubmFtZV0pOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IGdtZlF1ZXJ5R3JpZENvbXBvbmVudCBmcm9tICdnbWYvcXVlcnkvZ3JpZENvbXBvbmVudC5qcyc7XG5pbXBvcnQgZ21mUXVlcnlXaW5kb3dDb21wb25lbnQgZnJvbSAnZ21mL3F1ZXJ5L3dpbmRvd0NvbXBvbmVudC5qcyc7XG5pbXBvcnQgJy4vZ3JpZC5zY3NzJztcbmltcG9ydCAnLi93aW5kb3cuc2Nzcyc7XG5leHBvcnQgZGVmYXVsdCBhbmd1bGFyLm1vZHVsZSgnZ21mUXVlcnlFeHRyYU1vZHVsZScsIFtnbWZRdWVyeUdyaWRDb21wb25lbnQubmFtZSwgZ21mUXVlcnlXaW5kb3dDb21wb25lbnQubmFtZV0pOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXYgY2xhc3M9XCJnbWYtZGlzcGxheXF1ZXJ5Z3JpZCBwYW5lbFwiIG5nLXNob3c9XCJjdHJsLmFjdGl2ZVwiPlxcbiAgPGRpdlxcbiAgICBjbGFzcz1cImNsb3NlXCJcXG4gICAgbmctY2xpY2s9XCJjdHJsLmNsZWFyKClcIj5cXG4gICAgJnRpbWVzO1xcbiAgPC9kaXY+XFxuXFxuICA8dWxcXG4gICAgY2xhc3M9XCJuYXYgbmF2LXBpbGxzXCJcXG4gICAgcm9sZT1cInRhYmxpc3RcIj5cXG5cXG4gICAgPGxpXFxuICAgICAgY2xhc3M9XCJuYXYtaXRlbVwiXFxuICAgICAgbmctcmVwZWF0PVwiZ3JpZFNvdXJjZSBpbiBjdHJsLmdldEdyaWRTb3VyY2VzKCkgdHJhY2sgYnkgZ3JpZFNvdXJjZS5zb3VyY2UubGFiZWxcIlxcbiAgICAgIHJvbGU9XCJwcmVzZW50YXRpb25cIlxcbiAgICAgIG5nLWNsaWNrPVwiY3RybC5zZWxlY3RUYWIoZ3JpZFNvdXJjZSlcIj5cXG5cXG4gICAgICA8YVxcbiAgICAgICAgY2xhc3M9XCJuYXYtbGlua1wiXFxuICAgICAgICBocmVmPVwiI3t7Y3RybC5lc2NhcGVWYWx1ZShncmlkU291cmNlLnNvdXJjZS5sYWJlbCl9fVwiXFxuICAgICAgICBuZy1jbGFzcz1cIntcXCdhY3RpdmVcXCcgOiBjdHJsLmlzU2VsZWN0ZWQoZ3JpZFNvdXJjZSl9XCJcXG4gICAgICAgIGRhdGEtdGFyZ2V0PVwiI3t7Y3RybC5lc2NhcGVWYWx1ZShncmlkU291cmNlLnNvdXJjZS5sYWJlbCl9fVwiXFxuICAgICAgICBhcmlhLWNvbnRyb2xzPVwie3tjdHJsLmVzY2FwZVZhbHVlKGdyaWRTb3VyY2Uuc291cmNlLmxhYmVsKX19XCJcXG4gICAgICAgIHJvbGU9XCJ0YWJcIlxcbiAgICAgICAgZGF0YS10b2dnbGU9XCJ0YWJcIj5cXG5cXG4gICAgICAgIDxzcGFuIG5nLWlmPVwiZ3JpZFNvdXJjZS5zb3VyY2UudG9vTWFueVJlc3VsdHMgIT09IHRydWVcIj5cXG4gICAgICAgICAge3tncmlkU291cmNlLnNvdXJjZS5sYWJlbCB8IHRyYW5zbGF0ZX19ICh7e2dyaWRTb3VyY2Uuc291cmNlLmZlYXR1cmVzLmxlbmd0aH19KVxcbiAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgPHNwYW4gbmctaWY9XCJncmlkU291cmNlLnNvdXJjZS50b29NYW55UmVzdWx0cyA9PT0gdHJ1ZVwiPlxcbiAgICAgICAgICB7e2dyaWRTb3VyY2Uuc291cmNlLmxhYmVsIHwgdHJhbnNsYXRlfX0gKHt7Z3JpZFNvdXJjZS5zb3VyY2UudG90YWxGZWF0dXJlQ291bnR9fSopXFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgPC9hPlxcbiAgICA8L2xpPlxcbiAgPC91bD5cXG5cXG4gIDxkaXYgY2xhc3M9XCJ0YWItY29udGVudFwiPlxcbiAgICA8ZGl2XFxuICAgICAgbmctcmVwZWF0PVwiZ3JpZFNvdXJjZSBpbiBjdHJsLmdldEdyaWRTb3VyY2VzKCkgdHJhY2sgYnkgZ3JpZFNvdXJjZS5zb3VyY2UubGFiZWxcIlxcbiAgICAgIHJvbGU9XCJ0YWJwYW5lbFwiXFxuICAgICAgY2xhc3M9XCJ0YWItcGFuZVwiXFxuICAgICAgbmctY2xhc3M9XCJ7XFwnYWN0aXZlXFwnIDogY3RybC5pc1NlbGVjdGVkKGdyaWRTb3VyY2UpfVwiXFxuICAgICAgaWQ9XCJ7e2N0cmwuZXNjYXBlVmFsdWUoZ3JpZFNvdXJjZS5zb3VyY2UubGFiZWwpfX1cIj5cXG5cXG4gICAgICA8bmdlby1ncmlkXFxuICAgICAgICBuZ2VvLWdyaWQtY29uZmlndXJhdGlvbj1cImdyaWRTb3VyY2UuY29uZmlndXJhdGlvblwiXFxuICAgICAgICBuZy1pZj1cImdyaWRTb3VyY2Uuc291cmNlLnRvb01hbnlSZXN1bHRzICE9PSB0cnVlXCI+XFxuICAgICAgPC9uZ2VvLWdyaWQ+XFxuXFxuICAgICAgPGRpdiBuZy1pZj1cImdyaWRTb3VyY2Uuc291cmNlLnRvb01hbnlSZXN1bHRzID09PSB0cnVlXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVwiZ21mLWRpc3BsYXlxdWVyeWdyaWQtbWVzc2FnZSBhbGVydCBhbGVydC13YXJuaW5nXCI+XFxuICAgICAgICAgIDxwPjxzcGFuIHRyYW5zbGF0ZT5UaGUgcmVzdWx0cyBjYW4gbm90IGJlIGRpc3BsYXllZCBiZWNhdXNlIHRoZSBtYXhpbXVtIG51bWJlciBoYXMgYmVlbiByZWFjaGVkPC9zcGFuPiAoe3tncmlkU291cmNlLnNvdXJjZS5saW1pdH19KS48L3A+XFxuICAgICAgICAgIDxwIHRyYW5zbGF0ZT5QbGVhc2UgcmVmaW5lIHlvdXIgcXVlcnkuPC9wPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2IG5nLXNob3c9XCIhY3RybC5wZW5kaW5nICYmIGN0cmwuZ2V0QWN0aXZlR3JpZFNvdXJjZSgpICYmIGN0cmwuZ2V0QWN0aXZlR3JpZFNvdXJjZSgpLmNvbmZpZ3VyYXRpb24gIT09IG51bGxcIj5cXG5cXG4gICAgPHVsIGNsYXNzPVwibmF2IGp1c3RpZnktY29udGVudC1lbmRcIj5cXG5cXG4gICAgICA8bGlcXG4gICAgICAgIGNsYXNzPVwibmctaGlkZVwiXFxuICAgICAgICBuZy1zaG93PVwiY3RybC5pc09uZVNlbGVjdGVkKClcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XCJidG4gYnRuLXNtIG5nLWJpbmRpbmdcIj5cXG4gICAgICAgICAge3tjdHJsLmdldFNlbGVjdGVkUm93Q291bnQoKX19IDxzcGFuIHRyYW5zbGF0ZT5zZWxlY3RlZCBlbGVtZW50KHMpPC9zcGFuPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9saT5cXG5cXG4gICAgICA8bGlcXG4gICAgICAgIG5nLXNob3c9XCJjdHJsLmlzT25lU2VsZWN0ZWQoKVwiXFxuICAgICAgICBjbGFzcz1cIm5nLWhpZGVcIj5cXG4gICAgICAgIDxidXR0b25cXG4gICAgICAgICAgY2xhc3M9XCJidG4gYnRuLWxpbmsgYnRuLXNtXCJcXG4gICAgICAgICAgdGl0bGU9XCJ7e1xcJ1pvb20gdG8gc2VsZWN0aW9uXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICAgICAgICBuZy1jbGljaz1cImN0cmwuem9vbVRvU2VsZWN0aW9uKClcIj5cXG4gICAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1zZWFyY2gtcGx1c1wiPjwvaT4gPHNwYW4gdHJhbnNsYXRlPlpvb20gdG88L3NwYW4+XFxuICAgICAgICA8L2J1dHRvbj5cXG4gICAgICA8L2xpPlxcblxcbiAgICAgIDxsaVxcbiAgICAgICAgbmctc2hvdz1cImN0cmwuaXNPbmVTZWxlY3RlZCgpXCJcXG4gICAgICAgIGNsYXNzPVwibmctaGlkZVwiPlxcbiAgICAgICAgPGJ1dHRvblxcbiAgICAgICAgICBjbGFzcz1cImJ0biBidG4tbGluayBidG4tc21cIlxcbiAgICAgICAgICB0aXRsZT1cInt7XFwnRXhwb3J0IHNlbGVjdGlvbiBhcyBDU1ZcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgICAgICAgIG5nLWNsaWNrPVwiY3RybC5kb3dubG9hZENzdigpXCI+XFxuICAgICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtZG93bmxvYWRcIj48L2k+IDxzcGFuIHRyYW5zbGF0ZT5FeHBvcnQgYXMgQ1NWPC9zcGFuPlxcbiAgICAgICAgPC9idXR0b24+XFxuICAgICAgPC9saT5cXG5cXG4gICAgICA8bGkgY2xhc3M9XCJkcm9wZG93blwiPlxcbiAgICAgICAgPGJ1dHRvblxcbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgY2xhc3M9XCJkcm9wdXAgYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbSBkcm9wZG93bi10b2dnbGVcIlxcbiAgICAgICAgICBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJcXG4gICAgICAgICAgYXJpYS1oYXNwb3B1cD1cInRydWVcIlxcbiAgICAgICAgICBhcmlhLWV4cGFuZGVkPVwiZmFsc2VcIj5cXG4gICAgICAgICAgPHNwYW4gdHJhbnNsYXRlPlNlbGVjdDwvc3Bhbj5cXG4gICAgICAgIDwvYnV0dG9uPlxcbiAgICAgICAgPHVsXFxuICAgICAgICAgIGNsYXNzPVwiZHJvcGRvd24tbWVudVwiXFxuICAgICAgICAgIGFyaWEtbGFiZWxsZWRieT1cImRMYWJlbFwiPlxcbiAgICAgICAgICA8bGk+XFxuICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgIGhyZWY9XCJcIlxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCJjdHJsLnNlbGVjdEFsbCgpXCIgdHJhbnNsYXRlPkFsbDwvYT5cXG4gICAgICAgICAgPC9saT5cXG4gICAgICAgICAgPGxpPlxcbiAgICAgICAgICAgIDxhXFxuICAgICAgICAgICAgICBocmVmPVwiXCJcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiY3RybC51bnNlbGVjdEFsbCgpXCIgdHJhbnNsYXRlPk5vbmU8L2E+XFxuICAgICAgICAgIDwvbGk+XFxuICAgICAgICAgIDxsaT5cXG4gICAgICAgICAgICA8YVxcbiAgICAgICAgICAgICAgaHJlZj1cIlwiXFxuICAgICAgICAgICAgICBuZy1jbGljaz1cImN0cmwuaW52ZXJ0U2VsZWN0aW9uKClcIiB0cmFuc2xhdGU+UmV2ZXJzZSBzZWxlY3Rpb248L2E+XFxuICAgICAgICAgIDwvbGk+XFxuICAgICAgICA8L3VsPlxcbiAgICAgIDwvbGk+XFxuICAgIDwvdWw+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXZcXG4gICAgbmctc2hvdz1cImN0cmwucGVuZGluZ1wiXFxuICAgIGNsYXNzPVwiZ21mLWRpc3BsYXlxdWVyeWdyaWQtcGVuZGluZ1wiPlxcbiAgICA8c3BhbiBjbGFzcz1cImZhIGZhLXNwaW5uZXIgZmEtc3BpblwiPjwvc3Bhbj5cXG4gIDwvZGl2PlxcbjwvZGl2Plxcbic7XG5cbn1cbnJldHVybiBfX3Bcbn0iLCJRdWVyeUdyaWRDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkaW5qZWN0b3JcIiwgXCIkc2NvcGVcIiwgXCJuZ2VvUXVlcnlSZXN1bHRcIiwgXCJuZ2VvTWFwUXVlcmVudFwiLCBcIm5nZW9GZWF0dXJlT3ZlcmxheU1nclwiLCBcIiR0aW1lb3V0XCIsIFwibmdlb0NzdkRvd25sb2FkXCIsIFwiJGVsZW1lbnRcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvRG93bmxvYWRDc3YgZnJvbSAnbmdlby9kb3dubG9hZC9Dc3YuanMnO1xuaW1wb3J0IG5nZW9Eb3dubG9hZFNlcnZpY2UgZnJvbSAnbmdlby9kb3dubG9hZC9zZXJ2aWNlLmpzJztcbmltcG9ydCBuZ2VvR3JpZENvbXBvbmVudCBmcm9tICduZ2VvL2dyaWQvY29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvR3JpZENvbmZpZywgeyBnZXRSb3dVaWQgfSBmcm9tICduZ2VvL2dyaWQvQ29uZmlnLmpzJztcbmltcG9ydCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXlNZ3IgZnJvbSAnbmdlby9tYXAvRmVhdHVyZU92ZXJsYXlNZ3IuanMnO1xuaW1wb3J0IG5nZW9RdWVyeU1hcFF1ZXJlbnQgZnJvbSAnbmdlby9xdWVyeS9NYXBRdWVyZW50LmpzJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgKiBhcyBvbEV4dGVudCBmcm9tICdvbC9leHRlbnQuanMnO1xuaW1wb3J0IG9sTWFwIGZyb20gJ29sL01hcC5qcyc7XG5pbXBvcnQgb2xTdHlsZUNpcmNsZSBmcm9tICdvbC9zdHlsZS9DaXJjbGUuanMnO1xuaW1wb3J0IG9sU3R5bGVGaWxsIGZyb20gJ29sL3N0eWxlL0ZpbGwuanMnO1xuaW1wb3J0IG9sU3R5bGVTdHJva2UgZnJvbSAnb2wvc3R5bGUvU3Ryb2tlLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xuaW1wb3J0ICdib290c3RyYXAvanMvc3JjL2Ryb3Bkb3duLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mUXVlcnlHcmlkQ29tcG9uZW50JywgW25nZW9Eb3dubG9hZENzdi5uYW1lLCBuZ2VvRG93bmxvYWRTZXJ2aWNlLm5hbWUsIG5nZW9HcmlkQ29tcG9uZW50Lm5hbWUsIG5nZW9NYXBGZWF0dXJlT3ZlcmxheU1nci5uYW1lLCBuZ2VvUXVlcnlNYXBRdWVyZW50Lm5hbWVdKTtcbm1vZHVsZS52YWx1ZSgnZ21mRGlzcGxheXF1ZXJ5Z3JpZFRlbXBsYXRlVXJsJywgZnVuY3Rpb24gKCRlbGVtZW50LCAkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzLmdtZkRpc3BsYXlxdWVyeWdyaWRUZW1wbGF0ZXVybDtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICdnbWYvcXVlcnkvZ3JpZENvbXBvbmVudCc7XG59KTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZ21mL3F1ZXJ5L2dyaWRDb21wb25lbnQnLCByZXF1aXJlKCcuL2dyaWRDb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcbmdtZkRpc3BsYXlxdWVyeWdyaWRUZW1wbGF0ZVVybC4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkYXR0cnNcIiwgXCJnbWZEaXNwbGF5cXVlcnlncmlkVGVtcGxhdGVVcmxcIl07XG5cbmZ1bmN0aW9uIGdtZkRpc3BsYXlxdWVyeWdyaWRUZW1wbGF0ZVVybCgkZWxlbWVudCwgJGF0dHJzLCBnbWZEaXNwbGF5cXVlcnlncmlkVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIGdtZkRpc3BsYXlxdWVyeWdyaWRUZW1wbGF0ZVVybCgkZWxlbWVudCwgJGF0dHJzKTtcbn1cblxudmFyIHF1ZXJ5R3JpZENvbXBvbmVudCA9IHtcbiAgY29udHJvbGxlcjogJ0dtZkRpc3BsYXlxdWVyeWdyaWRDb250cm9sbGVyIGFzIGN0cmwnLFxuICBiaW5kaW5nczoge1xuICAgICdhY3RpdmUnOiAnPT9nbWZEaXNwbGF5cXVlcnlncmlkQWN0aXZlJyxcbiAgICAnZmVhdHVyZXNTdHlsZUZuJzogJyZnbWZEaXNwbGF5cXVlcnlncmlkRmVhdHVyZXNzdHlsZScsXG4gICAgJ3NlbGVjdGVkRmVhdHVyZVN0eWxlRm4nOiAnJmdtZkRpc3BsYXlxdWVyeWdyaWRTZWxlY3RlZGZlYXR1cmVzdHlsZScsXG4gICAgJ2dldE1hcEZuJzogJyZnbWZEaXNwbGF5cXVlcnlncmlkTWFwJyxcbiAgICAncmVtb3ZlRW1wdHlDb2x1bW5zRm4nOiAnJj9nbWZEaXNwbGF5cXVlcnlncmlkUmVtb3ZlZW1wdHljb2x1bW5zJyxcbiAgICAnbWF4UmVzdWx0c0ZuJzogJyY/Z21mRGlzcGxheXF1ZXJ5Z3JpZE1heHJlc3VsdHMnLFxuICAgICdtYXhSZWNlbnRlclpvb21Gbic6ICcmP2dtZkRpc3BsYXlxdWVyeWdyaWRNYXhyZWNlbnRlcnpvb20nLFxuICAgICdtZXJnZVRhYnMnOiAnPD9nbWZEaXNwbGF5cXVlcnlncmlkTWVyZ2V0YWJzJ1xuICB9LFxuICB0ZW1wbGF0ZVVybDogZ21mRGlzcGxheXF1ZXJ5Z3JpZFRlbXBsYXRlVXJsXG59O1xubW9kdWxlLmNvbXBvbmVudCgnZ21mRGlzcGxheXF1ZXJ5Z3JpZCcsIHF1ZXJ5R3JpZENvbXBvbmVudCk7XG5leHBvcnQgZnVuY3Rpb24gUXVlcnlHcmlkQ29udHJvbGxlcigkaW5qZWN0b3IsICRzY29wZSwgbmdlb1F1ZXJ5UmVzdWx0LCBuZ2VvTWFwUXVlcmVudCwgbmdlb0ZlYXR1cmVPdmVybGF5TWdyLCAkdGltZW91dCwgbmdlb0NzdkRvd25sb2FkLCAkZWxlbWVudCkge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHZhciBxdWVyeU9wdGlvbnMgPSAkaW5qZWN0b3IuaGFzKCduZ2VvUXVlcnlPcHRpb25zJykgPyAkaW5qZWN0b3IuZ2V0KCduZ2VvUXVlcnlPcHRpb25zJykgOiB7fTtcbiAgdGhpcy4kc2NvcGVfID0gJHNjb3BlO1xuICB0aGlzLiR0aW1lb3V0XyA9ICR0aW1lb3V0O1xuICB0aGlzLm5nZW9RdWVyeVJlc3VsdCA9IG5nZW9RdWVyeVJlc3VsdDtcbiAgdGhpcy5uZ2VvTWFwUXVlcmVudF8gPSBuZ2VvTWFwUXVlcmVudDtcbiAgdGhpcy5uZ2VvQ3N2RG93bmxvYWRfID0gbmdlb0NzdkRvd25sb2FkO1xuICB0aGlzLiRlbGVtZW50XyA9ICRlbGVtZW50O1xuICB0aGlzLm1heFJlc3VsdHMgPSBxdWVyeU9wdGlvbnMubGltaXQgIT09IHVuZGVmaW5lZCA/IHF1ZXJ5T3B0aW9ucy5saW1pdCA6IDUwO1xuICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgdGhpcy5ncmlkU291cmNlcyA9IHt9O1xuICB0aGlzLmxvYWRlZEdyaWRTb3VyY2VzID0gW107XG4gIHRoaXMuc2VsZWN0ZWRUYWIgPSBudWxsO1xuICB0aGlzLnJlbW92ZUVtcHR5Q29sdW1uc18gPSBmYWxzZTtcbiAgdGhpcy5tYXhSZWNlbnRlclpvb20gPSBudWxsO1xuICB0aGlzLm1lcmdlVGFicyA9IHt9O1xuICB0aGlzLmZlYXR1cmVzRm9yU291cmNlc18gPSB7fTtcbiAgdGhpcy5mZWF0dXJlc18gPSBuZXcgb2xDb2xsZWN0aW9uKCk7XG4gIHRoaXMubmdlb0ZlYXR1cmVPdmVybGF5TWdyXyA9IG5nZW9GZWF0dXJlT3ZlcmxheU1ncjtcbiAgdGhpcy5oaWdobGlnaHRGZWF0dXJlc18gPSBuZXcgb2xDb2xsZWN0aW9uKCk7XG4gIHRoaXMuZmlsZW5hbWVfID0gJGluamVjdG9yLmhhcygnZ21mQ3N2RmlsZW5hbWUnKSA/ICRpbmplY3Rvci5nZXQoJ2dtZkNzdkZpbGVuYW1lJykgOiAncXVlcnktcmVzdWx0cy5jc3YnO1xuICB0aGlzLm1hcF8gPSBudWxsO1xuICB0aGlzLiRzY29wZV8uJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5nZW9RdWVyeVJlc3VsdDtcbiAgfSwgZnVuY3Rpb24gKG5ld1F1ZXJ5UmVzdWx0LCBvbGRRdWVyeVJlc3VsdCkge1xuICAgIGlmIChuZXdRdWVyeVJlc3VsdCAhPT0gb2xkUXVlcnlSZXN1bHQpIHtcbiAgICAgIF90aGlzLnVwZGF0ZURhdGFfKCk7XG4gICAgfVxuICB9KTtcbiAgdGhpcy51bnJlZ2lzdGVyU2VsZWN0V2F0Y2hlcl8gPSBudWxsO1xuXG4gIHRoaXMucmVtb3ZlRW1wdHlDb2x1bW5zRm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHRoaXMubWF4UmVjZW50ZXJab29tRm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgdGhpcy5mZWF0dXJlc1N0eWxlRm4gPSBudWxsO1xuICB0aGlzLnNlbGVjdGVkRmVhdHVyZVN0eWxlRm4gPSBudWxsO1xuICB0aGlzLmdldE1hcEZuID0gbnVsbDtcbn1cblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLmdldE1hcEZuKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdldE1hcEZuJyk7XG4gIH1cblxuICBpZiAoIXRoaXMuZmVhdHVyZXNTdHlsZUZuKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmVzU3R5bGVGbicpO1xuICB9XG5cbiAgaWYgKCF0aGlzLnNlbGVjdGVkRmVhdHVyZVN0eWxlRm4pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc2VsZWN0ZWRGZWF0dXJlU3R5bGVGbicpO1xuICB9XG5cbiAgdGhpcy5yZW1vdmVFbXB0eUNvbHVtbnNfID0gdGhpcy5yZW1vdmVFbXB0eUNvbHVtbnNGbigpO1xuICB0aGlzLm1heFJlY2VudGVyWm9vbSA9IHRoaXMubWF4UmVjZW50ZXJab29tRm4oKTtcbiAgdmFyIGZlYXR1cmVzT3ZlcmxheSA9IHRoaXMubmdlb0ZlYXR1cmVPdmVybGF5TWdyXy5nZXRGZWF0dXJlT3ZlcmxheSgpO1xuICBmZWF0dXJlc092ZXJsYXkuc2V0RmVhdHVyZXModGhpcy5mZWF0dXJlc18pO1xuICB2YXIgZmVhdHVyZXNTdHlsZSA9IHRoaXMuZmVhdHVyZXNTdHlsZUZuKCk7XG5cbiAgaWYgKGZlYXR1cmVzU3R5bGUgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICghKGZlYXR1cmVzU3R5bGUgaW5zdGFuY2VvZiBvbFN0eWxlU3R5bGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGZlYXR1cmVzU3R5bGUgdHlwZScpO1xuICAgIH1cblxuICAgIGZlYXR1cmVzT3ZlcmxheS5zZXRTdHlsZShmZWF0dXJlc1N0eWxlKTtcbiAgfVxuXG4gIHZhciBoaWdobGlnaHRGZWF0dXJlc092ZXJsYXkgPSB0aGlzLm5nZW9GZWF0dXJlT3ZlcmxheU1ncl8uZ2V0RmVhdHVyZU92ZXJsYXkoKTtcbiAgaGlnaGxpZ2h0RmVhdHVyZXNPdmVybGF5LnNldEZlYXR1cmVzKHRoaXMuaGlnaGxpZ2h0RmVhdHVyZXNfKTtcbiAgdmFyIGhpZ2hsaWdodEZlYXR1cmVTdHlsZSA9IHRoaXMuc2VsZWN0ZWRGZWF0dXJlU3R5bGVGbigpO1xuXG4gIGlmIChoaWdobGlnaHRGZWF0dXJlU3R5bGUgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICghKGhpZ2hsaWdodEZlYXR1cmVTdHlsZSBpbnN0YW5jZW9mIG9sU3R5bGVTdHlsZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgaGlnaGxpZ2h0RmVhdHVyZVN0eWxlIHR5cGUnKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdmFyIGZpbGwgPSBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgY29sb3I6IFsyNTUsIDAsIDAsIDAuNl1cbiAgICB9KTtcbiAgICB2YXIgc3Ryb2tlID0gbmV3IG9sU3R5bGVTdHJva2Uoe1xuICAgICAgY29sb3I6IFsyNTUsIDAsIDAsIDFdLFxuICAgICAgd2lkdGg6IDJcbiAgICB9KTtcbiAgICBoaWdobGlnaHRGZWF0dXJlU3R5bGUgPSBuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICAgIGZpbGw6IGZpbGwsXG4gICAgICBpbWFnZTogbmV3IG9sU3R5bGVDaXJjbGUoe1xuICAgICAgICBmaWxsOiBmaWxsLFxuICAgICAgICByYWRpdXM6IDUsXG4gICAgICAgIHN0cm9rZTogc3Ryb2tlXG4gICAgICB9KSxcbiAgICAgIHN0cm9rZTogc3Ryb2tlLFxuICAgICAgekluZGV4OiAxMFxuICAgIH0pO1xuICB9XG5cbiAgaGlnaGxpZ2h0RmVhdHVyZXNPdmVybGF5LnNldFN0eWxlKGhpZ2hsaWdodEZlYXR1cmVTdHlsZSk7XG4gIHZhciBtYXBGbiA9IHRoaXMuZ2V0TWFwRm47XG5cbiAgaWYgKG1hcEZuKSB7XG4gICAgdmFyIG1hcCA9IG1hcEZuKCk7XG5cbiAgICBpZiAoIShtYXAgaW5zdGFuY2VvZiBvbE1hcCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgbWFwIHR5cGUnKTtcbiAgICB9XG5cbiAgICB0aGlzLm1hcF8gPSBtYXA7XG4gIH1cbn07XG5cblF1ZXJ5R3JpZENvbnRyb2xsZXIucHJvdG90eXBlLmdldEdyaWRTb3VyY2VzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMyID0gdGhpcztcblxuICByZXR1cm4gdGhpcy5sb2FkZWRHcmlkU291cmNlcy5tYXAoZnVuY3Rpb24gKHNvdXJjZUxhYmVsKSB7XG4gICAgcmV0dXJuIF90aGlzMi5ncmlkU291cmNlc1tzb3VyY2VMYWJlbF07XG4gIH0pO1xufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUudXBkYXRlRGF0YV8gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gIGlmICgodGhpcy5uZ2VvUXVlcnlSZXN1bHQucGVuZGluZyB8fCB0aGlzLm5nZW9RdWVyeVJlc3VsdC50b3RhbCA9PT0gMCkgJiYgIXRoaXMuaGFzT25lV2l0aFRvb01hbnlSZXN1bHRzXygpKSB7XG4gICAgdmFyIG9sZEFjdGl2ZSA9IHRoaXMuYWN0aXZlO1xuICAgIHRoaXMuY2xlYXIoKTtcblxuICAgIGlmIChvbGRBY3RpdmUpIHtcbiAgICAgIHRoaXMuYWN0aXZlID0gdGhpcy5uZ2VvUXVlcnlSZXN1bHQucGVuZGluZztcbiAgICAgIHRoaXMucGVuZGluZyA9IHRoaXMubmdlb1F1ZXJ5UmVzdWx0LnBlbmRpbmc7XG4gICAgfVxuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgdmFyIHNvdXJjZXMgPSB0aGlzLm5nZW9RdWVyeVJlc3VsdC5zb3VyY2VzO1xuXG4gIGlmIChPYmplY3Qua2V5cyh0aGlzLm1lcmdlVGFicykubGVuZ3RoID4gMCkge1xuICAgIHNvdXJjZXMgPSB0aGlzLmdldE1lcmdlZFNvdXJjZXNfKHNvdXJjZXMpO1xuICB9XG5cbiAgc291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICBpZiAoc291cmNlLnRvb01hbnlSZXN1bHRzKSB7XG4gICAgICBfdGhpczMubWFrZUdyaWRfKG51bGwsIHNvdXJjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNvdXJjZS5pZCA9IF90aGlzMy5lc2NhcGVWYWx1ZShzb3VyY2UuaWQpO1xuICAgICAgdmFyIGZlYXR1cmVzID0gc291cmNlLmZlYXR1cmVzO1xuXG4gICAgICBpZiAoZmVhdHVyZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBfdGhpczMuY29sbGVjdERhdGFfKHNvdXJjZSk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBpZiAodGhpcy5sb2FkZWRHcmlkU291cmNlcy5sZW5ndGggPT09IDApIHtcbiAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLnNlbGVjdGVkVGFiID09PSBudWxsIHx8ICEoXCJcIiArIHRoaXMuc2VsZWN0ZWRUYWIgaW4gdGhpcy5ncmlkU291cmNlcykpIHtcbiAgICB0aGlzLiR0aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZmlyc3RTb3VyY2VJZCA9IF90aGlzMy5sb2FkZWRHcmlkU291cmNlc1swXTtcblxuICAgICAgX3RoaXMzLnNlbGVjdFRhYihfdGhpczMuZ3JpZFNvdXJjZXNbZmlyc3RTb3VyY2VJZF0pO1xuICAgIH0sIDApO1xuICB9XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5oYXNPbmVXaXRoVG9vTWFueVJlc3VsdHNfID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5uZ2VvUXVlcnlSZXN1bHQuc291cmNlcy5zb21lKGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICByZXR1cm4gc291cmNlLnRvb01hbnlSZXN1bHRzO1xuICB9KTtcbn07XG5cblF1ZXJ5R3JpZENvbnRyb2xsZXIucHJvdG90eXBlLmVzY2FwZVZhbHVlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHRvRXNjYXBlID0gL1tcXC1cXFtcXF1cXC9cXHtcXH1cXChcXClcXCpcXCtcXD9cXC5cXFxcXFxeXFwkXFwgfF0vZztcblxuICAgIGlmICh2YWx1ZS5tYXRjaCh0b0VzY2FwZSkgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKHRvRXNjYXBlLCAnXycpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICB9XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5pc1NlbGVjdGVkID0gZnVuY3Rpb24gKGdyaWRTb3VyY2UpIHtcbiAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRUYWIgPT09IGdyaWRTb3VyY2Uuc291cmNlLmxhYmVsO1xufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0TWVyZ2VkU291cmNlc18gPSBmdW5jdGlvbiAoc291cmNlcykge1xuICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICB2YXIgYWxsU291cmNlcyA9IFtdO1xuICB2YXIgbWVyZ2VkU291cmNlcyA9IHt9O1xuICBzb3VyY2VzLmZvckVhY2goZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgIHZhciBtZXJnZWRTb3VyY2UgPSBfdGhpczQuZ2V0TWVyZ2VkU291cmNlXyhzb3VyY2UsIG1lcmdlZFNvdXJjZXMpO1xuXG4gICAgaWYgKG1lcmdlZFNvdXJjZSA9PT0gbnVsbCkge1xuICAgICAgYWxsU291cmNlcy5wdXNoKHNvdXJjZSk7XG4gICAgfVxuICB9KTtcblxuICBmb3IgKHZhciBtZXJnZWRTb3VyY2VJZCBpbiBtZXJnZWRTb3VyY2VzKSB7XG4gICAgYWxsU291cmNlcy5wdXNoKG1lcmdlZFNvdXJjZXNbbWVyZ2VkU291cmNlSWRdKTtcbiAgfVxuXG4gIHJldHVybiBhbGxTb3VyY2VzO1xufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0TWVyZ2VkU291cmNlXyA9IGZ1bmN0aW9uIChzb3VyY2UsIG1lcmdlZFNvdXJjZXMpIHtcbiAgdmFyIG1lcmdlU291cmNlSWQgPSBudWxsO1xuXG4gIGZvciAodmFyIGN1cnJlbnRNZXJnZVNvdXJjZUlkIGluIHRoaXMubWVyZ2VUYWJzKSB7XG4gICAgdmFyIHNvdXJjZUxhYmVscyA9IHRoaXMubWVyZ2VUYWJzW2N1cnJlbnRNZXJnZVNvdXJjZUlkXTtcbiAgICB2YXIgY29udGFpbnNTb3VyY2UgPSBzb3VyY2VMYWJlbHMuc29tZShmdW5jdGlvbiAoc291cmNlTGFiZWwpIHtcbiAgICAgIHJldHVybiBzb3VyY2VMYWJlbCA9PSBzb3VyY2UubGFiZWw7XG4gICAgfSk7XG5cbiAgICBpZiAoY29udGFpbnNTb3VyY2UpIHtcbiAgICAgIG1lcmdlU291cmNlSWQgPSBjdXJyZW50TWVyZ2VTb3VyY2VJZDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGlmIChtZXJnZVNvdXJjZUlkID09PSBudWxsKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB2YXIgbWVyZ2VTb3VyY2U7XG5cbiAgaWYgKG1lcmdlU291cmNlSWQgaW4gbWVyZ2VkU291cmNlcykge1xuICAgIG1lcmdlU291cmNlID0gbWVyZ2VkU291cmNlc1ttZXJnZVNvdXJjZUlkXTtcbiAgfSBlbHNlIHtcbiAgICBtZXJnZVNvdXJjZSA9IHtcbiAgICAgIGZlYXR1cmVzOiBbXSxcbiAgICAgIGlkOiBtZXJnZVNvdXJjZUlkLFxuICAgICAgbGFiZWw6IG1lcmdlU291cmNlSWQsXG4gICAgICBsaW1pdDogdGhpcy5tYXhSZXN1bHRzLFxuICAgICAgcGVuZGluZzogZmFsc2UsXG4gICAgICBxdWVyaWVkOiB0cnVlLFxuICAgICAgdG9vTWFueVJlc3VsdHM6IGZhbHNlXG4gICAgfTtcbiAgICBtZXJnZWRTb3VyY2VzW21lcmdlU291cmNlSWRdID0gbWVyZ2VTb3VyY2U7XG4gIH1cblxuICBzb3VyY2UuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgIG1lcmdlU291cmNlLmZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XG4gIH0pO1xuICBtZXJnZVNvdXJjZS50b29NYW55UmVzdWx0cyA9IG1lcmdlU291cmNlLnRvb01hbnlSZXN1bHRzIHx8IHNvdXJjZS50b29NYW55UmVzdWx0cztcblxuICBpZiAobWVyZ2VTb3VyY2UudG9vTWFueVJlc3VsdHMpIHtcbiAgICBtZXJnZVNvdXJjZS50b3RhbEZlYXR1cmVDb3VudCA9IG1lcmdlU291cmNlLnRvdGFsRmVhdHVyZUNvdW50ICE9PSB1bmRlZmluZWQgPyBtZXJnZVNvdXJjZS50b3RhbEZlYXR1cmVDb3VudCArIG1lcmdlU291cmNlLmZlYXR1cmVzLmxlbmd0aCA6IG1lcmdlU291cmNlLmZlYXR1cmVzLmxlbmd0aDtcbiAgICBtZXJnZVNvdXJjZS5mZWF0dXJlcyA9IFtdO1xuICB9XG5cbiAgaWYgKHNvdXJjZS50b3RhbEZlYXR1cmVDb3VudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgbWVyZ2VTb3VyY2UudG90YWxGZWF0dXJlQ291bnQgPSBtZXJnZVNvdXJjZS50b3RhbEZlYXR1cmVDb3VudCAhPT0gdW5kZWZpbmVkID8gbWVyZ2VTb3VyY2UudG90YWxGZWF0dXJlQ291bnQgKyBzb3VyY2UudG90YWxGZWF0dXJlQ291bnQgOiBzb3VyY2UudG90YWxGZWF0dXJlQ291bnQ7XG4gIH1cblxuICByZXR1cm4gbWVyZ2VTb3VyY2U7XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5jb2xsZWN0RGF0YV8gPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gIHZhciBmZWF0dXJlcyA9IHNvdXJjZS5mZWF0dXJlcztcbiAgdmFyIGFsbFByb3BlcnRpZXMgPSBbXTtcbiAgdmFyIGZlYXR1cmVHZW9tZXRyaWVzTmFtZXMgPSBbXTtcbiAgdmFyIGZlYXR1cmVzRm9yU291cmNlID0ge307XG4gIHZhciBwcm9wZXJ0aWVzLCBmZWF0dXJlR2VvbWV0cnlOYW1lO1xuICBmZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgcHJvcGVydGllcyA9IGZlYXR1cmUuZ2V0UHJvcGVydGllcygpO1xuXG4gICAgaWYgKHByb3BlcnRpZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZmVhdHVyZUdlb21ldHJ5TmFtZSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnlOYW1lKCk7XG5cbiAgICAgIGlmICghZmVhdHVyZUdlb21ldHJpZXNOYW1lcy5pbmNsdWRlcyhmZWF0dXJlR2VvbWV0cnlOYW1lKSkge1xuICAgICAgICBmZWF0dXJlR2VvbWV0cmllc05hbWVzLnB1c2goZmVhdHVyZUdlb21ldHJ5TmFtZSk7XG4gICAgICB9XG5cbiAgICAgIGFsbFByb3BlcnRpZXMucHVzaChwcm9wZXJ0aWVzKTtcbiAgICAgIGZlYXR1cmVzRm9yU291cmNlW2dldFJvd1VpZChwcm9wZXJ0aWVzKV0gPSBmZWF0dXJlO1xuICAgIH1cbiAgfSk7XG4gIHRoaXMuY2xlYW5Qcm9wZXJ0aWVzXyhhbGxQcm9wZXJ0aWVzLCBmZWF0dXJlR2VvbWV0cmllc05hbWVzKTtcblxuICBpZiAoYWxsUHJvcGVydGllcy5sZW5ndGggPiAwKSB7XG4gICAgdmFyIGdyaWRDcmVhdGVkID0gdGhpcy5tYWtlR3JpZF8oYWxsUHJvcGVydGllcywgc291cmNlKTtcblxuICAgIGlmIChncmlkQ3JlYXRlZCkge1xuICAgICAgdGhpcy5mZWF0dXJlc0ZvclNvdXJjZXNfW1wiXCIgKyBzb3VyY2UubGFiZWxdID0gZmVhdHVyZXNGb3JTb3VyY2U7XG4gICAgfVxuICB9XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5jbGVhblByb3BlcnRpZXNfID0gZnVuY3Rpb24gKGFsbFByb3BlcnRpZXMsIGZlYXR1cmVHZW9tZXRyaWVzTmFtZXMpIHtcbiAgYWxsUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0aWVzKSB7XG4gICAgZmVhdHVyZUdlb21ldHJpZXNOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlR2VvbWV0cnlOYW1lKSB7XG4gICAgICBkZWxldGUgcHJvcGVydGllc1tmZWF0dXJlR2VvbWV0cnlOYW1lXTtcbiAgICB9KTtcbiAgICBkZWxldGUgcHJvcGVydGllcy5ib3VuZGVkQnk7XG4gICAgZGVsZXRlIHByb3BlcnRpZXMubmdlb19mZWF0dXJlX3R5cGVfO1xuICB9KTtcblxuICBpZiAodGhpcy5yZW1vdmVFbXB0eUNvbHVtbnNfID09PSB0cnVlKSB7XG4gICAgdGhpcy5yZW1vdmVFbXB0eUNvbHVtbnNGbl8oYWxsUHJvcGVydGllcyk7XG4gIH1cbn07XG5cblF1ZXJ5R3JpZENvbnRyb2xsZXIucHJvdG90eXBlLnJlbW92ZUVtcHR5Q29sdW1uc0ZuXyA9IGZ1bmN0aW9uIChhbGxQcm9wZXJ0aWVzKSB7XG4gIHZhciBrZXlzVG9LZWVwID0gW107XG4gIHZhciBpLCBrZXk7XG5cbiAgZm9yIChrZXkgaW4gYWxsUHJvcGVydGllc1swXSkge1xuICAgIGZvciAoaSA9IDA7IGkgPCBhbGxQcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYWxsUHJvcGVydGllc1tpXVtrZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAga2V5c1RvS2VlcC5wdXNoKGtleSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBrZXlUb1JlbW92ZTtcbiAgYWxsUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0aWVzKSB7XG4gICAga2V5VG9SZW1vdmUgPSBbXTtcblxuICAgIGZvciAoa2V5IGluIHByb3BlcnRpZXMpIHtcbiAgICAgIGlmICgha2V5c1RvS2VlcC5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgIGtleVRvUmVtb3ZlLnB1c2goa2V5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBrZXlUb1JlbW92ZS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIGRlbGV0ZSBwcm9wZXJ0aWVzW2tleV07XG4gICAgfSk7XG4gIH0pO1xufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUubWFrZUdyaWRfID0gZnVuY3Rpb24gKGRhdGEsIHNvdXJjZSkge1xuICB2YXIgc291cmNlTGFiZWwgPSBcIlwiICsgc291cmNlLmxhYmVsO1xuICB2YXIgZ3JpZENvbmZpZyA9IG51bGw7XG5cbiAgaWYgKGRhdGEgIT09IG51bGwpIHtcbiAgICBncmlkQ29uZmlnID0gdGhpcy5nZXRHcmlkQ29uZmlndXJhdGlvbl8oZGF0YSk7XG5cbiAgICBpZiAoZ3JpZENvbmZpZyA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGlmICghdGhpcy5sb2FkZWRHcmlkU291cmNlcy5pbmNsdWRlcyhzb3VyY2VMYWJlbCkpIHtcbiAgICB0aGlzLmxvYWRlZEdyaWRTb3VyY2VzLnB1c2goc291cmNlTGFiZWwpO1xuICB9XG5cbiAgdGhpcy5ncmlkU291cmNlc1tzb3VyY2VMYWJlbF0gPSB7XG4gICAgc291cmNlOiBzb3VyY2VcbiAgfTtcblxuICBpZiAoZ3JpZENvbmZpZykge1xuICAgIHRoaXMuZ3JpZFNvdXJjZXNbc291cmNlTGFiZWxdLmNvbmZpZ3VyYXRpb24gPSBncmlkQ29uZmlnO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5nZXRHcmlkQ29uZmlndXJhdGlvbl8gPSBmdW5jdGlvbiAoZGF0YSkge1xuICBpZiAoIWRhdGEubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGRhdGEnKTtcbiAgfVxuXG4gIHZhciBjbG9uZSA9IHt9O1xuICBPYmplY3QuYXNzaWduKGNsb25lLCBkYXRhWzBdKTtcbiAgZGVsZXRlIGNsb25lLm9sX3VpZDtcbiAgdmFyIGNvbHVtbnMgPSBPYmplY3Qua2V5cyhjbG9uZSk7XG4gIHZhciBjb2x1bW5EZWZzID0gW107XG4gIGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG4gICAgY29sdW1uRGVmcy5wdXNoKHtcbiAgICAgIG5hbWU6IGNvbHVtblxuICAgIH0pO1xuICB9KTtcblxuICBpZiAoY29sdW1uRGVmcy5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIG5ldyBuZ2VvR3JpZENvbmZpZyhkYXRhLCBjb2x1bW5EZWZzKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gIHRoaXMucGVuZGluZyA9IGZhbHNlO1xuICB0aGlzLmdyaWRTb3VyY2VzID0ge307XG4gIHRoaXMubG9hZGVkR3JpZFNvdXJjZXMgPSBbXTtcbiAgdGhpcy5zZWxlY3RlZFRhYiA9IG51bGw7XG4gIHRoaXMudG9vTWFueVJlc3VsdHMgPSBmYWxzZTtcbiAgdGhpcy5mZWF0dXJlc18uY2xlYXIoKTtcbiAgdGhpcy5oaWdobGlnaHRGZWF0dXJlc18uY2xlYXIoKTtcbiAgdGhpcy5uZ2VvTWFwUXVlcmVudF8uY2xlYXIoKTtcbiAgdGhpcy5mZWF0dXJlc0ZvclNvdXJjZXNfID0ge307XG5cbiAgaWYgKHRoaXMudW5yZWdpc3RlclNlbGVjdFdhdGNoZXJfKSB7XG4gICAgdGhpcy51bnJlZ2lzdGVyU2VsZWN0V2F0Y2hlcl8oKTtcbiAgfVxufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUuc2VsZWN0VGFiID0gZnVuY3Rpb24gKGdyaWRTb3VyY2UpIHtcbiAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgdmFyIHNvdXJjZSA9IGdyaWRTb3VyY2Uuc291cmNlO1xuICB0aGlzLnNlbGVjdGVkVGFiID0gc291cmNlLmxhYmVsO1xuXG4gIGlmICh0aGlzLnVucmVnaXN0ZXJTZWxlY3RXYXRjaGVyXykge1xuICAgIHRoaXMudW5yZWdpc3RlclNlbGVjdFdhdGNoZXJfKCk7XG4gICAgdGhpcy51bnJlZ2lzdGVyU2VsZWN0V2F0Y2hlcl8gPSBudWxsO1xuICB9XG5cbiAgaWYgKGdyaWRTb3VyY2UuY29uZmlndXJhdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy51bnJlZ2lzdGVyU2VsZWN0V2F0Y2hlcl8gPSB0aGlzLiRzY29wZV8uJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZ3JpZFNvdXJjZS5jb25maWd1cmF0aW9uLnNlbGVjdGVkUm93cztcbiAgICB9LCBmdW5jdGlvbiAobmV3U2VsZWN0ZWQsIG9sZFNlbGVjdGVkUm93cykge1xuICAgICAgaWYgKE9iamVjdC5rZXlzKG5ld1NlbGVjdGVkKSAhPT0gT2JqZWN0LmtleXMob2xkU2VsZWN0ZWRSb3dzKSkge1xuICAgICAgICBfdGhpczUub25TZWxlY3Rpb25DaGFuZ2VkXygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgdGhpcy51cGRhdGVGZWF0dXJlc18oZ3JpZFNvdXJjZSk7XG4gIHRoaXMucmVmbG93R3JpZF8oKTtcbn07XG5cblF1ZXJ5R3JpZENvbnRyb2xsZXIucHJvdG90eXBlLnJlZmxvd0dyaWRfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgaWQgPSB0aGlzLmVzY2FwZVZhbHVlKHRoaXMuc2VsZWN0ZWRUYWIgfHwgJycpO1xuICB2YXIgYWN0aXZlUGFuZSA9IHRoaXMuJGVsZW1lbnRfLmZpbmQoXCJkaXYudGFiLXBhbmUjXCIgKyBpZCk7XG4gIGFjdGl2ZVBhbmUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgdGhpcy4kdGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgIGFjdGl2ZVBhbmUuZmluZCgnZGl2Lm5nZW8tZ3JpZC10YWJsZS1jb250YWluZXIgdGFibGUnKS50cmlnZ2VyKCdyZWZsb3cnKTtcbiAgfSk7XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5vblNlbGVjdGlvbkNoYW5nZWRfID0gZnVuY3Rpb24gKCkge1xuICBpZiAodGhpcy5zZWxlY3RlZFRhYiA9PT0gbnVsbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBncmlkU291cmNlID0gdGhpcy5ncmlkU291cmNlc1tcIlwiICsgdGhpcy5zZWxlY3RlZFRhYl07XG4gIHRoaXMudXBkYXRlRmVhdHVyZXNfKGdyaWRTb3VyY2UpO1xufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUudXBkYXRlRmVhdHVyZXNfID0gZnVuY3Rpb24gKGdyaWRTb3VyY2UpIHtcbiAgdGhpcy5mZWF0dXJlc18uY2xlYXIoKTtcbiAgdGhpcy5oaWdobGlnaHRGZWF0dXJlc18uY2xlYXIoKTtcblxuICBpZiAoIWdyaWRTb3VyY2UuY29uZmlndXJhdGlvbikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBzb3VyY2VMYWJlbCA9IFwiXCIgKyBncmlkU291cmNlLnNvdXJjZS5sYWJlbDtcbiAgdmFyIGZlYXR1cmVzRm9yU291cmNlID0gdGhpcy5mZWF0dXJlc0ZvclNvdXJjZXNfW3NvdXJjZUxhYmVsXTtcbiAgdmFyIHNlbGVjdGVkUm93cyA9IGdyaWRTb3VyY2UuY29uZmlndXJhdGlvbi5zZWxlY3RlZFJvd3M7XG5cbiAgZm9yICh2YXIgcm93SWQgaW4gZmVhdHVyZXNGb3JTb3VyY2UpIHtcbiAgICB2YXIgZmVhdHVyZSA9IGZlYXR1cmVzRm9yU291cmNlW3Jvd0lkXTtcblxuICAgIGlmIChyb3dJZCBpbiBzZWxlY3RlZFJvd3MpIHtcbiAgICAgIHRoaXMuaGlnaGxpZ2h0RmVhdHVyZXNfLnB1c2goZmVhdHVyZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZmVhdHVyZXNfLnB1c2goZmVhdHVyZSk7XG4gICAgfVxuICB9XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5nZXRBY3RpdmVHcmlkU291cmNlID0gZnVuY3Rpb24gKCkge1xuICBpZiAodGhpcy5zZWxlY3RlZFRhYiA9PT0gbnVsbCkge1xuICAgIHJldHVybiBudWxsO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB0aGlzLmdyaWRTb3VyY2VzW1wiXCIgKyB0aGlzLnNlbGVjdGVkVGFiXTtcbiAgfVxufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUuaXNPbmVTZWxlY3RlZCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHNvdXJjZSA9IHRoaXMuZ2V0QWN0aXZlR3JpZFNvdXJjZSgpO1xuXG4gIGlmIChzb3VyY2UgPT09IG51bGwgfHwgc291cmNlLmNvbmZpZ3VyYXRpb24gPT09IG51bGwpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHNvdXJjZS5jb25maWd1cmF0aW9uLmdldFNlbGVjdGVkQ291bnQoKSA+IDA7XG4gIH1cbn07XG5cblF1ZXJ5R3JpZENvbnRyb2xsZXIucHJvdG90eXBlLmdldFNlbGVjdGVkUm93Q291bnQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBzb3VyY2UgPSB0aGlzLmdldEFjdGl2ZUdyaWRTb3VyY2UoKTtcblxuICBpZiAoc291cmNlID09PSBudWxsIHx8IHNvdXJjZS5jb25maWd1cmF0aW9uID09PSBudWxsKSB7XG4gICAgcmV0dXJuIDA7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHNvdXJjZS5jb25maWd1cmF0aW9uLmdldFNlbGVjdGVkQ291bnQoKTtcbiAgfVxufTtcblxuUXVlcnlHcmlkQ29udHJvbGxlci5wcm90b3R5cGUuc2VsZWN0QWxsID0gZnVuY3Rpb24gKCkge1xuICB2YXIgc291cmNlID0gdGhpcy5nZXRBY3RpdmVHcmlkU291cmNlKCk7XG5cbiAgaWYgKHNvdXJjZSAhPT0gbnVsbCkge1xuICAgIHNvdXJjZS5jb25maWd1cmF0aW9uLnNlbGVjdEFsbCgpO1xuICB9XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS51bnNlbGVjdEFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHNvdXJjZSA9IHRoaXMuZ2V0QWN0aXZlR3JpZFNvdXJjZSgpO1xuXG4gIGlmIChzb3VyY2UgIT09IG51bGwpIHtcbiAgICBzb3VyY2UuY29uZmlndXJhdGlvbi51bnNlbGVjdEFsbCgpO1xuICB9XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5pbnZlcnRTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBzb3VyY2UgPSB0aGlzLmdldEFjdGl2ZUdyaWRTb3VyY2UoKTtcblxuICBpZiAoc291cmNlICE9PSBudWxsKSB7XG4gICAgc291cmNlLmNvbmZpZ3VyYXRpb24uaW52ZXJ0U2VsZWN0aW9uKCk7XG4gIH1cbn07XG5cblF1ZXJ5R3JpZENvbnRyb2xsZXIucHJvdG90eXBlLnpvb21Ub1NlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLm1hcF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gIH1cblxuICB2YXIgc291cmNlID0gdGhpcy5nZXRBY3RpdmVHcmlkU291cmNlKCk7XG5cbiAgaWYgKHNvdXJjZSAhPT0gbnVsbCkge1xuICAgIHZhciBleHRlbnQgPSBvbEV4dGVudC5jcmVhdGVFbXB0eSgpO1xuICAgIHRoaXMuaGlnaGxpZ2h0RmVhdHVyZXNfLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgICAgaWYgKCFnZW9tZXRyeSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICAgIH1cblxuICAgICAgb2xFeHRlbnQuZXh0ZW5kKGV4dGVudCwgZ2VvbWV0cnkuZ2V0RXh0ZW50KCkpO1xuICAgIH0pO1xuICAgIHZhciBzaXplID0gdGhpcy5tYXBfLmdldFNpemUoKTtcblxuICAgIGlmICghc2l6ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNpemUnKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5tYXhSZWNlbnRlclpvb20gPT09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXhSZWNlbnRlclpvb20nKTtcbiAgICB9XG5cbiAgICB0aGlzLm1hcF8uZ2V0VmlldygpLmZpdChleHRlbnQsIHtcbiAgICAgIHNpemU6IHNpemUsXG4gICAgICBtYXhab29tOiB0aGlzLm1heFJlY2VudGVyWm9vbVxuICAgIH0pO1xuICB9XG59O1xuXG5RdWVyeUdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5kb3dubG9hZENzdiA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHNvdXJjZSA9IHRoaXMuZ2V0QWN0aXZlR3JpZFNvdXJjZSgpO1xuXG4gIGlmIChzb3VyY2UgIT09IG51bGwpIHtcbiAgICB2YXIgY29sdW1uRGVmcyA9IHNvdXJjZS5jb25maWd1cmF0aW9uLmNvbHVtbkRlZnM7XG5cbiAgICBpZiAoIWNvbHVtbkRlZnMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjb2x1bW5EZWZzJyk7XG4gICAgfVxuXG4gICAgdmFyIHNlbGVjdGVkUm93cyA9IHNvdXJjZS5jb25maWd1cmF0aW9uLmdldFNlbGVjdGVkUm93cygpO1xuICAgIHRoaXMubmdlb0NzdkRvd25sb2FkXy5zdGFydERvd25sb2FkKHNlbGVjdGVkUm93cywgY29sdW1uRGVmcywgdGhpcy5maWxlbmFtZV8pO1xuICB9XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignR21mRGlzcGxheXF1ZXJ5Z3JpZENvbnRyb2xsZXInLCBRdWVyeUdyaWRDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaikge1xub2JqIHx8IChvYmogPSB7fSk7XG52YXIgX190LCBfX3AgPSAnJztcbndpdGggKG9iaikge1xuX19wICs9ICc8ZGl2XFxuICBjbGFzcz1cImdtZi1kaXNwbGF5cXVlcnl3aW5kb3dcIlxcbiAgbmctY2xhc3M9XCJ7XFwnZGVza3RvcFxcJzogY3RybC5kZXNrdG9wLCBcXCdtb2JpbGVcXCc6ICFjdHJsLmRlc2t0b3B9XCJcXG4gIG5nLXNob3c9XCJjdHJsLm9wZW5cIj5cXG5cXG4gIDxidXR0b25cXG4gICAgY2xhc3M9XCJjb2xsYXBzZS1idXR0b25cIlxcbiAgICB0eXBlPVwiYnV0dG9uXCJcXG4gICAgbmctc2hvdz1cIjo6IWN0cmwuZGVza3RvcFwiXFxuICAgIG5nZW8tc3dpcGUtdXA9XCJjdHJsLmNvbGxhcHNlZCA9IGZhbHNlXCJcXG4gICAgbmdlby1zd2lwZS1kb3duPVwiY3RybC5jb2xsYXBzZWQgPSB0cnVlXCJcXG4gICAgbmdlby1zd2lwZS1kaXNhYmxlLW1vdXNlXFxuICAgIG5nLWNsaWNrPVwiY3RybC5jb2xsYXBzZWQgPSAhY3RybC5jb2xsYXBzZWRcIlxcbiAgICBuZy1jbGFzcz1cIltjdHJsLmNvbGxhcHNlZCA/IFxcJ2NvbGxhcHNlLWJ1dHRvbi11cFxcJyA6IFxcJ2NvbGxhcHNlLWJ1dHRvbi1kb3duXFwnXVwiPlxcbiAgPC9idXR0b24+XFxuXFxuICA8ZGl2XFxuICBjbGFzcz1cIndpbmRvd2NvbnRhaW5lclwiXFxuICBuZy1zd2lwZS1kaXNhYmxlLW1vdXNlXFxuICBuZy1zd2lwZS1sZWZ0PVwiY3RybC5uZXh0KClcIlxcbiAgbmctc3dpcGUtcmlnaHQ9XCJjdHJsLnByZXZpb3VzKClcIj5cXG5cXG4gICAgPGJ1dHRvblxcbiAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgIGNsYXNzPVwiYnRuIGZhLXRpbWVzIGNsb3NlXCJcXG4gICAgICBuZy1jbGljaz1cImN0cmwuY2xvc2UoKVwiPlxcbiAgICA8L2J1dHRvbj5cXG5cXG4gICAgPGRpdlxcbiAgICAgIGNsYXNzPVwiYW5pbWF0aW9uLWNvbnRhaW5lclwiXFxuICAgICAgbmctY2xhc3M9XCJbY3RybC5jb2xsYXBzZWQgPyBcXCdcXCcgOiBcXCdhbmltYXRpb24tY29udGFpbmVyLWRldGFpbGVkXFwnLCBjdHJsLmlzTmV4dCA/IFxcJ25leHRcXCcgOiBcXCdwcmV2aW91c1xcJ11cIj5cXG5cXG4gICAgICA8ZGl2XFxuICAgICAgICBuZy1hbmltYXRlLXN3YXA9XCJjdHJsLmFuaW1hdGVcIlxcbiAgICAgICAgY2xhc3M9XCJzbGlkZS1hbmltYXRpb24gZ21mLWFuaW1hdGFibGVcIj5cXG5cXG4gICAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXIgdWktZHJhZ2dhYmxlLWhhbmRsZVwiPlxcbiAgICAgICAgICA8cFxcbiAgICAgICAgICAgIGNsYXNzPVwidGl0bGVcIlxcbiAgICAgICAgICAgID57e2N0cmwuc291cmNlLmxhYmVsIHwgdHJhbnNsYXRlfX08L3A+XFxuICAgICAgICAgIDxwXFxuICAgICAgICAgICAgY2xhc3M9XCJzdWJ0aXRsZVwiXFxuICAgICAgICAgICAgPnt7Y3RybC5nZXRGZWF0dXJlVmFsdWVzKClbY3RybC5zb3VyY2UuaWRlbnRpZmllckF0dHJpYnV0ZUZpZWxkXX19PC9wPlxcbiAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICA8ZGl2IGNsYXNzPVwiZGV0YWlsc1wiPlxcbiAgICAgICAgICA8dGFibGU+XFxuICAgICAgICAgICAgPHRyXFxuICAgICAgICAgICAgICBuZy1yZXBlYXQ9XCIoa2V5LCB2YWx1ZSkgaW4gY3RybC5nZXRGZWF0dXJlVmFsdWVzKClcIlxcbiAgICAgICAgICAgICAgbmctaWY9XCJ2YWx1ZSAhPT0gdW5kZWZpbmVkXCI+XFxuICAgICAgICAgICAgICA8dGRcXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJkZXRhaWxzLWtleVwiXFxuICAgICAgICAgICAgICAgIG5nLWJpbmQtaHRtbD1cImtleSB8IHRyYW5zbGF0ZSB8IG5nZW9UcnVzdEh0bWxcIlxcbiAgICAgICAgICAgICAgICA+PC90ZD5cXG4gICAgICAgICAgICAgIDx0ZFxcbiAgICAgICAgICAgICAgICBjbGFzcz1cImRldGFpbHMtdmFsdWVcIlxcbiAgICAgICAgICAgICAgICBuZy1iaW5kLWh0bWw9XCJ2YWx1ZSB8IHJlbW92ZUNEQVRBIHwgbmdlb1RydXN0SHRtbEF1dG9cIlxcbiAgICAgICAgICAgICAgICA+PC90ZD5cXG4gICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICA8L3RhYmxlPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8ZGl2IGNsYXNzPVwibmF2aWdhdGVcIj5cXG5cXG4gICAgICA8ZGl2IGNsYXNzPVwicGxhY2Vob2xkZXJcIj5cXG4gICAgICAgIDxidXR0b25cXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgICAgIGNsYXNzPVwicHJldmlvdXMgYnRuXCJcXG4gICAgICAgICAgbmctZGlzYWJsZWQ9XCJjdHJsLmlzRmlyc3QoKVwiXFxuICAgICAgICAgIG5nLXNob3c9XCJjdHJsLmdldFJlc3VsdExlbmd0aCgpID4gMVwiXFxuICAgICAgICAgIG5nLWNsaWNrPVwiY3RybC5wcmV2aW91cygpXCI+XFxuICAgICAgICAgIDxzcGFuIG5nLXNob3c9XCI6OmN0cmwuZGVza3RvcFwiPnt7XFwnUHJldi5cXCcgfCB0cmFuc2xhdGV9fTwvc3Bhbj5cXG4gICAgICAgIDwvYnV0dG9uPlxcbiAgICAgIDwvZGl2PlxcblxcbiAgICAgIDxkaXYgY2xhc3M9XCJyZXN1bHRzXCI+XFxuICAgICAgICA8c3BhbiBuZy1zaG93PVwiOjohY3RybC5kZXNrdG9wXCI+e3tcXCdSZXN1bHRcXCcgfCB0cmFuc2xhdGV9fTwvc3Bhbj5cXG4gICAgICAgIDxzcGFuPnt7Y3RybC5jdXJyZW50UmVzdWx0ICsgMX19PC9zcGFuPlxcbiAgICAgICAgPHNwYW4+Lzwvc3Bhbj5cXG4gICAgICAgIDxzcGFuPnt7Y3RybC5nZXRSZXN1bHRMZW5ndGgoKX19PC9zcGFuPlxcbiAgICAgICAgPGRpdlxcbiAgICAgICAgICBuZy1zaG93PVwiOjpjdHJsLmRlc2t0b3BcIlxcbiAgICAgICAgICBjbGFzcz1cImRyb3B1cFwiPlxcblxcbiAgICAgICAgICA8YnV0dG9uXFxuICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgZHJvcGRvd24tdG9nZ2xlXCJcXG4gICAgICAgICAgICBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJcXG4gICAgICAgICAgICBhcmlhLWV4cGFuZGVkPVwiZmFsc2VcIj5cXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLWZpbHRlclwiPjwvc3Bhbj5cXG4gICAgICAgICAgPC9idXR0b24+XFxuXFxuICAgICAgICAgIDx1bFxcbiAgICAgICAgICAgIGNsYXNzPVwiZHJvcGRvd24tbWVudSBkcm9wZG93bi1tZW51LXJpZ2h0XCJcXG4gICAgICAgICAgICByb2xlPVwibWVudVwiPlxcblxcbiAgICAgICAgICAgIDxsaT5cXG4gICAgICAgICAgICAgIDxhXFxuICAgICAgICAgICAgICAgIGhyZWY9XCIjXCJcXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCJjdHJsLnNldFNlbGVjdGVkU291cmNlKG51bGwpXCI+XFxuICAgICAgICAgICAgICAgIDxpXFxuICAgICAgICAgICAgICAgICAgY2xhc3M9XCJmYSBmYS1md1wiXFxuICAgICAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7XFwnZmEtY2hlY2tcXCc6IGN0cmwuc2VsZWN0ZWRTb3VyY2UgPT09IG51bGx9XCI+XFxuICAgICAgICAgICAgICAgIDwvaT5cXG4gICAgICAgICAgICAgICAgPHNwYW4+e3tcXCdBbGwgbGF5ZXJzXFwnIHwgdHJhbnNsYXRlfX0gKHt7Y3RybC5uZ2VvUXVlcnlSZXN1bHQudG90YWx9fSk8L3NwYW4+XFxuICAgICAgICAgICAgICA8L2E+XFxuICAgICAgICAgICAgPC9saT5cXG5cXG4gICAgICAgICAgICA8bGlcXG4gICAgICAgICAgICAgIHJvbGU9XCJzZXBhcmF0b3JcIlxcbiAgICAgICAgICAgICAgY2xhc3M9XCJkaXZpZGVyXCI+XFxuICAgICAgICAgICAgPC9saT5cXG5cXG4gICAgICAgICAgICA8bGlcXG4gICAgICAgICAgICAgIG5nLXJlcGVhdC1zdGFydD1cInNvdXJjZSBpbiBjdHJsLm5nZW9RdWVyeVJlc3VsdC5zb3VyY2VzIHwgZmlsdGVyOiBjdHJsLnNvdXJjZXNGaWx0ZXJcIiBuZy1yZXBlYXQtZW5kXFxuICAgICAgICAgICAgICBuZy1jbGFzcz1cIntcXCdkaXNhYmxlZFxcJzogc291cmNlLmZlYXR1cmVzLmxlbmd0aCA8PSAwfVwiPlxcbiAgICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgICAgaHJlZj1cIiNcIlxcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cImN0cmwuc2V0U2VsZWN0ZWRTb3VyY2Uoc291cmNlKVwiPlxcbiAgICAgICAgICAgICAgICA8aVxcbiAgICAgICAgICAgICAgICAgIGNsYXNzPVwiZmEgZmEtZndcIlxcbiAgICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwie1xcJ2ZhLWNoZWNrXFwnOiBjdHJsLnNlbGVjdGVkU291cmNlID09PSBzb3VyY2V9XCI+XFxuICAgICAgICAgICAgICAgIDwvaT5cXG4gICAgICAgICAgICAgICAgPHNwYW4+e3tzb3VyY2UubGFiZWwgfCB0cmFuc2xhdGV9fSAoe3tzb3VyY2UuZmVhdHVyZXMubGVuZ3RofX0pPC9zcGFuPlxcbiAgICAgICAgICAgICAgPC9hPlxcbiAgICAgICAgICAgIDwvbGk+XFxuICAgICAgICAgIDwvdWw+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG5cXG4gICAgICA8ZGl2IGNsYXNzPVwicGxhY2Vob2xkZXJcIj5cXG4gICAgICAgIDxidXR0b25cXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgICAgIGNsYXNzPVwibmV4dCBidG5cIlxcbiAgICAgICAgICBuZy1kaXNhYmxlZD1cImN0cmwuaXNMYXN0KClcIlxcbiAgICAgICAgICBuZy1zaG93PVwiY3RybC5nZXRSZXN1bHRMZW5ndGgoKSA+IDFcIlxcbiAgICAgICAgICBuZy1jbGljaz1cImN0cmwubmV4dCgpXCI+XFxuICAgICAgICAgIDxzcGFuIG5nLXNob3c9XCI6OmN0cmwuZGVza3RvcFwiPnt7XFwnTmV4dFxcJyB8IHRyYW5zbGF0ZX19PC9zcGFuPlxcbiAgICAgICAgPC9idXR0b24+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsIlF1ZXJ5V2luZG93Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkc2NvcGVcIiwgXCJuZ2VvUXVlcnlSZXN1bHRcIiwgXCJuZ2VvTWFwUXVlcmVudFwiLCBcIm5nZW9GZWF0dXJlT3ZlcmxheU1nclwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9NYXBGZWF0dXJlT3ZlcmxheU1nciBmcm9tICduZ2VvL21hcC9GZWF0dXJlT3ZlcmxheU1nci5qcyc7XG5pbXBvcnQgbmdlb01pc2NGZWF0dXJlSGVscGVyLCB7IGdldEZpbHRlcmVkRmVhdHVyZVZhbHVlcyB9IGZyb20gJ25nZW8vbWlzYy9GZWF0dXJlSGVscGVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY1N3aXBlIGZyb20gJ25nZW8vbWlzYy9zd2lwZS5qcyc7XG5pbXBvcnQgbmdlb1F1ZXJ5TWFwUXVlcmVudCBmcm9tICduZ2VvL3F1ZXJ5L01hcFF1ZXJlbnQuanMnO1xuaW1wb3J0IG9sQ29sbGVjdGlvbiBmcm9tICdvbC9Db2xsZWN0aW9uLmpzJztcbmltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdvbC9vYmouanMnO1xuaW1wb3J0IG9sU3R5bGVDaXJjbGUgZnJvbSAnb2wvc3R5bGUvQ2lyY2xlLmpzJztcbmltcG9ydCBvbFN0eWxlRmlsbCBmcm9tICdvbC9zdHlsZS9GaWxsLmpzJztcbmltcG9ydCBvbFN0eWxlU3Ryb2tlIGZyb20gJ29sL3N0eWxlL1N0cm9rZS5qcyc7XG5pbXBvcnQgb2xTdHlsZVN0eWxlIGZyb20gJ29sL3N0eWxlL1N0eWxlLmpzJztcbmltcG9ydCAnanF1ZXJ5LXVpL3VpL3dpZGdldHMvcmVzaXphYmxlLmpzJztcbmltcG9ydCAnbmdlby9zYXNzL2pxdWVyeS11aS5zY3NzJztcbmltcG9ydCAnYW5ndWxhci1hbmltYXRlJztcbmltcG9ydCAnYW5ndWxhci10b3VjaCc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvY29sbGFwc2UuanMnO1xuaW1wb3J0ICdib290c3RyYXAvanMvc3JjL2Ryb3Bkb3duLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mUXVlcnlXaW5kb3dDb21wb25lbnQnLCBbbmdlb01hcEZlYXR1cmVPdmVybGF5TWdyLm5hbWUsIG5nZW9NaXNjRmVhdHVyZUhlbHBlci5uYW1lLCBuZ2VvTWlzY1N3aXBlLm5hbWUsIG5nZW9RdWVyeU1hcFF1ZXJlbnQubmFtZSwgJ25nQW5pbWF0ZScsICduZ1RvdWNoJ10pO1xubW9kdWxlLmNvbmZpZyhbJyRhbmltYXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJGFuaW1hdGVQcm92aWRlcikge1xuICAkYW5pbWF0ZVByb3ZpZGVyLmNsYXNzTmFtZUZpbHRlcigvZ21mLWFuaW1hdGFibGUvKTtcbn1dKTtcbm1vZHVsZS52YWx1ZSgnZ21mRGlzcGxheXF1ZXJ5d2luZG93VGVtcGxhdGVVcmwnLCBmdW5jdGlvbiAoJGVsZW1lbnQsICRhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSAkYXR0cnMuZ21mRGlzcGxheXF1ZXJ5d2luZG93VGVtcGxhdGV1cmw7XG4gIHJldHVybiB0ZW1wbGF0ZVVybCAhPT0gdW5kZWZpbmVkID8gdGVtcGxhdGVVcmwgOiAnZ21mL3F1ZXJ5L3dpbmRvd0NvbXBvbmVudCc7XG59KTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZ21mL3F1ZXJ5L3dpbmRvd0NvbXBvbmVudCcsIHJlcXVpcmUoJy4vd2luZG93Q29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5nbWZEaXNwbGF5cXVlcnl3aW5kb3dUZW1wbGF0ZVVybC4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkYXR0cnNcIiwgXCJnbWZEaXNwbGF5cXVlcnl3aW5kb3dUZW1wbGF0ZVVybFwiXTtcblxuZnVuY3Rpb24gZ21mRGlzcGxheXF1ZXJ5d2luZG93VGVtcGxhdGVVcmwoJGVsZW1lbnQsICRhdHRycywgZ21mRGlzcGxheXF1ZXJ5d2luZG93VGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIGdtZkRpc3BsYXlxdWVyeXdpbmRvd1RlbXBsYXRlVXJsKCRlbGVtZW50LCAkYXR0cnMpO1xufVxuXG52YXIgcXVlcnlXaW5kb3dDb21wb25lbnQgPSB7XG4gIGNvbnRyb2xsZXI6ICdHbWZEaXNwbGF5cXVlcnl3aW5kb3dDb250cm9sbGVyIGFzIGN0cmwnLFxuICBiaW5kaW5nczoge1xuICAgICdkcmFnZ2FibGVDb250YWlubWVudCc6ICc8P2dtZkRpc3BsYXlxdWVyeXdpbmRvd0RyYWdnYWJsZUNvbnRhaW5tZW50JyxcbiAgICAnZmVhdHVyZXNTdHlsZUZuJzogJyZnbWZEaXNwbGF5cXVlcnl3aW5kb3dGZWF0dXJlc3N0eWxlJyxcbiAgICAnc2VsZWN0ZWRGZWF0dXJlU3R5bGVGbic6ICcmZ21mRGlzcGxheXF1ZXJ5d2luZG93U2VsZWN0ZWRmZWF0dXJlc3R5bGUnLFxuICAgICdkZWZhdWx0Q29sbGFwc2VkRm4nOiAnJj9nbWZEaXNwbGF5cXVlcnl3aW5kb3dEZWZhdWx0Y29sbGFwc2VkJyxcbiAgICAnZGVza3RvcCc6ICc9Z21mRGlzcGxheXF1ZXJ5d2luZG93RGVza3RvcCcsXG4gICAgJ3Nob3dVbnF1ZXJpZWRMYXllcnMnOiAnPWdtZkRpc3BsYXlxdWVyeXdpbmRvd1Nob3d1bnF1ZXJpZWRsYXllcnMnXG4gIH0sXG4gIHRlbXBsYXRlVXJsOiBnbWZEaXNwbGF5cXVlcnl3aW5kb3dUZW1wbGF0ZVVybFxufTtcbm1vZHVsZS5jb21wb25lbnQoJ2dtZkRpc3BsYXlxdWVyeXdpbmRvdycsIHF1ZXJ5V2luZG93Q29tcG9uZW50KTtcbmV4cG9ydCBmdW5jdGlvbiBRdWVyeVdpbmRvd0NvbnRyb2xsZXIoJGVsZW1lbnQsICRzY29wZSwgbmdlb1F1ZXJ5UmVzdWx0LCBuZ2VvTWFwUXVlcmVudCwgbmdlb0ZlYXR1cmVPdmVybGF5TWdyKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgdGhpcy5kcmFnZ2FibGVDb250YWlubWVudCA9ICcnO1xuICB0aGlzLmRlc2t0b3AgPSBmYWxzZTtcbiAgdGhpcy5jb2xsYXBzZWQgPSAhdGhpcy5kZXNrdG9wO1xuICB0aGlzLnNob3dVbnF1ZXJpZWRMYXllcnNfID0gZmFsc2U7XG4gIHRoaXMuc291cmNlc0ZpbHRlciA9IHtcbiAgICAncXVlcmllZCc6IHRydWVcbiAgfTtcbiAgdGhpcy5uZ2VvUXVlcnlSZXN1bHQgPSB7XG4gICAgc291cmNlczogW10sXG4gICAgdG90YWw6IDAsXG4gICAgcGVuZGluZzogZmFsc2VcbiAgfTtcbiAgdGhpcy5uZ2VvTWFwUXVlcmVudF8gPSBuZ2VvTWFwUXVlcmVudDtcbiAgdGhpcy5zZWxlY3RlZFNvdXJjZSA9IG51bGw7XG4gIHRoaXMuZmVhdHVyZXNfID0gbmV3IG9sQ29sbGVjdGlvbigpO1xuICB0aGlzLm5nZW9GZWF0dXJlT3ZlcmxheU1ncl8gPSBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3I7XG4gIHRoaXMuaGlnaGxpZ2h0RmVhdHVyZXNfID0gbmV3IG9sQ29sbGVjdGlvbigpO1xuICB0aGlzLnNvdXJjZSA9IG51bGw7XG4gIHRoaXMuZmVhdHVyZSA9IG51bGw7XG4gIHRoaXMuY3VycmVudFJlc3VsdCA9IC0xO1xuICB0aGlzLmlzTmV4dCA9IHRydWU7XG4gIHRoaXMuYW5pbWF0ZSA9IDA7XG4gIHRoaXMub3BlbiA9IGZhbHNlO1xuICB0aGlzLmVsZW1lbnRfID0gJGVsZW1lbnQ7XG5cbiAgdGhpcy5kZWZhdWx0Q29sbGFwc2VkRm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICFfdGhpcy5kZXNrdG9wO1xuICB9O1xuXG4gIHRoaXMuc2hvd1VucXVlcmllZExheWVycyA9IGZhbHNlO1xuICB0aGlzLmZlYXR1cmVzU3R5bGVGbiA9IG51bGw7XG4gIHRoaXMuc2VsZWN0ZWRGZWF0dXJlU3R5bGVGbiA9IG51bGw7XG4gICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmdlb1F1ZXJ5UmVzdWx0O1xuICB9LCBmdW5jdGlvbiAobmV3UXVlcnlSZXN1bHQsIG9sZFF1ZXJ5UmVzdWx0KSB7XG4gICAgX3RoaXMudXBkYXRlUXVlcnlSZXN1bHRfKG5ld1F1ZXJ5UmVzdWx0KTtcblxuICAgIGlmIChuZXdRdWVyeVJlc3VsdC50b3RhbCA+IDApIHtcbiAgICAgIF90aGlzLnNob3coKTtcbiAgICB9IGVsc2UgaWYgKG9sZFF1ZXJ5UmVzdWx0ICE9PSBuZXdRdWVyeVJlc3VsdCkge1xuICAgICAgX3RoaXMub3BlbiA9IGZhbHNlO1xuXG4gICAgICBfdGhpcy5jbGVhcigpO1xuICAgIH1cbiAgfSk7XG59XG5cblF1ZXJ5V2luZG93Q29udHJvbGxlci5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLmZlYXR1cmVzU3R5bGVGbikge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlc1N0eWxlRm4nKTtcbiAgfVxuXG4gIGlmICghdGhpcy5zZWxlY3RlZEZlYXR1cmVTdHlsZUZuKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNlbGVjdGVkRmVhdHVyZVN0eWxlRm4nKTtcbiAgfVxuXG4gIHRoaXMuZHJhZ2dhYmxlQ29udGFpbm1lbnQgPSB0aGlzLmRyYWdnYWJsZUNvbnRhaW5tZW50IHx8ICdkb2N1bWVudCc7XG4gIHRoaXMuZGVza3RvcCA9IHRoaXMuZGVza3RvcDtcbiAgdGhpcy5jb2xsYXBzZWQgPSB0aGlzLmRlZmF1bHRDb2xsYXBzZWRGbigpO1xuICB0aGlzLnNob3dVbnF1ZXJpZWRMYXllcnNfID0gdGhpcy5zaG93VW5xdWVyaWVkTGF5ZXJzO1xuICB0aGlzLnNvdXJjZXNGaWx0ZXIgPSB0aGlzLnNob3dVbnF1ZXJpZWRMYXllcnNfID8ge30gOiB7XG4gICAgJ3F1ZXJpZWQnOiB0cnVlXG4gIH07XG4gIHZhciBmZWF0dXJlc092ZXJsYXkgPSB0aGlzLm5nZW9GZWF0dXJlT3ZlcmxheU1ncl8uZ2V0RmVhdHVyZU92ZXJsYXkoKTtcbiAgZmVhdHVyZXNPdmVybGF5LnNldEZlYXR1cmVzKHRoaXMuZmVhdHVyZXNfKTtcbiAgdmFyIGZlYXR1cmVzU3R5bGUgPSB0aGlzLmZlYXR1cmVzU3R5bGVGbigpO1xuXG4gIGlmIChmZWF0dXJlc1N0eWxlICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAoIShmZWF0dXJlc1N0eWxlIGluc3RhbmNlb2Ygb2xTdHlsZVN0eWxlKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBmZWF0dXJlc1N0eWxlIHR5cGUnKTtcbiAgICB9XG5cbiAgICBmZWF0dXJlc092ZXJsYXkuc2V0U3R5bGUoZmVhdHVyZXNTdHlsZSk7XG4gIH1cblxuICB2YXIgaGlnaGxpZ2h0RmVhdHVyZXNPdmVybGF5ID0gdGhpcy5uZ2VvRmVhdHVyZU92ZXJsYXlNZ3JfLmdldEZlYXR1cmVPdmVybGF5KCk7XG4gIGhpZ2hsaWdodEZlYXR1cmVzT3ZlcmxheS5zZXRGZWF0dXJlcyh0aGlzLmhpZ2hsaWdodEZlYXR1cmVzXyk7XG4gIHZhciBoaWdobGlnaHRGZWF0dXJlU3R5bGUgPSB0aGlzLnNlbGVjdGVkRmVhdHVyZVN0eWxlRm4oKTtcblxuICBpZiAoaGlnaGxpZ2h0RmVhdHVyZVN0eWxlICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAoIShoaWdobGlnaHRGZWF0dXJlU3R5bGUgaW5zdGFuY2VvZiBvbFN0eWxlU3R5bGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGhpZ2hsaWdodEZlYXR1cmVTdHlsZSB0eXBlJyk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBmaWxsID0gbmV3IG9sU3R5bGVGaWxsKHtcbiAgICAgIGNvbG9yOiBbMjU1LCAwLCAwLCAwLjZdXG4gICAgfSk7XG4gICAgdmFyIHN0cm9rZSA9IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICAgIGNvbG9yOiBbMjU1LCAwLCAwLCAxXSxcbiAgICAgIHdpZHRoOiAyXG4gICAgfSk7XG4gICAgaGlnaGxpZ2h0RmVhdHVyZVN0eWxlID0gbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICBmaWxsOiBmaWxsLFxuICAgICAgaW1hZ2U6IG5ldyBvbFN0eWxlQ2lyY2xlKHtcbiAgICAgICAgZmlsbDogZmlsbCxcbiAgICAgICAgcmFkaXVzOiA1LFxuICAgICAgICBzdHJva2U6IHN0cm9rZVxuICAgICAgfSksXG4gICAgICBzdHJva2U6IHN0cm9rZVxuICAgIH0pO1xuICB9XG5cbiAgaGlnaGxpZ2h0RmVhdHVyZXNPdmVybGF5LnNldFN0eWxlKGhpZ2hsaWdodEZlYXR1cmVTdHlsZSk7XG4gIHZhciB3aW5kb3dDb250YWluZXIgPSB0aGlzLmVsZW1lbnRfLmZpbmQoJy5nbWYtZGlzcGxheXF1ZXJ5d2luZG93IC53aW5kb3djb250YWluZXInKTtcblxuICBpZiAodGhpcy5kZXNrdG9wKSB7XG4gICAgd2luZG93Q29udGFpbmVyLmRyYWdnYWJsZSh7XG4gICAgICBoYW5kbGU6ICcuaGVhZGVyJyxcbiAgICAgIGNvbnRhaW5tZW50OiB0aGlzLmRyYWdnYWJsZUNvbnRhaW5tZW50XG4gICAgfSk7XG4gICAgd2luZG93Q29udGFpbmVyLnJlc2l6YWJsZSh7XG4gICAgICBoYW5kbGVzOiAnYWxsJyxcbiAgICAgIG1pbkhlaWdodDogMjQwLFxuICAgICAgbWluV2lkdGg6IDI0MFxuICAgIH0pO1xuICB9XG59O1xuXG5RdWVyeVdpbmRvd0NvbnRyb2xsZXIucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuY2xlYXIoKTtcbiAgdGhpcy51cGRhdGVGZWF0dXJlc18oKTtcbn07XG5cblF1ZXJ5V2luZG93Q29udHJvbGxlci5wcm90b3R5cGUudXBkYXRlRmVhdHVyZXNfID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnNldEN1cnJlbnRSZXN1bHRfKDAsIGZhbHNlKTtcblxuICBpZiAodGhpcy5zb3VyY2UgIT09IG51bGwpIHtcbiAgICB0aGlzLmNvbGxlY3RGZWF0dXJlc18oKTtcbiAgICB0aGlzLmhpZ2hsaWdodEN1cnJlbnRGZWF0dXJlXygpO1xuICAgIHRoaXMub3BlbiA9IHRydWU7XG4gIH1cbn07XG5cblF1ZXJ5V2luZG93Q29udHJvbGxlci5wcm90b3R5cGUuc2V0Q3VycmVudFJlc3VsdF8gPSBmdW5jdGlvbiAocG9zaXRpb24sIHNldEhpZ2hsaWdodCkge1xuICB2YXIgaGFzQ2hhbmdlZCA9IGZhbHNlO1xuXG4gIGlmIChwb3NpdGlvbiAhPT0gdGhpcy5jdXJyZW50UmVzdWx0KSB7XG4gICAgdmFyIGksIHNvdXJjZSwgZmVhdHVyZXM7XG4gICAgdmFyIGxhc3RGZWF0dXJlID0gdGhpcy5mZWF0dXJlO1xuICAgIHZhciBzb3VyY2VzID0gdGhpcy5uZ2VvUXVlcnlSZXN1bHQuc291cmNlcztcbiAgICB0aGlzLmN1cnJlbnRSZXN1bHQgPSBwb3NpdGlvbjtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBzb3VyY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzb3VyY2UgPSBzb3VyY2VzW2ldO1xuXG4gICAgICBpZiAodGhpcy5zZWxlY3RlZFNvdXJjZSAhPT0gbnVsbCAmJiB0aGlzLnNlbGVjdGVkU291cmNlICE9PSBzb3VyY2UpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGZlYXR1cmVzID0gc291cmNlLmZlYXR1cmVzO1xuXG4gICAgICBpZiAocG9zaXRpb24gPj0gZmVhdHVyZXMubGVuZ3RoKSB7XG4gICAgICAgIHBvc2l0aW9uIC09IGZlYXR1cmVzLmxlbmd0aDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgICB0aGlzLmZlYXR1cmUgPSBzb3VyY2UuZmVhdHVyZXNbcG9zaXRpb25dO1xuICAgICAgICBoYXNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHNldEhpZ2hsaWdodCkge1xuICAgICAgdGhpcy5oaWdobGlnaHRDdXJyZW50RmVhdHVyZV8obGFzdEZlYXR1cmUgfHwgdW5kZWZpbmVkKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gaGFzQ2hhbmdlZDtcbn07XG5cblF1ZXJ5V2luZG93Q29udHJvbGxlci5wcm90b3R5cGUucHJldmlvdXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBwb3NpdGlvbiA9IHRoaXMuY3VycmVudFJlc3VsdCAtIDE7XG5cbiAgaWYgKHBvc2l0aW9uIDwgMCkge1xuICAgIHBvc2l0aW9uID0gdGhpcy5nZXRSZXN1bHRMZW5ndGgoKSAtIDE7XG4gIH1cblxuICB2YXIgaGFzQ2hhbmdlZCA9IHRoaXMuc2V0Q3VycmVudFJlc3VsdF8ocG9zaXRpb24sIHRydWUpO1xuXG4gIGlmIChoYXNDaGFuZ2VkKSB7XG4gICAgdGhpcy5hbmltYXRlXyhmYWxzZSk7XG4gIH1cbn07XG5cblF1ZXJ5V2luZG93Q29udHJvbGxlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHBvc2l0aW9uID0gdGhpcy5jdXJyZW50UmVzdWx0ICsgMTtcbiAgdmFyIHBvc2l0aW9uTWF4ID0gdGhpcy5nZXRSZXN1bHRMZW5ndGgoKSAtIDE7XG5cbiAgaWYgKHBvc2l0aW9uID4gcG9zaXRpb25NYXgpIHtcbiAgICBwb3NpdGlvbiA9IDA7XG4gIH1cblxuICB2YXIgaGFzQ2hhbmdlZCA9IHRoaXMuc2V0Q3VycmVudFJlc3VsdF8ocG9zaXRpb24sIHRydWUpO1xuXG4gIGlmIChoYXNDaGFuZ2VkKSB7XG4gICAgdGhpcy5hbmltYXRlXyh0cnVlKTtcbiAgfVxufTtcblxuUXVlcnlXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS51cGRhdGVRdWVyeVJlc3VsdF8gPSBmdW5jdGlvbiAocXVlcnlSZXN1bHQpIHtcbiAgdGhpcy5uZ2VvUXVlcnlSZXN1bHQudG90YWwgPSAwO1xuICB0aGlzLm5nZW9RdWVyeVJlc3VsdC5zb3VyY2VzLmxlbmd0aCA9IDA7XG5cbiAgZm9yICh2YXIgX2l0ZXJhdG9yID0gcXVlcnlSZXN1bHQuc291cmNlcywgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvciksIF9pID0gMCwgX2l0ZXJhdG9yID0gX2lzQXJyYXkgPyBfaXRlcmF0b3IgOiBfaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICB2YXIgX3JlZjtcblxuICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgaWYgKF9pID49IF9pdGVyYXRvci5sZW5ndGgpIGJyZWFrO1xuICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICB9IGVsc2Uge1xuICAgICAgX2kgPSBfaXRlcmF0b3IubmV4dCgpO1xuICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgIH1cblxuICAgIHZhciBzb3VyY2UgPSBfcmVmO1xuICAgIHNvdXJjZS5mZWF0dXJlcyA9IHNvdXJjZS5mZWF0dXJlcy5maWx0ZXIoZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgIGlmICghZmVhdHVyZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZScpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gIWlzRW1wdHkoZ2V0RmlsdGVyZWRGZWF0dXJlVmFsdWVzKGZlYXR1cmUpKTtcbiAgICB9KTtcbiAgICB0aGlzLm5nZW9RdWVyeVJlc3VsdC5zb3VyY2VzLnB1c2goc291cmNlKTtcbiAgICB0aGlzLm5nZW9RdWVyeVJlc3VsdC50b3RhbCArPSBzb3VyY2UuZmVhdHVyZXMubGVuZ3RoO1xuICB9XG59O1xuXG5RdWVyeVdpbmRvd0NvbnRyb2xsZXIucHJvdG90eXBlLmdldFJlc3VsdExlbmd0aCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuc2VsZWN0ZWRTb3VyY2UgPT09IG51bGwpIHtcbiAgICByZXR1cm4gdGhpcy5uZ2VvUXVlcnlSZXN1bHQudG90YWw7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRTb3VyY2UuZmVhdHVyZXMubGVuZ3RoO1xuICB9XG59O1xuXG5RdWVyeVdpbmRvd0NvbnRyb2xsZXIucHJvdG90eXBlLmlzRmlyc3QgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmN1cnJlbnRSZXN1bHQgPT0gMDtcbn07XG5cblF1ZXJ5V2luZG93Q29udHJvbGxlci5wcm90b3R5cGUuaXNMYXN0ID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5jdXJyZW50UmVzdWx0ID09IHRoaXMuZ2V0UmVzdWx0TGVuZ3RoKCkgLSAxO1xufTtcblxuUXVlcnlXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS5nZXRGZWF0dXJlVmFsdWVzID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMuZmVhdHVyZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGdldEZpbHRlcmVkRmVhdHVyZVZhbHVlcyh0aGlzLmZlYXR1cmUpO1xufTtcblxuUXVlcnlXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS5hbmltYXRlXyA9IGZ1bmN0aW9uIChpc05leHQpIHtcbiAgdGhpcy5pc05leHQgPSBpc05leHQ7XG4gIHRoaXMuYW5pbWF0ZSsrO1xufTtcblxuUXVlcnlXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS5jb2xsZWN0RmVhdHVyZXNfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgc291cmNlcyA9IHRoaXMubmdlb1F1ZXJ5UmVzdWx0LnNvdXJjZXM7XG4gIHRoaXMuZmVhdHVyZXNfLmNsZWFyKCk7XG5cbiAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IHNvdXJjZXMsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgIHZhciBfcmVmMjtcblxuICAgIGlmIChfaXNBcnJheTIpIHtcbiAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgX3JlZjIgPSBfaXRlcmF0b3IyW19pMisrXTtcbiAgICB9IGVsc2Uge1xuICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICBpZiAoX2kyLmRvbmUpIGJyZWFrO1xuICAgICAgX3JlZjIgPSBfaTIudmFsdWU7XG4gICAgfVxuXG4gICAgdmFyIHNvdXJjZSA9IF9yZWYyO1xuXG4gICAgaWYgKHRoaXMuc2VsZWN0ZWRTb3VyY2UgIT09IG51bGwgJiYgdGhpcy5zZWxlY3RlZFNvdXJjZSAhPT0gc291cmNlKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICB2YXIgZmVhdHVyZXMgPSBzb3VyY2UuZmVhdHVyZXM7XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IzID0gZmVhdHVyZXMsIF9pc0FycmF5MyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMyksIF9pMyA9IDAsIF9pdGVyYXRvcjMgPSBfaXNBcnJheTMgPyBfaXRlcmF0b3IzIDogX2l0ZXJhdG9yM1tTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYzO1xuXG4gICAgICBpZiAoX2lzQXJyYXkzKSB7XG4gICAgICAgIGlmIChfaTMgPj0gX2l0ZXJhdG9yMy5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmMyA9IF9pdGVyYXRvcjNbX2kzKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kzID0gX2l0ZXJhdG9yMy5uZXh0KCk7XG4gICAgICAgIGlmIChfaTMuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYzID0gX2kzLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZmVhdHVyZSA9IF9yZWYzO1xuICAgICAgdGhpcy5mZWF0dXJlc18ucHVzaChmZWF0dXJlKTtcbiAgICB9XG4gIH1cbn07XG5cblF1ZXJ5V2luZG93Q29udHJvbGxlci5wcm90b3R5cGUuaGlnaGxpZ2h0Q3VycmVudEZlYXR1cmVfID0gZnVuY3Rpb24gKG9wdF9sYXN0RmVhdHVyZSkge1xuICBpZiAoIXRoaXMuZmVhdHVyZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlJyk7XG4gIH1cblxuICB0aGlzLmhpZ2hsaWdodEZlYXR1cmVzXy5jbGVhcigpO1xuICB0aGlzLmZlYXR1cmVzXy5yZW1vdmUodGhpcy5mZWF0dXJlKTtcbiAgdGhpcy5oaWdobGlnaHRGZWF0dXJlc18ucHVzaCh0aGlzLmZlYXR1cmUpO1xuXG4gIGlmIChvcHRfbGFzdEZlYXR1cmUgIT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuZmVhdHVyZXNfLnB1c2gob3B0X2xhc3RGZWF0dXJlKTtcbiAgfVxufTtcblxuUXVlcnlXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5vcGVuID0gZmFsc2U7XG4gIHRoaXMuY2xlYXIoKTtcbiAgdGhpcy5uZ2VvTWFwUXVlcmVudF8uY2xlYXIoKTtcbn07XG5cblF1ZXJ5V2luZG93Q29udHJvbGxlci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuZmVhdHVyZSA9IG51bGw7XG4gIHRoaXMuc291cmNlID0gbnVsbDtcbiAgdGhpcy5jdXJyZW50UmVzdWx0ID0gLTE7XG4gIHRoaXMuZmVhdHVyZXNfLmNsZWFyKCk7XG4gIHRoaXMuaGlnaGxpZ2h0RmVhdHVyZXNfLmNsZWFyKCk7XG4gIHRoaXMuc2VsZWN0ZWRTb3VyY2UgPSBudWxsO1xufTtcblxuUXVlcnlXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS5zZXRTZWxlY3RlZFNvdXJjZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgaWYgKHNvdXJjZSAhPT0gbnVsbCAmJiBzb3VyY2UuZmVhdHVyZXMubGVuZ3RoIDw9IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLmNsZWFyKCk7XG4gIHRoaXMuc2VsZWN0ZWRTb3VyY2UgPSBzb3VyY2U7XG4gIHRoaXMudXBkYXRlRmVhdHVyZXNfKCk7XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignR21mRGlzcGxheXF1ZXJ5d2luZG93Q29udHJvbGxlcicsIFF1ZXJ5V2luZG93Q29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiUmFzdGVyU2VydmljZS4kaW5qZWN0ID0gW1wiJGh0dHBcIiwgXCJnbWZSYXN0ZXJVcmxcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmV4cG9ydCBmdW5jdGlvbiBSYXN0ZXJTZXJ2aWNlKCRodHRwLCBnbWZSYXN0ZXJVcmwpIHtcbiAgdGhpcy4kaHR0cF8gPSAkaHR0cDtcbiAgdGhpcy51cmxfID0gZ21mUmFzdGVyVXJsO1xufVxudmFyIFBhcmFtID0ge1xuICBYOiAnbG9uJyxcbiAgWTogJ2xhdCdcbn07XG5cblJhc3RlclNlcnZpY2UucHJvdG90eXBlLmdldFJhc3RlciA9IGZ1bmN0aW9uIChjb29yZGluYXRlLCBvcHRfcGFyYW1zKSB7XG4gIHZhciBwYXJhbXMgPSBvcHRfcGFyYW1zIHx8IHt9O1xuICBwYXJhbXNbUGFyYW0uWF0gPSBjb29yZGluYXRlWzBdO1xuICBwYXJhbXNbUGFyYW0uWV0gPSBjb29yZGluYXRlWzFdO1xuICByZXR1cm4gdGhpcy4kaHR0cF8uZ2V0KHRoaXMudXJsXywge1xuICAgIHBhcmFtczogcGFyYW1zXG4gIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcbiAgICByZXR1cm4gcmVzcC5kYXRhO1xuICB9KTtcbn07XG5cblJhc3RlclNlcnZpY2UucHJvdG90eXBlLmhhbmRsZUdldFJhc3Rlcl8gPSBmdW5jdGlvbiAocmVzcCkge1xuICByZXR1cm4gcmVzcC5kYXRhO1xufTtcblxudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZSYXN0ZXInLCBbXSk7XG5tb2R1bGUuc2VydmljZSgnZ21mUmFzdGVyJywgUmFzdGVyU2VydmljZSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGZpbHRlclwiLCBcIm5nZW9EZWJvdW5jZVwiLCBcImdtZlJhc3RlclwiLCBcImdldHRleHRDYXRhbG9nXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mUmFzdGVyUmFzdGVyU2VydmljZSBmcm9tICdnbWYvcmFzdGVyL1Jhc3RlclNlcnZpY2UuanMnO1xuaW1wb3J0IG5nZW9NaXNjRGVib3VuY2UgZnJvbSAnbmdlby9taXNjL2RlYm91bmNlLmpzJztcbmltcG9ydCB7IGxpc3RlbiwgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgTWFwQnJvd3NlckV2ZW50IGZyb20gJ29sL01hcEJyb3dzZXJFdmVudC5qcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvZHJvcGRvd24uanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZSYXN0ZXJDb21wb25lbnQnLCBbZ21mUmFzdGVyUmFzdGVyU2VydmljZS5uYW1lLCBuZ2VvTWlzY0RlYm91bmNlLm5hbWVdKTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZ21mL3Jhc3Rlci93aWRnZXRDb21wb25lbnQnLCByZXF1aXJlKCcuL3dpZGdldENvbXBvbmVudC5odG1sJykpO1xufV0pO1xubW9kdWxlLnZhbHVlKCdnbWZFbGV2YXRpb253aWRnZXRUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uICgkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzLmdtZkVsZXZhdGlvbndpZGdldFRlbXBsYXRlVXJsO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ2dtZi9yYXN0ZXIvd2lkZ2V0Q29tcG9uZW50Jztcbn0pO1xuZ21mRWxldmF0aW9ud2lkZ2V0VGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRhdHRyc1wiLCBcImdtZkVsZXZhdGlvbndpZGdldFRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBnbWZFbGV2YXRpb253aWRnZXRUZW1wbGF0ZVVybCgkYXR0cnMsIGdtZkVsZXZhdGlvbndpZGdldFRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBnbWZFbGV2YXRpb253aWRnZXRUZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG5mdW5jdGlvbiByYXN0ZXJDb21wb25lbnQoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBjb250cm9sbGVyOiAnR21mRWxldmF0aW9uQ29udHJvbGxlciBhcyBjdHJsJyxcbiAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgIHNjb3BlOiB7XG4gICAgICAnYWN0aXZlJzogJzxnbWZFbGV2YXRpb25BY3RpdmUnLFxuICAgICAgJ2VsZXZhdGlvbic6ICc9Z21mRWxldmF0aW9uRWxldmF0aW9uJyxcbiAgICAgICdsYXllcnNjb25maWcnOiAnPWdtZkVsZXZhdGlvbkxheWVyc2NvbmZpZycsXG4gICAgICAnbG9hZGluZyc6ICc9P2dtZkVsZXZhdGlvbkxvYWRpbmcnLFxuICAgICAgJ2xheWVyJzogJzxnbWZFbGV2YXRpb25MYXllcicsXG4gICAgICAnbWFwJzogJz1nbWZFbGV2YXRpb25NYXAnXG4gICAgfSxcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgICB2YXIgY3RybCA9IHNjb3BlLmN0cmw7XG4gICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gY3RybC5hY3RpdmU7XG4gICAgICB9LCBmdW5jdGlvbiAoYWN0aXZlKSB7XG4gICAgICAgIGN0cmwudG9nZ2xlQWN0aXZlXyhhY3RpdmUpO1xuICAgICAgfSk7XG4gICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gY3RybC5sYXllcjtcbiAgICAgIH0sIGZ1bmN0aW9uIChsYXllcikge1xuICAgICAgICBjdHJsLmxheWVyID0gbGF5ZXI7XG4gICAgICAgIGN0cmwuZWxldmF0aW9uID0gbnVsbDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnZ21mRWxldmF0aW9uJywgcmFzdGVyQ29tcG9uZW50KTtcblxuZnVuY3Rpb24gQ29udHJvbGxlcigkc2NvcGUsICRmaWx0ZXIsIG5nZW9EZWJvdW5jZSwgZ21mUmFzdGVyLCBnZXR0ZXh0Q2F0YWxvZykge1xuICB0aGlzLmZpbHRlcl8gPSAkZmlsdGVyO1xuICB0aGlzLm5nZW9EZWJvdW5jZV8gPSBuZ2VvRGVib3VuY2U7XG4gIHRoaXMuZ21mUmFzdGVyXyA9IGdtZlJhc3RlcjtcbiAgdGhpcy5nZXR0ZXh0Q2F0YWxvZyA9IGdldHRleHRDYXRhbG9nO1xuICB0aGlzLmxheWVyc2NvbmZpZyA9IHt9O1xuICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLmVsZXZhdGlvbiA9IG51bGw7XG4gIHRoaXMubGF5ZXIgPSAnJztcbiAgdGhpcy5tYXAgPSBudWxsO1xuICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgdGhpcy5zY29wZV8gPSAkc2NvcGU7XG4gIHRoaXMuaW5WaWV3cG9ydF8gPSBmYWxzZTtcbiAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG59XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnRvZ2dsZUFjdGl2ZV8gPSBmdW5jdGlvbiAoYWN0aXZlKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgdGhpcy5lbGV2YXRpb24gPSBudWxsO1xuXG4gIGlmIChhY3RpdmUpIHtcbiAgICBpZiAodGhpcy5saXN0ZW5lcktleXNfLmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmV4cGV4dGVkIGxpc3RlbmVyS2V5cycpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICB2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbiBsaXN0ZW5lcihldmVudCkge1xuICAgICAgX3RoaXMuc2NvcGVfLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzLmluVmlld3BvcnRfID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMuZWxldmF0aW9uID0gbnVsbDtcbiAgICAgICAgX3RoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMubGlzdGVuZXJLZXlzXy5wdXNoKGxpc3Rlbih0aGlzLm1hcCwgJ3BvaW50ZXJtb3ZlJywgbGlzdGVuZXIpKTtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18ucHVzaChsaXN0ZW4odGhpcy5tYXAsICdwb2ludGVybW92ZScsIHRoaXMubmdlb0RlYm91bmNlXyhmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKF90aGlzLmluVmlld3BvcnRfICYmIGUgaW5zdGFuY2VvZiBNYXBCcm93c2VyRXZlbnQpIHtcbiAgICAgICAgX3RoaXMubG9hZGluZyA9IHRydWU7XG4gICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgJ2xheWVycyc6IF90aGlzLmxheWVyXG4gICAgICAgIH07XG5cbiAgICAgICAgX3RoaXMuZ21mUmFzdGVyXy5nZXRSYXN0ZXIoZS5jb29yZGluYXRlLCBwYXJhbXMpLnRoZW4oX3RoaXMuZ2V0UmFzdGVyU3VjY2Vzc18uYmluZChfdGhpcyksIF90aGlzLmdldFJhc3RlckVycm9yXy5iaW5kKF90aGlzKSk7XG4gICAgICB9XG4gICAgfSwgNTAwLCB0cnVlKSkpO1xuICAgIHRoaXMubGlzdGVuZXJLZXlzXy5wdXNoKGxpc3Rlbih0aGlzLm1hcC5nZXRWaWV3cG9ydCgpLCAnbW91c2VvdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5zY29wZV8uJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMuZWxldmF0aW9uID0gbnVsbDtcbiAgICAgICAgX3RoaXMuaW5WaWV3cG9ydF8gPSBmYWxzZTtcbiAgICAgICAgX3RoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfSkpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuZWxldmF0aW9uID0gbnVsbDtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18uZm9yRWFjaCh1bmxpc3RlbkJ5S2V5KTtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18ubGVuZ3RoID0gMDtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0UmFzdGVyU3VjY2Vzc18gPSBmdW5jdGlvbiAocmVzcCkge1xuICBpZiAodGhpcy5sYXllciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGxheWVyJyk7XG4gIH1cblxuICB2YXIgdmFsdWUgPSByZXNwW3RoaXMubGF5ZXJdO1xuXG4gIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLmxheWVyc2NvbmZpZ1t0aGlzLmxheWVyXSB8fCB7fTtcbiAgICB2YXIgZmlsdGVyID0gb3B0aW9ucy5maWx0ZXIgfHwgJ251bWJlcic7XG4gICAgdmFyIGN1c3RvbV9hcmdzID0gb3B0aW9ucy5hcmdzIHx8IFtdO1xuICAgIHZhciBwb3N0Zml4ID0gb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgncG9zdGZpeCcpID8gb3B0aW9ucy5wb3N0Zml4IDogJ20nO1xuICAgIHZhciBzZXBhcmF0b3IgPSBwb3N0Zml4Lmxlbmd0aCA+IDAgPyBvcHRpb25zLmhhc093blByb3BlcnR5KCdzZXBhcmF0b3InKSA/IG9wdGlvbnMuc2VwYXJhdG9yIDogXCJcXHhBMFwiIDogJyc7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuY29uY2F0KFt2YWx1ZV0sIGN1c3RvbV9hcmdzKTtcbiAgICB2YXIgZWxldmF0aW9uID0gdGhpcy5maWx0ZXJfKGZpbHRlcikuYXBwbHkodm9pZCAwLCBhcmdzKTtcblxuICAgIGlmICh0eXBlb2YgZWxldmF0aW9uICE9ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGVsZXZhdGlvbiB0eXBlJyk7XG4gICAgfVxuXG4gICAgdGhpcy5lbGV2YXRpb24gPSBlbGV2YXRpb24gKyBzZXBhcmF0b3IgKyBwb3N0Zml4O1xuICB9IGVsc2Uge1xuICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2c7XG4gICAgdGhpcy5lbGV2YXRpb24gPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ05vIHZhbHVlJyk7XG4gIH1cblxuICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmdldFJhc3RlckVycm9yXyA9IGZ1bmN0aW9uICgpIHtcbiAgY29uc29sZS5lcnJvcignRXJyb3Igb24gZ2V0dGluZyB0aGUgcmFzdGVyLicpO1xuICB0aGlzLmVsZXZhdGlvbiA9IG51bGw7XG4gIHRoaXMubG9hZGluZyA9IGZhbHNlO1xufTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ0dtZkVsZXZhdGlvbkNvbnRyb2xsZXInLCBDb250cm9sbGVyKTtcbnZhciByYXN0ZXJXaWRnZXRDb21wb25lbnQgPSB7XG4gIGNvbnRyb2xsZXI6ICdnbWZFbGV2YXRpb253aWRnZXRDb250cm9sbGVyIGFzIGN0cmwnLFxuICBiaW5kaW5nczoge1xuICAgICdtYXAnOiAnPGdtZkVsZXZhdGlvbndpZGdldE1hcCcsXG4gICAgJ2xheWVycyc6ICc8Z21mRWxldmF0aW9ud2lkZ2V0TGF5ZXJzJyxcbiAgICAnbGF5ZXJzY29uZmlnJzogJz1nbWZFbGV2YXRpb253aWRnZXRMYXllcnNjb25maWcnLFxuICAgICdhY3RpdmUnOiAnPGdtZkVsZXZhdGlvbndpZGdldEFjdGl2ZSdcbiAgfSxcbiAgdGVtcGxhdGVVcmw6IGdtZkVsZXZhdGlvbndpZGdldFRlbXBsYXRlVXJsXG59O1xubW9kdWxlLmNvbXBvbmVudCgnZ21mRWxldmF0aW9ud2lkZ2V0JywgcmFzdGVyV2lkZ2V0Q29tcG9uZW50KTtcblxuZnVuY3Rpb24gV2lkZ2V0Q29udHJvbGxlcigpIHtcbiAgdGhpcy5tYXAgPSBudWxsO1xuICB0aGlzLmxheWVycyA9IFtdO1xuICB0aGlzLmxheWVyc2NvbmZpZyA9IHt9O1xuICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLnNlbGVjdGVkRWxldmF0aW9uTGF5ZXIgPSAnJztcbn1cblxuV2lkZ2V0Q29udHJvbGxlci5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5zZWxlY3RlZEVsZXZhdGlvbkxheWVyID0gdGhpcy5sYXllcnNbMF07XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignZ21mRWxldmF0aW9ud2lkZ2V0Q29udHJvbGxlcicsIFdpZGdldENvbnRyb2xsZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXYgY2xhc3M9XCJ0ZXh0LWNlbnRlciBidG4tZ3JvdXAgZHJvcHVwXCJcXG4gICAgZ21mLWVsZXZhdGlvblxcbiAgICBnbWYtZWxldmF0aW9uLWFjdGl2ZT1cImN0cmwuYWN0aXZlXCJcXG4gICAgZ21mLWVsZXZhdGlvbi1lbGV2YXRpb249XCJjdHJsLmVsZXZhdGlvblZhbHVlXCJcXG4gICAgZ21mLWVsZXZhdGlvbi1sb2FkaW5nPVwiY3RybC5lbGV2YXRpb25Mb2FkaW5nXCJcXG4gICAgZ21mLWVsZXZhdGlvbi1sYXllcj1cImN0cmwuc2VsZWN0ZWRFbGV2YXRpb25MYXllclwiXFxuICAgIGdtZi1lbGV2YXRpb24tbGF5ZXJzY29uZmlnPVwiY3RybC5sYXllcnNjb25maWdcIlxcbiAgICBnbWYtZWxldmF0aW9uLW1hcD1cIjo6Y3RybC5tYXBcIj5cXG4gIDxhIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0XCIgYXJpYS1leHBhbmRlZD1cImZhbHNlXCJcXG4gICAgbmctY2xhc3M9XCI6OntcXCdkcm9wZG93bi10b2dnbGVcXCc6IGN0cmwubGF5ZXJzLmxlbmd0aCA+IDF9XCJcXG4gICAgbmctYXR0ci1kYXRhLXRvZ2dsZT1cInt7OjooY3RybC5sYXllcnMubGVuZ3RoID4gMSkgPyBcXCdkcm9wZG93blxcJyA6IFxcJ1xcJ319XCJcXG4gICAgPlxcbiAgICA8c3BhbiBjbGFzcz1cImdtZi1lbGV2YXRpb253aWRnZXQtdmFsdWVcIj5cXG4gICAgICB7e2N0cmwuZWxldmF0aW9uVmFsdWV9fVxcbiAgICAgIDxzcGFuIG5nLXNob3c9XCJjdHJsLmVsZXZhdGlvbkxvYWRpbmdcIiBjbGFzcz1cImZhIGZhLXNwaW5uZXJcIj48L3NwYW4+XFxuICAgICAgPHNwYW4gbmctc2hvdz1cIiFjdHJsLmVsZXZhdGlvblZhbHVlICYmICFjdHJsLmVsZXZhdGlvbkxvYWRpbmdcIiB0cmFuc2xhdGU+RWxldmF0aW9u4oCmPC9zcGFuPlxcbiAgICA8L3NwYW4+PHNwYW4gY2xhc3M9XCJjYXJldFwiIG5nLWlmPVwiOjpjdHJsLmxheWVycy5sZW5ndGggPiAxXCI+PC9zcGFuPlxcbiAgPC9hPlxcbiAgPHVsIGNsYXNzPVwiZHJvcGRvd24tbWVudSBkcm9wZG93bi1tZW51LXJpZ2h0XCIgcm9sZT1cIm1lbnVcIlxcbiAgICAgIG5nLWlmPVwiOjpjdHJsLmxheWVycy5sZW5ndGggPiAxXCI+XFxuICAgIDxsaSBjbGFzcz1cImRyb3Bkb3duLWhlYWRlclwiIHRyYW5zbGF0ZT5FbGV2YXRpb24gZGF0YSBzb3VyY2VzPC9saT5cXG4gICAgPGxpIG5nLXJlcGVhdD1cImVsZXZhdGlvbkl0ZW0gaW4gOjpjdHJsLmxheWVyc1wiPlxcbiAgICAgIDxhIGhyZWYgbmctY2xpY2s9XCJjdHJsLnNlbGVjdGVkRWxldmF0aW9uTGF5ZXIgPSBlbGV2YXRpb25JdGVtXCI+XFxuICAgICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLWZ3XCIgbmctY2xhc3M9XCJ7XFwnZmEtY2hlY2tcXCc6IGN0cmwuc2VsZWN0ZWRFbGV2YXRpb25MYXllciA9PT0gZWxldmF0aW9uSXRlbX1cIj48L3NwYW4+XFxuICAgICAgICB7e2VsZXZhdGlvbkl0ZW0gfCB0cmFuc2xhdGV9fVxcbiAgICAgIDwvYT5cXG4gICAgPC9saT5cXG4gIDwvdWw+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsIkZ1bGx0ZXh0U2VhcmNoU2VydmljZS4kaW5qZWN0ID0gW1wiJGluamVjdG9yXCIsIFwiJGh0dHBcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IGVuY29kZVF1ZXJ5U3RyaW5nLCBkZWNvZGVRdWVyeVN0cmluZyB9IGZyb20gJ25nZW8vdXRpbHMuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIEZ1bGx0ZXh0U2VhcmNoU2VydmljZSgkaW5qZWN0b3IsICRodHRwKSB7XG4gIHRoaXMuJGh0dHBfID0gJGh0dHA7XG4gIHRoaXMudXJsXyA9ICRpbmplY3Rvci5nZXQoJ2Z1bGx0ZXh0c2VhcmNoVXJsJyk7XG4gIHZhciB1cmwgPSB0aGlzLnVybF8uc3BsaXQoJz8nKTtcbiAgdGhpcy5iYXNlVXJsXyA9IHVybFswXTtcbiAgdmFyIHF1ZXJ5U3RyaW5nID0gdXJsLmxlbmd0aCA9PSAyID8gXCI/XCIgKyB1cmxbMV0gOiAnJztcbiAgdGhpcy5kZWZhdWx0UGFyYW1zXyA9IGRlY29kZVF1ZXJ5U3RyaW5nKHF1ZXJ5U3RyaW5nKTtcbn1cblxuRnVsbHRleHRTZWFyY2hTZXJ2aWNlLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbiAocXVlcnksIHBhcmFtcykge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHZhciBxdWVyeVBhcmFtcyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdFBhcmFtc18sIHBhcmFtcyk7XG4gIHF1ZXJ5UGFyYW1zWydxdWVyeSddID0gcXVlcnk7XG4gIHZhciB1cmwgPSB0aGlzLmJhc2VVcmxfICsgXCI/XCIgKyBlbmNvZGVRdWVyeVN0cmluZyhxdWVyeVBhcmFtcyk7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgX3RoaXMuJGh0dHBfLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcbiAgICAgIHJldHVybiByZXNvbHZlKHJlc3BbJ2RhdGEnXSk7XG4gICAgfSkuY2F0Y2gocmVqZWN0KTtcbiAgfSk7XG59O1xuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2dtZlNlYXJjaEZ1bGx0ZXh0U2VhcmNoJywgW10pO1xubW9kdWxlLnNlcnZpY2UoJ2dtZlNlYXJjaEZ1bGx0ZXh0U2VhcmNoJywgRnVsbHRleHRTZWFyY2hTZXJ2aWNlKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaikge1xub2JqIHx8IChvYmogPSB7fSk7XG52YXIgX190LCBfX3AgPSAnJztcbndpdGggKG9iaikge1xuX19wICs9ICc8ZGl2IGNsYXNzPVwiZ21mLXNlYXJjaFwiPlxcbiAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctYXR0ci1wbGFjZWhvbGRlcj1cInt7JGN0cmwucGxhY2Vob2xkZXJ8dHJhbnNsYXRlfX1cIlxcbiAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgIG5nLW1vZGVsPVwiJGN0cmwuaW5wdXRWYWx1ZVwiXFxuICAgIG5nZW8tc2VhcmNoPVwiJGN0cmwub3B0aW9uc1wiXFxuICAgIG5nZW8tc2VhcmNoLWRhdGFzZXRzPVwiJGN0cmwuZGF0YXNldHNcIlxcbiAgICBuZ2VvLXNlYXJjaC1saXN0ZW5lcnM9XCIkY3RybC5saXN0ZW5lcnNcIj5cXG4gIDxzcGFuIGNsYXNzPVwiZ21mLWNsZWFyLWJ1dHRvbiBuZy1oaWRlXCJcXG4gICAgbmctaGlkZT1cIiEkY3RybC5jbGVhckJ1dHRvbiB8fCAkY3RybC5pbnB1dFZhbHVlID09IFxcJ1xcJ1wiXFxuICAgIG5nLWNsaWNrPVwiJGN0cmwub25DbGVhckJ1dHRvbigpXCI+XFxuICA8L3NwYW4+XFxuPC9kaXY+XFxuPHNwYW4gbmctaWY9XCIkY3RybC5jb2xvckNob29zZXJcIj5cXG4gIDxzcGFuIG5nLXNob3c9XCIkY3RybC5kaXNwbGF5Q29sb3JQaWNrZXJcIiBuZ2VvLXBvcG92ZXIgbmdlby1wb3BvdmVyLXBsYWNlbWVudD1cImJvdHRvbVwiPlxcbiAgICA8YnV0dG9uIGNsYXNzPVwiZ21mLWNvbG9yLWJ1dHRvbiBmYSBmYS10aW50XCIgbmdlby1wb3BvdmVyLWFuY2hvclxcbiAgICAgICAgICAgIGRhdGEtb3JpZ2luYWwtdGl0bGU9XCJ7e1xcJ0NoYW5nZSB0aGUgY29sb3Igb2YgdGhlIHNlYXJjaCByZXN1bHRcXCd8dHJhbnNsYXRlfX1cIj48L2J1dHRvbj5cXG4gICAgPGRpdiBuZ2VvLXBvcG92ZXItY29udGVudD5cXG4gICAgICA8ZGl2IG5nZW8tY29sb3JwaWNrZXIgbmdlby1jb2xvcnBpY2tlci1jb2xvcj1cIiRjdHJsLmNvbG9yXCI+PC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9zcGFuPlxcbjwvc3Bhbj5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBDT09SRElOQVRFU19MQVlFUl9OQU1FIH0gZnJvbSAnZ21mL2luZGV4LmpzJztcbmltcG9ydCBnbWZMYXllcnRyZWVUcmVlTWFuYWdlciBmcm9tICdnbWYvbGF5ZXJ0cmVlL1RyZWVNYW5hZ2VyLmpzJztcbmltcG9ydCBnbWZTZWFyY2hGdWxsdGV4dFNlYXJjaCBmcm9tICdnbWYvc2VhcmNoL0Z1bGx0ZXh0U2VhcmNoLmpzJztcbmltcG9ydCBnbWZUaGVtZVRoZW1lcywgeyBmaW5kVGhlbWVCeU5hbWUgfSBmcm9tICdnbWYvdGhlbWUvVGhlbWVzLmpzJztcbmltcG9ydCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXlNZ3IgZnJvbSAnbmdlby9tYXAvRmVhdHVyZU92ZXJsYXlNZ3IuanMnO1xuaW1wb3J0IG5nZW9NaXNjQXV0b1Byb2plY3Rpb24gZnJvbSAnbmdlby9taXNjL0F1dG9Qcm9qZWN0aW9uLmpzJztcbmltcG9ydCBuZ2VvTWlzY0NvbG9ycGlja2VyQ29tcG9uZW50IGZyb20gJ25nZW8vbWlzYy9jb2xvcnBpY2tlckNvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb01lc3NhZ2VQb3BvdmVyQ29tcG9uZW50IGZyb20gJ25nZW8vbWVzc2FnZS9wb3BvdmVyQ29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvU2VhcmNoTW9kdWxlIGZyb20gJ25nZW8vc2VhcmNoL21vZHVsZS5qcyc7XG5pbXBvcnQgb2xGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuaW1wb3J0IHsgYXNBcnJheSBhcyBhc0NvbG9yQXJyYXkgfSBmcm9tICdvbC9jb2xvci5qcyc7XG5pbXBvcnQgb2xHZW9tUG9pbnQgZnJvbSAnb2wvZ2VvbS9Qb2ludC5qcyc7XG5pbXBvcnQgb2xGb3JtYXRHZW9KU09OIGZyb20gJ29sL2Zvcm1hdC9HZW9KU09OLmpzJztcbmltcG9ydCAqIGFzIG9sUHJvaiBmcm9tICdvbC9wcm9qLmpzJztcbmltcG9ydCBvbFN0eWxlQ2lyY2xlIGZyb20gJ29sL3N0eWxlL0NpcmNsZS5qcyc7XG5pbXBvcnQgb2xTdHlsZUZpbGwgZnJvbSAnb2wvc3R5bGUvRmlsbC5qcyc7XG5pbXBvcnQgb2xTdHlsZVJlZ3VsYXJTaGFwZSBmcm9tICdvbC9zdHlsZS9SZWd1bGFyU2hhcGUuanMnO1xuaW1wb3J0IG9sU3R5bGVTdHJva2UgZnJvbSAnb2wvc3R5bGUvU3Ryb2tlLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xuaW1wb3J0IHsgYXBwZW5kUGFyYW1zIGFzIG9sVXJpQXBwZW5kUGFyYW1zIH0gZnJvbSAnb2wvdXJpLmpzJztcbmltcG9ydCBTaW1wbGVHZW9tZXRyeSBmcm9tICdvbC9nZW9tL1NpbXBsZUdlb21ldHJ5LmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnZ21mU2VhcmNoJywgW2dtZkxheWVydHJlZVRyZWVNYW5hZ2VyLm5hbWUsIGdtZlNlYXJjaEZ1bGx0ZXh0U2VhcmNoLm5hbWUsIGdtZlRoZW1lVGhlbWVzLm5hbWUsIG5nZW9NaXNjQXV0b1Byb2plY3Rpb24ubmFtZSwgbmdlb01pc2NDb2xvcnBpY2tlckNvbXBvbmVudC5uYW1lLCBuZ2VvU2VhcmNoTW9kdWxlLm5hbWUsIG5nZW9NYXBGZWF0dXJlT3ZlcmxheU1nci5uYW1lLCBuZ2VvTWVzc2FnZVBvcG92ZXJDb21wb25lbnQubmFtZV0pO1xuXG5mdW5jdGlvbiBnbWZTZWFyY2hUZW1wbGF0ZVVybF8oZWxlbWVudCwgYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gYXR0cnMuZ21mU2VhcmNoVGVtcGxhdGV1cmw7XG4gIHJldHVybiB0ZW1wbGF0ZVVybCAhPT0gdW5kZWZpbmVkID8gdGVtcGxhdGVVcmwgOiAnZ21mL3NlYXJjaCc7XG59XG5cbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZ21mL3NlYXJjaCcsIHJlcXVpcmUoJy4vY29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5nbWZTZWFyY2hUZW1wbGF0ZVVybC4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkYXR0cnNcIiwgXCJnbWZTZWFyY2hUZW1wbGF0ZVVybFwiXTtcblxuZnVuY3Rpb24gZ21mU2VhcmNoVGVtcGxhdGVVcmwoJGVsZW1lbnQsICRhdHRycywgZ21mU2VhcmNoVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIGdtZlNlYXJjaFRlbXBsYXRlVXJsKCRlbGVtZW50LCAkYXR0cnMpO1xufVxuXG52YXIgc2VhcmNoQ29tcG9uZW50ID0ge1xuICBiaW5kaW5nczoge1xuICAgICdpbnB1dFZhbHVlJzogJz0/Z21mU2VhcmNoSW5wdXRWYWx1ZScsXG4gICAgJ3BsYWNlaG9sZGVyJzogJ0A/Z21mU2VhcmNoUGxhY2Vob2xkZXInLFxuICAgICdtYXAnOiAnPGdtZlNlYXJjaE1hcCcsXG4gICAgJ2RhdGFzb3VyY2VzJzogJzxnbWZTZWFyY2hEYXRhc291cmNlcycsXG4gICAgJ3R5cGVhaGVhZE9wdGlvbnMnOiAnPD9nbWZTZWFyY2hPcHRpb25zJyxcbiAgICAnZmVhdHVyZXNTdHlsZXMnOiAnPD9nbWZTZWFyY2hTdHlsZXMnLFxuICAgICdjbGVhckJ1dHRvbic6ICc9P2dtZlNlYXJjaENsZWFyYnV0dG9uJyxcbiAgICAnY29sb3JDaG9vc2VyJzogJzw/Z21mU2VhcmNoQ29sb3JjaG9vc2VyJyxcbiAgICAnY29vcmRpbmF0ZXNQcm9qZWN0aW9ucyc6ICc8P2dtZlNlYXJjaENvb3JkaW5hdGVzcHJvamVjdGlvbnMnLFxuICAgICdhZGRpdGlvbmFsTGlzdGVuZXJzJzogJzxnbWZTZWFyY2hMaXN0ZW5lcnMnLFxuICAgICdtYXhab29tJzogJzw/Z21mU2VhcmNoTWF4em9vbScsXG4gICAgJ2RlbGF5JzogJzw/Z21mU2VhcmNoRGVsYXknLFxuICAgICdvbkluaXRDYWxsYmFjayc6ICc8P2dtZlNlYXJjaE9uSW5pdCdcbiAgfSxcbiAgY29udHJvbGxlcjogJ2dtZlNlYXJjaENvbnRyb2xsZXInLFxuICB0ZW1wbGF0ZVVybDogZ21mU2VhcmNoVGVtcGxhdGVVcmxcbn07XG5tb2R1bGUudmFsdWUoJ2dtZlNlYXJjaFRlbXBsYXRlVXJsJywgZ21mU2VhcmNoVGVtcGxhdGVVcmxfKTtcbm1vZHVsZS5jb21wb25lbnQoJ2dtZlNlYXJjaCcsIHNlYXJjaENvbXBvbmVudCk7XG5cbnZhciBTZWFyY2hDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICBTZWFyY2hDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkZWxlbWVudFwiLCBcIiRzY29wZVwiLCBcIiRjb21waWxlXCIsIFwiJHRpbWVvdXRcIiwgXCIkaW5qZWN0b3JcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIm5nZW9BdXRvUHJvamVjdGlvblwiLCBcIm5nZW9TZWFyY2hDcmVhdGVHZW9KU09OQmxvb2Rob3VuZFwiLCBcIm5nZW9GZWF0dXJlT3ZlcmxheU1nclwiLCBcImdtZlRoZW1lc1wiLCBcImdtZlRyZWVNYW5hZ2VyXCIsIFwiZ21mU2VhcmNoRnVsbHRleHRTZWFyY2hcIl07XG5cbiAgZnVuY3Rpb24gU2VhcmNoQ29udHJvbGxlcigkZWxlbWVudCwgJHNjb3BlLCAkY29tcGlsZSwgJHRpbWVvdXQsICRpbmplY3RvciwgZ2V0dGV4dENhdGFsb2csIG5nZW9BdXRvUHJvamVjdGlvbiwgbmdlb1NlYXJjaENyZWF0ZUdlb0pTT05CbG9vZGhvdW5kLCBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IsIGdtZlRoZW1lcywgZ21mVHJlZU1hbmFnZXIsIGdtZlNlYXJjaEZ1bGx0ZXh0U2VhcmNoKSB7XG4gICAgdGhpcy5lbGVtZW50XyA9ICRlbGVtZW50O1xuICAgIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICAgIHRoaXMuY29tcGlsZV8gPSAkY29tcGlsZTtcbiAgICB0aGlzLnRpbWVvdXRfID0gJHRpbWVvdXQ7XG4gICAgdGhpcy5nZXR0ZXh0Q2F0YWxvZ18gPSBnZXR0ZXh0Q2F0YWxvZztcbiAgICB0aGlzLmdtZlRoZW1lc18gPSBnbWZUaGVtZXM7XG4gICAgdGhpcy5nbWZUcmVlTWFuYWdlcl8gPSBnbWZUcmVlTWFuYWdlcjtcbiAgICB0aGlzLmZ1bGxUZXh0U2VhcmNoXyA9IGdtZlNlYXJjaEZ1bGx0ZXh0U2VhcmNoO1xuICAgIHRoaXMubmdlb1NlYXJjaENyZWF0ZUdlb0pTT05CbG9vZGhvdW5kXyA9IG5nZW9TZWFyY2hDcmVhdGVHZW9KU09OQmxvb2Rob3VuZDtcbiAgICB0aGlzLm5nZW9GZWF0dXJlT3ZlcmxheU1nciA9IG5nZW9GZWF0dXJlT3ZlcmxheU1ncjtcbiAgICB0aGlzLm5nZW9Mb2NhdGlvbl87XG5cbiAgICBpZiAoJGluamVjdG9yLmhhcygnbmdlb0xvY2F0aW9uJykpIHtcbiAgICAgIHRoaXMubmdlb0xvY2F0aW9uXyA9ICRpbmplY3Rvci5nZXQoJ25nZW9Mb2NhdGlvbicpO1xuICAgIH1cblxuICAgIHRoaXMubmdlb0F1dG9Qcm9qZWN0aW9uXyA9IG5nZW9BdXRvUHJvamVjdGlvbjtcbiAgICB0aGlzLm1hcCA9IG51bGw7XG4gICAgdGhpcy5zdHlsZXNfID0ge307XG4gICAgdGhpcy5vbkluaXRDYWxsYmFjayA9IG51bGw7XG4gICAgdGhpcy5jbGVhckJ1dHRvbiA9IGZhbHNlO1xuICAgIHRoaXMuY29sb3JDaG9vc2VyID0gZmFsc2U7XG4gICAgdGhpcy5wbGFjZWhvbGRlciA9ICcnO1xuICAgIHRoaXMuZGVsYXkgPSAwO1xuICAgIHRoaXMubWF4Wm9vbSA9IDE2O1xuICAgIHRoaXMuY29vcmRpbmF0ZXNQcm9qZWN0aW9ucyA9IFtdO1xuICAgIHRoaXMuY29vcmRpbmF0ZXNQcm9qZWN0aW9uc0luc3RhbmNlcyA9IFtdO1xuICAgIHRoaXMuZmVhdHVyZU92ZXJsYXlfID0gbmdlb0ZlYXR1cmVPdmVybGF5TWdyLmdldEZlYXR1cmVPdmVybGF5KCk7XG4gICAgdGhpcy5kYXRhc291cmNlcyA9IFtdO1xuICAgIHRoaXMudHlwZWFoZWFkT3B0aW9ucyA9IG51bGw7XG4gICAgdGhpcy5vcHRpb25zID0ge1xuICAgICAgaGlnaGxpZ2h0OiB0cnVlXG4gICAgfTtcbiAgICB0aGlzLmZlYXR1cmVzU3R5bGVzID0ge307XG4gICAgdGhpcy5kYXRhc2V0cyA9IFtdO1xuICAgIHRoaXMuaW5wdXRWYWx1ZSA9ICcnO1xuICAgIHRoaXMuY29sb3IgPSAnJztcbiAgICB0aGlzLmRpc3BsYXlDb2xvclBpY2tlciA9IGZhbHNlO1xuICAgIHRoaXMubGlzdGVuZXJzID0gbnVsbDtcbiAgICB0aGlzLmFkZGl0aW9uYWxMaXN0ZW5lcnMgPSB7fTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBTZWFyY2hDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uJG9uSW5pdCA9IGZ1bmN0aW9uICRvbkluaXQoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIGlmICghdGhpcy5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMubmdlb0xvY2F0aW9uXykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG5nZW9Mb2NhdGlvbicpO1xuICAgIH1cblxuICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICAgIHRoaXMuY2xlYXJCdXR0b24gPSB0aGlzLmNsZWFyQnV0dG9uICE9PSBmYWxzZTtcbiAgICB0aGlzLmNvbG9yQ2hvb3NlciA9IHRoaXMuY29sb3JDaG9vc2VyID09PSB0cnVlO1xuXG4gICAgaWYgKHRoaXMuZGVsYXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5kZWxheSA9IDUwO1xuICAgIH1cblxuICAgIHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLnBsYWNlaG9sZGVyICE9PSB1bmRlZmluZWQgPyB0aGlzLnBsYWNlaG9sZGVyIDogZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdTZWFyY2jigKYnKTtcbiAgICB0aGlzLmNvb3JkaW5hdGVzUHJvamVjdGlvbnNJbnN0YW5jZXMgPSB0aGlzLmNvb3JkaW5hdGVzUHJvamVjdGlvbnMgPT09IHVuZGVmaW5lZCA/IFt0aGlzLm1hcC5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpXSA6IHRoaXMubmdlb0F1dG9Qcm9qZWN0aW9uXy5nZXRQcm9qZWN0aW9uTGlzdCh0aGlzLmNvb3JkaW5hdGVzUHJvamVjdGlvbnMpO1xuXG4gICAgaWYgKCF0aGlzLmNsZWFyQnV0dG9uKSB7XG4gICAgICB0aGlzLmVsZW1lbnRfLmZpbmQoJ2lucHV0Jykub24oJ2ZvY3VzIGJsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzLmNsZWFyKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vbkluaXRDYWxsYmFjaykge1xuICAgICAgdGhpcy5vbkluaXRDYWxsYmFjaygpO1xuICAgIH1cblxuICAgIHRoaXMuaW5pdFN0eWxlc18oKTtcbiAgICB0aGlzLmZlYXR1cmVPdmVybGF5Xy5zZXRTdHlsZSh0aGlzLmdldFNlYXJjaFN0eWxlXy5iaW5kKHRoaXMpKTtcblxuICAgIGlmICh0aGlzLnR5cGVhaGVhZE9wdGlvbnMpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5vcHRpb25zLCB0aGlzLnR5cGVhaGVhZE9wdGlvbnMpO1xuICAgIH1cblxuICAgIHRoaXMuaW5pdERhdGFzZXRzXygpO1xuICAgIHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMuY29sb3I7XG4gICAgfSwgdGhpcy5zZXRTdHlsZUNvbG9yLmJpbmQodGhpcykpO1xuICAgIHRoaXMubGlzdGVuZXJzID0gdGhpcy5tZXJnZUxpc3RlbmVyc18odGhpcy5hZGRpdGlvbmFsTGlzdGVuZXJzLCB7XG4gICAgICBzZWxlY3Q6IHRoaXMuc2VsZWN0Xy5iaW5kKHRoaXMpLFxuICAgICAgY2hhbmdlOiB0aGlzLmhhbmRsZUNoYW5nZV8uYmluZCh0aGlzKSxcbiAgICAgIGNsb3NlOiB0aGlzLmNsb3NlXy5iaW5kKHRoaXMpLFxuICAgICAgZGF0YXNldHNlbXB0eTogdGhpcy5kYXRhc2V0c2VtcHR5Xy5iaW5kKHRoaXMpXG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5uZ2VvTG9jYXRpb25fKSB7XG4gICAgICB2YXIgc2VhcmNoUXVlcnkgPSB0aGlzLm5nZW9Mb2NhdGlvbl8uZ2V0UGFyYW0oJ3NlYXJjaCcpO1xuXG4gICAgICBpZiAoc2VhcmNoUXVlcnkpIHtcbiAgICAgICAgdmFyIHJlc3VsdEluZGV4ID0gMTtcblxuICAgICAgICBpZiAodGhpcy5uZ2VvTG9jYXRpb25fLmdldFBhcmFtKCdzZWFyY2gtc2VsZWN0LWluZGV4JykpIHtcbiAgICAgICAgICByZXN1bHRJbmRleCA9IHBhcnNlSW50KHRoaXMubmdlb0xvY2F0aW9uXy5nZXRQYXJhbSgnc2VhcmNoLXNlbGVjdC1pbmRleCcpIHx8ICcnLCAxMCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbWFwWm9vbTtcblxuICAgICAgICBpZiAodGhpcy5uZ2VvTG9jYXRpb25fLmdldFBhcmFtKCdzZWFyY2gtbWF4em9vbScpKSB7XG4gICAgICAgICAgbWFwWm9vbSA9IHBhcnNlSW50KHRoaXMubmdlb0xvY2F0aW9uXy5nZXRQYXJhbSgnc2VhcmNoLW1heHpvb20nKSB8fCAnJywgMTApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubmdlb0xvY2F0aW9uXy5nZXRQYXJhbSgnbWFwX3pvb20nKSkge1xuICAgICAgICAgIG1hcFpvb20gPSBwYXJzZUludCh0aGlzLm5nZW9Mb2NhdGlvbl8uZ2V0UGFyYW0oJ21hcF96b29tJykgfHwgJycsIDEwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZnVsbHRleHRzZWFyY2hfKHNlYXJjaFF1ZXJ5LCByZXN1bHRJbmRleCwgbWFwWm9vbSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5tZXJnZUxpc3RlbmVyc18gPSBmdW5jdGlvbiBtZXJnZUxpc3RlbmVyc18oYWRkaXRpb25hbExpc3RlbmVycywgbGlzdGVuZXJzKSB7XG4gICAgaWYgKGFkZGl0aW9uYWxMaXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGxpc3RlbmVycztcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgb3BlbjogYWRkaXRpb25hbExpc3RlbmVycy5vcGVuLFxuICAgICAgY2xvc2U6IGFkZGl0aW9uYWxMaXN0ZW5lcnMuY2xvc2UgPT09IHVuZGVmaW5lZCA/IGxpc3RlbmVycy5jbG9zZSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGlzdGVuZXJzLmNsb3NlKCk7XG4gICAgICAgIGFkZGl0aW9uYWxMaXN0ZW5lcnMuY2xvc2UoKTtcbiAgICAgIH0sXG4gICAgICBjaGFuZ2U6IGFkZGl0aW9uYWxMaXN0ZW5lcnMuY2hhbmdlLFxuICAgICAgY3Vyc29yY2hhbmdlOiBhZGRpdGlvbmFsTGlzdGVuZXJzLmN1cnNvcmNoYW5nZSxcbiAgICAgIGRhdGFzZXRzZW1wdHk6IGFkZGl0aW9uYWxMaXN0ZW5lcnMuZGF0YXNldHNlbXB0eSxcbiAgICAgIHNlbGVjdDogYWRkaXRpb25hbExpc3RlbmVycy5zZWxlY3QgPT09IHVuZGVmaW5lZCA/IGxpc3RlbmVycy5zZWxlY3QgOiBmdW5jdGlvbiAoZXZ0LCBvYmosIGRhdGFzZXQpIHtcbiAgICAgICAgbGlzdGVuZXJzLnNlbGVjdChldnQsIG9iaiwgZGF0YXNldCk7XG4gICAgICAgIGFkZGl0aW9uYWxMaXN0ZW5lcnMuc2VsZWN0KGV2dCwgb2JqLCBkYXRhc2V0KTtcbiAgICAgIH0sXG4gICAgICBhdXRvY29tcGxldGU6IGFkZGl0aW9uYWxMaXN0ZW5lcnMuYXV0b2NvbXBsZXRlXG4gICAgfTtcbiAgfTtcblxuICBfcHJvdG8uaW5pdERhdGFzZXRzXyA9IGZ1bmN0aW9uIGluaXREYXRhc2V0c18oKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICBpZiAoIXRoaXMubWFwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgdmFyIGdldHRleHRDYXRhbG9nID0gdGhpcy5nZXR0ZXh0Q2F0YWxvZ187XG5cbiAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHtcbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgcmV0dXJuIFwiYnJlYWtcIjtcbiAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pID0gX2l0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgaWYgKF9pLmRvbmUpIHJldHVybiBcImJyZWFrXCI7XG4gICAgICAgIF9yZWYgPSBfaS52YWx1ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIGRhdGFzb3VyY2UgPSBfcmVmO1xuICAgICAgdmFyIGdyb3VwVmFsdWVzID0gZGF0YXNvdXJjZS5ncm91cFZhbHVlcyAhPT0gdW5kZWZpbmVkID8gZGF0YXNvdXJjZS5ncm91cFZhbHVlcyA6IFtdO1xuICAgICAgdmFyIGdyb3VwQWN0aW9ucyA9IGRhdGFzb3VyY2UuZ3JvdXBBY3Rpb25zID8gZGF0YXNvdXJjZS5ncm91cEFjdGlvbnMgOiBbXTtcbiAgICAgIHZhciBmaWx0ZXJzID0gW107XG5cbiAgICAgIGlmIChncm91cFZhbHVlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZmlsdGVycy5wdXNoKHtcbiAgICAgICAgICAndGl0bGUnOiAnJyxcbiAgICAgICAgICAnZmlsdGVyJzogX3RoaXMyLmZpbHRlckxheWVybmFtZV8oKVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdyb3VwVmFsdWVzLmZvckVhY2goZnVuY3Rpb24gKGxheWVyTmFtZSkge1xuICAgICAgICAgIGZpbHRlcnMucHVzaCh7XG4gICAgICAgICAgICAndGl0bGUnOiBsYXllck5hbWUsXG4gICAgICAgICAgICAnZmlsdGVyJzogX3RoaXMyLmZpbHRlckxheWVybmFtZV8obGF5ZXJOYW1lKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZ3JvdXBBY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICBmaWx0ZXJzLnB1c2goe1xuICAgICAgICAgICd0aXRsZSc6IGdldHRleHRDYXRhbG9nLmdldFN0cmluZyhhY3Rpb24udGl0bGUpLFxuICAgICAgICAgICdmaWx0ZXInOiBfdGhpczIuZmlsdGVyQWN0aW9uXyhhY3Rpb24uYWN0aW9uKVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgZmlsdGVycy5mb3JFYWNoKGZ1bmN0aW9uIChmaWx0ZXIpIHtcbiAgICAgICAgX3RoaXMyLmRhdGFzZXRzLnB1c2goX3RoaXMyLmNyZWF0ZURhdGFzZXRfKHtcbiAgICAgICAgICBibG9vZGhvdW5kT3B0aW9uczogZGF0YXNvdXJjZS5ibG9vZGhvdW5kT3B0aW9ucyxcbiAgICAgICAgICBkYXRhc2V0VGl0bGU6IGZpbHRlci50aXRsZSxcbiAgICAgICAgICBsYWJlbEtleTogZGF0YXNvdXJjZS5sYWJlbEtleSxcbiAgICAgICAgICBwcm9qZWN0aW9uOiBkYXRhc291cmNlLnByb2plY3Rpb24sXG4gICAgICAgICAgdHlwZWFoZWFkRGF0YXNldE9wdGlvbnM6IGRhdGFzb3VyY2UudHlwZWFoZWFkRGF0YXNldE9wdGlvbnMsXG4gICAgICAgICAgdXJsOiBkYXRhc291cmNlLnVybFxuICAgICAgICB9LCBmaWx0ZXIuZmlsdGVyKSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gdGhpcy5kYXRhc291cmNlcywgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvciksIF9pID0gMCwgX2l0ZXJhdG9yID0gX2lzQXJyYXkgPyBfaXRlcmF0b3IgOiBfaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgIHZhciBfcmVmO1xuXG4gICAgICB2YXIgX3JldCA9IF9sb29wKCk7XG5cbiAgICAgIGlmIChfcmV0ID09PSBcImJyZWFrXCIpIGJyZWFrO1xuICAgIH1cblxuICAgIHRoaXMuZGF0YXNldHMucHVzaCh7XG4gICAgICBzb3VyY2U6IHRoaXMuY3JlYXRlU2VhcmNoQ29vcmRpbmF0ZXNfKHRoaXMubWFwLmdldFZpZXcoKSksXG4gICAgICBuYW1lOiAnY29vcmRpbmF0ZXMnLFxuICAgICAgZGlzcGxheTogJ2xhYmVsJyxcbiAgICAgIHRlbXBsYXRlczoge1xuICAgICAgICBoZWFkZXI6IGZ1bmN0aW9uIGhlYWRlcigpIHtcbiAgICAgICAgICB2YXIgaGVhZGVyID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdSZWNlbnRlciB0bycpO1xuICAgICAgICAgIHJldHVybiBcIjxkaXYgY2xhc3M9XFxcImdtZi1zZWFyY2gtaGVhZGVyXFxcIiB0cmFuc2xhdGU+XCIgKyBoZWFkZXIgKyBcIjwvZGl2PlwiO1xuICAgICAgICB9LFxuICAgICAgICBzdWdnZXN0aW9uOiBmdW5jdGlvbiBzdWdnZXN0aW9uKF9zdWdnZXN0aW9uKSB7XG4gICAgICAgICAgdmFyIGNvb3JkaW5hdGVzID0gX3N1Z2dlc3Rpb24ubGFiZWw7XG4gICAgICAgICAgdmFyIGh0bWwgPSBcIjxwIGNsYXNzPVxcXCJnbWYtc2VhcmNoLWxhYmVsXFxcIj5cIiArIGNvb3JkaW5hdGVzICsgXCI8L3A+XCI7XG4gICAgICAgICAgaHRtbCA9IFwiPGRpdiBjbGFzcz1cXFwiZ21mLXNlYXJjaC1kYXR1bVxcXCI+XCIgKyBodG1sICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgICByZXR1cm4gaHRtbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5jcmVhdGVEYXRhc2V0XyA9IGZ1bmN0aW9uIGNyZWF0ZURhdGFzZXRfKGNvbmZpZywgb3B0X2ZpbHRlcikge1xuICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICAgIHZhciBjb21wb25lbnRTY29wZSA9IHRoaXMuc2NvcGVfO1xuICAgIHZhciBjb21waWxlID0gdGhpcy5jb21waWxlXztcbiAgICB2YXIgYmxvb2Rob3VuZEVuZ2luZSA9IHRoaXMuY3JlYXRlQW5kSW5pdEJsb29kaG91bmRfKGNvbmZpZywgb3B0X2ZpbHRlcik7XG4gICAgdmFyIHR5cGVhaGVhZERhdGFzZXQgPSB7XG4gICAgICBsaW1pdDogSW5maW5pdHksXG4gICAgICBzb3VyY2U6IGJsb29kaG91bmRFbmdpbmUudHRBZGFwdGVyKCksXG4gICAgICBkaXNwbGF5OiBmdW5jdGlvbiBkaXNwbGF5KHN1Z2dlc3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb24uZ2V0KGNvbmZpZy5sYWJlbEtleSk7XG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVzOiB7XG4gICAgICAgIGhlYWRlcjogZnVuY3Rpb24gaGVhZGVyKCkge1xuICAgICAgICAgIGlmICghY29uZmlnLmRhdGFzZXRUaXRsZSkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgaGVhZGVyID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKGNvbmZpZy5kYXRhc2V0VGl0bGUpO1xuICAgICAgICAgICAgcmV0dXJuIFwiPGRpdiBjbGFzcz1cXFwiZ21mLXNlYXJjaC1oZWFkZXJcXFwiPlwiICsgaGVhZGVyICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHN1Z2dlc3Rpb246IGZ1bmN0aW9uIHN1Z2dlc3Rpb24oX3N1Z2dlc3Rpb24yKSB7XG4gICAgICAgICAgdmFyIHNjb3BlID0gY29tcG9uZW50U2NvcGUuJG5ldyh0cnVlKTtcbiAgICAgICAgICBzY29wZS5mZWF0dXJlID0gX3N1Z2dlc3Rpb24yO1xuICAgICAgICAgIHZhciBodG1sID0gXCI8cCBjbGFzcz1cXFwiZ21mLXNlYXJjaC1sYWJlbFxcXCIgdHJhbnNsYXRlPlwiICsgX3N1Z2dlc3Rpb24yLmdldChjb25maWcubGFiZWxLZXkpICsgXCI8L3A+XCI7XG4gICAgICAgICAgaHRtbCArPSBcIjxwIGNsYXNzPVxcXCJnbWYtc2VhcmNoLWdyb3VwXFxcIiB0cmFuc2xhdGU+XCIgKyAoX3N1Z2dlc3Rpb24yLmdldCgnbGF5ZXJfbmFtZScpIHx8IGNvbmZpZy5kYXRhc2V0VGl0bGUpICsgXCI8L3A+XCI7XG4gICAgICAgICAgaHRtbCA9IFwiPGRpdiBjbGFzcz1cXFwiZ21mLXNlYXJjaC1kYXR1bVxcXCI+XCIgKyBodG1sICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgICByZXR1cm4gY29tcGlsZShodG1sKShzY29wZSkuaHRtbCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmIChjb25maWcudHlwZWFoZWFkRGF0YXNldE9wdGlvbnMpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odHlwZWFoZWFkRGF0YXNldCwgY29uZmlnLnR5cGVhaGVhZERhdGFzZXRPcHRpb25zKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHlwZWFoZWFkRGF0YXNldDtcbiAgfTtcblxuICBfcHJvdG8uZmlsdGVyQWN0aW9uXyA9IGZ1bmN0aW9uIGZpbHRlckFjdGlvbl8oYWN0aW9uKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgICB2YXIgcHJvcGVydGllcyA9IGZlYXR1cmUucHJvcGVydGllcyB8fCB7fTtcblxuICAgICAgaWYgKHByb3BlcnRpZXMuYWN0aW9ucykge1xuICAgICAgICByZXR1cm4gIXByb3BlcnRpZXMubGF5ZXJfbmFtZSAmJiBwcm9wZXJ0aWVzLmFjdGlvbnMuc29tZShmdW5jdGlvbiAoYWN0KSB7XG4gICAgICAgICAgcmV0dXJuIGFjdC5hY3Rpb24gPT09IGFjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICBfcHJvdG8uZmlsdGVyTGF5ZXJuYW1lXyA9IGZ1bmN0aW9uIGZpbHRlckxheWVybmFtZV8ob3B0X2xheWVyTmFtZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgdmFyIGZlYXR1cmVMYXllck5hbWUgPSAoZmVhdHVyZS5wcm9wZXJ0aWVzIHx8IHt9KS5sYXllcl9uYW1lO1xuXG4gICAgICBpZiAoZmVhdHVyZUxheWVyTmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdF9sYXllck5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZlYXR1cmVMYXllck5hbWUgPT09IG9wdF9sYXllck5hbWU7XG4gICAgfTtcbiAgfTtcblxuICBfcHJvdG8uY3JlYXRlQW5kSW5pdEJsb29kaG91bmRfID0gZnVuY3Rpb24gY3JlYXRlQW5kSW5pdEJsb29kaG91bmRfKGNvbmZpZywgb3B0X2ZpbHRlcikge1xuICAgIGlmICghdGhpcy5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICB2YXIgbWFwUHJvamVjdGlvbkNvZGUgPSB0aGlzLm1hcC5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpLmdldENvZGUoKTtcbiAgICB2YXIgcmVtb3RlT3B0aW9ucyA9IHRoaXMuZ2V0Qmxvb2Rob3VkUmVtb3RlT3B0aW9uc18oKTtcbiAgICB2YXIgYmxvb2Rob3VuZCA9IHRoaXMubmdlb1NlYXJjaENyZWF0ZUdlb0pTT05CbG9vZGhvdW5kXyhjb25maWcudXJsLCBvcHRfZmlsdGVyLCBvbFByb2ouZ2V0KG1hcFByb2plY3Rpb25Db2RlKSwgb2xQcm9qLmdldChjb25maWcucHJvamVjdGlvbiksIGNvbmZpZy5ibG9vZGhvdW5kT3B0aW9ucywgcmVtb3RlT3B0aW9ucyk7XG4gICAgYmxvb2Rob3VuZC5pbml0aWFsaXplKCk7XG4gICAgcmV0dXJuIGJsb29kaG91bmQ7XG4gIH07XG5cbiAgX3Byb3RvLmdldEJsb29kaG91ZFJlbW90ZU9wdGlvbnNfID0gZnVuY3Rpb24gZ2V0Qmxvb2Rob3VkUmVtb3RlT3B0aW9uc18oKSB7XG4gICAgdmFyIGdldHRleHRDYXRhbG9nID0gdGhpcy5nZXR0ZXh0Q2F0YWxvZ187XG4gICAgcmV0dXJuIHtcbiAgICAgIHJhdGVMaW1pdFdhaXQ6IHRoaXMuZGVsYXksXG4gICAgICBwcmVwYXJlOiBmdW5jdGlvbiBwcmVwYXJlKHF1ZXJ5LCBzZXR0aW5ncykge1xuICAgICAgICB2YXIgdXJsID0gc2V0dGluZ3MudXJsO1xuXG4gICAgICAgIGlmICghdXJsKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFVSTCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGxhbmcgPSBnZXR0ZXh0Q2F0YWxvZy5nZXRDdXJyZW50TGFuZ3VhZ2UoKTtcbiAgICAgICAgc2V0dGluZ3MueGhyRmllbGRzID0ge1xuICAgICAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICBzZXR0aW5ncy51cmwgPSBvbFVyaUFwcGVuZFBhcmFtcyh1cmwsIHtcbiAgICAgICAgICBxdWVyeTogcXVlcnksXG4gICAgICAgICAgbGFuZzogbGFuZ1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHNldHRpbmdzO1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgX3Byb3RvLmNyZWF0ZVNlYXJjaENvb3JkaW5hdGVzXyA9IGZ1bmN0aW9uIGNyZWF0ZVNlYXJjaENvb3JkaW5hdGVzXyh2aWV3KSB7XG4gICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICB2YXIgdmlld1Byb2plY3Rpb24gPSB2aWV3LmdldFByb2plY3Rpb24oKTtcbiAgICB2YXIgZXh0ZW50ID0gdmlld1Byb2plY3Rpb24uZ2V0RXh0ZW50KCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChxdWVyeSwgY2FsbGJhY2spIHtcbiAgICAgIHZhciBzdWdnZXN0aW9ucyA9IFtdO1xuXG4gICAgICB2YXIgY29vcmRpbmF0ZXMgPSBfdGhpczMubmdlb0F1dG9Qcm9qZWN0aW9uXy5zdHJpbmdUb0Nvb3JkaW5hdGVzKHF1ZXJ5KTtcblxuICAgICAgaWYgKGNvb3JkaW5hdGVzID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHBvc2l0aW9uID0gX3RoaXMzLm5nZW9BdXRvUHJvamVjdGlvbl8udHJ5UHJvamVjdGlvbnNXaXRoSW52ZXJzaW9uKGNvb3JkaW5hdGVzLCBleHRlbnQsIHZpZXdQcm9qZWN0aW9uLCBfdGhpczMuY29vcmRpbmF0ZXNQcm9qZWN0aW9ucyk7XG5cbiAgICAgIGlmIChwb3NpdGlvbiA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xuICAgICAgICBsYWJlbDogY29vcmRpbmF0ZXMuam9pbignICcpLFxuICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sXG4gICAgICAgIHR0X3NvdXJjZTogJ2Nvb3JkaW5hdGVzJ1xuICAgICAgfSk7XG4gICAgICBjYWxsYmFjayhzdWdnZXN0aW9ucyk7XG4gICAgfTtcbiAgfTtcblxuICBfcHJvdG8uaW5pdFN0eWxlc18gPSBmdW5jdGlvbiBpbml0U3R5bGVzXygpIHtcbiAgICB0aGlzLnN0eWxlc19bQ09PUkRJTkFURVNfTEFZRVJfTkFNRV0gPSBuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICAgIGltYWdlOiBuZXcgb2xTdHlsZVJlZ3VsYXJTaGFwZSh7XG4gICAgICAgIHN0cm9rZTogbmV3IG9sU3R5bGVTdHJva2Uoe1xuICAgICAgICAgIGNvbG9yOiBbMCwgMCwgMCwgMC43XSxcbiAgICAgICAgICB3aWR0aDogMlxuICAgICAgICB9KSxcbiAgICAgICAgcG9pbnRzOiA0LFxuICAgICAgICByYWRpdXM6IDgsXG4gICAgICAgIHJhZGl1czI6IDAsXG4gICAgICAgIGFuZ2xlOiAwXG4gICAgICB9KVxuICAgIH0pO1xuICAgIHZhciBmaWxsID0gbmV3IG9sU3R5bGVGaWxsKHtcbiAgICAgIGNvbG9yOiBbNjUsIDEzNCwgMjQwLCAwLjVdXG4gICAgfSk7XG4gICAgdmFyIHN0cm9rZSA9IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICAgIGNvbG9yOiBbNjUsIDEzNCwgMjQwLCAxXSxcbiAgICAgIHdpZHRoOiAyXG4gICAgfSk7XG4gICAgdGhpcy5zdHlsZXNfWydkZWZhdWx0J10gPSBuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICAgIGZpbGw6IGZpbGwsXG4gICAgICBpbWFnZTogbmV3IG9sU3R5bGVDaXJjbGUoe1xuICAgICAgICBmaWxsOiBmaWxsLFxuICAgICAgICByYWRpdXM6IDUsXG4gICAgICAgIHN0cm9rZTogc3Ryb2tlXG4gICAgICB9KSxcbiAgICAgIHN0cm9rZTogc3Ryb2tlXG4gICAgfSk7XG4gICAgdmFyIGN1c3RvbVN0eWxlcyA9IHRoaXMuZmVhdHVyZXNTdHlsZXMgfHwge307XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLnN0eWxlc18sIGN1c3RvbVN0eWxlcyk7XG4gIH07XG5cbiAgX3Byb3RvLmdldFNlYXJjaFN0eWxlXyA9IGZ1bmN0aW9uIGdldFNlYXJjaFN0eWxlXyhmZWF0dXJlLCByZXNvbHV0aW9uKSB7XG4gICAgaWYgKCFmZWF0dXJlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZScpO1xuICAgIH1cblxuICAgIHZhciBzdHlsZSA9IHRoaXMuc3R5bGVzX1tmZWF0dXJlLmdldCgnbGF5ZXJfbmFtZScpXSB8fCB0aGlzLnN0eWxlc19bJ2RlZmF1bHQnXTtcblxuICAgIGlmICh0aGlzLmNvbG9yKSB7XG4gICAgICB2YXIgY29sb3IgPSBhc0NvbG9yQXJyYXkodGhpcy5jb2xvcik7XG4gICAgICB2YXIgc3Ryb2tlQ29sb3IgPSBjb2xvci5zbGljZSgpO1xuICAgICAgc3Ryb2tlQ29sb3JbM10gPSAxO1xuICAgICAgdmFyIGZpbGxDb2xvciA9IGNvbG9yLnNsaWNlKCk7XG4gICAgICBmaWxsQ29sb3JbM10gPSAwLjU7XG4gICAgICB2YXIgc3Ryb2tlU3R5bGUgPSBzdHlsZS5nZXRTdHJva2UoKTtcblxuICAgICAgaWYgKHN0cm9rZVN0eWxlKSB7XG4gICAgICAgIHN0cm9rZVN0eWxlLnNldENvbG9yKHN0cm9rZUNvbG9yKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGZpbGxTdHlsZSA9IHN0eWxlLmdldEZpbGwoKTtcblxuICAgICAgaWYgKGZpbGxTdHlsZSkge1xuICAgICAgICBmaWxsU3R5bGUuc2V0Q29sb3IoZmlsbENvbG9yKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGltYWdlU3R5bGUgPSBzdHlsZS5nZXRJbWFnZSgpO1xuXG4gICAgICBpZiAoaW1hZ2VTdHlsZSkge1xuICAgICAgICBpbWFnZVN0eWxlID0gaW1hZ2VTdHlsZS5jbG9uZSgpO1xuICAgICAgICB2YXIgaW1hZ2VTdHJva2VTdHlsZSA9IGltYWdlU3R5bGUuZ2V0U3Ryb2tlKCk7XG5cbiAgICAgICAgaWYgKGltYWdlU3Ryb2tlU3R5bGUpIHtcbiAgICAgICAgICBpbWFnZVN0cm9rZVN0eWxlLnNldENvbG9yKHN0cm9rZUNvbG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpbWFnZUZpbGxTdHlsZSA9IGltYWdlU3R5bGUuZ2V0RmlsbCgpO1xuXG4gICAgICAgIGlmIChpbWFnZUZpbGxTdHlsZSkge1xuICAgICAgICAgIGltYWdlRmlsbFN0eWxlLnNldENvbG9yKGZpbGxDb2xvcik7XG4gICAgICAgIH1cblxuICAgICAgICBzdHlsZS5zZXRJbWFnZShpbWFnZVN0eWxlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3R5bGU7XG4gIH07XG5cbiAgX3Byb3RvLnNldFN0eWxlQ29sb3IgPSBmdW5jdGlvbiBzZXRTdHlsZUNvbG9yKGNvbG9yKSB7XG4gICAgaWYgKGNvbG9yKSB7XG4gICAgICB0aGlzLmNvbG9yID0gY29sb3I7XG4gICAgICB0aGlzLm5nZW9GZWF0dXJlT3ZlcmxheU1nci5nZXRMYXllcigpLmNoYW5nZWQoKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnNldFRURHJvcGRvd25WaXNpYmlsaXR5XyA9IGZ1bmN0aW9uIHNldFRURHJvcGRvd25WaXNpYmlsaXR5XygpIHtcbiAgICBpZiAodGhpcy5jbGVhckJ1dHRvbikge1xuICAgICAgdmFyIHR0RHJvcGRvd24gPSB0aGlzLmVsZW1lbnRfLmZpbmQoJy50d2l0dGVyLXR5cGVhaGVhZCAudHQtbWVudScpO1xuICAgICAgdGhpcy5pbnB1dFZhbHVlID8gdHREcm9wZG93bi5zaG93KCkgOiB0dERyb3Bkb3duLmhpZGUoKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLm9uQ2xlYXJCdXR0b24gPSBmdW5jdGlvbiBvbkNsZWFyQnV0dG9uKCkge1xuICAgIHRoaXMuZmVhdHVyZU92ZXJsYXlfLmNsZWFyKCk7XG4gICAgdGhpcy5jbGVhcigpO1xuICB9O1xuXG4gIF9wcm90by5jbGVhciA9IGZ1bmN0aW9uIGNsZWFyKCkge1xuICAgIHZhciB0eXBlYWhlYWQgPSB0aGlzLmVsZW1lbnRfLmZpbmQoJy50d2l0dGVyLXR5cGVhaGVhZCcpO1xuICAgIHZhciB0dG1lbnUgPSB0eXBlYWhlYWQuY2hpbGRyZW4oJy50dC1tZW51Jyk7XG4gICAgdmFyIGlucHV0cyA9IHR5cGVhaGVhZC5jaGlsZHJlbignaW5wdXQnKTtcbiAgICB0aGlzLmlucHV0VmFsdWUgPSAnJztcbiAgICAkKGlucHV0c1sxXSkudHlwZWFoZWFkKCd2YWwnLCAnJyk7XG4gICAgdHRtZW51LmNoaWxkcmVuKCcudHQtZGF0YXNldCcpLmVtcHR5KCk7XG4gICAgdGhpcy5zZXRUVERyb3Bkb3duVmlzaWJpbGl0eV8oKTtcbiAgICB0aGlzLmRpc3BsYXlDb2xvclBpY2tlciA9IGZhbHNlO1xuICB9O1xuXG4gIF9wcm90by5ibHVyID0gZnVuY3Rpb24gYmx1cigpIHtcbiAgICB2YXIgdHlwZWFoZWFkID0gdGhpcy5lbGVtZW50Xy5maW5kKCcudHdpdHRlci10eXBlYWhlYWQnKTtcbiAgICB2YXIgaW5wdXRzID0gdHlwZWFoZWFkLmNoaWxkcmVuKCdpbnB1dCcpO1xuICAgIHRoaXMudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgJChpbnB1dHNbMV0pLmJsdXIoKTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uc2VsZWN0XyA9IGZ1bmN0aW9uIHNlbGVjdF8oZXZlbnQsIHN1Z2dlc3Rpb24sIGRhdGFzZXQpIHtcbiAgICBpZiAoIXRoaXMubWFwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgaWYgKHN1Z2dlc3Rpb24udHRfc291cmNlID09PSAnY29vcmRpbmF0ZXMnKSB7XG4gICAgICB2YXIgZ2VvbSA9IG5ldyBvbEdlb21Qb2ludChzdWdnZXN0aW9uLnBvc2l0aW9uKTtcbiAgICAgIHRoaXMuZmVhdHVyZU92ZXJsYXlfLmNsZWFyKCk7XG4gICAgICB0aGlzLmZlYXR1cmVPdmVybGF5Xy5hZGRGZWF0dXJlKG5ldyBvbEZlYXR1cmUoe1xuICAgICAgICBnZW9tZXRyeTogZ2VvbSxcbiAgICAgICAgJ2xheWVyX25hbWUnOiBDT09SRElOQVRFU19MQVlFUl9OQU1FXG4gICAgICB9KSk7XG4gICAgICB0aGlzLm1hcC5nZXRWaWV3KCkuc2V0Q2VudGVyKHN1Z2dlc3Rpb24ucG9zaXRpb24pO1xuICAgICAgdGhpcy5sZWF2ZVNlYXJjaF8oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCEoc3VnZ2VzdGlvbiBpbnN0YW5jZW9mIG9sRmVhdHVyZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBzdWdnZXN0aW9uIHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zZWxlY3RGcm9tR01GXyhldmVudCwgc3VnZ2VzdGlvbiwgZGF0YXNldCk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5zZWxlY3RGcm9tR01GXyA9IGZ1bmN0aW9uIHNlbGVjdEZyb21HTUZfKGV2ZW50LCBmZWF0dXJlLCBkYXRhc2V0KSB7XG4gICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICBpZiAoIXRoaXMubWFwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgfVxuXG4gICAgdmFyIGFjdGlvbnMgPSBmZWF0dXJlLmdldCgnYWN0aW9ucycpO1xuICAgIHZhciBmZWF0dXJlR2VvbWV0cnkgPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoYWN0aW9ucykge1xuICAgICAgdmFyIF9sb29wMiA9IGZ1bmN0aW9uIF9sb29wMihpLCBpaSkge1xuICAgICAgICB2YXIgYWN0aW9uID0gYWN0aW9uc1tpXTtcbiAgICAgICAgdmFyIGFjdGlvbk5hbWUgPSBhY3Rpb24uYWN0aW9uO1xuICAgICAgICB2YXIgYWN0aW9uRGF0YSA9IGFjdGlvbi5kYXRhO1xuXG4gICAgICAgIGlmIChhY3Rpb25OYW1lID09ICdhZGRfdGhlbWUnKSB7XG4gICAgICAgICAgX3RoaXM0LmdtZlRoZW1lc18uZ2V0VGhlbWVzT2JqZWN0KCkudGhlbihmdW5jdGlvbiAodGhlbWVzKSB7XG4gICAgICAgICAgICB2YXIgdGhlbWUgPSBmaW5kVGhlbWVCeU5hbWUodGhlbWVzLCBhY3Rpb25EYXRhKTtcblxuICAgICAgICAgICAgaWYgKHRoZW1lKSB7XG4gICAgICAgICAgICAgIF90aGlzNC5nbWZUcmVlTWFuYWdlcl8uYWRkRmlyc3RMZXZlbEdyb3Vwcyh0aGVtZS5jaGlsZHJlbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uTmFtZSA9PSAnYWRkX2dyb3VwJykge1xuICAgICAgICAgIF90aGlzNC5nbWZUcmVlTWFuYWdlcl8uYWRkR3JvdXBCeU5hbWUoYWN0aW9uRGF0YSwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uTmFtZSA9PSAnYWRkX2xheWVyJykge1xuICAgICAgICAgIHZhciBncm91cEFjdGlvbnMgPSBfdGhpczQuZGF0YXNvdXJjZXNbMF0uZ3JvdXBBY3Rpb25zO1xuICAgICAgICAgIHZhciBkYXRhc291cmNlc0FjdGlvbnNIYXZlQWRkTGF5ZXI7XG4gICAgICAgICAgZ3JvdXBBY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGdyb3VwQWN0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZ3JvdXBBY3Rpb24uYWN0aW9uID09PSAnYWRkX2xheWVyJykge1xuICAgICAgICAgICAgICBkYXRhc291cmNlc0FjdGlvbnNIYXZlQWRkTGF5ZXIgPSB0cnVlO1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGlmIChkYXRhc291cmNlc0FjdGlvbnNIYXZlQWRkTGF5ZXIpIHtcbiAgICAgICAgICAgIHZhciBzaWxlbnQgPSAhIWZlYXR1cmVHZW9tZXRyeTtcblxuICAgICAgICAgICAgX3RoaXM0LmdtZlRyZWVNYW5hZ2VyXy5hZGRHcm91cEJ5TGF5ZXJOYW1lKGFjdGlvbkRhdGEsIHRydWUsIHNpbGVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBhY3Rpb25zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgX2xvb3AyKGksIGlpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgc2l6ZSA9IHRoaXMubWFwLmdldFNpemUoKTtcblxuICAgIGlmIChmZWF0dXJlR2VvbWV0cnkgaW5zdGFuY2VvZiBTaW1wbGVHZW9tZXRyeSAmJiBzaXplKSB7XG4gICAgICB2YXIgdmlldyA9IHRoaXMubWFwLmdldFZpZXcoKTtcbiAgICAgIHRoaXMuZmVhdHVyZU92ZXJsYXlfLmNsZWFyKCk7XG4gICAgICB0aGlzLmZlYXR1cmVPdmVybGF5Xy5hZGRGZWF0dXJlKGZlYXR1cmUpO1xuICAgICAgdGhpcy5kaXNwbGF5Q29sb3JQaWNrZXIgPSB0cnVlO1xuICAgICAgdmFyIGZpdEFycmF5ID0gZmVhdHVyZUdlb21ldHJ5LmdldFR5cGUoKSA9PT0gJ0dlb21ldHJ5Q29sbGVjdGlvbicgPyBmZWF0dXJlR2VvbWV0cnkuZ2V0RXh0ZW50KCkgOiBmZWF0dXJlR2VvbWV0cnk7XG4gICAgICB2aWV3LmZpdChmaXRBcnJheSwge1xuICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICBtYXhab29tOiB0aGlzLm1heFpvb21cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMubGVhdmVTZWFyY2hfKCk7XG4gIH07XG5cbiAgX3Byb3RvLmxlYXZlU2VhcmNoXyA9IGZ1bmN0aW9uIGxlYXZlU2VhcmNoXygpIHtcbiAgICBpZiAoIXRoaXMuY2xlYXJCdXR0b24pIHtcbiAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICB9XG5cbiAgICB0aGlzLmJsdXIoKTtcbiAgfTtcblxuICBfcHJvdG8uY2xvc2VfID0gZnVuY3Rpb24gY2xvc2VfKGV2ZW50KSB7XG4gICAgaWYgKCF0aGlzLmNsZWFyQnV0dG9uKSB7XG4gICAgICB0aGlzLnNldFRURHJvcGRvd25WaXNpYmlsaXR5XygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uZGF0YXNldHNlbXB0eV8gPSBmdW5jdGlvbiBkYXRhc2V0c2VtcHR5XyhldmVudCwgcXVlcnksIGVtcHR5KSB7XG4gICAgdmFyIG1lbnUgPSB0aGlzLmVsZW1lbnRfLmZpbmQoJy50d2l0dGVyLXR5cGVhaGVhZCAudHQtbWVudScpO1xuICAgIHZhciBtZXNzYWdlID0gbWVudS5jaGlsZHJlbignLmdtZi1zZWFyY2gtbm8tcmVzdWx0cycpO1xuXG4gICAgaWYgKG1lc3NhZ2UubGVuZ3RoID09IDApIHtcbiAgICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICAgICAgdmFyIGlubmVySFRNTCA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnTm8gcmVzdWx0IGZvdW5kJyk7XG4gICAgICB2YXIgZGl2ID0gJChcIjxkaXYgY2xhc3M9XFxcImdtZi1zZWFyY2gtbm8tcmVzdWx0c1xcXCIgdHJhbnNsYXRlPlwiICsgaW5uZXJIVE1MICsgXCI8L2Rpdj5cIik7XG4gICAgICBtZW51LmFwcGVuZChkaXYpO1xuICAgIH1cblxuICAgIGlmIChlbXB0eSkge1xuICAgICAgbWVzc2FnZS5zaG93KCk7XG4gICAgICBtZW51LmFkZENsYXNzKCdnbWYtc2VhcmNoLW5vLXJlc3VsdHMnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbWVudS5yZW1vdmVDbGFzcygnZ21mLXNlYXJjaC1uby1yZXN1bHRzJyk7XG4gICAgICBtZXNzYWdlLmhpZGUoKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmZ1bGx0ZXh0c2VhcmNoXyA9IGZ1bmN0aW9uIGZ1bGx0ZXh0c2VhcmNoXyhxdWVyeSwgcmVzdWx0SW5kZXgsIG9wdF96b29tKSB7XG4gICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICBpZiAocmVzdWx0SW5kZXggPCAxKSB7XG4gICAgICByZXN1bHRJbmRleCA9IDE7XG4gICAgfVxuXG4gICAgdGhpcy5mdWxsVGV4dFNlYXJjaF8uc2VhcmNoKHF1ZXJ5LCB7XG4gICAgICBsaW1pdDogXCJcIiArIHJlc3VsdEluZGV4XG4gICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgaWYgKCFfdGhpczUubWFwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRhdGEgJiYgZGF0YS5mZWF0dXJlc1tyZXN1bHRJbmRleCAtIDFdKSB7XG4gICAgICAgIHZhciBmb3JtYXQgPSBuZXcgb2xGb3JtYXRHZW9KU09OKCk7XG4gICAgICAgIHZhciBmZWF0dXJlID0gZm9ybWF0LnJlYWRGZWF0dXJlKGRhdGEuZmVhdHVyZXNbcmVzdWx0SW5kZXggLSAxXSk7XG5cbiAgICAgICAgX3RoaXM1LmZlYXR1cmVPdmVybGF5Xy5hZGRGZWF0dXJlKGZlYXR1cmUpO1xuXG4gICAgICAgIHZhciBmaXRPcHRpb25zID0ge307XG5cbiAgICAgICAgaWYgKG9wdF96b29tICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBmaXRPcHRpb25zLm1heFpvb20gPSBvcHRfem9vbTtcbiAgICAgICAgICBmaXRPcHRpb25zLnNpemUgPSBfdGhpczUubWFwLmdldFNpemUoKSB8fCBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgICAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdlb21ldHJ5Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpczUubWFwLmdldFZpZXcoKS5maXQoZ2VvbWV0cnkuZ2V0RXh0ZW50KCksIGZpdE9wdGlvbnMpO1xuXG4gICAgICAgIF90aGlzNS5pbnB1dFZhbHVlID0gZmVhdHVyZS5nZXQoJ2xhYmVsJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVDaGFuZ2VfKGV2ZW50LCBxdWVyeSkge1xuICAgIGlmIChxdWVyeSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZGF0YXNldHNlbXB0eV8oZXZlbnQsIHF1ZXJ5LCBmYWxzZSk7XG4gIH07XG5cbiAgcmV0dXJuIFNlYXJjaENvbnRyb2xsZXI7XG59KCk7XG5cbm1vZHVsZS5jb250cm9sbGVyKCdnbWZTZWFyY2hDb250cm9sbGVyJywgU2VhcmNoQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mU2VhcmNoQ29tcG9uZW50IGZyb20gJ2dtZi9zZWFyY2gvY29tcG9uZW50LmpzJztcbmltcG9ydCBnbWZTZWFyY2hGdWxsdGV4dFNlYXJjaCBmcm9tICdnbWYvc2VhcmNoL0Z1bGx0ZXh0U2VhcmNoLmpzJztcbmltcG9ydCAnLi9zZWFyY2guc2Nzcyc7XG5leHBvcnQgZGVmYXVsdCBhbmd1bGFyLm1vZHVsZSgnZ21mU2VhcmNoTW9kdWxlJywgW2dtZlNlYXJjaENvbXBvbmVudC5uYW1lLCBnbWZTZWFyY2hGdWxsdGV4dFNlYXJjaC5uYW1lXSk7IiwiVGhlbWVNYW5hZ2VyU2VydmljZS4kaW5qZWN0ID0gW1wiJHJvb3RTY29wZVwiLCBcImdtZlRoZW1lc1wiLCBcImdtZlRyZWVNYW5hZ2VyTW9kZUZsdXNoXCIsIFwiZ21mVHJlZU1hbmFnZXJcIiwgXCJuZ2VvU3RhdGVNYW5hZ2VyXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mTGF5ZXJ0cmVlVHJlZU1hbmFnZXIgZnJvbSAnZ21mL2xheWVydHJlZS9UcmVlTWFuYWdlci5qcyc7XG5pbXBvcnQgZ21mVGhlbWVUaGVtZXMsIHsgZmluZFRoZW1lQnlOYW1lIH0gZnJvbSAnZ21mL3RoZW1lL1RoZW1lcy5qcyc7XG5pbXBvcnQgbmdlb1N0YXRlbWFuYWdlclNlcnZpY2UgZnJvbSAnbmdlby9zdGF0ZW1hbmFnZXIvU2VydmljZS5qcyc7XG5leHBvcnQgdmFyIFRoZW1lRXZlbnRUeXBlID0ge1xuICBUSEVNRV9OQU1FX1NFVDogJ2dtZi10aGVtZW1hbmFnZXItdGhlbWVfbmFtZV9zZXQnXG59O1xuZXhwb3J0IGZ1bmN0aW9uIFRoZW1lTWFuYWdlclNlcnZpY2UoJHJvb3RTY29wZSwgZ21mVGhlbWVzLCBnbWZUcmVlTWFuYWdlck1vZGVGbHVzaCwgZ21mVHJlZU1hbmFnZXIsIG5nZW9TdGF0ZU1hbmFnZXIpIHtcbiAgdGhpcy4kcm9vdFNjb3BlXyA9ICRyb290U2NvcGU7XG4gIHRoaXMuZ21mVGhlbWVzXyA9IGdtZlRoZW1lcztcbiAgdGhpcy5tb2RlRmx1c2ggPSBnbWZUcmVlTWFuYWdlck1vZGVGbHVzaDtcbiAgdGhpcy5nbWZUcmVlTWFuYWdlcl8gPSBnbWZUcmVlTWFuYWdlcjtcbiAgdGhpcy5uZ2VvU3RhdGVNYW5hZ2VyXyA9IG5nZW9TdGF0ZU1hbmFnZXI7XG4gIHRoaXMudGhlbWVOYW1lXyA9ICcnO1xufVxuXG5UaGVtZU1hbmFnZXJTZXJ2aWNlLnByb3RvdHlwZS5hZGRUaGVtZSA9IGZ1bmN0aW9uICh0aGVtZSwgb3B0X3NpbGVudCkge1xuICBpZiAodGhpcy5tb2RlRmx1c2gpIHtcbiAgICB0aGlzLm5nZW9TdGF0ZU1hbmFnZXJfLnVwZGF0ZVN0YXRlKHtcbiAgICAgICd0aGVtZSc6IHRoZW1lLm5hbWVcbiAgICB9KTtcbiAgICB0aGlzLnNldFRoZW1lTmFtZSh0aGVtZS5uYW1lKTtcbiAgICB0aGlzLmdtZlRyZWVNYW5hZ2VyXy5zZXRGaXJzdExldmVsR3JvdXBzKHRoZW1lLmNoaWxkcmVuKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmdtZlRyZWVNYW5hZ2VyXy5hZGRGaXJzdExldmVsR3JvdXBzKHRoZW1lLmNoaWxkcmVuLCBmYWxzZSwgb3B0X3NpbGVudCk7XG4gIH1cbn07XG5cblRoZW1lTWFuYWdlclNlcnZpY2UucHJvdG90eXBlLmdldFRoZW1lTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMudGhlbWVOYW1lXztcbn07XG5cblRoZW1lTWFuYWdlclNlcnZpY2UucHJvdG90eXBlLmlzTG9hZGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuICF0aGlzLmdtZlRoZW1lc18ubG9hZGVkO1xufTtcblxuVGhlbWVNYW5hZ2VyU2VydmljZS5wcm90b3R5cGUudXBkYXRlQ3VycmVudFRoZW1lID0gZnVuY3Rpb24gKHRoZW1lTmFtZSwgZmFsbGJhY2tUaGVtZU5hbWUsIG9wdF9zaWxlbnQpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLmdtZlRoZW1lc18uZ2V0VGhlbWVzT2JqZWN0KCkudGhlbihmdW5jdGlvbiAodGhlbWVzKSB7XG4gICAgaWYgKCF0aGVtZU5hbWUgJiYgX3RoaXMubW9kZUZsdXNoKSB7XG4gICAgICB2YXIgZmFsbGJhY2tUaGVtZSA9IGZpbmRUaGVtZUJ5TmFtZSh0aGVtZXMsIGZhbGxiYWNrVGhlbWVOYW1lKTtcblxuICAgICAgaWYgKGZhbGxiYWNrVGhlbWUpIHtcbiAgICAgICAgX3RoaXMuZ21mVHJlZU1hbmFnZXJfLnNldEluaXRpYWxGaXJzdExldmVsR3JvdXBzKGZhbGxiYWNrVGhlbWUuY2hpbGRyZW4pO1xuXG4gICAgICAgIF90aGlzLmdtZlRyZWVNYW5hZ2VyXy5hZGRGaXJzdExldmVsR3JvdXBzKGZhbGxiYWNrVGhlbWUuY2hpbGRyZW4sIGZhbHNlLCBvcHRfc2lsZW50KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhlbWVOYW1lKSB7XG4gICAgICB2YXIgdGhlbWUgPSBmaW5kVGhlbWVCeU5hbWUodGhlbWVzLCB0aGVtZU5hbWUpO1xuXG4gICAgICBpZiAodGhlbWUpIHtcbiAgICAgICAgX3RoaXMuYWRkVGhlbWUodGhlbWUsIHRydWUpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBfdGhpcy5zZXRUaGVtZU5hbWUoZmFsbGJhY2tUaGVtZU5hbWUpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5UaGVtZU1hbmFnZXJTZXJ2aWNlLnByb3RvdHlwZS5zZXRUaGVtZU5hbWUgPSBmdW5jdGlvbiAobmFtZSwgb3B0X3NpbGVudCkge1xuICB0aGlzLnRoZW1lTmFtZV8gPSBuYW1lO1xuXG4gIGlmICghb3B0X3NpbGVudCkge1xuICAgIHRoaXMuJHJvb3RTY29wZV8uJGVtaXQoVGhlbWVFdmVudFR5cGUuVEhFTUVfTkFNRV9TRVQsIG5hbWUpO1xuICB9XG59O1xuXG5UaGVtZU1hbmFnZXJTZXJ2aWNlLnByb3RvdHlwZS5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuZ21mVHJlZU1hbmFnZXJfLnJlbW92ZUFsbCgpO1xufTtcblxudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZUaGVtZU1hbmFnZXInLCBbZ21mTGF5ZXJ0cmVlVHJlZU1hbmFnZXIubmFtZSwgZ21mVGhlbWVUaGVtZXMubmFtZSwgbmdlb1N0YXRlbWFuYWdlclNlcnZpY2UubmFtZV0pO1xubW9kdWxlLnZhbHVlKCdnbWZUcmVlTWFuYWdlck1vZGVGbHVzaCcsIHRydWUpO1xubW9kdWxlLnNlcnZpY2UoJ2dtZlRoZW1lTWFuYWdlcicsIFRoZW1lTWFuYWdlclNlcnZpY2UpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvTWFwTGF5ZXJIZWxwZXIgZnJvbSAnbmdlby9tYXAvTGF5ZXJIZWxwZXIuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0ICogYXMgb2xBcnJheSBmcm9tICdvbC9hcnJheS5qcyc7XG5pbXBvcnQgb2xDb2xsZWN0aW9uIGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuaW1wb3J0IG9sRXZlbnRzRXZlbnRUYXJnZXQgZnJvbSAnb2wvZXZlbnRzL1RhcmdldC5qcyc7XG5pbXBvcnQgVmVjdG9yTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yLmpzJztcbmltcG9ydCBWZWN0b3JTb3VyY2UgZnJvbSAnb2wvc291cmNlL1ZlY3Rvci5qcyc7XG5leHBvcnQgdmFyIFRoZW1lc1NlcnZpY2UgPSBmdW5jdGlvbiAoX29sRXZlbnRzRXZlbnRUYXJnZXQpIHtcbiAgVGhlbWVzU2VydmljZS4kaW5qZWN0ID0gW1wiJGh0dHBcIiwgXCIkaW5qZWN0b3JcIiwgXCIkcVwiLCBcIm5nZW9MYXllckhlbHBlclwiLCBcImdldHRleHRDYXRhbG9nXCIsIFwiZ21mVGhlbWVzT3B0aW9uc1wiXTtcblxuICBfaW5oZXJpdHNMb29zZShUaGVtZXNTZXJ2aWNlLCBfb2xFdmVudHNFdmVudFRhcmdldCk7XG5cbiAgZnVuY3Rpb24gVGhlbWVzU2VydmljZSgkaHR0cCwgJGluamVjdG9yLCAkcSwgbmdlb0xheWVySGVscGVyLCBnZXR0ZXh0Q2F0YWxvZywgZ21mVGhlbWVzT3B0aW9ucykge1xuICAgIHZhciBfdGhpcztcblxuICAgIF90aGlzID0gX29sRXZlbnRzRXZlbnRUYXJnZXQuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgIF90aGlzLmFkZEJsYW5rQmFja2dyb3VuZExheWVyXyA9IHRydWU7XG5cbiAgICBpZiAoZ21mVGhlbWVzT3B0aW9ucy5hZGRCbGFua0JhY2tncm91bmRMYXllciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBfdGhpcy5hZGRCbGFua0JhY2tncm91bmRMYXllcl8gPSBnbWZUaGVtZXNPcHRpb25zLmFkZEJsYW5rQmFja2dyb3VuZExheWVyO1xuICAgIH1cblxuICAgIF90aGlzLiRxXyA9ICRxO1xuICAgIF90aGlzLiRodHRwXyA9ICRodHRwO1xuICAgIF90aGlzLnRyZWVVcmxfID0gdW5kZWZpbmVkO1xuXG4gICAgaWYgKCRpbmplY3Rvci5oYXMoJ2dtZlRyZWVVcmwnKSkge1xuICAgICAgX3RoaXMudHJlZVVybF8gPSAkaW5qZWN0b3IuZ2V0KCdnbWZUcmVlVXJsJyk7XG4gICAgfVxuXG4gICAgX3RoaXMubmdlb0xvY2F0aW9uXyA9IG51bGw7XG5cbiAgICBpZiAoJGluamVjdG9yLmhhcygnbmdlb0xvY2F0aW9uJykpIHtcbiAgICAgIF90aGlzLm5nZW9Mb2NhdGlvbl8gPSAkaW5qZWN0b3IuZ2V0KCduZ2VvTG9jYXRpb24nKTtcbiAgICB9XG5cbiAgICBfdGhpcy5sYXllckhlbHBlcl8gPSBuZ2VvTGF5ZXJIZWxwZXI7XG4gICAgX3RoaXMuZ2V0dGV4dENhdGFsb2cgPSBnZXR0ZXh0Q2F0YWxvZztcbiAgICBfdGhpcy5kZWZlcnJlZF8gPSAkcS5kZWZlcigpO1xuICAgIF90aGlzLnByb21pc2VfID0gX3RoaXMuZGVmZXJyZWRfLnByb21pc2U7XG4gICAgX3RoaXMubG9hZGVkID0gZmFsc2U7XG4gICAgX3RoaXMuYmdMYXllclByb21pc2VfID0gbnVsbDtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gVGhlbWVzU2VydmljZS5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmdldEJnTGF5ZXJzID0gZnVuY3Rpb24gZ2V0QmdMYXllcnMoKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgZ2V0dGV4dENhdGFsb2cgPSB0aGlzLmdldHRleHRDYXRhbG9nO1xuXG4gICAgaWYgKHRoaXMuYmdMYXllclByb21pc2VfKSB7XG4gICAgICByZXR1cm4gdGhpcy5iZ0xheWVyUHJvbWlzZV87XG4gICAgfVxuXG4gICAgdmFyICRxID0gdGhpcy4kcV87XG4gICAgdmFyIGxheWVySGVscGVyID0gdGhpcy5sYXllckhlbHBlcl87XG5cbiAgICB2YXIgZ2V0SWRzID0gZnVuY3Rpb24gZ2V0SWRzKGl0ZW0sIGFycmF5KSB7XG4gICAgICBhcnJheS5wdXNoKG9sVXRpbEdldFVpZChpdGVtKSk7XG4gICAgICB2YXIgZ3JvdXBJdGVtID0gaXRlbTtcbiAgICAgIHZhciBjaGlsZHJlbiA9IGdyb3VwSXRlbS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIGdldElkcyhjaGlsZCwgYXJyYXkpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0sIGxheWVyKSB7XG4gICAgICBsYXllci5zZXQoJ2xhYmVsJywgaXRlbS5uYW1lKTtcbiAgICAgIGxheWVyLnNldCgnbWV0YWRhdGEnLCBpdGVtLm1ldGFkYXRhKTtcbiAgICAgIGxheWVyLnNldCgnZGltZW5zaW9ucycsIGl0ZW0uZGltZW5zaW9ucyk7XG4gICAgICB2YXIgaWRzID0gW107XG4gICAgICBnZXRJZHMoaXRlbSwgaWRzKTtcbiAgICAgIGxheWVyLnNldCgncXVlcnlTb3VyY2VJZHMnLCBpZHMpO1xuICAgICAgbGF5ZXIuc2V0KCdkYXRhU291cmNlSWQnLCBpdGVtLmlkKTtcbiAgICAgIHJldHVybiBsYXllcjtcbiAgICB9O1xuXG4gICAgdmFyIGxheWVyTGF5ZXJDcmVhdGlvbkZuID0gZnVuY3Rpb24gbGF5ZXJMYXllckNyZWF0aW9uRm4ob2djU2VydmVycywgZ21mTGF5ZXIpIHtcbiAgICAgIGlmIChnbWZMYXllci50eXBlID09PSAnV01UUycpIHtcbiAgICAgICAgdmFyIGdtZkxheWVyV01UUyA9IGdtZkxheWVyO1xuXG4gICAgICAgIGlmICghZ21mTGF5ZXJXTVRTLnVybCkge1xuICAgICAgICAgIHRocm93ICdMYXllciBVUkwgaXMgcmVxdWlyZWQnO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG1pblJlc29sdXRpb24gPSBnZXROb2RlTWluUmVzb2x1dGlvbihnbWZMYXllcldNVFMpO1xuICAgICAgICB2YXIgbWF4UmVzb2x1dGlvbiA9IGdldE5vZGVNYXhSZXNvbHV0aW9uKGdtZkxheWVyV01UUyk7XG4gICAgICAgIHZhciBsYXllciA9IGxheWVySGVscGVyLmNyZWF0ZVdNVFNMYXllckZyb21DYXBhYmlsaXRpdGVzKGdtZkxheWVyV01UUy51cmwsIGdtZkxheWVyV01UUy5sYXllciB8fCAnJywgZ21mTGF5ZXJXTVRTLm1hdHJpeFNldCwgZ21mTGF5ZXIuZGltZW5zaW9ucywgZ21mTGF5ZXJXTVRTLm1ldGFkYXRhLmN1c3RvbU9wZW5MYXllcnNPcHRpb25zLCBtaW5SZXNvbHV0aW9uLCBtYXhSZXNvbHV0aW9uKS50aGVuKGNhbGxiYWNrLmJpbmQobnVsbCwgZ21mTGF5ZXIpKS50aGVuKG51bGwsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIHZhciBtZXNzYWdlID0gXCJVbmFibGUgdG8gYnVpbGQgbGF5ZXIgXFxcIlwiICsgZ21mTGF5ZXJXTVRTLmxheWVyICsgXCJcXFwiIFwiICsgKFwiZnJvbSBXTVRTQ2FwYWJpbGl0aWVzOiBcIiArIGdtZkxheWVyV01UUy51cmwgKyBcIlxcblwiKTtcbiAgICAgICAgICBtZXNzYWdlICs9IFwiT3BlbkxheWVycyBlcnJvciBpcyBcXFwiXCIgKyByZXNwb25zZS5tZXNzYWdlO1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XG4gICAgICAgICAgcmV0dXJuICRxLnJlc29sdmUodW5kZWZpbmVkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBsYXllcjtcbiAgICAgIH0gZWxzZSBpZiAoZ21mTGF5ZXIudHlwZSA9PT0gJ1dNUycpIHtcbiAgICAgICAgdmFyIGdtZkxheWVyV01TID0gZ21mTGF5ZXI7XG5cbiAgICAgICAgaWYgKCFnbWZMYXllcldNUy5vZ2NTZXJ2ZXIpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ21mTGF5ZXJXTVMub2djU2VydmVyJyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VydmVyID0gb2djU2VydmVyc1tnbWZMYXllcldNUy5vZ2NTZXJ2ZXJdO1xuXG4gICAgICAgIGlmICghc2VydmVyKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNlcnZlcicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzZXJ2ZXIudXJsKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNlcnZlci51cmwnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghc2VydmVyLmltYWdlVHlwZSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBzZXJ2ZXIuaW1hZ2VUeXBlJyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgb3B0X3BhcmFtcyA9IHtcbiAgICAgICAgICBTVFlMRVM6IGdtZkxheWVyV01TLnN0eWxlXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGdtZkxheWVyLmRpbWVuc2lvbnMpIHtcbiAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3QkZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKGdtZkxheWVyLmRpbWVuc2lvbnMpOyBfaSA8IF9PYmplY3QkZW50cmllcy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBfT2JqZWN0JGVudHJpZXMkX2kgPSBfT2JqZWN0JGVudHJpZXNbX2ldLFxuICAgICAgICAgICAgICAgIGtleSA9IF9PYmplY3QkZW50cmllcyRfaVswXSxcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IF9PYmplY3QkZW50cmllcyRfaVsxXTtcblxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIG9wdF9wYXJhbXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjYWxsYmFjayhnbWZMYXllciwgbGF5ZXJIZWxwZXIuY3JlYXRlQmFzaWNXTVNMYXllcihzZXJ2ZXIudXJsLCBnbWZMYXllcldNUy5sYXllcnMgfHwgJycsIHNlcnZlci5pbWFnZVR5cGUsIHNlcnZlci50eXBlLCB1bmRlZmluZWQsIG9wdF9wYXJhbXMsIHNlcnZlci5jcmVkZW50aWFsID8gJ3VzZS1jcmVkZW50aWFscycgOiAnYW5vbnltb3VzJywgZ21mTGF5ZXJXTVMubWV0YWRhdGEuY3VzdG9tT3BlbkxheWVyc09wdGlvbnMpKTtcbiAgICAgIH1cblxuICAgICAgdGhyb3cgXCJVbnN1cHBvcnRlZCB0eXBlOiBcIiArIGdtZkxheWVyLnR5cGU7XG4gICAgfTtcblxuICAgIHZhciBsYXllckdyb3VwQ3JlYXRpb25GbiA9IGZ1bmN0aW9uIGxheWVyR3JvdXBDcmVhdGlvbkZuKG9nY1NlcnZlcnMsIGl0ZW0pIHtcbiAgICAgIHZhciBvcmRlcmVkQ2hpbGRyZW4gPSBpdGVtLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICByZXR1cm4geDtcbiAgICAgIH0pLnJldmVyc2UoKTtcbiAgICAgIHZhciBwcm9taXNlcyA9IG9yZGVyZWRDaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGxheWVyTGF5ZXJDcmVhdGlvbkZuKG9nY1NlcnZlcnMsIGl0ZW0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gJHEuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uIChsYXllcnMpIHtcbiAgICAgICAgdmFyIGNvbGxlY3Rpb247XG5cbiAgICAgICAgaWYgKGxheWVycykge1xuICAgICAgICAgIGxheWVycyA9IGxheWVycy5maWx0ZXIoZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgIHJldHVybiBsO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbGxlY3Rpb24gPSBuZXcgb2xDb2xsZWN0aW9uKGxheWVycyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZ3JvdXAgPSBsYXllckhlbHBlci5jcmVhdGVCYXNpY0dyb3VwKGNvbGxlY3Rpb24pO1xuICAgICAgICBjYWxsYmFjayhpdGVtLCBncm91cCk7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgcHJvbWlzZVN1Y2Nlc3NGbiA9IGZ1bmN0aW9uIHByb21pc2VTdWNjZXNzRm4oZGF0YSkge1xuICAgICAgdmFyIHByb21pc2VzID0gZGF0YS5iYWNrZ3JvdW5kX2xheWVycy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdmFyIGl0ZW1MYXllciA9IGl0ZW07XG4gICAgICAgIHZhciBpdGVtR3JvdXAgPSBpdGVtO1xuICAgICAgICB2YXIgaXRlbVR5cGUgPSBpdGVtTGF5ZXIudHlwZTtcblxuICAgICAgICBpZiAoaXRlbVR5cGUgPT09ICdXTVRTJyB8fCBpdGVtVHlwZSA9PT0gJ1dNUycpIHtcbiAgICAgICAgICByZXR1cm4gbGF5ZXJMYXllckNyZWF0aW9uRm4oZGF0YS5vZ2NTZXJ2ZXJzLCBpdGVtTGF5ZXIpO1xuICAgICAgICB9IGVsc2UgaWYgKGl0ZW1Hcm91cC5jaGlsZHJlbikge1xuICAgICAgICAgIHJldHVybiBsYXllckdyb3VwQ3JlYXRpb25GbihkYXRhLm9nY1NlcnZlcnMsIGl0ZW1Hcm91cCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gJHEuYWxsKHByb21pc2VzKTtcbiAgICB9O1xuXG4gICAgdGhpcy5iZ0xheWVyUHJvbWlzZV8gPSB0aGlzLnByb21pc2VfLnRoZW4ocHJvbWlzZVN1Y2Nlc3NGbikudGhlbihmdW5jdGlvbiAodmFsdWVzKSB7XG4gICAgICB2YXIgbGF5ZXJzID0gW107XG5cbiAgICAgIGlmIChfdGhpczIuYWRkQmxhbmtCYWNrZ3JvdW5kTGF5ZXJfKSB7XG4gICAgICAgIGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnYmxhbmsnKTtcbiAgICAgICAgdmFyIGxheWVyID0gbmV3IFZlY3RvckxheWVyKHtcbiAgICAgICAgICBzb3VyY2U6IG5ldyBWZWN0b3JTb3VyY2UoKVxuICAgICAgICB9KTtcbiAgICAgICAgbGF5ZXIuc2V0KCdsYWJlbCcsICdibGFuaycpO1xuICAgICAgICBsYXllci5zZXQoJ21ldGFkYXRhJywge1xuICAgICAgICAgIHRodW1ibmFpbDogJydcbiAgICAgICAgfSk7XG4gICAgICAgIGxheWVycy5wdXNoKGxheWVyKTtcbiAgICAgIH1cblxuICAgICAgdmFsdWVzLmZvckVhY2goZnVuY3Rpb24gKGxheWVyKSB7XG4gICAgICAgIGlmIChsYXllcikge1xuICAgICAgICAgIGxheWVycy5wdXNoKGxheWVyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gbGF5ZXJzO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLmJnTGF5ZXJQcm9taXNlXztcbiAgfTtcblxuICBfcHJvdG8uZ2V0VGhlbWVPYmplY3QgPSBmdW5jdGlvbiBnZXRUaGVtZU9iamVjdCh0aGVtZU5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXy50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICByZXR1cm4gZmluZFRoZW1lQnlOYW1lKGRhdGEudGhlbWVzLCB0aGVtZU5hbWUpO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5nZXRUaGVtZXNPYmplY3QgPSBmdW5jdGlvbiBnZXRUaGVtZXNPYmplY3QoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZV8udGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgcmV0dXJuIGRhdGEudGhlbWVzO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5nZXRCYWNrZ3JvdW5kTGF5ZXJzT2JqZWN0ID0gZnVuY3Rpb24gZ2V0QmFja2dyb3VuZExheWVyc09iamVjdCgpIHtcbiAgICBpZiAodGhpcy5wcm9taXNlXyA9PT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHByb21pc2UnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXy50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICByZXR1cm4gZGF0YS5iYWNrZ3JvdW5kX2xheWVycztcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0T2djU2VydmVyc09iamVjdCA9IGZ1bmN0aW9uIGdldE9nY1NlcnZlcnNPYmplY3QoKSB7XG4gICAgaWYgKHRoaXMucHJvbWlzZV8gPT09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBwcm9taXNlJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZV8udGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgcmV0dXJuIGRhdGEub2djU2VydmVycztcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uaGFzRWRpdGFibGVMYXllcnMgPSBmdW5jdGlvbiBoYXNFZGl0YWJsZUxheWVycygpIHtcbiAgICBpZiAodGhpcy5wcm9taXNlXyA9PT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHByb21pc2UnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXy50aGVuKHRoaXMuaGFzRWRpdGFibGVMYXllcnNfLmJpbmQodGhpcykpO1xuICB9O1xuXG4gIF9wcm90by5oYXNFZGl0YWJsZUxheWVyc18gPSBmdW5jdGlvbiBoYXNFZGl0YWJsZUxheWVyc18oZGF0YSkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgcmV0dXJuIGRhdGEudGhlbWVzLnNvbWUoZnVuY3Rpb24gKHRoZW1lKSB7XG4gICAgICB2YXIgaGFzRWRpdGFibGVMYXllcnMgPSB0aGVtZS5jaGlsZHJlbi5zb21lKF90aGlzMy5oYXNOb2RlRWRpdGFibGVMYXllcnNfLmJpbmQoX3RoaXMzKSk7XG4gICAgICByZXR1cm4gaGFzRWRpdGFibGVMYXllcnM7XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLmhhc05vZGVFZGl0YWJsZUxheWVyc18gPSBmdW5jdGlvbiBoYXNOb2RlRWRpdGFibGVMYXllcnNfKG5vZGUpIHtcbiAgICBpZiAobm9kZS5lZGl0YWJsZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgdmFyIGhhc0VkaXRhYmxlTGF5ZXJzID0gZmFsc2U7XG4gICAgdmFyIGNoaWxkcmVuID0gbm9kZS5jaGlsZHJlbjtcblxuICAgIGlmIChjaGlsZHJlbiAmJiBjaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgIGhhc0VkaXRhYmxlTGF5ZXJzID0gY2hpbGRyZW4uc29tZSh0aGlzLmhhc05vZGVFZGl0YWJsZUxheWVyc18uYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGhhc0VkaXRhYmxlTGF5ZXJzO1xuICB9O1xuXG4gIF9wcm90by5sb2FkVGhlbWVzID0gZnVuY3Rpb24gbG9hZFRoZW1lcyhvcHRfcm9sZUlkKSB7XG4gICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICBpZiAoIXRoaXMudHJlZVVybF8pIHtcbiAgICAgIHRocm93ICdnbWZUcmVlVXJsIHNob3VsZCBiZSBkZWZpbmVkLic7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubG9hZGVkKSB7XG4gICAgICB0aGlzLmRlZmVycmVkXyA9IHRoaXMuJHFfLmRlZmVyKCk7XG4gICAgICB0aGlzLnByb21pc2VfID0gdGhpcy5kZWZlcnJlZF8ucHJvbWlzZTtcbiAgICAgIHRoaXMuYmdMYXllclByb21pc2VfID0gbnVsbDtcbiAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhpcy4kaHR0cF8uZ2V0KHRoaXMudHJlZVVybF8sIHtcbiAgICAgIHBhcmFtczogb3B0X3JvbGVJZCAhPT0gdW5kZWZpbmVkID8ge1xuICAgICAgICAncm9sZSc6IG9wdF9yb2xlSWRcbiAgICAgIH0gOiB7fSxcbiAgICAgIGNhY2hlOiBmYWxzZSxcbiAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZVxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBpZiAocmVzcG9uc2UuZGF0YS5lcnJvcnMubGVuZ3RoICE9IDApIHtcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIlRoZSB0aGVtZXMgY29udGFpbiBzb21lIGVycm9yczpcXG5cIiArIHJlc3BvbnNlLmRhdGEuZXJyb3JzLmpvaW4oJ1xcbicpO1xuICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UpO1xuXG4gICAgICAgIGlmIChfdGhpczQubmdlb0xvY2F0aW9uXyAhPT0gbnVsbCAmJiBfdGhpczQubmdlb0xvY2F0aW9uXy5oYXNQYXJhbSgnZGVidWcnKSkge1xuICAgICAgICAgIHdpbmRvdy5hbGVydChtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBPYmplY3QudmFsdWVzKHJlc3BvbnNlLmRhdGEub2djU2VydmVycykuZm9yRWFjaChmdW5jdGlvbiAoc2VydmVyKSB7XG4gICAgICAgIHNlcnZlci5nZW9tZXRyeU5hbWUgPSBzZXJ2ZXIuZ2VvbWV0cnlOYW1lIHx8ICdnZW9tZXRyeSc7XG4gICAgICB9KTtcblxuICAgICAgX3RoaXM0LmRlZmVycmVkXy5yZXNvbHZlKHJlc3BvbnNlLmRhdGEpO1xuXG4gICAgICBfdGhpczQuZGlzcGF0Y2hFdmVudCgnY2hhbmdlJyk7XG5cbiAgICAgIF90aGlzNC5sb2FkZWQgPSB0cnVlO1xuICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgX3RoaXM0LmRlZmVycmVkXy5yZWplY3QocmVzcG9uc2UpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBUaGVtZXNTZXJ2aWNlO1xufShvbEV2ZW50c0V2ZW50VGFyZ2V0KTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kR3JvdXBCeUxheWVyTm9kZU5hbWUodGhlbWVzLCBuYW1lKSB7XG4gIGZvciAodmFyIGkgPSAwLCBpaSA9IHRoZW1lcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgdmFyIHRoZW1lID0gdGhlbWVzW2ldO1xuXG4gICAgZm9yICh2YXIgaiA9IDAsIGpqID0gdGhlbWUuY2hpbGRyZW4ubGVuZ3RoOyBqIDwgamo7IGorKykge1xuICAgICAgdmFyIGdyb3VwID0gdGhlbWUuY2hpbGRyZW5bal07XG4gICAgICB2YXIgY2hpbGROb2RlcyA9IFtdO1xuICAgICAgZ2V0RmxhdE5vZGVzKGdyb3VwLCBjaGlsZE5vZGVzKTtcblxuICAgICAgaWYgKGZpbmRPYmplY3RCeU5hbWUoY2hpbGROb2RlcywgbmFtZSkpIHtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRHcm91cEJ5TmFtZSh0aGVtZXMsIG5hbWUpIHtcbiAgZm9yICh2YXIgaSA9IDAsIGlpID0gdGhlbWVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICB2YXIgdGhlbWUgPSB0aGVtZXNbaV07XG5cbiAgICBmb3IgKHZhciBqID0gMCwgamogPSB0aGVtZS5jaGlsZHJlbi5sZW5ndGg7IGogPCBqajsgaisrKSB7XG4gICAgICB2YXIgZ3JvdXAgPSB0aGVtZS5jaGlsZHJlbltqXTtcbiAgICAgIHZhciBpbnRlcm5hbE5vZGVzID0gW107XG4gICAgICBnZXRGbGF0SW50ZXJuYWxOb2Rlcyhncm91cCwgaW50ZXJuYWxOb2Rlcyk7XG5cbiAgICAgIGlmIChmaW5kT2JqZWN0QnlOYW1lKGludGVybmFsTm9kZXMsIG5hbWUpKSB7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmaW5kT2JqZWN0QnlOYW1lKG9iamVjdHMsIG9iamVjdE5hbWUpIHtcbiAgcmV0dXJuIG9sQXJyYXkuZmluZChvYmplY3RzLCBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgcmV0dXJuIG9iamVjdC5uYW1lID09PSBvYmplY3ROYW1lO1xuICB9KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmaW5kVGhlbWVCeU5hbWUodGhlbWVzLCB0aGVtZU5hbWUpIHtcbiAgcmV0dXJuIGZpbmRPYmplY3RCeU5hbWUodGhlbWVzLCB0aGVtZU5hbWUpO1xufVxuXG5mdW5jdGlvbiBnZXRGbGF0SW50ZXJuYWxOb2Rlcyhub2RlLCBub2Rlcykge1xuICB2YXIgY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuO1xuXG4gIGlmIChjaGlsZHJlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgbm9kZXMucHVzaChub2RlKTtcblxuICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGNoaWxkcmVuLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kyID0gMCwgX2l0ZXJhdG9yID0gX2lzQXJyYXkgPyBfaXRlcmF0b3IgOiBfaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgIHZhciBfcmVmO1xuXG4gICAgICBpZiAoX2lzQXJyYXkpIHtcbiAgICAgICAgaWYgKF9pMiA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaTIrK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaTIgPSBfaXRlcmF0b3IubmV4dCgpO1xuICAgICAgICBpZiAoX2kyLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmID0gX2kyLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2hpbGQgPSBfcmVmO1xuICAgICAgZ2V0RmxhdEludGVybmFsTm9kZXMoY2hpbGQsIG5vZGVzKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZsYXROb2Rlcyhub2RlLCBub2Rlcykge1xuICB2YXIgY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuO1xuXG4gIGlmIChjaGlsZHJlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IGNoaWxkcmVuLCBfaXNBcnJheTIgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjIpLCBfaTMgPSAwLCBfaXRlcmF0b3IyID0gX2lzQXJyYXkyID8gX2l0ZXJhdG9yMiA6IF9pdGVyYXRvcjJbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgIHZhciBfcmVmMjtcblxuICAgICAgaWYgKF9pc0FycmF5Mikge1xuICAgICAgICBpZiAoX2kzID49IF9pdGVyYXRvcjIubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZjIgPSBfaXRlcmF0b3IyW19pMysrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pMyA9IF9pdGVyYXRvcjIubmV4dCgpO1xuICAgICAgICBpZiAoX2kzLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmMiA9IF9pMy52YWx1ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIGNoaWxkID0gX3JlZjI7XG4gICAgICBnZXRGbGF0Tm9kZXMoY2hpbGQsIG5vZGVzKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbm9kZXMucHVzaChub2RlKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFNuYXBwaW5nQ29uZmlnKG5vZGUpIHtcbiAgdmFyIGNvbmZpZyA9IG5vZGUubWV0YWRhdGEgJiYgbm9kZS5tZXRhZGF0YS5zbmFwcGluZ0NvbmZpZyAhPT0gdW5kZWZpbmVkID8gbm9kZS5tZXRhZGF0YS5zbmFwcGluZ0NvbmZpZyA6IG51bGw7XG5cbiAgaWYgKGNvbmZpZyAmJiBjb25maWcuYWN0aXZhdGVkID09PSB1bmRlZmluZWQpIHtcbiAgICBjb25maWcuYWN0aXZhdGVkID0gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiBjb25maWc7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0Tm9kZU1heFJlc29sdXRpb24oZ21mTGF5ZXIpIHtcbiAgdmFyIG1ldGFkYXRhID0gZ21mTGF5ZXIubWV0YWRhdGE7XG4gIHZhciBtYXhSZXNvbHV0aW9uID0gZ21mTGF5ZXIubWF4UmVzb2x1dGlvbkhpbnQ7XG5cbiAgaWYgKG1heFJlc29sdXRpb24gPT09IHVuZGVmaW5lZCAmJiBtZXRhZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgbWF4UmVzb2x1dGlvbiA9IG1ldGFkYXRhLm1heFJlc29sdXRpb247XG4gIH1cblxuICByZXR1cm4gbWF4UmVzb2x1dGlvbjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXROb2RlTWluUmVzb2x1dGlvbihnbWZMYXllcikge1xuICB2YXIgbWV0YWRhdGEgPSBnbWZMYXllci5tZXRhZGF0YTtcbiAgdmFyIG1pblJlc29sdXRpb24gPSBnbWZMYXllci5taW5SZXNvbHV0aW9uSGludDtcblxuICBpZiAobWluUmVzb2x1dGlvbiA9PT0gdW5kZWZpbmVkICYmIG1ldGFkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICBtaW5SZXNvbHV0aW9uID0gbWV0YWRhdGEubWluUmVzb2x1dGlvbjtcbiAgfVxuXG4gIHJldHVybiBtaW5SZXNvbHV0aW9uO1xufVxuZXhwb3J0IHZhciBUaGVtZU5vZGVUeXBlID0ge1xuICBNSVhFRF9HUk9VUDogJ01peGVkR3JvdXAnLFxuICBOT1RfTUlYRURfR1JPVVA6ICdOb3RNaXhlZEdyb3VwJyxcbiAgV01UUzogJ1dNVFMnLFxuICBXTVM6ICdXTVMnXG59O1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZUaGVtZXMnLCBbbmdlb01hcExheWVySGVscGVyLm5hbWVdKTtcbm1vZHVsZS52YWx1ZSgnZ21mVGhlbWVzT3B0aW9ucycsIHt9KTtcbm1vZHVsZS5zZXJ2aWNlKCdnbWZUaGVtZXMnLCBUaGVtZXNTZXJ2aWNlKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBnbWZUaGVtZU1hbmFnZXIgZnJvbSAnZ21mL3RoZW1lL01hbmFnZXIuanMnO1xuaW1wb3J0IGdtZlRoZW1lU2VsZWN0b3JDb21wb25lbnQgZnJvbSAnZ21mL3RoZW1lL3NlbGVjdG9yQ29tcG9uZW50LmpzJztcbmltcG9ydCBnbWZUaGVtZVRoZW1lcyBmcm9tICdnbWYvdGhlbWUvVGhlbWVzLmpzJztcbmV4cG9ydCBkZWZhdWx0IGFuZ3VsYXIubW9kdWxlKCdnbWZUaGVtZU1vZHVsZScsIFtnbWZUaGVtZVNlbGVjdG9yQ29tcG9uZW50Lm5hbWUsIGdtZlRoZW1lTWFuYWdlci5uYW1lLCBnbWZUaGVtZVRoZW1lcy5uYW1lXSk7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPHVsIGNsYXNzPVwiZ21mLXRoZW1lLXNlbGVjdG9yXCI+XFxuICA8bGlcXG4gICAgICBuZy1yZXBlYXQ9XCJ0aGVtZSBpbiAkY3RybC50aGVtZXNcIlxcbiAgICAgIG5nLWNsaWNrPVwiJGN0cmwuc2V0VGhlbWUodGhlbWUpXCJcXG4gICAgICBuZy1jbGFzcz1cIntcXCdnbWYtdGhlbWUtc2VsZWN0b3ItYWN0aXZlXFwnOiAkY3RybC5nbWZUaGVtZU1hbmFnZXIuZ2V0VGhlbWVOYW1lKCkgPT0gdGhlbWUubmFtZX1cIj5cXG4gICAgPGltZyBjbGFzcz1cImdtZi10aHVtYlwiXFxuICAgICAgICAgbmctc3JjPVwie3s6OnRoZW1lLmljb259fVwiIC8+XFxuICAgIDxzcGFuIGNsYXNzPVwiZ21mLXRleHRcIj57e3RoZW1lLm5hbWUgfCB0cmFuc2xhdGV9fTwvc3Bhbj5cXG4gIDwvbGk+XFxuPC91bD5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiZ21mVGhlbWVNYW5hZ2VyXCIsIFwiZ21mVGhlbWVzXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgZ21mVGhlbWVNYW5hZ2VyIGZyb20gJ2dtZi90aGVtZS9NYW5hZ2VyLmpzJztcbmltcG9ydCBnbWZUaGVtZVRoZW1lcyBmcm9tICdnbWYvdGhlbWUvVGhlbWVzLmpzJztcbmltcG9ydCB7IGxpc3RlbiwgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvZHJvcGRvd24uanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdnbWZUaGVtZVNlbGVjdG9yQ29tcG9uZW50JywgW2dtZlRoZW1lTWFuYWdlci5uYW1lLCBnbWZUaGVtZVRoZW1lcy5uYW1lXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2dtZi90aGVtZS9zZWxlY3RvckNvbXBvbmVudCcsIHJlcXVpcmUoJy4vc2VsZWN0b3JDb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcbm1vZHVsZS52YWx1ZSgnZ21mVGhlbWVTZWxlY3RvclRlbXBsYXRlVXJsJywgZnVuY3Rpb24gKCRhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSAkYXR0cnMuZ21mVGhlbWVTZWxlY3RvclRlbXBsYXRlVXJsO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ2dtZi90aGVtZS9zZWxlY3RvckNvbXBvbmVudCc7XG59KTtcbmdtZlRoZW1lU2VsZWN0b3JUZW1wbGF0ZVVybC4kaW5qZWN0ID0gW1wiJGF0dHJzXCIsIFwiZ21mVGhlbWVTZWxlY3RvclRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBnbWZUaGVtZVNlbGVjdG9yVGVtcGxhdGVVcmwoJGF0dHJzLCBnbWZUaGVtZVNlbGVjdG9yVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIGdtZlRoZW1lU2VsZWN0b3JUZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG52YXIgdGhlbWVTZWxlY3RvckNvbXBvbmVudCA9IHtcbiAgYmluZGluZ3M6IHtcbiAgICAnZmlsdGVyJzogJzxnbWZUaGVtZXNlbGVjdG9yRmlsdGVyJ1xuICB9LFxuICBjb250cm9sbGVyOiAnZ21mVGhlbWVzZWxlY3RvckNvbnRyb2xsZXInLFxuICB0ZW1wbGF0ZVVybDogZ21mVGhlbWVTZWxlY3RvclRlbXBsYXRlVXJsXG59O1xubW9kdWxlLmNvbXBvbmVudCgnZ21mVGhlbWVzZWxlY3RvcicsIHRoZW1lU2VsZWN0b3JDb21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKCRzY29wZSwgZ21mVGhlbWVNYW5hZ2VyLCBnbWZUaGVtZXMpIHtcbiAgdGhpcy5nbWZUaGVtZU1hbmFnZXIgPSBnbWZUaGVtZU1hbmFnZXI7XG4gIHRoaXMuZ21mVGhlbWVzXyA9IGdtZlRoZW1lcztcbiAgdGhpcy50aGVtZXMgPSBbXTtcblxuICB0aGlzLmZpbHRlciA9IGZ1bmN0aW9uICh0aGVtZSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH07XG5cbiAgdGhpcy5saXN0ZW5lcktleXNfID0gW107XG4gIHRoaXMubGlzdGVuZXJLZXlzXy5wdXNoKGxpc3Rlbih0aGlzLmdtZlRoZW1lc18sICdjaGFuZ2UnLCB0aGlzLnNldFRoZW1lc18sIHRoaXMpKTtcbiAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCB0aGlzLmhhbmRsZURlc3Ryb3lfLmJpbmQodGhpcykpO1xufVxuXG5Db250cm9sbGVyLnByb3RvdHlwZS5zZXRUaGVtZXNfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHRoaXMuZ21mVGhlbWVzXy5nZXRUaGVtZXNPYmplY3QoKS50aGVuKGZ1bmN0aW9uICh0aGVtZXMpIHtcbiAgICBfdGhpcy50aGVtZXMgPSBfdGhpcy5maWx0ZXIgPyB0aGVtZXMuZmlsdGVyKF90aGlzLmZpbHRlcikgOiB0aGVtZXM7XG4gIH0pO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuc2V0VGhlbWUgPSBmdW5jdGlvbiAodGhlbWUsIG9wdF9zaWxlbnQpIHtcbiAgaWYgKHRoZW1lKSB7XG4gICAgdGhpcy5nbWZUaGVtZU1hbmFnZXIuYWRkVGhlbWUodGhlbWUsIG9wdF9zaWxlbnQpO1xuICB9XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVEZXN0cm95XyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5saXN0ZW5lcktleXNfLmZvckVhY2godW5saXN0ZW5CeUtleSk7XG4gIHRoaXMubGlzdGVuZXJLZXlzXy5sZW5ndGggPSAwO1xufTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ2dtZlRoZW1lc2VsZWN0b3JDb250cm9sbGVyJywgQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IHNvbWVyYyBmcm9tICcuL3NvbWVyYy5qcyc7XG5pbXBvcnQgeyBjcmVhdGUgfSBmcm9tICcuL3V0aWxzLmpzJztcbmV4cG9ydCB2YXIgY29kZSA9ICdFUFNHOjIwNTYnO1xudmFyIGRlZiA9IFwiXFxuICArcHJvaj1cIiArIHNvbWVyYyArIFwiXFxuICArbGF0XzA9NDYuOTUyNDA1NTU1NTU1NTZcXG4gICtsb25fMD03LjQzOTU4MzMzMzMzMzMzM1xcbiAgK2tfMD0xXFxuICAreF8wPTI2MDAwMDBcXG4gICt5XzA9MTIwMDAwMFxcbiAgK2VsbHBzPWJlc3NlbFxcbiAgK3Rvd2dzODQ9Njc0LjM3NCwxNS4wNTYsNDA1LjM0NiwwLDAsMCwwXFxuICArdW5pdHM9bVxcbiAgK25vX2RlZnNcXG5cIjtcbnZhciBleHRlbnQgPSBbMjQyMDAwMCwgMTAzMDAwMCwgMjkwMDAwMCwgMTM1MDAwMF07XG5leHBvcnQgdmFyIHByb2ogPSBjcmVhdGUoY29kZSwgZGVmLCBleHRlbnQpO1xuZXhwb3J0IGRlZmF1bHQgY29kZTsiLCIvKipcbiAqIGZsb2F0VGhlYWQgd3JhcHBlciBmb3IgQW5ndWxhckpTXG4gKiBAdmVyc2lvbiB2MC4xLjAgLSAyMDE1LTEwLTI1XG4gKiBAbGluayBodHRwczovL2dpdGh1Yi5jb20vYnJhbmRvbi1iYXJrZXIvYW5ndWxhci1mbG9hdFRoZWFkXG4gKiBAYXV0aG9yIEJyYW5kb24gQmFya2VyXG4gKiBAbGljZW5zZSBNSVQgTGljZW5zZSwgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdmbG9hdFRoZWFkJywgW10pLmRpcmVjdGl2ZSgnZmxvYXRUaGVhZCcsIFsnJHRpbWVvdXQnLCAnJGxvZycsIGZsb2F0VGhlYWRdKTtcblxuICBmdW5jdGlvbiBmbG9hdFRoZWFkKCR0aW1lb3V0LCAkbG9nKSB7XG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXG4gICAgICBzY29wZToge1xuICAgICAgICBmbG9hdFRoZWFkOiAnPT8nLFxuICAgICAgICBmbG9hdFRoZWFkRW5hYmxlZDogJz0/J1xuICAgICAgfSxcbiAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRlbGVtZW50JywgJyRhdHRycycsIGZ1bmN0aW9uICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgICAgaWYgKCEkYXR0cnMuaGFzT3duUHJvcGVydHkoJ2Zsb2F0VGhlYWRFbmFibGVkJykpIHtcbiAgICAgICAgICAkc2NvcGUuZmxvYXRUaGVhZEVuYWJsZWQgPSAkYXR0cnMuZmxvYXRUaGVhZEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCEkYXR0cnMuaGFzT3duUHJvcGVydHkoJ2Zsb2F0VGhlYWQnKSB8fCAkYXR0cnMuZmxvYXRUaGVhZCA9PT0gJycpIHtcbiAgICAgICAgICAkc2NvcGUuZmxvYXRUaGVhZCA9ICRhdHRycy5mbG9hdFRoZWFkID0ge307XG4gICAgICAgIH1cbiAgICAgIH1dLFxuICAgICAgbGluazogbGluayxcbiAgICAgIHJlc3RyaWN0OiAnQSdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgbmdNb2RlbCkge1xuICAgICAgJHNjb3BlLiR3YXRjaCgnZmxvYXRUaGVhZEVuYWJsZWQnLCBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgICAgIGlmIChuZXdWYWwgPT09IHRydWUpIHtcbiAgICAgICAgICBpZiAoYW5ndWxhci5pc09iamVjdCgkc2NvcGUuZmxvYXRUaGVhZCkpIHtcbiAgICAgICAgICAgIGpRdWVyeSgkZWxlbWVudCkuZmxvYXRUaGVhZCgkc2NvcGUuZmxvYXRUaGVhZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGpRdWVyeSgkZWxlbWVudCkuZmxvYXRUaGVhZCgnZGVzdHJveScpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgICRzY29wZS4kd2F0Y2goJ2Zsb2F0VGhlYWQnLCBmdW5jdGlvbiAobmV3VmFsLCBvbGRWYWwpIHtcbiAgICAgICAgaWYgKG5ld1ZhbCA9PT0gb2xkVmFsIHx8ICEkc2NvcGUuZmxvYXRUaGVhZEVuYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBqUXVlcnkoJGVsZW1lbnQpLmZsb2F0VGhlYWQoJ2Rlc3Ryb3knKTtcblxuICAgICAgICBpZiAoYW5ndWxhci5pc09iamVjdChuZXdWYWwpKSB7XG4gICAgICAgICAgalF1ZXJ5KCRlbGVtZW50KS5mbG9hdFRoZWFkKG5ld1ZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0sIHRydWUpO1xuXG4gICAgICBpZiAobmdNb2RlbCkge1xuICAgICAgICBuZ01vZGVsLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICgkc2NvcGUuZmxvYXRUaGVhZEVuYWJsZWQgJiYgYW5ndWxhci5pc09iamVjdCgkc2NvcGUuZmxvYXRUaGVhZCkpIHtcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgalF1ZXJ5KCRlbGVtZW50KS5mbG9hdFRoZWFkKCdyZWZsb3cnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkbG9nLmluZm8oJ2Zsb2F0VGhlYWQ6IG5nTW9kZWwgbm90IHByb3ZpZGVkIScpO1xuICAgICAgfVxuXG4gICAgICAkZWxlbWVudC5iaW5kKCd1cGRhdGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBqUXVlcnkoJGVsZW1lbnQpLmZsb2F0VGhlYWQoJ3JlZmxvdycpO1xuICAgICAgICB9LCAwKTtcbiAgICAgIH0pO1xuICAgICAgJGVsZW1lbnQuYmluZCgnJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGpRdWVyeSgkZWxlbWVudCkuZmxvYXRUaGVhZCgnZGVzdHJveScpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpOyIsIihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW1wianF1ZXJ5XCJdLCBmdW5jdGlvbiAoYTApIHtcbiAgICAgIHJldHVybiByb290W1wiQmxvb2Rob3VuZFwiXSA9IGZhY3RvcnkoYTApO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcImpxdWVyeVwiKSk7XG4gIH0gZWxzZSB7XG4gICAgcm9vdFtcIkJsb29kaG91bmRcIl0gPSBmYWN0b3J5KHJvb3RbXCJqUXVlcnlcIl0pO1xuICB9XG59KSh0aGlzLCBmdW5jdGlvbiAoJCkge1xuICB2YXIgXyA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHJldHVybiB7XG4gICAgICBpc01zaWU6IGZ1bmN0aW9uIGlzTXNpZSgpIHtcbiAgICAgICAgcmV0dXJuIC8obXNpZXx0cmlkZW50KS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgPyBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC8obXNpZSB8cnY6KShcXGQrKC5cXGQrKT8pL2kpWzJdIDogZmFsc2U7XG4gICAgICB9LFxuICAgICAgaXNCbGFua1N0cmluZzogZnVuY3Rpb24gaXNCbGFua1N0cmluZyhzdHIpIHtcbiAgICAgICAgcmV0dXJuICFzdHIgfHwgL15cXHMqJC8udGVzdChzdHIpO1xuICAgICAgfSxcbiAgICAgIGVzY2FwZVJlZ0V4Q2hhcnM6IGZ1bmN0aW9uIGVzY2FwZVJlZ0V4Q2hhcnMoc3RyKSB7XG4gICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvW1xcLVxcW1xcXVxcL1xce1xcfVxcKFxcKVxcKlxcK1xcP1xcLlxcXFxcXF5cXCRcXHxdL2csIFwiXFxcXCQmXCIpO1xuICAgICAgfSxcbiAgICAgIGlzU3RyaW5nOiBmdW5jdGlvbiBpc1N0cmluZyhvYmopIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT09IFwic3RyaW5nXCI7XG4gICAgICB9LFxuICAgICAgaXNOdW1iZXI6IGZ1bmN0aW9uIGlzTnVtYmVyKG9iaikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gXCJudW1iZXJcIjtcbiAgICAgIH0sXG4gICAgICBpc0FycmF5OiAkLmlzQXJyYXksXG4gICAgICBpc0Z1bmN0aW9uOiAkLmlzRnVuY3Rpb24sXG4gICAgICBpc09iamVjdDogJC5pc1BsYWluT2JqZWN0LFxuICAgICAgaXNVbmRlZmluZWQ6IGZ1bmN0aW9uIGlzVW5kZWZpbmVkKG9iaikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIjtcbiAgICAgIH0sXG4gICAgICBpc0VsZW1lbnQ6IGZ1bmN0aW9uIGlzRWxlbWVudChvYmopIHtcbiAgICAgICAgcmV0dXJuICEhKG9iaiAmJiBvYmoubm9kZVR5cGUgPT09IDEpO1xuICAgICAgfSxcbiAgICAgIGlzSlF1ZXJ5OiBmdW5jdGlvbiBpc0pRdWVyeShvYmopIHtcbiAgICAgICAgcmV0dXJuIG9iaiBpbnN0YW5jZW9mICQ7XG4gICAgICB9LFxuICAgICAgdG9TdHI6IGZ1bmN0aW9uIHRvU3RyKHMpIHtcbiAgICAgICAgcmV0dXJuIF8uaXNVbmRlZmluZWQocykgfHwgcyA9PT0gbnVsbCA/IFwiXCIgOiBzICsgXCJcIjtcbiAgICAgIH0sXG4gICAgICBiaW5kOiAkLnByb3h5LFxuICAgICAgZWFjaDogZnVuY3Rpb24gZWFjaChjb2xsZWN0aW9uLCBjYikge1xuICAgICAgICAkLmVhY2goY29sbGVjdGlvbiwgcmV2ZXJzZUFyZ3MpO1xuXG4gICAgICAgIGZ1bmN0aW9uIHJldmVyc2VBcmdzKGluZGV4LCB2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiBjYih2YWx1ZSwgaW5kZXgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgbWFwOiAkLm1hcCxcbiAgICAgIGZpbHRlcjogJC5ncmVwLFxuICAgICAgZXZlcnk6IGZ1bmN0aW9uIGV2ZXJ5KG9iaiwgdGVzdCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcblxuICAgICAgICBpZiAoIW9iaikge1xuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAkLmVhY2gob2JqLCBmdW5jdGlvbiAoa2V5LCB2YWwpIHtcbiAgICAgICAgICBpZiAoIShyZXN1bHQgPSB0ZXN0LmNhbGwobnVsbCwgdmFsLCBrZXksIG9iaikpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICEhcmVzdWx0O1xuICAgICAgfSxcbiAgICAgIHNvbWU6IGZ1bmN0aW9uIHNvbWUob2JqLCB0ZXN0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBmYWxzZTtcblxuICAgICAgICBpZiAoIW9iaikge1xuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAkLmVhY2gob2JqLCBmdW5jdGlvbiAoa2V5LCB2YWwpIHtcbiAgICAgICAgICBpZiAocmVzdWx0ID0gdGVzdC5jYWxsKG51bGwsIHZhbCwga2V5LCBvYmopKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICEhcmVzdWx0O1xuICAgICAgfSxcbiAgICAgIG1peGluOiAkLmV4dGVuZCxcbiAgICAgIGlkZW50aXR5OiBmdW5jdGlvbiBpZGVudGl0eSh4KSB7XG4gICAgICAgIHJldHVybiB4O1xuICAgICAgfSxcbiAgICAgIGNsb25lOiBmdW5jdGlvbiBjbG9uZShvYmopIHtcbiAgICAgICAgcmV0dXJuICQuZXh0ZW5kKHRydWUsIHt9LCBvYmopO1xuICAgICAgfSxcbiAgICAgIGdldElkR2VuZXJhdG9yOiBmdW5jdGlvbiBnZXRJZEdlbmVyYXRvcigpIHtcbiAgICAgICAgdmFyIGNvdW50ZXIgPSAwO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBjb3VudGVyKys7XG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgdGVtcGxhdGlmeTogZnVuY3Rpb24gdGVtcGxhdGlmeShvYmopIHtcbiAgICAgICAgcmV0dXJuICQuaXNGdW5jdGlvbihvYmopID8gb2JqIDogdGVtcGxhdGU7XG5cbiAgICAgICAgZnVuY3Rpb24gdGVtcGxhdGUoKSB7XG4gICAgICAgICAgcmV0dXJuIFN0cmluZyhvYmopO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVmZXI6IGZ1bmN0aW9uIGRlZmVyKGZuKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZm4sIDApO1xuICAgICAgfSxcbiAgICAgIGRlYm91bmNlOiBmdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHtcbiAgICAgICAgdmFyIHRpbWVvdXQsIHJlc3VsdDtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMsXG4gICAgICAgICAgICAgIGFyZ3MgPSBhcmd1bWVudHMsXG4gICAgICAgICAgICAgIGxhdGVyLFxuICAgICAgICAgICAgICBjYWxsTm93O1xuXG4gICAgICAgICAgbGF0ZXIgPSBmdW5jdGlvbiBsYXRlcigpIHtcbiAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAoIWltbWVkaWF0ZSkge1xuICAgICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7XG5cbiAgICAgICAgICBpZiAoY2FsbE5vdykge1xuICAgICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHRocm90dGxlOiBmdW5jdGlvbiB0aHJvdHRsZShmdW5jLCB3YWl0KSB7XG4gICAgICAgIHZhciBjb250ZXh0LCBhcmdzLCB0aW1lb3V0LCByZXN1bHQsIHByZXZpb3VzLCBsYXRlcjtcbiAgICAgICAgcHJldmlvdXMgPSAwO1xuXG4gICAgICAgIGxhdGVyID0gZnVuY3Rpb24gbGF0ZXIoKSB7XG4gICAgICAgICAgcHJldmlvdXMgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgcmVtYWluaW5nID0gd2FpdCAtIChub3cgLSBwcmV2aW91cyk7XG4gICAgICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgICAgICAgYXJncyA9IGFyZ3VtZW50cztcblxuICAgICAgICAgIGlmIChyZW1haW5pbmcgPD0gMCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgICAgICBwcmV2aW91cyA9IG5vdztcbiAgICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgfSBlbHNlIGlmICghdGltZW91dCkge1xuICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHJlbWFpbmluZyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICBzdHJpbmdpZnk6IGZ1bmN0aW9uIHN0cmluZ2lmeSh2YWwpIHtcbiAgICAgICAgcmV0dXJuIF8uaXNTdHJpbmcodmFsKSA/IHZhbCA6IEpTT04uc3RyaW5naWZ5KHZhbCk7XG4gICAgICB9LFxuICAgICAgZ3VpZDogZnVuY3Rpb24gZ3VpZCgpIHtcbiAgICAgICAgZnVuY3Rpb24gX3A4KHMpIHtcbiAgICAgICAgICB2YXIgcCA9IChNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KSArIFwiMDAwMDAwMDAwXCIpLnN1YnN0cigyLCA4KTtcbiAgICAgICAgICByZXR1cm4gcyA/IFwiLVwiICsgcC5zdWJzdHIoMCwgNCkgKyBcIi1cIiArIHAuc3Vic3RyKDQsIDQpIDogcDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBcInR0LVwiICsgX3A4KCkgKyBfcDgodHJ1ZSkgKyBfcDgodHJ1ZSkgKyBfcDgoKTtcbiAgICAgIH0sXG4gICAgICBub29wOiBmdW5jdGlvbiBub29wKCkge31cbiAgICB9O1xuICB9KCk7XG5cbiAgdmFyIFZFUlNJT04gPSBcIjEuMy4wXCI7XG5cbiAgdmFyIHRva2VuaXplcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICByZXR1cm4ge1xuICAgICAgbm9ud29yZDogbm9ud29yZCxcbiAgICAgIHdoaXRlc3BhY2U6IHdoaXRlc3BhY2UsXG4gICAgICBuZ3JhbTogbmdyYW0sXG4gICAgICBvYmo6IHtcbiAgICAgICAgbm9ud29yZDogZ2V0T2JqVG9rZW5pemVyKG5vbndvcmQpLFxuICAgICAgICB3aGl0ZXNwYWNlOiBnZXRPYmpUb2tlbml6ZXIod2hpdGVzcGFjZSksXG4gICAgICAgIG5ncmFtOiBnZXRPYmpUb2tlbml6ZXIobmdyYW0pXG4gICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHdoaXRlc3BhY2Uoc3RyKSB7XG4gICAgICBzdHIgPSBfLnRvU3RyKHN0cik7XG4gICAgICByZXR1cm4gc3RyID8gc3RyLnNwbGl0KC9cXHMrLykgOiBbXTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBub253b3JkKHN0cikge1xuICAgICAgc3RyID0gXy50b1N0cihzdHIpO1xuICAgICAgcmV0dXJuIHN0ciA/IHN0ci5zcGxpdCgvXFxXKy8pIDogW107XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmdyYW0oc3RyKSB7XG4gICAgICBzdHIgPSBfLnRvU3RyKHN0cik7XG4gICAgICB2YXIgdG9rZW5zID0gW10sXG4gICAgICAgICAgd29yZCA9IFwiXCI7XG5cbiAgICAgIF8uZWFjaChzdHIuc3BsaXQoXCJcIiksIGZ1bmN0aW9uIChjaGFyKSB7XG4gICAgICAgIGlmIChjaGFyLm1hdGNoKC9cXHMrLykpIHtcbiAgICAgICAgICB3b3JkID0gXCJcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0b2tlbnMucHVzaCh3b3JkICsgY2hhcik7XG4gICAgICAgICAgd29yZCArPSBjaGFyO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHRva2VucztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRPYmpUb2tlbml6ZXIodG9rZW5pemVyKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gc2V0S2V5KGtleXMpIHtcbiAgICAgICAga2V5cyA9IF8uaXNBcnJheShrZXlzKSA/IGtleXMgOiBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiB0b2tlbml6ZShvKSB7XG4gICAgICAgICAgdmFyIHRva2VucyA9IFtdO1xuXG4gICAgICAgICAgXy5lYWNoKGtleXMsIGZ1bmN0aW9uIChrKSB7XG4gICAgICAgICAgICB0b2tlbnMgPSB0b2tlbnMuY29uY2F0KHRva2VuaXplcihfLnRvU3RyKG9ba10pKSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXR1cm4gdG9rZW5zO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9XG4gIH0oKTtcblxuICB2YXIgTHJ1Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBmdW5jdGlvbiBMcnVDYWNoZShtYXhTaXplKSB7XG4gICAgICB0aGlzLm1heFNpemUgPSBfLmlzTnVtYmVyKG1heFNpemUpID8gbWF4U2l6ZSA6IDEwMDtcbiAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgaWYgKHRoaXMubWF4U2l6ZSA8PSAwKSB7XG4gICAgICAgIHRoaXMuc2V0ID0gdGhpcy5nZXQgPSAkLm5vb3A7XG4gICAgICB9XG4gICAgfVxuXG4gICAgXy5taXhpbihMcnVDYWNoZS5wcm90b3R5cGUsIHtcbiAgICAgIHNldDogZnVuY3Rpb24gc2V0KGtleSwgdmFsKSB7XG4gICAgICAgIHZhciB0YWlsSXRlbSA9IHRoaXMubGlzdC50YWlsLFxuICAgICAgICAgICAgbm9kZTtcblxuICAgICAgICBpZiAodGhpcy5zaXplID49IHRoaXMubWF4U2l6ZSkge1xuICAgICAgICAgIHRoaXMubGlzdC5yZW1vdmUodGFpbEl0ZW0pO1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLmhhc2hbdGFpbEl0ZW0ua2V5XTtcbiAgICAgICAgICB0aGlzLnNpemUtLTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChub2RlID0gdGhpcy5oYXNoW2tleV0pIHtcbiAgICAgICAgICBub2RlLnZhbCA9IHZhbDtcbiAgICAgICAgICB0aGlzLmxpc3QubW92ZVRvRnJvbnQobm9kZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm9kZSA9IG5ldyBOb2RlKGtleSwgdmFsKTtcbiAgICAgICAgICB0aGlzLmxpc3QuYWRkKG5vZGUpO1xuICAgICAgICAgIHRoaXMuaGFzaFtrZXldID0gbm9kZTtcbiAgICAgICAgICB0aGlzLnNpemUrKztcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGtleSkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuaGFzaFtrZXldO1xuXG4gICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgdGhpcy5saXN0Lm1vdmVUb0Zyb250KG5vZGUpO1xuICAgICAgICAgIHJldHVybiBub2RlLnZhbDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgdGhpcy5zaXplID0gMDtcbiAgICAgICAgdGhpcy5oYXNoID0ge307XG4gICAgICAgIHRoaXMubGlzdCA9IG5ldyBMaXN0KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBMaXN0KCkge1xuICAgICAgdGhpcy5oZWFkID0gdGhpcy50YWlsID0gbnVsbDtcbiAgICB9XG5cbiAgICBfLm1peGluKExpc3QucHJvdG90eXBlLCB7XG4gICAgICBhZGQ6IGZ1bmN0aW9uIGFkZChub2RlKSB7XG4gICAgICAgIGlmICh0aGlzLmhlYWQpIHtcbiAgICAgICAgICBub2RlLm5leHQgPSB0aGlzLmhlYWQ7XG4gICAgICAgICAgdGhpcy5oZWFkLnByZXYgPSBub2RlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5oZWFkID0gbm9kZTtcbiAgICAgICAgdGhpcy50YWlsID0gdGhpcy50YWlsIHx8IG5vZGU7XG4gICAgICB9LFxuICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUobm9kZSkge1xuICAgICAgICBub2RlLnByZXYgPyBub2RlLnByZXYubmV4dCA9IG5vZGUubmV4dCA6IHRoaXMuaGVhZCA9IG5vZGUubmV4dDtcbiAgICAgICAgbm9kZS5uZXh0ID8gbm9kZS5uZXh0LnByZXYgPSBub2RlLnByZXYgOiB0aGlzLnRhaWwgPSBub2RlLnByZXY7XG4gICAgICB9LFxuICAgICAgbW92ZVRvRnJvbnQ6IGZ1bmN0aW9uIG1vdmVUb0Zyb250KG5vZGUpIHtcbiAgICAgICAgdGhpcy5yZW1vdmUobm9kZSk7XG4gICAgICAgIHRoaXMuYWRkKG5vZGUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gTm9kZShrZXksIHZhbCkge1xuICAgICAgdGhpcy5rZXkgPSBrZXk7XG4gICAgICB0aGlzLnZhbCA9IHZhbDtcbiAgICAgIHRoaXMucHJldiA9IHRoaXMubmV4dCA9IG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIExydUNhY2hlO1xuICB9KCk7XG5cbiAgdmFyIFBlcnNpc3RlbnRTdG9yYWdlID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgdmFyIExPQ0FMX1NUT1JBR0U7XG5cbiAgICB0cnkge1xuICAgICAgTE9DQUxfU1RPUkFHRSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2U7XG4gICAgICBMT0NBTF9TVE9SQUdFLnNldEl0ZW0oXCJ+fn5cIiwgXCIhXCIpO1xuICAgICAgTE9DQUxfU1RPUkFHRS5yZW1vdmVJdGVtKFwifn5+XCIpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgTE9DQUxfU1RPUkFHRSA9IG51bGw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gUGVyc2lzdGVudFN0b3JhZ2UobmFtZXNwYWNlLCBvdmVycmlkZSkge1xuICAgICAgdGhpcy5wcmVmaXggPSBbXCJfX1wiLCBuYW1lc3BhY2UsIFwiX19cIl0uam9pbihcIlwiKTtcbiAgICAgIHRoaXMudHRsS2V5ID0gXCJfX3R0bF9fXCI7XG4gICAgICB0aGlzLmtleU1hdGNoZXIgPSBuZXcgUmVnRXhwKFwiXlwiICsgXy5lc2NhcGVSZWdFeENoYXJzKHRoaXMucHJlZml4KSk7XG4gICAgICB0aGlzLmxzID0gb3ZlcnJpZGUgfHwgTE9DQUxfU1RPUkFHRTtcbiAgICAgICF0aGlzLmxzICYmIHRoaXMuX25vb3AoKTtcbiAgICB9XG5cbiAgICBfLm1peGluKFBlcnNpc3RlbnRTdG9yYWdlLnByb3RvdHlwZSwge1xuICAgICAgX3ByZWZpeDogZnVuY3Rpb24gX3ByZWZpeChrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJlZml4ICsga2V5O1xuICAgICAgfSxcbiAgICAgIF90dGxLZXk6IGZ1bmN0aW9uIF90dGxLZXkoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcmVmaXgoa2V5KSArIHRoaXMudHRsS2V5O1xuICAgICAgfSxcbiAgICAgIF9ub29wOiBmdW5jdGlvbiBfbm9vcCgpIHtcbiAgICAgICAgdGhpcy5nZXQgPSB0aGlzLnNldCA9IHRoaXMucmVtb3ZlID0gdGhpcy5jbGVhciA9IHRoaXMuaXNFeHBpcmVkID0gXy5ub29wO1xuICAgICAgfSxcbiAgICAgIF9zYWZlU2V0OiBmdW5jdGlvbiBfc2FmZVNldChrZXksIHZhbCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHRoaXMubHMuc2V0SXRlbShrZXksIHZhbCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGlmIChlcnIubmFtZSA9PT0gXCJRdW90YUV4Y2VlZGVkRXJyb3JcIikge1xuICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xuXG4gICAgICAgICAgICB0aGlzLl9ub29wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7XG4gICAgICAgIGlmICh0aGlzLmlzRXhwaXJlZChrZXkpKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdmUoa2V5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkZWNvZGUodGhpcy5scy5nZXRJdGVtKHRoaXMuX3ByZWZpeChrZXkpKSk7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoa2V5LCB2YWwsIHR0bCkge1xuICAgICAgICBpZiAoXy5pc051bWJlcih0dGwpKSB7XG4gICAgICAgICAgdGhpcy5fc2FmZVNldCh0aGlzLl90dGxLZXkoa2V5KSwgZW5jb2RlKG5vdygpICsgdHRsKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5scy5yZW1vdmVJdGVtKHRoaXMuX3R0bEtleShrZXkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl9zYWZlU2V0KHRoaXMuX3ByZWZpeChrZXkpLCBlbmNvZGUodmFsKSk7XG4gICAgICB9LFxuICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoa2V5KSB7XG4gICAgICAgIHRoaXMubHMucmVtb3ZlSXRlbSh0aGlzLl90dGxLZXkoa2V5KSk7XG4gICAgICAgIHRoaXMubHMucmVtb3ZlSXRlbSh0aGlzLl9wcmVmaXgoa2V5KSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSxcbiAgICAgIGNsZWFyOiBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgICAgdmFyIGksXG4gICAgICAgICAgICBrZXlzID0gZ2F0aGVyTWF0Y2hpbmdLZXlzKHRoaXMua2V5TWF0Y2hlcik7XG5cbiAgICAgICAgZm9yIChpID0ga2V5cy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICB0aGlzLnJlbW92ZShrZXlzW2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSxcbiAgICAgIGlzRXhwaXJlZDogZnVuY3Rpb24gaXNFeHBpcmVkKGtleSkge1xuICAgICAgICB2YXIgdHRsID0gZGVjb2RlKHRoaXMubHMuZ2V0SXRlbSh0aGlzLl90dGxLZXkoa2V5KSkpO1xuICAgICAgICByZXR1cm4gXy5pc051bWJlcih0dGwpICYmIG5vdygpID4gdHRsID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIFBlcnNpc3RlbnRTdG9yYWdlO1xuXG4gICAgZnVuY3Rpb24gbm93KCkge1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVuY29kZSh2YWwpIHtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShfLmlzVW5kZWZpbmVkKHZhbCkgPyBudWxsIDogdmFsKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWNvZGUodmFsKSB7XG4gICAgICByZXR1cm4gJC5wYXJzZUpTT04odmFsKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnYXRoZXJNYXRjaGluZ0tleXMoa2V5TWF0Y2hlcikge1xuICAgICAgdmFyIGksXG4gICAgICAgICAga2V5LFxuICAgICAgICAgIGtleXMgPSBbXSxcbiAgICAgICAgICBsZW4gPSBMT0NBTF9TVE9SQUdFLmxlbmd0aDtcblxuICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmICgoa2V5ID0gTE9DQUxfU1RPUkFHRS5rZXkoaSkpLm1hdGNoKGtleU1hdGNoZXIpKSB7XG4gICAgICAgICAga2V5cy5wdXNoKGtleS5yZXBsYWNlKGtleU1hdGNoZXIsIFwiXCIpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ga2V5cztcbiAgICB9XG4gIH0oKTtcblxuICB2YXIgVHJhbnNwb3J0ID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgdmFyIHBlbmRpbmdSZXF1ZXN0c0NvdW50ID0gMCxcbiAgICAgICAgcGVuZGluZ1JlcXVlc3RzID0ge30sXG4gICAgICAgIHNoYXJlZENhY2hlID0gbmV3IExydUNhY2hlKDEwKTtcblxuICAgIGZ1bmN0aW9uIFRyYW5zcG9ydChvKSB7XG4gICAgICBvID0gbyB8fCB7fTtcbiAgICAgIHRoaXMubWF4UGVuZGluZ1JlcXVlc3RzID0gby5tYXhQZW5kaW5nUmVxdWVzdHMgfHwgNjtcbiAgICAgIHRoaXMuY2FuY2VsbGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmxhc3RSZXEgPSBudWxsO1xuICAgICAgdGhpcy5fc2VuZCA9IG8udHJhbnNwb3J0O1xuICAgICAgdGhpcy5fZ2V0ID0gby5saW1pdGVyID8gby5saW1pdGVyKHRoaXMuX2dldCkgOiB0aGlzLl9nZXQ7XG4gICAgICB0aGlzLl9jYWNoZSA9IG8uY2FjaGUgPT09IGZhbHNlID8gbmV3IExydUNhY2hlKDApIDogc2hhcmVkQ2FjaGU7XG4gICAgfVxuXG4gICAgVHJhbnNwb3J0LnNldE1heFBlbmRpbmdSZXF1ZXN0cyA9IGZ1bmN0aW9uIHNldE1heFBlbmRpbmdSZXF1ZXN0cyhudW0pIHtcbiAgICAgIHRoaXMubWF4UGVuZGluZ1JlcXVlc3RzID0gbnVtO1xuICAgIH07XG5cbiAgICBUcmFuc3BvcnQucmVzZXRDYWNoZSA9IGZ1bmN0aW9uIHJlc2V0Q2FjaGUoKSB7XG4gICAgICBzaGFyZWRDYWNoZS5yZXNldCgpO1xuICAgIH07XG5cbiAgICBfLm1peGluKFRyYW5zcG9ydC5wcm90b3R5cGUsIHtcbiAgICAgIF9maW5nZXJwcmludDogZnVuY3Rpb24gZmluZ2VycHJpbnQobykge1xuICAgICAgICBvID0gbyB8fCB7fTtcbiAgICAgICAgcmV0dXJuIG8udXJsICsgby50eXBlICsgJC5wYXJhbShvLmRhdGEgfHwge30pO1xuICAgICAgfSxcbiAgICAgIF9nZXQ6IGZ1bmN0aW9uIF9nZXQobywgY2IpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgZmluZ2VycHJpbnQsXG4gICAgICAgICAgICBqcVhocjtcbiAgICAgICAgZmluZ2VycHJpbnQgPSB0aGlzLl9maW5nZXJwcmludChvKTtcblxuICAgICAgICBpZiAodGhpcy5jYW5jZWxsZWQgfHwgZmluZ2VycHJpbnQgIT09IHRoaXMubGFzdFJlcSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChqcVhociA9IHBlbmRpbmdSZXF1ZXN0c1tmaW5nZXJwcmludF0pIHtcbiAgICAgICAgICBqcVhoci5kb25lKGRvbmUpLmZhaWwoZmFpbCk7XG4gICAgICAgIH0gZWxzZSBpZiAocGVuZGluZ1JlcXVlc3RzQ291bnQgPCB0aGlzLm1heFBlbmRpbmdSZXF1ZXN0cykge1xuICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0c0NvdW50Kys7XG4gICAgICAgICAgcGVuZGluZ1JlcXVlc3RzW2ZpbmdlcnByaW50XSA9IHRoaXMuX3NlbmQobykuZG9uZShkb25lKS5mYWlsKGZhaWwpLmFsd2F5cyhhbHdheXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMub25EZWNrUmVxdWVzdEFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkb25lKHJlc3ApIHtcbiAgICAgICAgICBjYihudWxsLCByZXNwKTtcblxuICAgICAgICAgIHRoYXQuX2NhY2hlLnNldChmaW5nZXJwcmludCwgcmVzcCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmYWlsKCkge1xuICAgICAgICAgIGNiKHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYWx3YXlzKCkge1xuICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0c0NvdW50LS07XG4gICAgICAgICAgZGVsZXRlIHBlbmRpbmdSZXF1ZXN0c1tmaW5nZXJwcmludF07XG5cbiAgICAgICAgICBpZiAodGhhdC5vbkRlY2tSZXF1ZXN0QXJncykge1xuICAgICAgICAgICAgdGhhdC5fZ2V0LmFwcGx5KHRoYXQsIHRoYXQub25EZWNrUmVxdWVzdEFyZ3MpO1xuXG4gICAgICAgICAgICB0aGF0Lm9uRGVja1JlcXVlc3RBcmdzID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBnZXQ6IGZ1bmN0aW9uIGdldChvLCBjYikge1xuICAgICAgICB2YXIgcmVzcCwgZmluZ2VycHJpbnQ7XG4gICAgICAgIGNiID0gY2IgfHwgJC5ub29wO1xuICAgICAgICBvID0gXy5pc1N0cmluZyhvKSA/IHtcbiAgICAgICAgICB1cmw6IG9cbiAgICAgICAgfSA6IG8gfHwge307XG4gICAgICAgIGZpbmdlcnByaW50ID0gdGhpcy5fZmluZ2VycHJpbnQobyk7XG4gICAgICAgIHRoaXMuY2FuY2VsbGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubGFzdFJlcSA9IGZpbmdlcnByaW50O1xuXG4gICAgICAgIGlmIChyZXNwID0gdGhpcy5fY2FjaGUuZ2V0KGZpbmdlcnByaW50KSkge1xuICAgICAgICAgIGNiKG51bGwsIHJlc3ApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX2dldChvLCBjYik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjYW5jZWw6IGZ1bmN0aW9uIGNhbmNlbCgpIHtcbiAgICAgICAgdGhpcy5jYW5jZWxsZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIFRyYW5zcG9ydDtcbiAgfSgpO1xuXG4gIHZhciBTZWFyY2hJbmRleCA9IHdpbmRvdy5TZWFyY2hJbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBDSElMRFJFTiA9IFwiY1wiLFxuICAgICAgICBJRFMgPSBcImlcIjtcblxuICAgIGZ1bmN0aW9uIFNlYXJjaEluZGV4KG8pIHtcbiAgICAgIG8gPSBvIHx8IHt9O1xuXG4gICAgICBpZiAoIW8uZGF0dW1Ub2tlbml6ZXIgfHwgIW8ucXVlcnlUb2tlbml6ZXIpIHtcbiAgICAgICAgJC5lcnJvcihcImRhdHVtVG9rZW5pemVyIGFuZCBxdWVyeVRva2VuaXplciBhcmUgYm90aCByZXF1aXJlZFwiKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5pZGVudGlmeSA9IG8uaWRlbnRpZnkgfHwgXy5zdHJpbmdpZnk7XG4gICAgICB0aGlzLmRhdHVtVG9rZW5pemVyID0gby5kYXR1bVRva2VuaXplcjtcbiAgICAgIHRoaXMucXVlcnlUb2tlbml6ZXIgPSBvLnF1ZXJ5VG9rZW5pemVyO1xuICAgICAgdGhpcy5tYXRjaEFueVF1ZXJ5VG9rZW4gPSBvLm1hdGNoQW55UXVlcnlUb2tlbjtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICB9XG5cbiAgICBfLm1peGluKFNlYXJjaEluZGV4LnByb3RvdHlwZSwge1xuICAgICAgYm9vdHN0cmFwOiBmdW5jdGlvbiBib290c3RyYXAobykge1xuICAgICAgICB0aGlzLmRhdHVtcyA9IG8uZGF0dW1zO1xuICAgICAgICB0aGlzLnRyaWUgPSBvLnRyaWU7XG4gICAgICB9LFxuICAgICAgYWRkOiBmdW5jdGlvbiBhZGQoZGF0YSkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIGRhdGEgPSBfLmlzQXJyYXkoZGF0YSkgPyBkYXRhIDogW2RhdGFdO1xuXG4gICAgICAgIF8uZWFjaChkYXRhLCBmdW5jdGlvbiAoZGF0dW0pIHtcbiAgICAgICAgICB2YXIgaWQsIHRva2VucztcbiAgICAgICAgICB0aGF0LmRhdHVtc1tpZCA9IHRoYXQuaWRlbnRpZnkoZGF0dW0pXSA9IGRhdHVtO1xuICAgICAgICAgIHRva2VucyA9IG5vcm1hbGl6ZVRva2Vucyh0aGF0LmRhdHVtVG9rZW5pemVyKGRhdHVtKSk7XG5cbiAgICAgICAgICBfLmVhY2godG9rZW5zLCBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBub2RlLCBjaGFycywgY2g7XG4gICAgICAgICAgICBub2RlID0gdGhhdC50cmllO1xuICAgICAgICAgICAgY2hhcnMgPSB0b2tlbi5zcGxpdChcIlwiKTtcblxuICAgICAgICAgICAgd2hpbGUgKGNoID0gY2hhcnMuc2hpZnQoKSkge1xuICAgICAgICAgICAgICBub2RlID0gbm9kZVtDSElMRFJFTl1bY2hdIHx8IChub2RlW0NISUxEUkVOXVtjaF0gPSBuZXdOb2RlKCkpO1xuICAgICAgICAgICAgICBub2RlW0lEU10ucHVzaChpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGlkcykge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHJldHVybiBfLm1hcChpZHMsIGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgIHJldHVybiB0aGF0LmRhdHVtc1tpZF07XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIHNlYXJjaDogZnVuY3Rpb24gc2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgIHRva2VucyxcbiAgICAgICAgICAgIG1hdGNoZXM7XG4gICAgICAgIHRva2VucyA9IG5vcm1hbGl6ZVRva2Vucyh0aGlzLnF1ZXJ5VG9rZW5pemVyKHF1ZXJ5KSk7XG5cbiAgICAgICAgXy5lYWNoKHRva2VucywgZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgdmFyIG5vZGUsIGNoYXJzLCBjaCwgaWRzO1xuXG4gICAgICAgICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlcy5sZW5ndGggPT09IDAgJiYgIXRoYXQubWF0Y2hBbnlRdWVyeVRva2VuKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbm9kZSA9IHRoYXQudHJpZTtcbiAgICAgICAgICBjaGFycyA9IHRva2VuLnNwbGl0KFwiXCIpO1xuXG4gICAgICAgICAgd2hpbGUgKG5vZGUgJiYgKGNoID0gY2hhcnMuc2hpZnQoKSkpIHtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlW0NISUxEUkVOXVtjaF07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG5vZGUgJiYgY2hhcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpZHMgPSBub2RlW0lEU10uc2xpY2UoMCk7XG4gICAgICAgICAgICBtYXRjaGVzID0gbWF0Y2hlcyA/IGdldEludGVyc2VjdGlvbihtYXRjaGVzLCBpZHMpIDogaWRzO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoYXQubWF0Y2hBbnlRdWVyeVRva2VuKSB7XG4gICAgICAgICAgICAgIG1hdGNoZXMgPSBbXTtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIG1hdGNoZXMgPyBfLm1hcCh1bmlxdWUobWF0Y2hlcyksIGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgIHJldHVybiB0aGF0LmRhdHVtc1tpZF07XG4gICAgICAgIH0pIDogW107XG4gICAgICB9LFxuICAgICAgYWxsOiBmdW5jdGlvbiBhbGwoKSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcblxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5kYXR1bXMpIHtcbiAgICAgICAgICB2YWx1ZXMucHVzaCh0aGlzLmRhdHVtc1trZXldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgICB9LFxuICAgICAgcmVzZXQ6IGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgICB0aGlzLmRhdHVtcyA9IHt9O1xuICAgICAgICB0aGlzLnRyaWUgPSBuZXdOb2RlKCk7XG4gICAgICB9LFxuICAgICAgc2VyaWFsaXplOiBmdW5jdGlvbiBzZXJpYWxpemUoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0dW1zOiB0aGlzLmRhdHVtcyxcbiAgICAgICAgICB0cmllOiB0aGlzLnRyaWVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBTZWFyY2hJbmRleDtcblxuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZVRva2Vucyh0b2tlbnMpIHtcbiAgICAgIHRva2VucyA9IF8uZmlsdGVyKHRva2VucywgZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIHJldHVybiAhIXRva2VuO1xuICAgICAgfSk7XG4gICAgICB0b2tlbnMgPSBfLm1hcCh0b2tlbnMsIGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICByZXR1cm4gdG9rZW4udG9Mb3dlckNhc2UoKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRva2VucztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXdOb2RlKCkge1xuICAgICAgdmFyIG5vZGUgPSB7fTtcbiAgICAgIG5vZGVbSURTXSA9IFtdO1xuICAgICAgbm9kZVtDSElMRFJFTl0gPSB7fTtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVuaXF1ZShhcnJheSkge1xuICAgICAgdmFyIHNlZW4gPSB7fSxcbiAgICAgICAgICB1bmlxdWVzID0gW107XG5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoIXNlZW5bYXJyYXlbaV1dKSB7XG4gICAgICAgICAgc2VlblthcnJheVtpXV0gPSB0cnVlO1xuICAgICAgICAgIHVuaXF1ZXMucHVzaChhcnJheVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVuaXF1ZXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0SW50ZXJzZWN0aW9uKGFycmF5QSwgYXJyYXlCKSB7XG4gICAgICB2YXIgYWkgPSAwLFxuICAgICAgICAgIGJpID0gMCxcbiAgICAgICAgICBpbnRlcnNlY3Rpb24gPSBbXTtcbiAgICAgIGFycmF5QSA9IGFycmF5QS5zb3J0KCk7XG4gICAgICBhcnJheUIgPSBhcnJheUIuc29ydCgpO1xuICAgICAgdmFyIGxlbkFycmF5QSA9IGFycmF5QS5sZW5ndGgsXG4gICAgICAgICAgbGVuQXJyYXlCID0gYXJyYXlCLmxlbmd0aDtcblxuICAgICAgd2hpbGUgKGFpIDwgbGVuQXJyYXlBICYmIGJpIDwgbGVuQXJyYXlCKSB7XG4gICAgICAgIGlmIChhcnJheUFbYWldIDwgYXJyYXlCW2JpXSkge1xuICAgICAgICAgIGFpKys7XG4gICAgICAgIH0gZWxzZSBpZiAoYXJyYXlBW2FpXSA+IGFycmF5QltiaV0pIHtcbiAgICAgICAgICBiaSsrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGludGVyc2VjdGlvbi5wdXNoKGFycmF5QVthaV0pO1xuICAgICAgICAgIGFpKys7XG4gICAgICAgICAgYmkrKztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gaW50ZXJzZWN0aW9uO1xuICAgIH1cbiAgfSgpO1xuXG4gIHZhciBQcmVmZXRjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBrZXlzO1xuICAgIGtleXMgPSB7XG4gICAgICBkYXRhOiBcImRhdGFcIixcbiAgICAgIHByb3RvY29sOiBcInByb3RvY29sXCIsXG4gICAgICB0aHVtYnByaW50OiBcInRodW1icHJpbnRcIlxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBQcmVmZXRjaChvKSB7XG4gICAgICB0aGlzLnVybCA9IG8udXJsO1xuICAgICAgdGhpcy50dGwgPSBvLnR0bDtcbiAgICAgIHRoaXMuY2FjaGUgPSBvLmNhY2hlO1xuICAgICAgdGhpcy5wcmVwYXJlID0gby5wcmVwYXJlO1xuICAgICAgdGhpcy50cmFuc2Zvcm0gPSBvLnRyYW5zZm9ybTtcbiAgICAgIHRoaXMudHJhbnNwb3J0ID0gby50cmFuc3BvcnQ7XG4gICAgICB0aGlzLnRodW1icHJpbnQgPSBvLnRodW1icHJpbnQ7XG4gICAgICB0aGlzLnN0b3JhZ2UgPSBuZXcgUGVyc2lzdGVudFN0b3JhZ2Uoby5jYWNoZUtleSk7XG4gICAgfVxuXG4gICAgXy5taXhpbihQcmVmZXRjaC5wcm90b3R5cGUsIHtcbiAgICAgIF9zZXR0aW5nczogZnVuY3Rpb24gc2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXJsOiB0aGlzLnVybCxcbiAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxuICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIlxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHN0b3JlOiBmdW5jdGlvbiBzdG9yZShkYXRhKSB7XG4gICAgICAgIGlmICghdGhpcy5jYWNoZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3RvcmFnZS5zZXQoa2V5cy5kYXRhLCBkYXRhLCB0aGlzLnR0bCk7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5zZXQoa2V5cy5wcm90b2NvbCwgbG9jYXRpb24ucHJvdG9jb2wsIHRoaXMudHRsKTtcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldChrZXlzLnRodW1icHJpbnQsIHRoaXMudGh1bWJwcmludCwgdGhpcy50dGwpO1xuICAgICAgfSxcbiAgICAgIGZyb21DYWNoZTogZnVuY3Rpb24gZnJvbUNhY2hlKCkge1xuICAgICAgICB2YXIgc3RvcmVkID0ge30sXG4gICAgICAgICAgICBpc0V4cGlyZWQ7XG5cbiAgICAgICAgaWYgKCF0aGlzLmNhY2hlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBzdG9yZWQuZGF0YSA9IHRoaXMuc3RvcmFnZS5nZXQoa2V5cy5kYXRhKTtcbiAgICAgICAgc3RvcmVkLnByb3RvY29sID0gdGhpcy5zdG9yYWdlLmdldChrZXlzLnByb3RvY29sKTtcbiAgICAgICAgc3RvcmVkLnRodW1icHJpbnQgPSB0aGlzLnN0b3JhZ2UuZ2V0KGtleXMudGh1bWJwcmludCk7XG4gICAgICAgIGlzRXhwaXJlZCA9IHN0b3JlZC50aHVtYnByaW50ICE9PSB0aGlzLnRodW1icHJpbnQgfHwgc3RvcmVkLnByb3RvY29sICE9PSBsb2NhdGlvbi5wcm90b2NvbDtcbiAgICAgICAgcmV0dXJuIHN0b3JlZC5kYXRhICYmICFpc0V4cGlyZWQgPyBzdG9yZWQuZGF0YSA6IG51bGw7XG4gICAgICB9LFxuICAgICAgZnJvbU5ldHdvcms6IGZ1bmN0aW9uIGZyb21OZXR3b3JrKGNiKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgIHNldHRpbmdzO1xuXG4gICAgICAgIGlmICghY2IpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBzZXR0aW5ncyA9IHRoaXMucHJlcGFyZSh0aGlzLl9zZXR0aW5ncygpKTtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQoc2V0dGluZ3MpLmZhaWwob25FcnJvcikuZG9uZShvblJlc3BvbnNlKTtcblxuICAgICAgICBmdW5jdGlvbiBvbkVycm9yKCkge1xuICAgICAgICAgIGNiKHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb25SZXNwb25zZShyZXNwKSB7XG4gICAgICAgICAgY2IobnVsbCwgdGhhdC50cmFuc2Zvcm0ocmVzcCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkge1xuICAgICAgICB0aGlzLnN0b3JhZ2UuY2xlYXIoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gUHJlZmV0Y2g7XG4gIH0oKTtcblxuICB2YXIgUmVtb3RlID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgZnVuY3Rpb24gUmVtb3RlKG8pIHtcbiAgICAgIHRoaXMudXJsID0gby51cmw7XG4gICAgICB0aGlzLnByZXBhcmUgPSBvLnByZXBhcmU7XG4gICAgICB0aGlzLnRyYW5zZm9ybSA9IG8udHJhbnNmb3JtO1xuICAgICAgdGhpcy5pbmRleFJlc3BvbnNlID0gby5pbmRleFJlc3BvbnNlO1xuICAgICAgdGhpcy50cmFuc3BvcnQgPSBuZXcgVHJhbnNwb3J0KHtcbiAgICAgICAgY2FjaGU6IG8uY2FjaGUsXG4gICAgICAgIGxpbWl0ZXI6IG8ubGltaXRlcixcbiAgICAgICAgdHJhbnNwb3J0OiBvLnRyYW5zcG9ydCxcbiAgICAgICAgbWF4UGVuZGluZ1JlcXVlc3RzOiBvLm1heFBlbmRpbmdSZXF1ZXN0c1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgXy5taXhpbihSZW1vdGUucHJvdG90eXBlLCB7XG4gICAgICBfc2V0dGluZ3M6IGZ1bmN0aW9uIHNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVybDogdGhpcy51cmwsXG4gICAgICAgICAgdHlwZTogXCJHRVRcIixcbiAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCJcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICBnZXQ6IGZ1bmN0aW9uIGdldChxdWVyeSwgY2IpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgc2V0dGluZ3M7XG5cbiAgICAgICAgaWYgKCFjYikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkgfHwgXCJcIjtcbiAgICAgICAgc2V0dGluZ3MgPSB0aGlzLnByZXBhcmUocXVlcnksIHRoaXMuX3NldHRpbmdzKCkpO1xuICAgICAgICByZXR1cm4gdGhpcy50cmFuc3BvcnQuZ2V0KHNldHRpbmdzLCBvblJlc3BvbnNlKTtcblxuICAgICAgICBmdW5jdGlvbiBvblJlc3BvbnNlKGVyciwgcmVzcCkge1xuICAgICAgICAgIGVyciA/IGNiKFtdKSA6IGNiKHRoYXQudHJhbnNmb3JtKHJlc3ApKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGNhbmNlbExhc3RSZXF1ZXN0OiBmdW5jdGlvbiBjYW5jZWxMYXN0UmVxdWVzdCgpIHtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQuY2FuY2VsKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gUmVtb3RlO1xuICB9KCk7XG5cbiAgdmFyIG9QYXJzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gcGFyc2Uobykge1xuICAgICAgdmFyIGRlZmF1bHRzLCBzb3J0ZXI7XG4gICAgICBkZWZhdWx0cyA9IHtcbiAgICAgICAgaW5pdGlhbGl6ZTogdHJ1ZSxcbiAgICAgICAgaWRlbnRpZnk6IF8uc3RyaW5naWZ5LFxuICAgICAgICBkYXR1bVRva2VuaXplcjogbnVsbCxcbiAgICAgICAgcXVlcnlUb2tlbml6ZXI6IG51bGwsXG4gICAgICAgIG1hdGNoQW55UXVlcnlUb2tlbjogZmFsc2UsXG4gICAgICAgIHN1ZmZpY2llbnQ6IDUsXG4gICAgICAgIGluZGV4UmVtb3RlOiBmYWxzZSxcbiAgICAgICAgc29ydGVyOiBudWxsLFxuICAgICAgICBsb2NhbDogW10sXG4gICAgICAgIHByZWZldGNoOiBudWxsLFxuICAgICAgICByZW1vdGU6IG51bGxcbiAgICAgIH07XG4gICAgICBvID0gXy5taXhpbihkZWZhdWx0cywgbyB8fCB7fSk7XG4gICAgICAhby5kYXR1bVRva2VuaXplciAmJiAkLmVycm9yKFwiZGF0dW1Ub2tlbml6ZXIgaXMgcmVxdWlyZWRcIik7XG4gICAgICAhby5xdWVyeVRva2VuaXplciAmJiAkLmVycm9yKFwicXVlcnlUb2tlbml6ZXIgaXMgcmVxdWlyZWRcIik7XG4gICAgICBzb3J0ZXIgPSBvLnNvcnRlcjtcbiAgICAgIG8uc29ydGVyID0gc29ydGVyID8gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgcmV0dXJuIHguc29ydChzb3J0ZXIpO1xuICAgICAgfSA6IF8uaWRlbnRpdHk7XG4gICAgICBvLmxvY2FsID0gXy5pc0Z1bmN0aW9uKG8ubG9jYWwpID8gby5sb2NhbCgpIDogby5sb2NhbDtcbiAgICAgIG8ucHJlZmV0Y2ggPSBwYXJzZVByZWZldGNoKG8ucHJlZmV0Y2gpO1xuICAgICAgby5yZW1vdGUgPSBwYXJzZVJlbW90ZShvLnJlbW90ZSk7XG4gICAgICByZXR1cm4gbztcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcGFyc2VQcmVmZXRjaChvKSB7XG4gICAgICB2YXIgZGVmYXVsdHM7XG5cbiAgICAgIGlmICghbykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgZGVmYXVsdHMgPSB7XG4gICAgICAgIHVybDogbnVsbCxcbiAgICAgICAgdHRsOiAyNCAqIDYwICogNjAgKiAxZTMsXG4gICAgICAgIGNhY2hlOiB0cnVlLFxuICAgICAgICBjYWNoZUtleTogbnVsbCxcbiAgICAgICAgdGh1bWJwcmludDogXCJcIixcbiAgICAgICAgcHJlcGFyZTogXy5pZGVudGl0eSxcbiAgICAgICAgdHJhbnNmb3JtOiBfLmlkZW50aXR5LFxuICAgICAgICB0cmFuc3BvcnQ6IG51bGxcbiAgICAgIH07XG4gICAgICBvID0gXy5pc1N0cmluZyhvKSA/IHtcbiAgICAgICAgdXJsOiBvXG4gICAgICB9IDogbztcbiAgICAgIG8gPSBfLm1peGluKGRlZmF1bHRzLCBvKTtcbiAgICAgICFvLnVybCAmJiAkLmVycm9yKFwicHJlZmV0Y2ggcmVxdWlyZXMgdXJsIHRvIGJlIHNldFwiKTtcbiAgICAgIG8udHJhbnNmb3JtID0gby5maWx0ZXIgfHwgby50cmFuc2Zvcm07XG4gICAgICBvLmNhY2hlS2V5ID0gby5jYWNoZUtleSB8fCBvLnVybDtcbiAgICAgIG8udGh1bWJwcmludCA9IFZFUlNJT04gKyBvLnRodW1icHJpbnQ7XG4gICAgICBvLnRyYW5zcG9ydCA9IG8udHJhbnNwb3J0ID8gY2FsbGJhY2tUb0RlZmVycmVkKG8udHJhbnNwb3J0KSA6ICQuYWpheDtcbiAgICAgIHJldHVybiBvO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlUmVtb3RlKG8pIHtcbiAgICAgIHZhciBkZWZhdWx0cztcblxuICAgICAgaWYgKCFvKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZGVmYXVsdHMgPSB7XG4gICAgICAgIHVybDogbnVsbCxcbiAgICAgICAgY2FjaGU6IHRydWUsXG4gICAgICAgIHByZXBhcmU6IG51bGwsXG4gICAgICAgIHJlcGxhY2U6IG51bGwsXG4gICAgICAgIHdpbGRjYXJkOiBudWxsLFxuICAgICAgICBsaW1pdGVyOiBudWxsLFxuICAgICAgICByYXRlTGltaXRCeTogXCJkZWJvdW5jZVwiLFxuICAgICAgICByYXRlTGltaXRXYWl0OiAzMDAsXG4gICAgICAgIHRyYW5zZm9ybTogXy5pZGVudGl0eSxcbiAgICAgICAgdHJhbnNwb3J0OiBudWxsXG4gICAgICB9O1xuICAgICAgbyA9IF8uaXNTdHJpbmcobykgPyB7XG4gICAgICAgIHVybDogb1xuICAgICAgfSA6IG87XG4gICAgICBvID0gXy5taXhpbihkZWZhdWx0cywgbyk7XG4gICAgICAhby51cmwgJiYgJC5lcnJvcihcInJlbW90ZSByZXF1aXJlcyB1cmwgdG8gYmUgc2V0XCIpO1xuICAgICAgby50cmFuc2Zvcm0gPSBvLmZpbHRlciB8fCBvLnRyYW5zZm9ybTtcbiAgICAgIG8ucHJlcGFyZSA9IHRvUmVtb3RlUHJlcGFyZShvKTtcbiAgICAgIG8ubGltaXRlciA9IHRvTGltaXRlcihvKTtcbiAgICAgIG8udHJhbnNwb3J0ID0gby50cmFuc3BvcnQgPyBjYWxsYmFja1RvRGVmZXJyZWQoby50cmFuc3BvcnQpIDogJC5hamF4O1xuICAgICAgZGVsZXRlIG8ucmVwbGFjZTtcbiAgICAgIGRlbGV0ZSBvLndpbGRjYXJkO1xuICAgICAgZGVsZXRlIG8ucmF0ZUxpbWl0Qnk7XG4gICAgICBkZWxldGUgby5yYXRlTGltaXRXYWl0O1xuICAgICAgcmV0dXJuIG87XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdG9SZW1vdGVQcmVwYXJlKG8pIHtcbiAgICAgIHZhciBwcmVwYXJlLCByZXBsYWNlLCB3aWxkY2FyZDtcbiAgICAgIHByZXBhcmUgPSBvLnByZXBhcmU7XG4gICAgICByZXBsYWNlID0gby5yZXBsYWNlO1xuICAgICAgd2lsZGNhcmQgPSBvLndpbGRjYXJkO1xuXG4gICAgICBpZiAocHJlcGFyZSkge1xuICAgICAgICByZXR1cm4gcHJlcGFyZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJlcGxhY2UpIHtcbiAgICAgICAgcHJlcGFyZSA9IHByZXBhcmVCeVJlcGxhY2U7XG4gICAgICB9IGVsc2UgaWYgKG8ud2lsZGNhcmQpIHtcbiAgICAgICAgcHJlcGFyZSA9IHByZXBhcmVCeVdpbGRjYXJkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJlcGFyZSA9IGlkZW50aXR5UHJlcGFyZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXBhcmU7XG5cbiAgICAgIGZ1bmN0aW9uIHByZXBhcmVCeVJlcGxhY2UocXVlcnksIHNldHRpbmdzKSB7XG4gICAgICAgIHNldHRpbmdzLnVybCA9IHJlcGxhY2Uoc2V0dGluZ3MudXJsLCBxdWVyeSk7XG4gICAgICAgIHJldHVybiBzZXR0aW5ncztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcHJlcGFyZUJ5V2lsZGNhcmQocXVlcnksIHNldHRpbmdzKSB7XG4gICAgICAgIHNldHRpbmdzLnVybCA9IHNldHRpbmdzLnVybC5yZXBsYWNlKHdpbGRjYXJkLCBlbmNvZGVVUklDb21wb25lbnQocXVlcnkpKTtcbiAgICAgICAgcmV0dXJuIHNldHRpbmdzO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBpZGVudGl0eVByZXBhcmUocXVlcnksIHNldHRpbmdzKSB7XG4gICAgICAgIHJldHVybiBzZXR0aW5ncztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0b0xpbWl0ZXIobykge1xuICAgICAgdmFyIGxpbWl0ZXIsIG1ldGhvZCwgd2FpdDtcbiAgICAgIGxpbWl0ZXIgPSBvLmxpbWl0ZXI7XG4gICAgICBtZXRob2QgPSBvLnJhdGVMaW1pdEJ5O1xuICAgICAgd2FpdCA9IG8ucmF0ZUxpbWl0V2FpdDtcblxuICAgICAgaWYgKCFsaW1pdGVyKSB7XG4gICAgICAgIGxpbWl0ZXIgPSAvXnRocm90dGxlJC9pLnRlc3QobWV0aG9kKSA/IHRocm90dGxlKHdhaXQpIDogZGVib3VuY2Uod2FpdCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBsaW1pdGVyO1xuXG4gICAgICBmdW5jdGlvbiBkZWJvdW5jZSh3YWl0KSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBkZWJvdW5jZShmbikge1xuICAgICAgICAgIHJldHVybiBfLmRlYm91bmNlKGZuLCB3YWl0KTtcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gdGhyb3R0bGUod2FpdCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gdGhyb3R0bGUoZm4pIHtcbiAgICAgICAgICByZXR1cm4gXy50aHJvdHRsZShmbiwgd2FpdCk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsbGJhY2tUb0RlZmVycmVkKGZuKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gd3JhcHBlcihvKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICAgICAgZm4obywgb25TdWNjZXNzLCBvbkVycm9yKTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkO1xuXG4gICAgICAgIGZ1bmN0aW9uIG9uU3VjY2VzcyhyZXNwKSB7XG4gICAgICAgICAgXy5kZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3ApO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb25FcnJvcihlcnIpIHtcbiAgICAgICAgICBfLmRlZmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSgpO1xuXG4gIHZhciBCbG9vZGhvdW5kID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgdmFyIG9sZDtcbiAgICBvbGQgPSB3aW5kb3cgJiYgd2luZG93LkJsb29kaG91bmQ7XG5cbiAgICBmdW5jdGlvbiBCbG9vZGhvdW5kKG8pIHtcbiAgICAgIG8gPSBvUGFyc2VyKG8pO1xuICAgICAgdGhpcy5zb3J0ZXIgPSBvLnNvcnRlcjtcbiAgICAgIHRoaXMuaWRlbnRpZnkgPSBvLmlkZW50aWZ5O1xuICAgICAgdGhpcy5zdWZmaWNpZW50ID0gby5zdWZmaWNpZW50O1xuICAgICAgdGhpcy5pbmRleFJlbW90ZSA9IG8uaW5kZXhSZW1vdGU7XG4gICAgICB0aGlzLmxvY2FsID0gby5sb2NhbDtcbiAgICAgIHRoaXMucmVtb3RlID0gby5yZW1vdGUgPyBuZXcgUmVtb3RlKG8ucmVtb3RlKSA6IG51bGw7XG4gICAgICB0aGlzLnByZWZldGNoID0gby5wcmVmZXRjaCA/IG5ldyBQcmVmZXRjaChvLnByZWZldGNoKSA6IG51bGw7XG4gICAgICB0aGlzLmluZGV4ID0gbmV3IFNlYXJjaEluZGV4KHtcbiAgICAgICAgaWRlbnRpZnk6IHRoaXMuaWRlbnRpZnksXG4gICAgICAgIGRhdHVtVG9rZW5pemVyOiBvLmRhdHVtVG9rZW5pemVyLFxuICAgICAgICBxdWVyeVRva2VuaXplcjogby5xdWVyeVRva2VuaXplclxuICAgICAgfSk7XG4gICAgICBvLmluaXRpYWxpemUgIT09IGZhbHNlICYmIHRoaXMuaW5pdGlhbGl6ZSgpO1xuICAgIH1cblxuICAgIEJsb29kaG91bmQubm9Db25mbGljdCA9IGZ1bmN0aW9uIG5vQ29uZmxpY3QoKSB7XG4gICAgICB3aW5kb3cgJiYgKHdpbmRvdy5CbG9vZGhvdW5kID0gb2xkKTtcbiAgICAgIHJldHVybiBCbG9vZGhvdW5kO1xuICAgIH07XG5cbiAgICBCbG9vZGhvdW5kLnRva2VuaXplcnMgPSB0b2tlbml6ZXJzO1xuXG4gICAgXy5taXhpbihCbG9vZGhvdW5kLnByb3RvdHlwZSwge1xuICAgICAgX190dEFkYXB0ZXI6IGZ1bmN0aW9uIHR0QWRhcHRlcigpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGUgPyB3aXRoQXN5bmMgOiB3aXRob3V0QXN5bmM7XG5cbiAgICAgICAgZnVuY3Rpb24gd2l0aEFzeW5jKHF1ZXJ5LCBzeW5jLCBhc3luYykge1xuICAgICAgICAgIHJldHVybiB0aGF0LnNlYXJjaChxdWVyeSwgc3luYywgYXN5bmMpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gd2l0aG91dEFzeW5jKHF1ZXJ5LCBzeW5jKSB7XG4gICAgICAgICAgcmV0dXJuIHRoYXQuc2VhcmNoKHF1ZXJ5LCBzeW5jKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIF9sb2FkUHJlZmV0Y2g6IGZ1bmN0aW9uIGxvYWRQcmVmZXRjaCgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgZGVmZXJyZWQsXG4gICAgICAgICAgICBzZXJpYWxpemVkO1xuICAgICAgICBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcblxuICAgICAgICBpZiAoIXRoaXMucHJlZmV0Y2gpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2VyaWFsaXplZCA9IHRoaXMucHJlZmV0Y2guZnJvbUNhY2hlKCkpIHtcbiAgICAgICAgICB0aGlzLmluZGV4LmJvb3RzdHJhcChzZXJpYWxpemVkKTtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5wcmVmZXRjaC5mcm9tTmV0d29yayhkb25lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gZG9uZShlcnIsIGRhdGEpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhhdC5hZGQoZGF0YSk7XG4gICAgICAgICAgdGhhdC5wcmVmZXRjaC5zdG9yZSh0aGF0LmluZGV4LnNlcmlhbGl6ZSgpKTtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBfaW5pdGlhbGl6ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgZGVmZXJyZWQ7XG4gICAgICAgIHRoaXMuY2xlYXIoKTtcblxuICAgICAgICAodGhpcy5pbml0UHJvbWlzZSA9IHRoaXMuX2xvYWRQcmVmZXRjaCgpKS5kb25lKGFkZExvY2FsVG9JbmRleCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaW5pdFByb21pc2U7XG5cbiAgICAgICAgZnVuY3Rpb24gYWRkTG9jYWxUb0luZGV4KCkge1xuICAgICAgICAgIHRoYXQuYWRkKHRoYXQubG9jYWwpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShmb3JjZSkge1xuICAgICAgICByZXR1cm4gIXRoaXMuaW5pdFByb21pc2UgfHwgZm9yY2UgPyB0aGlzLl9pbml0aWFsaXplKCkgOiB0aGlzLmluaXRQcm9taXNlO1xuICAgICAgfSxcbiAgICAgIGFkZDogZnVuY3Rpb24gYWRkKGRhdGEpIHtcbiAgICAgICAgdGhpcy5pbmRleC5hZGQoZGF0YSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSxcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGlkcykge1xuICAgICAgICBpZHMgPSBfLmlzQXJyYXkoaWRzKSA/IGlkcyA6IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXguZ2V0KGlkcyk7XG4gICAgICB9LFxuICAgICAgc2VhcmNoOiBmdW5jdGlvbiBzZWFyY2gocXVlcnksIHN5bmMsIGFzeW5jKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgIGxvY2FsO1xuICAgICAgICBzeW5jID0gc3luYyB8fCBfLm5vb3A7XG4gICAgICAgIGFzeW5jID0gYXN5bmMgfHwgXy5ub29wO1xuICAgICAgICBsb2NhbCA9IHRoaXMuc29ydGVyKHRoaXMuaW5kZXguc2VhcmNoKHF1ZXJ5KSk7XG4gICAgICAgIHN5bmModGhpcy5yZW1vdGUgPyBsb2NhbC5zbGljZSgpIDogbG9jYWwpO1xuXG4gICAgICAgIGlmICh0aGlzLnJlbW90ZSAmJiBsb2NhbC5sZW5ndGggPCB0aGlzLnN1ZmZpY2llbnQpIHtcbiAgICAgICAgICB0aGlzLnJlbW90ZS5nZXQocXVlcnksIHByb2Nlc3NSZW1vdGUpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVtb3RlKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdGUuY2FuY2VsTGFzdFJlcXVlc3QoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgICAgIGZ1bmN0aW9uIHByb2Nlc3NSZW1vdGUocmVtb3RlKSB7XG4gICAgICAgICAgdmFyIG5vbkR1cGxpY2F0ZXMgPSBbXTtcblxuICAgICAgICAgIF8uZWFjaChyZW1vdGUsIGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICAhXy5zb21lKGxvY2FsLCBmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICByZXR1cm4gdGhhdC5pZGVudGlmeShyKSA9PT0gdGhhdC5pZGVudGlmeShsKTtcbiAgICAgICAgICAgIH0pICYmIG5vbkR1cGxpY2F0ZXMucHVzaChyKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHRoYXQuaW5kZXhSZW1vdGUgJiYgdGhhdC5hZGQobm9uRHVwbGljYXRlcyk7XG4gICAgICAgICAgYXN5bmMobm9uRHVwbGljYXRlcyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBhbGw6IGZ1bmN0aW9uIGFsbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXguYWxsKCk7XG4gICAgICB9LFxuICAgICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkge1xuICAgICAgICB0aGlzLmluZGV4LnJlc2V0KCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSxcbiAgICAgIGNsZWFyUHJlZmV0Y2hDYWNoZTogZnVuY3Rpb24gY2xlYXJQcmVmZXRjaENhY2hlKCkge1xuICAgICAgICB0aGlzLnByZWZldGNoICYmIHRoaXMucHJlZmV0Y2guY2xlYXIoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9LFxuICAgICAgY2xlYXJSZW1vdGVDYWNoZTogZnVuY3Rpb24gY2xlYXJSZW1vdGVDYWNoZSgpIHtcbiAgICAgICAgVHJhbnNwb3J0LnJlc2V0Q2FjaGUoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9LFxuICAgICAgdHRBZGFwdGVyOiBmdW5jdGlvbiB0dEFkYXB0ZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9fdHRBZGFwdGVyKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gQmxvb2Rob3VuZDtcbiAgfSgpO1xuXG4gIHJldHVybiBCbG9vZGhvdW5kO1xufSk7XG5cbihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW1wianF1ZXJ5XCJdLCBmdW5jdGlvbiAoYTApIHtcbiAgICAgIHJldHVybiBmYWN0b3J5KGEwKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJqcXVlcnlcIikpO1xuICB9IGVsc2Uge1xuICAgIGZhY3Rvcnkocm9vdFtcImpRdWVyeVwiXSk7XG4gIH1cbn0pKHRoaXMsIGZ1bmN0aW9uICgkKSB7XG4gIHZhciBfID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTXNpZTogZnVuY3Rpb24gaXNNc2llKCkge1xuICAgICAgICByZXR1cm4gLyhtc2llfHRyaWRlbnQpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSA/IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goLyhtc2llIHxydjopKFxcZCsoLlxcZCspPykvaSlbMl0gOiBmYWxzZTtcbiAgICAgIH0sXG4gICAgICBpc0JsYW5rU3RyaW5nOiBmdW5jdGlvbiBpc0JsYW5rU3RyaW5nKHN0cikge1xuICAgICAgICByZXR1cm4gIXN0ciB8fCAvXlxccyokLy50ZXN0KHN0cik7XG4gICAgICB9LFxuICAgICAgZXNjYXBlUmVnRXhDaGFyczogZnVuY3Rpb24gZXNjYXBlUmVnRXhDaGFycyhzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9bXFwtXFxbXFxdXFwvXFx7XFx9XFwoXFwpXFwqXFwrXFw/XFwuXFxcXFxcXlxcJFxcfF0vZywgXCJcXFxcJCZcIik7XG4gICAgICB9LFxuICAgICAgaXNTdHJpbmc6IGZ1bmN0aW9uIGlzU3RyaW5nKG9iaikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gXCJzdHJpbmdcIjtcbiAgICAgIH0sXG4gICAgICBpc051bWJlcjogZnVuY3Rpb24gaXNOdW1iZXIob2JqKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSBcIm51bWJlclwiO1xuICAgICAgfSxcbiAgICAgIGlzQXJyYXk6ICQuaXNBcnJheSxcbiAgICAgIGlzRnVuY3Rpb246ICQuaXNGdW5jdGlvbixcbiAgICAgIGlzT2JqZWN0OiAkLmlzUGxhaW5PYmplY3QsXG4gICAgICBpc1VuZGVmaW5lZDogZnVuY3Rpb24gaXNVbmRlZmluZWQob2JqKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiO1xuICAgICAgfSxcbiAgICAgIGlzRWxlbWVudDogZnVuY3Rpb24gaXNFbGVtZW50KG9iaikge1xuICAgICAgICByZXR1cm4gISEob2JqICYmIG9iai5ub2RlVHlwZSA9PT0gMSk7XG4gICAgICB9LFxuICAgICAgaXNKUXVlcnk6IGZ1bmN0aW9uIGlzSlF1ZXJ5KG9iaikge1xuICAgICAgICByZXR1cm4gb2JqIGluc3RhbmNlb2YgJDtcbiAgICAgIH0sXG4gICAgICB0b1N0cjogZnVuY3Rpb24gdG9TdHIocykge1xuICAgICAgICByZXR1cm4gXy5pc1VuZGVmaW5lZChzKSB8fCBzID09PSBudWxsID8gXCJcIiA6IHMgKyBcIlwiO1xuICAgICAgfSxcbiAgICAgIGJpbmQ6ICQucHJveHksXG4gICAgICBlYWNoOiBmdW5jdGlvbiBlYWNoKGNvbGxlY3Rpb24sIGNiKSB7XG4gICAgICAgICQuZWFjaChjb2xsZWN0aW9uLCByZXZlcnNlQXJncyk7XG5cbiAgICAgICAgZnVuY3Rpb24gcmV2ZXJzZUFyZ3MoaW5kZXgsIHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIGNiKHZhbHVlLCBpbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBtYXA6ICQubWFwLFxuICAgICAgZmlsdGVyOiAkLmdyZXAsXG4gICAgICBldmVyeTogZnVuY3Rpb24gZXZlcnkob2JqLCB0ZXN0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0cnVlO1xuXG4gICAgICAgIGlmICghb2JqKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgICQuZWFjaChvYmosIGZ1bmN0aW9uIChrZXksIHZhbCkge1xuICAgICAgICAgIGlmICghKHJlc3VsdCA9IHRlc3QuY2FsbChudWxsLCB2YWwsIGtleSwgb2JqKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gISFyZXN1bHQ7XG4gICAgICB9LFxuICAgICAgc29tZTogZnVuY3Rpb24gc29tZShvYmosIHRlc3QpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuXG4gICAgICAgIGlmICghb2JqKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgICQuZWFjaChvYmosIGZ1bmN0aW9uIChrZXksIHZhbCkge1xuICAgICAgICAgIGlmIChyZXN1bHQgPSB0ZXN0LmNhbGwobnVsbCwgdmFsLCBrZXksIG9iaikpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gISFyZXN1bHQ7XG4gICAgICB9LFxuICAgICAgbWl4aW46ICQuZXh0ZW5kLFxuICAgICAgaWRlbnRpdHk6IGZ1bmN0aW9uIGlkZW50aXR5KHgpIHtcbiAgICAgICAgcmV0dXJuIHg7XG4gICAgICB9LFxuICAgICAgY2xvbmU6IGZ1bmN0aW9uIGNsb25lKG9iaikge1xuICAgICAgICByZXR1cm4gJC5leHRlbmQodHJ1ZSwge30sIG9iaik7XG4gICAgICB9LFxuICAgICAgZ2V0SWRHZW5lcmF0b3I6IGZ1bmN0aW9uIGdldElkR2VuZXJhdG9yKCkge1xuICAgICAgICB2YXIgY291bnRlciA9IDA7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGNvdW50ZXIrKztcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0aWZ5OiBmdW5jdGlvbiB0ZW1wbGF0aWZ5KG9iaikge1xuICAgICAgICByZXR1cm4gJC5pc0Z1bmN0aW9uKG9iaikgPyBvYmogOiB0ZW1wbGF0ZTtcblxuICAgICAgICBmdW5jdGlvbiB0ZW1wbGF0ZSgpIHtcbiAgICAgICAgICByZXR1cm4gU3RyaW5nKG9iaik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZWZlcjogZnVuY3Rpb24gZGVmZXIoZm4pIHtcbiAgICAgICAgc2V0VGltZW91dChmbiwgMCk7XG4gICAgICB9LFxuICAgICAgZGVib3VuY2U6IGZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xuICAgICAgICB2YXIgdGltZW91dCwgcmVzdWx0O1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcyxcbiAgICAgICAgICAgICAgYXJncyA9IGFyZ3VtZW50cyxcbiAgICAgICAgICAgICAgbGF0ZXIsXG4gICAgICAgICAgICAgIGNhbGxOb3c7XG5cbiAgICAgICAgICBsYXRlciA9IGZ1bmN0aW9uIGxhdGVyKCkge1xuICAgICAgICAgICAgdGltZW91dCA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICghaW1tZWRpYXRlKSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcblxuICAgICAgICAgIGlmIChjYWxsTm93KSB7XG4gICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgdGhyb3R0bGU6IGZ1bmN0aW9uIHRocm90dGxlKGZ1bmMsIHdhaXQpIHtcbiAgICAgICAgdmFyIGNvbnRleHQsIGFyZ3MsIHRpbWVvdXQsIHJlc3VsdCwgcHJldmlvdXMsIGxhdGVyO1xuICAgICAgICBwcmV2aW91cyA9IDA7XG5cbiAgICAgICAgbGF0ZXIgPSBmdW5jdGlvbiBsYXRlcigpIHtcbiAgICAgICAgICBwcmV2aW91cyA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICByZW1haW5pbmcgPSB3YWl0IC0gKG5vdyAtIHByZXZpb3VzKTtcbiAgICAgICAgICBjb250ZXh0ID0gdGhpcztcbiAgICAgICAgICBhcmdzID0gYXJndW1lbnRzO1xuXG4gICAgICAgICAgaWYgKHJlbWFpbmluZyA8PSAwKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgICAgICAgIHByZXZpb3VzID0gbm93O1xuICAgICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKCF0aW1lb3V0KSB7XG4gICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgcmVtYWluaW5nKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KHZhbCkge1xuICAgICAgICByZXR1cm4gXy5pc1N0cmluZyh2YWwpID8gdmFsIDogSlNPTi5zdHJpbmdpZnkodmFsKTtcbiAgICAgIH0sXG4gICAgICBndWlkOiBmdW5jdGlvbiBndWlkKCkge1xuICAgICAgICBmdW5jdGlvbiBfcDgocykge1xuICAgICAgICAgIHZhciBwID0gKE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpICsgXCIwMDAwMDAwMDBcIikuc3Vic3RyKDIsIDgpO1xuICAgICAgICAgIHJldHVybiBzID8gXCItXCIgKyBwLnN1YnN0cigwLCA0KSArIFwiLVwiICsgcC5zdWJzdHIoNCwgNCkgOiBwO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFwidHQtXCIgKyBfcDgoKSArIF9wOCh0cnVlKSArIF9wOCh0cnVlKSArIF9wOCgpO1xuICAgICAgfSxcbiAgICAgIG5vb3A6IGZ1bmN0aW9uIG5vb3AoKSB7fVxuICAgIH07XG4gIH0oKTtcblxuICB2YXIgV1dXID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgdmFyIGRlZmF1bHRDbGFzc05hbWVzID0ge1xuICAgICAgd3JhcHBlcjogXCJ0d2l0dGVyLXR5cGVhaGVhZFwiLFxuICAgICAgaW5wdXQ6IFwidHQtaW5wdXRcIixcbiAgICAgIGhpbnQ6IFwidHQtaGludFwiLFxuICAgICAgbWVudTogXCJ0dC1tZW51XCIsXG4gICAgICBkYXRhc2V0OiBcInR0LWRhdGFzZXRcIixcbiAgICAgIHN1Z2dlc3Rpb246IFwidHQtc3VnZ2VzdGlvblwiLFxuICAgICAgc2VsZWN0YWJsZTogXCJ0dC1zZWxlY3RhYmxlXCIsXG4gICAgICBlbXB0eTogXCJ0dC1lbXB0eVwiLFxuICAgICAgb3BlbjogXCJ0dC1vcGVuXCIsXG4gICAgICBjdXJzb3I6IFwidHQtY3Vyc29yXCIsXG4gICAgICBoaWdobGlnaHQ6IFwidHQtaGlnaGxpZ2h0XCJcbiAgICB9O1xuICAgIHJldHVybiBidWlsZDtcblxuICAgIGZ1bmN0aW9uIGJ1aWxkKG8pIHtcbiAgICAgIHZhciB3d3csIGNsYXNzZXM7XG4gICAgICBjbGFzc2VzID0gXy5taXhpbih7fSwgZGVmYXVsdENsYXNzTmFtZXMsIG8pO1xuICAgICAgd3d3ID0ge1xuICAgICAgICBjc3M6IGJ1aWxkQ3NzKCksXG4gICAgICAgIGNsYXNzZXM6IGNsYXNzZXMsXG4gICAgICAgIGh0bWw6IGJ1aWxkSHRtbChjbGFzc2VzKSxcbiAgICAgICAgc2VsZWN0b3JzOiBidWlsZFNlbGVjdG9ycyhjbGFzc2VzKVxuICAgICAgfTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNzczogd3d3LmNzcyxcbiAgICAgICAgaHRtbDogd3d3Lmh0bWwsXG4gICAgICAgIGNsYXNzZXM6IHd3dy5jbGFzc2VzLFxuICAgICAgICBzZWxlY3RvcnM6IHd3dy5zZWxlY3RvcnMsXG4gICAgICAgIG1peGluOiBmdW5jdGlvbiBtaXhpbihvKSB7XG4gICAgICAgICAgXy5taXhpbihvLCB3d3cpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkSHRtbChjKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB3cmFwcGVyOiAnPHNwYW4gY2xhc3M9XCInICsgYy53cmFwcGVyICsgJ1wiPjwvc3Bhbj4nLFxuICAgICAgICBtZW51OiAnPGRpdiByb2xlPVwibGlzdGJveFwiIGNsYXNzPVwiJyArIGMubWVudSArICdcIj48L2Rpdj4nXG4gICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkU2VsZWN0b3JzKGNsYXNzZXMpIHtcbiAgICAgIHZhciBzZWxlY3RvcnMgPSB7fTtcblxuICAgICAgXy5lYWNoKGNsYXNzZXMsIGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgIHNlbGVjdG9yc1trXSA9IFwiLlwiICsgdjtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gc2VsZWN0b3JzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkQ3NzKCkge1xuICAgICAgdmFyIGNzcyA9IHtcbiAgICAgICAgd3JhcHBlcjoge1xuICAgICAgICAgIHBvc2l0aW9uOiBcInJlbGF0aXZlXCIsXG4gICAgICAgICAgZGlzcGxheTogXCJpbmxpbmUtYmxvY2tcIlxuICAgICAgICB9LFxuICAgICAgICBoaW50OiB7XG4gICAgICAgICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICAgICAgICB0b3A6IFwiMFwiLFxuICAgICAgICAgIGxlZnQ6IFwiMFwiLFxuICAgICAgICAgIGJvcmRlckNvbG9yOiBcInRyYW5zcGFyZW50XCIsXG4gICAgICAgICAgYm94U2hhZG93OiBcIm5vbmVcIixcbiAgICAgICAgICBvcGFjaXR5OiBcIjFcIlxuICAgICAgICB9LFxuICAgICAgICBpbnB1dDoge1xuICAgICAgICAgIHBvc2l0aW9uOiBcInJlbGF0aXZlXCIsXG4gICAgICAgICAgdmVydGljYWxBbGlnbjogXCJ0b3BcIixcbiAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwidHJhbnNwYXJlbnRcIlxuICAgICAgICB9LFxuICAgICAgICBpbnB1dFdpdGhOb0hpbnQ6IHtcbiAgICAgICAgICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiLFxuICAgICAgICAgIHZlcnRpY2FsQWxpZ246IFwidG9wXCJcbiAgICAgICAgfSxcbiAgICAgICAgbWVudToge1xuICAgICAgICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgICAgICAgdG9wOiBcIjEwMCVcIixcbiAgICAgICAgICBsZWZ0OiBcIjBcIixcbiAgICAgICAgICB6SW5kZXg6IFwiMTAwXCIsXG4gICAgICAgICAgZGlzcGxheTogXCJub25lXCJcbiAgICAgICAgfSxcbiAgICAgICAgbHRyOiB7XG4gICAgICAgICAgbGVmdDogXCIwXCIsXG4gICAgICAgICAgcmlnaHQ6IFwiYXV0b1wiXG4gICAgICAgIH0sXG4gICAgICAgIHJ0bDoge1xuICAgICAgICAgIGxlZnQ6IFwiYXV0b1wiLFxuICAgICAgICAgIHJpZ2h0OiBcIiAwXCJcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgaWYgKF8uaXNNc2llKCkpIHtcbiAgICAgICAgXy5taXhpbihjc3MuaW5wdXQsIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6IFwidXJsKGRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQUFBQUFQLy8veUg1QkFFQUFBQUFMQUFBQUFBQkFBRUFBQUlCUkFBNylcIlxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNzcztcbiAgICB9XG4gIH0oKTtcblxuICB2YXIgRXZlbnRCdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgbmFtZXNwYWNlLCBkZXByZWNhdGlvbk1hcDtcbiAgICBuYW1lc3BhY2UgPSBcInR5cGVhaGVhZDpcIjtcbiAgICBkZXByZWNhdGlvbk1hcCA9IHtcbiAgICAgIHJlbmRlcjogXCJyZW5kZXJlZFwiLFxuICAgICAgY3Vyc29yY2hhbmdlOiBcImN1cnNvcmNoYW5nZWRcIixcbiAgICAgIHNlbGVjdDogXCJzZWxlY3RlZFwiLFxuICAgICAgYXV0b2NvbXBsZXRlOiBcImF1dG9jb21wbGV0ZWRcIlxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBFdmVudEJ1cyhvKSB7XG4gICAgICBpZiAoIW8gfHwgIW8uZWwpIHtcbiAgICAgICAgJC5lcnJvcihcIkV2ZW50QnVzIGluaXRpYWxpemVkIHdpdGhvdXQgZWxcIik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuJGVsID0gJChvLmVsKTtcbiAgICB9XG5cbiAgICBfLm1peGluKEV2ZW50QnVzLnByb3RvdHlwZSwge1xuICAgICAgX3RyaWdnZXI6IGZ1bmN0aW9uIF90cmlnZ2VyKHR5cGUsIGFyZ3MpIHtcbiAgICAgICAgdmFyICRlID0gJC5FdmVudChuYW1lc3BhY2UgKyB0eXBlKTtcbiAgICAgICAgdGhpcy4kZWwudHJpZ2dlci5jYWxsKHRoaXMuJGVsLCAkZSwgYXJncyB8fCBbXSk7XG4gICAgICAgIHJldHVybiAkZTtcbiAgICAgIH0sXG4gICAgICBiZWZvcmU6IGZ1bmN0aW9uIGJlZm9yZSh0eXBlKSB7XG4gICAgICAgIHZhciBhcmdzLCAkZTtcbiAgICAgICAgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICAgICAgJGUgPSB0aGlzLl90cmlnZ2VyKFwiYmVmb3JlXCIgKyB0eXBlLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuICRlLmlzRGVmYXVsdFByZXZlbnRlZCgpO1xuICAgICAgfSxcbiAgICAgIHRyaWdnZXI6IGZ1bmN0aW9uIHRyaWdnZXIodHlwZSkge1xuICAgICAgICB2YXIgZGVwcmVjYXRlZFR5cGU7XG5cbiAgICAgICAgdGhpcy5fdHJpZ2dlcih0eXBlLCBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuXG4gICAgICAgIGlmIChkZXByZWNhdGVkVHlwZSA9IGRlcHJlY2F0aW9uTWFwW3R5cGVdKSB7XG4gICAgICAgICAgdGhpcy5fdHJpZ2dlcihkZXByZWNhdGVkVHlwZSwgW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIEV2ZW50QnVzO1xuICB9KCk7XG5cbiAgdmFyIEV2ZW50RW1pdHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBzcGxpdHRlciA9IC9cXHMrLyxcbiAgICAgICAgbmV4dFRpY2sgPSBnZXROZXh0VGljaygpO1xuICAgIHJldHVybiB7XG4gICAgICBvblN5bmM6IG9uU3luYyxcbiAgICAgIG9uQXN5bmM6IG9uQXN5bmMsXG4gICAgICBvZmY6IG9mZixcbiAgICAgIHRyaWdnZXI6IHRyaWdnZXJcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gb24obWV0aG9kLCB0eXBlcywgY2IsIGNvbnRleHQpIHtcbiAgICAgIHZhciB0eXBlO1xuXG4gICAgICBpZiAoIWNiKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICB0eXBlcyA9IHR5cGVzLnNwbGl0KHNwbGl0dGVyKTtcbiAgICAgIGNiID0gY29udGV4dCA/IGJpbmRDb250ZXh0KGNiLCBjb250ZXh0KSA6IGNiO1xuICAgICAgdGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xuXG4gICAgICB3aGlsZSAodHlwZSA9IHR5cGVzLnNoaWZ0KCkpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzW3R5cGVdID0gdGhpcy5fY2FsbGJhY2tzW3R5cGVdIHx8IHtcbiAgICAgICAgICBzeW5jOiBbXSxcbiAgICAgICAgICBhc3luYzogW11cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9jYWxsYmFja3NbdHlwZV1bbWV0aG9kXS5wdXNoKGNiKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25Bc3luYyh0eXBlcywgY2IsIGNvbnRleHQpIHtcbiAgICAgIHJldHVybiBvbi5jYWxsKHRoaXMsIFwiYXN5bmNcIiwgdHlwZXMsIGNiLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblN5bmModHlwZXMsIGNiLCBjb250ZXh0KSB7XG4gICAgICByZXR1cm4gb24uY2FsbCh0aGlzLCBcInN5bmNcIiwgdHlwZXMsIGNiLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvZmYodHlwZXMpIHtcbiAgICAgIHZhciB0eXBlO1xuXG4gICAgICBpZiAoIXRoaXMuX2NhbGxiYWNrcykge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgdHlwZXMgPSB0eXBlcy5zcGxpdChzcGxpdHRlcik7XG5cbiAgICAgIHdoaWxlICh0eXBlID0gdHlwZXMuc2hpZnQoKSkge1xuICAgICAgICBkZWxldGUgdGhpcy5fY2FsbGJhY2tzW3R5cGVdO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0cmlnZ2VyKHR5cGVzKSB7XG4gICAgICB2YXIgdHlwZSwgY2FsbGJhY2tzLCBhcmdzLCBzeW5jRmx1c2gsIGFzeW5jRmx1c2g7XG5cbiAgICAgIGlmICghdGhpcy5fY2FsbGJhY2tzKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICB0eXBlcyA9IHR5cGVzLnNwbGl0KHNwbGl0dGVyKTtcbiAgICAgIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cbiAgICAgIHdoaWxlICgodHlwZSA9IHR5cGVzLnNoaWZ0KCkpICYmIChjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbdHlwZV0pKSB7XG4gICAgICAgIHN5bmNGbHVzaCA9IGdldEZsdXNoKGNhbGxiYWNrcy5zeW5jLCB0aGlzLCBbdHlwZV0uY29uY2F0KGFyZ3MpKTtcbiAgICAgICAgYXN5bmNGbHVzaCA9IGdldEZsdXNoKGNhbGxiYWNrcy5hc3luYywgdGhpcywgW3R5cGVdLmNvbmNhdChhcmdzKSk7XG4gICAgICAgIHN5bmNGbHVzaCgpICYmIG5leHRUaWNrKGFzeW5jRmx1c2gpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRGbHVzaChjYWxsYmFja3MsIGNvbnRleHQsIGFyZ3MpIHtcbiAgICAgIHJldHVybiBmbHVzaDtcblxuICAgICAgZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgICAgIHZhciBjYW5jZWxsZWQ7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNhbGxiYWNrcy5sZW5ndGg7ICFjYW5jZWxsZWQgJiYgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgICAgY2FuY2VsbGVkID0gY2FsbGJhY2tzW2ldLmFwcGx5KGNvbnRleHQsIGFyZ3MpID09PSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAhY2FuY2VsbGVkO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldE5leHRUaWNrKCkge1xuICAgICAgdmFyIG5leHRUaWNrRm47XG5cbiAgICAgIGlmICh3aW5kb3cuc2V0SW1tZWRpYXRlKSB7XG4gICAgICAgIG5leHRUaWNrRm4gPSBmdW5jdGlvbiBuZXh0VGlja1NldEltbWVkaWF0ZShmbikge1xuICAgICAgICAgIHNldEltbWVkaWF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmbigpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dFRpY2tGbiA9IGZ1bmN0aW9uIG5leHRUaWNrU2V0VGltZW91dChmbikge1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5leHRUaWNrRm47XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYmluZENvbnRleHQoZm4sIGNvbnRleHQpIHtcbiAgICAgIHJldHVybiBmbi5iaW5kID8gZm4uYmluZChjb250ZXh0KSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm4uYXBwbHkoY29udGV4dCwgW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDApKTtcbiAgICAgIH07XG4gICAgfVxuICB9KCk7XG5cbiAgdmFyIGhpZ2hsaWdodCA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBkZWZhdWx0cyA9IHtcbiAgICAgIG5vZGU6IG51bGwsXG4gICAgICBwYXR0ZXJuOiBudWxsLFxuICAgICAgdGFnTmFtZTogXCJzdHJvbmdcIixcbiAgICAgIGNsYXNzTmFtZTogbnVsbCxcbiAgICAgIHdvcmRzT25seTogZmFsc2UsXG4gICAgICBjYXNlU2Vuc2l0aXZlOiBmYWxzZSxcbiAgICAgIGRpYWNyaXRpY0luc2Vuc2l0aXZlOiBmYWxzZVxuICAgIH07XG4gICAgdmFyIGFjY2VudGVkID0ge1xuICAgICAgQTogXCJbQWHCqsOALcOFw6Atw6XEgC3EhceNx47IgC3Ig8imyKfhtKzhtYPhuIDhuIHhuprhuqAt4bqj4oKQ4oSA4oSB4oS74pKc4pK24pOQ442xLeONtOOOgC3jjoTjjojjjonjjqkt446v44+C44+K44+f44+/77yh772BXVwiLFxuICAgICAgQjogXCJbQmLhtK7htYfhuIIt4biH4oSs4pKd4pK34pOR4420446FLeOOh+OPg+OPiOOPlOOPne+8ou+9gl1cIixcbiAgICAgIEM6IFwiW0Njw4fDp8SGLcSN4bac4oSA4oSC4oSD4oSF4oSG4oSt4oWt4oW94pKe4pK44pOS4422446I446J446d446g446k44+ELeOPh++8o++9g11cIixcbiAgICAgIEQ6IFwiW0RkxI7Ej8eELceGx7Etx7PhtLDhtYjhuIot4biT4oWF4oWG4oWu4oW+4pKf4pK54pOT44uP442y4423LeONueOOl+OOrS3jjq/jj4Xjj4jvvKTvvYRdXCIsXG4gICAgICBFOiBcIltFZcOILcOLw6gtw6vEki3Em8iELciHyKjIqeG0seG1ieG4mC3huJvhurgt4bq94oKR4oSh4oSv4oSw4oWH4pKg4pK64pOU44mQ44uN44uO77yl772FXVwiLFxuICAgICAgRjogXCJbRmbhtqDhuJ7huJ/ihInihLHihLvikqHikrvik5Xjjoot446M446Z76yALe+shO+8pu+9hl1cIixcbiAgICAgIEc6IFwiW0dnxJwtxKPHpsenx7THteG0s+G1jeG4oOG4oeKEiuKSouKSvOKTluOLjOOLjeOOh+OOjS3jjo/jjpPjjqzjj4bjj4njj5Ljj7/vvKfvvYddXCIsXG4gICAgICBIOiBcIltIaMSkxKXInsifyrDhtLThuKIt4bir4bqW4oSLLeKEjuKSo+KSveKTl+OLjOONseOOkC3jjpTjj4rjj4vjj5fvvKjvvYhdXCIsXG4gICAgICBJOiBcIltJacOMLcOPw6wtw6/EqC3EsMSyxLPHj8eQyIgtyIvhtLXhtaLhuKzhuK3hu4gt4buL4oGx4oSQ4oSR4oS54oWI4oWgLeKFo+KFpS3ihajiharihavihbAt4oWz4oW1LeKFuOKFuuKFu+KSpOKSvuKTmOONuuOPjOOPle+sge+sg++8qe+9iV1cIixcbiAgICAgIEo6IFwiW0pqxLItxLXHhy3HjMewyrLhtLbihYnikqXikr/ik5nisbzvvKrvvYpdXCIsXG4gICAgICBLOiBcIltLa8S2xLfHqMep4bS34bWP4biwLeG4teKEquKSpuKTgOKTmuOOhOOOheOOieOOj+OOkeOOmOOOnuOOouOOpuOOquOOuOOOvuOPgOOPhuOPjS3jj4/vvKvvvYtdXCIsXG4gICAgICBMOiBcIltMbMS5LcWAx4ctx4nLoeG0uOG4tuG4t+G4ui3huL3ihJLihJPihKHihazihbzikqfik4Hik5vji4/jjojjjonjj5At44+T44+V44+W44+/76yC76yE77ys772MXVwiLFxuICAgICAgTTogXCJbTW3htLnhtZDhuL4t4bmD4oSg4oSi4oSz4oWv4oW/4pKo4pOC4pOc4423LeONueOOg+OOhuOOjuOOkuOOluOOmS3jjqjjjqvjjrPjjrfjjrnjjr3jjr/jj4Hjj4Ljj47jj5Djj5Qt44+W44+Y44+Z44+e44+f77yt772NXVwiLFxuICAgICAgTjogXCJbTm7DkcOxxYMtxYnHii3HjMe4x7nhtLrhuYQt4bmL4oG/4oSV4oSW4pKp4pOD4pOd446B446L446a446x4461446744+M44+R77yu772OXVwiLFxuICAgICAgTzogXCJbT2/CusOSLcOWw7Itw7bFjC3FkcagxqHHkceSx6rHq8iMLciPyK7Ir+G0vOG1kuG7jC3hu4/igpLihIXihJbihLTikqrik4Tik57jjbXjj4fjj5Ljj5bvvK/vvY9dXCIsXG4gICAgICBQOiBcIltQcOG0vuG1luG5lC3huZfihJnikqvik4Xik5/jiZDjjbHjjbbjjoDjjorjjqkt446s446w4460446644+L44+XLeOPmu+8sO+9kF1cIixcbiAgICAgIFE6IFwiW1Fx4oSa4pKs4pOG4pOg44+D77yx772RXVwiLFxuICAgICAgUjogXCJbUnLFlC3FmciQLciTyrPhtL/htaPhuZgt4bmb4bme4bmf4oKo4oSbLeKEneKSreKTh+KToeOLjeONtOOOrS3jjq/jj5rjj5vvvLLvvZJdXCIsXG4gICAgICBTOiBcIltTc8WaLcWhxb/ImMiZy6LhuaAt4bmj4oKo4oSB4oSg4pKu4pOI4pOi446n446o446uLeOOs+OPm+OPnO+shu+8s++9k11cIixcbiAgICAgIFQ6IFwiW1R0xaItxaXImsib4bWA4bWX4bmqLeG5seG6l+KEoeKEouKSr+KTieKTo+OJkOOLj+OOlOOPj++she+shu+8tO+9lF1cIixcbiAgICAgIFU6IFwiW1V1w5ktw5zDuS3DvMWoLcWzxq/GsMeTx5TIlC3Il+G1geG1mOG1pOG5si3hubfhu6Qt4bun4oSG4pKw4pOK4pOk442z442677y1772VXVwiLFxuICAgICAgVjogXCJbVnbhtZvhtaXhubwt4bm/4oWjLeKFp+KFsy3ihbfikrHik4vik6Xisb3ji47jjbXjjrQt446544+c44+e77y2772WXVwiLFxuICAgICAgVzogXCJbV3fFtMW1yrfhtYLhuoAt4bqJ4bqY4pKy4pOM4pOm4466LeOOv+OPne+8t++9l11cIixcbiAgICAgIFg6IFwiW1h4y6Phuoot4bqN4oKT4oS74oWoLeKFq+KFuC3ihbvikrPik43ik6fjj5PvvLjvvZhdXCIsXG4gICAgICBZOiBcIltZecOdw73Dv8W2LcW4yLLIs8q44bqO4bqP4bqZ4buyLeG7ueKStOKTjuKTqOOPie+8ue+9mV1cIixcbiAgICAgIFo6IFwiW1p6xbktxb7HsS3Hs+G2u+G6kC3hupXihKTihKjikrXik4/ik6njjpAt446U77y6772aXVwiXG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gaGlnaHRsaWdodChvKSB7XG4gICAgICB2YXIgcmVnZXg7XG4gICAgICBvID0gXy5taXhpbih7fSwgZGVmYXVsdHMsIG8pO1xuXG4gICAgICBpZiAoIW8ubm9kZSB8fCAhby5wYXR0ZXJuKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgby5wYXR0ZXJuID0gXy5pc0FycmF5KG8ucGF0dGVybikgPyBvLnBhdHRlcm4gOiBbby5wYXR0ZXJuXTtcbiAgICAgIHJlZ2V4ID0gZ2V0UmVnZXgoby5wYXR0ZXJuLCBvLmNhc2VTZW5zaXRpdmUsIG8ud29yZHNPbmx5LCBvLmRpYWNyaXRpY0luc2Vuc2l0aXZlKTtcbiAgICAgIHRyYXZlcnNlKG8ubm9kZSwgaGlnaHRsaWdodFRleHROb2RlKTtcblxuICAgICAgZnVuY3Rpb24gaGlnaHRsaWdodFRleHROb2RlKHRleHROb2RlKSB7XG4gICAgICAgIHZhciBtYXRjaCwgcGF0dGVybk5vZGUsIHdyYXBwZXJOb2RlO1xuXG4gICAgICAgIGlmIChtYXRjaCA9IHJlZ2V4LmV4ZWModGV4dE5vZGUuZGF0YSkpIHtcbiAgICAgICAgICB3cmFwcGVyTm9kZSA9IGRvYy5jcmVhdGVFbGVtZW50KG8udGFnTmFtZSk7XG4gICAgICAgICAgby5jbGFzc05hbWUgJiYgKHdyYXBwZXJOb2RlLmNsYXNzTmFtZSA9IG8uY2xhc3NOYW1lKTtcbiAgICAgICAgICBwYXR0ZXJuTm9kZSA9IHRleHROb2RlLnNwbGl0VGV4dChtYXRjaC5pbmRleCk7XG4gICAgICAgICAgcGF0dGVybk5vZGUuc3BsaXRUZXh0KG1hdGNoWzBdLmxlbmd0aCk7XG4gICAgICAgICAgd3JhcHBlck5vZGUuYXBwZW5kQ2hpbGQocGF0dGVybk5vZGUuY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgICAgICB0ZXh0Tm9kZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCh3cmFwcGVyTm9kZSwgcGF0dGVybk5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICEhbWF0Y2g7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHRyYXZlcnNlKGVsLCBoaWdodGxpZ2h0VGV4dE5vZGUpIHtcbiAgICAgICAgdmFyIGNoaWxkTm9kZSxcbiAgICAgICAgICAgIFRFWFRfTk9ERV9UWVBFID0gMztcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsLmNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjaGlsZE5vZGUgPSBlbC5jaGlsZE5vZGVzW2ldO1xuXG4gICAgICAgICAgaWYgKGNoaWxkTm9kZS5ub2RlVHlwZSA9PT0gVEVYVF9OT0RFX1RZUEUpIHtcbiAgICAgICAgICAgIGkgKz0gaGlnaHRsaWdodFRleHROb2RlKGNoaWxkTm9kZSkgPyAxIDogMDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJhdmVyc2UoY2hpbGROb2RlLCBoaWdodGxpZ2h0VGV4dE5vZGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBhY2NlbnRfcmVwbGFjZXIoY2hyKSB7XG4gICAgICByZXR1cm4gYWNjZW50ZWRbY2hyLnRvVXBwZXJDYXNlKCldIHx8IGNocjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRSZWdleChwYXR0ZXJucywgY2FzZVNlbnNpdGl2ZSwgd29yZHNPbmx5LCBkaWFjcml0aWNJbnNlbnNpdGl2ZSkge1xuICAgICAgdmFyIGVzY2FwZWRQYXR0ZXJucyA9IFtdLFxuICAgICAgICAgIHJlZ2V4U3RyO1xuXG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGF0dGVybnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIGVzY2FwZWRXb3JkID0gXy5lc2NhcGVSZWdFeENoYXJzKHBhdHRlcm5zW2ldKTtcblxuICAgICAgICBpZiAoZGlhY3JpdGljSW5zZW5zaXRpdmUpIHtcbiAgICAgICAgICBlc2NhcGVkV29yZCA9IGVzY2FwZWRXb3JkLnJlcGxhY2UoL1xcUy9nLCBhY2NlbnRfcmVwbGFjZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZXNjYXBlZFBhdHRlcm5zLnB1c2goZXNjYXBlZFdvcmQpO1xuICAgICAgfVxuXG4gICAgICByZWdleFN0ciA9IHdvcmRzT25seSA/IFwiXFxcXGIoXCIgKyBlc2NhcGVkUGF0dGVybnMuam9pbihcInxcIikgKyBcIilcXFxcYlwiIDogXCIoXCIgKyBlc2NhcGVkUGF0dGVybnMuam9pbihcInxcIikgKyBcIilcIjtcbiAgICAgIHJldHVybiBjYXNlU2Vuc2l0aXZlID8gbmV3IFJlZ0V4cChyZWdleFN0cikgOiBuZXcgUmVnRXhwKHJlZ2V4U3RyLCBcImlcIik7XG4gICAgfVxuICB9KHdpbmRvdy5kb2N1bWVudCk7XG5cbiAgdmFyIElucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgdmFyIHNwZWNpYWxLZXlDb2RlTWFwO1xuICAgIHNwZWNpYWxLZXlDb2RlTWFwID0ge1xuICAgICAgOTogXCJ0YWJcIixcbiAgICAgIDI3OiBcImVzY1wiLFxuICAgICAgMzc6IFwibGVmdFwiLFxuICAgICAgMzk6IFwicmlnaHRcIixcbiAgICAgIDEzOiBcImVudGVyXCIsXG4gICAgICAzODogXCJ1cFwiLFxuICAgICAgNDA6IFwiZG93blwiXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIElucHV0KG8sIHd3dykge1xuICAgICAgbyA9IG8gfHwge307XG5cbiAgICAgIGlmICghby5pbnB1dCkge1xuICAgICAgICAkLmVycm9yKFwiaW5wdXQgaXMgbWlzc2luZ1wiKTtcbiAgICAgIH1cblxuICAgICAgd3d3Lm1peGluKHRoaXMpO1xuICAgICAgdGhpcy4kaGludCA9ICQoby5oaW50KTtcbiAgICAgIHRoaXMuJGlucHV0ID0gJChvLmlucHV0KTtcbiAgICAgIHRoaXMuJGlucHV0LmF0dHIoe1xuICAgICAgICBcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiOiBcIlwiLFxuICAgICAgICBcImFyaWEtb3duc1wiOiB0aGlzLiRpbnB1dC5hdHRyKFwiaWRcIikgKyBcIl9saXN0Ym94XCIsXG4gICAgICAgIHJvbGU6IFwiY29tYm9ib3hcIixcbiAgICAgICAgXCJhcmlhLXJlYWRvbmx5XCI6IFwidHJ1ZVwiLFxuICAgICAgICBcImFyaWEtYXV0b2NvbXBsZXRlXCI6IFwibGlzdFwiXG4gICAgICB9KTtcbiAgICAgICQod3d3Lm1lbnUpLmF0dHIoXCJpZFwiLCB0aGlzLiRpbnB1dC5hdHRyKFwiaWRcIikgKyBcIl9saXN0Ym94XCIpO1xuICAgICAgdGhpcy5xdWVyeSA9IHRoaXMuJGlucHV0LnZhbCgpO1xuICAgICAgdGhpcy5xdWVyeVdoZW5Gb2N1c2VkID0gdGhpcy5oYXNGb2N1cygpID8gdGhpcy5xdWVyeSA6IG51bGw7XG4gICAgICB0aGlzLiRvdmVyZmxvd0hlbHBlciA9IGJ1aWxkT3ZlcmZsb3dIZWxwZXIodGhpcy4kaW5wdXQpO1xuXG4gICAgICB0aGlzLl9jaGVja0xhbmd1YWdlRGlyZWN0aW9uKCk7XG5cbiAgICAgIGlmICh0aGlzLiRoaW50Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aGlzLnNldEhpbnQgPSB0aGlzLmdldEhpbnQgPSB0aGlzLmNsZWFySGludCA9IHRoaXMuY2xlYXJIaW50SWZJbnZhbGlkID0gXy5ub29wO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm9uU3luYyhcImN1cnNvcmNoYW5nZVwiLCB0aGlzLl91cGRhdGVEZXNjZW5kZW50KTtcbiAgICB9XG5cbiAgICBJbnB1dC5ub3JtYWxpemVRdWVyeSA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICAgIHJldHVybiBfLnRvU3RyKHN0cikucmVwbGFjZSgvXlxccyovZywgXCJcIikucmVwbGFjZSgvXFxzezIsfS9nLCBcIiBcIik7XG4gICAgfTtcblxuICAgIF8ubWl4aW4oSW5wdXQucHJvdG90eXBlLCBFdmVudEVtaXR0ZXIsIHtcbiAgICAgIF9vbkJsdXI6IGZ1bmN0aW9uIG9uQmx1cigpIHtcbiAgICAgICAgdGhpcy5yZXNldElucHV0VmFsdWUoKTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKFwiYmx1cnJlZFwiKTtcbiAgICAgIH0sXG4gICAgICBfb25Gb2N1czogZnVuY3Rpb24gb25Gb2N1cygpIHtcbiAgICAgICAgdGhpcy5xdWVyeVdoZW5Gb2N1c2VkID0gdGhpcy5xdWVyeTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKFwiZm9jdXNlZFwiKTtcbiAgICAgIH0sXG4gICAgICBfb25LZXlkb3duOiBmdW5jdGlvbiBvbktleWRvd24oJGUpIHtcbiAgICAgICAgdmFyIGtleU5hbWUgPSBzcGVjaWFsS2V5Q29kZU1hcFskZS53aGljaCB8fCAkZS5rZXlDb2RlXTtcblxuICAgICAgICB0aGlzLl9tYW5hZ2VQcmV2ZW50RGVmYXVsdChrZXlOYW1lLCAkZSk7XG5cbiAgICAgICAgaWYgKGtleU5hbWUgJiYgdGhpcy5fc2hvdWxkVHJpZ2dlcihrZXlOYW1lLCAkZSkpIHtcbiAgICAgICAgICB0aGlzLnRyaWdnZXIoa2V5TmFtZSArIFwiS2V5ZWRcIiwgJGUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgX29uSW5wdXQ6IGZ1bmN0aW9uIG9uSW5wdXQoKSB7XG4gICAgICAgIHRoaXMuX3NldFF1ZXJ5KHRoaXMuZ2V0SW5wdXRWYWx1ZSgpKTtcblxuICAgICAgICB0aGlzLmNsZWFySGludElmSW52YWxpZCgpO1xuXG4gICAgICAgIHRoaXMuX2NoZWNrTGFuZ3VhZ2VEaXJlY3Rpb24oKTtcbiAgICAgIH0sXG4gICAgICBfbWFuYWdlUHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uIG1hbmFnZVByZXZlbnREZWZhdWx0KGtleU5hbWUsICRlKSB7XG4gICAgICAgIHZhciBwcmV2ZW50RGVmYXVsdDtcblxuICAgICAgICBzd2l0Y2ggKGtleU5hbWUpIHtcbiAgICAgICAgICBjYXNlIFwidXBcIjpcbiAgICAgICAgICBjYXNlIFwiZG93blwiOlxuICAgICAgICAgICAgcHJldmVudERlZmF1bHQgPSAhd2l0aE1vZGlmaWVyKCRlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHByZXZlbnREZWZhdWx0ID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBwcmV2ZW50RGVmYXVsdCAmJiAkZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfSxcbiAgICAgIF9zaG91bGRUcmlnZ2VyOiBmdW5jdGlvbiBzaG91bGRUcmlnZ2VyKGtleU5hbWUsICRlKSB7XG4gICAgICAgIHZhciB0cmlnZ2VyO1xuXG4gICAgICAgIHN3aXRjaCAoa2V5TmFtZSkge1xuICAgICAgICAgIGNhc2UgXCJ0YWJcIjpcbiAgICAgICAgICAgIHRyaWdnZXIgPSAhd2l0aE1vZGlmaWVyKCRlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRyaWdnZXIgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRyaWdnZXI7XG4gICAgICB9LFxuICAgICAgX2NoZWNrTGFuZ3VhZ2VEaXJlY3Rpb246IGZ1bmN0aW9uIGNoZWNrTGFuZ3VhZ2VEaXJlY3Rpb24oKSB7XG4gICAgICAgIHZhciBkaXIgPSAodGhpcy4kaW5wdXQuY3NzKFwiZGlyZWN0aW9uXCIpIHx8IFwibHRyXCIpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuZGlyICE9PSBkaXIpIHtcbiAgICAgICAgICB0aGlzLmRpciA9IGRpcjtcbiAgICAgICAgICB0aGlzLiRoaW50LmF0dHIoXCJkaXJcIiwgZGlyKTtcbiAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJsYW5nRGlyQ2hhbmdlZFwiLCBkaXIpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgX3NldFF1ZXJ5OiBmdW5jdGlvbiBzZXRRdWVyeSh2YWwsIHNpbGVudCkge1xuICAgICAgICB2YXIgYXJlRXF1aXZhbGVudCwgaGFzRGlmZmVyZW50V2hpdGVzcGFjZTtcbiAgICAgICAgYXJlRXF1aXZhbGVudCA9IGFyZVF1ZXJpZXNFcXVpdmFsZW50KHZhbCwgdGhpcy5xdWVyeSk7XG4gICAgICAgIGhhc0RpZmZlcmVudFdoaXRlc3BhY2UgPSBhcmVFcXVpdmFsZW50ID8gdGhpcy5xdWVyeS5sZW5ndGggIT09IHZhbC5sZW5ndGggOiBmYWxzZTtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHZhbDtcblxuICAgICAgICBpZiAoIXNpbGVudCAmJiAhYXJlRXF1aXZhbGVudCkge1xuICAgICAgICAgIHRoaXMudHJpZ2dlcihcInF1ZXJ5Q2hhbmdlZFwiLCB0aGlzLnF1ZXJ5KTtcbiAgICAgICAgfSBlbHNlIGlmICghc2lsZW50ICYmIGhhc0RpZmZlcmVudFdoaXRlc3BhY2UpIHtcbiAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJ3aGl0ZXNwYWNlQ2hhbmdlZFwiLCB0aGlzLnF1ZXJ5KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIF91cGRhdGVEZXNjZW5kZW50OiBmdW5jdGlvbiB1cGRhdGVEZXNjZW5kZW50KGV2ZW50LCBpZCkge1xuICAgICAgICB0aGlzLiRpbnB1dC5hdHRyKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIsIGlkKTtcbiAgICAgIH0sXG4gICAgICBiaW5kOiBmdW5jdGlvbiBiaW5kKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBvbkJsdXIsXG4gICAgICAgICAgICBvbkZvY3VzLFxuICAgICAgICAgICAgb25LZXlkb3duLFxuICAgICAgICAgICAgb25JbnB1dDtcbiAgICAgICAgb25CbHVyID0gXy5iaW5kKHRoaXMuX29uQmx1ciwgdGhpcyk7XG4gICAgICAgIG9uRm9jdXMgPSBfLmJpbmQodGhpcy5fb25Gb2N1cywgdGhpcyk7XG4gICAgICAgIG9uS2V5ZG93biA9IF8uYmluZCh0aGlzLl9vbktleWRvd24sIHRoaXMpO1xuICAgICAgICBvbklucHV0ID0gXy5iaW5kKHRoaXMuX29uSW5wdXQsIHRoaXMpO1xuICAgICAgICB0aGlzLiRpbnB1dC5vbihcImJsdXIudHRcIiwgb25CbHVyKS5vbihcImZvY3VzLnR0XCIsIG9uRm9jdXMpLm9uKFwia2V5ZG93bi50dFwiLCBvbktleWRvd24pO1xuXG4gICAgICAgIGlmICghXy5pc01zaWUoKSB8fCBfLmlzTXNpZSgpID4gOSkge1xuICAgICAgICAgIHRoaXMuJGlucHV0Lm9uKFwiaW5wdXQudHRcIiwgb25JbnB1dCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy4kaW5wdXQub24oXCJrZXlkb3duLnR0IGtleXByZXNzLnR0IGN1dC50dCBwYXN0ZS50dFwiLCBmdW5jdGlvbiAoJGUpIHtcbiAgICAgICAgICAgIGlmIChzcGVjaWFsS2V5Q29kZU1hcFskZS53aGljaCB8fCAkZS5rZXlDb2RlXSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF8uZGVmZXIoXy5iaW5kKHRoYXQuX29uSW5wdXQsIHRoYXQsICRlKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0sXG4gICAgICBmb2N1czogZnVuY3Rpb24gZm9jdXMoKSB7XG4gICAgICAgIHRoaXMuJGlucHV0LmZvY3VzKCk7XG4gICAgICB9LFxuICAgICAgYmx1cjogZnVuY3Rpb24gYmx1cigpIHtcbiAgICAgICAgdGhpcy4kaW5wdXQuYmx1cigpO1xuICAgICAgfSxcbiAgICAgIGdldExhbmdEaXI6IGZ1bmN0aW9uIGdldExhbmdEaXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpcjtcbiAgICAgIH0sXG4gICAgICBnZXRRdWVyeTogZnVuY3Rpb24gZ2V0UXVlcnkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5IHx8IFwiXCI7XG4gICAgICB9LFxuICAgICAgc2V0UXVlcnk6IGZ1bmN0aW9uIHNldFF1ZXJ5KHZhbCwgc2lsZW50KSB7XG4gICAgICAgIHRoaXMuc2V0SW5wdXRWYWx1ZSh2YWwpO1xuXG4gICAgICAgIHRoaXMuX3NldFF1ZXJ5KHZhbCwgc2lsZW50KTtcbiAgICAgIH0sXG4gICAgICBoYXNRdWVyeUNoYW5nZWRTaW5jZUxhc3RGb2N1czogZnVuY3Rpb24gaGFzUXVlcnlDaGFuZ2VkU2luY2VMYXN0Rm9jdXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5ICE9PSB0aGlzLnF1ZXJ5V2hlbkZvY3VzZWQ7XG4gICAgICB9LFxuICAgICAgZ2V0SW5wdXRWYWx1ZTogZnVuY3Rpb24gZ2V0SW5wdXRWYWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJGlucHV0LnZhbCgpO1xuICAgICAgfSxcbiAgICAgIHNldElucHV0VmFsdWU6IGZ1bmN0aW9uIHNldElucHV0VmFsdWUodmFsdWUpIHtcbiAgICAgICAgdGhpcy4kaW5wdXQudmFsKHZhbHVlKTtcbiAgICAgICAgdGhpcy5jbGVhckhpbnRJZkludmFsaWQoKTtcblxuICAgICAgICB0aGlzLl9jaGVja0xhbmd1YWdlRGlyZWN0aW9uKCk7XG4gICAgICB9LFxuICAgICAgcmVzZXRJbnB1dFZhbHVlOiBmdW5jdGlvbiByZXNldElucHV0VmFsdWUoKSB7XG4gICAgICAgIHRoaXMuc2V0SW5wdXRWYWx1ZSh0aGlzLnF1ZXJ5KTtcbiAgICAgIH0sXG4gICAgICBnZXRIaW50OiBmdW5jdGlvbiBnZXRIaW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kaGludC52YWwoKTtcbiAgICAgIH0sXG4gICAgICBzZXRIaW50OiBmdW5jdGlvbiBzZXRIaW50KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuJGhpbnQudmFsKHZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBjbGVhckhpbnQ6IGZ1bmN0aW9uIGNsZWFySGludCgpIHtcbiAgICAgICAgdGhpcy5zZXRIaW50KFwiXCIpO1xuICAgICAgfSxcbiAgICAgIGNsZWFySGludElmSW52YWxpZDogZnVuY3Rpb24gY2xlYXJIaW50SWZJbnZhbGlkKCkge1xuICAgICAgICB2YXIgdmFsLCBoaW50LCB2YWxJc1ByZWZpeE9mSGludCwgaXNWYWxpZDtcbiAgICAgICAgdmFsID0gdGhpcy5nZXRJbnB1dFZhbHVlKCk7XG4gICAgICAgIGhpbnQgPSB0aGlzLmdldEhpbnQoKTtcbiAgICAgICAgdmFsSXNQcmVmaXhPZkhpbnQgPSB2YWwgIT09IGhpbnQgJiYgaGludC5pbmRleE9mKHZhbCkgPT09IDA7XG4gICAgICAgIGlzVmFsaWQgPSB2YWwgIT09IFwiXCIgJiYgdmFsSXNQcmVmaXhPZkhpbnQgJiYgIXRoaXMuaGFzT3ZlcmZsb3coKTtcbiAgICAgICAgIWlzVmFsaWQgJiYgdGhpcy5jbGVhckhpbnQoKTtcbiAgICAgIH0sXG4gICAgICBoYXNGb2N1czogZnVuY3Rpb24gaGFzRm9jdXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRpbnB1dC5pcyhcIjpmb2N1c1wiKTtcbiAgICAgIH0sXG4gICAgICBoYXNPdmVyZmxvdzogZnVuY3Rpb24gaGFzT3ZlcmZsb3coKSB7XG4gICAgICAgIHZhciBjb25zdHJhaW50ID0gdGhpcy4kaW5wdXQud2lkdGgoKSAtIDI7XG4gICAgICAgIHRoaXMuJG92ZXJmbG93SGVscGVyLnRleHQodGhpcy5nZXRJbnB1dFZhbHVlKCkpO1xuICAgICAgICByZXR1cm4gdGhpcy4kb3ZlcmZsb3dIZWxwZXIud2lkdGgoKSA+PSBjb25zdHJhaW50O1xuICAgICAgfSxcbiAgICAgIGlzQ3Vyc29yQXRFbmQ6IGZ1bmN0aW9uIGlzQ3Vyc29yQXRFbmQoKSB7XG4gICAgICAgIHZhciB2YWx1ZUxlbmd0aCwgc2VsZWN0aW9uU3RhcnQsIHJhbmdlO1xuICAgICAgICB2YWx1ZUxlbmd0aCA9IHRoaXMuJGlucHV0LnZhbCgpLmxlbmd0aDtcbiAgICAgICAgc2VsZWN0aW9uU3RhcnQgPSB0aGlzLiRpbnB1dFswXS5zZWxlY3Rpb25TdGFydDtcblxuICAgICAgICBpZiAoXy5pc051bWJlcihzZWxlY3Rpb25TdGFydCkpIHtcbiAgICAgICAgICByZXR1cm4gc2VsZWN0aW9uU3RhcnQgPT09IHZhbHVlTGVuZ3RoO1xuICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikge1xuICAgICAgICAgIHJhbmdlID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgICAgcmFuZ2UubW92ZVN0YXJ0KFwiY2hhcmFjdGVyXCIsIC12YWx1ZUxlbmd0aCk7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlTGVuZ3RoID09PSByYW5nZS50ZXh0Lmxlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSxcbiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuJGhpbnQub2ZmKFwiLnR0XCIpO1xuICAgICAgICB0aGlzLiRpbnB1dC5vZmYoXCIudHRcIik7XG4gICAgICAgIHRoaXMuJG92ZXJmbG93SGVscGVyLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLiRoaW50ID0gdGhpcy4kaW5wdXQgPSB0aGlzLiRvdmVyZmxvd0hlbHBlciA9ICQoXCI8ZGl2PlwiKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBJbnB1dDtcblxuICAgIGZ1bmN0aW9uIGJ1aWxkT3ZlcmZsb3dIZWxwZXIoJGlucHV0KSB7XG4gICAgICByZXR1cm4gJCgnPHByZSBhcmlhLWhpZGRlbj1cInRydWVcIj48L3ByZT4nKS5jc3Moe1xuICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgICAgICB2aXNpYmlsaXR5OiBcImhpZGRlblwiLFxuICAgICAgICB3aGl0ZVNwYWNlOiBcInByZVwiLFxuICAgICAgICBmb250RmFtaWx5OiAkaW5wdXQuY3NzKFwiZm9udC1mYW1pbHlcIiksXG4gICAgICAgIGZvbnRTaXplOiAkaW5wdXQuY3NzKFwiZm9udC1zaXplXCIpLFxuICAgICAgICBmb250U3R5bGU6ICRpbnB1dC5jc3MoXCJmb250LXN0eWxlXCIpLFxuICAgICAgICBmb250VmFyaWFudDogJGlucHV0LmNzcyhcImZvbnQtdmFyaWFudFwiKSxcbiAgICAgICAgZm9udFdlaWdodDogJGlucHV0LmNzcyhcImZvbnQtd2VpZ2h0XCIpLFxuICAgICAgICB3b3JkU3BhY2luZzogJGlucHV0LmNzcyhcIndvcmQtc3BhY2luZ1wiKSxcbiAgICAgICAgbGV0dGVyU3BhY2luZzogJGlucHV0LmNzcyhcImxldHRlci1zcGFjaW5nXCIpLFxuICAgICAgICB0ZXh0SW5kZW50OiAkaW5wdXQuY3NzKFwidGV4dC1pbmRlbnRcIiksXG4gICAgICAgIHRleHRSZW5kZXJpbmc6ICRpbnB1dC5jc3MoXCJ0ZXh0LXJlbmRlcmluZ1wiKSxcbiAgICAgICAgdGV4dFRyYW5zZm9ybTogJGlucHV0LmNzcyhcInRleHQtdHJhbnNmb3JtXCIpXG4gICAgICB9KS5pbnNlcnRBZnRlcigkaW5wdXQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFyZVF1ZXJpZXNFcXVpdmFsZW50KGEsIGIpIHtcbiAgICAgIHJldHVybiBJbnB1dC5ub3JtYWxpemVRdWVyeShhKSA9PT0gSW5wdXQubm9ybWFsaXplUXVlcnkoYik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2l0aE1vZGlmaWVyKCRlKSB7XG4gICAgICByZXR1cm4gJGUuYWx0S2V5IHx8ICRlLmN0cmxLZXkgfHwgJGUubWV0YUtleSB8fCAkZS5zaGlmdEtleTtcbiAgICB9XG4gIH0oKTtcblxuICB2YXIgRGF0YXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBrZXlzLCBuYW1lR2VuZXJhdG9yO1xuICAgIGtleXMgPSB7XG4gICAgICBkYXRhc2V0OiBcInR0LXNlbGVjdGFibGUtZGF0YXNldFwiLFxuICAgICAgdmFsOiBcInR0LXNlbGVjdGFibGUtZGlzcGxheVwiLFxuICAgICAgb2JqOiBcInR0LXNlbGVjdGFibGUtb2JqZWN0XCJcbiAgICB9O1xuICAgIG5hbWVHZW5lcmF0b3IgPSBfLmdldElkR2VuZXJhdG9yKCk7XG5cbiAgICBmdW5jdGlvbiBEYXRhc2V0KG8sIHd3dykge1xuICAgICAgbyA9IG8gfHwge307XG4gICAgICBvLnRlbXBsYXRlcyA9IG8udGVtcGxhdGVzIHx8IHt9O1xuICAgICAgby50ZW1wbGF0ZXMubm90Rm91bmQgPSBvLnRlbXBsYXRlcy5ub3RGb3VuZCB8fCBvLnRlbXBsYXRlcy5lbXB0eTtcblxuICAgICAgaWYgKCFvLnNvdXJjZSkge1xuICAgICAgICAkLmVycm9yKFwibWlzc2luZyBzb3VyY2VcIik7XG4gICAgICB9XG5cbiAgICAgIGlmICghby5ub2RlKSB7XG4gICAgICAgICQuZXJyb3IoXCJtaXNzaW5nIG5vZGVcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChvLm5hbWUgJiYgIWlzVmFsaWROYW1lKG8ubmFtZSkpIHtcbiAgICAgICAgJC5lcnJvcihcImludmFsaWQgZGF0YXNldCBuYW1lOiBcIiArIG8ubmFtZSk7XG4gICAgICB9XG5cbiAgICAgIHd3dy5taXhpbih0aGlzKTtcbiAgICAgIHRoaXMuaGlnaGxpZ2h0ID0gISFvLmhpZ2hsaWdodDtcbiAgICAgIHRoaXMubmFtZSA9IF8udG9TdHIoby5uYW1lIHx8IG5hbWVHZW5lcmF0b3IoKSk7XG4gICAgICB0aGlzLmxpbWl0ID0gby5saW1pdCB8fCA1O1xuICAgICAgdGhpcy5kaXNwbGF5Rm4gPSBnZXREaXNwbGF5Rm4oby5kaXNwbGF5IHx8IG8uZGlzcGxheUtleSk7XG4gICAgICB0aGlzLnRlbXBsYXRlcyA9IGdldFRlbXBsYXRlcyhvLnRlbXBsYXRlcywgdGhpcy5kaXNwbGF5Rm4pO1xuICAgICAgdGhpcy5zb3VyY2UgPSBvLnNvdXJjZS5fX3R0QWRhcHRlciA/IG8uc291cmNlLl9fdHRBZGFwdGVyKCkgOiBvLnNvdXJjZTtcbiAgICAgIHRoaXMuYXN5bmMgPSBfLmlzVW5kZWZpbmVkKG8uYXN5bmMpID8gdGhpcy5zb3VyY2UubGVuZ3RoID4gMiA6ICEhby5hc3luYztcblxuICAgICAgdGhpcy5fcmVzZXRMYXN0U3VnZ2VzdGlvbigpO1xuXG4gICAgICB0aGlzLiRlbCA9ICQoby5ub2RlKS5hdHRyKFwicm9sZVwiLCBcInByZXNlbnRhdGlvblwiKS5hZGRDbGFzcyh0aGlzLmNsYXNzZXMuZGF0YXNldCkuYWRkQ2xhc3ModGhpcy5jbGFzc2VzLmRhdGFzZXQgKyBcIi1cIiArIHRoaXMubmFtZSk7XG4gICAgfVxuXG4gICAgRGF0YXNldC5leHRyYWN0RGF0YSA9IGZ1bmN0aW9uIGV4dHJhY3REYXRhKGVsKSB7XG4gICAgICB2YXIgJGVsID0gJChlbCk7XG5cbiAgICAgIGlmICgkZWwuZGF0YShrZXlzLm9iaikpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkYXRhc2V0OiAkZWwuZGF0YShrZXlzLmRhdGFzZXQpIHx8IFwiXCIsXG4gICAgICAgICAgdmFsOiAkZWwuZGF0YShrZXlzLnZhbCkgfHwgXCJcIixcbiAgICAgICAgICBvYmo6ICRlbC5kYXRhKGtleXMub2JqKSB8fCBudWxsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG5cbiAgICBfLm1peGluKERhdGFzZXQucHJvdG90eXBlLCBFdmVudEVtaXR0ZXIsIHtcbiAgICAgIF9vdmVyd3JpdGU6IGZ1bmN0aW9uIG92ZXJ3cml0ZShxdWVyeSwgc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9ucyB8fCBbXTtcblxuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgdGhpcy5fcmVuZGVyU3VnZ2VzdGlvbnMocXVlcnksIHN1Z2dlc3Rpb25zKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFzeW5jICYmIHRoaXMudGVtcGxhdGVzLnBlbmRpbmcpIHtcbiAgICAgICAgICB0aGlzLl9yZW5kZXJQZW5kaW5nKHF1ZXJ5KTtcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5hc3luYyAmJiB0aGlzLnRlbXBsYXRlcy5ub3RGb3VuZCkge1xuICAgICAgICAgIHRoaXMuX3JlbmRlck5vdEZvdW5kKHF1ZXJ5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9lbXB0eSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50cmlnZ2VyKFwicmVuZGVyZWRcIiwgc3VnZ2VzdGlvbnMsIGZhbHNlLCB0aGlzLm5hbWUpO1xuICAgICAgfSxcbiAgICAgIF9hcHBlbmQ6IGZ1bmN0aW9uIGFwcGVuZChxdWVyeSwgc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9ucyB8fCBbXTtcblxuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoICYmIHRoaXMuJGxhc3RTdWdnZXN0aW9uLmxlbmd0aCkge1xuICAgICAgICAgIHRoaXMuX2FwcGVuZFN1Z2dlc3Rpb25zKHF1ZXJ5LCBzdWdnZXN0aW9ucyk7XG4gICAgICAgIH0gZWxzZSBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgdGhpcy5fcmVuZGVyU3VnZ2VzdGlvbnMocXVlcnksIHN1Z2dlc3Rpb25zKTtcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy4kbGFzdFN1Z2dlc3Rpb24ubGVuZ3RoICYmIHRoaXMudGVtcGxhdGVzLm5vdEZvdW5kKSB7XG4gICAgICAgICAgdGhpcy5fcmVuZGVyTm90Rm91bmQocXVlcnkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50cmlnZ2VyKFwicmVuZGVyZWRcIiwgc3VnZ2VzdGlvbnMsIHRydWUsIHRoaXMubmFtZSk7XG4gICAgICB9LFxuICAgICAgX3JlbmRlclN1Z2dlc3Rpb25zOiBmdW5jdGlvbiByZW5kZXJTdWdnZXN0aW9ucyhxdWVyeSwgc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgdmFyICRmcmFnbWVudDtcbiAgICAgICAgJGZyYWdtZW50ID0gdGhpcy5fZ2V0U3VnZ2VzdGlvbnNGcmFnbWVudChxdWVyeSwgc3VnZ2VzdGlvbnMpO1xuICAgICAgICB0aGlzLiRsYXN0U3VnZ2VzdGlvbiA9ICRmcmFnbWVudC5jaGlsZHJlbigpLmxhc3QoKTtcbiAgICAgICAgdGhpcy4kZWwuaHRtbCgkZnJhZ21lbnQpLnByZXBlbmQodGhpcy5fZ2V0SGVhZGVyKHF1ZXJ5LCBzdWdnZXN0aW9ucykpLmFwcGVuZCh0aGlzLl9nZXRGb290ZXIocXVlcnksIHN1Z2dlc3Rpb25zKSk7XG4gICAgICB9LFxuICAgICAgX2FwcGVuZFN1Z2dlc3Rpb25zOiBmdW5jdGlvbiBhcHBlbmRTdWdnZXN0aW9ucyhxdWVyeSwgc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgdmFyICRmcmFnbWVudCwgJGxhc3RTdWdnZXN0aW9uO1xuICAgICAgICAkZnJhZ21lbnQgPSB0aGlzLl9nZXRTdWdnZXN0aW9uc0ZyYWdtZW50KHF1ZXJ5LCBzdWdnZXN0aW9ucyk7XG4gICAgICAgICRsYXN0U3VnZ2VzdGlvbiA9ICRmcmFnbWVudC5jaGlsZHJlbigpLmxhc3QoKTtcbiAgICAgICAgdGhpcy4kbGFzdFN1Z2dlc3Rpb24uYWZ0ZXIoJGZyYWdtZW50KTtcbiAgICAgICAgdGhpcy4kbGFzdFN1Z2dlc3Rpb24gPSAkbGFzdFN1Z2dlc3Rpb247XG4gICAgICB9LFxuICAgICAgX3JlbmRlclBlbmRpbmc6IGZ1bmN0aW9uIHJlbmRlclBlbmRpbmcocXVlcnkpIHtcbiAgICAgICAgdmFyIHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXMucGVuZGluZztcblxuICAgICAgICB0aGlzLl9yZXNldExhc3RTdWdnZXN0aW9uKCk7XG5cbiAgICAgICAgdGVtcGxhdGUgJiYgdGhpcy4kZWwuaHRtbCh0ZW1wbGF0ZSh7XG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgICAgICAgIGRhdGFzZXQ6IHRoaXMubmFtZVxuICAgICAgICB9KSk7XG4gICAgICB9LFxuICAgICAgX3JlbmRlck5vdEZvdW5kOiBmdW5jdGlvbiByZW5kZXJOb3RGb3VuZChxdWVyeSkge1xuICAgICAgICB2YXIgdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcy5ub3RGb3VuZDtcblxuICAgICAgICB0aGlzLl9yZXNldExhc3RTdWdnZXN0aW9uKCk7XG5cbiAgICAgICAgdGVtcGxhdGUgJiYgdGhpcy4kZWwuaHRtbCh0ZW1wbGF0ZSh7XG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgICAgICAgIGRhdGFzZXQ6IHRoaXMubmFtZVxuICAgICAgICB9KSk7XG4gICAgICB9LFxuICAgICAgX2VtcHR5OiBmdW5jdGlvbiBlbXB0eSgpIHtcbiAgICAgICAgdGhpcy4kZWwuZW1wdHkoKTtcblxuICAgICAgICB0aGlzLl9yZXNldExhc3RTdWdnZXN0aW9uKCk7XG4gICAgICB9LFxuICAgICAgX2dldFN1Z2dlc3Rpb25zRnJhZ21lbnQ6IGZ1bmN0aW9uIGdldFN1Z2dlc3Rpb25zRnJhZ21lbnQocXVlcnksIHN1Z2dlc3Rpb25zKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgIGZyYWdtZW50O1xuICAgICAgICBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgICAgICBfLmVhY2goc3VnZ2VzdGlvbnMsIGZ1bmN0aW9uIGdldFN1Z2dlc3Rpb25Ob2RlKHN1Z2dlc3Rpb24pIHtcbiAgICAgICAgICB2YXIgJGVsLCBjb250ZXh0O1xuICAgICAgICAgIGNvbnRleHQgPSB0aGF0Ll9pbmplY3RRdWVyeShxdWVyeSwgc3VnZ2VzdGlvbik7XG4gICAgICAgICAgJGVsID0gJCh0aGF0LnRlbXBsYXRlcy5zdWdnZXN0aW9uKGNvbnRleHQpKS5kYXRhKGtleXMuZGF0YXNldCwgdGhhdC5uYW1lKS5kYXRhKGtleXMub2JqLCBzdWdnZXN0aW9uKS5kYXRhKGtleXMudmFsLCB0aGF0LmRpc3BsYXlGbihzdWdnZXN0aW9uKSkuYWRkQ2xhc3ModGhhdC5jbGFzc2VzLnN1Z2dlc3Rpb24gKyBcIiBcIiArIHRoYXQuY2xhc3Nlcy5zZWxlY3RhYmxlKTtcbiAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCgkZWxbMF0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmhpZ2hsaWdodCAmJiBoaWdobGlnaHQoe1xuICAgICAgICAgIGNsYXNzTmFtZTogdGhpcy5jbGFzc2VzLmhpZ2hsaWdodCxcbiAgICAgICAgICBub2RlOiBmcmFnbWVudCxcbiAgICAgICAgICBwYXR0ZXJuOiBxdWVyeVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICQoZnJhZ21lbnQpO1xuICAgICAgfSxcbiAgICAgIF9nZXRGb290ZXI6IGZ1bmN0aW9uIGdldEZvb3RlcihxdWVyeSwgc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGVtcGxhdGVzLmZvb3RlciA/IHRoaXMudGVtcGxhdGVzLmZvb3Rlcih7XG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgICAgICAgIHN1Z2dlc3Rpb25zOiBzdWdnZXN0aW9ucyxcbiAgICAgICAgICBkYXRhc2V0OiB0aGlzLm5hbWVcbiAgICAgICAgfSkgOiBudWxsO1xuICAgICAgfSxcbiAgICAgIF9nZXRIZWFkZXI6IGZ1bmN0aW9uIGdldEhlYWRlcihxdWVyeSwgc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGVtcGxhdGVzLmhlYWRlciA/IHRoaXMudGVtcGxhdGVzLmhlYWRlcih7XG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgICAgICAgIHN1Z2dlc3Rpb25zOiBzdWdnZXN0aW9ucyxcbiAgICAgICAgICBkYXRhc2V0OiB0aGlzLm5hbWVcbiAgICAgICAgfSkgOiBudWxsO1xuICAgICAgfSxcbiAgICAgIF9yZXNldExhc3RTdWdnZXN0aW9uOiBmdW5jdGlvbiByZXNldExhc3RTdWdnZXN0aW9uKCkge1xuICAgICAgICB0aGlzLiRsYXN0U3VnZ2VzdGlvbiA9ICQoKTtcbiAgICAgIH0sXG4gICAgICBfaW5qZWN0UXVlcnk6IGZ1bmN0aW9uIGluamVjdFF1ZXJ5KHF1ZXJ5LCBvYmopIHtcbiAgICAgICAgcmV0dXJuIF8uaXNPYmplY3Qob2JqKSA/IF8ubWl4aW4oe1xuICAgICAgICAgIF9xdWVyeTogcXVlcnlcbiAgICAgICAgfSwgb2JqKSA6IG9iajtcbiAgICAgIH0sXG4gICAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShxdWVyeSkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBjYW5jZWxlZCA9IGZhbHNlLFxuICAgICAgICAgICAgc3luY0NhbGxlZCA9IGZhbHNlLFxuICAgICAgICAgICAgcmVuZGVyZWQgPSAwO1xuICAgICAgICB0aGlzLmNhbmNlbCgpO1xuXG4gICAgICAgIHRoaXMuY2FuY2VsID0gZnVuY3Rpb24gY2FuY2VsKCkge1xuICAgICAgICAgIGNhbmNlbGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGF0LmNhbmNlbCA9ICQubm9vcDtcbiAgICAgICAgICB0aGF0LmFzeW5jICYmIHRoYXQudHJpZ2dlcihcImFzeW5jQ2FuY2VsZWRcIiwgcXVlcnksIHRoYXQubmFtZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5zb3VyY2UocXVlcnksIHN5bmMsIGFzeW5jKTtcbiAgICAgICAgIXN5bmNDYWxsZWQgJiYgc3luYyhbXSk7XG5cbiAgICAgICAgZnVuY3Rpb24gc3luYyhzdWdnZXN0aW9ucykge1xuICAgICAgICAgIGlmIChzeW5jQ2FsbGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc3luY0NhbGxlZCA9IHRydWU7XG4gICAgICAgICAgc3VnZ2VzdGlvbnMgPSAoc3VnZ2VzdGlvbnMgfHwgW10pLnNsaWNlKDAsIHRoYXQubGltaXQpO1xuICAgICAgICAgIHJlbmRlcmVkID0gc3VnZ2VzdGlvbnMubGVuZ3RoO1xuXG4gICAgICAgICAgdGhhdC5fb3ZlcndyaXRlKHF1ZXJ5LCBzdWdnZXN0aW9ucyk7XG5cbiAgICAgICAgICBpZiAocmVuZGVyZWQgPCB0aGF0LmxpbWl0ICYmIHRoYXQuYXN5bmMpIHtcbiAgICAgICAgICAgIHRoYXQudHJpZ2dlcihcImFzeW5jUmVxdWVzdGVkXCIsIHF1ZXJ5LCB0aGF0Lm5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFzeW5jKHN1Z2dlc3Rpb25zKSB7XG4gICAgICAgICAgc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9ucyB8fCBbXTtcblxuICAgICAgICAgIGlmICghY2FuY2VsZWQgJiYgcmVuZGVyZWQgPCB0aGF0LmxpbWl0KSB7XG4gICAgICAgICAgICB0aGF0LmNhbmNlbCA9ICQubm9vcDtcbiAgICAgICAgICAgIHZhciBpZHggPSBNYXRoLmFicyhyZW5kZXJlZCAtIHRoYXQubGltaXQpO1xuICAgICAgICAgICAgcmVuZGVyZWQgKz0gaWR4O1xuXG4gICAgICAgICAgICB0aGF0Ll9hcHBlbmQocXVlcnksIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIGlkeCkpO1xuXG4gICAgICAgICAgICB0aGF0LmFzeW5jICYmIHRoYXQudHJpZ2dlcihcImFzeW5jUmVjZWl2ZWRcIiwgcXVlcnksIHRoYXQubmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY2FuY2VsOiAkLm5vb3AsXG4gICAgICBjbGVhcjogZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgICAgIHRoaXMuX2VtcHR5KCk7XG5cbiAgICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKFwiY2xlYXJlZFwiKTtcbiAgICAgIH0sXG4gICAgICBpc0VtcHR5OiBmdW5jdGlvbiBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kZWwuaXMoXCI6ZW1wdHlcIik7XG4gICAgICB9LFxuICAgICAgZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy4kZWwgPSAkKFwiPGRpdj5cIik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gRGF0YXNldDtcblxuICAgIGZ1bmN0aW9uIGdldERpc3BsYXlGbihkaXNwbGF5KSB7XG4gICAgICBkaXNwbGF5ID0gZGlzcGxheSB8fCBfLnN0cmluZ2lmeTtcbiAgICAgIHJldHVybiBfLmlzRnVuY3Rpb24oZGlzcGxheSkgPyBkaXNwbGF5IDogZGlzcGxheUZuO1xuXG4gICAgICBmdW5jdGlvbiBkaXNwbGF5Rm4ob2JqKSB7XG4gICAgICAgIHJldHVybiBvYmpbZGlzcGxheV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0VGVtcGxhdGVzKHRlbXBsYXRlcywgZGlzcGxheUZuKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBub3RGb3VuZDogdGVtcGxhdGVzLm5vdEZvdW5kICYmIF8udGVtcGxhdGlmeSh0ZW1wbGF0ZXMubm90Rm91bmQpLFxuICAgICAgICBwZW5kaW5nOiB0ZW1wbGF0ZXMucGVuZGluZyAmJiBfLnRlbXBsYXRpZnkodGVtcGxhdGVzLnBlbmRpbmcpLFxuICAgICAgICBoZWFkZXI6IHRlbXBsYXRlcy5oZWFkZXIgJiYgXy50ZW1wbGF0aWZ5KHRlbXBsYXRlcy5oZWFkZXIpLFxuICAgICAgICBmb290ZXI6IHRlbXBsYXRlcy5mb290ZXIgJiYgXy50ZW1wbGF0aWZ5KHRlbXBsYXRlcy5mb290ZXIpLFxuICAgICAgICBzdWdnZXN0aW9uOiB0ZW1wbGF0ZXMuc3VnZ2VzdGlvbiA/IHVzZXJTdWdnZXN0aW9uVGVtcGxhdGUgOiBzdWdnZXN0aW9uVGVtcGxhdGVcbiAgICAgIH07XG5cbiAgICAgIGZ1bmN0aW9uIHVzZXJTdWdnZXN0aW9uVGVtcGxhdGUoY29udGV4dCkge1xuICAgICAgICB2YXIgdGVtcGxhdGUgPSB0ZW1wbGF0ZXMuc3VnZ2VzdGlvbjtcbiAgICAgICAgcmV0dXJuICQodGVtcGxhdGUoY29udGV4dCkpLmF0dHIoXCJpZFwiLCBfLmd1aWQoKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHN1Z2dlc3Rpb25UZW1wbGF0ZShjb250ZXh0KSB7XG4gICAgICAgIHJldHVybiAkKCc8ZGl2IHJvbGU9XCJvcHRpb25cIj4nKS5hdHRyKFwiaWRcIiwgXy5ndWlkKCkpLnRleHQoZGlzcGxheUZuKGNvbnRleHQpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc1ZhbGlkTmFtZShzdHIpIHtcbiAgICAgIHJldHVybiAvXltfYS16QS1aMC05LV0rJC8udGVzdChzdHIpO1xuICAgIH1cbiAgfSgpO1xuXG4gIHZhciBNZW51ID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgZnVuY3Rpb24gTWVudShvLCB3d3cpIHtcbiAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgIG8gPSBvIHx8IHt9O1xuXG4gICAgICBpZiAoIW8ubm9kZSkge1xuICAgICAgICAkLmVycm9yKFwibm9kZSBpcyByZXF1aXJlZFwiKTtcbiAgICAgIH1cblxuICAgICAgd3d3Lm1peGluKHRoaXMpO1xuICAgICAgdGhpcy4kbm9kZSA9ICQoby5ub2RlKTtcbiAgICAgIHRoaXMucXVlcnkgPSBudWxsO1xuICAgICAgdGhpcy5kYXRhc2V0cyA9IF8ubWFwKG8uZGF0YXNldHMsIGluaXRpYWxpemVEYXRhc2V0KTtcblxuICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZURhdGFzZXQob0RhdGFzZXQpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGF0LiRub2RlLmZpbmQob0RhdGFzZXQubm9kZSkuZmlyc3QoKTtcbiAgICAgICAgb0RhdGFzZXQubm9kZSA9IG5vZGUubGVuZ3RoID8gbm9kZSA6ICQoXCI8ZGl2PlwiKS5hcHBlbmRUbyh0aGF0LiRub2RlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRhc2V0KG9EYXRhc2V0LCB3d3cpO1xuICAgICAgfVxuICAgIH1cblxuICAgIF8ubWl4aW4oTWVudS5wcm90b3R5cGUsIEV2ZW50RW1pdHRlciwge1xuICAgICAgX29uU2VsZWN0YWJsZUNsaWNrOiBmdW5jdGlvbiBvblNlbGVjdGFibGVDbGljaygkZSkge1xuICAgICAgICB0aGlzLnRyaWdnZXIoXCJzZWxlY3RhYmxlQ2xpY2tlZFwiLCAkKCRlLmN1cnJlbnRUYXJnZXQpKTtcbiAgICAgIH0sXG4gICAgICBfb25SZW5kZXJlZDogZnVuY3Rpb24gb25SZW5kZXJlZCh0eXBlLCBkYXRhc2V0LCBzdWdnZXN0aW9ucywgYXN5bmMpIHtcbiAgICAgICAgdGhpcy4kbm9kZS50b2dnbGVDbGFzcyh0aGlzLmNsYXNzZXMuZW1wdHksIHRoaXMuX2FsbERhdGFzZXRzRW1wdHkoKSk7XG4gICAgICAgIHRoaXMudHJpZ2dlcihcImRhdGFzZXRSZW5kZXJlZFwiLCBkYXRhc2V0LCBzdWdnZXN0aW9ucywgYXN5bmMpO1xuICAgICAgfSxcbiAgICAgIF9vbkNsZWFyZWQ6IGZ1bmN0aW9uIG9uQ2xlYXJlZCgpIHtcbiAgICAgICAgdGhpcy4kbm9kZS50b2dnbGVDbGFzcyh0aGlzLmNsYXNzZXMuZW1wdHksIHRoaXMuX2FsbERhdGFzZXRzRW1wdHkoKSk7XG4gICAgICAgIHRoaXMudHJpZ2dlcihcImRhdGFzZXRDbGVhcmVkXCIpO1xuICAgICAgfSxcbiAgICAgIF9wcm9wYWdhdGU6IGZ1bmN0aW9uIHByb3BhZ2F0ZSgpIHtcbiAgICAgICAgdGhpcy50cmlnZ2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9LFxuICAgICAgX2FsbERhdGFzZXRzRW1wdHk6IGZ1bmN0aW9uIGFsbERhdGFzZXRzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBfLmV2ZXJ5KHRoaXMuZGF0YXNldHMsIF8uYmluZChmdW5jdGlvbiBpc0RhdGFzZXRFbXB0eShkYXRhc2V0KSB7XG4gICAgICAgICAgdmFyIGlzRW1wdHkgPSBkYXRhc2V0LmlzRW1wdHkoKTtcbiAgICAgICAgICB0aGlzLiRub2RlLmF0dHIoXCJhcmlhLWV4cGFuZGVkXCIsICFpc0VtcHR5KTtcbiAgICAgICAgICByZXR1cm4gaXNFbXB0eTtcbiAgICAgICAgfSwgdGhpcykpO1xuICAgICAgfSxcbiAgICAgIF9nZXRTZWxlY3RhYmxlczogZnVuY3Rpb24gZ2V0U2VsZWN0YWJsZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRub2RlLmZpbmQodGhpcy5zZWxlY3RvcnMuc2VsZWN0YWJsZSk7XG4gICAgICB9LFxuICAgICAgX3JlbW92ZUN1cnNvcjogZnVuY3Rpb24gX3JlbW92ZUN1cnNvcigpIHtcbiAgICAgICAgdmFyICRzZWxlY3RhYmxlID0gdGhpcy5nZXRBY3RpdmVTZWxlY3RhYmxlKCk7XG4gICAgICAgICRzZWxlY3RhYmxlICYmICRzZWxlY3RhYmxlLnJlbW92ZUNsYXNzKHRoaXMuY2xhc3Nlcy5jdXJzb3IpO1xuICAgICAgfSxcbiAgICAgIF9lbnN1cmVWaXNpYmxlOiBmdW5jdGlvbiBlbnN1cmVWaXNpYmxlKCRlbCkge1xuICAgICAgICB2YXIgZWxUb3AsIGVsQm90dG9tLCBub2RlU2Nyb2xsVG9wLCBub2RlSGVpZ2h0O1xuICAgICAgICBlbFRvcCA9ICRlbC5wb3NpdGlvbigpLnRvcDtcbiAgICAgICAgZWxCb3R0b20gPSBlbFRvcCArICRlbC5vdXRlckhlaWdodCh0cnVlKTtcbiAgICAgICAgbm9kZVNjcm9sbFRvcCA9IHRoaXMuJG5vZGUuc2Nyb2xsVG9wKCk7XG4gICAgICAgIG5vZGVIZWlnaHQgPSB0aGlzLiRub2RlLmhlaWdodCgpICsgcGFyc2VJbnQodGhpcy4kbm9kZS5jc3MoXCJwYWRkaW5nVG9wXCIpLCAxMCkgKyBwYXJzZUludCh0aGlzLiRub2RlLmNzcyhcInBhZGRpbmdCb3R0b21cIiksIDEwKTtcblxuICAgICAgICBpZiAoZWxUb3AgPCAwKSB7XG4gICAgICAgICAgdGhpcy4kbm9kZS5zY3JvbGxUb3Aobm9kZVNjcm9sbFRvcCArIGVsVG9wKTtcbiAgICAgICAgfSBlbHNlIGlmIChub2RlSGVpZ2h0IDwgZWxCb3R0b20pIHtcbiAgICAgICAgICB0aGlzLiRub2RlLnNjcm9sbFRvcChub2RlU2Nyb2xsVG9wICsgKGVsQm90dG9tIC0gbm9kZUhlaWdodCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYmluZDogZnVuY3Rpb24gYmluZCgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgb25TZWxlY3RhYmxlQ2xpY2s7XG4gICAgICAgIG9uU2VsZWN0YWJsZUNsaWNrID0gXy5iaW5kKHRoaXMuX29uU2VsZWN0YWJsZUNsaWNrLCB0aGlzKTtcbiAgICAgICAgdGhpcy4kbm9kZS5vbihcImNsaWNrLnR0XCIsIHRoaXMuc2VsZWN0b3JzLnNlbGVjdGFibGUsIG9uU2VsZWN0YWJsZUNsaWNrKTtcbiAgICAgICAgdGhpcy4kbm9kZS5vbihcIm1vdXNlb3ZlclwiLCB0aGlzLnNlbGVjdG9ycy5zZWxlY3RhYmxlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhhdC5zZXRDdXJzb3IoJCh0aGlzKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLiRub2RlLm9uKFwibW91c2VsZWF2ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhhdC5fcmVtb3ZlQ3Vyc29yKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIF8uZWFjaCh0aGlzLmRhdGFzZXRzLCBmdW5jdGlvbiAoZGF0YXNldCkge1xuICAgICAgICAgIGRhdGFzZXQub25TeW5jKFwiYXN5bmNSZXF1ZXN0ZWRcIiwgdGhhdC5fcHJvcGFnYXRlLCB0aGF0KS5vblN5bmMoXCJhc3luY0NhbmNlbGVkXCIsIHRoYXQuX3Byb3BhZ2F0ZSwgdGhhdCkub25TeW5jKFwiYXN5bmNSZWNlaXZlZFwiLCB0aGF0Ll9wcm9wYWdhdGUsIHRoYXQpLm9uU3luYyhcInJlbmRlcmVkXCIsIHRoYXQuX29uUmVuZGVyZWQsIHRoYXQpLm9uU3luYyhcImNsZWFyZWRcIiwgdGhhdC5fb25DbGVhcmVkLCB0aGF0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9LFxuICAgICAgaXNPcGVuOiBmdW5jdGlvbiBpc09wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRub2RlLmhhc0NsYXNzKHRoaXMuY2xhc3Nlcy5vcGVuKTtcbiAgICAgIH0sXG4gICAgICBvcGVuOiBmdW5jdGlvbiBvcGVuKCkge1xuICAgICAgICB0aGlzLiRub2RlLnNjcm9sbFRvcCgwKTtcbiAgICAgICAgdGhpcy4kbm9kZS5hZGRDbGFzcyh0aGlzLmNsYXNzZXMub3Blbik7XG4gICAgICB9LFxuICAgICAgY2xvc2U6IGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgICB0aGlzLiRub2RlLmF0dHIoXCJhcmlhLWV4cGFuZGVkXCIsIGZhbHNlKTtcbiAgICAgICAgdGhpcy4kbm9kZS5yZW1vdmVDbGFzcyh0aGlzLmNsYXNzZXMub3Blbik7XG5cbiAgICAgICAgdGhpcy5fcmVtb3ZlQ3Vyc29yKCk7XG4gICAgICB9LFxuICAgICAgc2V0TGFuZ3VhZ2VEaXJlY3Rpb246IGZ1bmN0aW9uIHNldExhbmd1YWdlRGlyZWN0aW9uKGRpcikge1xuICAgICAgICB0aGlzLiRub2RlLmF0dHIoXCJkaXJcIiwgZGlyKTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RhYmxlUmVsYXRpdmVUb0N1cnNvcjogZnVuY3Rpb24gc2VsZWN0YWJsZVJlbGF0aXZlVG9DdXJzb3IoZGVsdGEpIHtcbiAgICAgICAgdmFyICRzZWxlY3RhYmxlcywgJG9sZEN1cnNvciwgb2xkSW5kZXgsIG5ld0luZGV4O1xuICAgICAgICAkb2xkQ3Vyc29yID0gdGhpcy5nZXRBY3RpdmVTZWxlY3RhYmxlKCk7XG4gICAgICAgICRzZWxlY3RhYmxlcyA9IHRoaXMuX2dldFNlbGVjdGFibGVzKCk7XG4gICAgICAgIG9sZEluZGV4ID0gJG9sZEN1cnNvciA/ICRzZWxlY3RhYmxlcy5pbmRleCgkb2xkQ3Vyc29yKSA6IC0xO1xuICAgICAgICBuZXdJbmRleCA9IG9sZEluZGV4ICsgZGVsdGE7XG4gICAgICAgIG5ld0luZGV4ID0gKG5ld0luZGV4ICsgMSkgJSAoJHNlbGVjdGFibGVzLmxlbmd0aCArIDEpIC0gMTtcbiAgICAgICAgbmV3SW5kZXggPSBuZXdJbmRleCA8IC0xID8gJHNlbGVjdGFibGVzLmxlbmd0aCAtIDEgOiBuZXdJbmRleDtcbiAgICAgICAgcmV0dXJuIG5ld0luZGV4ID09PSAtMSA/IG51bGwgOiAkc2VsZWN0YWJsZXMuZXEobmV3SW5kZXgpO1xuICAgICAgfSxcbiAgICAgIHNldEN1cnNvcjogZnVuY3Rpb24gc2V0Q3Vyc29yKCRzZWxlY3RhYmxlKSB7XG4gICAgICAgIHRoaXMuX3JlbW92ZUN1cnNvcigpO1xuXG4gICAgICAgIGlmICgkc2VsZWN0YWJsZSA9ICRzZWxlY3RhYmxlICYmICRzZWxlY3RhYmxlLmZpcnN0KCkpIHtcbiAgICAgICAgICAkc2VsZWN0YWJsZS5hZGRDbGFzcyh0aGlzLmNsYXNzZXMuY3Vyc29yKTtcblxuICAgICAgICAgIHRoaXMuX2Vuc3VyZVZpc2libGUoJHNlbGVjdGFibGUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZ2V0U2VsZWN0YWJsZURhdGE6IGZ1bmN0aW9uIGdldFNlbGVjdGFibGVEYXRhKCRlbCkge1xuICAgICAgICByZXR1cm4gJGVsICYmICRlbC5sZW5ndGggPyBEYXRhc2V0LmV4dHJhY3REYXRhKCRlbCkgOiBudWxsO1xuICAgICAgfSxcbiAgICAgIGdldEFjdGl2ZVNlbGVjdGFibGU6IGZ1bmN0aW9uIGdldEFjdGl2ZVNlbGVjdGFibGUoKSB7XG4gICAgICAgIHZhciAkc2VsZWN0YWJsZSA9IHRoaXMuX2dldFNlbGVjdGFibGVzKCkuZmlsdGVyKHRoaXMuc2VsZWN0b3JzLmN1cnNvcikuZmlyc3QoKTtcblxuICAgICAgICByZXR1cm4gJHNlbGVjdGFibGUubGVuZ3RoID8gJHNlbGVjdGFibGUgOiBudWxsO1xuICAgICAgfSxcbiAgICAgIGdldFRvcFNlbGVjdGFibGU6IGZ1bmN0aW9uIGdldFRvcFNlbGVjdGFibGUoKSB7XG4gICAgICAgIHZhciAkc2VsZWN0YWJsZSA9IHRoaXMuX2dldFNlbGVjdGFibGVzKCkuZmlyc3QoKTtcblxuICAgICAgICByZXR1cm4gJHNlbGVjdGFibGUubGVuZ3RoID8gJHNlbGVjdGFibGUgOiBudWxsO1xuICAgICAgfSxcbiAgICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBpc1ZhbGlkVXBkYXRlID0gcXVlcnkgIT09IHRoaXMucXVlcnk7XG5cbiAgICAgICAgaWYgKGlzVmFsaWRVcGRhdGUpIHtcbiAgICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XG5cbiAgICAgICAgICBfLmVhY2godGhpcy5kYXRhc2V0cywgdXBkYXRlRGF0YXNldCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaXNWYWxpZFVwZGF0ZTtcblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVEYXRhc2V0KGRhdGFzZXQpIHtcbiAgICAgICAgICBkYXRhc2V0LnVwZGF0ZShxdWVyeSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBlbXB0eTogZnVuY3Rpb24gZW1wdHkoKSB7XG4gICAgICAgIF8uZWFjaCh0aGlzLmRhdGFzZXRzLCBjbGVhckRhdGFzZXQpO1xuXG4gICAgICAgIHRoaXMucXVlcnkgPSBudWxsO1xuICAgICAgICB0aGlzLiRub2RlLmFkZENsYXNzKHRoaXMuY2xhc3Nlcy5lbXB0eSk7XG5cbiAgICAgICAgZnVuY3Rpb24gY2xlYXJEYXRhc2V0KGRhdGFzZXQpIHtcbiAgICAgICAgICBkYXRhc2V0LmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLiRub2RlLm9mZihcIi50dFwiKTtcbiAgICAgICAgdGhpcy4kbm9kZSA9ICQoXCI8ZGl2PlwiKTtcblxuICAgICAgICBfLmVhY2godGhpcy5kYXRhc2V0cywgZGVzdHJveURhdGFzZXQpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGRlc3Ryb3lEYXRhc2V0KGRhdGFzZXQpIHtcbiAgICAgICAgICBkYXRhc2V0LmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE1lbnU7XG4gIH0oKTtcblxuICB2YXIgU3RhdHVzID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgZnVuY3Rpb24gU3RhdHVzKG9wdGlvbnMpIHtcbiAgICAgIHRoaXMuJGVsID0gJChcIjxzcGFuPjwvc3Bhbj5cIiwge1xuICAgICAgICByb2xlOiBcInN0YXR1c1wiLFxuICAgICAgICBcImFyaWEtbGl2ZVwiOiBcInBvbGl0ZVwiXG4gICAgICB9KS5jc3Moe1xuICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgICAgICBwYWRkaW5nOiBcIjBcIixcbiAgICAgICAgYm9yZGVyOiBcIjBcIixcbiAgICAgICAgaGVpZ2h0OiBcIjFweFwiLFxuICAgICAgICB3aWR0aDogXCIxcHhcIixcbiAgICAgICAgXCJtYXJnaW4tYm90dG9tXCI6IFwiLTFweFwiLFxuICAgICAgICBcIm1hcmdpbi1yaWdodFwiOiBcIi0xcHhcIixcbiAgICAgICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gICAgICAgIGNsaXA6IFwicmVjdCgwIDAgMCAwKVwiLFxuICAgICAgICBcIndoaXRlLXNwYWNlXCI6IFwibm93cmFwXCJcbiAgICAgIH0pO1xuICAgICAgb3B0aW9ucy4kaW5wdXQuYWZ0ZXIodGhpcy4kZWwpO1xuXG4gICAgICBfLmVhY2gob3B0aW9ucy5tZW51LmRhdGFzZXRzLCBfLmJpbmQoZnVuY3Rpb24gKGRhdGFzZXQpIHtcbiAgICAgICAgaWYgKGRhdGFzZXQub25TeW5jKSB7XG4gICAgICAgICAgZGF0YXNldC5vblN5bmMoXCJyZW5kZXJlZFwiLCBfLmJpbmQodGhpcy51cGRhdGUsIHRoaXMpKTtcbiAgICAgICAgICBkYXRhc2V0Lm9uU3luYyhcImNsZWFyZWRcIiwgXy5iaW5kKHRoaXMuY2xlYXJlZCwgdGhpcykpO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzKSk7XG4gICAgfVxuXG4gICAgXy5taXhpbihTdGF0dXMucHJvdG90eXBlLCB7XG4gICAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShldmVudCwgc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHN1Z2dlc3Rpb25zLmxlbmd0aDtcbiAgICAgICAgdmFyIHdvcmRzO1xuXG4gICAgICAgIGlmIChsZW5ndGggPT09IDEpIHtcbiAgICAgICAgICB3b3JkcyA9IHtcbiAgICAgICAgICAgIHJlc3VsdDogXCJyZXN1bHRcIixcbiAgICAgICAgICAgIGlzOiBcImlzXCJcbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdvcmRzID0ge1xuICAgICAgICAgICAgcmVzdWx0OiBcInJlc3VsdHNcIixcbiAgICAgICAgICAgIGlzOiBcImFyZVwiXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuJGVsLnRleHQobGVuZ3RoICsgXCIgXCIgKyB3b3Jkcy5yZXN1bHQgKyBcIiBcIiArIHdvcmRzLmlzICsgXCIgYXZhaWxhYmxlLCB1c2UgdXAgYW5kIGRvd24gYXJyb3cga2V5cyB0byBuYXZpZ2F0ZS5cIik7XG4gICAgICB9LFxuICAgICAgY2xlYXJlZDogZnVuY3Rpb24gY2xlYXJlZCgpIHtcbiAgICAgICAgdGhpcy4kZWwudGV4dChcIlwiKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBTdGF0dXM7XG4gIH0oKTtcblxuICB2YXIgRGVmYXVsdE1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgcyA9IE1lbnUucHJvdG90eXBlO1xuXG4gICAgZnVuY3Rpb24gRGVmYXVsdE1lbnUoKSB7XG4gICAgICBNZW51LmFwcGx5KHRoaXMsIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKSk7XG4gICAgfVxuXG4gICAgXy5taXhpbihEZWZhdWx0TWVudS5wcm90b3R5cGUsIE1lbnUucHJvdG90eXBlLCB7XG4gICAgICBvcGVuOiBmdW5jdGlvbiBvcGVuKCkge1xuICAgICAgICAhdGhpcy5fYWxsRGF0YXNldHNFbXB0eSgpICYmIHRoaXMuX3Nob3coKTtcbiAgICAgICAgcmV0dXJuIHMub3Blbi5hcHBseSh0aGlzLCBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCkpO1xuICAgICAgfSxcbiAgICAgIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5faGlkZSgpO1xuXG4gICAgICAgIHJldHVybiBzLmNsb3NlLmFwcGx5KHRoaXMsIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKSk7XG4gICAgICB9LFxuICAgICAgX29uUmVuZGVyZWQ6IGZ1bmN0aW9uIG9uUmVuZGVyZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLl9hbGxEYXRhc2V0c0VtcHR5KCkpIHtcbiAgICAgICAgICB0aGlzLl9oaWRlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5pc09wZW4oKSAmJiB0aGlzLl9zaG93KCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcy5fb25SZW5kZXJlZC5hcHBseSh0aGlzLCBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCkpO1xuICAgICAgfSxcbiAgICAgIF9vbkNsZWFyZWQ6IGZ1bmN0aW9uIG9uQ2xlYXJlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2FsbERhdGFzZXRzRW1wdHkoKSkge1xuICAgICAgICAgIHRoaXMuX2hpZGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmlzT3BlbigpICYmIHRoaXMuX3Nob3coKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzLl9vbkNsZWFyZWQuYXBwbHkodGhpcywgW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDApKTtcbiAgICAgIH0sXG4gICAgICBzZXRMYW5ndWFnZURpcmVjdGlvbjogZnVuY3Rpb24gc2V0TGFuZ3VhZ2VEaXJlY3Rpb24oZGlyKSB7XG4gICAgICAgIHRoaXMuJG5vZGUuY3NzKGRpciA9PT0gXCJsdHJcIiA/IHRoaXMuY3NzLmx0ciA6IHRoaXMuY3NzLnJ0bCk7XG4gICAgICAgIHJldHVybiBzLnNldExhbmd1YWdlRGlyZWN0aW9uLmFwcGx5KHRoaXMsIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKSk7XG4gICAgICB9LFxuICAgICAgX2hpZGU6IGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgICAgIHRoaXMuJG5vZGUuaGlkZSgpO1xuICAgICAgfSxcbiAgICAgIF9zaG93OiBmdW5jdGlvbiBzaG93KCkge1xuICAgICAgICB0aGlzLiRub2RlLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBEZWZhdWx0TWVudTtcbiAgfSgpO1xuXG4gIHZhciBUeXBlYWhlYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBmdW5jdGlvbiBUeXBlYWhlYWQobywgd3d3KSB7XG4gICAgICB2YXIgb25Gb2N1c2VkLCBvbkJsdXJyZWQsIG9uRW50ZXJLZXllZCwgb25UYWJLZXllZCwgb25Fc2NLZXllZCwgb25VcEtleWVkLCBvbkRvd25LZXllZCwgb25MZWZ0S2V5ZWQsIG9uUmlnaHRLZXllZCwgb25RdWVyeUNoYW5nZWQsIG9uV2hpdGVzcGFjZUNoYW5nZWQ7XG4gICAgICBvID0gbyB8fCB7fTtcblxuICAgICAgaWYgKCFvLmlucHV0KSB7XG4gICAgICAgICQuZXJyb3IoXCJtaXNzaW5nIGlucHV0XCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIW8ubWVudSkge1xuICAgICAgICAkLmVycm9yKFwibWlzc2luZyBtZW51XCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIW8uZXZlbnRCdXMpIHtcbiAgICAgICAgJC5lcnJvcihcIm1pc3NpbmcgZXZlbnQgYnVzXCIpO1xuICAgICAgfVxuXG4gICAgICB3d3cubWl4aW4odGhpcyk7XG4gICAgICB0aGlzLmV2ZW50QnVzID0gby5ldmVudEJ1cztcbiAgICAgIHRoaXMubWluTGVuZ3RoID0gXy5pc051bWJlcihvLm1pbkxlbmd0aCkgPyBvLm1pbkxlbmd0aCA6IDE7XG4gICAgICB0aGlzLmlucHV0ID0gby5pbnB1dDtcbiAgICAgIHRoaXMubWVudSA9IG8ubWVudTtcbiAgICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XG4gICAgICB0aGlzLmF1dG9zZWxlY3QgPSAhIW8uYXV0b3NlbGVjdDtcbiAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmlucHV0Lmhhc0ZvY3VzKCkgJiYgdGhpcy5hY3RpdmF0ZSgpO1xuICAgICAgdGhpcy5kaXIgPSB0aGlzLmlucHV0LmdldExhbmdEaXIoKTtcblxuICAgICAgdGhpcy5faGFja3MoKTtcblxuICAgICAgdGhpcy5tZW51LmJpbmQoKS5vblN5bmMoXCJzZWxlY3RhYmxlQ2xpY2tlZFwiLCB0aGlzLl9vblNlbGVjdGFibGVDbGlja2VkLCB0aGlzKS5vblN5bmMoXCJhc3luY1JlcXVlc3RlZFwiLCB0aGlzLl9vbkFzeW5jUmVxdWVzdGVkLCB0aGlzKS5vblN5bmMoXCJhc3luY0NhbmNlbGVkXCIsIHRoaXMuX29uQXN5bmNDYW5jZWxlZCwgdGhpcykub25TeW5jKFwiYXN5bmNSZWNlaXZlZFwiLCB0aGlzLl9vbkFzeW5jUmVjZWl2ZWQsIHRoaXMpLm9uU3luYyhcImRhdGFzZXRSZW5kZXJlZFwiLCB0aGlzLl9vbkRhdGFzZXRSZW5kZXJlZCwgdGhpcykub25TeW5jKFwiZGF0YXNldENsZWFyZWRcIiwgdGhpcy5fb25EYXRhc2V0Q2xlYXJlZCwgdGhpcyk7XG4gICAgICBvbkZvY3VzZWQgPSBjKHRoaXMsIFwiYWN0aXZhdGVcIiwgXCJvcGVuXCIsIFwiX29uRm9jdXNlZFwiKTtcbiAgICAgIG9uQmx1cnJlZCA9IGModGhpcywgXCJkZWFjdGl2YXRlXCIsIFwiX29uQmx1cnJlZFwiKTtcbiAgICAgIG9uRW50ZXJLZXllZCA9IGModGhpcywgXCJpc0FjdGl2ZVwiLCBcImlzT3BlblwiLCBcIl9vbkVudGVyS2V5ZWRcIik7XG4gICAgICBvblRhYktleWVkID0gYyh0aGlzLCBcImlzQWN0aXZlXCIsIFwiaXNPcGVuXCIsIFwiX29uVGFiS2V5ZWRcIik7XG4gICAgICBvbkVzY0tleWVkID0gYyh0aGlzLCBcImlzQWN0aXZlXCIsIFwiX29uRXNjS2V5ZWRcIik7XG4gICAgICBvblVwS2V5ZWQgPSBjKHRoaXMsIFwiaXNBY3RpdmVcIiwgXCJvcGVuXCIsIFwiX29uVXBLZXllZFwiKTtcbiAgICAgIG9uRG93bktleWVkID0gYyh0aGlzLCBcImlzQWN0aXZlXCIsIFwib3BlblwiLCBcIl9vbkRvd25LZXllZFwiKTtcbiAgICAgIG9uTGVmdEtleWVkID0gYyh0aGlzLCBcImlzQWN0aXZlXCIsIFwiaXNPcGVuXCIsIFwiX29uTGVmdEtleWVkXCIpO1xuICAgICAgb25SaWdodEtleWVkID0gYyh0aGlzLCBcImlzQWN0aXZlXCIsIFwiaXNPcGVuXCIsIFwiX29uUmlnaHRLZXllZFwiKTtcbiAgICAgIG9uUXVlcnlDaGFuZ2VkID0gYyh0aGlzLCBcIl9vcGVuSWZBY3RpdmVcIiwgXCJfb25RdWVyeUNoYW5nZWRcIik7XG4gICAgICBvbldoaXRlc3BhY2VDaGFuZ2VkID0gYyh0aGlzLCBcIl9vcGVuSWZBY3RpdmVcIiwgXCJfb25XaGl0ZXNwYWNlQ2hhbmdlZFwiKTtcbiAgICAgIHRoaXMuaW5wdXQuYmluZCgpLm9uU3luYyhcImZvY3VzZWRcIiwgb25Gb2N1c2VkLCB0aGlzKS5vblN5bmMoXCJibHVycmVkXCIsIG9uQmx1cnJlZCwgdGhpcykub25TeW5jKFwiZW50ZXJLZXllZFwiLCBvbkVudGVyS2V5ZWQsIHRoaXMpLm9uU3luYyhcInRhYktleWVkXCIsIG9uVGFiS2V5ZWQsIHRoaXMpLm9uU3luYyhcImVzY0tleWVkXCIsIG9uRXNjS2V5ZWQsIHRoaXMpLm9uU3luYyhcInVwS2V5ZWRcIiwgb25VcEtleWVkLCB0aGlzKS5vblN5bmMoXCJkb3duS2V5ZWRcIiwgb25Eb3duS2V5ZWQsIHRoaXMpLm9uU3luYyhcImxlZnRLZXllZFwiLCBvbkxlZnRLZXllZCwgdGhpcykub25TeW5jKFwicmlnaHRLZXllZFwiLCBvblJpZ2h0S2V5ZWQsIHRoaXMpLm9uU3luYyhcInF1ZXJ5Q2hhbmdlZFwiLCBvblF1ZXJ5Q2hhbmdlZCwgdGhpcykub25TeW5jKFwid2hpdGVzcGFjZUNoYW5nZWRcIiwgb25XaGl0ZXNwYWNlQ2hhbmdlZCwgdGhpcykub25TeW5jKFwibGFuZ0RpckNoYW5nZWRcIiwgdGhpcy5fb25MYW5nRGlyQ2hhbmdlZCwgdGhpcyk7XG4gICAgfVxuXG4gICAgXy5taXhpbihUeXBlYWhlYWQucHJvdG90eXBlLCB7XG4gICAgICBfaGFja3M6IGZ1bmN0aW9uIGhhY2tzKCkge1xuICAgICAgICB2YXIgJGlucHV0LCAkbWVudTtcbiAgICAgICAgJGlucHV0ID0gdGhpcy5pbnB1dC4kaW5wdXQgfHwgJChcIjxkaXY+XCIpO1xuICAgICAgICAkbWVudSA9IHRoaXMubWVudS4kbm9kZSB8fCAkKFwiPGRpdj5cIik7XG4gICAgICAgICRpbnB1dC5vbihcImJsdXIudHRcIiwgZnVuY3Rpb24gKCRlKSB7XG4gICAgICAgICAgdmFyIGFjdGl2ZSwgaXNBY3RpdmUsIGhhc0FjdGl2ZTtcbiAgICAgICAgICBhY3RpdmUgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgICAgICAgIGlzQWN0aXZlID0gJG1lbnUuaXMoYWN0aXZlKTtcbiAgICAgICAgICBoYXNBY3RpdmUgPSAkbWVudS5oYXMoYWN0aXZlKS5sZW5ndGggPiAwO1xuXG4gICAgICAgICAgaWYgKF8uaXNNc2llKCkgJiYgKGlzQWN0aXZlIHx8IGhhc0FjdGl2ZSkpIHtcbiAgICAgICAgICAgICRlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAkZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgXy5kZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICRpbnB1dC5mb2N1cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJG1lbnUub24oXCJtb3VzZWRvd24udHRcIiwgZnVuY3Rpb24gKCRlKSB7XG4gICAgICAgICAgJGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgX29uU2VsZWN0YWJsZUNsaWNrZWQ6IGZ1bmN0aW9uIG9uU2VsZWN0YWJsZUNsaWNrZWQodHlwZSwgJGVsKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0KCRlbCk7XG4gICAgICB9LFxuICAgICAgX29uRGF0YXNldENsZWFyZWQ6IGZ1bmN0aW9uIG9uRGF0YXNldENsZWFyZWQoKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUhpbnQoKTtcbiAgICAgIH0sXG4gICAgICBfb25EYXRhc2V0UmVuZGVyZWQ6IGZ1bmN0aW9uIG9uRGF0YXNldFJlbmRlcmVkKHR5cGUsIHN1Z2dlc3Rpb25zLCBhc3luYywgZGF0YXNldCkge1xuICAgICAgICB0aGlzLl91cGRhdGVIaW50KCk7XG5cbiAgICAgICAgaWYgKHRoaXMuYXV0b3NlbGVjdCkge1xuICAgICAgICAgIHZhciBjdXJzb3JDbGFzcyA9IHRoaXMuc2VsZWN0b3JzLmN1cnNvci5zdWJzdHIoMSk7XG4gICAgICAgICAgdGhpcy5tZW51LiRub2RlLmZpbmQodGhpcy5zZWxlY3RvcnMuc3VnZ2VzdGlvbikuZmlyc3QoKS5hZGRDbGFzcyhjdXJzb3JDbGFzcyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmV2ZW50QnVzLnRyaWdnZXIoXCJyZW5kZXJcIiwgc3VnZ2VzdGlvbnMsIGFzeW5jLCBkYXRhc2V0KTtcbiAgICAgIH0sXG4gICAgICBfb25Bc3luY1JlcXVlc3RlZDogZnVuY3Rpb24gb25Bc3luY1JlcXVlc3RlZCh0eXBlLCBkYXRhc2V0LCBxdWVyeSkge1xuICAgICAgICB0aGlzLmV2ZW50QnVzLnRyaWdnZXIoXCJhc3luY3JlcXVlc3RcIiwgcXVlcnksIGRhdGFzZXQpO1xuICAgICAgfSxcbiAgICAgIF9vbkFzeW5jQ2FuY2VsZWQ6IGZ1bmN0aW9uIG9uQXN5bmNDYW5jZWxlZCh0eXBlLCBkYXRhc2V0LCBxdWVyeSkge1xuICAgICAgICB0aGlzLmV2ZW50QnVzLnRyaWdnZXIoXCJhc3luY2NhbmNlbFwiLCBxdWVyeSwgZGF0YXNldCk7XG4gICAgICB9LFxuICAgICAgX29uQXN5bmNSZWNlaXZlZDogZnVuY3Rpb24gb25Bc3luY1JlY2VpdmVkKHR5cGUsIGRhdGFzZXQsIHF1ZXJ5KSB7XG4gICAgICAgIHRoaXMuZXZlbnRCdXMudHJpZ2dlcihcImFzeW5jcmVjZWl2ZVwiLCBxdWVyeSwgZGF0YXNldCk7XG4gICAgICB9LFxuICAgICAgX29uRm9jdXNlZDogZnVuY3Rpb24gb25Gb2N1c2VkKCkge1xuICAgICAgICB0aGlzLl9taW5MZW5ndGhNZXQoKSAmJiB0aGlzLm1lbnUudXBkYXRlKHRoaXMuaW5wdXQuZ2V0UXVlcnkoKSk7XG4gICAgICB9LFxuICAgICAgX29uQmx1cnJlZDogZnVuY3Rpb24gb25CbHVycmVkKCkge1xuICAgICAgICBpZiAodGhpcy5pbnB1dC5oYXNRdWVyeUNoYW5nZWRTaW5jZUxhc3RGb2N1cygpKSB7XG4gICAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKFwiY2hhbmdlXCIsIHRoaXMuaW5wdXQuZ2V0UXVlcnkoKSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBfb25FbnRlcktleWVkOiBmdW5jdGlvbiBvbkVudGVyS2V5ZWQodHlwZSwgJGUpIHtcbiAgICAgICAgdmFyICRzZWxlY3RhYmxlO1xuXG4gICAgICAgIGlmICgkc2VsZWN0YWJsZSA9IHRoaXMubWVudS5nZXRBY3RpdmVTZWxlY3RhYmxlKCkpIHtcbiAgICAgICAgICBpZiAodGhpcy5zZWxlY3QoJHNlbGVjdGFibGUpKSB7XG4gICAgICAgICAgICAkZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgJGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXV0b3NlbGVjdCkge1xuICAgICAgICAgIGlmICh0aGlzLnNlbGVjdCh0aGlzLm1lbnUuZ2V0VG9wU2VsZWN0YWJsZSgpKSkge1xuICAgICAgICAgICAgJGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICRlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIF9vblRhYktleWVkOiBmdW5jdGlvbiBvblRhYktleWVkKHR5cGUsICRlKSB7XG4gICAgICAgIHZhciAkc2VsZWN0YWJsZTtcblxuICAgICAgICBpZiAoJHNlbGVjdGFibGUgPSB0aGlzLm1lbnUuZ2V0QWN0aXZlU2VsZWN0YWJsZSgpKSB7XG4gICAgICAgICAgdGhpcy5zZWxlY3QoJHNlbGVjdGFibGUpICYmICRlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5hdXRvc2VsZWN0KSB7XG4gICAgICAgICAgaWYgKCRzZWxlY3RhYmxlID0gdGhpcy5tZW51LmdldFRvcFNlbGVjdGFibGUoKSkge1xuICAgICAgICAgICAgdGhpcy5hdXRvY29tcGxldGUoJHNlbGVjdGFibGUpICYmICRlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgX29uRXNjS2V5ZWQ6IGZ1bmN0aW9uIG9uRXNjS2V5ZWQoKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH0sXG4gICAgICBfb25VcEtleWVkOiBmdW5jdGlvbiBvblVwS2V5ZWQoKSB7XG4gICAgICAgIHRoaXMubW92ZUN1cnNvcigtMSk7XG4gICAgICB9LFxuICAgICAgX29uRG93bktleWVkOiBmdW5jdGlvbiBvbkRvd25LZXllZCgpIHtcbiAgICAgICAgdGhpcy5tb3ZlQ3Vyc29yKCsxKTtcbiAgICAgIH0sXG4gICAgICBfb25MZWZ0S2V5ZWQ6IGZ1bmN0aW9uIG9uTGVmdEtleWVkKCkge1xuICAgICAgICBpZiAodGhpcy5kaXIgPT09IFwicnRsXCIgJiYgdGhpcy5pbnB1dC5pc0N1cnNvckF0RW5kKCkpIHtcbiAgICAgICAgICB0aGlzLmF1dG9jb21wbGV0ZSh0aGlzLm1lbnUuZ2V0QWN0aXZlU2VsZWN0YWJsZSgpIHx8IHRoaXMubWVudS5nZXRUb3BTZWxlY3RhYmxlKCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgX29uUmlnaHRLZXllZDogZnVuY3Rpb24gb25SaWdodEtleWVkKCkge1xuICAgICAgICBpZiAodGhpcy5kaXIgPT09IFwibHRyXCIgJiYgdGhpcy5pbnB1dC5pc0N1cnNvckF0RW5kKCkpIHtcbiAgICAgICAgICB0aGlzLmF1dG9jb21wbGV0ZSh0aGlzLm1lbnUuZ2V0QWN0aXZlU2VsZWN0YWJsZSgpIHx8IHRoaXMubWVudS5nZXRUb3BTZWxlY3RhYmxlKCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgX29uUXVlcnlDaGFuZ2VkOiBmdW5jdGlvbiBvblF1ZXJ5Q2hhbmdlZChlLCBxdWVyeSkge1xuICAgICAgICB0aGlzLl9taW5MZW5ndGhNZXQocXVlcnkpID8gdGhpcy5tZW51LnVwZGF0ZShxdWVyeSkgOiB0aGlzLm1lbnUuZW1wdHkoKTtcbiAgICAgIH0sXG4gICAgICBfb25XaGl0ZXNwYWNlQ2hhbmdlZDogZnVuY3Rpb24gb25XaGl0ZXNwYWNlQ2hhbmdlZCgpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlSGludCgpO1xuICAgICAgfSxcbiAgICAgIF9vbkxhbmdEaXJDaGFuZ2VkOiBmdW5jdGlvbiBvbkxhbmdEaXJDaGFuZ2VkKGUsIGRpcikge1xuICAgICAgICBpZiAodGhpcy5kaXIgIT09IGRpcikge1xuICAgICAgICAgIHRoaXMuZGlyID0gZGlyO1xuICAgICAgICAgIHRoaXMubWVudS5zZXRMYW5ndWFnZURpcmVjdGlvbihkaXIpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgX29wZW5JZkFjdGl2ZTogZnVuY3Rpb24gb3BlbklmQWN0aXZlKCkge1xuICAgICAgICB0aGlzLmlzQWN0aXZlKCkgJiYgdGhpcy5vcGVuKCk7XG4gICAgICB9LFxuICAgICAgX21pbkxlbmd0aE1ldDogZnVuY3Rpb24gbWluTGVuZ3RoTWV0KHF1ZXJ5KSB7XG4gICAgICAgIHF1ZXJ5ID0gXy5pc1N0cmluZyhxdWVyeSkgPyBxdWVyeSA6IHRoaXMuaW5wdXQuZ2V0UXVlcnkoKSB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gcXVlcnkubGVuZ3RoID49IHRoaXMubWluTGVuZ3RoO1xuICAgICAgfSxcbiAgICAgIF91cGRhdGVIaW50OiBmdW5jdGlvbiB1cGRhdGVIaW50KCkge1xuICAgICAgICB2YXIgJHNlbGVjdGFibGUsIGRhdGEsIHZhbCwgcXVlcnksIGVzY2FwZWRRdWVyeSwgZnJvbnRNYXRjaFJlZ0V4LCBtYXRjaDtcbiAgICAgICAgJHNlbGVjdGFibGUgPSB0aGlzLm1lbnUuZ2V0VG9wU2VsZWN0YWJsZSgpO1xuICAgICAgICBkYXRhID0gdGhpcy5tZW51LmdldFNlbGVjdGFibGVEYXRhKCRzZWxlY3RhYmxlKTtcbiAgICAgICAgdmFsID0gdGhpcy5pbnB1dC5nZXRJbnB1dFZhbHVlKCk7XG5cbiAgICAgICAgaWYgKGRhdGEgJiYgIV8uaXNCbGFua1N0cmluZyh2YWwpICYmICF0aGlzLmlucHV0Lmhhc092ZXJmbG93KCkpIHtcbiAgICAgICAgICBxdWVyeSA9IElucHV0Lm5vcm1hbGl6ZVF1ZXJ5KHZhbCk7XG4gICAgICAgICAgZXNjYXBlZFF1ZXJ5ID0gXy5lc2NhcGVSZWdFeENoYXJzKHF1ZXJ5KTtcbiAgICAgICAgICBmcm9udE1hdGNoUmVnRXggPSBuZXcgUmVnRXhwKFwiXig/OlwiICsgZXNjYXBlZFF1ZXJ5ICsgXCIpKC4rJClcIiwgXCJpXCIpO1xuICAgICAgICAgIG1hdGNoID0gZnJvbnRNYXRjaFJlZ0V4LmV4ZWMoZGF0YS52YWwpO1xuICAgICAgICAgIG1hdGNoICYmIHRoaXMuaW5wdXQuc2V0SGludCh2YWwgKyBtYXRjaFsxXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5pbnB1dC5jbGVhckhpbnQoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGlzRW5hYmxlZDogZnVuY3Rpb24gaXNFbmFibGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbmFibGVkO1xuICAgICAgfSxcbiAgICAgIGVuYWJsZTogZnVuY3Rpb24gZW5hYmxlKCkge1xuICAgICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgfSxcbiAgICAgIGRpc2FibGU6IGZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gICAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgfSxcbiAgICAgIGlzQWN0aXZlOiBmdW5jdGlvbiBpc0FjdGl2ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlO1xuICAgICAgfSxcbiAgICAgIGFjdGl2YXRlOiBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNBY3RpdmUoKSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmlzRW5hYmxlZCgpIHx8IHRoaXMuZXZlbnRCdXMuYmVmb3JlKFwiYWN0aXZlXCIpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmV2ZW50QnVzLnRyaWdnZXIoXCJhY3RpdmVcIik7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZWFjdGl2YXRlOiBmdW5jdGlvbiBkZWFjdGl2YXRlKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNBY3RpdmUoKSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZXZlbnRCdXMuYmVmb3JlKFwiaWRsZVwiKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICB0aGlzLmV2ZW50QnVzLnRyaWdnZXIoXCJpZGxlXCIpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaXNPcGVuOiBmdW5jdGlvbiBpc09wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lbnUuaXNPcGVuKCk7XG4gICAgICB9LFxuICAgICAgb3BlbjogZnVuY3Rpb24gb3BlbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzT3BlbigpICYmICF0aGlzLmV2ZW50QnVzLmJlZm9yZShcIm9wZW5cIikpIHtcbiAgICAgICAgICB0aGlzLm1lbnUub3BlbigpO1xuXG4gICAgICAgICAgdGhpcy5fdXBkYXRlSGludCgpO1xuXG4gICAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKFwib3BlblwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmlzT3BlbigpO1xuICAgICAgfSxcbiAgICAgIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuKCkgJiYgIXRoaXMuZXZlbnRCdXMuYmVmb3JlKFwiY2xvc2VcIikpIHtcbiAgICAgICAgICB0aGlzLm1lbnUuY2xvc2UoKTtcbiAgICAgICAgICB0aGlzLmlucHV0LmNsZWFySGludCgpO1xuICAgICAgICAgIHRoaXMuaW5wdXQucmVzZXRJbnB1dFZhbHVlKCk7XG4gICAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKFwiY2xvc2VcIik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gIXRoaXMuaXNPcGVuKCk7XG4gICAgICB9LFxuICAgICAgc2V0VmFsOiBmdW5jdGlvbiBzZXRWYWwodmFsKSB7XG4gICAgICAgIHRoaXMuaW5wdXQuc2V0UXVlcnkoXy50b1N0cih2YWwpKTtcbiAgICAgIH0sXG4gICAgICBnZXRWYWw6IGZ1bmN0aW9uIGdldFZhbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5wdXQuZ2V0UXVlcnkoKTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3Q6IGZ1bmN0aW9uIHNlbGVjdCgkc2VsZWN0YWJsZSkge1xuICAgICAgICB2YXIgZGF0YSA9IHRoaXMubWVudS5nZXRTZWxlY3RhYmxlRGF0YSgkc2VsZWN0YWJsZSk7XG5cbiAgICAgICAgaWYgKGRhdGEgJiYgIXRoaXMuZXZlbnRCdXMuYmVmb3JlKFwic2VsZWN0XCIsIGRhdGEub2JqLCBkYXRhLmRhdGFzZXQpKSB7XG4gICAgICAgICAgdGhpcy5pbnB1dC5zZXRRdWVyeShkYXRhLnZhbCwgdHJ1ZSk7XG4gICAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKFwic2VsZWN0XCIsIGRhdGEub2JqLCBkYXRhLmRhdGFzZXQpO1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0sXG4gICAgICBhdXRvY29tcGxldGU6IGZ1bmN0aW9uIGF1dG9jb21wbGV0ZSgkc2VsZWN0YWJsZSkge1xuICAgICAgICB2YXIgcXVlcnksIGRhdGEsIGlzVmFsaWQ7XG4gICAgICAgIHF1ZXJ5ID0gdGhpcy5pbnB1dC5nZXRRdWVyeSgpO1xuICAgICAgICBkYXRhID0gdGhpcy5tZW51LmdldFNlbGVjdGFibGVEYXRhKCRzZWxlY3RhYmxlKTtcbiAgICAgICAgaXNWYWxpZCA9IGRhdGEgJiYgcXVlcnkgIT09IGRhdGEudmFsO1xuXG4gICAgICAgIGlmIChpc1ZhbGlkICYmICF0aGlzLmV2ZW50QnVzLmJlZm9yZShcImF1dG9jb21wbGV0ZVwiLCBkYXRhLm9iaiwgZGF0YS5kYXRhc2V0KSkge1xuICAgICAgICAgIHRoaXMuaW5wdXQuc2V0UXVlcnkoZGF0YS52YWwpO1xuICAgICAgICAgIHRoaXMuZXZlbnRCdXMudHJpZ2dlcihcImF1dG9jb21wbGV0ZVwiLCBkYXRhLm9iaiwgZGF0YS5kYXRhc2V0KTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0sXG4gICAgICBtb3ZlQ3Vyc29yOiBmdW5jdGlvbiBtb3ZlQ3Vyc29yKGRlbHRhKSB7XG4gICAgICAgIHZhciBxdWVyeSwgJGNhbmRpZGF0ZSwgZGF0YSwgc3VnZ2VzdGlvbiwgZGF0YXNldE5hbWUsIGNhbmNlbE1vdmUsIGlkO1xuICAgICAgICBxdWVyeSA9IHRoaXMuaW5wdXQuZ2V0UXVlcnkoKTtcbiAgICAgICAgJGNhbmRpZGF0ZSA9IHRoaXMubWVudS5zZWxlY3RhYmxlUmVsYXRpdmVUb0N1cnNvcihkZWx0YSk7XG4gICAgICAgIGRhdGEgPSB0aGlzLm1lbnUuZ2V0U2VsZWN0YWJsZURhdGEoJGNhbmRpZGF0ZSk7XG4gICAgICAgIHN1Z2dlc3Rpb24gPSBkYXRhID8gZGF0YS5vYmogOiBudWxsO1xuICAgICAgICBkYXRhc2V0TmFtZSA9IGRhdGEgPyBkYXRhLmRhdGFzZXQgOiBudWxsO1xuICAgICAgICBpZCA9ICRjYW5kaWRhdGUgPyAkY2FuZGlkYXRlLmF0dHIoXCJpZFwiKSA6IG51bGw7XG4gICAgICAgIHRoaXMuaW5wdXQudHJpZ2dlcihcImN1cnNvcmNoYW5nZVwiLCBpZCk7XG4gICAgICAgIGNhbmNlbE1vdmUgPSB0aGlzLl9taW5MZW5ndGhNZXQoKSAmJiB0aGlzLm1lbnUudXBkYXRlKHF1ZXJ5KTtcblxuICAgICAgICBpZiAoIWNhbmNlbE1vdmUgJiYgIXRoaXMuZXZlbnRCdXMuYmVmb3JlKFwiY3Vyc29yY2hhbmdlXCIsIHN1Z2dlc3Rpb24sIGRhdGFzZXROYW1lKSkge1xuICAgICAgICAgIHRoaXMubWVudS5zZXRDdXJzb3IoJGNhbmRpZGF0ZSk7XG5cbiAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhLnZhbCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICB0aGlzLmlucHV0LnNldElucHV0VmFsdWUoZGF0YS52YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmlucHV0LnJlc2V0SW5wdXRWYWx1ZSgpO1xuXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVIaW50KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKFwiY3Vyc29yY2hhbmdlXCIsIHN1Z2dlc3Rpb24sIGRhdGFzZXROYW1lKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0sXG4gICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLmlucHV0LmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5tZW51LmRlc3Ryb3koKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBUeXBlYWhlYWQ7XG5cbiAgICBmdW5jdGlvbiBjKGN0eCkge1xuICAgICAgdmFyIG1ldGhvZHMgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcblxuICAgICAgICBfLmVhY2gobWV0aG9kcywgZnVuY3Rpb24gKG1ldGhvZCkge1xuICAgICAgICAgIHJldHVybiBjdHhbbWV0aG9kXS5hcHBseShjdHgsIGFyZ3MpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfVxuICB9KCk7XG5cbiAgKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBvbGQsIGtleXMsIG1ldGhvZHM7XG4gICAgb2xkID0gJC5mbi50eXBlYWhlYWQ7XG4gICAga2V5cyA9IHtcbiAgICAgIHd3dzogXCJ0dC13d3dcIixcbiAgICAgIGF0dHJzOiBcInR0LWF0dHJzXCIsXG4gICAgICB0eXBlYWhlYWQ6IFwidHQtdHlwZWFoZWFkXCJcbiAgICB9O1xuICAgIG1ldGhvZHMgPSB7XG4gICAgICBpbml0aWFsaXplOiBmdW5jdGlvbiBpbml0aWFsaXplKG8sIGRhdGFzZXRzKSB7XG4gICAgICAgIHZhciB3d3c7XG4gICAgICAgIGRhdGFzZXRzID0gXy5pc0FycmF5KGRhdGFzZXRzKSA/IGRhdGFzZXRzIDogW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgICAgICBvID0gbyB8fCB7fTtcbiAgICAgICAgd3d3ID0gV1dXKG8uY2xhc3NOYW1lcyk7XG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goYXR0YWNoKTtcblxuICAgICAgICBmdW5jdGlvbiBhdHRhY2goKSB7XG4gICAgICAgICAgdmFyICRpbnB1dCwgJHdyYXBwZXIsICRoaW50LCAkbWVudSwgZGVmYXVsdEhpbnQsIGRlZmF1bHRNZW51LCBldmVudEJ1cywgaW5wdXQsIG1lbnUsIHN0YXR1cywgdHlwZWFoZWFkLCBNZW51Q29uc3RydWN0b3I7XG5cbiAgICAgICAgICBfLmVhY2goZGF0YXNldHMsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICBkLmhpZ2hsaWdodCA9ICEhby5oaWdobGlnaHQ7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAkaW5wdXQgPSAkKHRoaXMpO1xuICAgICAgICAgICR3cmFwcGVyID0gJCh3d3cuaHRtbC53cmFwcGVyKTtcbiAgICAgICAgICAkaGludCA9ICRlbE9yTnVsbChvLmhpbnQpO1xuICAgICAgICAgICRtZW51ID0gJGVsT3JOdWxsKG8ubWVudSk7XG4gICAgICAgICAgZGVmYXVsdEhpbnQgPSBvLmhpbnQgIT09IGZhbHNlICYmICEkaGludDtcbiAgICAgICAgICBkZWZhdWx0TWVudSA9IG8ubWVudSAhPT0gZmFsc2UgJiYgISRtZW51O1xuICAgICAgICAgIGRlZmF1bHRIaW50ICYmICgkaGludCA9IGJ1aWxkSGludEZyb21JbnB1dCgkaW5wdXQsIHd3dykpO1xuICAgICAgICAgIGRlZmF1bHRNZW51ICYmICgkbWVudSA9ICQod3d3Lmh0bWwubWVudSkuY3NzKHd3dy5jc3MubWVudSkpO1xuICAgICAgICAgICRoaW50ICYmICRoaW50LnZhbChcIlwiKTtcbiAgICAgICAgICAkaW5wdXQgPSBwcmVwSW5wdXQoJGlucHV0LCB3d3cpO1xuXG4gICAgICAgICAgaWYgKGRlZmF1bHRIaW50IHx8IGRlZmF1bHRNZW51KSB7XG4gICAgICAgICAgICAkd3JhcHBlci5jc3Mod3d3LmNzcy53cmFwcGVyKTtcbiAgICAgICAgICAgICRpbnB1dC5jc3MoZGVmYXVsdEhpbnQgPyB3d3cuY3NzLmlucHV0IDogd3d3LmNzcy5pbnB1dFdpdGhOb0hpbnQpO1xuICAgICAgICAgICAgJGlucHV0LndyYXAoJHdyYXBwZXIpLnBhcmVudCgpLnByZXBlbmQoZGVmYXVsdEhpbnQgPyAkaGludCA6IG51bGwpLmFwcGVuZChkZWZhdWx0TWVudSA/ICRtZW51IDogbnVsbCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgTWVudUNvbnN0cnVjdG9yID0gZGVmYXVsdE1lbnUgPyBEZWZhdWx0TWVudSA6IE1lbnU7XG4gICAgICAgICAgZXZlbnRCdXMgPSBuZXcgRXZlbnRCdXMoe1xuICAgICAgICAgICAgZWw6ICRpbnB1dFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlucHV0ID0gbmV3IElucHV0KHtcbiAgICAgICAgICAgIGhpbnQ6ICRoaW50LFxuICAgICAgICAgICAgaW5wdXQ6ICRpbnB1dFxuICAgICAgICAgIH0sIHd3dyk7XG4gICAgICAgICAgbWVudSA9IG5ldyBNZW51Q29uc3RydWN0b3Ioe1xuICAgICAgICAgICAgbm9kZTogJG1lbnUsXG4gICAgICAgICAgICBkYXRhc2V0czogZGF0YXNldHNcbiAgICAgICAgICB9LCB3d3cpO1xuICAgICAgICAgIHN0YXR1cyA9IG5ldyBTdGF0dXMoe1xuICAgICAgICAgICAgJGlucHV0OiAkaW5wdXQsXG4gICAgICAgICAgICBtZW51OiBtZW51XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdHlwZWFoZWFkID0gbmV3IFR5cGVhaGVhZCh7XG4gICAgICAgICAgICBpbnB1dDogaW5wdXQsXG4gICAgICAgICAgICBtZW51OiBtZW51LFxuICAgICAgICAgICAgZXZlbnRCdXM6IGV2ZW50QnVzLFxuICAgICAgICAgICAgbWluTGVuZ3RoOiBvLm1pbkxlbmd0aCxcbiAgICAgICAgICAgIGF1dG9zZWxlY3Q6IG8uYXV0b3NlbGVjdFxuICAgICAgICAgIH0sIHd3dyk7XG4gICAgICAgICAgJGlucHV0LmRhdGEoa2V5cy53d3csIHd3dyk7XG4gICAgICAgICAgJGlucHV0LmRhdGEoa2V5cy50eXBlYWhlYWQsIHR5cGVhaGVhZCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpc0VuYWJsZWQ6IGZ1bmN0aW9uIGlzRW5hYmxlZCgpIHtcbiAgICAgICAgdmFyIGVuYWJsZWQ7XG4gICAgICAgIHR0RWFjaCh0aGlzLmZpcnN0KCksIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgZW5hYmxlZCA9IHQuaXNFbmFibGVkKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZW5hYmxlZDtcbiAgICAgIH0sXG4gICAgICBlbmFibGU6IGZ1bmN0aW9uIGVuYWJsZSgpIHtcbiAgICAgICAgdHRFYWNoKHRoaXMsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgdC5lbmFibGUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSxcbiAgICAgIGRpc2FibGU6IGZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gICAgICAgIHR0RWFjaCh0aGlzLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHQuZGlzYWJsZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9LFxuICAgICAgaXNBY3RpdmU6IGZ1bmN0aW9uIGlzQWN0aXZlKCkge1xuICAgICAgICB2YXIgYWN0aXZlO1xuICAgICAgICB0dEVhY2godGhpcy5maXJzdCgpLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIGFjdGl2ZSA9IHQuaXNBY3RpdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhY3RpdmU7XG4gICAgICB9LFxuICAgICAgYWN0aXZhdGU6IGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICB0dEVhY2godGhpcywgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICB0LmFjdGl2YXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0sXG4gICAgICBkZWFjdGl2YXRlOiBmdW5jdGlvbiBkZWFjdGl2YXRlKCkge1xuICAgICAgICB0dEVhY2godGhpcywgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICB0LmRlYWN0aXZhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSxcbiAgICAgIGlzT3BlbjogZnVuY3Rpb24gaXNPcGVuKCkge1xuICAgICAgICB2YXIgb3BlbjtcbiAgICAgICAgdHRFYWNoKHRoaXMuZmlyc3QoKSwgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICBvcGVuID0gdC5pc09wZW4oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvcGVuO1xuICAgICAgfSxcbiAgICAgIG9wZW46IGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgICAgIHR0RWFjaCh0aGlzLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHQub3BlbigpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9LFxuICAgICAgY2xvc2U6IGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgICB0dEVhY2godGhpcywgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICB0LmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0sXG4gICAgICBzZWxlY3Q6IGZ1bmN0aW9uIHNlbGVjdChlbCkge1xuICAgICAgICB2YXIgc3VjY2VzcyA9IGZhbHNlLFxuICAgICAgICAgICAgJGVsID0gJChlbCk7XG4gICAgICAgIHR0RWFjaCh0aGlzLmZpcnN0KCksIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgc3VjY2VzcyA9IHQuc2VsZWN0KCRlbCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc3VjY2VzcztcbiAgICAgIH0sXG4gICAgICBhdXRvY29tcGxldGU6IGZ1bmN0aW9uIGF1dG9jb21wbGV0ZShlbCkge1xuICAgICAgICB2YXIgc3VjY2VzcyA9IGZhbHNlLFxuICAgICAgICAgICAgJGVsID0gJChlbCk7XG4gICAgICAgIHR0RWFjaCh0aGlzLmZpcnN0KCksIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgc3VjY2VzcyA9IHQuYXV0b2NvbXBsZXRlKCRlbCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc3VjY2VzcztcbiAgICAgIH0sXG4gICAgICBtb3ZlQ3Vyc29yOiBmdW5jdGlvbiBtb3ZlQ3Vyc29lKGRlbHRhKSB7XG4gICAgICAgIHZhciBzdWNjZXNzID0gZmFsc2U7XG4gICAgICAgIHR0RWFjaCh0aGlzLmZpcnN0KCksIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgc3VjY2VzcyA9IHQubW92ZUN1cnNvcihkZWx0YSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc3VjY2VzcztcbiAgICAgIH0sXG4gICAgICB2YWw6IGZ1bmN0aW9uIHZhbChuZXdWYWwpIHtcbiAgICAgICAgdmFyIHF1ZXJ5O1xuXG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgIHR0RWFjaCh0aGlzLmZpcnN0KCksIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICBxdWVyeSA9IHQuZ2V0VmFsKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHR0RWFjaCh0aGlzLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgdC5zZXRWYWwoXy50b1N0cihuZXdWYWwpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIHR0RWFjaCh0aGlzLCBmdW5jdGlvbiAodHlwZWFoZWFkLCAkaW5wdXQpIHtcbiAgICAgICAgICByZXZlcnQoJGlucHV0KTtcbiAgICAgICAgICB0eXBlYWhlYWQuZGVzdHJveSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgfTtcblxuICAgICQuZm4udHlwZWFoZWFkID0gZnVuY3Rpb24gKG1ldGhvZCkge1xuICAgICAgaWYgKG1ldGhvZHNbbWV0aG9kXSkge1xuICAgICAgICByZXR1cm4gbWV0aG9kc1ttZXRob2RdLmFwcGx5KHRoaXMsIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgICQuZm4udHlwZWFoZWFkLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiBub0NvbmZsaWN0KCkge1xuICAgICAgJC5mbi50eXBlYWhlYWQgPSBvbGQ7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gdHRFYWNoKCRlbHMsIGZuKSB7XG4gICAgICAkZWxzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgJGlucHV0ID0gJCh0aGlzKSxcbiAgICAgICAgICAgIHR5cGVhaGVhZDtcbiAgICAgICAgKHR5cGVhaGVhZCA9ICRpbnB1dC5kYXRhKGtleXMudHlwZWFoZWFkKSkgJiYgZm4odHlwZWFoZWFkLCAkaW5wdXQpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYnVpbGRIaW50RnJvbUlucHV0KCRpbnB1dCwgd3d3KSB7XG4gICAgICByZXR1cm4gJGlucHV0LmNsb25lKCkuYWRkQ2xhc3Mod3d3LmNsYXNzZXMuaGludCkucmVtb3ZlRGF0YSgpLmNzcyh3d3cuY3NzLmhpbnQpLmNzcyhnZXRCYWNrZ3JvdW5kU3R5bGVzKCRpbnB1dCkpLnByb3Aoe1xuICAgICAgICByZWFkb25seTogdHJ1ZSxcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICB9KS5yZW1vdmVBdHRyKFwiaWQgbmFtZSBwbGFjZWhvbGRlclwiKS5yZW1vdmVDbGFzcyhcInJlcXVpcmVkXCIpLmF0dHIoe1xuICAgICAgICBzcGVsbGNoZWNrOiBcImZhbHNlXCIsXG4gICAgICAgIHRhYmluZGV4OiAtMVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJlcElucHV0KCRpbnB1dCwgd3d3KSB7XG4gICAgICAkaW5wdXQuZGF0YShrZXlzLmF0dHJzLCB7XG4gICAgICAgIGRpcjogJGlucHV0LmF0dHIoXCJkaXJcIiksXG4gICAgICAgIGF1dG9jb21wbGV0ZTogJGlucHV0LmF0dHIoXCJhdXRvY29tcGxldGVcIiksXG4gICAgICAgIHNwZWxsY2hlY2s6ICRpbnB1dC5hdHRyKFwic3BlbGxjaGVja1wiKSxcbiAgICAgICAgc3R5bGU6ICRpbnB1dC5hdHRyKFwic3R5bGVcIilcbiAgICAgIH0pO1xuICAgICAgJGlucHV0LmFkZENsYXNzKHd3dy5jbGFzc2VzLmlucHV0KS5hdHRyKHtcbiAgICAgICAgc3BlbGxjaGVjazogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICAhJGlucHV0LmF0dHIoXCJkaXJcIikgJiYgJGlucHV0LmF0dHIoXCJkaXJcIiwgXCJhdXRvXCIpO1xuICAgICAgfSBjYXRjaCAoZSkge31cblxuICAgICAgcmV0dXJuICRpbnB1dDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRCYWNrZ3JvdW5kU3R5bGVzKCRlbCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYmFja2dyb3VuZEF0dGFjaG1lbnQ6ICRlbC5jc3MoXCJiYWNrZ3JvdW5kLWF0dGFjaG1lbnRcIiksXG4gICAgICAgIGJhY2tncm91bmRDbGlwOiAkZWwuY3NzKFwiYmFja2dyb3VuZC1jbGlwXCIpLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICRlbC5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpLFxuICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6ICRlbC5jc3MoXCJiYWNrZ3JvdW5kLWltYWdlXCIpLFxuICAgICAgICBiYWNrZ3JvdW5kT3JpZ2luOiAkZWwuY3NzKFwiYmFja2dyb3VuZC1vcmlnaW5cIiksXG4gICAgICAgIGJhY2tncm91bmRQb3NpdGlvbjogJGVsLmNzcyhcImJhY2tncm91bmQtcG9zaXRpb25cIiksXG4gICAgICAgIGJhY2tncm91bmRSZXBlYXQ6ICRlbC5jc3MoXCJiYWNrZ3JvdW5kLXJlcGVhdFwiKSxcbiAgICAgICAgYmFja2dyb3VuZFNpemU6ICRlbC5jc3MoXCJiYWNrZ3JvdW5kLXNpemVcIilcbiAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmV2ZXJ0KCRpbnB1dCkge1xuICAgICAgdmFyIHd3dywgJHdyYXBwZXI7XG4gICAgICB3d3cgPSAkaW5wdXQuZGF0YShrZXlzLnd3dyk7XG4gICAgICAkd3JhcHBlciA9ICRpbnB1dC5wYXJlbnQoKS5maWx0ZXIod3d3LnNlbGVjdG9ycy53cmFwcGVyKTtcblxuICAgICAgXy5lYWNoKCRpbnB1dC5kYXRhKGtleXMuYXR0cnMpLCBmdW5jdGlvbiAodmFsLCBrZXkpIHtcbiAgICAgICAgXy5pc1VuZGVmaW5lZCh2YWwpID8gJGlucHV0LnJlbW92ZUF0dHIoa2V5KSA6ICRpbnB1dC5hdHRyKGtleSwgdmFsKTtcbiAgICAgIH0pO1xuXG4gICAgICAkaW5wdXQucmVtb3ZlRGF0YShrZXlzLnR5cGVhaGVhZCkucmVtb3ZlRGF0YShrZXlzLnd3dykucmVtb3ZlRGF0YShrZXlzLmF0dHIpLnJlbW92ZUNsYXNzKHd3dy5jbGFzc2VzLmlucHV0KTtcblxuICAgICAgaWYgKCR3cmFwcGVyLmxlbmd0aCkge1xuICAgICAgICAkaW5wdXQuZGV0YWNoKCkuaW5zZXJ0QWZ0ZXIoJHdyYXBwZXIpO1xuICAgICAgICAkd3JhcHBlci5yZW1vdmUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiAkZWxPck51bGwob2JqKSB7XG4gICAgICB2YXIgaXNWYWxpZCwgJGVsO1xuICAgICAgaXNWYWxpZCA9IF8uaXNKUXVlcnkob2JqKSB8fCBfLmlzRWxlbWVudChvYmopO1xuICAgICAgJGVsID0gaXNWYWxpZCA/ICQob2JqKS5maXJzdCgpIDogW107XG4gICAgICByZXR1cm4gJGVsLmxlbmd0aCA/ICRlbCA6IG51bGw7XG4gICAgfVxuICB9KSgpO1xufSk7IiwibW9kdWxlLmV4cG9ydHMgPSBnbG9iYWxbXCJCbG9vZGhvdW5kXCJdID0gcmVxdWlyZShcIi0hL2hvbWUvdHJhdmlzL2J1aWxkL2NhbXB0b2NhbXAvbmdlby9ub2RlX21vZHVsZXMvYmFiZWwtbG9hZGVyL2xpYi9pbmRleC5qcz8/cmVmLS0xMCEuL3R5cGVhaGVhZC5idW5kbGUuanNcIik7IiwiaW1wb3J0IHsgZGF5c0luTW9udGggfSBmcm9tICcuLi91bml0cy9tb250aCc7XG5pbXBvcnQgeyBZRUFSLCBNT05USCwgREFURSwgSE9VUiwgTUlOVVRFLCBTRUNPTkQsIE1JTExJU0VDT05ELCBXRUVLLCBXRUVLREFZIH0gZnJvbSAnLi4vdW5pdHMvY29uc3RhbnRzJztcbmltcG9ydCBnZXRQYXJzaW5nRmxhZ3MgZnJvbSAnLi4vY3JlYXRlL3BhcnNpbmctZmxhZ3MnO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY2hlY2tPdmVyZmxvdyhtKSB7XG4gIHZhciBvdmVyZmxvdztcbiAgdmFyIGEgPSBtLl9hO1xuXG4gIGlmIChhICYmIGdldFBhcnNpbmdGbGFncyhtKS5vdmVyZmxvdyA9PT0gLTIpIHtcbiAgICBvdmVyZmxvdyA9IGFbTU9OVEhdIDwgMCB8fCBhW01PTlRIXSA+IDExID8gTU9OVEggOiBhW0RBVEVdIDwgMSB8fCBhW0RBVEVdID4gZGF5c0luTW9udGgoYVtZRUFSXSwgYVtNT05USF0pID8gREFURSA6IGFbSE9VUl0gPCAwIHx8IGFbSE9VUl0gPiAyNCB8fCBhW0hPVVJdID09PSAyNCAmJiAoYVtNSU5VVEVdICE9PSAwIHx8IGFbU0VDT05EXSAhPT0gMCB8fCBhW01JTExJU0VDT05EXSAhPT0gMCkgPyBIT1VSIDogYVtNSU5VVEVdIDwgMCB8fCBhW01JTlVURV0gPiA1OSA/IE1JTlVURSA6IGFbU0VDT05EXSA8IDAgfHwgYVtTRUNPTkRdID4gNTkgPyBTRUNPTkQgOiBhW01JTExJU0VDT05EXSA8IDAgfHwgYVtNSUxMSVNFQ09ORF0gPiA5OTkgPyBNSUxMSVNFQ09ORCA6IC0xO1xuXG4gICAgaWYgKGdldFBhcnNpbmdGbGFncyhtKS5fb3ZlcmZsb3dEYXlPZlllYXIgJiYgKG92ZXJmbG93IDwgWUVBUiB8fCBvdmVyZmxvdyA+IERBVEUpKSB7XG4gICAgICBvdmVyZmxvdyA9IERBVEU7XG4gICAgfVxuXG4gICAgaWYgKGdldFBhcnNpbmdGbGFncyhtKS5fb3ZlcmZsb3dXZWVrcyAmJiBvdmVyZmxvdyA9PT0gLTEpIHtcbiAgICAgIG92ZXJmbG93ID0gV0VFSztcbiAgICB9XG5cbiAgICBpZiAoZ2V0UGFyc2luZ0ZsYWdzKG0pLl9vdmVyZmxvd1dlZWtkYXkgJiYgb3ZlcmZsb3cgPT09IC0xKSB7XG4gICAgICBvdmVyZmxvdyA9IFdFRUtEQVk7XG4gICAgfVxuXG4gICAgZ2V0UGFyc2luZ0ZsYWdzKG0pLm92ZXJmbG93ID0gb3ZlcmZsb3c7XG4gIH1cblxuICByZXR1cm4gbTtcbn0iLCJleHBvcnQgZnVuY3Rpb24gY3JlYXRlRGF0ZSh5LCBtLCBkLCBoLCBNLCBzLCBtcykge1xuICB2YXIgZGF0ZTtcblxuICBpZiAoeSA8IDEwMCAmJiB5ID49IDApIHtcbiAgICBkYXRlID0gbmV3IERhdGUoeSArIDQwMCwgbSwgZCwgaCwgTSwgcywgbXMpO1xuXG4gICAgaWYgKGlzRmluaXRlKGRhdGUuZ2V0RnVsbFllYXIoKSkpIHtcbiAgICAgIGRhdGUuc2V0RnVsbFllYXIoeSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGRhdGUgPSBuZXcgRGF0ZSh5LCBtLCBkLCBoLCBNLCBzLCBtcyk7XG4gIH1cblxuICByZXR1cm4gZGF0ZTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVVVENEYXRlKHkpIHtcbiAgdmFyIGRhdGU7XG5cbiAgaWYgKHkgPCAxMDAgJiYgeSA+PSAwKSB7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuICAgIGFyZ3NbMF0gPSB5ICsgNDAwO1xuICAgIGRhdGUgPSBuZXcgRGF0ZShEYXRlLlVUQy5hcHBseShudWxsLCBhcmdzKSk7XG5cbiAgICBpZiAoaXNGaW5pdGUoZGF0ZS5nZXRVVENGdWxsWWVhcigpKSkge1xuICAgICAgZGF0ZS5zZXRVVENGdWxsWWVhcih5KTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZGF0ZSA9IG5ldyBEYXRlKERhdGUuVVRDLmFwcGx5KG51bGwsIGFyZ3VtZW50cykpO1xuICB9XG5cbiAgcmV0dXJuIGRhdGU7XG59IiwiaW1wb3J0IGlzQXJyYXkgZnJvbSAnLi4vdXRpbHMvaXMtYXJyYXknO1xuaW1wb3J0IGlzT2JqZWN0IGZyb20gJy4uL3V0aWxzL2lzLW9iamVjdCc7XG5pbXBvcnQgaXNPYmplY3RFbXB0eSBmcm9tICcuLi91dGlscy9pcy1vYmplY3QtZW1wdHknO1xuaW1wb3J0IGlzVW5kZWZpbmVkIGZyb20gJy4uL3V0aWxzL2lzLXVuZGVmaW5lZCc7XG5pbXBvcnQgaXNOdW1iZXIgZnJvbSAnLi4vdXRpbHMvaXMtbnVtYmVyJztcbmltcG9ydCBpc0RhdGUgZnJvbSAnLi4vdXRpbHMvaXMtZGF0ZSc7XG5pbXBvcnQgbWFwIGZyb20gJy4uL3V0aWxzL21hcCc7XG5pbXBvcnQgeyBjcmVhdGVJbnZhbGlkIH0gZnJvbSAnLi92YWxpZCc7XG5pbXBvcnQgeyBNb21lbnQsIGlzTW9tZW50IH0gZnJvbSAnLi4vbW9tZW50L2NvbnN0cnVjdG9yJztcbmltcG9ydCB7IGdldExvY2FsZSB9IGZyb20gJy4uL2xvY2FsZS9sb2NhbGVzJztcbmltcG9ydCB7IGhvb2tzIH0gZnJvbSAnLi4vdXRpbHMvaG9va3MnO1xuaW1wb3J0IGNoZWNrT3ZlcmZsb3cgZnJvbSAnLi9jaGVjay1vdmVyZmxvdyc7XG5pbXBvcnQgeyBpc1ZhbGlkIH0gZnJvbSAnLi92YWxpZCc7XG5pbXBvcnQgeyBjb25maWdGcm9tU3RyaW5nQW5kQXJyYXkgfSBmcm9tICcuL2Zyb20tc3RyaW5nLWFuZC1hcnJheSc7XG5pbXBvcnQgeyBjb25maWdGcm9tU3RyaW5nQW5kRm9ybWF0IH0gZnJvbSAnLi9mcm9tLXN0cmluZy1hbmQtZm9ybWF0JztcbmltcG9ydCB7IGNvbmZpZ0Zyb21TdHJpbmcgfSBmcm9tICcuL2Zyb20tc3RyaW5nJztcbmltcG9ydCB7IGNvbmZpZ0Zyb21BcnJheSB9IGZyb20gJy4vZnJvbS1hcnJheSc7XG5pbXBvcnQgeyBjb25maWdGcm9tT2JqZWN0IH0gZnJvbSAnLi9mcm9tLW9iamVjdCc7XG5cbmZ1bmN0aW9uIGNyZWF0ZUZyb21Db25maWcoY29uZmlnKSB7XG4gIHZhciByZXMgPSBuZXcgTW9tZW50KGNoZWNrT3ZlcmZsb3cocHJlcGFyZUNvbmZpZyhjb25maWcpKSk7XG5cbiAgaWYgKHJlcy5fbmV4dERheSkge1xuICAgIHJlcy5hZGQoMSwgJ2QnKTtcbiAgICByZXMuX25leHREYXkgPSB1bmRlZmluZWQ7XG4gIH1cblxuICByZXR1cm4gcmVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJlcGFyZUNvbmZpZyhjb25maWcpIHtcbiAgdmFyIGlucHV0ID0gY29uZmlnLl9pLFxuICAgICAgZm9ybWF0ID0gY29uZmlnLl9mO1xuICBjb25maWcuX2xvY2FsZSA9IGNvbmZpZy5fbG9jYWxlIHx8IGdldExvY2FsZShjb25maWcuX2wpO1xuXG4gIGlmIChpbnB1dCA9PT0gbnVsbCB8fCBmb3JtYXQgPT09IHVuZGVmaW5lZCAmJiBpbnB1dCA9PT0gJycpIHtcbiAgICByZXR1cm4gY3JlYXRlSW52YWxpZCh7XG4gICAgICBudWxsSW5wdXQ6IHRydWVcbiAgICB9KTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XG4gICAgY29uZmlnLl9pID0gaW5wdXQgPSBjb25maWcuX2xvY2FsZS5wcmVwYXJzZShpbnB1dCk7XG4gIH1cblxuICBpZiAoaXNNb21lbnQoaW5wdXQpKSB7XG4gICAgcmV0dXJuIG5ldyBNb21lbnQoY2hlY2tPdmVyZmxvdyhpbnB1dCkpO1xuICB9IGVsc2UgaWYgKGlzRGF0ZShpbnB1dCkpIHtcbiAgICBjb25maWcuX2QgPSBpbnB1dDtcbiAgfSBlbHNlIGlmIChpc0FycmF5KGZvcm1hdCkpIHtcbiAgICBjb25maWdGcm9tU3RyaW5nQW5kQXJyYXkoY29uZmlnKTtcbiAgfSBlbHNlIGlmIChmb3JtYXQpIHtcbiAgICBjb25maWdGcm9tU3RyaW5nQW5kRm9ybWF0KGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgY29uZmlnRnJvbUlucHV0KGNvbmZpZyk7XG4gIH1cblxuICBpZiAoIWlzVmFsaWQoY29uZmlnKSkge1xuICAgIGNvbmZpZy5fZCA9IG51bGw7XG4gIH1cblxuICByZXR1cm4gY29uZmlnO1xufVxuXG5mdW5jdGlvbiBjb25maWdGcm9tSW5wdXQoY29uZmlnKSB7XG4gIHZhciBpbnB1dCA9IGNvbmZpZy5faTtcblxuICBpZiAoaXNVbmRlZmluZWQoaW5wdXQpKSB7XG4gICAgY29uZmlnLl9kID0gbmV3IERhdGUoaG9va3Mubm93KCkpO1xuICB9IGVsc2UgaWYgKGlzRGF0ZShpbnB1dCkpIHtcbiAgICBjb25maWcuX2QgPSBuZXcgRGF0ZShpbnB1dC52YWx1ZU9mKCkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25maWdGcm9tU3RyaW5nKGNvbmZpZyk7XG4gIH0gZWxzZSBpZiAoaXNBcnJheShpbnB1dCkpIHtcbiAgICBjb25maWcuX2EgPSBtYXAoaW5wdXQuc2xpY2UoMCksIGZ1bmN0aW9uIChvYmopIHtcbiAgICAgIHJldHVybiBwYXJzZUludChvYmosIDEwKTtcbiAgICB9KTtcbiAgICBjb25maWdGcm9tQXJyYXkoY29uZmlnKTtcbiAgfSBlbHNlIGlmIChpc09iamVjdChpbnB1dCkpIHtcbiAgICBjb25maWdGcm9tT2JqZWN0KGNvbmZpZyk7XG4gIH0gZWxzZSBpZiAoaXNOdW1iZXIoaW5wdXQpKSB7XG4gICAgY29uZmlnLl9kID0gbmV3IERhdGUoaW5wdXQpO1xuICB9IGVsc2Uge1xuICAgIGhvb2tzLmNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrKGNvbmZpZyk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxvY2FsT3JVVEMoaW5wdXQsIGZvcm1hdCwgbG9jYWxlLCBzdHJpY3QsIGlzVVRDKSB7XG4gIHZhciBjID0ge307XG5cbiAgaWYgKGxvY2FsZSA9PT0gdHJ1ZSB8fCBsb2NhbGUgPT09IGZhbHNlKSB7XG4gICAgc3RyaWN0ID0gbG9jYWxlO1xuICAgIGxvY2FsZSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmIChpc09iamVjdChpbnB1dCkgJiYgaXNPYmplY3RFbXB0eShpbnB1dCkgfHwgaXNBcnJheShpbnB1dCkgJiYgaW5wdXQubGVuZ3RoID09PSAwKSB7XG4gICAgaW5wdXQgPSB1bmRlZmluZWQ7XG4gIH1cblxuICBjLl9pc0FNb21lbnRPYmplY3QgPSB0cnVlO1xuICBjLl91c2VVVEMgPSBjLl9pc1VUQyA9IGlzVVRDO1xuICBjLl9sID0gbG9jYWxlO1xuICBjLl9pID0gaW5wdXQ7XG4gIGMuX2YgPSBmb3JtYXQ7XG4gIGMuX3N0cmljdCA9IHN0cmljdDtcbiAgcmV0dXJuIGNyZWF0ZUZyb21Db25maWcoYyk7XG59IiwiaW1wb3J0IHsgaG9va3MgfSBmcm9tICcuLi91dGlscy9ob29rcyc7XG5pbXBvcnQgeyBjcmVhdGVEYXRlLCBjcmVhdGVVVENEYXRlIH0gZnJvbSAnLi9kYXRlLWZyb20tYXJyYXknO1xuaW1wb3J0IHsgZGF5c0luWWVhciB9IGZyb20gJy4uL3VuaXRzL3llYXInO1xuaW1wb3J0IHsgd2Vla09mWWVhciwgd2Vla3NJblllYXIsIGRheU9mWWVhckZyb21XZWVrcyB9IGZyb20gJy4uL3VuaXRzL3dlZWstY2FsZW5kYXItdXRpbHMnO1xuaW1wb3J0IHsgWUVBUiwgTU9OVEgsIERBVEUsIEhPVVIsIE1JTlVURSwgU0VDT05ELCBNSUxMSVNFQ09ORCB9IGZyb20gJy4uL3VuaXRzL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBjcmVhdGVMb2NhbCB9IGZyb20gJy4vbG9jYWwnO1xuaW1wb3J0IGRlZmF1bHRzIGZyb20gJy4uL3V0aWxzL2RlZmF1bHRzJztcbmltcG9ydCBnZXRQYXJzaW5nRmxhZ3MgZnJvbSAnLi9wYXJzaW5nLWZsYWdzJztcblxuZnVuY3Rpb24gY3VycmVudERhdGVBcnJheShjb25maWcpIHtcbiAgdmFyIG5vd1ZhbHVlID0gbmV3IERhdGUoaG9va3Mubm93KCkpO1xuXG4gIGlmIChjb25maWcuX3VzZVVUQykge1xuICAgIHJldHVybiBbbm93VmFsdWUuZ2V0VVRDRnVsbFllYXIoKSwgbm93VmFsdWUuZ2V0VVRDTW9udGgoKSwgbm93VmFsdWUuZ2V0VVRDRGF0ZSgpXTtcbiAgfVxuXG4gIHJldHVybiBbbm93VmFsdWUuZ2V0RnVsbFllYXIoKSwgbm93VmFsdWUuZ2V0TW9udGgoKSwgbm93VmFsdWUuZ2V0RGF0ZSgpXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbmZpZ0Zyb21BcnJheShjb25maWcpIHtcbiAgdmFyIGksXG4gICAgICBkYXRlLFxuICAgICAgaW5wdXQgPSBbXSxcbiAgICAgIGN1cnJlbnREYXRlLFxuICAgICAgZXhwZWN0ZWRXZWVrZGF5LFxuICAgICAgeWVhclRvVXNlO1xuXG4gIGlmIChjb25maWcuX2QpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjdXJyZW50RGF0ZSA9IGN1cnJlbnREYXRlQXJyYXkoY29uZmlnKTtcblxuICBpZiAoY29uZmlnLl93ICYmIGNvbmZpZy5fYVtEQVRFXSA9PSBudWxsICYmIGNvbmZpZy5fYVtNT05USF0gPT0gbnVsbCkge1xuICAgIGRheU9mWWVhckZyb21XZWVrSW5mbyhjb25maWcpO1xuICB9XG5cbiAgaWYgKGNvbmZpZy5fZGF5T2ZZZWFyICE9IG51bGwpIHtcbiAgICB5ZWFyVG9Vc2UgPSBkZWZhdWx0cyhjb25maWcuX2FbWUVBUl0sIGN1cnJlbnREYXRlW1lFQVJdKTtcblxuICAgIGlmIChjb25maWcuX2RheU9mWWVhciA+IGRheXNJblllYXIoeWVhclRvVXNlKSB8fCBjb25maWcuX2RheU9mWWVhciA9PT0gMCkge1xuICAgICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuX292ZXJmbG93RGF5T2ZZZWFyID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBkYXRlID0gY3JlYXRlVVRDRGF0ZSh5ZWFyVG9Vc2UsIDAsIGNvbmZpZy5fZGF5T2ZZZWFyKTtcbiAgICBjb25maWcuX2FbTU9OVEhdID0gZGF0ZS5nZXRVVENNb250aCgpO1xuICAgIGNvbmZpZy5fYVtEQVRFXSA9IGRhdGUuZ2V0VVRDRGF0ZSgpO1xuICB9XG5cbiAgZm9yIChpID0gMDsgaSA8IDMgJiYgY29uZmlnLl9hW2ldID09IG51bGw7ICsraSkge1xuICAgIGNvbmZpZy5fYVtpXSA9IGlucHV0W2ldID0gY3VycmVudERhdGVbaV07XG4gIH1cblxuICBmb3IgKDsgaSA8IDc7IGkrKykge1xuICAgIGNvbmZpZy5fYVtpXSA9IGlucHV0W2ldID0gY29uZmlnLl9hW2ldID09IG51bGwgPyBpID09PSAyID8gMSA6IDAgOiBjb25maWcuX2FbaV07XG4gIH1cblxuICBpZiAoY29uZmlnLl9hW0hPVVJdID09PSAyNCAmJiBjb25maWcuX2FbTUlOVVRFXSA9PT0gMCAmJiBjb25maWcuX2FbU0VDT05EXSA9PT0gMCAmJiBjb25maWcuX2FbTUlMTElTRUNPTkRdID09PSAwKSB7XG4gICAgY29uZmlnLl9uZXh0RGF5ID0gdHJ1ZTtcbiAgICBjb25maWcuX2FbSE9VUl0gPSAwO1xuICB9XG5cbiAgY29uZmlnLl9kID0gKGNvbmZpZy5fdXNlVVRDID8gY3JlYXRlVVRDRGF0ZSA6IGNyZWF0ZURhdGUpLmFwcGx5KG51bGwsIGlucHV0KTtcbiAgZXhwZWN0ZWRXZWVrZGF5ID0gY29uZmlnLl91c2VVVEMgPyBjb25maWcuX2QuZ2V0VVRDRGF5KCkgOiBjb25maWcuX2QuZ2V0RGF5KCk7XG5cbiAgaWYgKGNvbmZpZy5fdHptICE9IG51bGwpIHtcbiAgICBjb25maWcuX2Quc2V0VVRDTWludXRlcyhjb25maWcuX2QuZ2V0VVRDTWludXRlcygpIC0gY29uZmlnLl90em0pO1xuICB9XG5cbiAgaWYgKGNvbmZpZy5fbmV4dERheSkge1xuICAgIGNvbmZpZy5fYVtIT1VSXSA9IDI0O1xuICB9XG5cbiAgaWYgKGNvbmZpZy5fdyAmJiB0eXBlb2YgY29uZmlnLl93LmQgIT09ICd1bmRlZmluZWQnICYmIGNvbmZpZy5fdy5kICE9PSBleHBlY3RlZFdlZWtkYXkpIHtcbiAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS53ZWVrZGF5TWlzbWF0Y2ggPSB0cnVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGRheU9mWWVhckZyb21XZWVrSW5mbyhjb25maWcpIHtcbiAgdmFyIHcsIHdlZWtZZWFyLCB3ZWVrLCB3ZWVrZGF5LCBkb3csIGRveSwgdGVtcCwgd2Vla2RheU92ZXJmbG93O1xuICB3ID0gY29uZmlnLl93O1xuXG4gIGlmICh3LkdHICE9IG51bGwgfHwgdy5XICE9IG51bGwgfHwgdy5FICE9IG51bGwpIHtcbiAgICBkb3cgPSAxO1xuICAgIGRveSA9IDQ7XG4gICAgd2Vla1llYXIgPSBkZWZhdWx0cyh3LkdHLCBjb25maWcuX2FbWUVBUl0sIHdlZWtPZlllYXIoY3JlYXRlTG9jYWwoKSwgMSwgNCkueWVhcik7XG4gICAgd2VlayA9IGRlZmF1bHRzKHcuVywgMSk7XG4gICAgd2Vla2RheSA9IGRlZmF1bHRzKHcuRSwgMSk7XG5cbiAgICBpZiAod2Vla2RheSA8IDEgfHwgd2Vla2RheSA+IDcpIHtcbiAgICAgIHdlZWtkYXlPdmVyZmxvdyA9IHRydWU7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGRvdyA9IGNvbmZpZy5fbG9jYWxlLl93ZWVrLmRvdztcbiAgICBkb3kgPSBjb25maWcuX2xvY2FsZS5fd2Vlay5kb3k7XG4gICAgdmFyIGN1cldlZWsgPSB3ZWVrT2ZZZWFyKGNyZWF0ZUxvY2FsKCksIGRvdywgZG95KTtcbiAgICB3ZWVrWWVhciA9IGRlZmF1bHRzKHcuZ2csIGNvbmZpZy5fYVtZRUFSXSwgY3VyV2Vlay55ZWFyKTtcbiAgICB3ZWVrID0gZGVmYXVsdHMody53LCBjdXJXZWVrLndlZWspO1xuXG4gICAgaWYgKHcuZCAhPSBudWxsKSB7XG4gICAgICB3ZWVrZGF5ID0gdy5kO1xuXG4gICAgICBpZiAod2Vla2RheSA8IDAgfHwgd2Vla2RheSA+IDYpIHtcbiAgICAgICAgd2Vla2RheU92ZXJmbG93ID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHcuZSAhPSBudWxsKSB7XG4gICAgICB3ZWVrZGF5ID0gdy5lICsgZG93O1xuXG4gICAgICBpZiAody5lIDwgMCB8fCB3LmUgPiA2KSB7XG4gICAgICAgIHdlZWtkYXlPdmVyZmxvdyA9IHRydWU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHdlZWtkYXkgPSBkb3c7XG4gICAgfVxuICB9XG5cbiAgaWYgKHdlZWsgPCAxIHx8IHdlZWsgPiB3ZWVrc0luWWVhcih3ZWVrWWVhciwgZG93LCBkb3kpKSB7XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuX292ZXJmbG93V2Vla3MgPSB0cnVlO1xuICB9IGVsc2UgaWYgKHdlZWtkYXlPdmVyZmxvdyAhPSBudWxsKSB7XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuX292ZXJmbG93V2Vla2RheSA9IHRydWU7XG4gIH0gZWxzZSB7XG4gICAgdGVtcCA9IGRheU9mWWVhckZyb21XZWVrcyh3ZWVrWWVhciwgd2Vlaywgd2Vla2RheSwgZG93LCBkb3kpO1xuICAgIGNvbmZpZy5fYVtZRUFSXSA9IHRlbXAueWVhcjtcbiAgICBjb25maWcuX2RheU9mWWVhciA9IHRlbXAuZGF5T2ZZZWFyO1xuICB9XG59IiwiaW1wb3J0IHsgbm9ybWFsaXplT2JqZWN0VW5pdHMgfSBmcm9tICcuLi91bml0cy9hbGlhc2VzJztcbmltcG9ydCB7IGNvbmZpZ0Zyb21BcnJheSB9IGZyb20gJy4vZnJvbS1hcnJheSc7XG5pbXBvcnQgbWFwIGZyb20gJy4uL3V0aWxzL21hcCc7XG5leHBvcnQgZnVuY3Rpb24gY29uZmlnRnJvbU9iamVjdChjb25maWcpIHtcbiAgaWYgKGNvbmZpZy5fZCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBpID0gbm9ybWFsaXplT2JqZWN0VW5pdHMoY29uZmlnLl9pKTtcbiAgY29uZmlnLl9hID0gbWFwKFtpLnllYXIsIGkubW9udGgsIGkuZGF5IHx8IGkuZGF0ZSwgaS5ob3VyLCBpLm1pbnV0ZSwgaS5zZWNvbmQsIGkubWlsbGlzZWNvbmRdLCBmdW5jdGlvbiAob2JqKSB7XG4gICAgcmV0dXJuIG9iaiAmJiBwYXJzZUludChvYmosIDEwKTtcbiAgfSk7XG4gIGNvbmZpZ0Zyb21BcnJheShjb25maWcpO1xufSIsImltcG9ydCB7IGNvcHlDb25maWcgfSBmcm9tICcuLi9tb21lbnQvY29uc3RydWN0b3InO1xuaW1wb3J0IHsgY29uZmlnRnJvbVN0cmluZ0FuZEZvcm1hdCB9IGZyb20gJy4vZnJvbS1zdHJpbmctYW5kLWZvcm1hdCc7XG5pbXBvcnQgZ2V0UGFyc2luZ0ZsYWdzIGZyb20gJy4vcGFyc2luZy1mbGFncyc7XG5pbXBvcnQgeyBpc1ZhbGlkIH0gZnJvbSAnLi92YWxpZCc7XG5pbXBvcnQgZXh0ZW5kIGZyb20gJy4uL3V0aWxzL2V4dGVuZCc7XG5leHBvcnQgZnVuY3Rpb24gY29uZmlnRnJvbVN0cmluZ0FuZEFycmF5KGNvbmZpZykge1xuICB2YXIgdGVtcENvbmZpZywgYmVzdE1vbWVudCwgc2NvcmVUb0JlYXQsIGksIGN1cnJlbnRTY29yZTtcblxuICBpZiAoY29uZmlnLl9mLmxlbmd0aCA9PT0gMCkge1xuICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmludmFsaWRGb3JtYXQgPSB0cnVlO1xuICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKE5hTik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZm9yIChpID0gMDsgaSA8IGNvbmZpZy5fZi5sZW5ndGg7IGkrKykge1xuICAgIGN1cnJlbnRTY29yZSA9IDA7XG4gICAgdGVtcENvbmZpZyA9IGNvcHlDb25maWcoe30sIGNvbmZpZyk7XG5cbiAgICBpZiAoY29uZmlnLl91c2VVVEMgIT0gbnVsbCkge1xuICAgICAgdGVtcENvbmZpZy5fdXNlVVRDID0gY29uZmlnLl91c2VVVEM7XG4gICAgfVxuXG4gICAgdGVtcENvbmZpZy5fZiA9IGNvbmZpZy5fZltpXTtcbiAgICBjb25maWdGcm9tU3RyaW5nQW5kRm9ybWF0KHRlbXBDb25maWcpO1xuXG4gICAgaWYgKCFpc1ZhbGlkKHRlbXBDb25maWcpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjdXJyZW50U2NvcmUgKz0gZ2V0UGFyc2luZ0ZsYWdzKHRlbXBDb25maWcpLmNoYXJzTGVmdE92ZXI7XG4gICAgY3VycmVudFNjb3JlICs9IGdldFBhcnNpbmdGbGFncyh0ZW1wQ29uZmlnKS51bnVzZWRUb2tlbnMubGVuZ3RoICogMTA7XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKHRlbXBDb25maWcpLnNjb3JlID0gY3VycmVudFNjb3JlO1xuXG4gICAgaWYgKHNjb3JlVG9CZWF0ID09IG51bGwgfHwgY3VycmVudFNjb3JlIDwgc2NvcmVUb0JlYXQpIHtcbiAgICAgIHNjb3JlVG9CZWF0ID0gY3VycmVudFNjb3JlO1xuICAgICAgYmVzdE1vbWVudCA9IHRlbXBDb25maWc7XG4gICAgfVxuICB9XG5cbiAgZXh0ZW5kKGNvbmZpZywgYmVzdE1vbWVudCB8fCB0ZW1wQ29uZmlnKTtcbn0iLCJpbXBvcnQgeyBjb25maWdGcm9tSVNPLCBjb25maWdGcm9tUkZDMjgyMiB9IGZyb20gJy4vZnJvbS1zdHJpbmcnO1xuaW1wb3J0IHsgY29uZmlnRnJvbUFycmF5IH0gZnJvbSAnLi9mcm9tLWFycmF5JztcbmltcG9ydCB7IGdldFBhcnNlUmVnZXhGb3JUb2tlbiB9IGZyb20gJy4uL3BhcnNlL3JlZ2V4JztcbmltcG9ydCB7IGFkZFRpbWVUb0FycmF5RnJvbVRva2VuIH0gZnJvbSAnLi4vcGFyc2UvdG9rZW4nO1xuaW1wb3J0IHsgZXhwYW5kRm9ybWF0LCBmb3JtYXRUb2tlbkZ1bmN0aW9ucywgZm9ybWF0dGluZ1Rva2VucyB9IGZyb20gJy4uL2Zvcm1hdC9mb3JtYXQnO1xuaW1wb3J0IGNoZWNrT3ZlcmZsb3cgZnJvbSAnLi9jaGVjay1vdmVyZmxvdyc7XG5pbXBvcnQgeyBIT1VSIH0gZnJvbSAnLi4vdW5pdHMvY29uc3RhbnRzJztcbmltcG9ydCB7IGhvb2tzIH0gZnJvbSAnLi4vdXRpbHMvaG9va3MnO1xuaW1wb3J0IGdldFBhcnNpbmdGbGFncyBmcm9tICcuL3BhcnNpbmctZmxhZ3MnO1xuXG5ob29rcy5JU09fODYwMSA9IGZ1bmN0aW9uICgpIHt9O1xuXG5ob29rcy5SRkNfMjgyMiA9IGZ1bmN0aW9uICgpIHt9O1xuXG5leHBvcnQgZnVuY3Rpb24gY29uZmlnRnJvbVN0cmluZ0FuZEZvcm1hdChjb25maWcpIHtcbiAgaWYgKGNvbmZpZy5fZiA9PT0gaG9va3MuSVNPXzg2MDEpIHtcbiAgICBjb25maWdGcm9tSVNPKGNvbmZpZyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNvbmZpZy5fZiA9PT0gaG9va3MuUkZDXzI4MjIpIHtcbiAgICBjb25maWdGcm9tUkZDMjgyMihjb25maWcpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbmZpZy5fYSA9IFtdO1xuICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5lbXB0eSA9IHRydWU7XG4gIHZhciBzdHJpbmcgPSAnJyArIGNvbmZpZy5faSxcbiAgICAgIGksXG4gICAgICBwYXJzZWRJbnB1dCxcbiAgICAgIHRva2VucyxcbiAgICAgIHRva2VuLFxuICAgICAgc2tpcHBlZCxcbiAgICAgIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGgsXG4gICAgICB0b3RhbFBhcnNlZElucHV0TGVuZ3RoID0gMDtcbiAgdG9rZW5zID0gZXhwYW5kRm9ybWF0KGNvbmZpZy5fZiwgY29uZmlnLl9sb2NhbGUpLm1hdGNoKGZvcm1hdHRpbmdUb2tlbnMpIHx8IFtdO1xuXG4gIGZvciAoaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICB0b2tlbiA9IHRva2Vuc1tpXTtcbiAgICBwYXJzZWRJbnB1dCA9IChzdHJpbmcubWF0Y2goZ2V0UGFyc2VSZWdleEZvclRva2VuKHRva2VuLCBjb25maWcpKSB8fCBbXSlbMF07XG5cbiAgICBpZiAocGFyc2VkSW5wdXQpIHtcbiAgICAgIHNraXBwZWQgPSBzdHJpbmcuc3Vic3RyKDAsIHN0cmluZy5pbmRleE9mKHBhcnNlZElucHV0KSk7XG5cbiAgICAgIGlmIChza2lwcGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykudW51c2VkSW5wdXQucHVzaChza2lwcGVkKTtcbiAgICAgIH1cblxuICAgICAgc3RyaW5nID0gc3RyaW5nLnNsaWNlKHN0cmluZy5pbmRleE9mKHBhcnNlZElucHV0KSArIHBhcnNlZElucHV0Lmxlbmd0aCk7XG4gICAgICB0b3RhbFBhcnNlZElucHV0TGVuZ3RoICs9IHBhcnNlZElucHV0Lmxlbmd0aDtcbiAgICB9XG5cbiAgICBpZiAoZm9ybWF0VG9rZW5GdW5jdGlvbnNbdG9rZW5dKSB7XG4gICAgICBpZiAocGFyc2VkSW5wdXQpIHtcbiAgICAgICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuZW1wdHkgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLnVudXNlZFRva2Vucy5wdXNoKHRva2VuKTtcbiAgICAgIH1cblxuICAgICAgYWRkVGltZVRvQXJyYXlGcm9tVG9rZW4odG9rZW4sIHBhcnNlZElucHV0LCBjb25maWcpO1xuICAgIH0gZWxzZSBpZiAoY29uZmlnLl9zdHJpY3QgJiYgIXBhcnNlZElucHV0KSB7XG4gICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS51bnVzZWRUb2tlbnMucHVzaCh0b2tlbik7XG4gICAgfVxuICB9XG5cbiAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuY2hhcnNMZWZ0T3ZlciA9IHN0cmluZ0xlbmd0aCAtIHRvdGFsUGFyc2VkSW5wdXRMZW5ndGg7XG5cbiAgaWYgKHN0cmluZy5sZW5ndGggPiAwKSB7XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykudW51c2VkSW5wdXQucHVzaChzdHJpbmcpO1xuICB9XG5cbiAgaWYgKGNvbmZpZy5fYVtIT1VSXSA8PSAxMiAmJiBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5iaWdIb3VyID09PSB0cnVlICYmIGNvbmZpZy5fYVtIT1VSXSA+IDApIHtcbiAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5iaWdIb3VyID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykucGFyc2VkRGF0ZVBhcnRzID0gY29uZmlnLl9hLnNsaWNlKDApO1xuICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5tZXJpZGllbSA9IGNvbmZpZy5fbWVyaWRpZW07XG4gIGNvbmZpZy5fYVtIT1VSXSA9IG1lcmlkaWVtRml4V3JhcChjb25maWcuX2xvY2FsZSwgY29uZmlnLl9hW0hPVVJdLCBjb25maWcuX21lcmlkaWVtKTtcbiAgY29uZmlnRnJvbUFycmF5KGNvbmZpZyk7XG4gIGNoZWNrT3ZlcmZsb3coY29uZmlnKTtcbn1cblxuZnVuY3Rpb24gbWVyaWRpZW1GaXhXcmFwKGxvY2FsZSwgaG91ciwgbWVyaWRpZW0pIHtcbiAgdmFyIGlzUG07XG5cbiAgaWYgKG1lcmlkaWVtID09IG51bGwpIHtcbiAgICByZXR1cm4gaG91cjtcbiAgfVxuXG4gIGlmIChsb2NhbGUubWVyaWRpZW1Ib3VyICE9IG51bGwpIHtcbiAgICByZXR1cm4gbG9jYWxlLm1lcmlkaWVtSG91cihob3VyLCBtZXJpZGllbSk7XG4gIH0gZWxzZSBpZiAobG9jYWxlLmlzUE0gIT0gbnVsbCkge1xuICAgIGlzUG0gPSBsb2NhbGUuaXNQTShtZXJpZGllbSk7XG5cbiAgICBpZiAoaXNQbSAmJiBob3VyIDwgMTIpIHtcbiAgICAgIGhvdXIgKz0gMTI7XG4gICAgfVxuXG4gICAgaWYgKCFpc1BtICYmIGhvdXIgPT09IDEyKSB7XG4gICAgICBob3VyID0gMDtcbiAgICB9XG5cbiAgICByZXR1cm4gaG91cjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gaG91cjtcbiAgfVxufSIsImltcG9ydCB7IGNvbmZpZ0Zyb21TdHJpbmdBbmRGb3JtYXQgfSBmcm9tICcuL2Zyb20tc3RyaW5nLWFuZC1mb3JtYXQnO1xuaW1wb3J0IHsgY3JlYXRlVVRDRGF0ZSB9IGZyb20gJy4vZGF0ZS1mcm9tLWFycmF5JztcbmltcG9ydCB7IGNvbmZpZ0Zyb21BcnJheSB9IGZyb20gJy4vZnJvbS1hcnJheSc7XG5pbXBvcnQgeyBob29rcyB9IGZyb20gJy4uL3V0aWxzL2hvb2tzJztcbmltcG9ydCB7IGRlcHJlY2F0ZSB9IGZyb20gJy4uL3V0aWxzL2RlcHJlY2F0ZSc7XG5pbXBvcnQgZ2V0UGFyc2luZ0ZsYWdzIGZyb20gJy4vcGFyc2luZy1mbGFncyc7XG5pbXBvcnQgeyBkZWZhdWx0TG9jYWxlTW9udGhzU2hvcnQgfSBmcm9tICcuLi91bml0cy9tb250aCc7XG5pbXBvcnQgeyBkZWZhdWx0TG9jYWxlV2Vla2RheXNTaG9ydCB9IGZyb20gJy4uL3VuaXRzL2RheS1vZi13ZWVrJztcbnZhciBleHRlbmRlZElzb1JlZ2V4ID0gL15cXHMqKCg/OlsrLV1cXGR7Nn18XFxkezR9KS0oPzpcXGRcXGQtXFxkXFxkfFdcXGRcXGQtXFxkfFdcXGRcXGR8XFxkXFxkXFxkfFxcZFxcZCkpKD86KFR8ICkoXFxkXFxkKD86OlxcZFxcZCg/OjpcXGRcXGQoPzpbLixdXFxkKyk/KT8pPykoW1xcK1xcLV1cXGRcXGQoPzo6P1xcZFxcZCk/fFxccypaKT8pPyQvO1xudmFyIGJhc2ljSXNvUmVnZXggPSAvXlxccyooKD86WystXVxcZHs2fXxcXGR7NH0pKD86XFxkXFxkXFxkXFxkfFdcXGRcXGRcXGR8V1xcZFxcZHxcXGRcXGRcXGR8XFxkXFxkKSkoPzooVHwgKShcXGRcXGQoPzpcXGRcXGQoPzpcXGRcXGQoPzpbLixdXFxkKyk/KT8pPykoW1xcK1xcLV1cXGRcXGQoPzo6P1xcZFxcZCk/fFxccypaKT8pPyQvO1xudmFyIHR6UmVnZXggPSAvWnxbKy1dXFxkXFxkKD86Oj9cXGRcXGQpPy87XG52YXIgaXNvRGF0ZXMgPSBbWydZWVlZWVktTU0tREQnLCAvWystXVxcZHs2fS1cXGRcXGQtXFxkXFxkL10sIFsnWVlZWS1NTS1ERCcsIC9cXGR7NH0tXFxkXFxkLVxcZFxcZC9dLCBbJ0dHR0ctW1ddV1ctRScsIC9cXGR7NH0tV1xcZFxcZC1cXGQvXSwgWydHR0dHLVtXXVdXJywgL1xcZHs0fS1XXFxkXFxkLywgZmFsc2VdLCBbJ1lZWVktREREJywgL1xcZHs0fS1cXGR7M30vXSwgWydZWVlZLU1NJywgL1xcZHs0fS1cXGRcXGQvLCBmYWxzZV0sIFsnWVlZWVlZTU1ERCcsIC9bKy1dXFxkezEwfS9dLCBbJ1lZWVlNTUREJywgL1xcZHs4fS9dLCBbJ0dHR0dbV11XV0UnLCAvXFxkezR9V1xcZHszfS9dLCBbJ0dHR0dbV11XVycsIC9cXGR7NH1XXFxkezJ9LywgZmFsc2VdLCBbJ1lZWVlEREQnLCAvXFxkezd9L11dO1xudmFyIGlzb1RpbWVzID0gW1snSEg6bW06c3MuU1NTUycsIC9cXGRcXGQ6XFxkXFxkOlxcZFxcZFxcLlxcZCsvXSwgWydISDptbTpzcyxTU1NTJywgL1xcZFxcZDpcXGRcXGQ6XFxkXFxkLFxcZCsvXSwgWydISDptbTpzcycsIC9cXGRcXGQ6XFxkXFxkOlxcZFxcZC9dLCBbJ0hIOm1tJywgL1xcZFxcZDpcXGRcXGQvXSwgWydISG1tc3MuU1NTUycsIC9cXGRcXGRcXGRcXGRcXGRcXGRcXC5cXGQrL10sIFsnSEhtbXNzLFNTU1MnLCAvXFxkXFxkXFxkXFxkXFxkXFxkLFxcZCsvXSwgWydISG1tc3MnLCAvXFxkXFxkXFxkXFxkXFxkXFxkL10sIFsnSEhtbScsIC9cXGRcXGRcXGRcXGQvXSwgWydISCcsIC9cXGRcXGQvXV07XG52YXIgYXNwTmV0SnNvblJlZ2V4ID0gL15cXC8/RGF0ZVxcKChcXC0/XFxkKykvaTtcbmV4cG9ydCBmdW5jdGlvbiBjb25maWdGcm9tSVNPKGNvbmZpZykge1xuICB2YXIgaSxcbiAgICAgIGwsXG4gICAgICBzdHJpbmcgPSBjb25maWcuX2ksXG4gICAgICBtYXRjaCA9IGV4dGVuZGVkSXNvUmVnZXguZXhlYyhzdHJpbmcpIHx8IGJhc2ljSXNvUmVnZXguZXhlYyhzdHJpbmcpLFxuICAgICAgYWxsb3dUaW1lLFxuICAgICAgZGF0ZUZvcm1hdCxcbiAgICAgIHRpbWVGb3JtYXQsXG4gICAgICB0ekZvcm1hdDtcblxuICBpZiAobWF0Y2gpIHtcbiAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5pc28gPSB0cnVlO1xuXG4gICAgZm9yIChpID0gMCwgbCA9IGlzb0RhdGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgaWYgKGlzb0RhdGVzW2ldWzFdLmV4ZWMobWF0Y2hbMV0pKSB7XG4gICAgICAgIGRhdGVGb3JtYXQgPSBpc29EYXRlc1tpXVswXTtcbiAgICAgICAgYWxsb3dUaW1lID0gaXNvRGF0ZXNbaV1bMl0gIT09IGZhbHNlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZGF0ZUZvcm1hdCA9PSBudWxsKSB7XG4gICAgICBjb25maWcuX2lzVmFsaWQgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobWF0Y2hbM10pIHtcbiAgICAgIGZvciAoaSA9IDAsIGwgPSBpc29UaW1lcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGlzb1RpbWVzW2ldWzFdLmV4ZWMobWF0Y2hbM10pKSB7XG4gICAgICAgICAgdGltZUZvcm1hdCA9IChtYXRjaFsyXSB8fCAnICcpICsgaXNvVGltZXNbaV1bMF07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHRpbWVGb3JtYXQgPT0gbnVsbCkge1xuICAgICAgICBjb25maWcuX2lzVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghYWxsb3dUaW1lICYmIHRpbWVGb3JtYXQgIT0gbnVsbCkge1xuICAgICAgY29uZmlnLl9pc1ZhbGlkID0gZmFsc2U7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG1hdGNoWzRdKSB7XG4gICAgICBpZiAodHpSZWdleC5leGVjKG1hdGNoWzRdKSkge1xuICAgICAgICB0ekZvcm1hdCA9ICdaJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbmZpZy5faXNWYWxpZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uZmlnLl9mID0gZGF0ZUZvcm1hdCArICh0aW1lRm9ybWF0IHx8ICcnKSArICh0ekZvcm1hdCB8fCAnJyk7XG4gICAgY29uZmlnRnJvbVN0cmluZ0FuZEZvcm1hdChjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGNvbmZpZy5faXNWYWxpZCA9IGZhbHNlO1xuICB9XG59XG52YXIgcmZjMjgyMiA9IC9eKD86KE1vbnxUdWV8V2VkfFRodXxGcml8U2F0fFN1biksP1xccyk/KFxcZHsxLDJ9KVxccyhKYW58RmVifE1hcnxBcHJ8TWF5fEp1bnxKdWx8QXVnfFNlcHxPY3R8Tm92fERlYylcXHMoXFxkezIsNH0pXFxzKFxcZFxcZCk6KFxcZFxcZCkoPzo6KFxcZFxcZCkpP1xccyg/OihVVHxHTVR8W0VDTVBdW1NEXVQpfChbWnpdKXwoWystXVxcZHs0fSkpJC87XG5cbmZ1bmN0aW9uIGV4dHJhY3RGcm9tUkZDMjgyMlN0cmluZ3MoeWVhclN0ciwgbW9udGhTdHIsIGRheVN0ciwgaG91clN0ciwgbWludXRlU3RyLCBzZWNvbmRTdHIpIHtcbiAgdmFyIHJlc3VsdCA9IFt1bnRydW5jYXRlWWVhcih5ZWFyU3RyKSwgZGVmYXVsdExvY2FsZU1vbnRoc1Nob3J0LmluZGV4T2YobW9udGhTdHIpLCBwYXJzZUludChkYXlTdHIsIDEwKSwgcGFyc2VJbnQoaG91clN0ciwgMTApLCBwYXJzZUludChtaW51dGVTdHIsIDEwKV07XG5cbiAgaWYgKHNlY29uZFN0cikge1xuICAgIHJlc3VsdC5wdXNoKHBhcnNlSW50KHNlY29uZFN0ciwgMTApKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIHVudHJ1bmNhdGVZZWFyKHllYXJTdHIpIHtcbiAgdmFyIHllYXIgPSBwYXJzZUludCh5ZWFyU3RyLCAxMCk7XG5cbiAgaWYgKHllYXIgPD0gNDkpIHtcbiAgICByZXR1cm4gMjAwMCArIHllYXI7XG4gIH0gZWxzZSBpZiAoeWVhciA8PSA5OTkpIHtcbiAgICByZXR1cm4gMTkwMCArIHllYXI7XG4gIH1cblxuICByZXR1cm4geWVhcjtcbn1cblxuZnVuY3Rpb24gcHJlcHJvY2Vzc1JGQzI4MjIocykge1xuICByZXR1cm4gcy5yZXBsYWNlKC9cXChbXildKlxcKXxbXFxuXFx0XS9nLCAnICcpLnJlcGxhY2UoLyhcXHNcXHMrKS9nLCAnICcpLnJlcGxhY2UoL15cXHNcXHMqLywgJycpLnJlcGxhY2UoL1xcc1xccyokLywgJycpO1xufVxuXG5mdW5jdGlvbiBjaGVja1dlZWtkYXkod2Vla2RheVN0ciwgcGFyc2VkSW5wdXQsIGNvbmZpZykge1xuICBpZiAod2Vla2RheVN0cikge1xuICAgIHZhciB3ZWVrZGF5UHJvdmlkZWQgPSBkZWZhdWx0TG9jYWxlV2Vla2RheXNTaG9ydC5pbmRleE9mKHdlZWtkYXlTdHIpLFxuICAgICAgICB3ZWVrZGF5QWN0dWFsID0gbmV3IERhdGUocGFyc2VkSW5wdXRbMF0sIHBhcnNlZElucHV0WzFdLCBwYXJzZWRJbnB1dFsyXSkuZ2V0RGF5KCk7XG5cbiAgICBpZiAod2Vla2RheVByb3ZpZGVkICE9PSB3ZWVrZGF5QWN0dWFsKSB7XG4gICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS53ZWVrZGF5TWlzbWF0Y2ggPSB0cnVlO1xuICAgICAgY29uZmlnLl9pc1ZhbGlkID0gZmFsc2U7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG5cbnZhciBvYnNPZmZzZXRzID0ge1xuICBVVDogMCxcbiAgR01UOiAwLFxuICBFRFQ6IC00ICogNjAsXG4gIEVTVDogLTUgKiA2MCxcbiAgQ0RUOiAtNSAqIDYwLFxuICBDU1Q6IC02ICogNjAsXG4gIE1EVDogLTYgKiA2MCxcbiAgTVNUOiAtNyAqIDYwLFxuICBQRFQ6IC03ICogNjAsXG4gIFBTVDogLTggKiA2MFxufTtcblxuZnVuY3Rpb24gY2FsY3VsYXRlT2Zmc2V0KG9ic09mZnNldCwgbWlsaXRhcnlPZmZzZXQsIG51bU9mZnNldCkge1xuICBpZiAob2JzT2Zmc2V0KSB7XG4gICAgcmV0dXJuIG9ic09mZnNldHNbb2JzT2Zmc2V0XTtcbiAgfSBlbHNlIGlmIChtaWxpdGFyeU9mZnNldCkge1xuICAgIHJldHVybiAwO1xuICB9IGVsc2Uge1xuICAgIHZhciBobSA9IHBhcnNlSW50KG51bU9mZnNldCwgMTApO1xuICAgIHZhciBtID0gaG0gJSAxMDAsXG4gICAgICAgIGggPSAoaG0gLSBtKSAvIDEwMDtcbiAgICByZXR1cm4gaCAqIDYwICsgbTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY29uZmlnRnJvbVJGQzI4MjIoY29uZmlnKSB7XG4gIHZhciBtYXRjaCA9IHJmYzI4MjIuZXhlYyhwcmVwcm9jZXNzUkZDMjgyMihjb25maWcuX2kpKTtcblxuICBpZiAobWF0Y2gpIHtcbiAgICB2YXIgcGFyc2VkQXJyYXkgPSBleHRyYWN0RnJvbVJGQzI4MjJTdHJpbmdzKG1hdGNoWzRdLCBtYXRjaFszXSwgbWF0Y2hbMl0sIG1hdGNoWzVdLCBtYXRjaFs2XSwgbWF0Y2hbN10pO1xuXG4gICAgaWYgKCFjaGVja1dlZWtkYXkobWF0Y2hbMV0sIHBhcnNlZEFycmF5LCBjb25maWcpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uZmlnLl9hID0gcGFyc2VkQXJyYXk7XG4gICAgY29uZmlnLl90em0gPSBjYWxjdWxhdGVPZmZzZXQobWF0Y2hbOF0sIG1hdGNoWzldLCBtYXRjaFsxMF0pO1xuICAgIGNvbmZpZy5fZCA9IGNyZWF0ZVVUQ0RhdGUuYXBwbHkobnVsbCwgY29uZmlnLl9hKTtcblxuICAgIGNvbmZpZy5fZC5zZXRVVENNaW51dGVzKGNvbmZpZy5fZC5nZXRVVENNaW51dGVzKCkgLSBjb25maWcuX3R6bSk7XG5cbiAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5yZmMyODIyID0gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICBjb25maWcuX2lzVmFsaWQgPSBmYWxzZTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGNvbmZpZ0Zyb21TdHJpbmcoY29uZmlnKSB7XG4gIHZhciBtYXRjaGVkID0gYXNwTmV0SnNvblJlZ2V4LmV4ZWMoY29uZmlnLl9pKTtcblxuICBpZiAobWF0Y2hlZCAhPT0gbnVsbCkge1xuICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKCttYXRjaGVkWzFdKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25maWdGcm9tSVNPKGNvbmZpZyk7XG5cbiAgaWYgKGNvbmZpZy5faXNWYWxpZCA9PT0gZmFsc2UpIHtcbiAgICBkZWxldGUgY29uZmlnLl9pc1ZhbGlkO1xuICB9IGVsc2Uge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbmZpZ0Zyb21SRkMyODIyKGNvbmZpZyk7XG5cbiAgaWYgKGNvbmZpZy5faXNWYWxpZCA9PT0gZmFsc2UpIHtcbiAgICBkZWxldGUgY29uZmlnLl9pc1ZhbGlkO1xuICB9IGVsc2Uge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGhvb2tzLmNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrKGNvbmZpZyk7XG59XG5ob29rcy5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayA9IGRlcHJlY2F0ZSgndmFsdWUgcHJvdmlkZWQgaXMgbm90IGluIGEgcmVjb2duaXplZCBSRkMyODIyIG9yIElTTyBmb3JtYXQuIG1vbWVudCBjb25zdHJ1Y3Rpb24gZmFsbHMgYmFjayB0byBqcyBEYXRlKCksICcgKyAnd2hpY2ggaXMgbm90IHJlbGlhYmxlIGFjcm9zcyBhbGwgYnJvd3NlcnMgYW5kIHZlcnNpb25zLiBOb24gUkZDMjgyMi9JU08gZGF0ZSBmb3JtYXRzIGFyZSAnICsgJ2Rpc2NvdXJhZ2VkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gYW4gdXBjb21pbmcgbWFqb3IgcmVsZWFzZS4gUGxlYXNlIHJlZmVyIHRvICcgKyAnaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9qcy1kYXRlLyBmb3IgbW9yZSBpbmZvLicsIGZ1bmN0aW9uIChjb25maWcpIHtcbiAgY29uZmlnLl9kID0gbmV3IERhdGUoY29uZmlnLl9pICsgKGNvbmZpZy5fdXNlVVRDID8gJyBVVEMnIDogJycpKTtcbn0pOyIsImltcG9ydCB7IGNyZWF0ZUxvY2FsT3JVVEMgfSBmcm9tICcuL2Zyb20tYW55dGhpbmcnO1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxvY2FsKGlucHV0LCBmb3JtYXQsIGxvY2FsZSwgc3RyaWN0KSB7XG4gIHJldHVybiBjcmVhdGVMb2NhbE9yVVRDKGlucHV0LCBmb3JtYXQsIGxvY2FsZSwgc3RyaWN0LCBmYWxzZSk7XG59IiwiZnVuY3Rpb24gZGVmYXVsdFBhcnNpbmdGbGFncygpIHtcbiAgcmV0dXJuIHtcbiAgICBlbXB0eTogZmFsc2UsXG4gICAgdW51c2VkVG9rZW5zOiBbXSxcbiAgICB1bnVzZWRJbnB1dDogW10sXG4gICAgb3ZlcmZsb3c6IC0yLFxuICAgIGNoYXJzTGVmdE92ZXI6IDAsXG4gICAgbnVsbElucHV0OiBmYWxzZSxcbiAgICBpbnZhbGlkTW9udGg6IG51bGwsXG4gICAgaW52YWxpZEZvcm1hdDogZmFsc2UsXG4gICAgdXNlckludmFsaWRhdGVkOiBmYWxzZSxcbiAgICBpc286IGZhbHNlLFxuICAgIHBhcnNlZERhdGVQYXJ0czogW10sXG4gICAgbWVyaWRpZW06IG51bGwsXG4gICAgcmZjMjgyMjogZmFsc2UsXG4gICAgd2Vla2RheU1pc21hdGNoOiBmYWxzZVxuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRQYXJzaW5nRmxhZ3MobSkge1xuICBpZiAobS5fcGYgPT0gbnVsbCkge1xuICAgIG0uX3BmID0gZGVmYXVsdFBhcnNpbmdGbGFncygpO1xuICB9XG5cbiAgcmV0dXJuIG0uX3BmO1xufSIsImltcG9ydCB7IGNyZWF0ZUxvY2FsT3JVVEMgfSBmcm9tICcuL2Zyb20tYW55dGhpbmcnO1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVUQyhpbnB1dCwgZm9ybWF0LCBsb2NhbGUsIHN0cmljdCkge1xuICByZXR1cm4gY3JlYXRlTG9jYWxPclVUQyhpbnB1dCwgZm9ybWF0LCBsb2NhbGUsIHN0cmljdCwgdHJ1ZSkudXRjKCk7XG59IiwiaW1wb3J0IGV4dGVuZCBmcm9tICcuLi91dGlscy9leHRlbmQnO1xuaW1wb3J0IHsgY3JlYXRlVVRDIH0gZnJvbSAnLi91dGMnO1xuaW1wb3J0IGdldFBhcnNpbmdGbGFncyBmcm9tICcuLi9jcmVhdGUvcGFyc2luZy1mbGFncyc7XG5pbXBvcnQgc29tZSBmcm9tICcuLi91dGlscy9zb21lJztcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkKG0pIHtcbiAgaWYgKG0uX2lzVmFsaWQgPT0gbnVsbCkge1xuICAgIHZhciBmbGFncyA9IGdldFBhcnNpbmdGbGFncyhtKTtcbiAgICB2YXIgcGFyc2VkUGFydHMgPSBzb21lLmNhbGwoZmxhZ3MucGFyc2VkRGF0ZVBhcnRzLCBmdW5jdGlvbiAoaSkge1xuICAgICAgcmV0dXJuIGkgIT0gbnVsbDtcbiAgICB9KTtcbiAgICB2YXIgaXNOb3dWYWxpZCA9ICFpc05hTihtLl9kLmdldFRpbWUoKSkgJiYgZmxhZ3Mub3ZlcmZsb3cgPCAwICYmICFmbGFncy5lbXB0eSAmJiAhZmxhZ3MuaW52YWxpZE1vbnRoICYmICFmbGFncy5pbnZhbGlkV2Vla2RheSAmJiAhZmxhZ3Mud2Vla2RheU1pc21hdGNoICYmICFmbGFncy5udWxsSW5wdXQgJiYgIWZsYWdzLmludmFsaWRGb3JtYXQgJiYgIWZsYWdzLnVzZXJJbnZhbGlkYXRlZCAmJiAoIWZsYWdzLm1lcmlkaWVtIHx8IGZsYWdzLm1lcmlkaWVtICYmIHBhcnNlZFBhcnRzKTtcblxuICAgIGlmIChtLl9zdHJpY3QpIHtcbiAgICAgIGlzTm93VmFsaWQgPSBpc05vd1ZhbGlkICYmIGZsYWdzLmNoYXJzTGVmdE92ZXIgPT09IDAgJiYgZmxhZ3MudW51c2VkVG9rZW5zLmxlbmd0aCA9PT0gMCAmJiBmbGFncy5iaWdIb3VyID09PSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgaWYgKE9iamVjdC5pc0Zyb3plbiA9PSBudWxsIHx8ICFPYmplY3QuaXNGcm96ZW4obSkpIHtcbiAgICAgIG0uX2lzVmFsaWQgPSBpc05vd1ZhbGlkO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaXNOb3dWYWxpZDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbS5faXNWYWxpZDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbnZhbGlkKGZsYWdzKSB7XG4gIHZhciBtID0gY3JlYXRlVVRDKE5hTik7XG5cbiAgaWYgKGZsYWdzICE9IG51bGwpIHtcbiAgICBleHRlbmQoZ2V0UGFyc2luZ0ZsYWdzKG0pLCBmbGFncyk7XG4gIH0gZWxzZSB7XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKG0pLnVzZXJJbnZhbGlkYXRlZCA9IHRydWU7XG4gIH1cblxuICByZXR1cm4gbTtcbn0iLCJ2YXIgbWF0aEFicyA9IE1hdGguYWJzO1xuZXhwb3J0IGZ1bmN0aW9uIGFicygpIHtcbiAgdmFyIGRhdGEgPSB0aGlzLl9kYXRhO1xuICB0aGlzLl9taWxsaXNlY29uZHMgPSBtYXRoQWJzKHRoaXMuX21pbGxpc2Vjb25kcyk7XG4gIHRoaXMuX2RheXMgPSBtYXRoQWJzKHRoaXMuX2RheXMpO1xuICB0aGlzLl9tb250aHMgPSBtYXRoQWJzKHRoaXMuX21vbnRocyk7XG4gIGRhdGEubWlsbGlzZWNvbmRzID0gbWF0aEFicyhkYXRhLm1pbGxpc2Vjb25kcyk7XG4gIGRhdGEuc2Vjb25kcyA9IG1hdGhBYnMoZGF0YS5zZWNvbmRzKTtcbiAgZGF0YS5taW51dGVzID0gbWF0aEFicyhkYXRhLm1pbnV0ZXMpO1xuICBkYXRhLmhvdXJzID0gbWF0aEFicyhkYXRhLmhvdXJzKTtcbiAgZGF0YS5tb250aHMgPSBtYXRoQWJzKGRhdGEubW9udGhzKTtcbiAgZGF0YS55ZWFycyA9IG1hdGhBYnMoZGF0YS55ZWFycyk7XG4gIHJldHVybiB0aGlzO1xufSIsImltcG9ydCB7IGNyZWF0ZUR1cmF0aW9uIH0gZnJvbSAnLi9jcmVhdGUnO1xuXG5mdW5jdGlvbiBhZGRTdWJ0cmFjdChkdXJhdGlvbiwgaW5wdXQsIHZhbHVlLCBkaXJlY3Rpb24pIHtcbiAgdmFyIG90aGVyID0gY3JlYXRlRHVyYXRpb24oaW5wdXQsIHZhbHVlKTtcbiAgZHVyYXRpb24uX21pbGxpc2Vjb25kcyArPSBkaXJlY3Rpb24gKiBvdGhlci5fbWlsbGlzZWNvbmRzO1xuICBkdXJhdGlvbi5fZGF5cyArPSBkaXJlY3Rpb24gKiBvdGhlci5fZGF5cztcbiAgZHVyYXRpb24uX21vbnRocyArPSBkaXJlY3Rpb24gKiBvdGhlci5fbW9udGhzO1xuICByZXR1cm4gZHVyYXRpb24uX2J1YmJsZSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkKGlucHV0LCB2YWx1ZSkge1xuICByZXR1cm4gYWRkU3VidHJhY3QodGhpcywgaW5wdXQsIHZhbHVlLCAxKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzdWJ0cmFjdChpbnB1dCwgdmFsdWUpIHtcbiAgcmV0dXJuIGFkZFN1YnRyYWN0KHRoaXMsIGlucHV0LCB2YWx1ZSwgLTEpO1xufSIsImltcG9ydCB7IGRheXNUb01vbnRocywgbW9udGhzVG9EYXlzIH0gZnJvbSAnLi9idWJibGUnO1xuaW1wb3J0IHsgbm9ybWFsaXplVW5pdHMgfSBmcm9tICcuLi91bml0cy9hbGlhc2VzJztcbmltcG9ydCB0b0ludCBmcm9tICcuLi91dGlscy90by1pbnQnO1xuZXhwb3J0IGZ1bmN0aW9uIGFzKHVuaXRzKSB7XG4gIGlmICghdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICByZXR1cm4gTmFOO1xuICB9XG5cbiAgdmFyIGRheXM7XG4gIHZhciBtb250aHM7XG4gIHZhciBtaWxsaXNlY29uZHMgPSB0aGlzLl9taWxsaXNlY29uZHM7XG4gIHVuaXRzID0gbm9ybWFsaXplVW5pdHModW5pdHMpO1xuXG4gIGlmICh1bml0cyA9PT0gJ21vbnRoJyB8fCB1bml0cyA9PT0gJ3F1YXJ0ZXInIHx8IHVuaXRzID09PSAneWVhcicpIHtcbiAgICBkYXlzID0gdGhpcy5fZGF5cyArIG1pbGxpc2Vjb25kcyAvIDg2NGU1O1xuICAgIG1vbnRocyA9IHRoaXMuX21vbnRocyArIGRheXNUb01vbnRocyhkYXlzKTtcblxuICAgIHN3aXRjaCAodW5pdHMpIHtcbiAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgcmV0dXJuIG1vbnRocztcblxuICAgICAgY2FzZSAncXVhcnRlcic6XG4gICAgICAgIHJldHVybiBtb250aHMgLyAzO1xuXG4gICAgICBjYXNlICd5ZWFyJzpcbiAgICAgICAgcmV0dXJuIG1vbnRocyAvIDEyO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBkYXlzID0gdGhpcy5fZGF5cyArIE1hdGgucm91bmQobW9udGhzVG9EYXlzKHRoaXMuX21vbnRocykpO1xuXG4gICAgc3dpdGNoICh1bml0cykge1xuICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgIHJldHVybiBkYXlzIC8gNyArIG1pbGxpc2Vjb25kcyAvIDYwNDhlNTtcblxuICAgICAgY2FzZSAnZGF5JzpcbiAgICAgICAgcmV0dXJuIGRheXMgKyBtaWxsaXNlY29uZHMgLyA4NjRlNTtcblxuICAgICAgY2FzZSAnaG91cic6XG4gICAgICAgIHJldHVybiBkYXlzICogMjQgKyBtaWxsaXNlY29uZHMgLyAzNmU1O1xuXG4gICAgICBjYXNlICdtaW51dGUnOlxuICAgICAgICByZXR1cm4gZGF5cyAqIDE0NDAgKyBtaWxsaXNlY29uZHMgLyA2ZTQ7XG5cbiAgICAgIGNhc2UgJ3NlY29uZCc6XG4gICAgICAgIHJldHVybiBkYXlzICogODY0MDAgKyBtaWxsaXNlY29uZHMgLyAxMDAwO1xuXG4gICAgICBjYXNlICdtaWxsaXNlY29uZCc6XG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKGRheXMgKiA4NjRlNSkgKyBtaWxsaXNlY29uZHM7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biB1bml0ICcgKyB1bml0cyk7XG4gICAgfVxuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gdmFsdWVPZigpIHtcbiAgaWYgKCF0aGlzLmlzVmFsaWQoKSkge1xuICAgIHJldHVybiBOYU47XG4gIH1cblxuICByZXR1cm4gdGhpcy5fbWlsbGlzZWNvbmRzICsgdGhpcy5fZGF5cyAqIDg2NGU1ICsgdGhpcy5fbW9udGhzICUgMTIgKiAyNTkyZTYgKyB0b0ludCh0aGlzLl9tb250aHMgLyAxMikgKiAzMTUzNmU2O1xufVxuXG5mdW5jdGlvbiBtYWtlQXMoYWxpYXMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5hcyhhbGlhcyk7XG4gIH07XG59XG5cbmV4cG9ydCB2YXIgYXNNaWxsaXNlY29uZHMgPSBtYWtlQXMoJ21zJyk7XG5leHBvcnQgdmFyIGFzU2Vjb25kcyA9IG1ha2VBcygncycpO1xuZXhwb3J0IHZhciBhc01pbnV0ZXMgPSBtYWtlQXMoJ20nKTtcbmV4cG9ydCB2YXIgYXNIb3VycyA9IG1ha2VBcygnaCcpO1xuZXhwb3J0IHZhciBhc0RheXMgPSBtYWtlQXMoJ2QnKTtcbmV4cG9ydCB2YXIgYXNXZWVrcyA9IG1ha2VBcygndycpO1xuZXhwb3J0IHZhciBhc01vbnRocyA9IG1ha2VBcygnTScpO1xuZXhwb3J0IHZhciBhc1F1YXJ0ZXJzID0gbWFrZUFzKCdRJyk7XG5leHBvcnQgdmFyIGFzWWVhcnMgPSBtYWtlQXMoJ3knKTsiLCJpbXBvcnQgYWJzRmxvb3IgZnJvbSAnLi4vdXRpbHMvYWJzLWZsb29yJztcbmltcG9ydCBhYnNDZWlsIGZyb20gJy4uL3V0aWxzL2Ficy1jZWlsJztcbmltcG9ydCB7IGNyZWF0ZVVUQ0RhdGUgfSBmcm9tICcuLi9jcmVhdGUvZGF0ZS1mcm9tLWFycmF5JztcbmV4cG9ydCBmdW5jdGlvbiBidWJibGUoKSB7XG4gIHZhciBtaWxsaXNlY29uZHMgPSB0aGlzLl9taWxsaXNlY29uZHM7XG4gIHZhciBkYXlzID0gdGhpcy5fZGF5cztcbiAgdmFyIG1vbnRocyA9IHRoaXMuX21vbnRocztcbiAgdmFyIGRhdGEgPSB0aGlzLl9kYXRhO1xuICB2YXIgc2Vjb25kcywgbWludXRlcywgaG91cnMsIHllYXJzLCBtb250aHNGcm9tRGF5cztcblxuICBpZiAoIShtaWxsaXNlY29uZHMgPj0gMCAmJiBkYXlzID49IDAgJiYgbW9udGhzID49IDAgfHwgbWlsbGlzZWNvbmRzIDw9IDAgJiYgZGF5cyA8PSAwICYmIG1vbnRocyA8PSAwKSkge1xuICAgIG1pbGxpc2Vjb25kcyArPSBhYnNDZWlsKG1vbnRoc1RvRGF5cyhtb250aHMpICsgZGF5cykgKiA4NjRlNTtcbiAgICBkYXlzID0gMDtcbiAgICBtb250aHMgPSAwO1xuICB9XG5cbiAgZGF0YS5taWxsaXNlY29uZHMgPSBtaWxsaXNlY29uZHMgJSAxMDAwO1xuICBzZWNvbmRzID0gYWJzRmxvb3IobWlsbGlzZWNvbmRzIC8gMTAwMCk7XG4gIGRhdGEuc2Vjb25kcyA9IHNlY29uZHMgJSA2MDtcbiAgbWludXRlcyA9IGFic0Zsb29yKHNlY29uZHMgLyA2MCk7XG4gIGRhdGEubWludXRlcyA9IG1pbnV0ZXMgJSA2MDtcbiAgaG91cnMgPSBhYnNGbG9vcihtaW51dGVzIC8gNjApO1xuICBkYXRhLmhvdXJzID0gaG91cnMgJSAyNDtcbiAgZGF5cyArPSBhYnNGbG9vcihob3VycyAvIDI0KTtcbiAgbW9udGhzRnJvbURheXMgPSBhYnNGbG9vcihkYXlzVG9Nb250aHMoZGF5cykpO1xuICBtb250aHMgKz0gbW9udGhzRnJvbURheXM7XG4gIGRheXMgLT0gYWJzQ2VpbChtb250aHNUb0RheXMobW9udGhzRnJvbURheXMpKTtcbiAgeWVhcnMgPSBhYnNGbG9vcihtb250aHMgLyAxMik7XG4gIG1vbnRocyAlPSAxMjtcbiAgZGF0YS5kYXlzID0gZGF5cztcbiAgZGF0YS5tb250aHMgPSBtb250aHM7XG4gIGRhdGEueWVhcnMgPSB5ZWFycztcbiAgcmV0dXJuIHRoaXM7XG59XG5leHBvcnQgZnVuY3Rpb24gZGF5c1RvTW9udGhzKGRheXMpIHtcbiAgcmV0dXJuIGRheXMgKiA0ODAwIC8gMTQ2MDk3O1xufVxuZXhwb3J0IGZ1bmN0aW9uIG1vbnRoc1RvRGF5cyhtb250aHMpIHtcbiAgcmV0dXJuIG1vbnRocyAqIDE0NjA5NyAvIDQ4MDA7XG59IiwiaW1wb3J0IHsgY3JlYXRlRHVyYXRpb24gfSBmcm9tICcuL2NyZWF0ZSc7XG5leHBvcnQgZnVuY3Rpb24gY2xvbmUoKSB7XG4gIHJldHVybiBjcmVhdGVEdXJhdGlvbih0aGlzKTtcbn0iLCJpbXBvcnQgeyBub3JtYWxpemVPYmplY3RVbml0cyB9IGZyb20gJy4uL3VuaXRzL2FsaWFzZXMnO1xuaW1wb3J0IHsgZ2V0TG9jYWxlIH0gZnJvbSAnLi4vbG9jYWxlL2xvY2FsZXMnO1xuaW1wb3J0IGlzRHVyYXRpb25WYWxpZCBmcm9tICcuL3ZhbGlkLmpzJztcbmV4cG9ydCBmdW5jdGlvbiBEdXJhdGlvbihkdXJhdGlvbikge1xuICB2YXIgbm9ybWFsaXplZElucHV0ID0gbm9ybWFsaXplT2JqZWN0VW5pdHMoZHVyYXRpb24pLFxuICAgICAgeWVhcnMgPSBub3JtYWxpemVkSW5wdXQueWVhciB8fCAwLFxuICAgICAgcXVhcnRlcnMgPSBub3JtYWxpemVkSW5wdXQucXVhcnRlciB8fCAwLFxuICAgICAgbW9udGhzID0gbm9ybWFsaXplZElucHV0Lm1vbnRoIHx8IDAsXG4gICAgICB3ZWVrcyA9IG5vcm1hbGl6ZWRJbnB1dC53ZWVrIHx8IG5vcm1hbGl6ZWRJbnB1dC5pc29XZWVrIHx8IDAsXG4gICAgICBkYXlzID0gbm9ybWFsaXplZElucHV0LmRheSB8fCAwLFxuICAgICAgaG91cnMgPSBub3JtYWxpemVkSW5wdXQuaG91ciB8fCAwLFxuICAgICAgbWludXRlcyA9IG5vcm1hbGl6ZWRJbnB1dC5taW51dGUgfHwgMCxcbiAgICAgIHNlY29uZHMgPSBub3JtYWxpemVkSW5wdXQuc2Vjb25kIHx8IDAsXG4gICAgICBtaWxsaXNlY29uZHMgPSBub3JtYWxpemVkSW5wdXQubWlsbGlzZWNvbmQgfHwgMDtcbiAgdGhpcy5faXNWYWxpZCA9IGlzRHVyYXRpb25WYWxpZChub3JtYWxpemVkSW5wdXQpO1xuICB0aGlzLl9taWxsaXNlY29uZHMgPSArbWlsbGlzZWNvbmRzICsgc2Vjb25kcyAqIDFlMyArIG1pbnV0ZXMgKiA2ZTQgKyBob3VycyAqIDEwMDAgKiA2MCAqIDYwO1xuICB0aGlzLl9kYXlzID0gK2RheXMgKyB3ZWVrcyAqIDc7XG4gIHRoaXMuX21vbnRocyA9ICttb250aHMgKyBxdWFydGVycyAqIDMgKyB5ZWFycyAqIDEyO1xuICB0aGlzLl9kYXRhID0ge307XG4gIHRoaXMuX2xvY2FsZSA9IGdldExvY2FsZSgpO1xuXG4gIHRoaXMuX2J1YmJsZSgpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzRHVyYXRpb24ob2JqKSB7XG4gIHJldHVybiBvYmogaW5zdGFuY2VvZiBEdXJhdGlvbjtcbn0iLCJpbXBvcnQgeyBEdXJhdGlvbiwgaXNEdXJhdGlvbiB9IGZyb20gJy4vY29uc3RydWN0b3InO1xuaW1wb3J0IGlzTnVtYmVyIGZyb20gJy4uL3V0aWxzL2lzLW51bWJlcic7XG5pbXBvcnQgdG9JbnQgZnJvbSAnLi4vdXRpbHMvdG8taW50JztcbmltcG9ydCBhYnNSb3VuZCBmcm9tICcuLi91dGlscy9hYnMtcm91bmQnO1xuaW1wb3J0IGhhc093blByb3AgZnJvbSAnLi4vdXRpbHMvaGFzLW93bi1wcm9wJztcbmltcG9ydCB7IERBVEUsIEhPVVIsIE1JTlVURSwgU0VDT05ELCBNSUxMSVNFQ09ORCB9IGZyb20gJy4uL3VuaXRzL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBjbG9uZVdpdGhPZmZzZXQgfSBmcm9tICcuLi91bml0cy9vZmZzZXQnO1xuaW1wb3J0IHsgY3JlYXRlTG9jYWwgfSBmcm9tICcuLi9jcmVhdGUvbG9jYWwnO1xuaW1wb3J0IHsgY3JlYXRlSW52YWxpZCBhcyBpbnZhbGlkIH0gZnJvbSAnLi92YWxpZCc7XG52YXIgYXNwTmV0UmVnZXggPSAvXihcXC18XFwrKT8oPzooXFxkKilbLiBdKT8oXFxkKylcXDooXFxkKykoPzpcXDooXFxkKykoXFwuXFxkKik/KT8kLztcbnZhciBpc29SZWdleCA9IC9eKC18XFwrKT9QKD86KFstK10/WzAtOSwuXSopWSk/KD86KFstK10/WzAtOSwuXSopTSk/KD86KFstK10/WzAtOSwuXSopVyk/KD86KFstK10/WzAtOSwuXSopRCk/KD86VCg/OihbLStdP1swLTksLl0qKUgpPyg/OihbLStdP1swLTksLl0qKU0pPyg/OihbLStdP1swLTksLl0qKVMpPyk/JC87XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRHVyYXRpb24oaW5wdXQsIGtleSkge1xuICB2YXIgZHVyYXRpb24gPSBpbnB1dCxcbiAgICAgIG1hdGNoID0gbnVsbCxcbiAgICAgIHNpZ24sXG4gICAgICByZXQsXG4gICAgICBkaWZmUmVzO1xuXG4gIGlmIChpc0R1cmF0aW9uKGlucHV0KSkge1xuICAgIGR1cmF0aW9uID0ge1xuICAgICAgbXM6IGlucHV0Ll9taWxsaXNlY29uZHMsXG4gICAgICBkOiBpbnB1dC5fZGF5cyxcbiAgICAgIE06IGlucHV0Ll9tb250aHNcbiAgICB9O1xuICB9IGVsc2UgaWYgKGlzTnVtYmVyKGlucHV0KSkge1xuICAgIGR1cmF0aW9uID0ge307XG5cbiAgICBpZiAoa2V5KSB7XG4gICAgICBkdXJhdGlvbltrZXldID0gaW5wdXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGR1cmF0aW9uLm1pbGxpc2Vjb25kcyA9IGlucHV0O1xuICAgIH1cbiAgfSBlbHNlIGlmICghIShtYXRjaCA9IGFzcE5ldFJlZ2V4LmV4ZWMoaW5wdXQpKSkge1xuICAgIHNpZ24gPSBtYXRjaFsxXSA9PT0gJy0nID8gLTEgOiAxO1xuICAgIGR1cmF0aW9uID0ge1xuICAgICAgeTogMCxcbiAgICAgIGQ6IHRvSW50KG1hdGNoW0RBVEVdKSAqIHNpZ24sXG4gICAgICBoOiB0b0ludChtYXRjaFtIT1VSXSkgKiBzaWduLFxuICAgICAgbTogdG9JbnQobWF0Y2hbTUlOVVRFXSkgKiBzaWduLFxuICAgICAgczogdG9JbnQobWF0Y2hbU0VDT05EXSkgKiBzaWduLFxuICAgICAgbXM6IHRvSW50KGFic1JvdW5kKG1hdGNoW01JTExJU0VDT05EXSAqIDEwMDApKSAqIHNpZ25cbiAgICB9O1xuICB9IGVsc2UgaWYgKCEhKG1hdGNoID0gaXNvUmVnZXguZXhlYyhpbnB1dCkpKSB7XG4gICAgc2lnbiA9IG1hdGNoWzFdID09PSAnLScgPyAtMSA6IDE7XG4gICAgZHVyYXRpb24gPSB7XG4gICAgICB5OiBwYXJzZUlzbyhtYXRjaFsyXSwgc2lnbiksXG4gICAgICBNOiBwYXJzZUlzbyhtYXRjaFszXSwgc2lnbiksXG4gICAgICB3OiBwYXJzZUlzbyhtYXRjaFs0XSwgc2lnbiksXG4gICAgICBkOiBwYXJzZUlzbyhtYXRjaFs1XSwgc2lnbiksXG4gICAgICBoOiBwYXJzZUlzbyhtYXRjaFs2XSwgc2lnbiksXG4gICAgICBtOiBwYXJzZUlzbyhtYXRjaFs3XSwgc2lnbiksXG4gICAgICBzOiBwYXJzZUlzbyhtYXRjaFs4XSwgc2lnbilcbiAgICB9O1xuICB9IGVsc2UgaWYgKGR1cmF0aW9uID09IG51bGwpIHtcbiAgICBkdXJhdGlvbiA9IHt9O1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkdXJhdGlvbiA9PT0gJ29iamVjdCcgJiYgKCdmcm9tJyBpbiBkdXJhdGlvbiB8fCAndG8nIGluIGR1cmF0aW9uKSkge1xuICAgIGRpZmZSZXMgPSBtb21lbnRzRGlmZmVyZW5jZShjcmVhdGVMb2NhbChkdXJhdGlvbi5mcm9tKSwgY3JlYXRlTG9jYWwoZHVyYXRpb24udG8pKTtcbiAgICBkdXJhdGlvbiA9IHt9O1xuICAgIGR1cmF0aW9uLm1zID0gZGlmZlJlcy5taWxsaXNlY29uZHM7XG4gICAgZHVyYXRpb24uTSA9IGRpZmZSZXMubW9udGhzO1xuICB9XG5cbiAgcmV0ID0gbmV3IER1cmF0aW9uKGR1cmF0aW9uKTtcblxuICBpZiAoaXNEdXJhdGlvbihpbnB1dCkgJiYgaGFzT3duUHJvcChpbnB1dCwgJ19sb2NhbGUnKSkge1xuICAgIHJldC5fbG9jYWxlID0gaW5wdXQuX2xvY2FsZTtcbiAgfVxuXG4gIHJldHVybiByZXQ7XG59XG5jcmVhdGVEdXJhdGlvbi5mbiA9IER1cmF0aW9uLnByb3RvdHlwZTtcbmNyZWF0ZUR1cmF0aW9uLmludmFsaWQgPSBpbnZhbGlkO1xuXG5mdW5jdGlvbiBwYXJzZUlzbyhpbnAsIHNpZ24pIHtcbiAgdmFyIHJlcyA9IGlucCAmJiBwYXJzZUZsb2F0KGlucC5yZXBsYWNlKCcsJywgJy4nKSk7XG4gIHJldHVybiAoaXNOYU4ocmVzKSA/IDAgOiByZXMpICogc2lnbjtcbn1cblxuZnVuY3Rpb24gcG9zaXRpdmVNb21lbnRzRGlmZmVyZW5jZShiYXNlLCBvdGhlcikge1xuICB2YXIgcmVzID0ge307XG4gIHJlcy5tb250aHMgPSBvdGhlci5tb250aCgpIC0gYmFzZS5tb250aCgpICsgKG90aGVyLnllYXIoKSAtIGJhc2UueWVhcigpKSAqIDEyO1xuXG4gIGlmIChiYXNlLmNsb25lKCkuYWRkKHJlcy5tb250aHMsICdNJykuaXNBZnRlcihvdGhlcikpIHtcbiAgICAtLXJlcy5tb250aHM7XG4gIH1cblxuICByZXMubWlsbGlzZWNvbmRzID0gK290aGVyIC0gK2Jhc2UuY2xvbmUoKS5hZGQocmVzLm1vbnRocywgJ00nKTtcbiAgcmV0dXJuIHJlcztcbn1cblxuZnVuY3Rpb24gbW9tZW50c0RpZmZlcmVuY2UoYmFzZSwgb3RoZXIpIHtcbiAgdmFyIHJlcztcblxuICBpZiAoIShiYXNlLmlzVmFsaWQoKSAmJiBvdGhlci5pc1ZhbGlkKCkpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1pbGxpc2Vjb25kczogMCxcbiAgICAgIG1vbnRoczogMFxuICAgIH07XG4gIH1cblxuICBvdGhlciA9IGNsb25lV2l0aE9mZnNldChvdGhlciwgYmFzZSk7XG5cbiAgaWYgKGJhc2UuaXNCZWZvcmUob3RoZXIpKSB7XG4gICAgcmVzID0gcG9zaXRpdmVNb21lbnRzRGlmZmVyZW5jZShiYXNlLCBvdGhlcik7XG4gIH0gZWxzZSB7XG4gICAgcmVzID0gcG9zaXRpdmVNb21lbnRzRGlmZmVyZW5jZShvdGhlciwgYmFzZSk7XG4gICAgcmVzLm1pbGxpc2Vjb25kcyA9IC1yZXMubWlsbGlzZWNvbmRzO1xuICAgIHJlcy5tb250aHMgPSAtcmVzLm1vbnRocztcbiAgfVxuXG4gIHJldHVybiByZXM7XG59IiwiaW1wb3J0ICcuL3Byb3RvdHlwZSc7XG5pbXBvcnQgeyBjcmVhdGVEdXJhdGlvbiB9IGZyb20gJy4vY3JlYXRlJztcbmltcG9ydCB7IGlzRHVyYXRpb24gfSBmcm9tICcuL2NvbnN0cnVjdG9yJztcbmltcG9ydCB7IGdldFNldFJlbGF0aXZlVGltZVJvdW5kaW5nLCBnZXRTZXRSZWxhdGl2ZVRpbWVUaHJlc2hvbGQgfSBmcm9tICcuL2h1bWFuaXplJztcbmV4cG9ydCB7IGNyZWF0ZUR1cmF0aW9uLCBpc0R1cmF0aW9uLCBnZXRTZXRSZWxhdGl2ZVRpbWVSb3VuZGluZywgZ2V0U2V0UmVsYXRpdmVUaW1lVGhyZXNob2xkIH07IiwiaW1wb3J0IHsgbm9ybWFsaXplVW5pdHMgfSBmcm9tICcuLi91bml0cy9hbGlhc2VzJztcbmltcG9ydCBhYnNGbG9vciBmcm9tICcuLi91dGlscy9hYnMtZmxvb3InO1xuZXhwb3J0IGZ1bmN0aW9uIGdldCh1bml0cykge1xuICB1bml0cyA9IG5vcm1hbGl6ZVVuaXRzKHVuaXRzKTtcbiAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gdGhpc1t1bml0cyArICdzJ10oKSA6IE5hTjtcbn1cblxuZnVuY3Rpb24gbWFrZUdldHRlcihuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gdGhpcy5fZGF0YVtuYW1lXSA6IE5hTjtcbiAgfTtcbn1cblxuZXhwb3J0IHZhciBtaWxsaXNlY29uZHMgPSBtYWtlR2V0dGVyKCdtaWxsaXNlY29uZHMnKTtcbmV4cG9ydCB2YXIgc2Vjb25kcyA9IG1ha2VHZXR0ZXIoJ3NlY29uZHMnKTtcbmV4cG9ydCB2YXIgbWludXRlcyA9IG1ha2VHZXR0ZXIoJ21pbnV0ZXMnKTtcbmV4cG9ydCB2YXIgaG91cnMgPSBtYWtlR2V0dGVyKCdob3VycycpO1xuZXhwb3J0IHZhciBkYXlzID0gbWFrZUdldHRlcignZGF5cycpO1xuZXhwb3J0IHZhciBtb250aHMgPSBtYWtlR2V0dGVyKCdtb250aHMnKTtcbmV4cG9ydCB2YXIgeWVhcnMgPSBtYWtlR2V0dGVyKCd5ZWFycycpO1xuZXhwb3J0IGZ1bmN0aW9uIHdlZWtzKCkge1xuICByZXR1cm4gYWJzRmxvb3IodGhpcy5kYXlzKCkgLyA3KTtcbn0iLCJpbXBvcnQgeyBjcmVhdGVEdXJhdGlvbiB9IGZyb20gJy4vY3JlYXRlJztcbnZhciByb3VuZCA9IE1hdGgucm91bmQ7XG52YXIgdGhyZXNob2xkcyA9IHtcbiAgc3M6IDQ0LFxuICBzOiA0NSxcbiAgbTogNDUsXG4gIGg6IDIyLFxuICBkOiAyNixcbiAgTTogMTFcbn07XG5cbmZ1bmN0aW9uIHN1YnN0aXR1dGVUaW1lQWdvKHN0cmluZywgbnVtYmVyLCB3aXRob3V0U3VmZml4LCBpc0Z1dHVyZSwgbG9jYWxlKSB7XG4gIHJldHVybiBsb2NhbGUucmVsYXRpdmVUaW1lKG51bWJlciB8fCAxLCAhIXdpdGhvdXRTdWZmaXgsIHN0cmluZywgaXNGdXR1cmUpO1xufVxuXG5mdW5jdGlvbiByZWxhdGl2ZVRpbWUocG9zTmVnRHVyYXRpb24sIHdpdGhvdXRTdWZmaXgsIGxvY2FsZSkge1xuICB2YXIgZHVyYXRpb24gPSBjcmVhdGVEdXJhdGlvbihwb3NOZWdEdXJhdGlvbikuYWJzKCk7XG4gIHZhciBzZWNvbmRzID0gcm91bmQoZHVyYXRpb24uYXMoJ3MnKSk7XG4gIHZhciBtaW51dGVzID0gcm91bmQoZHVyYXRpb24uYXMoJ20nKSk7XG4gIHZhciBob3VycyA9IHJvdW5kKGR1cmF0aW9uLmFzKCdoJykpO1xuICB2YXIgZGF5cyA9IHJvdW5kKGR1cmF0aW9uLmFzKCdkJykpO1xuICB2YXIgbW9udGhzID0gcm91bmQoZHVyYXRpb24uYXMoJ00nKSk7XG4gIHZhciB5ZWFycyA9IHJvdW5kKGR1cmF0aW9uLmFzKCd5JykpO1xuICB2YXIgYSA9IHNlY29uZHMgPD0gdGhyZXNob2xkcy5zcyAmJiBbJ3MnLCBzZWNvbmRzXSB8fCBzZWNvbmRzIDwgdGhyZXNob2xkcy5zICYmIFsnc3MnLCBzZWNvbmRzXSB8fCBtaW51dGVzIDw9IDEgJiYgWydtJ10gfHwgbWludXRlcyA8IHRocmVzaG9sZHMubSAmJiBbJ21tJywgbWludXRlc10gfHwgaG91cnMgPD0gMSAmJiBbJ2gnXSB8fCBob3VycyA8IHRocmVzaG9sZHMuaCAmJiBbJ2hoJywgaG91cnNdIHx8IGRheXMgPD0gMSAmJiBbJ2QnXSB8fCBkYXlzIDwgdGhyZXNob2xkcy5kICYmIFsnZGQnLCBkYXlzXSB8fCBtb250aHMgPD0gMSAmJiBbJ00nXSB8fCBtb250aHMgPCB0aHJlc2hvbGRzLk0gJiYgWydNTScsIG1vbnRoc10gfHwgeWVhcnMgPD0gMSAmJiBbJ3knXSB8fCBbJ3l5JywgeWVhcnNdO1xuICBhWzJdID0gd2l0aG91dFN1ZmZpeDtcbiAgYVszXSA9ICtwb3NOZWdEdXJhdGlvbiA+IDA7XG4gIGFbNF0gPSBsb2NhbGU7XG4gIHJldHVybiBzdWJzdGl0dXRlVGltZUFnby5hcHBseShudWxsLCBhKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNldFJlbGF0aXZlVGltZVJvdW5kaW5nKHJvdW5kaW5nRnVuY3Rpb24pIHtcbiAgaWYgKHJvdW5kaW5nRnVuY3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiByb3VuZDtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygcm91bmRpbmdGdW5jdGlvbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJvdW5kID0gcm91bmRpbmdGdW5jdGlvbjtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXRSZWxhdGl2ZVRpbWVUaHJlc2hvbGQodGhyZXNob2xkLCBsaW1pdCkge1xuICBpZiAodGhyZXNob2xkc1t0aHJlc2hvbGRdID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAobGltaXQgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB0aHJlc2hvbGRzW3RocmVzaG9sZF07XG4gIH1cblxuICB0aHJlc2hvbGRzW3RocmVzaG9sZF0gPSBsaW1pdDtcblxuICBpZiAodGhyZXNob2xkID09PSAncycpIHtcbiAgICB0aHJlc2hvbGRzLnNzID0gbGltaXQgLSAxO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG5leHBvcnQgZnVuY3Rpb24gaHVtYW5pemUod2l0aFN1ZmZpeCkge1xuICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCk7XG4gIH1cblxuICB2YXIgbG9jYWxlID0gdGhpcy5sb2NhbGVEYXRhKCk7XG4gIHZhciBvdXRwdXQgPSByZWxhdGl2ZVRpbWUodGhpcywgIXdpdGhTdWZmaXgsIGxvY2FsZSk7XG5cbiAgaWYgKHdpdGhTdWZmaXgpIHtcbiAgICBvdXRwdXQgPSBsb2NhbGUucGFzdEZ1dHVyZSgrdGhpcywgb3V0cHV0KTtcbiAgfVxuXG4gIHJldHVybiBsb2NhbGUucG9zdGZvcm1hdChvdXRwdXQpO1xufSIsImltcG9ydCBhYnNGbG9vciBmcm9tICcuLi91dGlscy9hYnMtZmxvb3InO1xudmFyIGFicyA9IE1hdGguYWJzO1xuXG5mdW5jdGlvbiBzaWduKHgpIHtcbiAgcmV0dXJuICh4ID4gMCkgLSAoeCA8IDApIHx8ICt4O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9JU09TdHJpbmcoKSB7XG4gIGlmICghdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKTtcbiAgfVxuXG4gIHZhciBzZWNvbmRzID0gYWJzKHRoaXMuX21pbGxpc2Vjb25kcykgLyAxMDAwO1xuICB2YXIgZGF5cyA9IGFicyh0aGlzLl9kYXlzKTtcbiAgdmFyIG1vbnRocyA9IGFicyh0aGlzLl9tb250aHMpO1xuICB2YXIgbWludXRlcywgaG91cnMsIHllYXJzO1xuICBtaW51dGVzID0gYWJzRmxvb3Ioc2Vjb25kcyAvIDYwKTtcbiAgaG91cnMgPSBhYnNGbG9vcihtaW51dGVzIC8gNjApO1xuICBzZWNvbmRzICU9IDYwO1xuICBtaW51dGVzICU9IDYwO1xuICB5ZWFycyA9IGFic0Zsb29yKG1vbnRocyAvIDEyKTtcbiAgbW9udGhzICU9IDEyO1xuICB2YXIgWSA9IHllYXJzO1xuICB2YXIgTSA9IG1vbnRocztcbiAgdmFyIEQgPSBkYXlzO1xuICB2YXIgaCA9IGhvdXJzO1xuICB2YXIgbSA9IG1pbnV0ZXM7XG4gIHZhciBzID0gc2Vjb25kcyA/IHNlY29uZHMudG9GaXhlZCgzKS5yZXBsYWNlKC9cXC4/MCskLywgJycpIDogJyc7XG4gIHZhciB0b3RhbCA9IHRoaXMuYXNTZWNvbmRzKCk7XG5cbiAgaWYgKCF0b3RhbCkge1xuICAgIHJldHVybiAnUDBEJztcbiAgfVxuXG4gIHZhciB0b3RhbFNpZ24gPSB0b3RhbCA8IDAgPyAnLScgOiAnJztcbiAgdmFyIHltU2lnbiA9IHNpZ24odGhpcy5fbW9udGhzKSAhPT0gc2lnbih0b3RhbCkgPyAnLScgOiAnJztcbiAgdmFyIGRheXNTaWduID0gc2lnbih0aGlzLl9kYXlzKSAhPT0gc2lnbih0b3RhbCkgPyAnLScgOiAnJztcbiAgdmFyIGhtc1NpZ24gPSBzaWduKHRoaXMuX21pbGxpc2Vjb25kcykgIT09IHNpZ24odG90YWwpID8gJy0nIDogJyc7XG4gIHJldHVybiB0b3RhbFNpZ24gKyAnUCcgKyAoWSA/IHltU2lnbiArIFkgKyAnWScgOiAnJykgKyAoTSA/IHltU2lnbiArIE0gKyAnTScgOiAnJykgKyAoRCA/IGRheXNTaWduICsgRCArICdEJyA6ICcnKSArIChoIHx8IG0gfHwgcyA/ICdUJyA6ICcnKSArIChoID8gaG1zU2lnbiArIGggKyAnSCcgOiAnJykgKyAobSA/IGhtc1NpZ24gKyBtICsgJ00nIDogJycpICsgKHMgPyBobXNTaWduICsgcyArICdTJyA6ICcnKTtcbn0iLCJpbXBvcnQgeyBEdXJhdGlvbiB9IGZyb20gJy4vY29uc3RydWN0b3InO1xudmFyIHByb3RvID0gRHVyYXRpb24ucHJvdG90eXBlO1xuaW1wb3J0IHsgYWJzIH0gZnJvbSAnLi9hYnMnO1xuaW1wb3J0IHsgYWRkLCBzdWJ0cmFjdCB9IGZyb20gJy4vYWRkLXN1YnRyYWN0JztcbmltcG9ydCB7IGFzLCBhc01pbGxpc2Vjb25kcywgYXNTZWNvbmRzLCBhc01pbnV0ZXMsIGFzSG91cnMsIGFzRGF5cywgYXNXZWVrcywgYXNNb250aHMsIGFzUXVhcnRlcnMsIGFzWWVhcnMsIHZhbHVlT2YgfSBmcm9tICcuL2FzJztcbmltcG9ydCB7IGJ1YmJsZSB9IGZyb20gJy4vYnViYmxlJztcbmltcG9ydCB7IGNsb25lIH0gZnJvbSAnLi9jbG9uZSc7XG5pbXBvcnQgeyBnZXQsIG1pbGxpc2Vjb25kcywgc2Vjb25kcywgbWludXRlcywgaG91cnMsIGRheXMsIG1vbnRocywgeWVhcnMsIHdlZWtzIH0gZnJvbSAnLi9nZXQnO1xuaW1wb3J0IHsgaHVtYW5pemUgfSBmcm9tICcuL2h1bWFuaXplJztcbmltcG9ydCB7IHRvSVNPU3RyaW5nIH0gZnJvbSAnLi9pc28tc3RyaW5nJztcbmltcG9ydCB7IGxhbmcsIGxvY2FsZSwgbG9jYWxlRGF0YSB9IGZyb20gJy4uL21vbWVudC9sb2NhbGUnO1xuaW1wb3J0IHsgaXNWYWxpZCB9IGZyb20gJy4vdmFsaWQnO1xucHJvdG8uaXNWYWxpZCA9IGlzVmFsaWQ7XG5wcm90by5hYnMgPSBhYnM7XG5wcm90by5hZGQgPSBhZGQ7XG5wcm90by5zdWJ0cmFjdCA9IHN1YnRyYWN0O1xucHJvdG8uYXMgPSBhcztcbnByb3RvLmFzTWlsbGlzZWNvbmRzID0gYXNNaWxsaXNlY29uZHM7XG5wcm90by5hc1NlY29uZHMgPSBhc1NlY29uZHM7XG5wcm90by5hc01pbnV0ZXMgPSBhc01pbnV0ZXM7XG5wcm90by5hc0hvdXJzID0gYXNIb3VycztcbnByb3RvLmFzRGF5cyA9IGFzRGF5cztcbnByb3RvLmFzV2Vla3MgPSBhc1dlZWtzO1xucHJvdG8uYXNNb250aHMgPSBhc01vbnRocztcbnByb3RvLmFzUXVhcnRlcnMgPSBhc1F1YXJ0ZXJzO1xucHJvdG8uYXNZZWFycyA9IGFzWWVhcnM7XG5wcm90by52YWx1ZU9mID0gdmFsdWVPZjtcbnByb3RvLl9idWJibGUgPSBidWJibGU7XG5wcm90by5jbG9uZSA9IGNsb25lO1xucHJvdG8uZ2V0ID0gZ2V0O1xucHJvdG8ubWlsbGlzZWNvbmRzID0gbWlsbGlzZWNvbmRzO1xucHJvdG8uc2Vjb25kcyA9IHNlY29uZHM7XG5wcm90by5taW51dGVzID0gbWludXRlcztcbnByb3RvLmhvdXJzID0gaG91cnM7XG5wcm90by5kYXlzID0gZGF5cztcbnByb3RvLndlZWtzID0gd2Vla3M7XG5wcm90by5tb250aHMgPSBtb250aHM7XG5wcm90by55ZWFycyA9IHllYXJzO1xucHJvdG8uaHVtYW5pemUgPSBodW1hbml6ZTtcbnByb3RvLnRvSVNPU3RyaW5nID0gdG9JU09TdHJpbmc7XG5wcm90by50b1N0cmluZyA9IHRvSVNPU3RyaW5nO1xucHJvdG8udG9KU09OID0gdG9JU09TdHJpbmc7XG5wcm90by5sb2NhbGUgPSBsb2NhbGU7XG5wcm90by5sb2NhbGVEYXRhID0gbG9jYWxlRGF0YTtcbmltcG9ydCB7IGRlcHJlY2F0ZSB9IGZyb20gJy4uL3V0aWxzL2RlcHJlY2F0ZSc7XG5wcm90by50b0lzb1N0cmluZyA9IGRlcHJlY2F0ZSgndG9Jc29TdHJpbmcoKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRvSVNPU3RyaW5nKCkgaW5zdGVhZCAobm90aWNlIHRoZSBjYXBpdGFscyknLCB0b0lTT1N0cmluZyk7XG5wcm90by5sYW5nID0gbGFuZzsiLCJpbXBvcnQgdG9JbnQgZnJvbSAnLi4vdXRpbHMvdG8taW50JztcbmltcG9ydCBpbmRleE9mIGZyb20gJy4uL3V0aWxzL2luZGV4LW9mJztcbmltcG9ydCB7IER1cmF0aW9uIH0gZnJvbSAnLi9jb25zdHJ1Y3Rvcic7XG5pbXBvcnQgeyBjcmVhdGVEdXJhdGlvbiB9IGZyb20gJy4vY3JlYXRlJztcbnZhciBvcmRlcmluZyA9IFsneWVhcicsICdxdWFydGVyJywgJ21vbnRoJywgJ3dlZWsnLCAnZGF5JywgJ2hvdXInLCAnbWludXRlJywgJ3NlY29uZCcsICdtaWxsaXNlY29uZCddO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNEdXJhdGlvblZhbGlkKG0pIHtcbiAgZm9yICh2YXIga2V5IGluIG0pIHtcbiAgICBpZiAoIShpbmRleE9mLmNhbGwob3JkZXJpbmcsIGtleSkgIT09IC0xICYmIChtW2tleV0gPT0gbnVsbCB8fCAhaXNOYU4obVtrZXldKSkpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgdmFyIHVuaXRIYXNEZWNpbWFsID0gZmFsc2U7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcmRlcmluZy5sZW5ndGg7ICsraSkge1xuICAgIGlmIChtW29yZGVyaW5nW2ldXSkge1xuICAgICAgaWYgKHVuaXRIYXNEZWNpbWFsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHBhcnNlRmxvYXQobVtvcmRlcmluZ1tpXV0pICE9PSB0b0ludChtW29yZGVyaW5nW2ldXSkpIHtcbiAgICAgICAgdW5pdEhhc0RlY2ltYWwgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWQoKSB7XG4gIHJldHVybiB0aGlzLl9pc1ZhbGlkO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUludmFsaWQoKSB7XG4gIHJldHVybiBjcmVhdGVEdXJhdGlvbihOYU4pO1xufSIsImltcG9ydCB6ZXJvRmlsbCBmcm9tICcuLi91dGlscy96ZXJvLWZpbGwnO1xuaW1wb3J0IGlzRnVuY3Rpb24gZnJvbSAnLi4vdXRpbHMvaXMtZnVuY3Rpb24nO1xuZXhwb3J0IHZhciBmb3JtYXR0aW5nVG9rZW5zID0gLyhcXFtbXlxcW10qXFxdKXwoXFxcXCk/KFtIaF1tbShzcyk/fE1vfE1NP00/TT98RG98REREb3xERD9EP0Q/fGRkZD9kP3xkbz98d1tvfHddP3xXW298V10/fFFvP3xZWVlZWVl8WVlZWVl8WVlZWXxZWXxnZyhnZ2c/KT98R0coR0dHPyk/fGV8RXxhfEF8aGg/fEhIP3xraz98bW0/fHNzP3xTezEsOX18eHxYfHp6P3xaWj98LikvZztcbnZhciBsb2NhbEZvcm1hdHRpbmdUb2tlbnMgPSAvKFxcW1teXFxbXSpcXF0pfChcXFxcKT8oTFRTfExUfExMP0w/TD98bHsxLDR9KS9nO1xudmFyIGZvcm1hdEZ1bmN0aW9ucyA9IHt9O1xuZXhwb3J0IHZhciBmb3JtYXRUb2tlbkZ1bmN0aW9ucyA9IHt9O1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEZvcm1hdFRva2VuKHRva2VuLCBwYWRkZWQsIG9yZGluYWwsIGNhbGxiYWNrKSB7XG4gIHZhciBmdW5jID0gY2FsbGJhY2s7XG5cbiAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ3N0cmluZycpIHtcbiAgICBmdW5jID0gZnVuY3Rpb24gZnVuYygpIHtcbiAgICAgIHJldHVybiB0aGlzW2NhbGxiYWNrXSgpO1xuICAgIH07XG4gIH1cblxuICBpZiAodG9rZW4pIHtcbiAgICBmb3JtYXRUb2tlbkZ1bmN0aW9uc1t0b2tlbl0gPSBmdW5jO1xuICB9XG5cbiAgaWYgKHBhZGRlZCkge1xuICAgIGZvcm1hdFRva2VuRnVuY3Rpb25zW3BhZGRlZFswXV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gemVyb0ZpbGwoZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCBwYWRkZWRbMV0sIHBhZGRlZFsyXSk7XG4gICAgfTtcbiAgfVxuXG4gIGlmIChvcmRpbmFsKSB7XG4gICAgZm9ybWF0VG9rZW5GdW5jdGlvbnNbb3JkaW5hbF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkub3JkaW5hbChmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRva2VuKTtcbiAgICB9O1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUZvcm1hdHRpbmdUb2tlbnMoaW5wdXQpIHtcbiAgaWYgKGlucHV0Lm1hdGNoKC9cXFtbXFxzXFxTXS8pKSB7XG4gICAgcmV0dXJuIGlucHV0LnJlcGxhY2UoL15cXFt8XFxdJC9nLCAnJyk7XG4gIH1cblxuICByZXR1cm4gaW5wdXQucmVwbGFjZSgvXFxcXC9nLCAnJyk7XG59XG5cbmZ1bmN0aW9uIG1ha2VGb3JtYXRGdW5jdGlvbihmb3JtYXQpIHtcbiAgdmFyIGFycmF5ID0gZm9ybWF0Lm1hdGNoKGZvcm1hdHRpbmdUb2tlbnMpLFxuICAgICAgaSxcbiAgICAgIGxlbmd0aDtcblxuICBmb3IgKGkgPSAwLCBsZW5ndGggPSBhcnJheS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGlmIChmb3JtYXRUb2tlbkZ1bmN0aW9uc1thcnJheVtpXV0pIHtcbiAgICAgIGFycmF5W2ldID0gZm9ybWF0VG9rZW5GdW5jdGlvbnNbYXJyYXlbaV1dO1xuICAgIH0gZWxzZSB7XG4gICAgICBhcnJheVtpXSA9IHJlbW92ZUZvcm1hdHRpbmdUb2tlbnMoYXJyYXlbaV0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAobW9tKSB7XG4gICAgdmFyIG91dHB1dCA9ICcnLFxuICAgICAgICBpO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBvdXRwdXQgKz0gaXNGdW5jdGlvbihhcnJheVtpXSkgPyBhcnJheVtpXS5jYWxsKG1vbSwgZm9ybWF0KSA6IGFycmF5W2ldO1xuICAgIH1cblxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRNb21lbnQobSwgZm9ybWF0KSB7XG4gIGlmICghbS5pc1ZhbGlkKCkpIHtcbiAgICByZXR1cm4gbS5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKTtcbiAgfVxuXG4gIGZvcm1hdCA9IGV4cGFuZEZvcm1hdChmb3JtYXQsIG0ubG9jYWxlRGF0YSgpKTtcbiAgZm9ybWF0RnVuY3Rpb25zW2Zvcm1hdF0gPSBmb3JtYXRGdW5jdGlvbnNbZm9ybWF0XSB8fCBtYWtlRm9ybWF0RnVuY3Rpb24oZm9ybWF0KTtcbiAgcmV0dXJuIGZvcm1hdEZ1bmN0aW9uc1tmb3JtYXRdKG0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGV4cGFuZEZvcm1hdChmb3JtYXQsIGxvY2FsZSkge1xuICB2YXIgaSA9IDU7XG5cbiAgZnVuY3Rpb24gcmVwbGFjZUxvbmdEYXRlRm9ybWF0VG9rZW5zKGlucHV0KSB7XG4gICAgcmV0dXJuIGxvY2FsZS5sb25nRGF0ZUZvcm1hdChpbnB1dCkgfHwgaW5wdXQ7XG4gIH1cblxuICBsb2NhbEZvcm1hdHRpbmdUb2tlbnMubGFzdEluZGV4ID0gMDtcblxuICB3aGlsZSAoaSA+PSAwICYmIGxvY2FsRm9ybWF0dGluZ1Rva2Vucy50ZXN0KGZvcm1hdCkpIHtcbiAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZShsb2NhbEZvcm1hdHRpbmdUb2tlbnMsIHJlcGxhY2VMb25nRGF0ZUZvcm1hdFRva2Vucyk7XG4gICAgbG9jYWxGb3JtYXR0aW5nVG9rZW5zLmxhc3RJbmRleCA9IDA7XG4gICAgaSAtPSAxO1xuICB9XG5cbiAgcmV0dXJuIGZvcm1hdDtcbn0iLCJpbXBvcnQgeyBkZWZhdWx0Q2FsZW5kYXIgfSBmcm9tICcuL2NhbGVuZGFyJztcbmltcG9ydCB7IGRlZmF1bHRMb25nRGF0ZUZvcm1hdCB9IGZyb20gJy4vZm9ybWF0cyc7XG5pbXBvcnQgeyBkZWZhdWx0SW52YWxpZERhdGUgfSBmcm9tICcuL2ludmFsaWQnO1xuaW1wb3J0IHsgZGVmYXVsdE9yZGluYWwsIGRlZmF1bHREYXlPZk1vbnRoT3JkaW5hbFBhcnNlIH0gZnJvbSAnLi9vcmRpbmFsJztcbmltcG9ydCB7IGRlZmF1bHRSZWxhdGl2ZVRpbWUgfSBmcm9tICcuL3JlbGF0aXZlJztcbmltcG9ydCB7IGRlZmF1bHRMb2NhbGVNb250aHMsIGRlZmF1bHRMb2NhbGVNb250aHNTaG9ydCB9IGZyb20gJy4uL3VuaXRzL21vbnRoJztcbmltcG9ydCB7IGRlZmF1bHRMb2NhbGVXZWVrIH0gZnJvbSAnLi4vdW5pdHMvd2Vlayc7XG5pbXBvcnQgeyBkZWZhdWx0TG9jYWxlV2Vla2RheXMsIGRlZmF1bHRMb2NhbGVXZWVrZGF5c01pbiwgZGVmYXVsdExvY2FsZVdlZWtkYXlzU2hvcnQgfSBmcm9tICcuLi91bml0cy9kYXktb2Ytd2Vlayc7XG5pbXBvcnQgeyBkZWZhdWx0TG9jYWxlTWVyaWRpZW1QYXJzZSB9IGZyb20gJy4uL3VuaXRzL2hvdXInO1xuZXhwb3J0IHZhciBiYXNlQ29uZmlnID0ge1xuICBjYWxlbmRhcjogZGVmYXVsdENhbGVuZGFyLFxuICBsb25nRGF0ZUZvcm1hdDogZGVmYXVsdExvbmdEYXRlRm9ybWF0LFxuICBpbnZhbGlkRGF0ZTogZGVmYXVsdEludmFsaWREYXRlLFxuICBvcmRpbmFsOiBkZWZhdWx0T3JkaW5hbCxcbiAgZGF5T2ZNb250aE9yZGluYWxQYXJzZTogZGVmYXVsdERheU9mTW9udGhPcmRpbmFsUGFyc2UsXG4gIHJlbGF0aXZlVGltZTogZGVmYXVsdFJlbGF0aXZlVGltZSxcbiAgbW9udGhzOiBkZWZhdWx0TG9jYWxlTW9udGhzLFxuICBtb250aHNTaG9ydDogZGVmYXVsdExvY2FsZU1vbnRoc1Nob3J0LFxuICB3ZWVrOiBkZWZhdWx0TG9jYWxlV2VlayxcbiAgd2Vla2RheXM6IGRlZmF1bHRMb2NhbGVXZWVrZGF5cyxcbiAgd2Vla2RheXNNaW46IGRlZmF1bHRMb2NhbGVXZWVrZGF5c01pbixcbiAgd2Vla2RheXNTaG9ydDogZGVmYXVsdExvY2FsZVdlZWtkYXlzU2hvcnQsXG4gIG1lcmlkaWVtUGFyc2U6IGRlZmF1bHRMb2NhbGVNZXJpZGllbVBhcnNlXG59OyIsImV4cG9ydCB2YXIgZGVmYXVsdENhbGVuZGFyID0ge1xuICBzYW1lRGF5OiAnW1RvZGF5IGF0XSBMVCcsXG4gIG5leHREYXk6ICdbVG9tb3Jyb3cgYXRdIExUJyxcbiAgbmV4dFdlZWs6ICdkZGRkIFthdF0gTFQnLFxuICBsYXN0RGF5OiAnW1llc3RlcmRheSBhdF0gTFQnLFxuICBsYXN0V2VlazogJ1tMYXN0XSBkZGRkIFthdF0gTFQnLFxuICBzYW1lRWxzZTogJ0wnXG59O1xuaW1wb3J0IGlzRnVuY3Rpb24gZnJvbSAnLi4vdXRpbHMvaXMtZnVuY3Rpb24nO1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGVuZGFyKGtleSwgbW9tLCBub3cpIHtcbiAgdmFyIG91dHB1dCA9IHRoaXMuX2NhbGVuZGFyW2tleV0gfHwgdGhpcy5fY2FsZW5kYXJbJ3NhbWVFbHNlJ107XG4gIHJldHVybiBpc0Z1bmN0aW9uKG91dHB1dCkgPyBvdXRwdXQuY2FsbChtb20sIG5vdykgOiBvdXRwdXQ7XG59IiwiZXhwb3J0IGZ1bmN0aW9uIExvY2FsZShjb25maWcpIHtcbiAgaWYgKGNvbmZpZyAhPSBudWxsKSB7XG4gICAgdGhpcy5zZXQoY29uZmlnKTtcbiAgfVxufSIsImltcG9ydCAnLi9wcm90b3R5cGUnO1xuaW1wb3J0IHsgZ2V0U2V0R2xvYmFsTG9jYWxlIH0gZnJvbSAnLi9sb2NhbGVzJztcbmltcG9ydCB0b0ludCBmcm9tICcuLi91dGlscy90by1pbnQnO1xuZ2V0U2V0R2xvYmFsTG9jYWxlKCdlbicsIHtcbiAgZGF5T2ZNb250aE9yZGluYWxQYXJzZTogL1xcZHsxLDJ9KHRofHN0fG5kfHJkKS8sXG4gIG9yZGluYWw6IGZ1bmN0aW9uIG9yZGluYWwobnVtYmVyKSB7XG4gICAgdmFyIGIgPSBudW1iZXIgJSAxMCxcbiAgICAgICAgb3V0cHV0ID0gdG9JbnQobnVtYmVyICUgMTAwIC8gMTApID09PSAxID8gJ3RoJyA6IGIgPT09IDEgPyAnc3QnIDogYiA9PT0gMiA/ICduZCcgOiBiID09PSAzID8gJ3JkJyA6ICd0aCc7XG4gICAgcmV0dXJuIG51bWJlciArIG91dHB1dDtcbiAgfVxufSk7IiwiZXhwb3J0IHZhciBkZWZhdWx0TG9uZ0RhdGVGb3JtYXQgPSB7XG4gIExUUzogJ2g6bW06c3MgQScsXG4gIExUOiAnaDptbSBBJyxcbiAgTDogJ01NL0REL1lZWVknLFxuICBMTDogJ01NTU0gRCwgWVlZWScsXG4gIExMTDogJ01NTU0gRCwgWVlZWSBoOm1tIEEnLFxuICBMTExMOiAnZGRkZCwgTU1NTSBELCBZWVlZIGg6bW0gQSdcbn07XG5leHBvcnQgZnVuY3Rpb24gbG9uZ0RhdGVGb3JtYXQoa2V5KSB7XG4gIHZhciBmb3JtYXQgPSB0aGlzLl9sb25nRGF0ZUZvcm1hdFtrZXldLFxuICAgICAgZm9ybWF0VXBwZXIgPSB0aGlzLl9sb25nRGF0ZUZvcm1hdFtrZXkudG9VcHBlckNhc2UoKV07XG5cbiAgaWYgKGZvcm1hdCB8fCAhZm9ybWF0VXBwZXIpIHtcbiAgICByZXR1cm4gZm9ybWF0O1xuICB9XG5cbiAgdGhpcy5fbG9uZ0RhdGVGb3JtYXRba2V5XSA9IGZvcm1hdFVwcGVyLnJlcGxhY2UoL01NTU18TU18RER8ZGRkZC9nLCBmdW5jdGlvbiAodmFsKSB7XG4gICAgcmV0dXJuIHZhbC5zbGljZSgxKTtcbiAgfSk7XG4gIHJldHVybiB0aGlzLl9sb25nRGF0ZUZvcm1hdFtrZXldO1xufSIsImV4cG9ydCB2YXIgZGVmYXVsdEludmFsaWREYXRlID0gJ0ludmFsaWQgZGF0ZSc7XG5leHBvcnQgZnVuY3Rpb24gaW52YWxpZERhdGUoKSB7XG4gIHJldHVybiB0aGlzLl9pbnZhbGlkRGF0ZTtcbn0iLCJpbXBvcnQgaXNOdW1iZXIgZnJvbSAnLi4vdXRpbHMvaXMtbnVtYmVyJztcbmltcG9ydCB7IGdldExvY2FsZSB9IGZyb20gJy4vbG9jYWxlcyc7XG5pbXBvcnQgeyBjcmVhdGVVVEMgfSBmcm9tICcuLi9jcmVhdGUvdXRjJztcblxuZnVuY3Rpb24gZ2V0KGZvcm1hdCwgaW5kZXgsIGZpZWxkLCBzZXR0ZXIpIHtcbiAgdmFyIGxvY2FsZSA9IGdldExvY2FsZSgpO1xuICB2YXIgdXRjID0gY3JlYXRlVVRDKCkuc2V0KHNldHRlciwgaW5kZXgpO1xuICByZXR1cm4gbG9jYWxlW2ZpZWxkXSh1dGMsIGZvcm1hdCk7XG59XG5cbmZ1bmN0aW9uIGxpc3RNb250aHNJbXBsKGZvcm1hdCwgaW5kZXgsIGZpZWxkKSB7XG4gIGlmIChpc051bWJlcihmb3JtYXQpKSB7XG4gICAgaW5kZXggPSBmb3JtYXQ7XG4gICAgZm9ybWF0ID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgZm9ybWF0ID0gZm9ybWF0IHx8ICcnO1xuXG4gIGlmIChpbmRleCAhPSBudWxsKSB7XG4gICAgcmV0dXJuIGdldChmb3JtYXQsIGluZGV4LCBmaWVsZCwgJ21vbnRoJyk7XG4gIH1cblxuICB2YXIgaTtcbiAgdmFyIG91dCA9IFtdO1xuXG4gIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgb3V0W2ldID0gZ2V0KGZvcm1hdCwgaSwgZmllbGQsICdtb250aCcpO1xuICB9XG5cbiAgcmV0dXJuIG91dDtcbn1cblxuZnVuY3Rpb24gbGlzdFdlZWtkYXlzSW1wbChsb2NhbGVTb3J0ZWQsIGZvcm1hdCwgaW5kZXgsIGZpZWxkKSB7XG4gIGlmICh0eXBlb2YgbG9jYWxlU29ydGVkID09PSAnYm9vbGVhbicpIHtcbiAgICBpZiAoaXNOdW1iZXIoZm9ybWF0KSkge1xuICAgICAgaW5kZXggPSBmb3JtYXQ7XG4gICAgICBmb3JtYXQgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgZm9ybWF0ID0gZm9ybWF0IHx8ICcnO1xuICB9IGVsc2Uge1xuICAgIGZvcm1hdCA9IGxvY2FsZVNvcnRlZDtcbiAgICBpbmRleCA9IGZvcm1hdDtcbiAgICBsb2NhbGVTb3J0ZWQgPSBmYWxzZTtcblxuICAgIGlmIChpc051bWJlcihmb3JtYXQpKSB7XG4gICAgICBpbmRleCA9IGZvcm1hdDtcbiAgICAgIGZvcm1hdCA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBmb3JtYXQgPSBmb3JtYXQgfHwgJyc7XG4gIH1cblxuICB2YXIgbG9jYWxlID0gZ2V0TG9jYWxlKCksXG4gICAgICBzaGlmdCA9IGxvY2FsZVNvcnRlZCA/IGxvY2FsZS5fd2Vlay5kb3cgOiAwO1xuXG4gIGlmIChpbmRleCAhPSBudWxsKSB7XG4gICAgcmV0dXJuIGdldChmb3JtYXQsIChpbmRleCArIHNoaWZ0KSAlIDcsIGZpZWxkLCAnZGF5Jyk7XG4gIH1cblxuICB2YXIgaTtcbiAgdmFyIG91dCA9IFtdO1xuXG4gIGZvciAoaSA9IDA7IGkgPCA3OyBpKyspIHtcbiAgICBvdXRbaV0gPSBnZXQoZm9ybWF0LCAoaSArIHNoaWZ0KSAlIDcsIGZpZWxkLCAnZGF5Jyk7XG4gIH1cblxuICByZXR1cm4gb3V0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGlzdE1vbnRocyhmb3JtYXQsIGluZGV4KSB7XG4gIHJldHVybiBsaXN0TW9udGhzSW1wbChmb3JtYXQsIGluZGV4LCAnbW9udGhzJyk7XG59XG5leHBvcnQgZnVuY3Rpb24gbGlzdE1vbnRoc1Nob3J0KGZvcm1hdCwgaW5kZXgpIHtcbiAgcmV0dXJuIGxpc3RNb250aHNJbXBsKGZvcm1hdCwgaW5kZXgsICdtb250aHNTaG9ydCcpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RXZWVrZGF5cyhsb2NhbGVTb3J0ZWQsIGZvcm1hdCwgaW5kZXgpIHtcbiAgcmV0dXJuIGxpc3RXZWVrZGF5c0ltcGwobG9jYWxlU29ydGVkLCBmb3JtYXQsIGluZGV4LCAnd2Vla2RheXMnKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBsaXN0V2Vla2RheXNTaG9ydChsb2NhbGVTb3J0ZWQsIGZvcm1hdCwgaW5kZXgpIHtcbiAgcmV0dXJuIGxpc3RXZWVrZGF5c0ltcGwobG9jYWxlU29ydGVkLCBmb3JtYXQsIGluZGV4LCAnd2Vla2RheXNTaG9ydCcpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RXZWVrZGF5c01pbihsb2NhbGVTb3J0ZWQsIGZvcm1hdCwgaW5kZXgpIHtcbiAgcmV0dXJuIGxpc3RXZWVrZGF5c0ltcGwobG9jYWxlU29ydGVkLCBmb3JtYXQsIGluZGV4LCAnd2Vla2RheXNNaW4nKTtcbn0iLCJpbXBvcnQgJy4vcHJvdG90eXBlJztcbmltcG9ydCB7IGdldFNldEdsb2JhbExvY2FsZSwgZGVmaW5lTG9jYWxlLCB1cGRhdGVMb2NhbGUsIGdldExvY2FsZSwgbGlzdExvY2FsZXMgfSBmcm9tICcuL2xvY2FsZXMnO1xuaW1wb3J0IHsgbGlzdE1vbnRocywgbGlzdE1vbnRoc1Nob3J0LCBsaXN0V2Vla2RheXMsIGxpc3RXZWVrZGF5c1Nob3J0LCBsaXN0V2Vla2RheXNNaW4gfSBmcm9tICcuL2xpc3RzJztcbmV4cG9ydCB7IGdldFNldEdsb2JhbExvY2FsZSwgZGVmaW5lTG9jYWxlLCB1cGRhdGVMb2NhbGUsIGdldExvY2FsZSwgbGlzdExvY2FsZXMsIGxpc3RNb250aHMsIGxpc3RNb250aHNTaG9ydCwgbGlzdFdlZWtkYXlzLCBsaXN0V2Vla2RheXNTaG9ydCwgbGlzdFdlZWtkYXlzTWluIH07XG5pbXBvcnQgeyBkZXByZWNhdGUgfSBmcm9tICcuLi91dGlscy9kZXByZWNhdGUnO1xuaW1wb3J0IHsgaG9va3MgfSBmcm9tICcuLi91dGlscy9ob29rcyc7XG5ob29rcy5sYW5nID0gZGVwcmVjYXRlKCdtb21lbnQubGFuZyBpcyBkZXByZWNhdGVkLiBVc2UgbW9tZW50LmxvY2FsZSBpbnN0ZWFkLicsIGdldFNldEdsb2JhbExvY2FsZSk7XG5ob29rcy5sYW5nRGF0YSA9IGRlcHJlY2F0ZSgnbW9tZW50LmxhbmdEYXRhIGlzIGRlcHJlY2F0ZWQuIFVzZSBtb21lbnQubG9jYWxlRGF0YSBpbnN0ZWFkLicsIGdldExvY2FsZSk7XG5pbXBvcnQgJy4vZW4nOyIsImltcG9ydCBpc0FycmF5IGZyb20gJy4uL3V0aWxzL2lzLWFycmF5JztcbmltcG9ydCBoYXNPd25Qcm9wIGZyb20gJy4uL3V0aWxzL2hhcy1vd24tcHJvcCc7XG5pbXBvcnQgaXNVbmRlZmluZWQgZnJvbSAnLi4vdXRpbHMvaXMtdW5kZWZpbmVkJztcbmltcG9ydCBjb21wYXJlQXJyYXlzIGZyb20gJy4uL3V0aWxzL2NvbXBhcmUtYXJyYXlzJztcbmltcG9ydCB7IGRlcHJlY2F0ZVNpbXBsZSB9IGZyb20gJy4uL3V0aWxzL2RlcHJlY2F0ZSc7XG5pbXBvcnQgeyBtZXJnZUNvbmZpZ3MgfSBmcm9tICcuL3NldCc7XG5pbXBvcnQgeyBMb2NhbGUgfSBmcm9tICcuL2NvbnN0cnVjdG9yJztcbmltcG9ydCBrZXlzIGZyb20gJy4uL3V0aWxzL2tleXMnO1xuaW1wb3J0IHsgYmFzZUNvbmZpZyB9IGZyb20gJy4vYmFzZS1jb25maWcnO1xudmFyIGxvY2FsZXMgPSB7fTtcbnZhciBsb2NhbGVGYW1pbGllcyA9IHt9O1xudmFyIGdsb2JhbExvY2FsZTtcblxuZnVuY3Rpb24gbm9ybWFsaXplTG9jYWxlKGtleSkge1xuICByZXR1cm4ga2V5ID8ga2V5LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgnXycsICctJykgOiBrZXk7XG59XG5cbmZ1bmN0aW9uIGNob29zZUxvY2FsZShuYW1lcykge1xuICB2YXIgaSA9IDAsXG4gICAgICBqLFxuICAgICAgbmV4dCxcbiAgICAgIGxvY2FsZSxcbiAgICAgIHNwbGl0O1xuXG4gIHdoaWxlIChpIDwgbmFtZXMubGVuZ3RoKSB7XG4gICAgc3BsaXQgPSBub3JtYWxpemVMb2NhbGUobmFtZXNbaV0pLnNwbGl0KCctJyk7XG4gICAgaiA9IHNwbGl0Lmxlbmd0aDtcbiAgICBuZXh0ID0gbm9ybWFsaXplTG9jYWxlKG5hbWVzW2kgKyAxXSk7XG4gICAgbmV4dCA9IG5leHQgPyBuZXh0LnNwbGl0KCctJykgOiBudWxsO1xuXG4gICAgd2hpbGUgKGogPiAwKSB7XG4gICAgICBsb2NhbGUgPSBsb2FkTG9jYWxlKHNwbGl0LnNsaWNlKDAsIGopLmpvaW4oJy0nKSk7XG5cbiAgICAgIGlmIChsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsZTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5leHQgJiYgbmV4dC5sZW5ndGggPj0gaiAmJiBjb21wYXJlQXJyYXlzKHNwbGl0LCBuZXh0LCB0cnVlKSA+PSBqIC0gMSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgai0tO1xuICAgIH1cblxuICAgIGkrKztcbiAgfVxuXG4gIHJldHVybiBnbG9iYWxMb2NhbGU7XG59XG5cbmZ1bmN0aW9uIGxvYWRMb2NhbGUobmFtZSkge1xuICB2YXIgb2xkTG9jYWxlID0gbnVsbDtcblxuICBpZiAoIWxvY2FsZXNbbmFtZV0gJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgdHJ5IHtcbiAgICAgIG9sZExvY2FsZSA9IGdsb2JhbExvY2FsZS5fYWJicjtcbiAgICAgIHZhciBhbGlhc2VkUmVxdWlyZSA9IHJlcXVpcmU7XG4gICAgICBhbGlhc2VkUmVxdWlyZSgnLi9sb2NhbGUvJyArIG5hbWUpO1xuICAgICAgZ2V0U2V0R2xvYmFsTG9jYWxlKG9sZExvY2FsZSk7XG4gICAgfSBjYXRjaCAoZSkge31cbiAgfVxuXG4gIHJldHVybiBsb2NhbGVzW25hbWVdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2V0R2xvYmFsTG9jYWxlKGtleSwgdmFsdWVzKSB7XG4gIHZhciBkYXRhO1xuXG4gIGlmIChrZXkpIHtcbiAgICBpZiAoaXNVbmRlZmluZWQodmFsdWVzKSkge1xuICAgICAgZGF0YSA9IGdldExvY2FsZShrZXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRhID0gZGVmaW5lTG9jYWxlKGtleSwgdmFsdWVzKTtcbiAgICB9XG5cbiAgICBpZiAoZGF0YSkge1xuICAgICAgZ2xvYmFsTG9jYWxlID0gZGF0YTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLndhcm4pIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdMb2NhbGUgJyArIGtleSArICcgbm90IGZvdW5kLiBEaWQgeW91IGZvcmdldCB0byBsb2FkIGl0PycpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBnbG9iYWxMb2NhbGUuX2FiYnI7XG59XG5leHBvcnQgZnVuY3Rpb24gZGVmaW5lTG9jYWxlKG5hbWUsIGNvbmZpZykge1xuICBpZiAoY29uZmlnICE9PSBudWxsKSB7XG4gICAgdmFyIGxvY2FsZSxcbiAgICAgICAgcGFyZW50Q29uZmlnID0gYmFzZUNvbmZpZztcbiAgICBjb25maWcuYWJiciA9IG5hbWU7XG5cbiAgICBpZiAobG9jYWxlc1tuYW1lXSAhPSBudWxsKSB7XG4gICAgICBkZXByZWNhdGVTaW1wbGUoJ2RlZmluZUxvY2FsZU92ZXJyaWRlJywgJ3VzZSBtb21lbnQudXBkYXRlTG9jYWxlKGxvY2FsZU5hbWUsIGNvbmZpZykgdG8gY2hhbmdlICcgKyAnYW4gZXhpc3RpbmcgbG9jYWxlLiBtb21lbnQuZGVmaW5lTG9jYWxlKGxvY2FsZU5hbWUsICcgKyAnY29uZmlnKSBzaG91bGQgb25seSBiZSB1c2VkIGZvciBjcmVhdGluZyBhIG5ldyBsb2NhbGUgJyArICdTZWUgaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9kZWZpbmUtbG9jYWxlLyBmb3IgbW9yZSBpbmZvLicpO1xuICAgICAgcGFyZW50Q29uZmlnID0gbG9jYWxlc1tuYW1lXS5fY29uZmlnO1xuICAgIH0gZWxzZSBpZiAoY29uZmlnLnBhcmVudExvY2FsZSAhPSBudWxsKSB7XG4gICAgICBpZiAobG9jYWxlc1tjb25maWcucGFyZW50TG9jYWxlXSAhPSBudWxsKSB7XG4gICAgICAgIHBhcmVudENvbmZpZyA9IGxvY2FsZXNbY29uZmlnLnBhcmVudExvY2FsZV0uX2NvbmZpZztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvY2FsZSA9IGxvYWRMb2NhbGUoY29uZmlnLnBhcmVudExvY2FsZSk7XG5cbiAgICAgICAgaWYgKGxvY2FsZSAhPSBudWxsKSB7XG4gICAgICAgICAgcGFyZW50Q29uZmlnID0gbG9jYWxlLl9jb25maWc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCFsb2NhbGVGYW1pbGllc1tjb25maWcucGFyZW50TG9jYWxlXSkge1xuICAgICAgICAgICAgbG9jYWxlRmFtaWxpZXNbY29uZmlnLnBhcmVudExvY2FsZV0gPSBbXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsb2NhbGVGYW1pbGllc1tjb25maWcucGFyZW50TG9jYWxlXS5wdXNoKHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBjb25maWc6IGNvbmZpZ1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgbG9jYWxlc1tuYW1lXSA9IG5ldyBMb2NhbGUobWVyZ2VDb25maWdzKHBhcmVudENvbmZpZywgY29uZmlnKSk7XG5cbiAgICBpZiAobG9jYWxlRmFtaWxpZXNbbmFtZV0pIHtcbiAgICAgIGxvY2FsZUZhbWlsaWVzW25hbWVdLmZvckVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgZGVmaW5lTG9jYWxlKHgubmFtZSwgeC5jb25maWcpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZ2V0U2V0R2xvYmFsTG9jYWxlKG5hbWUpO1xuICAgIHJldHVybiBsb2NhbGVzW25hbWVdO1xuICB9IGVsc2Uge1xuICAgIGRlbGV0ZSBsb2NhbGVzW25hbWVdO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlTG9jYWxlKG5hbWUsIGNvbmZpZykge1xuICBpZiAoY29uZmlnICE9IG51bGwpIHtcbiAgICB2YXIgbG9jYWxlLFxuICAgICAgICB0bXBMb2NhbGUsXG4gICAgICAgIHBhcmVudENvbmZpZyA9IGJhc2VDb25maWc7XG4gICAgdG1wTG9jYWxlID0gbG9hZExvY2FsZShuYW1lKTtcblxuICAgIGlmICh0bXBMb2NhbGUgIT0gbnVsbCkge1xuICAgICAgcGFyZW50Q29uZmlnID0gdG1wTG9jYWxlLl9jb25maWc7XG4gICAgfVxuXG4gICAgY29uZmlnID0gbWVyZ2VDb25maWdzKHBhcmVudENvbmZpZywgY29uZmlnKTtcbiAgICBsb2NhbGUgPSBuZXcgTG9jYWxlKGNvbmZpZyk7XG4gICAgbG9jYWxlLnBhcmVudExvY2FsZSA9IGxvY2FsZXNbbmFtZV07XG4gICAgbG9jYWxlc1tuYW1lXSA9IGxvY2FsZTtcbiAgICBnZXRTZXRHbG9iYWxMb2NhbGUobmFtZSk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKGxvY2FsZXNbbmFtZV0gIT0gbnVsbCkge1xuICAgICAgaWYgKGxvY2FsZXNbbmFtZV0ucGFyZW50TG9jYWxlICE9IG51bGwpIHtcbiAgICAgICAgbG9jYWxlc1tuYW1lXSA9IGxvY2FsZXNbbmFtZV0ucGFyZW50TG9jYWxlO1xuICAgICAgfSBlbHNlIGlmIChsb2NhbGVzW25hbWVdICE9IG51bGwpIHtcbiAgICAgICAgZGVsZXRlIGxvY2FsZXNbbmFtZV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGxvY2FsZXNbbmFtZV07XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9jYWxlKGtleSkge1xuICB2YXIgbG9jYWxlO1xuXG4gIGlmIChrZXkgJiYga2V5Ll9sb2NhbGUgJiYga2V5Ll9sb2NhbGUuX2FiYnIpIHtcbiAgICBrZXkgPSBrZXkuX2xvY2FsZS5fYWJicjtcbiAgfVxuXG4gIGlmICgha2V5KSB7XG4gICAgcmV0dXJuIGdsb2JhbExvY2FsZTtcbiAgfVxuXG4gIGlmICghaXNBcnJheShrZXkpKSB7XG4gICAgbG9jYWxlID0gbG9hZExvY2FsZShrZXkpO1xuXG4gICAgaWYgKGxvY2FsZSkge1xuICAgICAgcmV0dXJuIGxvY2FsZTtcbiAgICB9XG5cbiAgICBrZXkgPSBba2V5XTtcbiAgfVxuXG4gIHJldHVybiBjaG9vc2VMb2NhbGUoa2V5KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBsaXN0TG9jYWxlcygpIHtcbiAgcmV0dXJuIGtleXMobG9jYWxlcyk7XG59IiwiZXhwb3J0IHZhciBkZWZhdWx0T3JkaW5hbCA9ICclZCc7XG5leHBvcnQgdmFyIGRlZmF1bHREYXlPZk1vbnRoT3JkaW5hbFBhcnNlID0gL1xcZHsxLDJ9LztcbmV4cG9ydCBmdW5jdGlvbiBvcmRpbmFsKG51bWJlcikge1xuICByZXR1cm4gdGhpcy5fb3JkaW5hbC5yZXBsYWNlKCclZCcsIG51bWJlcik7XG59IiwiZXhwb3J0IGZ1bmN0aW9uIHByZVBhcnNlUG9zdEZvcm1hdChzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZztcbn0iLCJpbXBvcnQgeyBMb2NhbGUgfSBmcm9tICcuL2NvbnN0cnVjdG9yJztcbnZhciBwcm90byA9IExvY2FsZS5wcm90b3R5cGU7XG5pbXBvcnQgeyBjYWxlbmRhciB9IGZyb20gJy4vY2FsZW5kYXInO1xuaW1wb3J0IHsgbG9uZ0RhdGVGb3JtYXQgfSBmcm9tICcuL2Zvcm1hdHMnO1xuaW1wb3J0IHsgaW52YWxpZERhdGUgfSBmcm9tICcuL2ludmFsaWQnO1xuaW1wb3J0IHsgb3JkaW5hbCB9IGZyb20gJy4vb3JkaW5hbCc7XG5pbXBvcnQgeyBwcmVQYXJzZVBvc3RGb3JtYXQgfSBmcm9tICcuL3ByZS1wb3N0LWZvcm1hdCc7XG5pbXBvcnQgeyByZWxhdGl2ZVRpbWUsIHBhc3RGdXR1cmUgfSBmcm9tICcuL3JlbGF0aXZlJztcbmltcG9ydCB7IHNldCB9IGZyb20gJy4vc2V0JztcbnByb3RvLmNhbGVuZGFyID0gY2FsZW5kYXI7XG5wcm90by5sb25nRGF0ZUZvcm1hdCA9IGxvbmdEYXRlRm9ybWF0O1xucHJvdG8uaW52YWxpZERhdGUgPSBpbnZhbGlkRGF0ZTtcbnByb3RvLm9yZGluYWwgPSBvcmRpbmFsO1xucHJvdG8ucHJlcGFyc2UgPSBwcmVQYXJzZVBvc3RGb3JtYXQ7XG5wcm90by5wb3N0Zm9ybWF0ID0gcHJlUGFyc2VQb3N0Rm9ybWF0O1xucHJvdG8ucmVsYXRpdmVUaW1lID0gcmVsYXRpdmVUaW1lO1xucHJvdG8ucGFzdEZ1dHVyZSA9IHBhc3RGdXR1cmU7XG5wcm90by5zZXQgPSBzZXQ7XG5pbXBvcnQgeyBsb2NhbGVNb250aHNQYXJzZSwgbG9jYWxlTW9udGhzLCBsb2NhbGVNb250aHNTaG9ydCwgbW9udGhzUmVnZXgsIG1vbnRoc1Nob3J0UmVnZXggfSBmcm9tICcuLi91bml0cy9tb250aCc7XG5wcm90by5tb250aHMgPSBsb2NhbGVNb250aHM7XG5wcm90by5tb250aHNTaG9ydCA9IGxvY2FsZU1vbnRoc1Nob3J0O1xucHJvdG8ubW9udGhzUGFyc2UgPSBsb2NhbGVNb250aHNQYXJzZTtcbnByb3RvLm1vbnRoc1JlZ2V4ID0gbW9udGhzUmVnZXg7XG5wcm90by5tb250aHNTaG9ydFJlZ2V4ID0gbW9udGhzU2hvcnRSZWdleDtcbmltcG9ydCB7IGxvY2FsZVdlZWssIGxvY2FsZUZpcnN0RGF5T2ZZZWFyLCBsb2NhbGVGaXJzdERheU9mV2VlayB9IGZyb20gJy4uL3VuaXRzL3dlZWsnO1xucHJvdG8ud2VlayA9IGxvY2FsZVdlZWs7XG5wcm90by5maXJzdERheU9mWWVhciA9IGxvY2FsZUZpcnN0RGF5T2ZZZWFyO1xucHJvdG8uZmlyc3REYXlPZldlZWsgPSBsb2NhbGVGaXJzdERheU9mV2VlaztcbmltcG9ydCB7IGxvY2FsZVdlZWtkYXlzUGFyc2UsIGxvY2FsZVdlZWtkYXlzLCBsb2NhbGVXZWVrZGF5c01pbiwgbG9jYWxlV2Vla2RheXNTaG9ydCwgd2Vla2RheXNSZWdleCwgd2Vla2RheXNTaG9ydFJlZ2V4LCB3ZWVrZGF5c01pblJlZ2V4IH0gZnJvbSAnLi4vdW5pdHMvZGF5LW9mLXdlZWsnO1xucHJvdG8ud2Vla2RheXMgPSBsb2NhbGVXZWVrZGF5cztcbnByb3RvLndlZWtkYXlzTWluID0gbG9jYWxlV2Vla2RheXNNaW47XG5wcm90by53ZWVrZGF5c1Nob3J0ID0gbG9jYWxlV2Vla2RheXNTaG9ydDtcbnByb3RvLndlZWtkYXlzUGFyc2UgPSBsb2NhbGVXZWVrZGF5c1BhcnNlO1xucHJvdG8ud2Vla2RheXNSZWdleCA9IHdlZWtkYXlzUmVnZXg7XG5wcm90by53ZWVrZGF5c1Nob3J0UmVnZXggPSB3ZWVrZGF5c1Nob3J0UmVnZXg7XG5wcm90by53ZWVrZGF5c01pblJlZ2V4ID0gd2Vla2RheXNNaW5SZWdleDtcbmltcG9ydCB7IGxvY2FsZUlzUE0sIGxvY2FsZU1lcmlkaWVtIH0gZnJvbSAnLi4vdW5pdHMvaG91cic7XG5wcm90by5pc1BNID0gbG9jYWxlSXNQTTtcbnByb3RvLm1lcmlkaWVtID0gbG9jYWxlTWVyaWRpZW07IiwiZXhwb3J0IHZhciBkZWZhdWx0UmVsYXRpdmVUaW1lID0ge1xuICBmdXR1cmU6ICdpbiAlcycsXG4gIHBhc3Q6ICclcyBhZ28nLFxuICBzOiAnYSBmZXcgc2Vjb25kcycsXG4gIHNzOiAnJWQgc2Vjb25kcycsXG4gIG06ICdhIG1pbnV0ZScsXG4gIG1tOiAnJWQgbWludXRlcycsXG4gIGg6ICdhbiBob3VyJyxcbiAgaGg6ICclZCBob3VycycsXG4gIGQ6ICdhIGRheScsXG4gIGRkOiAnJWQgZGF5cycsXG4gIE06ICdhIG1vbnRoJyxcbiAgTU06ICclZCBtb250aHMnLFxuICB5OiAnYSB5ZWFyJyxcbiAgeXk6ICclZCB5ZWFycydcbn07XG5pbXBvcnQgaXNGdW5jdGlvbiBmcm9tICcuLi91dGlscy9pcy1mdW5jdGlvbic7XG5leHBvcnQgZnVuY3Rpb24gcmVsYXRpdmVUaW1lKG51bWJlciwgd2l0aG91dFN1ZmZpeCwgc3RyaW5nLCBpc0Z1dHVyZSkge1xuICB2YXIgb3V0cHV0ID0gdGhpcy5fcmVsYXRpdmVUaW1lW3N0cmluZ107XG4gIHJldHVybiBpc0Z1bmN0aW9uKG91dHB1dCkgPyBvdXRwdXQobnVtYmVyLCB3aXRob3V0U3VmZml4LCBzdHJpbmcsIGlzRnV0dXJlKSA6IG91dHB1dC5yZXBsYWNlKC8lZC9pLCBudW1iZXIpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHBhc3RGdXR1cmUoZGlmZiwgb3V0cHV0KSB7XG4gIHZhciBmb3JtYXQgPSB0aGlzLl9yZWxhdGl2ZVRpbWVbZGlmZiA+IDAgPyAnZnV0dXJlJyA6ICdwYXN0J107XG4gIHJldHVybiBpc0Z1bmN0aW9uKGZvcm1hdCkgPyBmb3JtYXQob3V0cHV0KSA6IGZvcm1hdC5yZXBsYWNlKC8lcy9pLCBvdXRwdXQpO1xufSIsImltcG9ydCBpc0Z1bmN0aW9uIGZyb20gJy4uL3V0aWxzL2lzLWZ1bmN0aW9uJztcbmltcG9ydCBleHRlbmQgZnJvbSAnLi4vdXRpbHMvZXh0ZW5kJztcbmltcG9ydCBpc09iamVjdCBmcm9tICcuLi91dGlscy9pcy1vYmplY3QnO1xuaW1wb3J0IGhhc093blByb3AgZnJvbSAnLi4vdXRpbHMvaGFzLW93bi1wcm9wJztcbmV4cG9ydCBmdW5jdGlvbiBzZXQoY29uZmlnKSB7XG4gIHZhciBwcm9wLCBpO1xuXG4gIGZvciAoaSBpbiBjb25maWcpIHtcbiAgICBwcm9wID0gY29uZmlnW2ldO1xuXG4gICAgaWYgKGlzRnVuY3Rpb24ocHJvcCkpIHtcbiAgICAgIHRoaXNbaV0gPSBwcm9wO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzWydfJyArIGldID0gcHJvcDtcbiAgICB9XG4gIH1cblxuICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gIHRoaXMuX2RheU9mTW9udGhPcmRpbmFsUGFyc2VMZW5pZW50ID0gbmV3IFJlZ0V4cCgodGhpcy5fZGF5T2ZNb250aE9yZGluYWxQYXJzZS5zb3VyY2UgfHwgdGhpcy5fb3JkaW5hbFBhcnNlLnNvdXJjZSkgKyAnfCcgKyAvXFxkezEsMn0vLnNvdXJjZSk7XG59XG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VDb25maWdzKHBhcmVudENvbmZpZywgY2hpbGRDb25maWcpIHtcbiAgdmFyIHJlcyA9IGV4dGVuZCh7fSwgcGFyZW50Q29uZmlnKSxcbiAgICAgIHByb3A7XG5cbiAgZm9yIChwcm9wIGluIGNoaWxkQ29uZmlnKSB7XG4gICAgaWYgKGhhc093blByb3AoY2hpbGRDb25maWcsIHByb3ApKSB7XG4gICAgICBpZiAoaXNPYmplY3QocGFyZW50Q29uZmlnW3Byb3BdKSAmJiBpc09iamVjdChjaGlsZENvbmZpZ1twcm9wXSkpIHtcbiAgICAgICAgcmVzW3Byb3BdID0ge307XG4gICAgICAgIGV4dGVuZChyZXNbcHJvcF0sIHBhcmVudENvbmZpZ1twcm9wXSk7XG4gICAgICAgIGV4dGVuZChyZXNbcHJvcF0sIGNoaWxkQ29uZmlnW3Byb3BdKTtcbiAgICAgIH0gZWxzZSBpZiAoY2hpbGRDb25maWdbcHJvcF0gIT0gbnVsbCkge1xuICAgICAgICByZXNbcHJvcF0gPSBjaGlsZENvbmZpZ1twcm9wXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlbGV0ZSByZXNbcHJvcF07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZm9yIChwcm9wIGluIHBhcmVudENvbmZpZykge1xuICAgIGlmIChoYXNPd25Qcm9wKHBhcmVudENvbmZpZywgcHJvcCkgJiYgIWhhc093blByb3AoY2hpbGRDb25maWcsIHByb3ApICYmIGlzT2JqZWN0KHBhcmVudENvbmZpZ1twcm9wXSkpIHtcbiAgICAgIHJlc1twcm9wXSA9IGV4dGVuZCh7fSwgcmVzW3Byb3BdKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzO1xufSIsImltcG9ydCB7IGdldCwgc2V0IH0gZnJvbSAnLi9nZXQtc2V0JztcbmltcG9ydCB7IHNldE1vbnRoIH0gZnJvbSAnLi4vdW5pdHMvbW9udGgnO1xuaW1wb3J0IHsgY3JlYXRlRHVyYXRpb24gfSBmcm9tICcuLi9kdXJhdGlvbi9jcmVhdGUnO1xuaW1wb3J0IHsgZGVwcmVjYXRlU2ltcGxlIH0gZnJvbSAnLi4vdXRpbHMvZGVwcmVjYXRlJztcbmltcG9ydCB7IGhvb2tzIH0gZnJvbSAnLi4vdXRpbHMvaG9va3MnO1xuaW1wb3J0IGFic1JvdW5kIGZyb20gJy4uL3V0aWxzL2Ficy1yb3VuZCc7XG5cbmZ1bmN0aW9uIGNyZWF0ZUFkZGVyKGRpcmVjdGlvbiwgbmFtZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHZhbCwgcGVyaW9kKSB7XG4gICAgdmFyIGR1ciwgdG1wO1xuXG4gICAgaWYgKHBlcmlvZCAhPT0gbnVsbCAmJiAhaXNOYU4oK3BlcmlvZCkpIHtcbiAgICAgIGRlcHJlY2F0ZVNpbXBsZShuYW1lLCAnbW9tZW50KCkuJyArIG5hbWUgKyAnKHBlcmlvZCwgbnVtYmVyKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIG1vbWVudCgpLicgKyBuYW1lICsgJyhudW1iZXIsIHBlcmlvZCkuICcgKyAnU2VlIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3MvYWRkLWludmVydGVkLXBhcmFtLyBmb3IgbW9yZSBpbmZvLicpO1xuICAgICAgdG1wID0gdmFsO1xuICAgICAgdmFsID0gcGVyaW9kO1xuICAgICAgcGVyaW9kID0gdG1wO1xuICAgIH1cblxuICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnID8gK3ZhbCA6IHZhbDtcbiAgICBkdXIgPSBjcmVhdGVEdXJhdGlvbih2YWwsIHBlcmlvZCk7XG4gICAgYWRkU3VidHJhY3QodGhpcywgZHVyLCBkaXJlY3Rpb24pO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkU3VidHJhY3QobW9tLCBkdXJhdGlvbiwgaXNBZGRpbmcsIHVwZGF0ZU9mZnNldCkge1xuICB2YXIgbWlsbGlzZWNvbmRzID0gZHVyYXRpb24uX21pbGxpc2Vjb25kcyxcbiAgICAgIGRheXMgPSBhYnNSb3VuZChkdXJhdGlvbi5fZGF5cyksXG4gICAgICBtb250aHMgPSBhYnNSb3VuZChkdXJhdGlvbi5fbW9udGhzKTtcblxuICBpZiAoIW1vbS5pc1ZhbGlkKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB1cGRhdGVPZmZzZXQgPSB1cGRhdGVPZmZzZXQgPT0gbnVsbCA/IHRydWUgOiB1cGRhdGVPZmZzZXQ7XG5cbiAgaWYgKG1vbnRocykge1xuICAgIHNldE1vbnRoKG1vbSwgZ2V0KG1vbSwgJ01vbnRoJykgKyBtb250aHMgKiBpc0FkZGluZyk7XG4gIH1cblxuICBpZiAoZGF5cykge1xuICAgIHNldChtb20sICdEYXRlJywgZ2V0KG1vbSwgJ0RhdGUnKSArIGRheXMgKiBpc0FkZGluZyk7XG4gIH1cblxuICBpZiAobWlsbGlzZWNvbmRzKSB7XG4gICAgbW9tLl9kLnNldFRpbWUobW9tLl9kLnZhbHVlT2YoKSArIG1pbGxpc2Vjb25kcyAqIGlzQWRkaW5nKTtcbiAgfVxuXG4gIGlmICh1cGRhdGVPZmZzZXQpIHtcbiAgICBob29rcy51cGRhdGVPZmZzZXQobW9tLCBkYXlzIHx8IG1vbnRocyk7XG4gIH1cbn1cbmV4cG9ydCB2YXIgYWRkID0gY3JlYXRlQWRkZXIoMSwgJ2FkZCcpO1xuZXhwb3J0IHZhciBzdWJ0cmFjdCA9IGNyZWF0ZUFkZGVyKC0xLCAnc3VidHJhY3QnKTsiLCJpbXBvcnQgeyBjcmVhdGVMb2NhbCB9IGZyb20gJy4uL2NyZWF0ZS9sb2NhbCc7XG5pbXBvcnQgeyBjbG9uZVdpdGhPZmZzZXQgfSBmcm9tICcuLi91bml0cy9vZmZzZXQnO1xuaW1wb3J0IGlzRnVuY3Rpb24gZnJvbSAnLi4vdXRpbHMvaXMtZnVuY3Rpb24nO1xuaW1wb3J0IHsgaG9va3MgfSBmcm9tICcuLi91dGlscy9ob29rcyc7XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FsZW5kYXJGb3JtYXQobXlNb21lbnQsIG5vdykge1xuICB2YXIgZGlmZiA9IG15TW9tZW50LmRpZmYobm93LCAnZGF5cycsIHRydWUpO1xuICByZXR1cm4gZGlmZiA8IC02ID8gJ3NhbWVFbHNlJyA6IGRpZmYgPCAtMSA/ICdsYXN0V2VlaycgOiBkaWZmIDwgMCA/ICdsYXN0RGF5JyA6IGRpZmYgPCAxID8gJ3NhbWVEYXknIDogZGlmZiA8IDIgPyAnbmV4dERheScgOiBkaWZmIDwgNyA/ICduZXh0V2VlaycgOiAnc2FtZUVsc2UnO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNhbGVuZGFyKHRpbWUsIGZvcm1hdHMpIHtcbiAgdmFyIG5vdyA9IHRpbWUgfHwgY3JlYXRlTG9jYWwoKSxcbiAgICAgIHNvZCA9IGNsb25lV2l0aE9mZnNldChub3csIHRoaXMpLnN0YXJ0T2YoJ2RheScpLFxuICAgICAgZm9ybWF0ID0gaG9va3MuY2FsZW5kYXJGb3JtYXQodGhpcywgc29kKSB8fCAnc2FtZUVsc2UnO1xuICB2YXIgb3V0cHV0ID0gZm9ybWF0cyAmJiAoaXNGdW5jdGlvbihmb3JtYXRzW2Zvcm1hdF0pID8gZm9ybWF0c1tmb3JtYXRdLmNhbGwodGhpcywgbm93KSA6IGZvcm1hdHNbZm9ybWF0XSk7XG4gIHJldHVybiB0aGlzLmZvcm1hdChvdXRwdXQgfHwgdGhpcy5sb2NhbGVEYXRhKCkuY2FsZW5kYXIoZm9ybWF0LCB0aGlzLCBjcmVhdGVMb2NhbChub3cpKSk7XG59IiwiaW1wb3J0IHsgTW9tZW50IH0gZnJvbSAnLi9jb25zdHJ1Y3Rvcic7XG5leHBvcnQgZnVuY3Rpb24gY2xvbmUoKSB7XG4gIHJldHVybiBuZXcgTW9tZW50KHRoaXMpO1xufSIsImltcG9ydCB7IGlzTW9tZW50IH0gZnJvbSAnLi9jb25zdHJ1Y3Rvcic7XG5pbXBvcnQgeyBub3JtYWxpemVVbml0cyB9IGZyb20gJy4uL3VuaXRzL2FsaWFzZXMnO1xuaW1wb3J0IHsgY3JlYXRlTG9jYWwgfSBmcm9tICcuLi9jcmVhdGUvbG9jYWwnO1xuZXhwb3J0IGZ1bmN0aW9uIGlzQWZ0ZXIoaW5wdXQsIHVuaXRzKSB7XG4gIHZhciBsb2NhbElucHV0ID0gaXNNb21lbnQoaW5wdXQpID8gaW5wdXQgOiBjcmVhdGVMb2NhbChpbnB1dCk7XG5cbiAgaWYgKCEodGhpcy5pc1ZhbGlkKCkgJiYgbG9jYWxJbnB1dC5pc1ZhbGlkKCkpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cykgfHwgJ21pbGxpc2Vjb25kJztcblxuICBpZiAodW5pdHMgPT09ICdtaWxsaXNlY29uZCcpIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZU9mKCkgPiBsb2NhbElucHV0LnZhbHVlT2YoKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbG9jYWxJbnB1dC52YWx1ZU9mKCkgPCB0aGlzLmNsb25lKCkuc3RhcnRPZih1bml0cykudmFsdWVPZigpO1xuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gaXNCZWZvcmUoaW5wdXQsIHVuaXRzKSB7XG4gIHZhciBsb2NhbElucHV0ID0gaXNNb21lbnQoaW5wdXQpID8gaW5wdXQgOiBjcmVhdGVMb2NhbChpbnB1dCk7XG5cbiAgaWYgKCEodGhpcy5pc1ZhbGlkKCkgJiYgbG9jYWxJbnB1dC5pc1ZhbGlkKCkpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cykgfHwgJ21pbGxpc2Vjb25kJztcblxuICBpZiAodW5pdHMgPT09ICdtaWxsaXNlY29uZCcpIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZU9mKCkgPCBsb2NhbElucHV0LnZhbHVlT2YoKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdGhpcy5jbG9uZSgpLmVuZE9mKHVuaXRzKS52YWx1ZU9mKCkgPCBsb2NhbElucHV0LnZhbHVlT2YoKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGlzQmV0d2Vlbihmcm9tLCB0bywgdW5pdHMsIGluY2x1c2l2aXR5KSB7XG4gIHZhciBsb2NhbEZyb20gPSBpc01vbWVudChmcm9tKSA/IGZyb20gOiBjcmVhdGVMb2NhbChmcm9tKSxcbiAgICAgIGxvY2FsVG8gPSBpc01vbWVudCh0bykgPyB0byA6IGNyZWF0ZUxvY2FsKHRvKTtcblxuICBpZiAoISh0aGlzLmlzVmFsaWQoKSAmJiBsb2NhbEZyb20uaXNWYWxpZCgpICYmIGxvY2FsVG8uaXNWYWxpZCgpKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGluY2x1c2l2aXR5ID0gaW5jbHVzaXZpdHkgfHwgJygpJztcbiAgcmV0dXJuIChpbmNsdXNpdml0eVswXSA9PT0gJygnID8gdGhpcy5pc0FmdGVyKGxvY2FsRnJvbSwgdW5pdHMpIDogIXRoaXMuaXNCZWZvcmUobG9jYWxGcm9tLCB1bml0cykpICYmIChpbmNsdXNpdml0eVsxXSA9PT0gJyknID8gdGhpcy5pc0JlZm9yZShsb2NhbFRvLCB1bml0cykgOiAhdGhpcy5pc0FmdGVyKGxvY2FsVG8sIHVuaXRzKSk7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNTYW1lKGlucHV0LCB1bml0cykge1xuICB2YXIgbG9jYWxJbnB1dCA9IGlzTW9tZW50KGlucHV0KSA/IGlucHV0IDogY3JlYXRlTG9jYWwoaW5wdXQpLFxuICAgICAgaW5wdXRNcztcblxuICBpZiAoISh0aGlzLmlzVmFsaWQoKSAmJiBsb2NhbElucHV0LmlzVmFsaWQoKSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB1bml0cyA9IG5vcm1hbGl6ZVVuaXRzKHVuaXRzKSB8fCAnbWlsbGlzZWNvbmQnO1xuXG4gIGlmICh1bml0cyA9PT0gJ21pbGxpc2Vjb25kJykge1xuICAgIHJldHVybiB0aGlzLnZhbHVlT2YoKSA9PT0gbG9jYWxJbnB1dC52YWx1ZU9mKCk7XG4gIH0gZWxzZSB7XG4gICAgaW5wdXRNcyA9IGxvY2FsSW5wdXQudmFsdWVPZigpO1xuICAgIHJldHVybiB0aGlzLmNsb25lKCkuc3RhcnRPZih1bml0cykudmFsdWVPZigpIDw9IGlucHV0TXMgJiYgaW5wdXRNcyA8PSB0aGlzLmNsb25lKCkuZW5kT2YodW5pdHMpLnZhbHVlT2YoKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGlzU2FtZU9yQWZ0ZXIoaW5wdXQsIHVuaXRzKSB7XG4gIHJldHVybiB0aGlzLmlzU2FtZShpbnB1dCwgdW5pdHMpIHx8IHRoaXMuaXNBZnRlcihpbnB1dCwgdW5pdHMpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzU2FtZU9yQmVmb3JlKGlucHV0LCB1bml0cykge1xuICByZXR1cm4gdGhpcy5pc1NhbWUoaW5wdXQsIHVuaXRzKSB8fCB0aGlzLmlzQmVmb3JlKGlucHV0LCB1bml0cyk7XG59IiwiaW1wb3J0IHsgaG9va3MgfSBmcm9tICcuLi91dGlscy9ob29rcyc7XG5pbXBvcnQgaGFzT3duUHJvcCBmcm9tICcuLi91dGlscy9oYXMtb3duLXByb3AnO1xuaW1wb3J0IGlzVW5kZWZpbmVkIGZyb20gJy4uL3V0aWxzL2lzLXVuZGVmaW5lZCc7XG5pbXBvcnQgZ2V0UGFyc2luZ0ZsYWdzIGZyb20gJy4uL2NyZWF0ZS9wYXJzaW5nLWZsYWdzJztcbnZhciBtb21lbnRQcm9wZXJ0aWVzID0gaG9va3MubW9tZW50UHJvcGVydGllcyA9IFtdO1xuZXhwb3J0IGZ1bmN0aW9uIGNvcHlDb25maWcodG8sIGZyb20pIHtcbiAgdmFyIGksIHByb3AsIHZhbDtcblxuICBpZiAoIWlzVW5kZWZpbmVkKGZyb20uX2lzQU1vbWVudE9iamVjdCkpIHtcbiAgICB0by5faXNBTW9tZW50T2JqZWN0ID0gZnJvbS5faXNBTW9tZW50T2JqZWN0O1xuICB9XG5cbiAgaWYgKCFpc1VuZGVmaW5lZChmcm9tLl9pKSkge1xuICAgIHRvLl9pID0gZnJvbS5faTtcbiAgfVxuXG4gIGlmICghaXNVbmRlZmluZWQoZnJvbS5fZikpIHtcbiAgICB0by5fZiA9IGZyb20uX2Y7XG4gIH1cblxuICBpZiAoIWlzVW5kZWZpbmVkKGZyb20uX2wpKSB7XG4gICAgdG8uX2wgPSBmcm9tLl9sO1xuICB9XG5cbiAgaWYgKCFpc1VuZGVmaW5lZChmcm9tLl9zdHJpY3QpKSB7XG4gICAgdG8uX3N0cmljdCA9IGZyb20uX3N0cmljdDtcbiAgfVxuXG4gIGlmICghaXNVbmRlZmluZWQoZnJvbS5fdHptKSkge1xuICAgIHRvLl90em0gPSBmcm9tLl90em07XG4gIH1cblxuICBpZiAoIWlzVW5kZWZpbmVkKGZyb20uX2lzVVRDKSkge1xuICAgIHRvLl9pc1VUQyA9IGZyb20uX2lzVVRDO1xuICB9XG5cbiAgaWYgKCFpc1VuZGVmaW5lZChmcm9tLl9vZmZzZXQpKSB7XG4gICAgdG8uX29mZnNldCA9IGZyb20uX29mZnNldDtcbiAgfVxuXG4gIGlmICghaXNVbmRlZmluZWQoZnJvbS5fcGYpKSB7XG4gICAgdG8uX3BmID0gZ2V0UGFyc2luZ0ZsYWdzKGZyb20pO1xuICB9XG5cbiAgaWYgKCFpc1VuZGVmaW5lZChmcm9tLl9sb2NhbGUpKSB7XG4gICAgdG8uX2xvY2FsZSA9IGZyb20uX2xvY2FsZTtcbiAgfVxuXG4gIGlmIChtb21lbnRQcm9wZXJ0aWVzLmxlbmd0aCA+IDApIHtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbW9tZW50UHJvcGVydGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgcHJvcCA9IG1vbWVudFByb3BlcnRpZXNbaV07XG4gICAgICB2YWwgPSBmcm9tW3Byb3BdO1xuXG4gICAgICBpZiAoIWlzVW5kZWZpbmVkKHZhbCkpIHtcbiAgICAgICAgdG9bcHJvcF0gPSB2YWw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRvO1xufVxudmFyIHVwZGF0ZUluUHJvZ3Jlc3MgPSBmYWxzZTtcbmV4cG9ydCBmdW5jdGlvbiBNb21lbnQoY29uZmlnKSB7XG4gIGNvcHlDb25maWcodGhpcywgY29uZmlnKTtcbiAgdGhpcy5fZCA9IG5ldyBEYXRlKGNvbmZpZy5fZCAhPSBudWxsID8gY29uZmlnLl9kLmdldFRpbWUoKSA6IE5hTik7XG5cbiAgaWYgKCF0aGlzLmlzVmFsaWQoKSkge1xuICAgIHRoaXMuX2QgPSBuZXcgRGF0ZShOYU4pO1xuICB9XG5cbiAgaWYgKHVwZGF0ZUluUHJvZ3Jlc3MgPT09IGZhbHNlKSB7XG4gICAgdXBkYXRlSW5Qcm9ncmVzcyA9IHRydWU7XG4gICAgaG9va3MudXBkYXRlT2Zmc2V0KHRoaXMpO1xuICAgIHVwZGF0ZUluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGlzTW9tZW50KG9iaikge1xuICByZXR1cm4gb2JqIGluc3RhbmNlb2YgTW9tZW50IHx8IG9iaiAhPSBudWxsICYmIG9iai5faXNBTW9tZW50T2JqZWN0ICE9IG51bGw7XG59IiwiZXhwb3J0IGZ1bmN0aW9uIGNyZWF0aW9uRGF0YSgpIHtcbiAgcmV0dXJuIHtcbiAgICBpbnB1dDogdGhpcy5faSxcbiAgICBmb3JtYXQ6IHRoaXMuX2YsXG4gICAgbG9jYWxlOiB0aGlzLl9sb2NhbGUsXG4gICAgaXNVVEM6IHRoaXMuX2lzVVRDLFxuICAgIHN0cmljdDogdGhpcy5fc3RyaWN0XG4gIH07XG59IiwiaW1wb3J0IGFic0Zsb29yIGZyb20gJy4uL3V0aWxzL2Ficy1mbG9vcic7XG5pbXBvcnQgeyBjbG9uZVdpdGhPZmZzZXQgfSBmcm9tICcuLi91bml0cy9vZmZzZXQnO1xuaW1wb3J0IHsgbm9ybWFsaXplVW5pdHMgfSBmcm9tICcuLi91bml0cy9hbGlhc2VzJztcbmV4cG9ydCBmdW5jdGlvbiBkaWZmKGlucHV0LCB1bml0cywgYXNGbG9hdCkge1xuICB2YXIgdGhhdCwgem9uZURlbHRhLCBkZWx0YSwgb3V0cHV0O1xuXG4gIGlmICghdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICByZXR1cm4gTmFOO1xuICB9XG5cbiAgdGhhdCA9IGNsb25lV2l0aE9mZnNldChpbnB1dCwgdGhpcyk7XG5cbiAgaWYgKCF0aGF0LmlzVmFsaWQoKSkge1xuICAgIHJldHVybiBOYU47XG4gIH1cblxuICB6b25lRGVsdGEgPSAodGhhdC51dGNPZmZzZXQoKSAtIHRoaXMudXRjT2Zmc2V0KCkpICogNmU0O1xuICB1bml0cyA9IG5vcm1hbGl6ZVVuaXRzKHVuaXRzKTtcblxuICBzd2l0Y2ggKHVuaXRzKSB7XG4gICAgY2FzZSAneWVhcic6XG4gICAgICBvdXRwdXQgPSBtb250aERpZmYodGhpcywgdGhhdCkgLyAxMjtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnbW9udGgnOlxuICAgICAgb3V0cHV0ID0gbW9udGhEaWZmKHRoaXMsIHRoYXQpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdxdWFydGVyJzpcbiAgICAgIG91dHB1dCA9IG1vbnRoRGlmZih0aGlzLCB0aGF0KSAvIDM7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3NlY29uZCc6XG4gICAgICBvdXRwdXQgPSAodGhpcyAtIHRoYXQpIC8gMWUzO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdtaW51dGUnOlxuICAgICAgb3V0cHV0ID0gKHRoaXMgLSB0aGF0KSAvIDZlNDtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnaG91cic6XG4gICAgICBvdXRwdXQgPSAodGhpcyAtIHRoYXQpIC8gMzZlNTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnZGF5JzpcbiAgICAgIG91dHB1dCA9ICh0aGlzIC0gdGhhdCAtIHpvbmVEZWx0YSkgLyA4NjRlNTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnd2Vlayc6XG4gICAgICBvdXRwdXQgPSAodGhpcyAtIHRoYXQgLSB6b25lRGVsdGEpIC8gNjA0OGU1O1xuICAgICAgYnJlYWs7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgb3V0cHV0ID0gdGhpcyAtIHRoYXQ7XG4gIH1cblxuICByZXR1cm4gYXNGbG9hdCA/IG91dHB1dCA6IGFic0Zsb29yKG91dHB1dCk7XG59XG5cbmZ1bmN0aW9uIG1vbnRoRGlmZihhLCBiKSB7XG4gIHZhciB3aG9sZU1vbnRoRGlmZiA9IChiLnllYXIoKSAtIGEueWVhcigpKSAqIDEyICsgKGIubW9udGgoKSAtIGEubW9udGgoKSksXG4gICAgICBhbmNob3IgPSBhLmNsb25lKCkuYWRkKHdob2xlTW9udGhEaWZmLCAnbW9udGhzJyksXG4gICAgICBhbmNob3IyLFxuICAgICAgYWRqdXN0O1xuXG4gIGlmIChiIC0gYW5jaG9yIDwgMCkge1xuICAgIGFuY2hvcjIgPSBhLmNsb25lKCkuYWRkKHdob2xlTW9udGhEaWZmIC0gMSwgJ21vbnRocycpO1xuICAgIGFkanVzdCA9IChiIC0gYW5jaG9yKSAvIChhbmNob3IgLSBhbmNob3IyKTtcbiAgfSBlbHNlIHtcbiAgICBhbmNob3IyID0gYS5jbG9uZSgpLmFkZCh3aG9sZU1vbnRoRGlmZiArIDEsICdtb250aHMnKTtcbiAgICBhZGp1c3QgPSAoYiAtIGFuY2hvcikgLyAoYW5jaG9yMiAtIGFuY2hvcik7XG4gIH1cblxuICByZXR1cm4gLSh3aG9sZU1vbnRoRGlmZiArIGFkanVzdCkgfHwgMDtcbn0iLCJpbXBvcnQgeyBmb3JtYXRNb21lbnQgfSBmcm9tICcuLi9mb3JtYXQvZm9ybWF0JztcbmltcG9ydCB7IGhvb2tzIH0gZnJvbSAnLi4vdXRpbHMvaG9va3MnO1xuaW1wb3J0IGlzRnVuY3Rpb24gZnJvbSAnLi4vdXRpbHMvaXMtZnVuY3Rpb24nO1xuaG9va3MuZGVmYXVsdEZvcm1hdCA9ICdZWVlZLU1NLUREVEhIOm1tOnNzWic7XG5ob29rcy5kZWZhdWx0Rm9ybWF0VXRjID0gJ1lZWVktTU0tRERUSEg6bW06c3NbWl0nO1xuZXhwb3J0IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICByZXR1cm4gdGhpcy5jbG9uZSgpLmxvY2FsZSgnZW4nKS5mb3JtYXQoJ2RkZCBNTU0gREQgWVlZWSBISDptbTpzcyBbR01UXVpaJyk7XG59XG5leHBvcnQgZnVuY3Rpb24gdG9JU09TdHJpbmcoa2VlcE9mZnNldCkge1xuICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB2YXIgdXRjID0ga2VlcE9mZnNldCAhPT0gdHJ1ZTtcbiAgdmFyIG0gPSB1dGMgPyB0aGlzLmNsb25lKCkudXRjKCkgOiB0aGlzO1xuXG4gIGlmIChtLnllYXIoKSA8IDAgfHwgbS55ZWFyKCkgPiA5OTk5KSB7XG4gICAgcmV0dXJuIGZvcm1hdE1vbWVudChtLCB1dGMgPyAnWVlZWVlZLU1NLUREW1RdSEg6bW06c3MuU1NTW1pdJyA6ICdZWVlZWVktTU0tRERbVF1ISDptbTpzcy5TU1NaJyk7XG4gIH1cblxuICBpZiAoaXNGdW5jdGlvbihEYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZykpIHtcbiAgICBpZiAodXRjKSB7XG4gICAgICByZXR1cm4gdGhpcy50b0RhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbmV3IERhdGUodGhpcy52YWx1ZU9mKCkgKyB0aGlzLnV0Y09mZnNldCgpICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpLnJlcGxhY2UoJ1onLCBmb3JtYXRNb21lbnQobSwgJ1onKSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZvcm1hdE1vbWVudChtLCB1dGMgPyAnWVlZWS1NTS1ERFtUXUhIOm1tOnNzLlNTU1taXScgOiAnWVlZWS1NTS1ERFtUXUhIOm1tOnNzLlNTU1onKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpbnNwZWN0KCkge1xuICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuICdtb21lbnQuaW52YWxpZCgvKiAnICsgdGhpcy5faSArICcgKi8pJztcbiAgfVxuXG4gIHZhciBmdW5jID0gJ21vbWVudCc7XG4gIHZhciB6b25lID0gJyc7XG5cbiAgaWYgKCF0aGlzLmlzTG9jYWwoKSkge1xuICAgIGZ1bmMgPSB0aGlzLnV0Y09mZnNldCgpID09PSAwID8gJ21vbWVudC51dGMnIDogJ21vbWVudC5wYXJzZVpvbmUnO1xuICAgIHpvbmUgPSAnWic7XG4gIH1cblxuICB2YXIgcHJlZml4ID0gJ1snICsgZnVuYyArICcoXCJdJztcbiAgdmFyIHllYXIgPSAwIDw9IHRoaXMueWVhcigpICYmIHRoaXMueWVhcigpIDw9IDk5OTkgPyAnWVlZWScgOiAnWVlZWVlZJztcbiAgdmFyIGRhdGV0aW1lID0gJy1NTS1ERFtUXUhIOm1tOnNzLlNTUyc7XG4gIHZhciBzdWZmaXggPSB6b25lICsgJ1tcIildJztcbiAgcmV0dXJuIHRoaXMuZm9ybWF0KHByZWZpeCArIHllYXIgKyBkYXRldGltZSArIHN1ZmZpeCk7XG59XG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0KGlucHV0U3RyaW5nKSB7XG4gIGlmICghaW5wdXRTdHJpbmcpIHtcbiAgICBpbnB1dFN0cmluZyA9IHRoaXMuaXNVdGMoKSA/IGhvb2tzLmRlZmF1bHRGb3JtYXRVdGMgOiBob29rcy5kZWZhdWx0Rm9ybWF0O1xuICB9XG5cbiAgdmFyIG91dHB1dCA9IGZvcm1hdE1vbWVudCh0aGlzLCBpbnB1dFN0cmluZyk7XG4gIHJldHVybiB0aGlzLmxvY2FsZURhdGEoKS5wb3N0Zm9ybWF0KG91dHB1dCk7XG59IiwiaW1wb3J0IHsgY3JlYXRlRHVyYXRpb24gfSBmcm9tICcuLi9kdXJhdGlvbi9jcmVhdGUnO1xuaW1wb3J0IHsgY3JlYXRlTG9jYWwgfSBmcm9tICcuLi9jcmVhdGUvbG9jYWwnO1xuaW1wb3J0IHsgaXNNb21lbnQgfSBmcm9tICcuLi9tb21lbnQvY29uc3RydWN0b3InO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb20odGltZSwgd2l0aG91dFN1ZmZpeCkge1xuICBpZiAodGhpcy5pc1ZhbGlkKCkgJiYgKGlzTW9tZW50KHRpbWUpICYmIHRpbWUuaXNWYWxpZCgpIHx8IGNyZWF0ZUxvY2FsKHRpbWUpLmlzVmFsaWQoKSkpIHtcbiAgICByZXR1cm4gY3JlYXRlRHVyYXRpb24oe1xuICAgICAgdG86IHRoaXMsXG4gICAgICBmcm9tOiB0aW1lXG4gICAgfSkubG9jYWxlKHRoaXMubG9jYWxlKCkpLmh1bWFuaXplKCF3aXRob3V0U3VmZml4KTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGZyb21Ob3cod2l0aG91dFN1ZmZpeCkge1xuICByZXR1cm4gdGhpcy5mcm9tKGNyZWF0ZUxvY2FsKCksIHdpdGhvdXRTdWZmaXgpO1xufSIsImltcG9ydCB7IG5vcm1hbGl6ZVVuaXRzLCBub3JtYWxpemVPYmplY3RVbml0cyB9IGZyb20gJy4uL3VuaXRzL2FsaWFzZXMnO1xuaW1wb3J0IHsgZ2V0UHJpb3JpdGl6ZWRVbml0cyB9IGZyb20gJy4uL3VuaXRzL3ByaW9yaXRpZXMnO1xuaW1wb3J0IHsgaG9va3MgfSBmcm9tICcuLi91dGlscy9ob29rcyc7XG5pbXBvcnQgaXNGdW5jdGlvbiBmcm9tICcuLi91dGlscy9pcy1mdW5jdGlvbic7XG5pbXBvcnQgeyBkYXlzSW5Nb250aCB9IGZyb20gJy4uL3VuaXRzL21vbnRoJztcbmltcG9ydCB7IGlzTGVhcFllYXIgfSBmcm9tICcuLi91bml0cy95ZWFyJztcbmV4cG9ydCBmdW5jdGlvbiBtYWtlR2V0U2V0KHVuaXQsIGtlZXBUaW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgc2V0KHRoaXMsIHVuaXQsIHZhbHVlKTtcbiAgICAgIGhvb2tzLnVwZGF0ZU9mZnNldCh0aGlzLCBrZWVwVGltZSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGdldCh0aGlzLCB1bml0KTtcbiAgICB9XG4gIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0KG1vbSwgdW5pdCkge1xuICByZXR1cm4gbW9tLmlzVmFsaWQoKSA/IG1vbS5fZFsnZ2V0JyArIChtb20uX2lzVVRDID8gJ1VUQycgOiAnJykgKyB1bml0XSgpIDogTmFOO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHNldChtb20sIHVuaXQsIHZhbHVlKSB7XG4gIGlmIChtb20uaXNWYWxpZCgpICYmICFpc05hTih2YWx1ZSkpIHtcbiAgICBpZiAodW5pdCA9PT0gJ0Z1bGxZZWFyJyAmJiBpc0xlYXBZZWFyKG1vbS55ZWFyKCkpICYmIG1vbS5tb250aCgpID09PSAxICYmIG1vbS5kYXRlKCkgPT09IDI5KSB7XG4gICAgICBtb20uX2RbJ3NldCcgKyAobW9tLl9pc1VUQyA/ICdVVEMnIDogJycpICsgdW5pdF0odmFsdWUsIG1vbS5tb250aCgpLCBkYXlzSW5Nb250aCh2YWx1ZSwgbW9tLm1vbnRoKCkpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbW9tLl9kWydzZXQnICsgKG1vbS5faXNVVEMgPyAnVVRDJyA6ICcnKSArIHVuaXRdKHZhbHVlKTtcbiAgICB9XG4gIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdHZXQodW5pdHMpIHtcbiAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cyk7XG5cbiAgaWYgKGlzRnVuY3Rpb24odGhpc1t1bml0c10pKSB7XG4gICAgcmV0dXJuIHRoaXNbdW5pdHNdKCk7XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn1cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdTZXQodW5pdHMsIHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdW5pdHMgPT09ICdvYmplY3QnKSB7XG4gICAgdW5pdHMgPSBub3JtYWxpemVPYmplY3RVbml0cyh1bml0cyk7XG4gICAgdmFyIHByaW9yaXRpemVkID0gZ2V0UHJpb3JpdGl6ZWRVbml0cyh1bml0cyk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByaW9yaXRpemVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzW3ByaW9yaXRpemVkW2ldLnVuaXRdKHVuaXRzW3ByaW9yaXRpemVkW2ldLnVuaXRdKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cyk7XG5cbiAgICBpZiAoaXNGdW5jdGlvbih0aGlzW3VuaXRzXSkpIHtcbiAgICAgIHJldHVybiB0aGlzW3VuaXRzXSh2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59IiwiaW1wb3J0IHsgZ2V0TG9jYWxlIH0gZnJvbSAnLi4vbG9jYWxlL2xvY2FsZXMnO1xuaW1wb3J0IHsgZGVwcmVjYXRlIH0gZnJvbSAnLi4vdXRpbHMvZGVwcmVjYXRlJztcbmV4cG9ydCBmdW5jdGlvbiBsb2NhbGUoa2V5KSB7XG4gIHZhciBuZXdMb2NhbGVEYXRhO1xuXG4gIGlmIChrZXkgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB0aGlzLl9sb2NhbGUuX2FiYnI7XG4gIH0gZWxzZSB7XG4gICAgbmV3TG9jYWxlRGF0YSA9IGdldExvY2FsZShrZXkpO1xuXG4gICAgaWYgKG5ld0xvY2FsZURhdGEgIT0gbnVsbCkge1xuICAgICAgdGhpcy5fbG9jYWxlID0gbmV3TG9jYWxlRGF0YTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxufVxuZXhwb3J0IHZhciBsYW5nID0gZGVwcmVjYXRlKCdtb21lbnQoKS5sYW5nKCkgaXMgZGVwcmVjYXRlZC4gSW5zdGVhZCwgdXNlIG1vbWVudCgpLmxvY2FsZURhdGEoKSB0byBnZXQgdGhlIGxhbmd1YWdlIGNvbmZpZ3VyYXRpb24uIFVzZSBtb21lbnQoKS5sb2NhbGUoKSB0byBjaGFuZ2UgbGFuZ3VhZ2VzLicsIGZ1bmN0aW9uIChrZXkpIHtcbiAgaWYgKGtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB0aGlzLmxvY2FsZShrZXkpO1xuICB9XG59KTtcbmV4cG9ydCBmdW5jdGlvbiBsb2NhbGVEYXRhKCkge1xuICByZXR1cm4gdGhpcy5fbG9jYWxlO1xufSIsImltcG9ydCB7IGRlcHJlY2F0ZSB9IGZyb20gJy4uL3V0aWxzL2RlcHJlY2F0ZSc7XG5pbXBvcnQgaXNBcnJheSBmcm9tICcuLi91dGlscy9pcy1hcnJheSc7XG5pbXBvcnQgeyBjcmVhdGVMb2NhbCB9IGZyb20gJy4uL2NyZWF0ZS9sb2NhbCc7XG5pbXBvcnQgeyBjcmVhdGVJbnZhbGlkIH0gZnJvbSAnLi4vY3JlYXRlL3ZhbGlkJztcbmV4cG9ydCB2YXIgcHJvdG90eXBlTWluID0gZGVwcmVjYXRlKCdtb21lbnQoKS5taW4gaXMgZGVwcmVjYXRlZCwgdXNlIG1vbWVudC5tYXggaW5zdGVhZC4gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9taW4tbWF4LycsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIG90aGVyID0gY3JlYXRlTG9jYWwuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcblxuICBpZiAodGhpcy5pc1ZhbGlkKCkgJiYgb3RoZXIuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIG90aGVyIDwgdGhpcyA/IHRoaXMgOiBvdGhlcjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gY3JlYXRlSW52YWxpZCgpO1xuICB9XG59KTtcbmV4cG9ydCB2YXIgcHJvdG90eXBlTWF4ID0gZGVwcmVjYXRlKCdtb21lbnQoKS5tYXggaXMgZGVwcmVjYXRlZCwgdXNlIG1vbWVudC5taW4gaW5zdGVhZC4gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9taW4tbWF4LycsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIG90aGVyID0gY3JlYXRlTG9jYWwuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcblxuICBpZiAodGhpcy5pc1ZhbGlkKCkgJiYgb3RoZXIuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIG90aGVyID4gdGhpcyA/IHRoaXMgOiBvdGhlcjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gY3JlYXRlSW52YWxpZCgpO1xuICB9XG59KTtcblxuZnVuY3Rpb24gcGlja0J5KGZuLCBtb21lbnRzKSB7XG4gIHZhciByZXMsIGk7XG5cbiAgaWYgKG1vbWVudHMubGVuZ3RoID09PSAxICYmIGlzQXJyYXkobW9tZW50c1swXSkpIHtcbiAgICBtb21lbnRzID0gbW9tZW50c1swXTtcbiAgfVxuXG4gIGlmICghbW9tZW50cy5sZW5ndGgpIHtcbiAgICByZXR1cm4gY3JlYXRlTG9jYWwoKTtcbiAgfVxuXG4gIHJlcyA9IG1vbWVudHNbMF07XG5cbiAgZm9yIChpID0gMTsgaSA8IG1vbWVudHMubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoIW1vbWVudHNbaV0uaXNWYWxpZCgpIHx8IG1vbWVudHNbaV1bZm5dKHJlcykpIHtcbiAgICAgIHJlcyA9IG1vbWVudHNbaV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1pbigpIHtcbiAgdmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG4gIHJldHVybiBwaWNrQnkoJ2lzQmVmb3JlJywgYXJncyk7XG59XG5leHBvcnQgZnVuY3Rpb24gbWF4KCkge1xuICB2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKTtcbiAgcmV0dXJuIHBpY2tCeSgnaXNBZnRlcicsIGFyZ3MpO1xufSIsImltcG9ydCB7IGNyZWF0ZUxvY2FsIH0gZnJvbSAnLi4vY3JlYXRlL2xvY2FsJztcbmltcG9ydCB7IGNyZWF0ZVVUQyB9IGZyb20gJy4uL2NyZWF0ZS91dGMnO1xuaW1wb3J0IHsgY3JlYXRlSW52YWxpZCB9IGZyb20gJy4uL2NyZWF0ZS92YWxpZCc7XG5pbXBvcnQgeyBpc01vbWVudCB9IGZyb20gJy4vY29uc3RydWN0b3InO1xuaW1wb3J0IHsgbWluLCBtYXggfSBmcm9tICcuL21pbi1tYXgnO1xuaW1wb3J0IHsgbm93IH0gZnJvbSAnLi9ub3cnO1xuaW1wb3J0IG1vbWVudFByb3RvdHlwZSBmcm9tICcuL3Byb3RvdHlwZSc7XG5cbmZ1bmN0aW9uIGNyZWF0ZVVuaXgoaW5wdXQpIHtcbiAgcmV0dXJuIGNyZWF0ZUxvY2FsKGlucHV0ICogMTAwMCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUluWm9uZSgpIHtcbiAgcmV0dXJuIGNyZWF0ZUxvY2FsLmFwcGx5KG51bGwsIGFyZ3VtZW50cykucGFyc2Vab25lKCk7XG59XG5cbmV4cG9ydCB7IG5vdywgbWluLCBtYXgsIGlzTW9tZW50LCBjcmVhdGVVVEMsIGNyZWF0ZVVuaXgsIGNyZWF0ZUxvY2FsLCBjcmVhdGVJblpvbmUsIGNyZWF0ZUludmFsaWQsIG1vbWVudFByb3RvdHlwZSB9OyIsImV4cG9ydCB2YXIgbm93ID0gZnVuY3Rpb24gbm93KCkge1xuICByZXR1cm4gRGF0ZS5ub3cgPyBEYXRlLm5vdygpIDogK25ldyBEYXRlKCk7XG59OyIsImltcG9ydCB7IE1vbWVudCB9IGZyb20gJy4vY29uc3RydWN0b3InO1xudmFyIHByb3RvID0gTW9tZW50LnByb3RvdHlwZTtcbmltcG9ydCB7IGFkZCwgc3VidHJhY3QgfSBmcm9tICcuL2FkZC1zdWJ0cmFjdCc7XG5pbXBvcnQgeyBjYWxlbmRhciwgZ2V0Q2FsZW5kYXJGb3JtYXQgfSBmcm9tICcuL2NhbGVuZGFyJztcbmltcG9ydCB7IGNsb25lIH0gZnJvbSAnLi9jbG9uZSc7XG5pbXBvcnQgeyBpc0JlZm9yZSwgaXNCZXR3ZWVuLCBpc1NhbWUsIGlzQWZ0ZXIsIGlzU2FtZU9yQWZ0ZXIsIGlzU2FtZU9yQmVmb3JlIH0gZnJvbSAnLi9jb21wYXJlJztcbmltcG9ydCB7IGRpZmYgfSBmcm9tICcuL2RpZmYnO1xuaW1wb3J0IHsgZm9ybWF0LCB0b1N0cmluZywgdG9JU09TdHJpbmcsIGluc3BlY3QgfSBmcm9tICcuL2Zvcm1hdCc7XG5pbXBvcnQgeyBmcm9tLCBmcm9tTm93IH0gZnJvbSAnLi9mcm9tJztcbmltcG9ydCB7IHRvLCB0b05vdyB9IGZyb20gJy4vdG8nO1xuaW1wb3J0IHsgc3RyaW5nR2V0LCBzdHJpbmdTZXQgfSBmcm9tICcuL2dldC1zZXQnO1xuaW1wb3J0IHsgbG9jYWxlLCBsb2NhbGVEYXRhLCBsYW5nIH0gZnJvbSAnLi9sb2NhbGUnO1xuaW1wb3J0IHsgcHJvdG90eXBlTWluLCBwcm90b3R5cGVNYXggfSBmcm9tICcuL21pbi1tYXgnO1xuaW1wb3J0IHsgc3RhcnRPZiwgZW5kT2YgfSBmcm9tICcuL3N0YXJ0LWVuZC1vZic7XG5pbXBvcnQgeyB2YWx1ZU9mLCB0b0RhdGUsIHRvQXJyYXksIHRvT2JqZWN0LCB0b0pTT04sIHVuaXggfSBmcm9tICcuL3RvLXR5cGUnO1xuaW1wb3J0IHsgaXNWYWxpZCwgcGFyc2luZ0ZsYWdzLCBpbnZhbGlkQXQgfSBmcm9tICcuL3ZhbGlkJztcbmltcG9ydCB7IGNyZWF0aW9uRGF0YSB9IGZyb20gJy4vY3JlYXRpb24tZGF0YSc7XG5wcm90by5hZGQgPSBhZGQ7XG5wcm90by5jYWxlbmRhciA9IGNhbGVuZGFyO1xucHJvdG8uY2xvbmUgPSBjbG9uZTtcbnByb3RvLmRpZmYgPSBkaWZmO1xucHJvdG8uZW5kT2YgPSBlbmRPZjtcbnByb3RvLmZvcm1hdCA9IGZvcm1hdDtcbnByb3RvLmZyb20gPSBmcm9tO1xucHJvdG8uZnJvbU5vdyA9IGZyb21Ob3c7XG5wcm90by50byA9IHRvO1xucHJvdG8udG9Ob3cgPSB0b05vdztcbnByb3RvLmdldCA9IHN0cmluZ0dldDtcbnByb3RvLmludmFsaWRBdCA9IGludmFsaWRBdDtcbnByb3RvLmlzQWZ0ZXIgPSBpc0FmdGVyO1xucHJvdG8uaXNCZWZvcmUgPSBpc0JlZm9yZTtcbnByb3RvLmlzQmV0d2VlbiA9IGlzQmV0d2VlbjtcbnByb3RvLmlzU2FtZSA9IGlzU2FtZTtcbnByb3RvLmlzU2FtZU9yQWZ0ZXIgPSBpc1NhbWVPckFmdGVyO1xucHJvdG8uaXNTYW1lT3JCZWZvcmUgPSBpc1NhbWVPckJlZm9yZTtcbnByb3RvLmlzVmFsaWQgPSBpc1ZhbGlkO1xucHJvdG8ubGFuZyA9IGxhbmc7XG5wcm90by5sb2NhbGUgPSBsb2NhbGU7XG5wcm90by5sb2NhbGVEYXRhID0gbG9jYWxlRGF0YTtcbnByb3RvLm1heCA9IHByb3RvdHlwZU1heDtcbnByb3RvLm1pbiA9IHByb3RvdHlwZU1pbjtcbnByb3RvLnBhcnNpbmdGbGFncyA9IHBhcnNpbmdGbGFncztcbnByb3RvLnNldCA9IHN0cmluZ1NldDtcbnByb3RvLnN0YXJ0T2YgPSBzdGFydE9mO1xucHJvdG8uc3VidHJhY3QgPSBzdWJ0cmFjdDtcbnByb3RvLnRvQXJyYXkgPSB0b0FycmF5O1xucHJvdG8udG9PYmplY3QgPSB0b09iamVjdDtcbnByb3RvLnRvRGF0ZSA9IHRvRGF0ZTtcbnByb3RvLnRvSVNPU3RyaW5nID0gdG9JU09TdHJpbmc7XG5wcm90by5pbnNwZWN0ID0gaW5zcGVjdDtcbnByb3RvLnRvSlNPTiA9IHRvSlNPTjtcbnByb3RvLnRvU3RyaW5nID0gdG9TdHJpbmc7XG5wcm90by51bml4ID0gdW5peDtcbnByb3RvLnZhbHVlT2YgPSB2YWx1ZU9mO1xucHJvdG8uY3JlYXRpb25EYXRhID0gY3JlYXRpb25EYXRhO1xuaW1wb3J0IHsgZ2V0U2V0WWVhciwgZ2V0SXNMZWFwWWVhciB9IGZyb20gJy4uL3VuaXRzL3llYXInO1xucHJvdG8ueWVhciA9IGdldFNldFllYXI7XG5wcm90by5pc0xlYXBZZWFyID0gZ2V0SXNMZWFwWWVhcjtcbmltcG9ydCB7IGdldFNldFdlZWtZZWFyLCBnZXRTZXRJU09XZWVrWWVhciwgZ2V0V2Vla3NJblllYXIsIGdldElTT1dlZWtzSW5ZZWFyIH0gZnJvbSAnLi4vdW5pdHMvd2Vlay15ZWFyJztcbnByb3RvLndlZWtZZWFyID0gZ2V0U2V0V2Vla1llYXI7XG5wcm90by5pc29XZWVrWWVhciA9IGdldFNldElTT1dlZWtZZWFyO1xuaW1wb3J0IHsgZ2V0U2V0UXVhcnRlciB9IGZyb20gJy4uL3VuaXRzL3F1YXJ0ZXInO1xucHJvdG8ucXVhcnRlciA9IHByb3RvLnF1YXJ0ZXJzID0gZ2V0U2V0UXVhcnRlcjtcbmltcG9ydCB7IGdldFNldE1vbnRoLCBnZXREYXlzSW5Nb250aCB9IGZyb20gJy4uL3VuaXRzL21vbnRoJztcbnByb3RvLm1vbnRoID0gZ2V0U2V0TW9udGg7XG5wcm90by5kYXlzSW5Nb250aCA9IGdldERheXNJbk1vbnRoO1xuaW1wb3J0IHsgZ2V0U2V0V2VlaywgZ2V0U2V0SVNPV2VlayB9IGZyb20gJy4uL3VuaXRzL3dlZWsnO1xucHJvdG8ud2VlayA9IHByb3RvLndlZWtzID0gZ2V0U2V0V2VlaztcbnByb3RvLmlzb1dlZWsgPSBwcm90by5pc29XZWVrcyA9IGdldFNldElTT1dlZWs7XG5wcm90by53ZWVrc0luWWVhciA9IGdldFdlZWtzSW5ZZWFyO1xucHJvdG8uaXNvV2Vla3NJblllYXIgPSBnZXRJU09XZWVrc0luWWVhcjtcbmltcG9ydCB7IGdldFNldERheU9mTW9udGggfSBmcm9tICcuLi91bml0cy9kYXktb2YtbW9udGgnO1xuaW1wb3J0IHsgZ2V0U2V0RGF5T2ZXZWVrLCBnZXRTZXRJU09EYXlPZldlZWssIGdldFNldExvY2FsZURheU9mV2VlayB9IGZyb20gJy4uL3VuaXRzL2RheS1vZi13ZWVrJztcbmltcG9ydCB7IGdldFNldERheU9mWWVhciB9IGZyb20gJy4uL3VuaXRzL2RheS1vZi15ZWFyJztcbnByb3RvLmRhdGUgPSBnZXRTZXREYXlPZk1vbnRoO1xucHJvdG8uZGF5ID0gcHJvdG8uZGF5cyA9IGdldFNldERheU9mV2VlaztcbnByb3RvLndlZWtkYXkgPSBnZXRTZXRMb2NhbGVEYXlPZldlZWs7XG5wcm90by5pc29XZWVrZGF5ID0gZ2V0U2V0SVNPRGF5T2ZXZWVrO1xucHJvdG8uZGF5T2ZZZWFyID0gZ2V0U2V0RGF5T2ZZZWFyO1xuaW1wb3J0IHsgZ2V0U2V0SG91ciB9IGZyb20gJy4uL3VuaXRzL2hvdXInO1xucHJvdG8uaG91ciA9IHByb3RvLmhvdXJzID0gZ2V0U2V0SG91cjtcbmltcG9ydCB7IGdldFNldE1pbnV0ZSB9IGZyb20gJy4uL3VuaXRzL21pbnV0ZSc7XG5wcm90by5taW51dGUgPSBwcm90by5taW51dGVzID0gZ2V0U2V0TWludXRlO1xuaW1wb3J0IHsgZ2V0U2V0U2Vjb25kIH0gZnJvbSAnLi4vdW5pdHMvc2Vjb25kJztcbnByb3RvLnNlY29uZCA9IHByb3RvLnNlY29uZHMgPSBnZXRTZXRTZWNvbmQ7XG5pbXBvcnQgeyBnZXRTZXRNaWxsaXNlY29uZCB9IGZyb20gJy4uL3VuaXRzL21pbGxpc2Vjb25kJztcbnByb3RvLm1pbGxpc2Vjb25kID0gcHJvdG8ubWlsbGlzZWNvbmRzID0gZ2V0U2V0TWlsbGlzZWNvbmQ7XG5pbXBvcnQgeyBnZXRTZXRPZmZzZXQsIHNldE9mZnNldFRvVVRDLCBzZXRPZmZzZXRUb0xvY2FsLCBzZXRPZmZzZXRUb1BhcnNlZE9mZnNldCwgaGFzQWxpZ25lZEhvdXJPZmZzZXQsIGlzRGF5bGlnaHRTYXZpbmdUaW1lLCBpc0RheWxpZ2h0U2F2aW5nVGltZVNoaWZ0ZWQsIGdldFNldFpvbmUsIGlzTG9jYWwsIGlzVXRjT2Zmc2V0LCBpc1V0YyB9IGZyb20gJy4uL3VuaXRzL29mZnNldCc7XG5wcm90by51dGNPZmZzZXQgPSBnZXRTZXRPZmZzZXQ7XG5wcm90by51dGMgPSBzZXRPZmZzZXRUb1VUQztcbnByb3RvLmxvY2FsID0gc2V0T2Zmc2V0VG9Mb2NhbDtcbnByb3RvLnBhcnNlWm9uZSA9IHNldE9mZnNldFRvUGFyc2VkT2Zmc2V0O1xucHJvdG8uaGFzQWxpZ25lZEhvdXJPZmZzZXQgPSBoYXNBbGlnbmVkSG91ck9mZnNldDtcbnByb3RvLmlzRFNUID0gaXNEYXlsaWdodFNhdmluZ1RpbWU7XG5wcm90by5pc0xvY2FsID0gaXNMb2NhbDtcbnByb3RvLmlzVXRjT2Zmc2V0ID0gaXNVdGNPZmZzZXQ7XG5wcm90by5pc1V0YyA9IGlzVXRjO1xucHJvdG8uaXNVVEMgPSBpc1V0YztcbmltcG9ydCB7IGdldFpvbmVBYmJyLCBnZXRab25lTmFtZSB9IGZyb20gJy4uL3VuaXRzL3RpbWV6b25lJztcbnByb3RvLnpvbmVBYmJyID0gZ2V0Wm9uZUFiYnI7XG5wcm90by56b25lTmFtZSA9IGdldFpvbmVOYW1lO1xuaW1wb3J0IHsgZGVwcmVjYXRlIH0gZnJvbSAnLi4vdXRpbHMvZGVwcmVjYXRlJztcbnByb3RvLmRhdGVzID0gZGVwcmVjYXRlKCdkYXRlcyBhY2Nlc3NvciBpcyBkZXByZWNhdGVkLiBVc2UgZGF0ZSBpbnN0ZWFkLicsIGdldFNldERheU9mTW9udGgpO1xucHJvdG8ubW9udGhzID0gZGVwcmVjYXRlKCdtb250aHMgYWNjZXNzb3IgaXMgZGVwcmVjYXRlZC4gVXNlIG1vbnRoIGluc3RlYWQnLCBnZXRTZXRNb250aCk7XG5wcm90by55ZWFycyA9IGRlcHJlY2F0ZSgneWVhcnMgYWNjZXNzb3IgaXMgZGVwcmVjYXRlZC4gVXNlIHllYXIgaW5zdGVhZCcsIGdldFNldFllYXIpO1xucHJvdG8uem9uZSA9IGRlcHJlY2F0ZSgnbW9tZW50KCkuem9uZSBpcyBkZXByZWNhdGVkLCB1c2UgbW9tZW50KCkudXRjT2Zmc2V0IGluc3RlYWQuIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3Mvem9uZS8nLCBnZXRTZXRab25lKTtcbnByb3RvLmlzRFNUU2hpZnRlZCA9IGRlcHJlY2F0ZSgnaXNEU1RTaGlmdGVkIGlzIGRlcHJlY2F0ZWQuIFNlZSBodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL2RzdC1zaGlmdGVkLyBmb3IgbW9yZSBpbmZvcm1hdGlvbicsIGlzRGF5bGlnaHRTYXZpbmdUaW1lU2hpZnRlZCk7XG5leHBvcnQgZGVmYXVsdCBwcm90bzsiLCJpbXBvcnQgeyBub3JtYWxpemVVbml0cyB9IGZyb20gJy4uL3VuaXRzL2FsaWFzZXMnO1xuaW1wb3J0IHsgaG9va3MgfSBmcm9tICcuLi91dGlscy9ob29rcyc7XG52YXIgTVNfUEVSX1NFQ09ORCA9IDEwMDA7XG52YXIgTVNfUEVSX01JTlVURSA9IDYwICogTVNfUEVSX1NFQ09ORDtcbnZhciBNU19QRVJfSE9VUiA9IDYwICogTVNfUEVSX01JTlVURTtcbnZhciBNU19QRVJfNDAwX1lFQVJTID0gKDM2NSAqIDQwMCArIDk3KSAqIDI0ICogTVNfUEVSX0hPVVI7XG5cbmZ1bmN0aW9uIG1vZChkaXZpZGVuZCwgZGl2aXNvcikge1xuICByZXR1cm4gKGRpdmlkZW5kICUgZGl2aXNvciArIGRpdmlzb3IpICUgZGl2aXNvcjtcbn1cblxuZnVuY3Rpb24gbG9jYWxTdGFydE9mRGF0ZSh5LCBtLCBkKSB7XG4gIGlmICh5IDwgMTAwICYmIHkgPj0gMCkge1xuICAgIHJldHVybiBuZXcgRGF0ZSh5ICsgNDAwLCBtLCBkKSAtIE1TX1BFUl80MDBfWUVBUlM7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKHksIG0sIGQpLnZhbHVlT2YoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiB1dGNTdGFydE9mRGF0ZSh5LCBtLCBkKSB7XG4gIGlmICh5IDwgMTAwICYmIHkgPj0gMCkge1xuICAgIHJldHVybiBEYXRlLlVUQyh5ICsgNDAwLCBtLCBkKSAtIE1TX1BFUl80MDBfWUVBUlM7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIERhdGUuVVRDKHksIG0sIGQpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdGFydE9mKHVuaXRzKSB7XG4gIHZhciB0aW1lO1xuICB1bml0cyA9IG5vcm1hbGl6ZVVuaXRzKHVuaXRzKTtcblxuICBpZiAodW5pdHMgPT09IHVuZGVmaW5lZCB8fCB1bml0cyA9PT0gJ21pbGxpc2Vjb25kJyB8fCAhdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHZhciBzdGFydE9mRGF0ZSA9IHRoaXMuX2lzVVRDID8gdXRjU3RhcnRPZkRhdGUgOiBsb2NhbFN0YXJ0T2ZEYXRlO1xuXG4gIHN3aXRjaCAodW5pdHMpIHtcbiAgICBjYXNlICd5ZWFyJzpcbiAgICAgIHRpbWUgPSBzdGFydE9mRGF0ZSh0aGlzLnllYXIoKSwgMCwgMSk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3F1YXJ0ZXInOlxuICAgICAgdGltZSA9IHN0YXJ0T2ZEYXRlKHRoaXMueWVhcigpLCB0aGlzLm1vbnRoKCkgLSB0aGlzLm1vbnRoKCkgJSAzLCAxKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnbW9udGgnOlxuICAgICAgdGltZSA9IHN0YXJ0T2ZEYXRlKHRoaXMueWVhcigpLCB0aGlzLm1vbnRoKCksIDEpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICd3ZWVrJzpcbiAgICAgIHRpbWUgPSBzdGFydE9mRGF0ZSh0aGlzLnllYXIoKSwgdGhpcy5tb250aCgpLCB0aGlzLmRhdGUoKSAtIHRoaXMud2Vla2RheSgpKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnaXNvV2Vlayc6XG4gICAgICB0aW1lID0gc3RhcnRPZkRhdGUodGhpcy55ZWFyKCksIHRoaXMubW9udGgoKSwgdGhpcy5kYXRlKCkgLSAodGhpcy5pc29XZWVrZGF5KCkgLSAxKSk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ2RheSc6XG4gICAgY2FzZSAnZGF0ZSc6XG4gICAgICB0aW1lID0gc3RhcnRPZkRhdGUodGhpcy55ZWFyKCksIHRoaXMubW9udGgoKSwgdGhpcy5kYXRlKCkpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdob3VyJzpcbiAgICAgIHRpbWUgPSB0aGlzLl9kLnZhbHVlT2YoKTtcbiAgICAgIHRpbWUgLT0gbW9kKHRpbWUgKyAodGhpcy5faXNVVEMgPyAwIDogdGhpcy51dGNPZmZzZXQoKSAqIE1TX1BFUl9NSU5VVEUpLCBNU19QRVJfSE9VUik7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ21pbnV0ZSc6XG4gICAgICB0aW1lID0gdGhpcy5fZC52YWx1ZU9mKCk7XG4gICAgICB0aW1lIC09IG1vZCh0aW1lLCBNU19QRVJfTUlOVVRFKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnc2Vjb25kJzpcbiAgICAgIHRpbWUgPSB0aGlzLl9kLnZhbHVlT2YoKTtcbiAgICAgIHRpbWUgLT0gbW9kKHRpbWUsIE1TX1BFUl9TRUNPTkQpO1xuICAgICAgYnJlYWs7XG4gIH1cblxuICB0aGlzLl9kLnNldFRpbWUodGltZSk7XG5cbiAgaG9va3MudXBkYXRlT2Zmc2V0KHRoaXMsIHRydWUpO1xuICByZXR1cm4gdGhpcztcbn1cbmV4cG9ydCBmdW5jdGlvbiBlbmRPZih1bml0cykge1xuICB2YXIgdGltZTtcbiAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cyk7XG5cbiAgaWYgKHVuaXRzID09PSB1bmRlZmluZWQgfHwgdW5pdHMgPT09ICdtaWxsaXNlY29uZCcgfHwgIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB2YXIgc3RhcnRPZkRhdGUgPSB0aGlzLl9pc1VUQyA/IHV0Y1N0YXJ0T2ZEYXRlIDogbG9jYWxTdGFydE9mRGF0ZTtcblxuICBzd2l0Y2ggKHVuaXRzKSB7XG4gICAgY2FzZSAneWVhcic6XG4gICAgICB0aW1lID0gc3RhcnRPZkRhdGUodGhpcy55ZWFyKCkgKyAxLCAwLCAxKSAtIDE7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3F1YXJ0ZXInOlxuICAgICAgdGltZSA9IHN0YXJ0T2ZEYXRlKHRoaXMueWVhcigpLCB0aGlzLm1vbnRoKCkgLSB0aGlzLm1vbnRoKCkgJSAzICsgMywgMSkgLSAxO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdtb250aCc6XG4gICAgICB0aW1lID0gc3RhcnRPZkRhdGUodGhpcy55ZWFyKCksIHRoaXMubW9udGgoKSArIDEsIDEpIC0gMTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnd2Vlayc6XG4gICAgICB0aW1lID0gc3RhcnRPZkRhdGUodGhpcy55ZWFyKCksIHRoaXMubW9udGgoKSwgdGhpcy5kYXRlKCkgLSB0aGlzLndlZWtkYXkoKSArIDcpIC0gMTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnaXNvV2Vlayc6XG4gICAgICB0aW1lID0gc3RhcnRPZkRhdGUodGhpcy55ZWFyKCksIHRoaXMubW9udGgoKSwgdGhpcy5kYXRlKCkgLSAodGhpcy5pc29XZWVrZGF5KCkgLSAxKSArIDcpIC0gMTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnZGF5JzpcbiAgICBjYXNlICdkYXRlJzpcbiAgICAgIHRpbWUgPSBzdGFydE9mRGF0ZSh0aGlzLnllYXIoKSwgdGhpcy5tb250aCgpLCB0aGlzLmRhdGUoKSArIDEpIC0gMTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnaG91cic6XG4gICAgICB0aW1lID0gdGhpcy5fZC52YWx1ZU9mKCk7XG4gICAgICB0aW1lICs9IE1TX1BFUl9IT1VSIC0gbW9kKHRpbWUgKyAodGhpcy5faXNVVEMgPyAwIDogdGhpcy51dGNPZmZzZXQoKSAqIE1TX1BFUl9NSU5VVEUpLCBNU19QRVJfSE9VUikgLSAxO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdtaW51dGUnOlxuICAgICAgdGltZSA9IHRoaXMuX2QudmFsdWVPZigpO1xuICAgICAgdGltZSArPSBNU19QRVJfTUlOVVRFIC0gbW9kKHRpbWUsIE1TX1BFUl9NSU5VVEUpIC0gMTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnc2Vjb25kJzpcbiAgICAgIHRpbWUgPSB0aGlzLl9kLnZhbHVlT2YoKTtcbiAgICAgIHRpbWUgKz0gTVNfUEVSX1NFQ09ORCAtIG1vZCh0aW1lLCBNU19QRVJfU0VDT05EKSAtIDE7XG4gICAgICBicmVhaztcbiAgfVxuXG4gIHRoaXMuX2Quc2V0VGltZSh0aW1lKTtcblxuICBob29rcy51cGRhdGVPZmZzZXQodGhpcywgdHJ1ZSk7XG4gIHJldHVybiB0aGlzO1xufSIsImV4cG9ydCBmdW5jdGlvbiB2YWx1ZU9mKCkge1xuICByZXR1cm4gdGhpcy5fZC52YWx1ZU9mKCkgLSAodGhpcy5fb2Zmc2V0IHx8IDApICogNjAwMDA7XG59XG5leHBvcnQgZnVuY3Rpb24gdW5peCgpIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IodGhpcy52YWx1ZU9mKCkgLyAxMDAwKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB0b0RhdGUoKSB7XG4gIHJldHVybiBuZXcgRGF0ZSh0aGlzLnZhbHVlT2YoKSk7XG59XG5leHBvcnQgZnVuY3Rpb24gdG9BcnJheSgpIHtcbiAgdmFyIG0gPSB0aGlzO1xuICByZXR1cm4gW20ueWVhcigpLCBtLm1vbnRoKCksIG0uZGF0ZSgpLCBtLmhvdXIoKSwgbS5taW51dGUoKSwgbS5zZWNvbmQoKSwgbS5taWxsaXNlY29uZCgpXTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB0b09iamVjdCgpIHtcbiAgdmFyIG0gPSB0aGlzO1xuICByZXR1cm4ge1xuICAgIHllYXJzOiBtLnllYXIoKSxcbiAgICBtb250aHM6IG0ubW9udGgoKSxcbiAgICBkYXRlOiBtLmRhdGUoKSxcbiAgICBob3VyczogbS5ob3VycygpLFxuICAgIG1pbnV0ZXM6IG0ubWludXRlcygpLFxuICAgIHNlY29uZHM6IG0uc2Vjb25kcygpLFxuICAgIG1pbGxpc2Vjb25kczogbS5taWxsaXNlY29uZHMoKVxuICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIHRvSlNPTigpIHtcbiAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gdGhpcy50b0lTT1N0cmluZygpIDogbnVsbDtcbn0iLCJpbXBvcnQgeyBjcmVhdGVEdXJhdGlvbiB9IGZyb20gJy4uL2R1cmF0aW9uL2NyZWF0ZSc7XG5pbXBvcnQgeyBjcmVhdGVMb2NhbCB9IGZyb20gJy4uL2NyZWF0ZS9sb2NhbCc7XG5pbXBvcnQgeyBpc01vbWVudCB9IGZyb20gJy4uL21vbWVudC9jb25zdHJ1Y3Rvcic7XG5leHBvcnQgZnVuY3Rpb24gdG8odGltZSwgd2l0aG91dFN1ZmZpeCkge1xuICBpZiAodGhpcy5pc1ZhbGlkKCkgJiYgKGlzTW9tZW50KHRpbWUpICYmIHRpbWUuaXNWYWxpZCgpIHx8IGNyZWF0ZUxvY2FsKHRpbWUpLmlzVmFsaWQoKSkpIHtcbiAgICByZXR1cm4gY3JlYXRlRHVyYXRpb24oe1xuICAgICAgZnJvbTogdGhpcyxcbiAgICAgIHRvOiB0aW1lXG4gICAgfSkubG9jYWxlKHRoaXMubG9jYWxlKCkpLmh1bWFuaXplKCF3aXRob3V0U3VmZml4KTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIHRvTm93KHdpdGhvdXRTdWZmaXgpIHtcbiAgcmV0dXJuIHRoaXMudG8oY3JlYXRlTG9jYWwoKSwgd2l0aG91dFN1ZmZpeCk7XG59IiwiaW1wb3J0IHsgaXNWYWxpZCBhcyBfaXNWYWxpZCB9IGZyb20gJy4uL2NyZWF0ZS92YWxpZCc7XG5pbXBvcnQgZXh0ZW5kIGZyb20gJy4uL3V0aWxzL2V4dGVuZCc7XG5pbXBvcnQgZ2V0UGFyc2luZ0ZsYWdzIGZyb20gJy4uL2NyZWF0ZS9wYXJzaW5nLWZsYWdzJztcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkKCkge1xuICByZXR1cm4gX2lzVmFsaWQodGhpcyk7XG59XG5leHBvcnQgZnVuY3Rpb24gcGFyc2luZ0ZsYWdzKCkge1xuICByZXR1cm4gZXh0ZW5kKHt9LCBnZXRQYXJzaW5nRmxhZ3ModGhpcykpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGludmFsaWRBdCgpIHtcbiAgcmV0dXJuIGdldFBhcnNpbmdGbGFncyh0aGlzKS5vdmVyZmxvdztcbn0iLCJleHBvcnQgdmFyIG1hdGNoMSA9IC9cXGQvO1xuZXhwb3J0IHZhciBtYXRjaDIgPSAvXFxkXFxkLztcbmV4cG9ydCB2YXIgbWF0Y2gzID0gL1xcZHszfS87XG5leHBvcnQgdmFyIG1hdGNoNCA9IC9cXGR7NH0vO1xuZXhwb3J0IHZhciBtYXRjaDYgPSAvWystXT9cXGR7Nn0vO1xuZXhwb3J0IHZhciBtYXRjaDF0bzIgPSAvXFxkXFxkPy87XG5leHBvcnQgdmFyIG1hdGNoM3RvNCA9IC9cXGRcXGRcXGRcXGQ/LztcbmV4cG9ydCB2YXIgbWF0Y2g1dG82ID0gL1xcZFxcZFxcZFxcZFxcZFxcZD8vO1xuZXhwb3J0IHZhciBtYXRjaDF0bzMgPSAvXFxkezEsM30vO1xuZXhwb3J0IHZhciBtYXRjaDF0bzQgPSAvXFxkezEsNH0vO1xuZXhwb3J0IHZhciBtYXRjaDF0bzYgPSAvWystXT9cXGR7MSw2fS87XG5leHBvcnQgdmFyIG1hdGNoVW5zaWduZWQgPSAvXFxkKy87XG5leHBvcnQgdmFyIG1hdGNoU2lnbmVkID0gL1srLV0/XFxkKy87XG5leHBvcnQgdmFyIG1hdGNoT2Zmc2V0ID0gL1p8WystXVxcZFxcZDo/XFxkXFxkL2dpO1xuZXhwb3J0IHZhciBtYXRjaFNob3J0T2Zmc2V0ID0gL1p8WystXVxcZFxcZCg/Ojo/XFxkXFxkKT8vZ2k7XG5leHBvcnQgdmFyIG1hdGNoVGltZXN0YW1wID0gL1srLV0/XFxkKyhcXC5cXGR7MSwzfSk/LztcbmV4cG9ydCB2YXIgbWF0Y2hXb3JkID0gL1swLTldezAsMjU2fVsnYS16XFx1MDBBMC1cXHUwNUZGXFx1MDcwMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRjA3XFx1RkYxMC1cXHVGRkVGXXsxLDI1Nn18W1xcdTA2MDAtXFx1MDZGRlxcL117MSwyNTZ9KFxccyo/W1xcdTA2MDAtXFx1MDZGRl17MSwyNTZ9KXsxLDJ9L2k7XG5pbXBvcnQgaGFzT3duUHJvcCBmcm9tICcuLi91dGlscy9oYXMtb3duLXByb3AnO1xuaW1wb3J0IGlzRnVuY3Rpb24gZnJvbSAnLi4vdXRpbHMvaXMtZnVuY3Rpb24nO1xudmFyIHJlZ2V4ZXMgPSB7fTtcbmV4cG9ydCBmdW5jdGlvbiBhZGRSZWdleFRva2VuKHRva2VuLCByZWdleCwgc3RyaWN0UmVnZXgpIHtcbiAgcmVnZXhlc1t0b2tlbl0gPSBpc0Z1bmN0aW9uKHJlZ2V4KSA/IHJlZ2V4IDogZnVuY3Rpb24gKGlzU3RyaWN0LCBsb2NhbGVEYXRhKSB7XG4gICAgcmV0dXJuIGlzU3RyaWN0ICYmIHN0cmljdFJlZ2V4ID8gc3RyaWN0UmVnZXggOiByZWdleDtcbiAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJzZVJlZ2V4Rm9yVG9rZW4odG9rZW4sIGNvbmZpZykge1xuICBpZiAoIWhhc093blByb3AocmVnZXhlcywgdG9rZW4pKSB7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAodW5lc2NhcGVGb3JtYXQodG9rZW4pKTtcbiAgfVxuXG4gIHJldHVybiByZWdleGVzW3Rva2VuXShjb25maWcuX3N0cmljdCwgY29uZmlnLl9sb2NhbGUpO1xufVxuXG5mdW5jdGlvbiB1bmVzY2FwZUZvcm1hdChzKSB7XG4gIHJldHVybiByZWdleEVzY2FwZShzLnJlcGxhY2UoJ1xcXFwnLCAnJykucmVwbGFjZSgvXFxcXChcXFspfFxcXFwoXFxdKXxcXFsoW15cXF1cXFtdKilcXF18XFxcXCguKS9nLCBmdW5jdGlvbiAobWF0Y2hlZCwgcDEsIHAyLCBwMywgcDQpIHtcbiAgICByZXR1cm4gcDEgfHwgcDIgfHwgcDMgfHwgcDQ7XG4gIH0pKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2V4RXNjYXBlKHMpIHtcbiAgcmV0dXJuIHMucmVwbGFjZSgvWy1cXC9cXFxcXiQqKz8uKCl8W1xcXXt9XS9nLCAnXFxcXCQmJyk7XG59IiwiaW1wb3J0IGhhc093blByb3AgZnJvbSAnLi4vdXRpbHMvaGFzLW93bi1wcm9wJztcbmltcG9ydCBpc051bWJlciBmcm9tICcuLi91dGlscy9pcy1udW1iZXInO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG52YXIgdG9rZW5zID0ge307XG5leHBvcnQgZnVuY3Rpb24gYWRkUGFyc2VUb2tlbih0b2tlbiwgY2FsbGJhY2spIHtcbiAgdmFyIGksXG4gICAgICBmdW5jID0gY2FsbGJhY2s7XG5cbiAgaWYgKHR5cGVvZiB0b2tlbiA9PT0gJ3N0cmluZycpIHtcbiAgICB0b2tlbiA9IFt0b2tlbl07XG4gIH1cblxuICBpZiAoaXNOdW1iZXIoY2FsbGJhY2spKSB7XG4gICAgZnVuYyA9IGZ1bmN0aW9uIGZ1bmMoaW5wdXQsIGFycmF5KSB7XG4gICAgICBhcnJheVtjYWxsYmFja10gPSB0b0ludChpbnB1dCk7XG4gICAgfTtcbiAgfVxuXG4gIGZvciAoaSA9IDA7IGkgPCB0b2tlbi5sZW5ndGg7IGkrKykge1xuICAgIHRva2Vuc1t0b2tlbltpXV0gPSBmdW5jO1xuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gYWRkV2Vla1BhcnNlVG9rZW4odG9rZW4sIGNhbGxiYWNrKSB7XG4gIGFkZFBhcnNlVG9rZW4odG9rZW4sIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZywgdG9rZW4pIHtcbiAgICBjb25maWcuX3cgPSBjb25maWcuX3cgfHwge307XG4gICAgY2FsbGJhY2soaW5wdXQsIGNvbmZpZy5fdywgY29uZmlnLCB0b2tlbik7XG4gIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGFkZFRpbWVUb0FycmF5RnJvbVRva2VuKHRva2VuLCBpbnB1dCwgY29uZmlnKSB7XG4gIGlmIChpbnB1dCAhPSBudWxsICYmIGhhc093blByb3AodG9rZW5zLCB0b2tlbikpIHtcbiAgICB0b2tlbnNbdG9rZW5dKGlucHV0LCBjb25maWcuX2EsIGNvbmZpZywgdG9rZW4pO1xuICB9XG59IiwiaW1wb3J0IGhhc093blByb3AgZnJvbSAnLi4vdXRpbHMvaGFzLW93bi1wcm9wJztcbnZhciBhbGlhc2VzID0ge307XG5leHBvcnQgZnVuY3Rpb24gYWRkVW5pdEFsaWFzKHVuaXQsIHNob3J0aGFuZCkge1xuICB2YXIgbG93ZXJDYXNlID0gdW5pdC50b0xvd2VyQ2FzZSgpO1xuICBhbGlhc2VzW2xvd2VyQ2FzZV0gPSBhbGlhc2VzW2xvd2VyQ2FzZSArICdzJ10gPSBhbGlhc2VzW3Nob3J0aGFuZF0gPSB1bml0O1xufVxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVVuaXRzKHVuaXRzKSB7XG4gIHJldHVybiB0eXBlb2YgdW5pdHMgPT09ICdzdHJpbmcnID8gYWxpYXNlc1t1bml0c10gfHwgYWxpYXNlc1t1bml0cy50b0xvd2VyQ2FzZSgpXSA6IHVuZGVmaW5lZDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVPYmplY3RVbml0cyhpbnB1dE9iamVjdCkge1xuICB2YXIgbm9ybWFsaXplZElucHV0ID0ge30sXG4gICAgICBub3JtYWxpemVkUHJvcCxcbiAgICAgIHByb3A7XG5cbiAgZm9yIChwcm9wIGluIGlucHV0T2JqZWN0KSB7XG4gICAgaWYgKGhhc093blByb3AoaW5wdXRPYmplY3QsIHByb3ApKSB7XG4gICAgICBub3JtYWxpemVkUHJvcCA9IG5vcm1hbGl6ZVVuaXRzKHByb3ApO1xuXG4gICAgICBpZiAobm9ybWFsaXplZFByb3ApIHtcbiAgICAgICAgbm9ybWFsaXplZElucHV0W25vcm1hbGl6ZWRQcm9wXSA9IGlucHV0T2JqZWN0W3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBub3JtYWxpemVkSW5wdXQ7XG59IiwiZXhwb3J0IHZhciBZRUFSID0gMDtcbmV4cG9ydCB2YXIgTU9OVEggPSAxO1xuZXhwb3J0IHZhciBEQVRFID0gMjtcbmV4cG9ydCB2YXIgSE9VUiA9IDM7XG5leHBvcnQgdmFyIE1JTlVURSA9IDQ7XG5leHBvcnQgdmFyIFNFQ09ORCA9IDU7XG5leHBvcnQgdmFyIE1JTExJU0VDT05EID0gNjtcbmV4cG9ydCB2YXIgV0VFSyA9IDc7XG5leHBvcnQgdmFyIFdFRUtEQVkgPSA4OyIsImltcG9ydCB7IG1ha2VHZXRTZXQgfSBmcm9tICcuLi9tb21lbnQvZ2V0LXNldCc7XG5pbXBvcnQgeyBhZGRGb3JtYXRUb2tlbiB9IGZyb20gJy4uL2Zvcm1hdC9mb3JtYXQnO1xuaW1wb3J0IHsgYWRkVW5pdEFsaWFzIH0gZnJvbSAnLi9hbGlhc2VzJztcbmltcG9ydCB7IGFkZFVuaXRQcmlvcml0eSB9IGZyb20gJy4vcHJpb3JpdGllcyc7XG5pbXBvcnQgeyBhZGRSZWdleFRva2VuLCBtYXRjaDF0bzIsIG1hdGNoMiB9IGZyb20gJy4uL3BhcnNlL3JlZ2V4JztcbmltcG9ydCB7IGFkZFBhcnNlVG9rZW4gfSBmcm9tICcuLi9wYXJzZS90b2tlbic7XG5pbXBvcnQgeyBEQVRFIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG5hZGRGb3JtYXRUb2tlbignRCcsIFsnREQnLCAyXSwgJ0RvJywgJ2RhdGUnKTtcbmFkZFVuaXRBbGlhcygnZGF0ZScsICdEJyk7XG5hZGRVbml0UHJpb3JpdHkoJ2RhdGUnLCA5KTtcbmFkZFJlZ2V4VG9rZW4oJ0QnLCBtYXRjaDF0bzIpO1xuYWRkUmVnZXhUb2tlbignREQnLCBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRSZWdleFRva2VuKCdEbycsIGZ1bmN0aW9uIChpc1N0cmljdCwgbG9jYWxlKSB7XG4gIHJldHVybiBpc1N0cmljdCA/IGxvY2FsZS5fZGF5T2ZNb250aE9yZGluYWxQYXJzZSB8fCBsb2NhbGUuX29yZGluYWxQYXJzZSA6IGxvY2FsZS5fZGF5T2ZNb250aE9yZGluYWxQYXJzZUxlbmllbnQ7XG59KTtcbmFkZFBhcnNlVG9rZW4oWydEJywgJ0REJ10sIERBVEUpO1xuYWRkUGFyc2VUb2tlbignRG8nLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5KSB7XG4gIGFycmF5W0RBVEVdID0gdG9JbnQoaW5wdXQubWF0Y2gobWF0Y2gxdG8yKVswXSk7XG59KTtcbmV4cG9ydCB2YXIgZ2V0U2V0RGF5T2ZNb250aCA9IG1ha2VHZXRTZXQoJ0RhdGUnLCB0cnVlKTsiLCJpbXBvcnQgeyBhZGRGb3JtYXRUb2tlbiB9IGZyb20gJy4uL2Zvcm1hdC9mb3JtYXQnO1xuaW1wb3J0IHsgYWRkVW5pdEFsaWFzIH0gZnJvbSAnLi9hbGlhc2VzJztcbmltcG9ydCB7IGFkZFVuaXRQcmlvcml0eSB9IGZyb20gJy4vcHJpb3JpdGllcyc7XG5pbXBvcnQgeyBhZGRSZWdleFRva2VuLCBtYXRjaDF0bzIsIG1hdGNoV29yZCwgcmVnZXhFc2NhcGUgfSBmcm9tICcuLi9wYXJzZS9yZWdleCc7XG5pbXBvcnQgeyBhZGRXZWVrUGFyc2VUb2tlbiB9IGZyb20gJy4uL3BhcnNlL3Rva2VuJztcbmltcG9ydCB0b0ludCBmcm9tICcuLi91dGlscy90by1pbnQnO1xuaW1wb3J0IGlzQXJyYXkgZnJvbSAnLi4vdXRpbHMvaXMtYXJyYXknO1xuaW1wb3J0IGluZGV4T2YgZnJvbSAnLi4vdXRpbHMvaW5kZXgtb2YnO1xuaW1wb3J0IGhhc093blByb3AgZnJvbSAnLi4vdXRpbHMvaGFzLW93bi1wcm9wJztcbmltcG9ydCB7IGNyZWF0ZVVUQyB9IGZyb20gJy4uL2NyZWF0ZS91dGMnO1xuaW1wb3J0IGdldFBhcnNpbmdGbGFncyBmcm9tICcuLi9jcmVhdGUvcGFyc2luZy1mbGFncyc7XG5hZGRGb3JtYXRUb2tlbignZCcsIDAsICdkbycsICdkYXknKTtcbmFkZEZvcm1hdFRva2VuKCdkZCcsIDAsIDAsIGZ1bmN0aW9uIChmb3JtYXQpIHtcbiAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLndlZWtkYXlzTWluKHRoaXMsIGZvcm1hdCk7XG59KTtcbmFkZEZvcm1hdFRva2VuKCdkZGQnLCAwLCAwLCBmdW5jdGlvbiAoZm9ybWF0KSB7XG4gIHJldHVybiB0aGlzLmxvY2FsZURhdGEoKS53ZWVrZGF5c1Nob3J0KHRoaXMsIGZvcm1hdCk7XG59KTtcbmFkZEZvcm1hdFRva2VuKCdkZGRkJywgMCwgMCwgZnVuY3Rpb24gKGZvcm1hdCkge1xuICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkud2Vla2RheXModGhpcywgZm9ybWF0KTtcbn0pO1xuYWRkRm9ybWF0VG9rZW4oJ2UnLCAwLCAwLCAnd2Vla2RheScpO1xuYWRkRm9ybWF0VG9rZW4oJ0UnLCAwLCAwLCAnaXNvV2Vla2RheScpO1xuYWRkVW5pdEFsaWFzKCdkYXknLCAnZCcpO1xuYWRkVW5pdEFsaWFzKCd3ZWVrZGF5JywgJ2UnKTtcbmFkZFVuaXRBbGlhcygnaXNvV2Vla2RheScsICdFJyk7XG5hZGRVbml0UHJpb3JpdHkoJ2RheScsIDExKTtcbmFkZFVuaXRQcmlvcml0eSgnd2Vla2RheScsIDExKTtcbmFkZFVuaXRQcmlvcml0eSgnaXNvV2Vla2RheScsIDExKTtcbmFkZFJlZ2V4VG9rZW4oJ2QnLCBtYXRjaDF0bzIpO1xuYWRkUmVnZXhUb2tlbignZScsIG1hdGNoMXRvMik7XG5hZGRSZWdleFRva2VuKCdFJywgbWF0Y2gxdG8yKTtcbmFkZFJlZ2V4VG9rZW4oJ2RkJywgZnVuY3Rpb24gKGlzU3RyaWN0LCBsb2NhbGUpIHtcbiAgcmV0dXJuIGxvY2FsZS53ZWVrZGF5c01pblJlZ2V4KGlzU3RyaWN0KTtcbn0pO1xuYWRkUmVnZXhUb2tlbignZGRkJywgZnVuY3Rpb24gKGlzU3RyaWN0LCBsb2NhbGUpIHtcbiAgcmV0dXJuIGxvY2FsZS53ZWVrZGF5c1Nob3J0UmVnZXgoaXNTdHJpY3QpO1xufSk7XG5hZGRSZWdleFRva2VuKCdkZGRkJywgZnVuY3Rpb24gKGlzU3RyaWN0LCBsb2NhbGUpIHtcbiAgcmV0dXJuIGxvY2FsZS53ZWVrZGF5c1JlZ2V4KGlzU3RyaWN0KTtcbn0pO1xuYWRkV2Vla1BhcnNlVG9rZW4oWydkZCcsICdkZGQnLCAnZGRkZCddLCBmdW5jdGlvbiAoaW5wdXQsIHdlZWssIGNvbmZpZywgdG9rZW4pIHtcbiAgdmFyIHdlZWtkYXkgPSBjb25maWcuX2xvY2FsZS53ZWVrZGF5c1BhcnNlKGlucHV0LCB0b2tlbiwgY29uZmlnLl9zdHJpY3QpO1xuXG4gIGlmICh3ZWVrZGF5ICE9IG51bGwpIHtcbiAgICB3ZWVrLmQgPSB3ZWVrZGF5O1xuICB9IGVsc2Uge1xuICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmludmFsaWRXZWVrZGF5ID0gaW5wdXQ7XG4gIH1cbn0pO1xuYWRkV2Vla1BhcnNlVG9rZW4oWydkJywgJ2UnLCAnRSddLCBmdW5jdGlvbiAoaW5wdXQsIHdlZWssIGNvbmZpZywgdG9rZW4pIHtcbiAgd2Vla1t0b2tlbl0gPSB0b0ludChpbnB1dCk7XG59KTtcblxuZnVuY3Rpb24gcGFyc2VXZWVrZGF5KGlucHV0LCBsb2NhbGUpIHtcbiAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gaW5wdXQ7XG4gIH1cblxuICBpZiAoIWlzTmFOKGlucHV0KSkge1xuICAgIHJldHVybiBwYXJzZUludChpbnB1dCwgMTApO1xuICB9XG5cbiAgaW5wdXQgPSBsb2NhbGUud2Vla2RheXNQYXJzZShpbnB1dCk7XG5cbiAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ251bWJlcicpIHtcbiAgICByZXR1cm4gaW5wdXQ7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gcGFyc2VJc29XZWVrZGF5KGlucHV0LCBsb2NhbGUpIHtcbiAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gbG9jYWxlLndlZWtkYXlzUGFyc2UoaW5wdXQpICUgNyB8fCA3O1xuICB9XG5cbiAgcmV0dXJuIGlzTmFOKGlucHV0KSA/IG51bGwgOiBpbnB1dDtcbn1cblxuZnVuY3Rpb24gc2hpZnRXZWVrZGF5cyh3cywgbikge1xuICByZXR1cm4gd3Muc2xpY2UobiwgNykuY29uY2F0KHdzLnNsaWNlKDAsIG4pKTtcbn1cblxuZXhwb3J0IHZhciBkZWZhdWx0TG9jYWxlV2Vla2RheXMgPSAnU3VuZGF5X01vbmRheV9UdWVzZGF5X1dlZG5lc2RheV9UaHVyc2RheV9GcmlkYXlfU2F0dXJkYXknLnNwbGl0KCdfJyk7XG5leHBvcnQgZnVuY3Rpb24gbG9jYWxlV2Vla2RheXMobSwgZm9ybWF0KSB7XG4gIHZhciB3ZWVrZGF5cyA9IGlzQXJyYXkodGhpcy5fd2Vla2RheXMpID8gdGhpcy5fd2Vla2RheXMgOiB0aGlzLl93ZWVrZGF5c1ttICYmIG0gIT09IHRydWUgJiYgdGhpcy5fd2Vla2RheXMuaXNGb3JtYXQudGVzdChmb3JtYXQpID8gJ2Zvcm1hdCcgOiAnc3RhbmRhbG9uZSddO1xuICByZXR1cm4gbSA9PT0gdHJ1ZSA/IHNoaWZ0V2Vla2RheXMod2Vla2RheXMsIHRoaXMuX3dlZWsuZG93KSA6IG0gPyB3ZWVrZGF5c1ttLmRheSgpXSA6IHdlZWtkYXlzO1xufVxuZXhwb3J0IHZhciBkZWZhdWx0TG9jYWxlV2Vla2RheXNTaG9ydCA9ICdTdW5fTW9uX1R1ZV9XZWRfVGh1X0ZyaV9TYXQnLnNwbGl0KCdfJyk7XG5leHBvcnQgZnVuY3Rpb24gbG9jYWxlV2Vla2RheXNTaG9ydChtKSB7XG4gIHJldHVybiBtID09PSB0cnVlID8gc2hpZnRXZWVrZGF5cyh0aGlzLl93ZWVrZGF5c1Nob3J0LCB0aGlzLl93ZWVrLmRvdykgOiBtID8gdGhpcy5fd2Vla2RheXNTaG9ydFttLmRheSgpXSA6IHRoaXMuX3dlZWtkYXlzU2hvcnQ7XG59XG5leHBvcnQgdmFyIGRlZmF1bHRMb2NhbGVXZWVrZGF5c01pbiA9ICdTdV9Nb19UdV9XZV9UaF9Gcl9TYScuc3BsaXQoJ18nKTtcbmV4cG9ydCBmdW5jdGlvbiBsb2NhbGVXZWVrZGF5c01pbihtKSB7XG4gIHJldHVybiBtID09PSB0cnVlID8gc2hpZnRXZWVrZGF5cyh0aGlzLl93ZWVrZGF5c01pbiwgdGhpcy5fd2Vlay5kb3cpIDogbSA/IHRoaXMuX3dlZWtkYXlzTWluW20uZGF5KCldIDogdGhpcy5fd2Vla2RheXNNaW47XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVN0cmljdFBhcnNlKHdlZWtkYXlOYW1lLCBmb3JtYXQsIHN0cmljdCkge1xuICB2YXIgaSxcbiAgICAgIGlpLFxuICAgICAgbW9tLFxuICAgICAgbGxjID0gd2Vla2RheU5hbWUudG9Mb2NhbGVMb3dlckNhc2UoKTtcblxuICBpZiAoIXRoaXMuX3dlZWtkYXlzUGFyc2UpIHtcbiAgICB0aGlzLl93ZWVrZGF5c1BhcnNlID0gW107XG4gICAgdGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlID0gW107XG4gICAgdGhpcy5fbWluV2Vla2RheXNQYXJzZSA9IFtdO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IDc7ICsraSkge1xuICAgICAgbW9tID0gY3JlYXRlVVRDKFsyMDAwLCAxXSkuZGF5KGkpO1xuICAgICAgdGhpcy5fbWluV2Vla2RheXNQYXJzZVtpXSA9IHRoaXMud2Vla2RheXNNaW4obW9tLCAnJykudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgIHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZVtpXSA9IHRoaXMud2Vla2RheXNTaG9ydChtb20sICcnKS50b0xvY2FsZUxvd2VyQ2FzZSgpO1xuICAgICAgdGhpcy5fd2Vla2RheXNQYXJzZVtpXSA9IHRoaXMud2Vla2RheXMobW9tLCAnJykudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICB9XG4gIH1cblxuICBpZiAoc3RyaWN0KSB7XG4gICAgaWYgKGZvcm1hdCA9PT0gJ2RkZGQnKSB7XG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl93ZWVrZGF5c1BhcnNlLCBsbGMpO1xuICAgICAgcmV0dXJuIGlpICE9PSAtMSA/IGlpIDogbnVsbDtcbiAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2RkZCcpIHtcbiAgICAgIGlpID0gaW5kZXhPZi5jYWxsKHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSwgbGxjKTtcbiAgICAgIHJldHVybiBpaSAhPT0gLTEgPyBpaSA6IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlpID0gaW5kZXhPZi5jYWxsKHRoaXMuX21pbldlZWtkYXlzUGFyc2UsIGxsYyk7XG4gICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoZm9ybWF0ID09PSAnZGRkZCcpIHtcbiAgICAgIGlpID0gaW5kZXhPZi5jYWxsKHRoaXMuX3dlZWtkYXlzUGFyc2UsIGxsYyk7XG5cbiAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGlpO1xuICAgICAgfVxuXG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2UsIGxsYyk7XG5cbiAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGlpO1xuICAgICAgfVxuXG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl9taW5XZWVrZGF5c1BhcnNlLCBsbGMpO1xuICAgICAgcmV0dXJuIGlpICE9PSAtMSA/IGlpIDogbnVsbDtcbiAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2RkZCcpIHtcbiAgICAgIGlpID0gaW5kZXhPZi5jYWxsKHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSwgbGxjKTtcblxuICAgICAgaWYgKGlpICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gaWk7XG4gICAgICB9XG5cbiAgICAgIGlpID0gaW5kZXhPZi5jYWxsKHRoaXMuX3dlZWtkYXlzUGFyc2UsIGxsYyk7XG5cbiAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGlpO1xuICAgICAgfVxuXG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl9taW5XZWVrZGF5c1BhcnNlLCBsbGMpO1xuICAgICAgcmV0dXJuIGlpICE9PSAtMSA/IGlpIDogbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWkgPSBpbmRleE9mLmNhbGwodGhpcy5fbWluV2Vla2RheXNQYXJzZSwgbGxjKTtcblxuICAgICAgaWYgKGlpICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gaWk7XG4gICAgICB9XG5cbiAgICAgIGlpID0gaW5kZXhPZi5jYWxsKHRoaXMuX3dlZWtkYXlzUGFyc2UsIGxsYyk7XG5cbiAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGlpO1xuICAgICAgfVxuXG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2UsIGxsYyk7XG4gICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9jYWxlV2Vla2RheXNQYXJzZSh3ZWVrZGF5TmFtZSwgZm9ybWF0LCBzdHJpY3QpIHtcbiAgdmFyIGksIG1vbSwgcmVnZXg7XG5cbiAgaWYgKHRoaXMuX3dlZWtkYXlzUGFyc2VFeGFjdCkge1xuICAgIHJldHVybiBoYW5kbGVTdHJpY3RQYXJzZS5jYWxsKHRoaXMsIHdlZWtkYXlOYW1lLCBmb3JtYXQsIHN0cmljdCk7XG4gIH1cblxuICBpZiAoIXRoaXMuX3dlZWtkYXlzUGFyc2UpIHtcbiAgICB0aGlzLl93ZWVrZGF5c1BhcnNlID0gW107XG4gICAgdGhpcy5fbWluV2Vla2RheXNQYXJzZSA9IFtdO1xuICAgIHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSA9IFtdO1xuICAgIHRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlID0gW107XG4gIH1cblxuICBmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgbW9tID0gY3JlYXRlVVRDKFsyMDAwLCAxXSkuZGF5KGkpO1xuXG4gICAgaWYgKHN0cmljdCAmJiAhdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2VbaV0pIHtcbiAgICAgIHRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW2ldID0gbmV3IFJlZ0V4cCgnXicgKyB0aGlzLndlZWtkYXlzKG1vbSwgJycpLnJlcGxhY2UoJy4nLCAnXFxcXC4/JykgKyAnJCcsICdpJyk7XG4gICAgICB0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2VbaV0gPSBuZXcgUmVnRXhwKCdeJyArIHRoaXMud2Vla2RheXNTaG9ydChtb20sICcnKS5yZXBsYWNlKCcuJywgJ1xcXFwuPycpICsgJyQnLCAnaScpO1xuICAgICAgdGhpcy5fbWluV2Vla2RheXNQYXJzZVtpXSA9IG5ldyBSZWdFeHAoJ14nICsgdGhpcy53ZWVrZGF5c01pbihtb20sICcnKS5yZXBsYWNlKCcuJywgJ1xcXFwuPycpICsgJyQnLCAnaScpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5fd2Vla2RheXNQYXJzZVtpXSkge1xuICAgICAgcmVnZXggPSAnXicgKyB0aGlzLndlZWtkYXlzKG1vbSwgJycpICsgJ3xeJyArIHRoaXMud2Vla2RheXNTaG9ydChtb20sICcnKSArICd8XicgKyB0aGlzLndlZWtkYXlzTWluKG1vbSwgJycpO1xuICAgICAgdGhpcy5fd2Vla2RheXNQYXJzZVtpXSA9IG5ldyBSZWdFeHAocmVnZXgucmVwbGFjZSgnLicsICcnKSwgJ2knKTtcbiAgICB9XG5cbiAgICBpZiAoc3RyaWN0ICYmIGZvcm1hdCA9PT0gJ2RkZGQnICYmIHRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW2ldLnRlc3Qod2Vla2RheU5hbWUpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9IGVsc2UgaWYgKHN0cmljdCAmJiBmb3JtYXQgPT09ICdkZGQnICYmIHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZVtpXS50ZXN0KHdlZWtkYXlOYW1lKSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfSBlbHNlIGlmIChzdHJpY3QgJiYgZm9ybWF0ID09PSAnZGQnICYmIHRoaXMuX21pbldlZWtkYXlzUGFyc2VbaV0udGVzdCh3ZWVrZGF5TmFtZSkpIHtcbiAgICAgIHJldHVybiBpO1xuICAgIH0gZWxzZSBpZiAoIXN0cmljdCAmJiB0aGlzLl93ZWVrZGF5c1BhcnNlW2ldLnRlc3Qod2Vla2RheU5hbWUpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXREYXlPZldlZWsoaW5wdXQpIHtcbiAgaWYgKCF0aGlzLmlzVmFsaWQoKSkge1xuICAgIHJldHVybiBpbnB1dCAhPSBudWxsID8gdGhpcyA6IE5hTjtcbiAgfVxuXG4gIHZhciBkYXkgPSB0aGlzLl9pc1VUQyA/IHRoaXMuX2QuZ2V0VVRDRGF5KCkgOiB0aGlzLl9kLmdldERheSgpO1xuXG4gIGlmIChpbnB1dCAhPSBudWxsKSB7XG4gICAgaW5wdXQgPSBwYXJzZVdlZWtkYXkoaW5wdXQsIHRoaXMubG9jYWxlRGF0YSgpKTtcbiAgICByZXR1cm4gdGhpcy5hZGQoaW5wdXQgLSBkYXksICdkJyk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGRheTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFNldExvY2FsZURheU9mV2VlayhpbnB1dCkge1xuICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIGlucHV0ICE9IG51bGwgPyB0aGlzIDogTmFOO1xuICB9XG5cbiAgdmFyIHdlZWtkYXkgPSAodGhpcy5kYXkoKSArIDcgLSB0aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3cpICUgNztcbiAgcmV0dXJuIGlucHV0ID09IG51bGwgPyB3ZWVrZGF5IDogdGhpcy5hZGQoaW5wdXQgLSB3ZWVrZGF5LCAnZCcpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFNldElTT0RheU9mV2VlayhpbnB1dCkge1xuICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIGlucHV0ICE9IG51bGwgPyB0aGlzIDogTmFOO1xuICB9XG5cbiAgaWYgKGlucHV0ICE9IG51bGwpIHtcbiAgICB2YXIgd2Vla2RheSA9IHBhcnNlSXNvV2Vla2RheShpbnB1dCwgdGhpcy5sb2NhbGVEYXRhKCkpO1xuICAgIHJldHVybiB0aGlzLmRheSh0aGlzLmRheSgpICUgNyA/IHdlZWtkYXkgOiB3ZWVrZGF5IC0gNyk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRoaXMuZGF5KCkgfHwgNztcbiAgfVxufVxudmFyIGRlZmF1bHRXZWVrZGF5c1JlZ2V4ID0gbWF0Y2hXb3JkO1xuZXhwb3J0IGZ1bmN0aW9uIHdlZWtkYXlzUmVnZXgoaXNTdHJpY3QpIHtcbiAgaWYgKHRoaXMuX3dlZWtkYXlzUGFyc2VFeGFjdCkge1xuICAgIGlmICghaGFzT3duUHJvcCh0aGlzLCAnX3dlZWtkYXlzUmVnZXgnKSkge1xuICAgICAgY29tcHV0ZVdlZWtkYXlzUGFyc2UuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBpZiAoaXNTdHJpY3QpIHtcbiAgICAgIHJldHVybiB0aGlzLl93ZWVrZGF5c1N0cmljdFJlZ2V4O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5fd2Vla2RheXNSZWdleDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKCFoYXNPd25Qcm9wKHRoaXMsICdfd2Vla2RheXNSZWdleCcpKSB7XG4gICAgICB0aGlzLl93ZWVrZGF5c1JlZ2V4ID0gZGVmYXVsdFdlZWtkYXlzUmVnZXg7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX3dlZWtkYXlzU3RyaWN0UmVnZXggJiYgaXNTdHJpY3QgPyB0aGlzLl93ZWVrZGF5c1N0cmljdFJlZ2V4IDogdGhpcy5fd2Vla2RheXNSZWdleDtcbiAgfVxufVxudmFyIGRlZmF1bHRXZWVrZGF5c1Nob3J0UmVnZXggPSBtYXRjaFdvcmQ7XG5leHBvcnQgZnVuY3Rpb24gd2Vla2RheXNTaG9ydFJlZ2V4KGlzU3RyaWN0KSB7XG4gIGlmICh0aGlzLl93ZWVrZGF5c1BhcnNlRXhhY3QpIHtcbiAgICBpZiAoIWhhc093blByb3AodGhpcywgJ193ZWVrZGF5c1JlZ2V4JykpIHtcbiAgICAgIGNvbXB1dGVXZWVrZGF5c1BhcnNlLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgaWYgKGlzU3RyaWN0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fd2Vla2RheXNTaG9ydFN0cmljdFJlZ2V4O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoIWhhc093blByb3AodGhpcywgJ193ZWVrZGF5c1Nob3J0UmVnZXgnKSkge1xuICAgICAgdGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4ID0gZGVmYXVsdFdlZWtkYXlzU2hvcnRSZWdleDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fd2Vla2RheXNTaG9ydFN0cmljdFJlZ2V4ICYmIGlzU3RyaWN0ID8gdGhpcy5fd2Vla2RheXNTaG9ydFN0cmljdFJlZ2V4IDogdGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4O1xuICB9XG59XG52YXIgZGVmYXVsdFdlZWtkYXlzTWluUmVnZXggPSBtYXRjaFdvcmQ7XG5leHBvcnQgZnVuY3Rpb24gd2Vla2RheXNNaW5SZWdleChpc1N0cmljdCkge1xuICBpZiAodGhpcy5fd2Vla2RheXNQYXJzZUV4YWN0KSB7XG4gICAgaWYgKCFoYXNPd25Qcm9wKHRoaXMsICdfd2Vla2RheXNSZWdleCcpKSB7XG4gICAgICBjb21wdXRlV2Vla2RheXNQYXJzZS5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGlmIChpc1N0cmljdCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3dlZWtkYXlzTWluU3RyaWN0UmVnZXg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLl93ZWVrZGF5c01pblJlZ2V4O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoIWhhc093blByb3AodGhpcywgJ193ZWVrZGF5c01pblJlZ2V4JykpIHtcbiAgICAgIHRoaXMuX3dlZWtkYXlzTWluUmVnZXggPSBkZWZhdWx0V2Vla2RheXNNaW5SZWdleDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fd2Vla2RheXNNaW5TdHJpY3RSZWdleCAmJiBpc1N0cmljdCA/IHRoaXMuX3dlZWtkYXlzTWluU3RyaWN0UmVnZXggOiB0aGlzLl93ZWVrZGF5c01pblJlZ2V4O1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbXB1dGVXZWVrZGF5c1BhcnNlKCkge1xuICBmdW5jdGlvbiBjbXBMZW5SZXYoYSwgYikge1xuICAgIHJldHVybiBiLmxlbmd0aCAtIGEubGVuZ3RoO1xuICB9XG5cbiAgdmFyIG1pblBpZWNlcyA9IFtdLFxuICAgICAgc2hvcnRQaWVjZXMgPSBbXSxcbiAgICAgIGxvbmdQaWVjZXMgPSBbXSxcbiAgICAgIG1peGVkUGllY2VzID0gW10sXG4gICAgICBpLFxuICAgICAgbW9tLFxuICAgICAgbWlucCxcbiAgICAgIHNob3J0cCxcbiAgICAgIGxvbmdwO1xuXG4gIGZvciAoaSA9IDA7IGkgPCA3OyBpKyspIHtcbiAgICBtb20gPSBjcmVhdGVVVEMoWzIwMDAsIDFdKS5kYXkoaSk7XG4gICAgbWlucCA9IHRoaXMud2Vla2RheXNNaW4obW9tLCAnJyk7XG4gICAgc2hvcnRwID0gdGhpcy53ZWVrZGF5c1Nob3J0KG1vbSwgJycpO1xuICAgIGxvbmdwID0gdGhpcy53ZWVrZGF5cyhtb20sICcnKTtcbiAgICBtaW5QaWVjZXMucHVzaChtaW5wKTtcbiAgICBzaG9ydFBpZWNlcy5wdXNoKHNob3J0cCk7XG4gICAgbG9uZ1BpZWNlcy5wdXNoKGxvbmdwKTtcbiAgICBtaXhlZFBpZWNlcy5wdXNoKG1pbnApO1xuICAgIG1peGVkUGllY2VzLnB1c2goc2hvcnRwKTtcbiAgICBtaXhlZFBpZWNlcy5wdXNoKGxvbmdwKTtcbiAgfVxuXG4gIG1pblBpZWNlcy5zb3J0KGNtcExlblJldik7XG4gIHNob3J0UGllY2VzLnNvcnQoY21wTGVuUmV2KTtcbiAgbG9uZ1BpZWNlcy5zb3J0KGNtcExlblJldik7XG4gIG1peGVkUGllY2VzLnNvcnQoY21wTGVuUmV2KTtcblxuICBmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgc2hvcnRQaWVjZXNbaV0gPSByZWdleEVzY2FwZShzaG9ydFBpZWNlc1tpXSk7XG4gICAgbG9uZ1BpZWNlc1tpXSA9IHJlZ2V4RXNjYXBlKGxvbmdQaWVjZXNbaV0pO1xuICAgIG1peGVkUGllY2VzW2ldID0gcmVnZXhFc2NhcGUobWl4ZWRQaWVjZXNbaV0pO1xuICB9XG5cbiAgdGhpcy5fd2Vla2RheXNSZWdleCA9IG5ldyBSZWdFeHAoJ14oJyArIG1peGVkUGllY2VzLmpvaW4oJ3wnKSArICcpJywgJ2knKTtcbiAgdGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4ID0gdGhpcy5fd2Vla2RheXNSZWdleDtcbiAgdGhpcy5fd2Vla2RheXNNaW5SZWdleCA9IHRoaXMuX3dlZWtkYXlzUmVnZXg7XG4gIHRoaXMuX3dlZWtkYXlzU3RyaWN0UmVnZXggPSBuZXcgUmVnRXhwKCdeKCcgKyBsb25nUGllY2VzLmpvaW4oJ3wnKSArICcpJywgJ2knKTtcbiAgdGhpcy5fd2Vla2RheXNTaG9ydFN0cmljdFJlZ2V4ID0gbmV3IFJlZ0V4cCgnXignICsgc2hvcnRQaWVjZXMuam9pbignfCcpICsgJyknLCAnaScpO1xuICB0aGlzLl93ZWVrZGF5c01pblN0cmljdFJlZ2V4ID0gbmV3IFJlZ0V4cCgnXignICsgbWluUGllY2VzLmpvaW4oJ3wnKSArICcpJywgJ2knKTtcbn0iLCJpbXBvcnQgeyBhZGRGb3JtYXRUb2tlbiB9IGZyb20gJy4uL2Zvcm1hdC9mb3JtYXQnO1xuaW1wb3J0IHsgYWRkVW5pdEFsaWFzIH0gZnJvbSAnLi9hbGlhc2VzJztcbmltcG9ydCB7IGFkZFVuaXRQcmlvcml0eSB9IGZyb20gJy4vcHJpb3JpdGllcyc7XG5pbXBvcnQgeyBhZGRSZWdleFRva2VuLCBtYXRjaDMsIG1hdGNoMXRvMyB9IGZyb20gJy4uL3BhcnNlL3JlZ2V4JztcbmltcG9ydCB7IGRheXNJblllYXIgfSBmcm9tICcuL3llYXInO1xuaW1wb3J0IHsgY3JlYXRlVVRDRGF0ZSB9IGZyb20gJy4uL2NyZWF0ZS9kYXRlLWZyb20tYXJyYXknO1xuaW1wb3J0IHsgYWRkUGFyc2VUb2tlbiB9IGZyb20gJy4uL3BhcnNlL3Rva2VuJztcbmltcG9ydCB0b0ludCBmcm9tICcuLi91dGlscy90by1pbnQnO1xuYWRkRm9ybWF0VG9rZW4oJ0RERCcsIFsnRERERCcsIDNdLCAnREREbycsICdkYXlPZlllYXInKTtcbmFkZFVuaXRBbGlhcygnZGF5T2ZZZWFyJywgJ0RERCcpO1xuYWRkVW5pdFByaW9yaXR5KCdkYXlPZlllYXInLCA0KTtcbmFkZFJlZ2V4VG9rZW4oJ0RERCcsIG1hdGNoMXRvMyk7XG5hZGRSZWdleFRva2VuKCdEREREJywgbWF0Y2gzKTtcbmFkZFBhcnNlVG9rZW4oWydEREQnLCAnRERERCddLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5LCBjb25maWcpIHtcbiAgY29uZmlnLl9kYXlPZlllYXIgPSB0b0ludChpbnB1dCk7XG59KTtcbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXREYXlPZlllYXIoaW5wdXQpIHtcbiAgdmFyIGRheU9mWWVhciA9IE1hdGgucm91bmQoKHRoaXMuY2xvbmUoKS5zdGFydE9mKCdkYXknKSAtIHRoaXMuY2xvbmUoKS5zdGFydE9mKCd5ZWFyJykpIC8gODY0ZTUpICsgMTtcbiAgcmV0dXJuIGlucHV0ID09IG51bGwgPyBkYXlPZlllYXIgOiB0aGlzLmFkZChpbnB1dCAtIGRheU9mWWVhciwgJ2QnKTtcbn0iLCJpbXBvcnQgeyBtYWtlR2V0U2V0IH0gZnJvbSAnLi4vbW9tZW50L2dldC1zZXQnO1xuaW1wb3J0IHsgYWRkRm9ybWF0VG9rZW4gfSBmcm9tICcuLi9mb3JtYXQvZm9ybWF0JztcbmltcG9ydCB7IGFkZFVuaXRBbGlhcyB9IGZyb20gJy4vYWxpYXNlcyc7XG5pbXBvcnQgeyBhZGRVbml0UHJpb3JpdHkgfSBmcm9tICcuL3ByaW9yaXRpZXMnO1xuaW1wb3J0IHsgYWRkUmVnZXhUb2tlbiwgbWF0Y2gxdG8yLCBtYXRjaDIsIG1hdGNoM3RvNCwgbWF0Y2g1dG82IH0gZnJvbSAnLi4vcGFyc2UvcmVnZXgnO1xuaW1wb3J0IHsgYWRkUGFyc2VUb2tlbiB9IGZyb20gJy4uL3BhcnNlL3Rva2VuJztcbmltcG9ydCB7IEhPVVIsIE1JTlVURSwgU0VDT05EIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG5pbXBvcnQgemVyb0ZpbGwgZnJvbSAnLi4vdXRpbHMvemVyby1maWxsJztcbmltcG9ydCBnZXRQYXJzaW5nRmxhZ3MgZnJvbSAnLi4vY3JlYXRlL3BhcnNpbmctZmxhZ3MnO1xuXG5mdW5jdGlvbiBoRm9ybWF0KCkge1xuICByZXR1cm4gdGhpcy5ob3VycygpICUgMTIgfHwgMTI7XG59XG5cbmZ1bmN0aW9uIGtGb3JtYXQoKSB7XG4gIHJldHVybiB0aGlzLmhvdXJzKCkgfHwgMjQ7XG59XG5cbmFkZEZvcm1hdFRva2VuKCdIJywgWydISCcsIDJdLCAwLCAnaG91cicpO1xuYWRkRm9ybWF0VG9rZW4oJ2gnLCBbJ2hoJywgMl0sIDAsIGhGb3JtYXQpO1xuYWRkRm9ybWF0VG9rZW4oJ2snLCBbJ2trJywgMl0sIDAsIGtGb3JtYXQpO1xuYWRkRm9ybWF0VG9rZW4oJ2htbScsIDAsIDAsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuICcnICsgaEZvcm1hdC5hcHBseSh0aGlzKSArIHplcm9GaWxsKHRoaXMubWludXRlcygpLCAyKTtcbn0pO1xuYWRkRm9ybWF0VG9rZW4oJ2htbXNzJywgMCwgMCwgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gJycgKyBoRm9ybWF0LmFwcGx5KHRoaXMpICsgemVyb0ZpbGwodGhpcy5taW51dGVzKCksIDIpICsgemVyb0ZpbGwodGhpcy5zZWNvbmRzKCksIDIpO1xufSk7XG5hZGRGb3JtYXRUb2tlbignSG1tJywgMCwgMCwgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gJycgKyB0aGlzLmhvdXJzKCkgKyB6ZXJvRmlsbCh0aGlzLm1pbnV0ZXMoKSwgMik7XG59KTtcbmFkZEZvcm1hdFRva2VuKCdIbW1zcycsIDAsIDAsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuICcnICsgdGhpcy5ob3VycygpICsgemVyb0ZpbGwodGhpcy5taW51dGVzKCksIDIpICsgemVyb0ZpbGwodGhpcy5zZWNvbmRzKCksIDIpO1xufSk7XG5cbmZ1bmN0aW9uIG1lcmlkaWVtKHRva2VuLCBsb3dlcmNhc2UpIHtcbiAgYWRkRm9ybWF0VG9rZW4odG9rZW4sIDAsIDAsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkubWVyaWRpZW0odGhpcy5ob3VycygpLCB0aGlzLm1pbnV0ZXMoKSwgbG93ZXJjYXNlKTtcbiAgfSk7XG59XG5cbm1lcmlkaWVtKCdhJywgdHJ1ZSk7XG5tZXJpZGllbSgnQScsIGZhbHNlKTtcbmFkZFVuaXRBbGlhcygnaG91cicsICdoJyk7XG5hZGRVbml0UHJpb3JpdHkoJ2hvdXInLCAxMyk7XG5cbmZ1bmN0aW9uIG1hdGNoTWVyaWRpZW0oaXNTdHJpY3QsIGxvY2FsZSkge1xuICByZXR1cm4gbG9jYWxlLl9tZXJpZGllbVBhcnNlO1xufVxuXG5hZGRSZWdleFRva2VuKCdhJywgbWF0Y2hNZXJpZGllbSk7XG5hZGRSZWdleFRva2VuKCdBJywgbWF0Y2hNZXJpZGllbSk7XG5hZGRSZWdleFRva2VuKCdIJywgbWF0Y2gxdG8yKTtcbmFkZFJlZ2V4VG9rZW4oJ2gnLCBtYXRjaDF0bzIpO1xuYWRkUmVnZXhUb2tlbignaycsIG1hdGNoMXRvMik7XG5hZGRSZWdleFRva2VuKCdISCcsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcbmFkZFJlZ2V4VG9rZW4oJ2hoJywgbWF0Y2gxdG8yLCBtYXRjaDIpO1xuYWRkUmVnZXhUb2tlbigna2snLCBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRSZWdleFRva2VuKCdobW0nLCBtYXRjaDN0bzQpO1xuYWRkUmVnZXhUb2tlbignaG1tc3MnLCBtYXRjaDV0bzYpO1xuYWRkUmVnZXhUb2tlbignSG1tJywgbWF0Y2gzdG80KTtcbmFkZFJlZ2V4VG9rZW4oJ0htbXNzJywgbWF0Y2g1dG82KTtcbmFkZFBhcnNlVG9rZW4oWydIJywgJ0hIJ10sIEhPVVIpO1xuYWRkUGFyc2VUb2tlbihbJ2snLCAna2snXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnKSB7XG4gIHZhciBrSW5wdXQgPSB0b0ludChpbnB1dCk7XG4gIGFycmF5W0hPVVJdID0ga0lucHV0ID09PSAyNCA/IDAgOiBrSW5wdXQ7XG59KTtcbmFkZFBhcnNlVG9rZW4oWydhJywgJ0EnXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnKSB7XG4gIGNvbmZpZy5faXNQbSA9IGNvbmZpZy5fbG9jYWxlLmlzUE0oaW5wdXQpO1xuICBjb25maWcuX21lcmlkaWVtID0gaW5wdXQ7XG59KTtcbmFkZFBhcnNlVG9rZW4oWydoJywgJ2hoJ10sIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICBhcnJheVtIT1VSXSA9IHRvSW50KGlucHV0KTtcbiAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuYmlnSG91ciA9IHRydWU7XG59KTtcbmFkZFBhcnNlVG9rZW4oJ2htbScsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICB2YXIgcG9zID0gaW5wdXQubGVuZ3RoIC0gMjtcbiAgYXJyYXlbSE9VUl0gPSB0b0ludChpbnB1dC5zdWJzdHIoMCwgcG9zKSk7XG4gIGFycmF5W01JTlVURV0gPSB0b0ludChpbnB1dC5zdWJzdHIocG9zKSk7XG4gIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmJpZ0hvdXIgPSB0cnVlO1xufSk7XG5hZGRQYXJzZVRva2VuKCdobW1zcycsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICB2YXIgcG9zMSA9IGlucHV0Lmxlbmd0aCAtIDQ7XG4gIHZhciBwb3MyID0gaW5wdXQubGVuZ3RoIC0gMjtcbiAgYXJyYXlbSE9VUl0gPSB0b0ludChpbnB1dC5zdWJzdHIoMCwgcG9zMSkpO1xuICBhcnJheVtNSU5VVEVdID0gdG9JbnQoaW5wdXQuc3Vic3RyKHBvczEsIDIpKTtcbiAgYXJyYXlbU0VDT05EXSA9IHRvSW50KGlucHV0LnN1YnN0cihwb3MyKSk7XG4gIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmJpZ0hvdXIgPSB0cnVlO1xufSk7XG5hZGRQYXJzZVRva2VuKCdIbW0nLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5LCBjb25maWcpIHtcbiAgdmFyIHBvcyA9IGlucHV0Lmxlbmd0aCAtIDI7XG4gIGFycmF5W0hPVVJdID0gdG9JbnQoaW5wdXQuc3Vic3RyKDAsIHBvcykpO1xuICBhcnJheVtNSU5VVEVdID0gdG9JbnQoaW5wdXQuc3Vic3RyKHBvcykpO1xufSk7XG5hZGRQYXJzZVRva2VuKCdIbW1zcycsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICB2YXIgcG9zMSA9IGlucHV0Lmxlbmd0aCAtIDQ7XG4gIHZhciBwb3MyID0gaW5wdXQubGVuZ3RoIC0gMjtcbiAgYXJyYXlbSE9VUl0gPSB0b0ludChpbnB1dC5zdWJzdHIoMCwgcG9zMSkpO1xuICBhcnJheVtNSU5VVEVdID0gdG9JbnQoaW5wdXQuc3Vic3RyKHBvczEsIDIpKTtcbiAgYXJyYXlbU0VDT05EXSA9IHRvSW50KGlucHV0LnN1YnN0cihwb3MyKSk7XG59KTtcbmV4cG9ydCBmdW5jdGlvbiBsb2NhbGVJc1BNKGlucHV0KSB7XG4gIHJldHVybiAoaW5wdXQgKyAnJykudG9Mb3dlckNhc2UoKS5jaGFyQXQoMCkgPT09ICdwJztcbn1cbmV4cG9ydCB2YXIgZGVmYXVsdExvY2FsZU1lcmlkaWVtUGFyc2UgPSAvW2FwXVxcLj9tP1xcLj8vaTtcbmV4cG9ydCBmdW5jdGlvbiBsb2NhbGVNZXJpZGllbShob3VycywgbWludXRlcywgaXNMb3dlcikge1xuICBpZiAoaG91cnMgPiAxMSkge1xuICAgIHJldHVybiBpc0xvd2VyID8gJ3BtJyA6ICdQTSc7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGlzTG93ZXIgPyAnYW0nIDogJ0FNJztcbiAgfVxufVxuZXhwb3J0IHZhciBnZXRTZXRIb3VyID0gbWFrZUdldFNldCgnSG91cnMnLCB0cnVlKTsiLCJpbXBvcnQgeyBtYWtlR2V0U2V0IH0gZnJvbSAnLi4vbW9tZW50L2dldC1zZXQnO1xuaW1wb3J0IHsgYWRkRm9ybWF0VG9rZW4gfSBmcm9tICcuLi9mb3JtYXQvZm9ybWF0JztcbmltcG9ydCB7IGFkZFVuaXRBbGlhcyB9IGZyb20gJy4vYWxpYXNlcyc7XG5pbXBvcnQgeyBhZGRVbml0UHJpb3JpdHkgfSBmcm9tICcuL3ByaW9yaXRpZXMnO1xuaW1wb3J0IHsgYWRkUmVnZXhUb2tlbiwgbWF0Y2gxLCBtYXRjaDIsIG1hdGNoMywgbWF0Y2gxdG8zLCBtYXRjaFVuc2lnbmVkIH0gZnJvbSAnLi4vcGFyc2UvcmVnZXgnO1xuaW1wb3J0IHsgYWRkUGFyc2VUb2tlbiB9IGZyb20gJy4uL3BhcnNlL3Rva2VuJztcbmltcG9ydCB7IE1JTExJU0VDT05EIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG5hZGRGb3JtYXRUb2tlbignUycsIDAsIDAsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIH5+KHRoaXMubWlsbGlzZWNvbmQoKSAvIDEwMCk7XG59KTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnU1MnLCAyXSwgMCwgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gfn4odGhpcy5taWxsaXNlY29uZCgpIC8gMTApO1xufSk7XG5hZGRGb3JtYXRUb2tlbigwLCBbJ1NTUycsIDNdLCAwLCAnbWlsbGlzZWNvbmQnKTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnU1NTUycsIDRdLCAwLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLm1pbGxpc2Vjb25kKCkgKiAxMDtcbn0pO1xuYWRkRm9ybWF0VG9rZW4oMCwgWydTU1NTUycsIDVdLCAwLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLm1pbGxpc2Vjb25kKCkgKiAxMDA7XG59KTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnU1NTU1NTJywgNl0sIDAsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMubWlsbGlzZWNvbmQoKSAqIDEwMDA7XG59KTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnU1NTU1NTUycsIDddLCAwLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLm1pbGxpc2Vjb25kKCkgKiAxMDAwMDtcbn0pO1xuYWRkRm9ybWF0VG9rZW4oMCwgWydTU1NTU1NTUycsIDhdLCAwLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLm1pbGxpc2Vjb25kKCkgKiAxMDAwMDA7XG59KTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnU1NTU1NTU1NTJywgOV0sIDAsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMubWlsbGlzZWNvbmQoKSAqIDEwMDAwMDA7XG59KTtcbmFkZFVuaXRBbGlhcygnbWlsbGlzZWNvbmQnLCAnbXMnKTtcbmFkZFVuaXRQcmlvcml0eSgnbWlsbGlzZWNvbmQnLCAxNik7XG5hZGRSZWdleFRva2VuKCdTJywgbWF0Y2gxdG8zLCBtYXRjaDEpO1xuYWRkUmVnZXhUb2tlbignU1MnLCBtYXRjaDF0bzMsIG1hdGNoMik7XG5hZGRSZWdleFRva2VuKCdTU1MnLCBtYXRjaDF0bzMsIG1hdGNoMyk7XG52YXIgdG9rZW47XG5cbmZvciAodG9rZW4gPSAnU1NTUyc7IHRva2VuLmxlbmd0aCA8PSA5OyB0b2tlbiArPSAnUycpIHtcbiAgYWRkUmVnZXhUb2tlbih0b2tlbiwgbWF0Y2hVbnNpZ25lZCk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlTXMoaW5wdXQsIGFycmF5KSB7XG4gIGFycmF5W01JTExJU0VDT05EXSA9IHRvSW50KCgnMC4nICsgaW5wdXQpICogMTAwMCk7XG59XG5cbmZvciAodG9rZW4gPSAnUyc7IHRva2VuLmxlbmd0aCA8PSA5OyB0b2tlbiArPSAnUycpIHtcbiAgYWRkUGFyc2VUb2tlbih0b2tlbiwgcGFyc2VNcyk7XG59XG5cbmV4cG9ydCB2YXIgZ2V0U2V0TWlsbGlzZWNvbmQgPSBtYWtlR2V0U2V0KCdNaWxsaXNlY29uZHMnLCBmYWxzZSk7IiwiaW1wb3J0IHsgbWFrZUdldFNldCB9IGZyb20gJy4uL21vbWVudC9nZXQtc2V0JztcbmltcG9ydCB7IGFkZEZvcm1hdFRva2VuIH0gZnJvbSAnLi4vZm9ybWF0L2Zvcm1hdCc7XG5pbXBvcnQgeyBhZGRVbml0QWxpYXMgfSBmcm9tICcuL2FsaWFzZXMnO1xuaW1wb3J0IHsgYWRkVW5pdFByaW9yaXR5IH0gZnJvbSAnLi9wcmlvcml0aWVzJztcbmltcG9ydCB7IGFkZFJlZ2V4VG9rZW4sIG1hdGNoMXRvMiwgbWF0Y2gyIH0gZnJvbSAnLi4vcGFyc2UvcmVnZXgnO1xuaW1wb3J0IHsgYWRkUGFyc2VUb2tlbiB9IGZyb20gJy4uL3BhcnNlL3Rva2VuJztcbmltcG9ydCB7IE1JTlVURSB9IGZyb20gJy4vY29uc3RhbnRzJztcbmFkZEZvcm1hdFRva2VuKCdtJywgWydtbScsIDJdLCAwLCAnbWludXRlJyk7XG5hZGRVbml0QWxpYXMoJ21pbnV0ZScsICdtJyk7XG5hZGRVbml0UHJpb3JpdHkoJ21pbnV0ZScsIDE0KTtcbmFkZFJlZ2V4VG9rZW4oJ20nLCBtYXRjaDF0bzIpO1xuYWRkUmVnZXhUb2tlbignbW0nLCBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRQYXJzZVRva2VuKFsnbScsICdtbSddLCBNSU5VVEUpO1xuZXhwb3J0IHZhciBnZXRTZXRNaW51dGUgPSBtYWtlR2V0U2V0KCdNaW51dGVzJywgZmFsc2UpOyIsImltcG9ydCB7IGdldCB9IGZyb20gJy4uL21vbWVudC9nZXQtc2V0JztcbmltcG9ydCBoYXNPd25Qcm9wIGZyb20gJy4uL3V0aWxzL2hhcy1vd24tcHJvcCc7XG5pbXBvcnQgeyBhZGRGb3JtYXRUb2tlbiB9IGZyb20gJy4uL2Zvcm1hdC9mb3JtYXQnO1xuaW1wb3J0IHsgYWRkVW5pdEFsaWFzIH0gZnJvbSAnLi9hbGlhc2VzJztcbmltcG9ydCB7IGFkZFVuaXRQcmlvcml0eSB9IGZyb20gJy4vcHJpb3JpdGllcyc7XG5pbXBvcnQgeyBhZGRSZWdleFRva2VuLCBtYXRjaDF0bzIsIG1hdGNoMiwgbWF0Y2hXb3JkLCByZWdleEVzY2FwZSB9IGZyb20gJy4uL3BhcnNlL3JlZ2V4JztcbmltcG9ydCB7IGFkZFBhcnNlVG9rZW4gfSBmcm9tICcuLi9wYXJzZS90b2tlbic7XG5pbXBvcnQgeyBob29rcyB9IGZyb20gJy4uL3V0aWxzL2hvb2tzJztcbmltcG9ydCB7IE1PTlRIIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG5pbXBvcnQgaXNBcnJheSBmcm9tICcuLi91dGlscy9pcy1hcnJheSc7XG5pbXBvcnQgaXNOdW1iZXIgZnJvbSAnLi4vdXRpbHMvaXMtbnVtYmVyJztcbmltcG9ydCBtb2QgZnJvbSAnLi4vdXRpbHMvbW9kJztcbmltcG9ydCBpbmRleE9mIGZyb20gJy4uL3V0aWxzL2luZGV4LW9mJztcbmltcG9ydCB7IGNyZWF0ZVVUQyB9IGZyb20gJy4uL2NyZWF0ZS91dGMnO1xuaW1wb3J0IGdldFBhcnNpbmdGbGFncyBmcm9tICcuLi9jcmVhdGUvcGFyc2luZy1mbGFncyc7XG5pbXBvcnQgeyBpc0xlYXBZZWFyIH0gZnJvbSAnLi4vdW5pdHMveWVhcic7XG5leHBvcnQgZnVuY3Rpb24gZGF5c0luTW9udGgoeWVhciwgbW9udGgpIHtcbiAgaWYgKGlzTmFOKHllYXIpIHx8IGlzTmFOKG1vbnRoKSkge1xuICAgIHJldHVybiBOYU47XG4gIH1cblxuICB2YXIgbW9kTW9udGggPSBtb2QobW9udGgsIDEyKTtcbiAgeWVhciArPSAobW9udGggLSBtb2RNb250aCkgLyAxMjtcbiAgcmV0dXJuIG1vZE1vbnRoID09PSAxID8gaXNMZWFwWWVhcih5ZWFyKSA/IDI5IDogMjggOiAzMSAtIG1vZE1vbnRoICUgNyAlIDI7XG59XG5hZGRGb3JtYXRUb2tlbignTScsIFsnTU0nLCAyXSwgJ01vJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5tb250aCgpICsgMTtcbn0pO1xuYWRkRm9ybWF0VG9rZW4oJ01NTScsIDAsIDAsIGZ1bmN0aW9uIChmb3JtYXQpIHtcbiAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm1vbnRoc1Nob3J0KHRoaXMsIGZvcm1hdCk7XG59KTtcbmFkZEZvcm1hdFRva2VuKCdNTU1NJywgMCwgMCwgZnVuY3Rpb24gKGZvcm1hdCkge1xuICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkubW9udGhzKHRoaXMsIGZvcm1hdCk7XG59KTtcbmFkZFVuaXRBbGlhcygnbW9udGgnLCAnTScpO1xuYWRkVW5pdFByaW9yaXR5KCdtb250aCcsIDgpO1xuYWRkUmVnZXhUb2tlbignTScsIG1hdGNoMXRvMik7XG5hZGRSZWdleFRva2VuKCdNTScsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcbmFkZFJlZ2V4VG9rZW4oJ01NTScsIGZ1bmN0aW9uIChpc1N0cmljdCwgbG9jYWxlKSB7XG4gIHJldHVybiBsb2NhbGUubW9udGhzU2hvcnRSZWdleChpc1N0cmljdCk7XG59KTtcbmFkZFJlZ2V4VG9rZW4oJ01NTU0nLCBmdW5jdGlvbiAoaXNTdHJpY3QsIGxvY2FsZSkge1xuICByZXR1cm4gbG9jYWxlLm1vbnRoc1JlZ2V4KGlzU3RyaWN0KTtcbn0pO1xuYWRkUGFyc2VUb2tlbihbJ00nLCAnTU0nXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSkge1xuICBhcnJheVtNT05USF0gPSB0b0ludChpbnB1dCkgLSAxO1xufSk7XG5hZGRQYXJzZVRva2VuKFsnTU1NJywgJ01NTU0nXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnLCB0b2tlbikge1xuICB2YXIgbW9udGggPSBjb25maWcuX2xvY2FsZS5tb250aHNQYXJzZShpbnB1dCwgdG9rZW4sIGNvbmZpZy5fc3RyaWN0KTtcblxuICBpZiAobW9udGggIT0gbnVsbCkge1xuICAgIGFycmF5W01PTlRIXSA9IG1vbnRoO1xuICB9IGVsc2Uge1xuICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmludmFsaWRNb250aCA9IGlucHV0O1xuICB9XG59KTtcbnZhciBNT05USFNfSU5fRk9STUFUID0gL0Rbb0RdPyhcXFtbXlxcW1xcXV0qXFxdfFxccykrTU1NTT8vO1xuZXhwb3J0IHZhciBkZWZhdWx0TG9jYWxlTW9udGhzID0gJ0phbnVhcnlfRmVicnVhcnlfTWFyY2hfQXByaWxfTWF5X0p1bmVfSnVseV9BdWd1c3RfU2VwdGVtYmVyX09jdG9iZXJfTm92ZW1iZXJfRGVjZW1iZXInLnNwbGl0KCdfJyk7XG5leHBvcnQgZnVuY3Rpb24gbG9jYWxlTW9udGhzKG0sIGZvcm1hdCkge1xuICBpZiAoIW0pIHtcbiAgICByZXR1cm4gaXNBcnJheSh0aGlzLl9tb250aHMpID8gdGhpcy5fbW9udGhzIDogdGhpcy5fbW9udGhzWydzdGFuZGFsb25lJ107XG4gIH1cblxuICByZXR1cm4gaXNBcnJheSh0aGlzLl9tb250aHMpID8gdGhpcy5fbW9udGhzW20ubW9udGgoKV0gOiB0aGlzLl9tb250aHNbKHRoaXMuX21vbnRocy5pc0Zvcm1hdCB8fCBNT05USFNfSU5fRk9STUFUKS50ZXN0KGZvcm1hdCkgPyAnZm9ybWF0JyA6ICdzdGFuZGFsb25lJ11bbS5tb250aCgpXTtcbn1cbmV4cG9ydCB2YXIgZGVmYXVsdExvY2FsZU1vbnRoc1Nob3J0ID0gJ0phbl9GZWJfTWFyX0Fwcl9NYXlfSnVuX0p1bF9BdWdfU2VwX09jdF9Ob3ZfRGVjJy5zcGxpdCgnXycpO1xuZXhwb3J0IGZ1bmN0aW9uIGxvY2FsZU1vbnRoc1Nob3J0KG0sIGZvcm1hdCkge1xuICBpZiAoIW0pIHtcbiAgICByZXR1cm4gaXNBcnJheSh0aGlzLl9tb250aHNTaG9ydCkgPyB0aGlzLl9tb250aHNTaG9ydCA6IHRoaXMuX21vbnRoc1Nob3J0WydzdGFuZGFsb25lJ107XG4gIH1cblxuICByZXR1cm4gaXNBcnJheSh0aGlzLl9tb250aHNTaG9ydCkgPyB0aGlzLl9tb250aHNTaG9ydFttLm1vbnRoKCldIDogdGhpcy5fbW9udGhzU2hvcnRbTU9OVEhTX0lOX0ZPUk1BVC50ZXN0KGZvcm1hdCkgPyAnZm9ybWF0JyA6ICdzdGFuZGFsb25lJ11bbS5tb250aCgpXTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlU3RyaWN0UGFyc2UobW9udGhOYW1lLCBmb3JtYXQsIHN0cmljdCkge1xuICB2YXIgaSxcbiAgICAgIGlpLFxuICAgICAgbW9tLFxuICAgICAgbGxjID0gbW9udGhOYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG5cbiAgaWYgKCF0aGlzLl9tb250aHNQYXJzZSkge1xuICAgIHRoaXMuX21vbnRoc1BhcnNlID0gW107XG4gICAgdGhpcy5fbG9uZ01vbnRoc1BhcnNlID0gW107XG4gICAgdGhpcy5fc2hvcnRNb250aHNQYXJzZSA9IFtdO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IDEyOyArK2kpIHtcbiAgICAgIG1vbSA9IGNyZWF0ZVVUQyhbMjAwMCwgaV0pO1xuICAgICAgdGhpcy5fc2hvcnRNb250aHNQYXJzZVtpXSA9IHRoaXMubW9udGhzU2hvcnQobW9tLCAnJykudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgIHRoaXMuX2xvbmdNb250aHNQYXJzZVtpXSA9IHRoaXMubW9udGhzKG1vbSwgJycpLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHN0cmljdCkge1xuICAgIGlmIChmb3JtYXQgPT09ICdNTU0nKSB7XG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl9zaG9ydE1vbnRoc1BhcnNlLCBsbGMpO1xuICAgICAgcmV0dXJuIGlpICE9PSAtMSA/IGlpIDogbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWkgPSBpbmRleE9mLmNhbGwodGhpcy5fbG9uZ01vbnRoc1BhcnNlLCBsbGMpO1xuICAgICAgcmV0dXJuIGlpICE9PSAtMSA/IGlpIDogbnVsbDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGZvcm1hdCA9PT0gJ01NTScpIHtcbiAgICAgIGlpID0gaW5kZXhPZi5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsIGxsYyk7XG5cbiAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGlpO1xuICAgICAgfVxuXG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl9sb25nTW9udGhzUGFyc2UsIGxsYyk7XG4gICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl9sb25nTW9udGhzUGFyc2UsIGxsYyk7XG5cbiAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGlpO1xuICAgICAgfVxuXG4gICAgICBpaSA9IGluZGV4T2YuY2FsbCh0aGlzLl9zaG9ydE1vbnRoc1BhcnNlLCBsbGMpO1xuICAgICAgcmV0dXJuIGlpICE9PSAtMSA/IGlpIDogbnVsbDtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvY2FsZU1vbnRoc1BhcnNlKG1vbnRoTmFtZSwgZm9ybWF0LCBzdHJpY3QpIHtcbiAgdmFyIGksIG1vbSwgcmVnZXg7XG5cbiAgaWYgKHRoaXMuX21vbnRoc1BhcnNlRXhhY3QpIHtcbiAgICByZXR1cm4gaGFuZGxlU3RyaWN0UGFyc2UuY2FsbCh0aGlzLCBtb250aE5hbWUsIGZvcm1hdCwgc3RyaWN0KTtcbiAgfVxuXG4gIGlmICghdGhpcy5fbW9udGhzUGFyc2UpIHtcbiAgICB0aGlzLl9tb250aHNQYXJzZSA9IFtdO1xuICAgIHRoaXMuX2xvbmdNb250aHNQYXJzZSA9IFtdO1xuICAgIHRoaXMuX3Nob3J0TW9udGhzUGFyc2UgPSBbXTtcbiAgfVxuXG4gIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgbW9tID0gY3JlYXRlVVRDKFsyMDAwLCBpXSk7XG5cbiAgICBpZiAoc3RyaWN0ICYmICF0aGlzLl9sb25nTW9udGhzUGFyc2VbaV0pIHtcbiAgICAgIHRoaXMuX2xvbmdNb250aHNQYXJzZVtpXSA9IG5ldyBSZWdFeHAoJ14nICsgdGhpcy5tb250aHMobW9tLCAnJykucmVwbGFjZSgnLicsICcnKSArICckJywgJ2knKTtcbiAgICAgIHRoaXMuX3Nob3J0TW9udGhzUGFyc2VbaV0gPSBuZXcgUmVnRXhwKCdeJyArIHRoaXMubW9udGhzU2hvcnQobW9tLCAnJykucmVwbGFjZSgnLicsICcnKSArICckJywgJ2knKTtcbiAgICB9XG5cbiAgICBpZiAoIXN0cmljdCAmJiAhdGhpcy5fbW9udGhzUGFyc2VbaV0pIHtcbiAgICAgIHJlZ2V4ID0gJ14nICsgdGhpcy5tb250aHMobW9tLCAnJykgKyAnfF4nICsgdGhpcy5tb250aHNTaG9ydChtb20sICcnKTtcbiAgICAgIHRoaXMuX21vbnRoc1BhcnNlW2ldID0gbmV3IFJlZ0V4cChyZWdleC5yZXBsYWNlKCcuJywgJycpLCAnaScpO1xuICAgIH1cblxuICAgIGlmIChzdHJpY3QgJiYgZm9ybWF0ID09PSAnTU1NTScgJiYgdGhpcy5fbG9uZ01vbnRoc1BhcnNlW2ldLnRlc3QobW9udGhOYW1lKSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfSBlbHNlIGlmIChzdHJpY3QgJiYgZm9ybWF0ID09PSAnTU1NJyAmJiB0aGlzLl9zaG9ydE1vbnRoc1BhcnNlW2ldLnRlc3QobW9udGhOYW1lKSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfSBlbHNlIGlmICghc3RyaWN0ICYmIHRoaXMuX21vbnRoc1BhcnNlW2ldLnRlc3QobW9udGhOYW1lKSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gc2V0TW9udGgobW9tLCB2YWx1ZSkge1xuICB2YXIgZGF5T2ZNb250aDtcblxuICBpZiAoIW1vbS5pc1ZhbGlkKCkpIHtcbiAgICByZXR1cm4gbW9tO1xuICB9XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAoL15cXGQrJC8udGVzdCh2YWx1ZSkpIHtcbiAgICAgIHZhbHVlID0gdG9JbnQodmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSA9IG1vbS5sb2NhbGVEYXRhKCkubW9udGhzUGFyc2UodmFsdWUpO1xuXG4gICAgICBpZiAoIWlzTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gbW9tO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGRheU9mTW9udGggPSBNYXRoLm1pbihtb20uZGF0ZSgpLCBkYXlzSW5Nb250aChtb20ueWVhcigpLCB2YWx1ZSkpO1xuXG4gIG1vbS5fZFsnc2V0JyArIChtb20uX2lzVVRDID8gJ1VUQycgOiAnJykgKyAnTW9udGgnXSh2YWx1ZSwgZGF5T2ZNb250aCk7XG5cbiAgcmV0dXJuIG1vbTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXRNb250aCh2YWx1ZSkge1xuICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgIHNldE1vbnRoKHRoaXMsIHZhbHVlKTtcbiAgICBob29rcy51cGRhdGVPZmZzZXQodGhpcywgdHJ1ZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGdldCh0aGlzLCAnTW9udGgnKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGdldERheXNJbk1vbnRoKCkge1xuICByZXR1cm4gZGF5c0luTW9udGgodGhpcy55ZWFyKCksIHRoaXMubW9udGgoKSk7XG59XG52YXIgZGVmYXVsdE1vbnRoc1Nob3J0UmVnZXggPSBtYXRjaFdvcmQ7XG5leHBvcnQgZnVuY3Rpb24gbW9udGhzU2hvcnRSZWdleChpc1N0cmljdCkge1xuICBpZiAodGhpcy5fbW9udGhzUGFyc2VFeGFjdCkge1xuICAgIGlmICghaGFzT3duUHJvcCh0aGlzLCAnX21vbnRoc1JlZ2V4JykpIHtcbiAgICAgIGNvbXB1dGVNb250aHNQYXJzZS5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGlmIChpc1N0cmljdCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLl9tb250aHNTaG9ydFJlZ2V4O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoIWhhc093blByb3AodGhpcywgJ19tb250aHNTaG9ydFJlZ2V4JykpIHtcbiAgICAgIHRoaXMuX21vbnRoc1Nob3J0UmVnZXggPSBkZWZhdWx0TW9udGhzU2hvcnRSZWdleDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fbW9udGhzU2hvcnRTdHJpY3RSZWdleCAmJiBpc1N0cmljdCA/IHRoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXggOiB0aGlzLl9tb250aHNTaG9ydFJlZ2V4O1xuICB9XG59XG52YXIgZGVmYXVsdE1vbnRoc1JlZ2V4ID0gbWF0Y2hXb3JkO1xuZXhwb3J0IGZ1bmN0aW9uIG1vbnRoc1JlZ2V4KGlzU3RyaWN0KSB7XG4gIGlmICh0aGlzLl9tb250aHNQYXJzZUV4YWN0KSB7XG4gICAgaWYgKCFoYXNPd25Qcm9wKHRoaXMsICdfbW9udGhzUmVnZXgnKSkge1xuICAgICAgY29tcHV0ZU1vbnRoc1BhcnNlLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgaWYgKGlzU3RyaWN0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fbW9udGhzU3RyaWN0UmVnZXg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLl9tb250aHNSZWdleDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKCFoYXNPd25Qcm9wKHRoaXMsICdfbW9udGhzUmVnZXgnKSkge1xuICAgICAgdGhpcy5fbW9udGhzUmVnZXggPSBkZWZhdWx0TW9udGhzUmVnZXg7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX21vbnRoc1N0cmljdFJlZ2V4ICYmIGlzU3RyaWN0ID8gdGhpcy5fbW9udGhzU3RyaWN0UmVnZXggOiB0aGlzLl9tb250aHNSZWdleDtcbiAgfVxufVxuXG5mdW5jdGlvbiBjb21wdXRlTW9udGhzUGFyc2UoKSB7XG4gIGZ1bmN0aW9uIGNtcExlblJldihhLCBiKSB7XG4gICAgcmV0dXJuIGIubGVuZ3RoIC0gYS5sZW5ndGg7XG4gIH1cblxuICB2YXIgc2hvcnRQaWVjZXMgPSBbXSxcbiAgICAgIGxvbmdQaWVjZXMgPSBbXSxcbiAgICAgIG1peGVkUGllY2VzID0gW10sXG4gICAgICBpLFxuICAgICAgbW9tO1xuXG4gIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgbW9tID0gY3JlYXRlVVRDKFsyMDAwLCBpXSk7XG4gICAgc2hvcnRQaWVjZXMucHVzaCh0aGlzLm1vbnRoc1Nob3J0KG1vbSwgJycpKTtcbiAgICBsb25nUGllY2VzLnB1c2godGhpcy5tb250aHMobW9tLCAnJykpO1xuICAgIG1peGVkUGllY2VzLnB1c2godGhpcy5tb250aHMobW9tLCAnJykpO1xuICAgIG1peGVkUGllY2VzLnB1c2godGhpcy5tb250aHNTaG9ydChtb20sICcnKSk7XG4gIH1cblxuICBzaG9ydFBpZWNlcy5zb3J0KGNtcExlblJldik7XG4gIGxvbmdQaWVjZXMuc29ydChjbXBMZW5SZXYpO1xuICBtaXhlZFBpZWNlcy5zb3J0KGNtcExlblJldik7XG5cbiAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICBzaG9ydFBpZWNlc1tpXSA9IHJlZ2V4RXNjYXBlKHNob3J0UGllY2VzW2ldKTtcbiAgICBsb25nUGllY2VzW2ldID0gcmVnZXhFc2NhcGUobG9uZ1BpZWNlc1tpXSk7XG4gIH1cblxuICBmb3IgKGkgPSAwOyBpIDwgMjQ7IGkrKykge1xuICAgIG1peGVkUGllY2VzW2ldID0gcmVnZXhFc2NhcGUobWl4ZWRQaWVjZXNbaV0pO1xuICB9XG5cbiAgdGhpcy5fbW9udGhzUmVnZXggPSBuZXcgUmVnRXhwKCdeKCcgKyBtaXhlZFBpZWNlcy5qb2luKCd8JykgKyAnKScsICdpJyk7XG4gIHRoaXMuX21vbnRoc1Nob3J0UmVnZXggPSB0aGlzLl9tb250aHNSZWdleDtcbiAgdGhpcy5fbW9udGhzU3RyaWN0UmVnZXggPSBuZXcgUmVnRXhwKCdeKCcgKyBsb25nUGllY2VzLmpvaW4oJ3wnKSArICcpJywgJ2knKTtcbiAgdGhpcy5fbW9udGhzU2hvcnRTdHJpY3RSZWdleCA9IG5ldyBSZWdFeHAoJ14oJyArIHNob3J0UGllY2VzLmpvaW4oJ3wnKSArICcpJywgJ2knKTtcbn0iLCJpbXBvcnQgemVyb0ZpbGwgZnJvbSAnLi4vdXRpbHMvemVyby1maWxsJztcbmltcG9ydCB7IGNyZWF0ZUR1cmF0aW9uIH0gZnJvbSAnLi4vZHVyYXRpb24vY3JlYXRlJztcbmltcG9ydCB7IGFkZFN1YnRyYWN0IH0gZnJvbSAnLi4vbW9tZW50L2FkZC1zdWJ0cmFjdCc7XG5pbXBvcnQgeyBpc01vbWVudCwgY29weUNvbmZpZyB9IGZyb20gJy4uL21vbWVudC9jb25zdHJ1Y3Rvcic7XG5pbXBvcnQgeyBhZGRGb3JtYXRUb2tlbiB9IGZyb20gJy4uL2Zvcm1hdC9mb3JtYXQnO1xuaW1wb3J0IHsgYWRkUmVnZXhUb2tlbiwgbWF0Y2hPZmZzZXQsIG1hdGNoU2hvcnRPZmZzZXQgfSBmcm9tICcuLi9wYXJzZS9yZWdleCc7XG5pbXBvcnQgeyBhZGRQYXJzZVRva2VuIH0gZnJvbSAnLi4vcGFyc2UvdG9rZW4nO1xuaW1wb3J0IHsgY3JlYXRlTG9jYWwgfSBmcm9tICcuLi9jcmVhdGUvbG9jYWwnO1xuaW1wb3J0IHsgcHJlcGFyZUNvbmZpZyB9IGZyb20gJy4uL2NyZWF0ZS9mcm9tLWFueXRoaW5nJztcbmltcG9ydCB7IGNyZWF0ZVVUQyB9IGZyb20gJy4uL2NyZWF0ZS91dGMnO1xuaW1wb3J0IGlzRGF0ZSBmcm9tICcuLi91dGlscy9pcy1kYXRlJztcbmltcG9ydCB0b0ludCBmcm9tICcuLi91dGlscy90by1pbnQnO1xuaW1wb3J0IGlzVW5kZWZpbmVkIGZyb20gJy4uL3V0aWxzL2lzLXVuZGVmaW5lZCc7XG5pbXBvcnQgY29tcGFyZUFycmF5cyBmcm9tICcuLi91dGlscy9jb21wYXJlLWFycmF5cyc7XG5pbXBvcnQgeyBob29rcyB9IGZyb20gJy4uL3V0aWxzL2hvb2tzJztcblxuZnVuY3Rpb24gb2Zmc2V0KHRva2VuLCBzZXBhcmF0b3IpIHtcbiAgYWRkRm9ybWF0VG9rZW4odG9rZW4sIDAsIDAsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb2Zmc2V0ID0gdGhpcy51dGNPZmZzZXQoKTtcbiAgICB2YXIgc2lnbiA9ICcrJztcblxuICAgIGlmIChvZmZzZXQgPCAwKSB7XG4gICAgICBvZmZzZXQgPSAtb2Zmc2V0O1xuICAgICAgc2lnbiA9ICctJztcbiAgICB9XG5cbiAgICByZXR1cm4gc2lnbiArIHplcm9GaWxsKH5+KG9mZnNldCAvIDYwKSwgMikgKyBzZXBhcmF0b3IgKyB6ZXJvRmlsbCh+fm9mZnNldCAlIDYwLCAyKTtcbiAgfSk7XG59XG5cbm9mZnNldCgnWicsICc6Jyk7XG5vZmZzZXQoJ1paJywgJycpO1xuYWRkUmVnZXhUb2tlbignWicsIG1hdGNoU2hvcnRPZmZzZXQpO1xuYWRkUmVnZXhUb2tlbignWlonLCBtYXRjaFNob3J0T2Zmc2V0KTtcbmFkZFBhcnNlVG9rZW4oWydaJywgJ1paJ10sIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICBjb25maWcuX3VzZVVUQyA9IHRydWU7XG4gIGNvbmZpZy5fdHptID0gb2Zmc2V0RnJvbVN0cmluZyhtYXRjaFNob3J0T2Zmc2V0LCBpbnB1dCk7XG59KTtcbnZhciBjaHVua09mZnNldCA9IC8oW1xcK1xcLV18XFxkXFxkKS9naTtcblxuZnVuY3Rpb24gb2Zmc2V0RnJvbVN0cmluZyhtYXRjaGVyLCBzdHJpbmcpIHtcbiAgdmFyIG1hdGNoZXMgPSAoc3RyaW5nIHx8ICcnKS5tYXRjaChtYXRjaGVyKTtcblxuICBpZiAobWF0Y2hlcyA9PT0gbnVsbCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmFyIGNodW5rID0gbWF0Y2hlc1ttYXRjaGVzLmxlbmd0aCAtIDFdIHx8IFtdO1xuICB2YXIgcGFydHMgPSAoY2h1bmsgKyAnJykubWF0Y2goY2h1bmtPZmZzZXQpIHx8IFsnLScsIDAsIDBdO1xuICB2YXIgbWludXRlcyA9ICsocGFydHNbMV0gKiA2MCkgKyB0b0ludChwYXJ0c1syXSk7XG4gIHJldHVybiBtaW51dGVzID09PSAwID8gMCA6IHBhcnRzWzBdID09PSAnKycgPyBtaW51dGVzIDogLW1pbnV0ZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbG9uZVdpdGhPZmZzZXQoaW5wdXQsIG1vZGVsKSB7XG4gIHZhciByZXMsIGRpZmY7XG5cbiAgaWYgKG1vZGVsLl9pc1VUQykge1xuICAgIHJlcyA9IG1vZGVsLmNsb25lKCk7XG4gICAgZGlmZiA9IChpc01vbWVudChpbnB1dCkgfHwgaXNEYXRlKGlucHV0KSA/IGlucHV0LnZhbHVlT2YoKSA6IGNyZWF0ZUxvY2FsKGlucHV0KS52YWx1ZU9mKCkpIC0gcmVzLnZhbHVlT2YoKTtcblxuICAgIHJlcy5fZC5zZXRUaW1lKHJlcy5fZC52YWx1ZU9mKCkgKyBkaWZmKTtcblxuICAgIGhvb2tzLnVwZGF0ZU9mZnNldChyZXMsIGZhbHNlKTtcbiAgICByZXR1cm4gcmVzO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBjcmVhdGVMb2NhbChpbnB1dCkubG9jYWwoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXREYXRlT2Zmc2V0KG0pIHtcbiAgcmV0dXJuIC1NYXRoLnJvdW5kKG0uX2QuZ2V0VGltZXpvbmVPZmZzZXQoKSAvIDE1KSAqIDE1O1xufVxuXG5ob29rcy51cGRhdGVPZmZzZXQgPSBmdW5jdGlvbiAoKSB7fTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNldE9mZnNldChpbnB1dCwga2VlcExvY2FsVGltZSwga2VlcE1pbnV0ZXMpIHtcbiAgdmFyIG9mZnNldCA9IHRoaXMuX29mZnNldCB8fCAwLFxuICAgICAgbG9jYWxBZGp1c3Q7XG5cbiAgaWYgKCF0aGlzLmlzVmFsaWQoKSkge1xuICAgIHJldHVybiBpbnB1dCAhPSBudWxsID8gdGhpcyA6IE5hTjtcbiAgfVxuXG4gIGlmIChpbnB1dCAhPSBudWxsKSB7XG4gICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGlucHV0ID0gb2Zmc2V0RnJvbVN0cmluZyhtYXRjaFNob3J0T2Zmc2V0LCBpbnB1dCk7XG5cbiAgICAgIGlmIChpbnB1dCA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKE1hdGguYWJzKGlucHV0KSA8IDE2ICYmICFrZWVwTWludXRlcykge1xuICAgICAgaW5wdXQgPSBpbnB1dCAqIDYwO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5faXNVVEMgJiYga2VlcExvY2FsVGltZSkge1xuICAgICAgbG9jYWxBZGp1c3QgPSBnZXREYXRlT2Zmc2V0KHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMuX29mZnNldCA9IGlucHV0O1xuICAgIHRoaXMuX2lzVVRDID0gdHJ1ZTtcblxuICAgIGlmIChsb2NhbEFkanVzdCAhPSBudWxsKSB7XG4gICAgICB0aGlzLmFkZChsb2NhbEFkanVzdCwgJ20nKTtcbiAgICB9XG5cbiAgICBpZiAob2Zmc2V0ICE9PSBpbnB1dCkge1xuICAgICAgaWYgKCFrZWVwTG9jYWxUaW1lIHx8IHRoaXMuX2NoYW5nZUluUHJvZ3Jlc3MpIHtcbiAgICAgICAgYWRkU3VidHJhY3QodGhpcywgY3JlYXRlRHVyYXRpb24oaW5wdXQgLSBvZmZzZXQsICdtJyksIDEsIGZhbHNlKTtcbiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuX2NoYW5nZUluUHJvZ3Jlc3MpIHtcbiAgICAgICAgdGhpcy5fY2hhbmdlSW5Qcm9ncmVzcyA9IHRydWU7XG4gICAgICAgIGhvb2tzLnVwZGF0ZU9mZnNldCh0aGlzLCB0cnVlKTtcbiAgICAgICAgdGhpcy5fY2hhbmdlSW5Qcm9ncmVzcyA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzVVRDID8gb2Zmc2V0IDogZ2V0RGF0ZU9mZnNldCh0aGlzKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFNldFpvbmUoaW5wdXQsIGtlZXBMb2NhbFRpbWUpIHtcbiAgaWYgKGlucHV0ICE9IG51bGwpIHtcbiAgICBpZiAodHlwZW9mIGlucHV0ICE9PSAnc3RyaW5nJykge1xuICAgICAgaW5wdXQgPSAtaW5wdXQ7XG4gICAgfVxuXG4gICAgdGhpcy51dGNPZmZzZXQoaW5wdXQsIGtlZXBMb2NhbFRpbWUpO1xuICAgIHJldHVybiB0aGlzO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAtdGhpcy51dGNPZmZzZXQoKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIHNldE9mZnNldFRvVVRDKGtlZXBMb2NhbFRpbWUpIHtcbiAgcmV0dXJuIHRoaXMudXRjT2Zmc2V0KDAsIGtlZXBMb2NhbFRpbWUpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHNldE9mZnNldFRvTG9jYWwoa2VlcExvY2FsVGltZSkge1xuICBpZiAodGhpcy5faXNVVEMpIHtcbiAgICB0aGlzLnV0Y09mZnNldCgwLCBrZWVwTG9jYWxUaW1lKTtcbiAgICB0aGlzLl9pc1VUQyA9IGZhbHNlO1xuXG4gICAgaWYgKGtlZXBMb2NhbFRpbWUpIHtcbiAgICAgIHRoaXMuc3VidHJhY3QoZ2V0RGF0ZU9mZnNldCh0aGlzKSwgJ20nKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXRPZmZzZXRUb1BhcnNlZE9mZnNldCgpIHtcbiAgaWYgKHRoaXMuX3R6bSAhPSBudWxsKSB7XG4gICAgdGhpcy51dGNPZmZzZXQodGhpcy5fdHptLCBmYWxzZSwgdHJ1ZSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuX2kgPT09ICdzdHJpbmcnKSB7XG4gICAgdmFyIHRab25lID0gb2Zmc2V0RnJvbVN0cmluZyhtYXRjaE9mZnNldCwgdGhpcy5faSk7XG5cbiAgICBpZiAodFpvbmUgIT0gbnVsbCkge1xuICAgICAgdGhpcy51dGNPZmZzZXQodFpvbmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnV0Y09mZnNldCgwLCB0cnVlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn1cbmV4cG9ydCBmdW5jdGlvbiBoYXNBbGlnbmVkSG91ck9mZnNldChpbnB1dCkge1xuICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaW5wdXQgPSBpbnB1dCA/IGNyZWF0ZUxvY2FsKGlucHV0KS51dGNPZmZzZXQoKSA6IDA7XG4gIHJldHVybiAodGhpcy51dGNPZmZzZXQoKSAtIGlucHV0KSAlIDYwID09PSAwO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzRGF5bGlnaHRTYXZpbmdUaW1lKCkge1xuICByZXR1cm4gdGhpcy51dGNPZmZzZXQoKSA+IHRoaXMuY2xvbmUoKS5tb250aCgwKS51dGNPZmZzZXQoKSB8fCB0aGlzLnV0Y09mZnNldCgpID4gdGhpcy5jbG9uZSgpLm1vbnRoKDUpLnV0Y09mZnNldCgpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzRGF5bGlnaHRTYXZpbmdUaW1lU2hpZnRlZCgpIHtcbiAgaWYgKCFpc1VuZGVmaW5lZCh0aGlzLl9pc0RTVFNoaWZ0ZWQpKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzRFNUU2hpZnRlZDtcbiAgfVxuXG4gIHZhciBjID0ge307XG4gIGNvcHlDb25maWcoYywgdGhpcyk7XG4gIGMgPSBwcmVwYXJlQ29uZmlnKGMpO1xuXG4gIGlmIChjLl9hKSB7XG4gICAgdmFyIG90aGVyID0gYy5faXNVVEMgPyBjcmVhdGVVVEMoYy5fYSkgOiBjcmVhdGVMb2NhbChjLl9hKTtcbiAgICB0aGlzLl9pc0RTVFNoaWZ0ZWQgPSB0aGlzLmlzVmFsaWQoKSAmJiBjb21wYXJlQXJyYXlzKGMuX2EsIG90aGVyLnRvQXJyYXkoKSkgPiAwO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuX2lzRFNUU2hpZnRlZCA9IGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuX2lzRFNUU2hpZnRlZDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpc0xvY2FsKCkge1xuICByZXR1cm4gdGhpcy5pc1ZhbGlkKCkgPyAhdGhpcy5faXNVVEMgOiBmYWxzZTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpc1V0Y09mZnNldCgpIHtcbiAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gdGhpcy5faXNVVEMgOiBmYWxzZTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpc1V0YygpIHtcbiAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gdGhpcy5faXNVVEMgJiYgdGhpcy5fb2Zmc2V0ID09PSAwIDogZmFsc2U7XG59IiwidmFyIHByaW9yaXRpZXMgPSB7fTtcbmV4cG9ydCBmdW5jdGlvbiBhZGRVbml0UHJpb3JpdHkodW5pdCwgcHJpb3JpdHkpIHtcbiAgcHJpb3JpdGllc1t1bml0XSA9IHByaW9yaXR5O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFByaW9yaXRpemVkVW5pdHModW5pdHNPYmopIHtcbiAgdmFyIHVuaXRzID0gW107XG5cbiAgZm9yICh2YXIgdSBpbiB1bml0c09iaikge1xuICAgIHVuaXRzLnB1c2goe1xuICAgICAgdW5pdDogdSxcbiAgICAgIHByaW9yaXR5OiBwcmlvcml0aWVzW3VdXG4gICAgfSk7XG4gIH1cblxuICB1bml0cy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgcmV0dXJuIGEucHJpb3JpdHkgLSBiLnByaW9yaXR5O1xuICB9KTtcbiAgcmV0dXJuIHVuaXRzO1xufSIsImltcG9ydCB7IGFkZEZvcm1hdFRva2VuIH0gZnJvbSAnLi4vZm9ybWF0L2Zvcm1hdCc7XG5pbXBvcnQgeyBhZGRVbml0QWxpYXMgfSBmcm9tICcuL2FsaWFzZXMnO1xuaW1wb3J0IHsgYWRkVW5pdFByaW9yaXR5IH0gZnJvbSAnLi9wcmlvcml0aWVzJztcbmltcG9ydCB7IGFkZFJlZ2V4VG9rZW4sIG1hdGNoMSB9IGZyb20gJy4uL3BhcnNlL3JlZ2V4JztcbmltcG9ydCB7IGFkZFBhcnNlVG9rZW4gfSBmcm9tICcuLi9wYXJzZS90b2tlbic7XG5pbXBvcnQgeyBNT05USCB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB0b0ludCBmcm9tICcuLi91dGlscy90by1pbnQnO1xuYWRkRm9ybWF0VG9rZW4oJ1EnLCAwLCAnUW8nLCAncXVhcnRlcicpO1xuYWRkVW5pdEFsaWFzKCdxdWFydGVyJywgJ1EnKTtcbmFkZFVuaXRQcmlvcml0eSgncXVhcnRlcicsIDcpO1xuYWRkUmVnZXhUb2tlbignUScsIG1hdGNoMSk7XG5hZGRQYXJzZVRva2VuKCdRJywgZnVuY3Rpb24gKGlucHV0LCBhcnJheSkge1xuICBhcnJheVtNT05USF0gPSAodG9JbnQoaW5wdXQpIC0gMSkgKiAzO1xufSk7XG5leHBvcnQgZnVuY3Rpb24gZ2V0U2V0UXVhcnRlcihpbnB1dCkge1xuICByZXR1cm4gaW5wdXQgPT0gbnVsbCA/IE1hdGguY2VpbCgodGhpcy5tb250aCgpICsgMSkgLyAzKSA6IHRoaXMubW9udGgoKGlucHV0IC0gMSkgKiAzICsgdGhpcy5tb250aCgpICUgMyk7XG59IiwiaW1wb3J0IHsgbWFrZUdldFNldCB9IGZyb20gJy4uL21vbWVudC9nZXQtc2V0JztcbmltcG9ydCB7IGFkZEZvcm1hdFRva2VuIH0gZnJvbSAnLi4vZm9ybWF0L2Zvcm1hdCc7XG5pbXBvcnQgeyBhZGRVbml0QWxpYXMgfSBmcm9tICcuL2FsaWFzZXMnO1xuaW1wb3J0IHsgYWRkVW5pdFByaW9yaXR5IH0gZnJvbSAnLi9wcmlvcml0aWVzJztcbmltcG9ydCB7IGFkZFJlZ2V4VG9rZW4sIG1hdGNoMXRvMiwgbWF0Y2gyIH0gZnJvbSAnLi4vcGFyc2UvcmVnZXgnO1xuaW1wb3J0IHsgYWRkUGFyc2VUb2tlbiB9IGZyb20gJy4uL3BhcnNlL3Rva2VuJztcbmltcG9ydCB7IFNFQ09ORCB9IGZyb20gJy4vY29uc3RhbnRzJztcbmFkZEZvcm1hdFRva2VuKCdzJywgWydzcycsIDJdLCAwLCAnc2Vjb25kJyk7XG5hZGRVbml0QWxpYXMoJ3NlY29uZCcsICdzJyk7XG5hZGRVbml0UHJpb3JpdHkoJ3NlY29uZCcsIDE1KTtcbmFkZFJlZ2V4VG9rZW4oJ3MnLCBtYXRjaDF0bzIpO1xuYWRkUmVnZXhUb2tlbignc3MnLCBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRQYXJzZVRva2VuKFsncycsICdzcyddLCBTRUNPTkQpO1xuZXhwb3J0IHZhciBnZXRTZXRTZWNvbmQgPSBtYWtlR2V0U2V0KCdTZWNvbmRzJywgZmFsc2UpOyIsImltcG9ydCB7IGFkZEZvcm1hdFRva2VuIH0gZnJvbSAnLi4vZm9ybWF0L2Zvcm1hdCc7XG5pbXBvcnQgeyBhZGRSZWdleFRva2VuLCBtYXRjaFRpbWVzdGFtcCwgbWF0Y2hTaWduZWQgfSBmcm9tICcuLi9wYXJzZS9yZWdleCc7XG5pbXBvcnQgeyBhZGRQYXJzZVRva2VuIH0gZnJvbSAnLi4vcGFyc2UvdG9rZW4nO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG5hZGRGb3JtYXRUb2tlbignWCcsIDAsIDAsICd1bml4Jyk7XG5hZGRGb3JtYXRUb2tlbigneCcsIDAsIDAsICd2YWx1ZU9mJyk7XG5hZGRSZWdleFRva2VuKCd4JywgbWF0Y2hTaWduZWQpO1xuYWRkUmVnZXhUb2tlbignWCcsIG1hdGNoVGltZXN0YW1wKTtcbmFkZFBhcnNlVG9rZW4oJ1gnLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5LCBjb25maWcpIHtcbiAgY29uZmlnLl9kID0gbmV3IERhdGUocGFyc2VGbG9hdChpbnB1dCwgMTApICogMTAwMCk7XG59KTtcbmFkZFBhcnNlVG9rZW4oJ3gnLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5LCBjb25maWcpIHtcbiAgY29uZmlnLl9kID0gbmV3IERhdGUodG9JbnQoaW5wdXQpKTtcbn0pOyIsImltcG9ydCB7IGFkZEZvcm1hdFRva2VuIH0gZnJvbSAnLi4vZm9ybWF0L2Zvcm1hdCc7XG5hZGRGb3JtYXRUb2tlbigneicsIDAsIDAsICd6b25lQWJicicpO1xuYWRkRm9ybWF0VG9rZW4oJ3p6JywgMCwgMCwgJ3pvbmVOYW1lJyk7XG5leHBvcnQgZnVuY3Rpb24gZ2V0Wm9uZUFiYnIoKSB7XG4gIHJldHVybiB0aGlzLl9pc1VUQyA/ICdVVEMnIDogJyc7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0Wm9uZU5hbWUoKSB7XG4gIHJldHVybiB0aGlzLl9pc1VUQyA/ICdDb29yZGluYXRlZCBVbml2ZXJzYWwgVGltZScgOiAnJztcbn0iLCJpbXBvcnQgJy4vZGF5LW9mLW1vbnRoJztcbmltcG9ydCAnLi9kYXktb2Ytd2Vlayc7XG5pbXBvcnQgJy4vZGF5LW9mLXllYXInO1xuaW1wb3J0ICcuL2hvdXInO1xuaW1wb3J0ICcuL21pbGxpc2Vjb25kJztcbmltcG9ydCAnLi9taW51dGUnO1xuaW1wb3J0ICcuL21vbnRoJztcbmltcG9ydCAnLi9vZmZzZXQnO1xuaW1wb3J0ICcuL3F1YXJ0ZXInO1xuaW1wb3J0ICcuL3NlY29uZCc7XG5pbXBvcnQgJy4vdGltZXN0YW1wJztcbmltcG9ydCAnLi90aW1lem9uZSc7XG5pbXBvcnQgJy4vd2Vlay15ZWFyJztcbmltcG9ydCAnLi93ZWVrJztcbmltcG9ydCAnLi95ZWFyJztcbmltcG9ydCB7IG5vcm1hbGl6ZVVuaXRzIH0gZnJvbSAnLi9hbGlhc2VzJztcbmV4cG9ydCB7IG5vcm1hbGl6ZVVuaXRzIH07IiwiaW1wb3J0IHsgZGF5c0luWWVhciB9IGZyb20gJy4veWVhcic7XG5pbXBvcnQgeyBjcmVhdGVMb2NhbCB9IGZyb20gJy4uL2NyZWF0ZS9sb2NhbCc7XG5pbXBvcnQgeyBjcmVhdGVVVENEYXRlIH0gZnJvbSAnLi4vY3JlYXRlL2RhdGUtZnJvbS1hcnJheSc7XG5cbmZ1bmN0aW9uIGZpcnN0V2Vla09mZnNldCh5ZWFyLCBkb3csIGRveSkge1xuICB2YXIgZndkID0gNyArIGRvdyAtIGRveSxcbiAgICAgIGZ3ZGx3ID0gKDcgKyBjcmVhdGVVVENEYXRlKHllYXIsIDAsIGZ3ZCkuZ2V0VVRDRGF5KCkgLSBkb3cpICUgNztcbiAgcmV0dXJuIC1md2RsdyArIGZ3ZCAtIDE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXlPZlllYXJGcm9tV2Vla3MoeWVhciwgd2Vlaywgd2Vla2RheSwgZG93LCBkb3kpIHtcbiAgdmFyIGxvY2FsV2Vla2RheSA9ICg3ICsgd2Vla2RheSAtIGRvdykgJSA3LFxuICAgICAgd2Vla09mZnNldCA9IGZpcnN0V2Vla09mZnNldCh5ZWFyLCBkb3csIGRveSksXG4gICAgICBkYXlPZlllYXIgPSAxICsgNyAqICh3ZWVrIC0gMSkgKyBsb2NhbFdlZWtkYXkgKyB3ZWVrT2Zmc2V0LFxuICAgICAgcmVzWWVhcixcbiAgICAgIHJlc0RheU9mWWVhcjtcblxuICBpZiAoZGF5T2ZZZWFyIDw9IDApIHtcbiAgICByZXNZZWFyID0geWVhciAtIDE7XG4gICAgcmVzRGF5T2ZZZWFyID0gZGF5c0luWWVhcihyZXNZZWFyKSArIGRheU9mWWVhcjtcbiAgfSBlbHNlIGlmIChkYXlPZlllYXIgPiBkYXlzSW5ZZWFyKHllYXIpKSB7XG4gICAgcmVzWWVhciA9IHllYXIgKyAxO1xuICAgIHJlc0RheU9mWWVhciA9IGRheU9mWWVhciAtIGRheXNJblllYXIoeWVhcik7XG4gIH0gZWxzZSB7XG4gICAgcmVzWWVhciA9IHllYXI7XG4gICAgcmVzRGF5T2ZZZWFyID0gZGF5T2ZZZWFyO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB5ZWFyOiByZXNZZWFyLFxuICAgIGRheU9mWWVhcjogcmVzRGF5T2ZZZWFyXG4gIH07XG59XG5leHBvcnQgZnVuY3Rpb24gd2Vla09mWWVhcihtb20sIGRvdywgZG95KSB7XG4gIHZhciB3ZWVrT2Zmc2V0ID0gZmlyc3RXZWVrT2Zmc2V0KG1vbS55ZWFyKCksIGRvdywgZG95KSxcbiAgICAgIHdlZWsgPSBNYXRoLmZsb29yKChtb20uZGF5T2ZZZWFyKCkgLSB3ZWVrT2Zmc2V0IC0gMSkgLyA3KSArIDEsXG4gICAgICByZXNXZWVrLFxuICAgICAgcmVzWWVhcjtcblxuICBpZiAod2VlayA8IDEpIHtcbiAgICByZXNZZWFyID0gbW9tLnllYXIoKSAtIDE7XG4gICAgcmVzV2VlayA9IHdlZWsgKyB3ZWVrc0luWWVhcihyZXNZZWFyLCBkb3csIGRveSk7XG4gIH0gZWxzZSBpZiAod2VlayA+IHdlZWtzSW5ZZWFyKG1vbS55ZWFyKCksIGRvdywgZG95KSkge1xuICAgIHJlc1dlZWsgPSB3ZWVrIC0gd2Vla3NJblllYXIobW9tLnllYXIoKSwgZG93LCBkb3kpO1xuICAgIHJlc1llYXIgPSBtb20ueWVhcigpICsgMTtcbiAgfSBlbHNlIHtcbiAgICByZXNZZWFyID0gbW9tLnllYXIoKTtcbiAgICByZXNXZWVrID0gd2VlaztcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgd2VlazogcmVzV2VlayxcbiAgICB5ZWFyOiByZXNZZWFyXG4gIH07XG59XG5leHBvcnQgZnVuY3Rpb24gd2Vla3NJblllYXIoeWVhciwgZG93LCBkb3kpIHtcbiAgdmFyIHdlZWtPZmZzZXQgPSBmaXJzdFdlZWtPZmZzZXQoeWVhciwgZG93LCBkb3kpLFxuICAgICAgd2Vla09mZnNldE5leHQgPSBmaXJzdFdlZWtPZmZzZXQoeWVhciArIDEsIGRvdywgZG95KTtcbiAgcmV0dXJuIChkYXlzSW5ZZWFyKHllYXIpIC0gd2Vla09mZnNldCArIHdlZWtPZmZzZXROZXh0KSAvIDc7XG59IiwiaW1wb3J0IHsgYWRkRm9ybWF0VG9rZW4gfSBmcm9tICcuLi9mb3JtYXQvZm9ybWF0JztcbmltcG9ydCB7IGFkZFVuaXRBbGlhcyB9IGZyb20gJy4vYWxpYXNlcyc7XG5pbXBvcnQgeyBhZGRVbml0UHJpb3JpdHkgfSBmcm9tICcuL3ByaW9yaXRpZXMnO1xuaW1wb3J0IHsgYWRkUmVnZXhUb2tlbiwgbWF0Y2gxdG8yLCBtYXRjaDF0bzQsIG1hdGNoMXRvNiwgbWF0Y2gyLCBtYXRjaDQsIG1hdGNoNiwgbWF0Y2hTaWduZWQgfSBmcm9tICcuLi9wYXJzZS9yZWdleCc7XG5pbXBvcnQgeyBhZGRXZWVrUGFyc2VUb2tlbiB9IGZyb20gJy4uL3BhcnNlL3Rva2VuJztcbmltcG9ydCB7IHdlZWtPZlllYXIsIHdlZWtzSW5ZZWFyLCBkYXlPZlllYXJGcm9tV2Vla3MgfSBmcm9tICcuL3dlZWstY2FsZW5kYXItdXRpbHMnO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG5pbXBvcnQgeyBob29rcyB9IGZyb20gJy4uL3V0aWxzL2hvb2tzJztcbmltcG9ydCB7IGNyZWF0ZUxvY2FsIH0gZnJvbSAnLi4vY3JlYXRlL2xvY2FsJztcbmltcG9ydCB7IGNyZWF0ZVVUQ0RhdGUgfSBmcm9tICcuLi9jcmVhdGUvZGF0ZS1mcm9tLWFycmF5JztcbmFkZEZvcm1hdFRva2VuKDAsIFsnZ2cnLCAyXSwgMCwgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy53ZWVrWWVhcigpICUgMTAwO1xufSk7XG5hZGRGb3JtYXRUb2tlbigwLCBbJ0dHJywgMl0sIDAsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMuaXNvV2Vla1llYXIoKSAlIDEwMDtcbn0pO1xuXG5mdW5jdGlvbiBhZGRXZWVrWWVhckZvcm1hdFRva2VuKHRva2VuLCBnZXR0ZXIpIHtcbiAgYWRkRm9ybWF0VG9rZW4oMCwgW3Rva2VuLCB0b2tlbi5sZW5ndGhdLCAwLCBnZXR0ZXIpO1xufVxuXG5hZGRXZWVrWWVhckZvcm1hdFRva2VuKCdnZ2dnJywgJ3dlZWtZZWFyJyk7XG5hZGRXZWVrWWVhckZvcm1hdFRva2VuKCdnZ2dnZycsICd3ZWVrWWVhcicpO1xuYWRkV2Vla1llYXJGb3JtYXRUb2tlbignR0dHRycsICdpc29XZWVrWWVhcicpO1xuYWRkV2Vla1llYXJGb3JtYXRUb2tlbignR0dHR0cnLCAnaXNvV2Vla1llYXInKTtcbmFkZFVuaXRBbGlhcygnd2Vla1llYXInLCAnZ2cnKTtcbmFkZFVuaXRBbGlhcygnaXNvV2Vla1llYXInLCAnR0cnKTtcbmFkZFVuaXRQcmlvcml0eSgnd2Vla1llYXInLCAxKTtcbmFkZFVuaXRQcmlvcml0eSgnaXNvV2Vla1llYXInLCAxKTtcbmFkZFJlZ2V4VG9rZW4oJ0cnLCBtYXRjaFNpZ25lZCk7XG5hZGRSZWdleFRva2VuKCdnJywgbWF0Y2hTaWduZWQpO1xuYWRkUmVnZXhUb2tlbignR0cnLCBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRSZWdleFRva2VuKCdnZycsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcbmFkZFJlZ2V4VG9rZW4oJ0dHR0cnLCBtYXRjaDF0bzQsIG1hdGNoNCk7XG5hZGRSZWdleFRva2VuKCdnZ2dnJywgbWF0Y2gxdG80LCBtYXRjaDQpO1xuYWRkUmVnZXhUb2tlbignR0dHR0cnLCBtYXRjaDF0bzYsIG1hdGNoNik7XG5hZGRSZWdleFRva2VuKCdnZ2dnZycsIG1hdGNoMXRvNiwgbWF0Y2g2KTtcbmFkZFdlZWtQYXJzZVRva2VuKFsnZ2dnZycsICdnZ2dnZycsICdHR0dHJywgJ0dHR0dHJ10sIGZ1bmN0aW9uIChpbnB1dCwgd2VlaywgY29uZmlnLCB0b2tlbikge1xuICB3ZWVrW3Rva2VuLnN1YnN0cigwLCAyKV0gPSB0b0ludChpbnB1dCk7XG59KTtcbmFkZFdlZWtQYXJzZVRva2VuKFsnZ2cnLCAnR0cnXSwgZnVuY3Rpb24gKGlucHV0LCB3ZWVrLCBjb25maWcsIHRva2VuKSB7XG4gIHdlZWtbdG9rZW5dID0gaG9va3MucGFyc2VUd29EaWdpdFllYXIoaW5wdXQpO1xufSk7XG5leHBvcnQgZnVuY3Rpb24gZ2V0U2V0V2Vla1llYXIoaW5wdXQpIHtcbiAgcmV0dXJuIGdldFNldFdlZWtZZWFySGVscGVyLmNhbGwodGhpcywgaW5wdXQsIHRoaXMud2VlaygpLCB0aGlzLndlZWtkYXkoKSwgdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWsuZG93LCB0aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3kpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFNldElTT1dlZWtZZWFyKGlucHV0KSB7XG4gIHJldHVybiBnZXRTZXRXZWVrWWVhckhlbHBlci5jYWxsKHRoaXMsIGlucHV0LCB0aGlzLmlzb1dlZWsoKSwgdGhpcy5pc29XZWVrZGF5KCksIDEsIDQpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldElTT1dlZWtzSW5ZZWFyKCkge1xuICByZXR1cm4gd2Vla3NJblllYXIodGhpcy55ZWFyKCksIDEsIDQpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFdlZWtzSW5ZZWFyKCkge1xuICB2YXIgd2Vla0luZm8gPSB0aGlzLmxvY2FsZURhdGEoKS5fd2VlaztcblxuICByZXR1cm4gd2Vla3NJblllYXIodGhpcy55ZWFyKCksIHdlZWtJbmZvLmRvdywgd2Vla0luZm8uZG95KTtcbn1cblxuZnVuY3Rpb24gZ2V0U2V0V2Vla1llYXJIZWxwZXIoaW5wdXQsIHdlZWssIHdlZWtkYXksIGRvdywgZG95KSB7XG4gIHZhciB3ZWVrc1RhcmdldDtcblxuICBpZiAoaW5wdXQgPT0gbnVsbCkge1xuICAgIHJldHVybiB3ZWVrT2ZZZWFyKHRoaXMsIGRvdywgZG95KS55ZWFyO1xuICB9IGVsc2Uge1xuICAgIHdlZWtzVGFyZ2V0ID0gd2Vla3NJblllYXIoaW5wdXQsIGRvdywgZG95KTtcblxuICAgIGlmICh3ZWVrID4gd2Vla3NUYXJnZXQpIHtcbiAgICAgIHdlZWsgPSB3ZWVrc1RhcmdldDtcbiAgICB9XG5cbiAgICByZXR1cm4gc2V0V2Vla0FsbC5jYWxsKHRoaXMsIGlucHV0LCB3ZWVrLCB3ZWVrZGF5LCBkb3csIGRveSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2V0V2Vla0FsbCh3ZWVrWWVhciwgd2Vlaywgd2Vla2RheSwgZG93LCBkb3kpIHtcbiAgdmFyIGRheU9mWWVhckRhdGEgPSBkYXlPZlllYXJGcm9tV2Vla3Mod2Vla1llYXIsIHdlZWssIHdlZWtkYXksIGRvdywgZG95KSxcbiAgICAgIGRhdGUgPSBjcmVhdGVVVENEYXRlKGRheU9mWWVhckRhdGEueWVhciwgMCwgZGF5T2ZZZWFyRGF0YS5kYXlPZlllYXIpO1xuICB0aGlzLnllYXIoZGF0ZS5nZXRVVENGdWxsWWVhcigpKTtcbiAgdGhpcy5tb250aChkYXRlLmdldFVUQ01vbnRoKCkpO1xuICB0aGlzLmRhdGUoZGF0ZS5nZXRVVENEYXRlKCkpO1xuICByZXR1cm4gdGhpcztcbn0iLCJpbXBvcnQgeyBhZGRGb3JtYXRUb2tlbiB9IGZyb20gJy4uL2Zvcm1hdC9mb3JtYXQnO1xuaW1wb3J0IHsgYWRkVW5pdEFsaWFzIH0gZnJvbSAnLi9hbGlhc2VzJztcbmltcG9ydCB7IGFkZFVuaXRQcmlvcml0eSB9IGZyb20gJy4vcHJpb3JpdGllcyc7XG5pbXBvcnQgeyBhZGRSZWdleFRva2VuLCBtYXRjaDF0bzIsIG1hdGNoMiB9IGZyb20gJy4uL3BhcnNlL3JlZ2V4JztcbmltcG9ydCB7IGFkZFdlZWtQYXJzZVRva2VuIH0gZnJvbSAnLi4vcGFyc2UvdG9rZW4nO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG5pbXBvcnQgeyBjcmVhdGVMb2NhbCB9IGZyb20gJy4uL2NyZWF0ZS9sb2NhbCc7XG5pbXBvcnQgeyB3ZWVrT2ZZZWFyIH0gZnJvbSAnLi93ZWVrLWNhbGVuZGFyLXV0aWxzJztcbmFkZEZvcm1hdFRva2VuKCd3JywgWyd3dycsIDJdLCAnd28nLCAnd2VlaycpO1xuYWRkRm9ybWF0VG9rZW4oJ1cnLCBbJ1dXJywgMl0sICdXbycsICdpc29XZWVrJyk7XG5hZGRVbml0QWxpYXMoJ3dlZWsnLCAndycpO1xuYWRkVW5pdEFsaWFzKCdpc29XZWVrJywgJ1cnKTtcbmFkZFVuaXRQcmlvcml0eSgnd2VlaycsIDUpO1xuYWRkVW5pdFByaW9yaXR5KCdpc29XZWVrJywgNSk7XG5hZGRSZWdleFRva2VuKCd3JywgbWF0Y2gxdG8yKTtcbmFkZFJlZ2V4VG9rZW4oJ3d3JywgbWF0Y2gxdG8yLCBtYXRjaDIpO1xuYWRkUmVnZXhUb2tlbignVycsIG1hdGNoMXRvMik7XG5hZGRSZWdleFRva2VuKCdXVycsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcbmFkZFdlZWtQYXJzZVRva2VuKFsndycsICd3dycsICdXJywgJ1dXJ10sIGZ1bmN0aW9uIChpbnB1dCwgd2VlaywgY29uZmlnLCB0b2tlbikge1xuICB3ZWVrW3Rva2VuLnN1YnN0cigwLCAxKV0gPSB0b0ludChpbnB1dCk7XG59KTtcbmV4cG9ydCBmdW5jdGlvbiBsb2NhbGVXZWVrKG1vbSkge1xuICByZXR1cm4gd2Vla09mWWVhcihtb20sIHRoaXMuX3dlZWsuZG93LCB0aGlzLl93ZWVrLmRveSkud2Vlaztcbn1cbmV4cG9ydCB2YXIgZGVmYXVsdExvY2FsZVdlZWsgPSB7XG4gIGRvdzogMCxcbiAgZG95OiA2XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGxvY2FsZUZpcnN0RGF5T2ZXZWVrKCkge1xuICByZXR1cm4gdGhpcy5fd2Vlay5kb3c7XG59XG5leHBvcnQgZnVuY3Rpb24gbG9jYWxlRmlyc3REYXlPZlllYXIoKSB7XG4gIHJldHVybiB0aGlzLl93ZWVrLmRveTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXRXZWVrKGlucHV0KSB7XG4gIHZhciB3ZWVrID0gdGhpcy5sb2NhbGVEYXRhKCkud2Vlayh0aGlzKTtcbiAgcmV0dXJuIGlucHV0ID09IG51bGwgPyB3ZWVrIDogdGhpcy5hZGQoKGlucHV0IC0gd2VlaykgKiA3LCAnZCcpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldFNldElTT1dlZWsoaW5wdXQpIHtcbiAgdmFyIHdlZWsgPSB3ZWVrT2ZZZWFyKHRoaXMsIDEsIDQpLndlZWs7XG4gIHJldHVybiBpbnB1dCA9PSBudWxsID8gd2VlayA6IHRoaXMuYWRkKChpbnB1dCAtIHdlZWspICogNywgJ2QnKTtcbn0iLCJpbXBvcnQgeyBtYWtlR2V0U2V0IH0gZnJvbSAnLi4vbW9tZW50L2dldC1zZXQnO1xuaW1wb3J0IHsgYWRkRm9ybWF0VG9rZW4gfSBmcm9tICcuLi9mb3JtYXQvZm9ybWF0JztcbmltcG9ydCB7IGFkZFVuaXRBbGlhcyB9IGZyb20gJy4vYWxpYXNlcyc7XG5pbXBvcnQgeyBhZGRVbml0UHJpb3JpdHkgfSBmcm9tICcuL3ByaW9yaXRpZXMnO1xuaW1wb3J0IHsgYWRkUmVnZXhUb2tlbiwgbWF0Y2gxdG8yLCBtYXRjaDF0bzQsIG1hdGNoMXRvNiwgbWF0Y2gyLCBtYXRjaDQsIG1hdGNoNiwgbWF0Y2hTaWduZWQgfSBmcm9tICcuLi9wYXJzZS9yZWdleCc7XG5pbXBvcnQgeyBhZGRQYXJzZVRva2VuIH0gZnJvbSAnLi4vcGFyc2UvdG9rZW4nO1xuaW1wb3J0IHsgaG9va3MgfSBmcm9tICcuLi91dGlscy9ob29rcyc7XG5pbXBvcnQgeyBZRUFSIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHRvSW50IGZyb20gJy4uL3V0aWxzL3RvLWludCc7XG5hZGRGb3JtYXRUb2tlbignWScsIDAsIDAsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIHkgPSB0aGlzLnllYXIoKTtcbiAgcmV0dXJuIHkgPD0gOTk5OSA/ICcnICsgeSA6ICcrJyArIHk7XG59KTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnWVknLCAyXSwgMCwgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy55ZWFyKCkgJSAxMDA7XG59KTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnWVlZWScsIDRdLCAwLCAneWVhcicpO1xuYWRkRm9ybWF0VG9rZW4oMCwgWydZWVlZWScsIDVdLCAwLCAneWVhcicpO1xuYWRkRm9ybWF0VG9rZW4oMCwgWydZWVlZWVknLCA2LCB0cnVlXSwgMCwgJ3llYXInKTtcbmFkZFVuaXRBbGlhcygneWVhcicsICd5Jyk7XG5hZGRVbml0UHJpb3JpdHkoJ3llYXInLCAxKTtcbmFkZFJlZ2V4VG9rZW4oJ1knLCBtYXRjaFNpZ25lZCk7XG5hZGRSZWdleFRva2VuKCdZWScsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcbmFkZFJlZ2V4VG9rZW4oJ1lZWVknLCBtYXRjaDF0bzQsIG1hdGNoNCk7XG5hZGRSZWdleFRva2VuKCdZWVlZWScsIG1hdGNoMXRvNiwgbWF0Y2g2KTtcbmFkZFJlZ2V4VG9rZW4oJ1lZWVlZWScsIG1hdGNoMXRvNiwgbWF0Y2g2KTtcbmFkZFBhcnNlVG9rZW4oWydZWVlZWScsICdZWVlZWVknXSwgWUVBUik7XG5hZGRQYXJzZVRva2VuKCdZWVlZJywgZnVuY3Rpb24gKGlucHV0LCBhcnJheSkge1xuICBhcnJheVtZRUFSXSA9IGlucHV0Lmxlbmd0aCA9PT0gMiA/IGhvb2tzLnBhcnNlVHdvRGlnaXRZZWFyKGlucHV0KSA6IHRvSW50KGlucHV0KTtcbn0pO1xuYWRkUGFyc2VUb2tlbignWVknLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5KSB7XG4gIGFycmF5W1lFQVJdID0gaG9va3MucGFyc2VUd29EaWdpdFllYXIoaW5wdXQpO1xufSk7XG5hZGRQYXJzZVRva2VuKCdZJywgZnVuY3Rpb24gKGlucHV0LCBhcnJheSkge1xuICBhcnJheVtZRUFSXSA9IHBhcnNlSW50KGlucHV0LCAxMCk7XG59KTtcbmV4cG9ydCBmdW5jdGlvbiBkYXlzSW5ZZWFyKHllYXIpIHtcbiAgcmV0dXJuIGlzTGVhcFllYXIoeWVhcikgPyAzNjYgOiAzNjU7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNMZWFwWWVhcih5ZWFyKSB7XG4gIHJldHVybiB5ZWFyICUgNCA9PT0gMCAmJiB5ZWFyICUgMTAwICE9PSAwIHx8IHllYXIgJSA0MDAgPT09IDA7XG59XG5cbmhvb2tzLnBhcnNlVHdvRGlnaXRZZWFyID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gIHJldHVybiB0b0ludChpbnB1dCkgKyAodG9JbnQoaW5wdXQpID4gNjggPyAxOTAwIDogMjAwMCk7XG59O1xuXG5leHBvcnQgdmFyIGdldFNldFllYXIgPSBtYWtlR2V0U2V0KCdGdWxsWWVhcicsIHRydWUpO1xuZXhwb3J0IGZ1bmN0aW9uIGdldElzTGVhcFllYXIoKSB7XG4gIHJldHVybiBpc0xlYXBZZWFyKHRoaXMueWVhcigpKTtcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhYnNDZWlsKG51bWJlcikge1xuICBpZiAobnVtYmVyIDwgMCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKG51bWJlcik7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIE1hdGguY2VpbChudW1iZXIpO1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gYWJzRmxvb3IobnVtYmVyKSB7XG4gIGlmIChudW1iZXIgPCAwKSB7XG4gICAgcmV0dXJuIE1hdGguY2VpbChudW1iZXIpIHx8IDA7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IobnVtYmVyKTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGFic1JvdW5kKG51bWJlcikge1xuICBpZiAobnVtYmVyIDwgMCkge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKC0xICogbnVtYmVyKSAqIC0xO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKG51bWJlcik7XG4gIH1cbn0iLCJpbXBvcnQgdG9JbnQgZnJvbSAnLi90by1pbnQnO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29tcGFyZUFycmF5cyhhcnJheTEsIGFycmF5MiwgZG9udENvbnZlcnQpIHtcbiAgdmFyIGxlbiA9IE1hdGgubWluKGFycmF5MS5sZW5ndGgsIGFycmF5Mi5sZW5ndGgpLFxuICAgICAgbGVuZ3RoRGlmZiA9IE1hdGguYWJzKGFycmF5MS5sZW5ndGggLSBhcnJheTIubGVuZ3RoKSxcbiAgICAgIGRpZmZzID0gMCxcbiAgICAgIGk7XG5cbiAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgaWYgKGRvbnRDb252ZXJ0ICYmIGFycmF5MVtpXSAhPT0gYXJyYXkyW2ldIHx8ICFkb250Q29udmVydCAmJiB0b0ludChhcnJheTFbaV0pICE9PSB0b0ludChhcnJheTJbaV0pKSB7XG4gICAgICBkaWZmcysrO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBkaWZmcyArIGxlbmd0aERpZmY7XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZGVmYXVsdHMoYSwgYiwgYykge1xuICBpZiAoYSAhPSBudWxsKSB7XG4gICAgcmV0dXJuIGE7XG4gIH1cblxuICBpZiAoYiAhPSBudWxsKSB7XG4gICAgcmV0dXJuIGI7XG4gIH1cblxuICByZXR1cm4gYztcbn0iLCJpbXBvcnQgZXh0ZW5kIGZyb20gJy4vZXh0ZW5kJztcbmltcG9ydCB7IGhvb2tzIH0gZnJvbSAnLi9ob29rcyc7XG5pbXBvcnQgaXNVbmRlZmluZWQgZnJvbSAnLi9pcy11bmRlZmluZWQnO1xuXG5mdW5jdGlvbiB3YXJuKG1zZykge1xuICBpZiAoaG9va3Muc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmdzID09PSBmYWxzZSAmJiB0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgY29uc29sZS53YXJuKSB7XG4gICAgY29uc29sZS53YXJuKCdEZXByZWNhdGlvbiB3YXJuaW5nOiAnICsgbXNnKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVwcmVjYXRlKG1zZywgZm4pIHtcbiAgdmFyIGZpcnN0VGltZSA9IHRydWU7XG4gIHJldHVybiBleHRlbmQoZnVuY3Rpb24gKCkge1xuICAgIGlmIChob29rcy5kZXByZWNhdGlvbkhhbmRsZXIgIT0gbnVsbCkge1xuICAgICAgaG9va3MuZGVwcmVjYXRpb25IYW5kbGVyKG51bGwsIG1zZyk7XG4gICAgfVxuXG4gICAgaWYgKGZpcnN0VGltZSkge1xuICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgIHZhciBhcmc7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGFyZyA9ICcnO1xuXG4gICAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIGFyZyArPSAnXFxuWycgKyBpICsgJ10gJztcblxuICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhcmd1bWVudHNbMF0pIHtcbiAgICAgICAgICAgIGFyZyArPSBrZXkgKyAnOiAnICsgYXJndW1lbnRzWzBdW2tleV0gKyAnLCAnO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGFyZyA9IGFyZy5zbGljZSgwLCAtMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXJnID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgYXJncy5wdXNoKGFyZyk7XG4gICAgICB9XG5cbiAgICAgIHdhcm4obXNnICsgJ1xcbkFyZ3VtZW50czogJyArIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3MpLmpvaW4oJycpICsgJ1xcbicgKyBuZXcgRXJyb3IoKS5zdGFjayk7XG4gICAgICBmaXJzdFRpbWUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfSwgZm4pO1xufVxudmFyIGRlcHJlY2F0aW9ucyA9IHt9O1xuZXhwb3J0IGZ1bmN0aW9uIGRlcHJlY2F0ZVNpbXBsZShuYW1lLCBtc2cpIHtcbiAgaWYgKGhvb2tzLmRlcHJlY2F0aW9uSGFuZGxlciAhPSBudWxsKSB7XG4gICAgaG9va3MuZGVwcmVjYXRpb25IYW5kbGVyKG5hbWUsIG1zZyk7XG4gIH1cblxuICBpZiAoIWRlcHJlY2F0aW9uc1tuYW1lXSkge1xuICAgIHdhcm4obXNnKTtcbiAgICBkZXByZWNhdGlvbnNbbmFtZV0gPSB0cnVlO1xuICB9XG59XG5ob29rcy5zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZ3MgPSBmYWxzZTtcbmhvb2tzLmRlcHJlY2F0aW9uSGFuZGxlciA9IG51bGw7IiwiaW1wb3J0IGhhc093blByb3AgZnJvbSAnLi9oYXMtb3duLXByb3AnO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZXh0ZW5kKGEsIGIpIHtcbiAgZm9yICh2YXIgaSBpbiBiKSB7XG4gICAgaWYgKGhhc093blByb3AoYiwgaSkpIHtcbiAgICAgIGFbaV0gPSBiW2ldO1xuICAgIH1cbiAgfVxuXG4gIGlmIChoYXNPd25Qcm9wKGIsICd0b1N0cmluZycpKSB7XG4gICAgYS50b1N0cmluZyA9IGIudG9TdHJpbmc7XG4gIH1cblxuICBpZiAoaGFzT3duUHJvcChiLCAndmFsdWVPZicpKSB7XG4gICAgYS52YWx1ZU9mID0gYi52YWx1ZU9mO1xuICB9XG5cbiAgcmV0dXJuIGE7XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaGFzT3duUHJvcChhLCBiKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSwgYik7XG59IiwiZXhwb3J0IHsgaG9va3MsIHNldEhvb2tDYWxsYmFjayB9O1xudmFyIGhvb2tDYWxsYmFjaztcblxuZnVuY3Rpb24gaG9va3MoKSB7XG4gIHJldHVybiBob29rQ2FsbGJhY2suYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gc2V0SG9va0NhbGxiYWNrKGNhbGxiYWNrKSB7XG4gIGhvb2tDYWxsYmFjayA9IGNhbGxiYWNrO1xufSIsInZhciBpbmRleE9mO1xuXG5pZiAoQXJyYXkucHJvdG90eXBlLmluZGV4T2YpIHtcbiAgaW5kZXhPZiA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mO1xufSBlbHNlIHtcbiAgaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2Yobykge1xuICAgIHZhciBpO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGlmICh0aGlzW2ldID09PSBvKSB7XG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAtMTtcbiAgfTtcbn1cblxuZXhwb3J0IHsgaW5kZXhPZiBhcyBkZWZhdWx0IH07IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNBcnJheShpbnB1dCkge1xuICByZXR1cm4gaW5wdXQgaW5zdGFuY2VvZiBBcnJheSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaW5wdXQpID09PSAnW29iamVjdCBBcnJheV0nO1xufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzRGF0ZShpbnB1dCkge1xuICByZXR1cm4gaW5wdXQgaW5zdGFuY2VvZiBEYXRlIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpbnB1dCkgPT09ICdbb2JqZWN0IERhdGVdJztcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc0Z1bmN0aW9uKGlucHV0KSB7XG4gIHJldHVybiBpbnB1dCBpbnN0YW5jZW9mIEZ1bmN0aW9uIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpbnB1dCkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNOdW1iZXIoaW5wdXQpIHtcbiAgcmV0dXJuIHR5cGVvZiBpbnB1dCA9PT0gJ251bWJlcicgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGlucHV0KSA9PT0gJ1tvYmplY3QgTnVtYmVyXSc7XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNPYmplY3RFbXB0eShvYmopIHtcbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKSB7XG4gICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iaikubGVuZ3RoID09PSAwO1xuICB9IGVsc2Uge1xuICAgIHZhciBrO1xuXG4gICAgZm9yIChrIGluIG9iaikge1xuICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc09iamVjdChpbnB1dCkge1xuICByZXR1cm4gaW5wdXQgIT0gbnVsbCAmJiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaW5wdXQpID09PSAnW29iamVjdCBPYmplY3RdJztcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1VuZGVmaW5lZChpbnB1dCkge1xuICByZXR1cm4gaW5wdXQgPT09IHZvaWQgMDtcbn0iLCJpbXBvcnQgaGFzT3duUHJvcCBmcm9tICcuL2hhcy1vd24tcHJvcCc7XG52YXIga2V5cztcblxuaWYgKE9iamVjdC5rZXlzKSB7XG4gIGtleXMgPSBPYmplY3Qua2V5cztcbn0gZWxzZSB7XG4gIGtleXMgPSBmdW5jdGlvbiBrZXlzKG9iaikge1xuICAgIHZhciBpLFxuICAgICAgICByZXMgPSBbXTtcblxuICAgIGZvciAoaSBpbiBvYmopIHtcbiAgICAgIGlmIChoYXNPd25Qcm9wKG9iaiwgaSkpIHtcbiAgICAgICAgcmVzLnB1c2goaSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcztcbiAgfTtcbn1cblxuZXhwb3J0IHsga2V5cyBhcyBkZWZhdWx0IH07IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWFwKGFyciwgZm4pIHtcbiAgdmFyIHJlcyA9IFtdLFxuICAgICAgaTtcblxuICBmb3IgKGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgKytpKSB7XG4gICAgcmVzLnB1c2goZm4oYXJyW2ldLCBpKSk7XG4gIH1cblxuICByZXR1cm4gcmVzO1xufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1vZChuLCB4KSB7XG4gIHJldHVybiAobiAlIHggKyB4KSAlIHg7XG59IiwidmFyIHNvbWU7XG5cbmlmIChBcnJheS5wcm90b3R5cGUuc29tZSkge1xuICBzb21lID0gQXJyYXkucHJvdG90eXBlLnNvbWU7XG59IGVsc2Uge1xuICBzb21lID0gZnVuY3Rpb24gc29tZShmdW4pIHtcbiAgICB2YXIgdCA9IE9iamVjdCh0aGlzKTtcbiAgICB2YXIgbGVuID0gdC5sZW5ndGggPj4+IDA7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAoaSBpbiB0ICYmIGZ1bi5jYWxsKHRoaXMsIHRbaV0sIGksIHQpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbn1cblxuZXhwb3J0IHsgc29tZSBhcyBkZWZhdWx0IH07IiwiaW1wb3J0IGFic0Zsb29yIGZyb20gJy4vYWJzLWZsb29yJztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRvSW50KGFyZ3VtZW50Rm9yQ29lcmNpb24pIHtcbiAgdmFyIGNvZXJjZWROdW1iZXIgPSArYXJndW1lbnRGb3JDb2VyY2lvbixcbiAgICAgIHZhbHVlID0gMDtcblxuICBpZiAoY29lcmNlZE51bWJlciAhPT0gMCAmJiBpc0Zpbml0ZShjb2VyY2VkTnVtYmVyKSkge1xuICAgIHZhbHVlID0gYWJzRmxvb3IoY29lcmNlZE51bWJlcik7XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gemVyb0ZpbGwobnVtYmVyLCB0YXJnZXRMZW5ndGgsIGZvcmNlU2lnbikge1xuICB2YXIgYWJzTnVtYmVyID0gJycgKyBNYXRoLmFicyhudW1iZXIpLFxuICAgICAgemVyb3NUb0ZpbGwgPSB0YXJnZXRMZW5ndGggLSBhYnNOdW1iZXIubGVuZ3RoLFxuICAgICAgc2lnbiA9IG51bWJlciA+PSAwO1xuICByZXR1cm4gKHNpZ24gPyBmb3JjZVNpZ24gPyAnKycgOiAnJyA6ICctJykgKyBNYXRoLnBvdygxMCwgTWF0aC5tYXgoMCwgemVyb3NUb0ZpbGwpKS50b1N0cmluZygpLnN1YnN0cigxKSArIGFic051bWJlcjtcbn0iLCJpbXBvcnQgeyBob29rcyBhcyBtb21lbnQsIHNldEhvb2tDYWxsYmFjayB9IGZyb20gJy4vbGliL3V0aWxzL2hvb2tzJztcbm1vbWVudC52ZXJzaW9uID0gJzIuMjQuMCc7XG5pbXBvcnQgeyBtaW4sIG1heCwgbm93LCBpc01vbWVudCwgbW9tZW50UHJvdG90eXBlIGFzIGZuLCBjcmVhdGVVVEMgYXMgdXRjLCBjcmVhdGVVbml4IGFzIHVuaXgsIGNyZWF0ZUxvY2FsIGFzIGxvY2FsLCBjcmVhdGVJbnZhbGlkIGFzIGludmFsaWQsIGNyZWF0ZUluWm9uZSBhcyBwYXJzZVpvbmUgfSBmcm9tICcuL2xpYi9tb21lbnQvbW9tZW50JztcbmltcG9ydCB7IGdldENhbGVuZGFyRm9ybWF0IH0gZnJvbSAnLi9saWIvbW9tZW50L2NhbGVuZGFyJztcbmltcG9ydCB7IGRlZmluZUxvY2FsZSwgdXBkYXRlTG9jYWxlLCBnZXRTZXRHbG9iYWxMb2NhbGUgYXMgbG9jYWxlLCBnZXRMb2NhbGUgYXMgbG9jYWxlRGF0YSwgbGlzdExvY2FsZXMgYXMgbG9jYWxlcywgbGlzdE1vbnRocyBhcyBtb250aHMsIGxpc3RNb250aHNTaG9ydCBhcyBtb250aHNTaG9ydCwgbGlzdFdlZWtkYXlzIGFzIHdlZWtkYXlzLCBsaXN0V2Vla2RheXNNaW4gYXMgd2Vla2RheXNNaW4sIGxpc3RXZWVrZGF5c1Nob3J0IGFzIHdlZWtkYXlzU2hvcnQgfSBmcm9tICcuL2xpYi9sb2NhbGUvbG9jYWxlJztcbmltcG9ydCB7IGlzRHVyYXRpb24sIGNyZWF0ZUR1cmF0aW9uIGFzIGR1cmF0aW9uLCBnZXRTZXRSZWxhdGl2ZVRpbWVSb3VuZGluZyBhcyByZWxhdGl2ZVRpbWVSb3VuZGluZywgZ2V0U2V0UmVsYXRpdmVUaW1lVGhyZXNob2xkIGFzIHJlbGF0aXZlVGltZVRocmVzaG9sZCB9IGZyb20gJy4vbGliL2R1cmF0aW9uL2R1cmF0aW9uJztcbmltcG9ydCB7IG5vcm1hbGl6ZVVuaXRzIH0gZnJvbSAnLi9saWIvdW5pdHMvdW5pdHMnO1xuaW1wb3J0IGlzRGF0ZSBmcm9tICcuL2xpYi91dGlscy9pcy1kYXRlJztcbnNldEhvb2tDYWxsYmFjayhsb2NhbCk7XG5tb21lbnQuZm4gPSBmbjtcbm1vbWVudC5taW4gPSBtaW47XG5tb21lbnQubWF4ID0gbWF4O1xubW9tZW50Lm5vdyA9IG5vdztcbm1vbWVudC51dGMgPSB1dGM7XG5tb21lbnQudW5peCA9IHVuaXg7XG5tb21lbnQubW9udGhzID0gbW9udGhzO1xubW9tZW50LmlzRGF0ZSA9IGlzRGF0ZTtcbm1vbWVudC5sb2NhbGUgPSBsb2NhbGU7XG5tb21lbnQuaW52YWxpZCA9IGludmFsaWQ7XG5tb21lbnQuZHVyYXRpb24gPSBkdXJhdGlvbjtcbm1vbWVudC5pc01vbWVudCA9IGlzTW9tZW50O1xubW9tZW50LndlZWtkYXlzID0gd2Vla2RheXM7XG5tb21lbnQucGFyc2Vab25lID0gcGFyc2Vab25lO1xubW9tZW50LmxvY2FsZURhdGEgPSBsb2NhbGVEYXRhO1xubW9tZW50LmlzRHVyYXRpb24gPSBpc0R1cmF0aW9uO1xubW9tZW50Lm1vbnRoc1Nob3J0ID0gbW9udGhzU2hvcnQ7XG5tb21lbnQud2Vla2RheXNNaW4gPSB3ZWVrZGF5c01pbjtcbm1vbWVudC5kZWZpbmVMb2NhbGUgPSBkZWZpbmVMb2NhbGU7XG5tb21lbnQudXBkYXRlTG9jYWxlID0gdXBkYXRlTG9jYWxlO1xubW9tZW50LmxvY2FsZXMgPSBsb2NhbGVzO1xubW9tZW50LndlZWtkYXlzU2hvcnQgPSB3ZWVrZGF5c1Nob3J0O1xubW9tZW50Lm5vcm1hbGl6ZVVuaXRzID0gbm9ybWFsaXplVW5pdHM7XG5tb21lbnQucmVsYXRpdmVUaW1lUm91bmRpbmcgPSByZWxhdGl2ZVRpbWVSb3VuZGluZztcbm1vbWVudC5yZWxhdGl2ZVRpbWVUaHJlc2hvbGQgPSByZWxhdGl2ZVRpbWVUaHJlc2hvbGQ7XG5tb21lbnQuY2FsZW5kYXJGb3JtYXQgPSBnZXRDYWxlbmRhckZvcm1hdDtcbm1vbWVudC5wcm90b3R5cGUgPSBmbjtcbm1vbWVudC5IVE1MNV9GTVQgPSB7XG4gIERBVEVUSU1FX0xPQ0FMOiAnWVlZWS1NTS1ERFRISDptbScsXG4gIERBVEVUSU1FX0xPQ0FMX1NFQ09ORFM6ICdZWVlZLU1NLUREVEhIOm1tOnNzJyxcbiAgREFURVRJTUVfTE9DQUxfTVM6ICdZWVlZLU1NLUREVEhIOm1tOnNzLlNTUycsXG4gIERBVEU6ICdZWVlZLU1NLUREJyxcbiAgVElNRTogJ0hIOm1tJyxcbiAgVElNRV9TRUNPTkRTOiAnSEg6bW06c3MnLFxuICBUSU1FX01TOiAnSEg6bW06c3MuU1NTJyxcbiAgV0VFSzogJ0dHR0ctW1ddV1cnLFxuICBNT05USDogJ1lZWVktTU0nXG59O1xuZXhwb3J0IGRlZmF1bHQgbW9tZW50OyIsIihmdW5jdGlvbiAoZ2xvYmFsLCB1bmRlZmluZWQpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgaWYgKGdsb2JhbC5zZXRJbW1lZGlhdGUpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgbmV4dEhhbmRsZSA9IDE7XG4gIHZhciB0YXNrc0J5SGFuZGxlID0ge307XG4gIHZhciBjdXJyZW50bHlSdW5uaW5nQVRhc2sgPSBmYWxzZTtcbiAgdmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDtcbiAgdmFyIHJlZ2lzdGVySW1tZWRpYXRlO1xuXG4gIGZ1bmN0aW9uIHNldEltbWVkaWF0ZShjYWxsYmFjaykge1xuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY2FsbGJhY2sgPSBuZXcgRnVuY3Rpb24oXCJcIiArIGNhbGxiYWNrKTtcbiAgICB9XG5cbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGFyZ3NbaV0gPSBhcmd1bWVudHNbaSArIDFdO1xuICAgIH1cblxuICAgIHZhciB0YXNrID0ge1xuICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuICAgICAgYXJnczogYXJnc1xuICAgIH07XG4gICAgdGFza3NCeUhhbmRsZVtuZXh0SGFuZGxlXSA9IHRhc2s7XG4gICAgcmVnaXN0ZXJJbW1lZGlhdGUobmV4dEhhbmRsZSk7XG4gICAgcmV0dXJuIG5leHRIYW5kbGUrKztcbiAgfVxuXG4gIGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGhhbmRsZSkge1xuICAgIGRlbGV0ZSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG4gIH1cblxuICBmdW5jdGlvbiBydW4odGFzaykge1xuICAgIHZhciBjYWxsYmFjayA9IHRhc2suY2FsbGJhY2s7XG4gICAgdmFyIGFyZ3MgPSB0YXNrLmFyZ3M7XG5cbiAgICBzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIDE6XG4gICAgICAgIGNhbGxiYWNrKGFyZ3NbMF0pO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAyOlxuICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgMzpcbiAgICAgICAgY2FsbGJhY2soYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjYWxsYmFjay5hcHBseSh1bmRlZmluZWQsIGFyZ3MpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBydW5JZlByZXNlbnQoaGFuZGxlKSB7XG4gICAgaWYgKGN1cnJlbnRseVJ1bm5pbmdBVGFzaykge1xuICAgICAgc2V0VGltZW91dChydW5JZlByZXNlbnQsIDAsIGhhbmRsZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciB0YXNrID0gdGFza3NCeUhhbmRsZVtoYW5kbGVdO1xuXG4gICAgICBpZiAodGFzaykge1xuICAgICAgICBjdXJyZW50bHlSdW5uaW5nQVRhc2sgPSB0cnVlO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcnVuKHRhc2spO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIGNsZWFySW1tZWRpYXRlKGhhbmRsZSk7XG4gICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBpbnN0YWxsTmV4dFRpY2tJbXBsZW1lbnRhdGlvbigpIHtcbiAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uIHJlZ2lzdGVySW1tZWRpYXRlKGhhbmRsZSkge1xuICAgICAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNhblVzZVBvc3RNZXNzYWdlKCkge1xuICAgIGlmIChnbG9iYWwucG9zdE1lc3NhZ2UgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKSB7XG4gICAgICB2YXIgcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cyA9IHRydWU7XG4gICAgICB2YXIgb2xkT25NZXNzYWdlID0gZ2xvYmFsLm9ubWVzc2FnZTtcblxuICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cyA9IGZhbHNlO1xuICAgICAgfTtcblxuICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKFwiXCIsIFwiKlwiKTtcbiAgICAgIGdsb2JhbC5vbm1lc3NhZ2UgPSBvbGRPbk1lc3NhZ2U7XG4gICAgICByZXR1cm4gcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cztcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpIHtcbiAgICB2YXIgbWVzc2FnZVByZWZpeCA9IFwic2V0SW1tZWRpYXRlJFwiICsgTWF0aC5yYW5kb20oKSArIFwiJFwiO1xuXG4gICAgdmFyIG9uR2xvYmFsTWVzc2FnZSA9IGZ1bmN0aW9uIG9uR2xvYmFsTWVzc2FnZShldmVudCkge1xuICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gZ2xvYmFsICYmIHR5cGVvZiBldmVudC5kYXRhID09PSBcInN0cmluZ1wiICYmIGV2ZW50LmRhdGEuaW5kZXhPZihtZXNzYWdlUHJlZml4KSA9PT0gMCkge1xuICAgICAgICBydW5JZlByZXNlbnQoK2V2ZW50LmRhdGEuc2xpY2UobWVzc2FnZVByZWZpeC5sZW5ndGgpKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgb25HbG9iYWxNZXNzYWdlLCBmYWxzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGdsb2JhbC5hdHRhY2hFdmVudChcIm9ubWVzc2FnZVwiLCBvbkdsb2JhbE1lc3NhZ2UpO1xuICAgIH1cblxuICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24gcmVnaXN0ZXJJbW1lZGlhdGUoaGFuZGxlKSB7XG4gICAgICBnbG9iYWwucG9zdE1lc3NhZ2UobWVzc2FnZVByZWZpeCArIGhhbmRsZSwgXCIqXCIpO1xuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBpbnN0YWxsTWVzc2FnZUNoYW5uZWxJbXBsZW1lbnRhdGlvbigpIHtcbiAgICB2YXIgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpO1xuXG4gICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIHZhciBoYW5kbGUgPSBldmVudC5kYXRhO1xuICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7XG4gICAgfTtcblxuICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24gcmVnaXN0ZXJJbW1lZGlhdGUoaGFuZGxlKSB7XG4gICAgICBjaGFubmVsLnBvcnQyLnBvc3RNZXNzYWdlKGhhbmRsZSk7XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKSB7XG4gICAgdmFyIGh0bWwgPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbiByZWdpc3RlckltbWVkaWF0ZShoYW5kbGUpIHtcbiAgICAgIHZhciBzY3JpcHQgPSBkb2MuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcblxuICAgICAgc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7XG4gICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICBodG1sLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gICAgICAgIHNjcmlwdCA9IG51bGw7XG4gICAgICB9O1xuXG4gICAgICBodG1sLmFwcGVuZENoaWxkKHNjcmlwdCk7XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGluc3RhbGxTZXRUaW1lb3V0SW1wbGVtZW50YXRpb24oKSB7XG4gICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbiByZWdpc3RlckltbWVkaWF0ZShoYW5kbGUpIHtcbiAgICAgIHNldFRpbWVvdXQocnVuSWZQcmVzZW50LCAwLCBoYW5kbGUpO1xuICAgIH07XG4gIH1cblxuICB2YXIgYXR0YWNoVG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgJiYgT2JqZWN0LmdldFByb3RvdHlwZU9mKGdsb2JhbCk7XG4gIGF0dGFjaFRvID0gYXR0YWNoVG8gJiYgYXR0YWNoVG8uc2V0VGltZW91dCA/IGF0dGFjaFRvIDogZ2xvYmFsO1xuXG4gIGlmICh7fS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gXCJbb2JqZWN0IHByb2Nlc3NdXCIpIHtcbiAgICBpbnN0YWxsTmV4dFRpY2tJbXBsZW1lbnRhdGlvbigpO1xuICB9IGVsc2UgaWYgKGNhblVzZVBvc3RNZXNzYWdlKCkpIHtcbiAgICBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpO1xuICB9IGVsc2UgaWYgKGdsb2JhbC5NZXNzYWdlQ2hhbm5lbCkge1xuICAgIGluc3RhbGxNZXNzYWdlQ2hhbm5lbEltcGxlbWVudGF0aW9uKCk7XG4gIH0gZWxzZSBpZiAoZG9jICYmIFwib25yZWFkeXN0YXRlY2hhbmdlXCIgaW4gZG9jLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIikpIHtcbiAgICBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCk7XG4gIH0gZWxzZSB7XG4gICAgaW5zdGFsbFNldFRpbWVvdXRJbXBsZW1lbnRhdGlvbigpO1xuICB9XG5cbiAgYXR0YWNoVG8uc2V0SW1tZWRpYXRlID0gc2V0SW1tZWRpYXRlO1xuICBhdHRhY2hUby5jbGVhckltbWVkaWF0ZSA9IGNsZWFySW1tZWRpYXRlO1xufSkodHlwZW9mIHNlbGYgPT09IFwidW5kZWZpbmVkXCIgPyB0eXBlb2YgZ2xvYmFsID09PSBcInVuZGVmaW5lZFwiID8gdGhpcyA6IGdsb2JhbCA6IHNlbGYpOyIsInZhciBzY29wZSA9IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgJiYgZ2xvYmFsIHx8IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYgfHwgd2luZG93O1xudmFyIGFwcGx5ID0gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5O1xuXG5leHBvcnRzLnNldFRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBuZXcgVGltZW91dChhcHBseS5jYWxsKHNldFRpbWVvdXQsIHNjb3BlLCBhcmd1bWVudHMpLCBjbGVhclRpbWVvdXQpO1xufTtcblxuZXhwb3J0cy5zZXRJbnRlcnZhbCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0SW50ZXJ2YWwsIHNjb3BlLCBhcmd1bWVudHMpLCBjbGVhckludGVydmFsKTtcbn07XG5cbmV4cG9ydHMuY2xlYXJUaW1lb3V0ID0gZXhwb3J0cy5jbGVhckludGVydmFsID0gZnVuY3Rpb24gKHRpbWVvdXQpIHtcbiAgaWYgKHRpbWVvdXQpIHtcbiAgICB0aW1lb3V0LmNsb3NlKCk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIFRpbWVvdXQoaWQsIGNsZWFyRm4pIHtcbiAgdGhpcy5faWQgPSBpZDtcbiAgdGhpcy5fY2xlYXJGbiA9IGNsZWFyRm47XG59XG5cblRpbWVvdXQucHJvdG90eXBlLnVucmVmID0gVGltZW91dC5wcm90b3R5cGUucmVmID0gZnVuY3Rpb24gKCkge307XG5cblRpbWVvdXQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLl9jbGVhckZuLmNhbGwoc2NvcGUsIHRoaXMuX2lkKTtcbn07XG5cbmV4cG9ydHMuZW5yb2xsID0gZnVuY3Rpb24gKGl0ZW0sIG1zZWNzKSB7XG4gIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTtcbiAgaXRlbS5faWRsZVRpbWVvdXQgPSBtc2Vjcztcbn07XG5cbmV4cG9ydHMudW5lbnJvbGwgPSBmdW5jdGlvbiAoaXRlbSkge1xuICBjbGVhclRpbWVvdXQoaXRlbS5faWRsZVRpbWVvdXRJZCk7XG4gIGl0ZW0uX2lkbGVUaW1lb3V0ID0gLTE7XG59O1xuXG5leHBvcnRzLl91bnJlZkFjdGl2ZSA9IGV4cG9ydHMuYWN0aXZlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICB2YXIgbXNlY3MgPSBpdGVtLl9pZGxlVGltZW91dDtcblxuICBpZiAobXNlY3MgPj0gMCkge1xuICAgIGl0ZW0uX2lkbGVUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIG9uVGltZW91dCgpIHtcbiAgICAgIGlmIChpdGVtLl9vblRpbWVvdXQpIGl0ZW0uX29uVGltZW91dCgpO1xuICAgIH0sIG1zZWNzKTtcbiAgfVxufTtcblxucmVxdWlyZShcInNldGltbWVkaWF0ZVwiKTtcblxuZXhwb3J0cy5zZXRJbW1lZGlhdGUgPSB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmLnNldEltbWVkaWF0ZSB8fCB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiICYmIGdsb2JhbC5zZXRJbW1lZGlhdGUgfHwgdGhpcyAmJiB0aGlzLnNldEltbWVkaWF0ZTtcbmV4cG9ydHMuY2xlYXJJbW1lZGlhdGUgPSB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmLmNsZWFySW1tZWRpYXRlIHx8IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgJiYgZ2xvYmFsLmNsZWFySW1tZWRpYXRlIHx8IHRoaXMgJiYgdGhpcy5jbGVhckltbWVkaWF0ZTsiLCJmdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IG9sRXZlbnRzRXZlbnQgZnJvbSAnb2wvZXZlbnRzL0V2ZW50LmpzJztcblxudmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gKF9vbEV2ZW50c0V2ZW50KSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfb2xFdmVudHNFdmVudCk7XG5cbiAgZnVuY3Rpb24gX2RlZmF1bHQodHlwZSwgZGV0YWlsKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgaWYgKGRldGFpbCA9PT0gdm9pZCAwKSB7XG4gICAgICBkZXRhaWwgPSB7fTtcbiAgICB9XG5cbiAgICBfdGhpcyA9IF9vbEV2ZW50c0V2ZW50LmNhbGwodGhpcywgdHlwZSkgfHwgdGhpcztcbiAgICBfdGhpcy5kZXRhaWwgPSBkZXRhaWw7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIF9kZWZhdWx0O1xufShvbEV2ZW50c0V2ZW50KTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsImV4cG9ydCBkZWZhdWx0IHtcbiAgQ0lSQ0xFOiAnQ2lyY2xlJyxcbiAgTElORV9TVFJJTkc6ICdMaW5lU3RyaW5nJyxcbiAgTVVMVElfTElORV9TVFJJTkc6ICdNdWx0aUxpbmVTdHJpbmcnLFxuICBNVUxUSV9QT0lOVDogJ011bHRpUG9pbnQnLFxuICBNVUxUSV9QT0xZR09OOiAnTXVsdGlQb2x5Z29uJyxcbiAgUE9JTlQ6ICdQb2ludCcsXG4gIFBPTFlHT046ICdQb2x5Z29uJyxcbiAgUkVDVEFOR0xFOiAnUmVjdGFuZ2xlJyxcbiAgVEVYVDogJ1RleHQnXG59OyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgbmdlb0N1c3RvbUV2ZW50IGZyb20gJ25nZW8vQ3VzdG9tRXZlbnQuanMnO1xuaW1wb3J0IHsgbGlzdGVuLCB1bmxpc3RlbkJ5S2V5IH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbE92ZXJsYXkgZnJvbSAnb2wvT3ZlcmxheS5qcyc7XG5pbXBvcnQgb2xPdmVybGF5UG9zaXRpb25pbmcgZnJvbSAnb2wvT3ZlcmxheVBvc2l0aW9uaW5nLmpzJztcblxudmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gKF9vbE92ZXJsYXkpIHtcbiAgX2luaGVyaXRzTG9vc2UoX2RlZmF1bHQsIF9vbE92ZXJsYXkpO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG1lbnVPcHRpb25zLCBvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkge1xuICAgICAgb3B0aW9ucyA9IHt9O1xuICAgIH1cblxuICAgIG9wdGlvbnMucG9zaXRpb25pbmcgPSBvbE92ZXJsYXlQb3NpdGlvbmluZy5UT1BfTEVGVDtcblxuICAgIGlmICghbWVudU9wdGlvbnMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtZW51T3B0aW9ucycpO1xuICAgIH1cblxuICAgIF90aGlzID0gX29sT3ZlcmxheS5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgX3RoaXMubGlzdGVuZXJLZXlzXyA9IFtdO1xuICAgIF90aGlzLmNsaWNrT3V0TGlzdGVuZXJLZXlfID0gbnVsbDtcbiAgICB2YXIgY29udGVudEVsID0gJCgnPGRpdi8+Jywge1xuICAgICAgJ2NsYXNzJzogJ3BhbmVsIHBhbmVsLWRlZmF1bHQnXG4gICAgfSk7XG4gICAgX3RoaXMuYXV0b0Nsb3NlXyA9IG1lbnVPcHRpb25zLmF1dG9DbG9zZSAhPT0gdW5kZWZpbmVkID8gbWVudU9wdGlvbnMuYXV0b0Nsb3NlIDogdHJ1ZTtcblxuICAgIGlmIChtZW51T3B0aW9ucy50aXRsZSkge1xuICAgICAgdmFyIGhlYWRlckVsID0gJCgnPGRpdj4nLCB7XG4gICAgICAgICdjbGFzcyc6ICdwYW5lbC1oZWFkaW5nJ1xuICAgICAgfSkuYXBwZW5kVG8oY29udGVudEVsKTtcbiAgICAgICQoJzxzcGFuPicsIHtcbiAgICAgICAgdGV4dDogbWVudU9wdGlvbnMudGl0bGVcbiAgICAgIH0pLmFwcGVuZFRvKGhlYWRlckVsKTtcbiAgICB9XG5cbiAgICB2YXIgYWN0aW9uc0VsID0gJCgnPGRpdj4nLCB7XG4gICAgICAnY2xhc3MnOiAnbGlzdC1ncm91cCdcbiAgICB9KS5hcHBlbmRUbyhjb250ZW50RWwpO1xuICAgIF90aGlzLmFjdGlvbnNfID0gW107XG4gICAgbWVudU9wdGlvbnMuYWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgIF90aGlzLmFjdGlvbnNfLnB1c2goJCgnPGJ1dHRvbj4nLCB7XG4gICAgICAgICdjbGFzcyc6ICdsaXN0LWdyb3VwLWl0ZW0gYnRuJyxcbiAgICAgICAgJ2RhdGEtbmFtZSc6IGFjdGlvbi5uYW1lLFxuICAgICAgICAndGV4dCc6IFsnICcsIGFjdGlvbi5sYWJlbCAhPT0gdW5kZWZpbmVkID8gYWN0aW9uLmxhYmVsIDogYWN0aW9uLm5hbWVdLmpvaW4oJycpXG4gICAgICB9KS5hcHBlbmRUbyhhY3Rpb25zRWwpLnByZXBlbmQoJCgnPHNwYW4+Jywge1xuICAgICAgICAnY2xhc3MnOiBhY3Rpb24uY2xzICE9PSB1bmRlZmluZWQgPyBhY3Rpb24uY2xzIDogJydcbiAgICAgIH0pKSk7XG4gICAgfSk7XG5cbiAgICBfdGhpcy5zZXRFbGVtZW50KGNvbnRlbnRFbFswXSk7XG5cbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gX2RlZmF1bHQucHJvdG90eXBlO1xuXG4gIF9wcm90by5zZXRNYXAgPSBmdW5jdGlvbiBzZXRNYXAobWFwKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgY3VycmVudE1hcCA9IHRoaXMuZ2V0TWFwKCk7XG5cbiAgICBpZiAoY3VycmVudE1hcCkge1xuICAgICAgdGhpcy5saXN0ZW5lcktleXNfLmZvckVhY2godW5saXN0ZW5CeUtleSk7XG4gICAgICB0aGlzLmxpc3RlbmVyS2V5c18ubGVuZ3RoID0gMDtcbiAgICB9XG5cbiAgICBvbE92ZXJsYXkucHJvdG90eXBlLnNldE1hcC5jYWxsKHRoaXMsIG1hcCk7XG5cbiAgICBpZiAobWFwKSB7XG4gICAgICB0aGlzLmFjdGlvbnNfLmZvckVhY2goZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICB2YXIgZGF0YSA9IGFjdGlvbi5kYXRhKCk7XG5cbiAgICAgICAgX3RoaXMyLmxpc3RlbmVyS2V5c18ucHVzaChsaXN0ZW4oYWN0aW9uWzBdLCAnY2xpY2snLCBfdGhpczIuaGFuZGxlQWN0aW9uQ2xpY2tfLmJpbmQoX3RoaXMyLCBkYXRhLm5hbWUpKSk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMubGlzdGVuZXJLZXlzXy5wdXNoKGxpc3RlbihtYXAsICdwb2ludGVybW92ZScsIHRoaXMuaGFuZGxlTWFwUG9pbnRlck1vdmVfLCB0aGlzKSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5vcGVuID0gZnVuY3Rpb24gb3Blbihjb29yZGluYXRlKSB7XG4gICAgdGhpcy5zZXRQb3NpdGlvbihjb29yZGluYXRlKTtcblxuICAgIGlmICghKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCBpbnN0YW5jZW9mIEV2ZW50VGFyZ2V0KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBkb2N1bWVudCBlbGVtZW50IHR5cGUnKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5hdXRvQ2xvc2VfKSB7XG4gICAgICB0aGlzLmNsaWNrT3V0TGlzdGVuZXJLZXlfID0gbGlzdGVuKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgJ21vdXNlZG93bicsIHRoaXMuaGFuZGxlQ2xpY2tPdXRfLCB0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgdGhpcy5zZXRQb3NpdGlvbih1bmRlZmluZWQpO1xuXG4gICAgaWYgKHRoaXMuY2xpY2tPdXRMaXN0ZW5lcktleV8gIT09IG51bGwpIHtcbiAgICAgIHVubGlzdGVuQnlLZXkodGhpcy5jbGlja091dExpc3RlbmVyS2V5Xyk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVBY3Rpb25DbGlja18gPSBmdW5jdGlvbiBoYW5kbGVBY3Rpb25DbGlja18oYWN0aW9uLCBldnQpIHtcbiAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IG5nZW9DdXN0b21FdmVudCgnYWN0aW9uY2xpY2snLCB7XG4gICAgICBhY3Rpb246IGFjdGlvblxuICAgIH0pKTtcblxuICAgIGlmICh0aGlzLmF1dG9DbG9zZV8pIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG5cbiAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUNsaWNrT3V0XyA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrT3V0XyhldnQpIHtcbiAgICB2YXIgZWxlbWVudCA9IHRoaXMuZ2V0RWxlbWVudCgpO1xuXG4gICAgaWYgKGVsZW1lbnQgJiYgJChldnQudGFyZ2V0KS5jbG9zZXN0KGVsZW1lbnQpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlTWFwUG9pbnRlck1vdmVfID0gZnVuY3Rpb24gaGFuZGxlTWFwUG9pbnRlck1vdmVfKGV2dCkge1xuICAgIHZhciBteUV2ZW50ID0gZXZ0O1xuICAgIHZhciB0YXJnZXQgPSBteUV2ZW50Lm9yaWdpbmFsRXZlbnQudGFyZ2V0O1xuICAgIHZhciBlbGVtZW50ID0gdGhpcy5nZXRFbGVtZW50KCk7XG5cbiAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudCAmJiBlbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCAmJiBlbGVtZW50LmNvbnRhaW5zKHRhcmdldCkpIHtcbiAgICAgIG15RXZlbnQuY29vcmRpbmF0ZSA9IFtJbmZpbml0eSwgSW5maW5pdHldO1xuICAgICAgbXlFdmVudC5waXhlbCA9IFtJbmZpbml0eSwgSW5maW5pdHldO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gX2RlZmF1bHQ7XG59KG9sT3ZlcmxheSk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBvbE92ZXJsYXkgZnJvbSAnb2wvT3ZlcmxheS5qcyc7XG5cbnZhciBfZGVmYXVsdCA9IGZ1bmN0aW9uIChfb2xPdmVybGF5KSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfb2xPdmVybGF5KTtcblxuICBmdW5jdGlvbiBfZGVmYXVsdChvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkge1xuICAgICAgb3B0aW9ucyA9IHt9O1xuICAgIH1cblxuICAgIHZhciBvcmlnaW5hbEVsID0gb3B0aW9ucy5lbGVtZW50ID8gb3B0aW9ucy5lbGVtZW50IDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgb3B0aW9ucy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgX3RoaXMgPSBfb2xPdmVybGF5LmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICB2YXIgY2xvc2VFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNsb3NlRWwuY2xhc3NOYW1lID0gJ2Nsb3NlJztcbiAgICBjbG9zZUVsLmlubmVySFRNTCA9ICcmdGltZXM7JztcbiAgICBjbG9zZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3RoaXMuY2xvc2UuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSkpO1xuICAgIF90aGlzLmNvbnRlbnRFbF8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgIF90aGlzLmNvbnRlbnRFbF8uYXBwZW5kKGNsb3NlRWwsIG9yaWdpbmFsRWwpO1xuXG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IF9kZWZhdWx0LnByb3RvdHlwZTtcblxuICBfcHJvdG8uY2xvc2UgPSBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICB2YXIgbWFwID0gdGhpcy5nZXRNYXAoKTtcblxuICAgIGlmIChtYXApIHtcbiAgICAgIG1hcC5yZW1vdmVPdmVybGF5KHRoaXMpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uc2V0TWFwID0gZnVuY3Rpb24gc2V0TWFwKG1hcCkge1xuICAgIHZhciBlbGVtZW50ID0gdGhpcy5nZXRFbGVtZW50KCk7XG5cbiAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBlbGVtZW50Jyk7XG4gICAgfVxuXG4gICAgdmFyIGN1cnJlbnRNYXAgPSB0aGlzLmdldE1hcCgpO1xuXG4gICAgaWYgKGN1cnJlbnRNYXApIHtcbiAgICAgICQoZWxlbWVudCkucG9wb3ZlcignZGlzcG9zZScpO1xuICAgIH1cblxuICAgIF9vbE92ZXJsYXkucHJvdG90eXBlLnNldE1hcC5jYWxsKHRoaXMsIG1hcCk7XG5cbiAgICBpZiAobWFwKSB7XG4gICAgICB2YXIgY29udGVudEVsID0gdGhpcy5jb250ZW50RWxfO1xuICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAkKGVsZW1lbnQpLnBvcG92ZXIoe1xuICAgICAgICAgIGNvbnRhaW5lcjogZWxlbWVudC5wYXJlbnRFbGVtZW50LFxuICAgICAgICAgIHBsYWNlbWVudDogJ3RvcCcsXG4gICAgICAgICAgY29udGVudDogY29udGVudEVsLFxuICAgICAgICAgIGh0bWw6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgICQoZWxlbWVudCkucG9wb3Zlcignc2hvdycpO1xuICAgICAgfSwgMCk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0ob2xPdmVybGF5KTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgb2xGb3JtYXRYTUwgZnJvbSAnb2wvZm9ybWF0L1hNTC5qcyc7XG5pbXBvcnQgKiBhcyBvbFhtbCBmcm9tICdvbC94bWwuanMnO1xudmFyIE5BTUVTUEFDRV9VUklTXyA9IFtudWxsLCAnaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEnXTtcblxuZnVuY3Rpb24gbWFrZVN0cnVjdHVyZU5TKG5hbWVzcGFjZVVSSXMsIHN0cnVjdHVyZSkge1xuICByZXR1cm4gb2xYbWwubWFrZVN0cnVjdHVyZU5TKG5hbWVzcGFjZVVSSXMsIHN0cnVjdHVyZSk7XG59XG5cbnZhciBQQVJTRVJTXyA9IG1ha2VTdHJ1Y3R1cmVOUyhOQU1FU1BBQ0VfVVJJU18sIHtcbiAgZWxlbWVudDogb2xYbWwubWFrZU9iamVjdFByb3BlcnR5UHVzaGVyKHJlYWRFbGVtZW50XyksXG4gIGNvbXBsZXhUeXBlOiBvbFhtbC5tYWtlT2JqZWN0UHJvcGVydHlQdXNoZXIocmVhZENvbXBsZXhUeXBlXylcbn0pO1xudmFyIENPTVBMRVhfVFlQRV9QQVJTRVJTXyA9IG1ha2VTdHJ1Y3R1cmVOUyhOQU1FU1BBQ0VfVVJJU18sIHtcbiAgY29tcGxleENvbnRlbnQ6IG9sWG1sLm1ha2VPYmplY3RQcm9wZXJ0eVNldHRlcihyZWFkQ29tcGxleENvbnRlbnRfKVxufSk7XG52YXIgQ09NUExFWF9DT05URU5UX1BBUlNFUlNfID0gbWFrZVN0cnVjdHVyZU5TKE5BTUVTUEFDRV9VUklTXywge1xuICBleHRlbnNpb246IG9sWG1sLm1ha2VPYmplY3RQcm9wZXJ0eVNldHRlcihyZWFkRXh0ZW5zaW9uXylcbn0pO1xudmFyIEVYVEVOU0lPTl9QQVJTRVJTXyA9IG1ha2VTdHJ1Y3R1cmVOUyhOQU1FU1BBQ0VfVVJJU18sIHtcbiAgc2VxdWVuY2U6IG9sWG1sLm1ha2VPYmplY3RQcm9wZXJ0eVNldHRlcihyZWFkU2VxdWVuY2VfKVxufSk7XG52YXIgU0VRVUVOQ0VfUEFSU0VSU18gPSBtYWtlU3RydWN0dXJlTlMoTkFNRVNQQUNFX1VSSVNfLCB7XG4gIGVsZW1lbnQ6IG9sWG1sLm1ha2VPYmplY3RQcm9wZXJ0eVB1c2hlcihyZWFkRWxlbWVudF8pXG59KTtcblxudmFyIFdGU0Rlc2NyaWJlRmVhdHVyZVR5cGUgPSBmdW5jdGlvbiAoX29sRm9ybWF0WE1MKSB7XG4gIF9pbmhlcml0c0xvb3NlKFdGU0Rlc2NyaWJlRmVhdHVyZVR5cGUsIF9vbEZvcm1hdFhNTCk7XG5cbiAgZnVuY3Rpb24gV0ZTRGVzY3JpYmVGZWF0dXJlVHlwZSgpIHtcbiAgICByZXR1cm4gX29sRm9ybWF0WE1MLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgfVxuXG4gIHJldHVybiBXRlNEZXNjcmliZUZlYXR1cmVUeXBlO1xufShvbEZvcm1hdFhNTCk7XG5cbldGU0Rlc2NyaWJlRmVhdHVyZVR5cGUucHJvdG90eXBlLnJlYWQ7XG5cbldGU0Rlc2NyaWJlRmVhdHVyZVR5cGUucHJvdG90eXBlLnJlYWRGcm9tRG9jdW1lbnQgPSBmdW5jdGlvbiAoZG9jKSB7XG4gIHZhciBub2RlO1xuXG4gIGZvciAobm9kZSA9IGRvYy5maXJzdENoaWxkOyBub2RlOyBub2RlID0gbm9kZS5uZXh0U2libGluZykge1xuICAgIGlmIChub2RlICYmIG5vZGUubm9kZVR5cGUgPT0gTm9kZS5FTEVNRU5UX05PREUpIHtcbiAgICAgIHJldHVybiB0aGlzLnJlYWRGcm9tTm9kZShub2RlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn07XG5cbldGU0Rlc2NyaWJlRmVhdHVyZVR5cGUucHJvdG90eXBlLnJlYWRGcm9tTm9kZSA9IGZ1bmN0aW9uIChub2RlKSB7XG4gIHZhciByZXN1bHQgPSB7fTtcbiAgcmVzdWx0ID0gb2xYbWwucHVzaFBhcnNlQW5kUG9wKHJlc3VsdCwgUEFSU0VSU18sIG5vZGUsIFtdKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbmZ1bmN0aW9uIHJlYWRFbGVtZW50Xyhub2RlLCBvYmplY3RTdGFjaykge1xuICB2YXIgYXR0cmlidXRlcyA9IHt9O1xuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBub2RlLmF0dHJpYnV0ZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICB2YXIgYXR0cmlidXRlID0gbm9kZS5hdHRyaWJ1dGVzLml0ZW0oaSk7XG5cbiAgICBpZiAoIWF0dHJpYnV0ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGF0dHJpYnV0ZScpO1xuICAgIH1cblxuICAgIGF0dHJpYnV0ZXNbYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlLnZhbHVlO1xuICB9XG5cbiAgaWYgKG9iamVjdFN0YWNrLmxlbmd0aCA9PT0gMSkge1xuICAgIHZhciBfYXR0cmlidXRlID0gYXR0cmlidXRlcy50eXBlLnNwbGl0KCc6JykucG9wKCk7XG5cbiAgICBpZiAoIV9hdHRyaWJ1dGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBhdHRyaWJ1dGUnKTtcbiAgICB9XG5cbiAgICBhdHRyaWJ1dGVzLnR5cGUgPSBfYXR0cmlidXRlO1xuICB9XG5cbiAgcmV0dXJuIGF0dHJpYnV0ZXM7XG59XG5cbmZ1bmN0aW9uIHJlYWRDb21wbGV4VHlwZV8obm9kZSwgb2JqZWN0U3RhY2spIHtcbiAgdmFyIG5hbWUgPSBub2RlLmdldEF0dHJpYnV0ZSgnbmFtZScpO1xuICB2YXIgb2JqZWN0ID0gb2xYbWwucHVzaFBhcnNlQW5kUG9wKHtcbiAgICBuYW1lOiBuYW1lXG4gIH0sIENPTVBMRVhfVFlQRV9QQVJTRVJTXywgbm9kZSwgb2JqZWN0U3RhY2spO1xuICBvYmplY3QuY29tcGxleENvbnRlbnQgPSBvYmplY3QuY29tcGxleENvbnRlbnQuZXh0ZW5zaW9uLnNlcXVlbmNlLmVsZW1lbnQ7XG4gIHJldHVybiBvYmplY3Q7XG59XG5cbmZ1bmN0aW9uIHJlYWRDb21wbGV4Q29udGVudF8obm9kZSwgb2JqZWN0U3RhY2spIHtcbiAgcmV0dXJuIG9sWG1sLnB1c2hQYXJzZUFuZFBvcCh7fSwgQ09NUExFWF9DT05URU5UX1BBUlNFUlNfLCBub2RlLCBvYmplY3RTdGFjayk7XG59XG5cbmZ1bmN0aW9uIHJlYWRFeHRlbnNpb25fKG5vZGUsIG9iamVjdFN0YWNrKSB7XG4gIHJldHVybiBvbFhtbC5wdXNoUGFyc2VBbmRQb3Aoe30sIEVYVEVOU0lPTl9QQVJTRVJTXywgbm9kZSwgb2JqZWN0U3RhY2spO1xufVxuXG5mdW5jdGlvbiByZWFkU2VxdWVuY2VfKG5vZGUsIG9iamVjdFN0YWNrKSB7XG4gIHJldHVybiBvbFhtbC5wdXNoUGFyc2VBbmRQb3Aoe30sIFNFUVVFTkNFX1BBUlNFUlNfLCBub2RlLCBvYmplY3RTdGFjayk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IFdGU0Rlc2NyaWJlRmVhdHVyZVR5cGU7IiwiaW1wb3J0IHsgaW5jbHVkZXMgYXMgb2xBcnJheUluY2x1ZGVzIH0gZnJvbSAnb2wvYXJyYXkuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIHB1c2hVbmxlc3NJbmNsdWRlZChhcnIsIG9iaikge1xuICB2YXIgcmV0ID0gZmFsc2U7XG5cbiAgaWYgKCFvbEFycmF5SW5jbHVkZXMoYXJyLCBvYmopKSB7XG4gICAgYXJyLnB1c2gob2JqKTtcbiAgICByZXQgPSB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIHJldDtcbn0iLCJmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbnZhciBEYXRhU291cmNlID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBEYXRhU291cmNlKG9wdGlvbnMpIHtcbiAgICB0aGlzLmluUmFuZ2UgPSBvcHRpb25zLmluUmFuZ2UgIT09IGZhbHNlO1xuICAgIHRoaXMudmlzaWJsZSA9IG9wdGlvbnMudmlzaWJsZSA9PT0gdHJ1ZTtcbiAgICB0aGlzLmF0dHJpYnV0ZXMgPSBvcHRpb25zLmF0dHJpYnV0ZXMgfHwgbnVsbDtcbiAgICB0aGlzLmlkXyA9IG9wdGlvbnMuaWQ7XG4gICAgdGhpcy5pZGVudGlmaWVyQXR0cmlidXRlXyA9IG9wdGlvbnMuaWRlbnRpZmllckF0dHJpYnV0ZTtcbiAgICB0aGlzLm1heFJlc29sdXRpb25fID0gb3B0aW9ucy5tYXhSZXNvbHV0aW9uO1xuICAgIHRoaXMubWluUmVzb2x1dGlvbl8gPSBvcHRpb25zLm1pblJlc29sdXRpb247XG4gICAgdGhpcy5uYW1lXyA9IG9wdGlvbnMubmFtZTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBEYXRhU291cmNlLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZ2V0QXR0cmlidXRlcyA9IGZ1bmN0aW9uIGdldEF0dHJpYnV0ZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlcztcbiAgfTtcblxuICBfcHJvdG8uc2V0QXR0cmlidXRlcyA9IGZ1bmN0aW9uIHNldEF0dHJpYnV0ZXMoYXR0cmlidXRlcykge1xuICAgIHRoaXMuYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXM7XG4gIH07XG5cbiAgX2NyZWF0ZUNsYXNzKERhdGFTb3VyY2UsIFt7XG4gICAga2V5OiBcImlkXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5pZF87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImlkZW50aWZpZXJBdHRyaWJ1dGVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmlkZW50aWZpZXJBdHRyaWJ1dGVfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJtYXhSZXNvbHV0aW9uXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tYXhSZXNvbHV0aW9uXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibWluUmVzb2x1dGlvblwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMubWluUmVzb2x1dGlvbl87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm5hbWVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLm5hbWVfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJxdWVyeWFibGVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic3VwcG9ydHNEeW5hbWljSW5SYW5nZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMubWF4UmVzb2x1dGlvbiAhPT0gbnVsbCB8fCB0aGlzLm1pblJlc29sdXRpb24gIT09IG51bGw7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIERhdGFTb3VyY2U7XG59KCk7XG5cbmV4cG9ydCBkZWZhdWx0IERhdGFTb3VyY2U7IiwiZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4sIHVubGlzdGVuQnlLZXkgfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sVmlldyBmcm9tICdvbC9WaWV3LmpzJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuZXhwb3J0IHZhciBEYXRhU291cmNlID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBEYXRhU291cmNlKCkge1xuICAgIHRoaXMuY29sbGVjdGlvbl8gPSBuZXcgb2xDb2xsZWN0aW9uKCk7XG4gICAgdGhpcy5tYXBfID0gbnVsbDtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgICBsaXN0ZW4odGhpcy5jb2xsZWN0aW9uXywgJ2FkZCcsIHRoaXMuaGFuZGxlRGF0YVNvdXJjZXNBZGRfLCB0aGlzKTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBEYXRhU291cmNlLnByb3RvdHlwZTtcblxuICBfcHJvdG8uYmluZE1hcF8gPSBmdW5jdGlvbiBiaW5kTWFwXyhtYXApIHtcbiAgICB2YXIgdmlldyA9IG1hcC5nZXRWaWV3KCk7XG4gICAgdGhpcy5saXN0ZW5lcktleXNfLnB1c2gobGlzdGVuKHZpZXcsICdjaGFuZ2U6cmVzb2x1dGlvbicsIHRoaXMuaGFuZGxlVmlld1Jlc29sdXRpb25DaGFuZ2VfLCB0aGlzKSk7XG4gICAgdmFyIHJlc29sdXRpb24gPSB2aWV3LmdldFJlc29sdXRpb24oKTtcblxuICAgIGlmIChyZXNvbHV0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyByZXNvbHV0aW9uJyk7XG4gICAgfVxuXG4gICAgdGhpcy5zeW5jRGF0YVNvdXJjZXNUb1Jlc29sdXRpb25fKHJlc29sdXRpb24pO1xuICB9O1xuXG4gIF9wcm90by51bmJpbmRNYXBfID0gZnVuY3Rpb24gdW5iaW5kTWFwXyhtYXApIHtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18uZm9yRWFjaCh1bmxpc3RlbkJ5S2V5KTtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlVmlld1Jlc29sdXRpb25DaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlVmlld1Jlc29sdXRpb25DaGFuZ2VfKGV2dCkge1xuICAgIHZhciB2aWV3ID0gZXZ0LnRhcmdldDtcblxuICAgIGlmICh2aWV3IGluc3RhbmNlb2Ygb2xWaWV3KSB7XG4gICAgICB2YXIgcmVzb2x1dGlvbiA9IHZpZXcuZ2V0UmVzb2x1dGlvbigpO1xuXG4gICAgICBpZiAocmVzb2x1dGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyByZXNvbHV0aW9uJyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc3luY0RhdGFTb3VyY2VzVG9SZXNvbHV0aW9uXyhyZXNvbHV0aW9uKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnN5bmNEYXRhU291cmNlc1RvUmVzb2x1dGlvbl8gPSBmdW5jdGlvbiBzeW5jRGF0YVNvdXJjZXNUb1Jlc29sdXRpb25fKHJlc29sdXRpb24pIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdGhpcy5jb2xsZWN0aW9uXy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhU291cmNlKSB7XG4gICAgICBfdGhpcy5zeW5jRGF0YVNvdXJjZVRvUmVzb2x1dGlvbl8oZGF0YVNvdXJjZSwgcmVzb2x1dGlvbik7XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLnN5bmNEYXRhU291cmNlVG9SZXNvbHV0aW9uXyA9IGZ1bmN0aW9uIHN5bmNEYXRhU291cmNlVG9SZXNvbHV0aW9uXyhkYXRhU291cmNlLCByZXNvbHV0aW9uKSB7XG4gICAgaWYgKCFkYXRhU291cmNlLnN1cHBvcnRzRHluYW1pY0luUmFuZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgbWF4UmVzb2x1dGlvbiA9IGRhdGFTb3VyY2UubWF4UmVzb2x1dGlvbjtcbiAgICB2YXIgbWluUmVzb2x1dGlvbiA9IGRhdGFTb3VyY2UubWluUmVzb2x1dGlvbjtcbiAgICB2YXIgaW5NaW5SYW5nZSA9IG1pblJlc29sdXRpb24gPT09IG51bGwgfHwgbWluUmVzb2x1dGlvbiA9PT0gdW5kZWZpbmVkIHx8IHJlc29sdXRpb24gPj0gbWluUmVzb2x1dGlvbjtcbiAgICB2YXIgaW5NYXhSYW5nZSA9IG1heFJlc29sdXRpb24gPT09IG51bGwgfHwgbWF4UmVzb2x1dGlvbiA9PT0gdW5kZWZpbmVkIHx8IHJlc29sdXRpb24gPD0gbWF4UmVzb2x1dGlvbjtcbiAgICB2YXIgaW5SYW5nZSA9IGluTWluUmFuZ2UgJiYgaW5NYXhSYW5nZTtcbiAgICBkYXRhU291cmNlLmluUmFuZ2UgPSBpblJhbmdlO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEYXRhU291cmNlc0FkZF8gPSBmdW5jdGlvbiBoYW5kbGVEYXRhU291cmNlc0FkZF8oZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBDb2xsZWN0aW9uRXZlbnQpIHtcbiAgICAgIHZhciBkYXRhU291cmNlID0gZXZlbnQuZWxlbWVudDtcblxuICAgICAgaWYgKHRoaXMubWFwXykge1xuICAgICAgICB2YXIgcmVzb2x1dGlvbiA9IHRoaXMubWFwXy5nZXRWaWV3KCkuZ2V0UmVzb2x1dGlvbigpO1xuXG4gICAgICAgIGlmIChyZXNvbHV0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVzb2x1dGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zeW5jRGF0YVNvdXJjZVRvUmVzb2x1dGlvbl8oZGF0YVNvdXJjZSwgcmVzb2x1dGlvbik7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhEYXRhU291cmNlLCBbe1xuICAgIGtleTogXCJtYXBcIixcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChtYXApIHtcbiAgICAgIGlmICh0aGlzLm1hcF8gPT09IG1hcCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm1hcF8pIHtcbiAgICAgICAgdGhpcy51bmJpbmRNYXBfKHRoaXMubWFwXyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubWFwXyA9IG1hcDtcblxuICAgICAgaWYgKG1hcCkge1xuICAgICAgICB0aGlzLmJpbmRNYXBfKG1hcCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvbGxlY3Rpb25cIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbGxlY3Rpb25fO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBEYXRhU291cmNlO1xufSgpO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvRGF0YVNvdXJjZXMnLCBbXSk7XG5tb2R1bGUuc2VydmljZSgnbmdlb0RhdGFTb3VyY2VzJywgRGF0YVNvdXJjZSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IG5nZW9EYXRhc291cmNlRGF0YVNvdXJjZSBmcm9tICduZ2VvL2RhdGFzb3VyY2UvRGF0YVNvdXJjZS5qcyc7XG5pbXBvcnQgb2xDb2xsZWN0aW9uIGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuaW1wb3J0IG9sTGF5ZXJWZWN0b3IgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yLmpzJztcbmltcG9ydCBvbFNvdXJjZVZlY3RvciBmcm9tICdvbC9zb3VyY2UvVmVjdG9yLmpzJztcblxudmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gKF9uZ2VvRGF0YXNvdXJjZURhdGFTbykge1xuICBfaW5oZXJpdHNMb29zZShfZGVmYXVsdCwgX25nZW9EYXRhc291cmNlRGF0YVNvKTtcblxuICBmdW5jdGlvbiBfZGVmYXVsdChvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX3RoaXMgPSBfbmdlb0RhdGFzb3VyY2VEYXRhU28uY2FsbCh0aGlzLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgIF90aGlzLmZlYXR1cmVzQ29sbGVjdGlvbl8gPSBvcHRpb25zLmZlYXR1cmVzIHx8IG5ldyBvbENvbGxlY3Rpb24oKTtcbiAgICBfdGhpcy5zb3VyY2VfID0gbmV3IG9sU291cmNlVmVjdG9yKHtcbiAgICAgIGZlYXR1cmVzOiBfdGhpcy5mZWF0dXJlc0NvbGxlY3Rpb25fLFxuICAgICAgd3JhcFg6IGZhbHNlXG4gICAgfSk7XG4gICAgX3RoaXMubGF5ZXJfID0gbmV3IG9sTGF5ZXJWZWN0b3Ioe1xuICAgICAgc291cmNlOiBfdGhpcy5zb3VyY2VfXG4gICAgfSk7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKF9kZWZhdWx0LCBbe1xuICAgIGtleTogXCJmZWF0dXJlc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZmVhdHVyZXNDb2xsZWN0aW9uXy5nZXRBcnJheSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJmZWF0dXJlc0NvbGxlY3Rpb25cIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmZlYXR1cmVzQ29sbGVjdGlvbl87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImxheWVyXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYXllcl87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImV4dGVudFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlXy5nZXRFeHRlbnQoKTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gX2RlZmF1bHQ7XG59KG5nZW9EYXRhc291cmNlRGF0YVNvdXJjZSk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJmdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IG5nZW9EYXRhc291cmNlRmlsZSBmcm9tICduZ2VvL2RhdGFzb3VyY2UvRmlsZS5qcyc7XG5pbXBvcnQgbmdlb0RhdGFzb3VyY2VHcm91cCBmcm9tICduZ2VvL2RhdGFzb3VyY2UvR3JvdXAuanMnO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoX25nZW9EYXRhc291cmNlR3JvdXApIHtcbiAgX2luaGVyaXRzTG9vc2UoX2RlZmF1bHQsIF9uZ2VvRGF0YXNvdXJjZUdyb3VwKTtcblxuICBmdW5jdGlvbiBfZGVmYXVsdChvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX3RoaXMgPSBfbmdlb0RhdGFzb3VyY2VHcm91cC5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgdmFyIGluamVjdG9yID0gb3B0aW9ucy5pbmplY3RvcjtcbiAgICBfdGhpcy5yb290U2NvcGVfID0gaW5qZWN0b3IuZ2V0KCckcm9vdFNjb3BlJyk7XG4gICAgX3RoaXMudW5yZWdpc3Rlcl8gPSB7fTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gX2RlZmF1bHQucHJvdG90eXBlO1xuXG4gIF9wcm90by5hZGREYXRhU291cmNlID0gZnVuY3Rpb24gYWRkRGF0YVNvdXJjZShkYXRhU291cmNlKSB7XG4gICAgX25nZW9EYXRhc291cmNlR3JvdXAucHJvdG90eXBlLmFkZERhdGFTb3VyY2UuY2FsbCh0aGlzLCBkYXRhU291cmNlKTtcblxuICAgIGlmICghKGRhdGFTb3VyY2UgaW5zdGFuY2VvZiBuZ2VvRGF0YXNvdXJjZUZpbGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGRhdGFzb3VyY2UgdHlwZScpO1xuICAgIH1cblxuICAgIHRoaXMucmVnaXN0ZXJEYXRhU291cmNlXyhkYXRhU291cmNlKTtcbiAgfTtcblxuICBfcHJvdG8ucmVnaXN0ZXJEYXRhU291cmNlXyA9IGZ1bmN0aW9uIHJlZ2lzdGVyRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSkge1xuICAgIHRoaXMudW5yZWdpc3Rlcl9bZGF0YVNvdXJjZS5pZF0gPSB0aGlzLnJvb3RTY29wZV8uJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBkYXRhU291cmNlLnZpc2libGU7XG4gICAgfSwgdGhpcy5oYW5kbGVEYXRhU291cmNlVmlzaWJsZUNoYW5nZV8uYmluZCh0aGlzLCBkYXRhU291cmNlKSk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZURhdGFTb3VyY2VWaXNpYmxlQ2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZURhdGFTb3VyY2VWaXNpYmxlQ2hhbmdlXyhkYXRhU291cmNlLCB2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZGF0YVNvdXJjZS5sYXllci5zZXRWaXNpYmxlKHZhbHVlKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZURhdGFTb3VyY2UgPSBmdW5jdGlvbiByZW1vdmVEYXRhU291cmNlKGRhdGFTb3VyY2UpIHtcbiAgICBfbmdlb0RhdGFzb3VyY2VHcm91cC5wcm90b3R5cGUucmVtb3ZlRGF0YVNvdXJjZS5jYWxsKHRoaXMsIGRhdGFTb3VyY2UpO1xuXG4gICAgaWYgKCEoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIG5nZW9EYXRhc291cmNlRmlsZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZGF0YXNvdXJjZSB0eXBlJyk7XG4gICAgfVxuXG4gICAgdGhpcy51bnJlZ2lzdGVyRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSk7XG4gIH07XG5cbiAgX3Byb3RvLnVucmVnaXN0ZXJEYXRhU291cmNlXyA9IGZ1bmN0aW9uIHVucmVnaXN0ZXJEYXRhU291cmNlXyhkYXRhU291cmNlKSB7XG4gICAgdGhpcy51bnJlZ2lzdGVyX1tkYXRhU291cmNlLmlkXSgpO1xuICAgIGRlbGV0ZSB0aGlzLnVucmVnaXN0ZXJfW2RhdGFTb3VyY2UuaWRdO1xuICB9O1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0obmdlb0RhdGFzb3VyY2VHcm91cCk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG52YXIgVmlzaWJpbGl0eVN0YXRlID0ge1xuICBJTkRFVEVSTUlOQVRFOiAnaW5kZXRlcm1pbmF0ZScsXG4gIE9GRjogJ29mZicsXG4gIE9OOiAnb24nXG59O1xuXG52YXIgR3JvdXAgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEdyb3VwKG9wdGlvbnMpIHtcbiAgICB0aGlzLmRhdGFTb3VyY2VzQ29sbGVjdGlvbl8gPSBuZXcgb2xDb2xsZWN0aW9uKG9wdGlvbnMuZGF0YVNvdXJjZXMpO1xuICAgIHRoaXMudGl0bGVfID0gb3B0aW9ucy50aXRsZTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBHcm91cC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmRlc3Ryb3kgPSBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgIHRoaXMuZGF0YVNvdXJjZXNDb2xsZWN0aW9uXy5jbGVhcigpO1xuICB9O1xuXG4gIF9wcm90by5nZXREYXRhU291cmNlU3RhdGUgPSBmdW5jdGlvbiBnZXREYXRhU291cmNlU3RhdGUoZGF0YVNvdXJjZSkge1xuICAgIHJldHVybiBkYXRhU291cmNlLnZpc2libGUgPyBWaXNpYmlsaXR5U3RhdGUuT04gOiBWaXNpYmlsaXR5U3RhdGUuT0ZGO1xuICB9O1xuXG4gIF9wcm90by5hZGREYXRhU291cmNlID0gZnVuY3Rpb24gYWRkRGF0YVNvdXJjZShkYXRhU291cmNlKSB7XG4gICAgdGhpcy5kYXRhU291cmNlc0NvbGxlY3Rpb25fLnB1c2goZGF0YVNvdXJjZSk7XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZURhdGFTb3VyY2UgPSBmdW5jdGlvbiByZW1vdmVEYXRhU291cmNlKGRhdGFTb3VyY2UpIHtcbiAgICB0aGlzLmRhdGFTb3VyY2VzQ29sbGVjdGlvbl8ucmVtb3ZlKGRhdGFTb3VyY2UpO1xuICB9O1xuXG4gIF9wcm90by50b2dnbGVWaXNpYmlsaXR5U3RhdGUgPSBmdW5jdGlvbiB0b2dnbGVWaXNpYmlsaXR5U3RhdGUoKSB7XG4gICAgdmFyIHZpc2libGVUb1NldCA9IHRoaXMudmlzaWJpbGl0eVN0YXRlICE9PSBWaXNpYmlsaXR5U3RhdGUuT047XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLmRhdGFTb3VyY2VzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGF0YVNvdXJjZSA9IF9yZWY7XG5cbiAgICAgIGlmIChkYXRhU291cmNlLnZpc2libGUgIT09IHZpc2libGVUb1NldCkge1xuICAgICAgICBkYXRhU291cmNlLnZpc2libGUgPSB2aXNpYmxlVG9TZXQ7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhHcm91cCwgW3tcbiAgICBrZXk6IFwiZGF0YVNvdXJjZXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmRhdGFTb3VyY2VzQ29sbGVjdGlvbl8uZ2V0QXJyYXkoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZGF0YVNvdXJjZXNDb2xsZWN0aW9uXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5kYXRhU291cmNlc0NvbGxlY3Rpb25fO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ0aXRsZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMudGl0bGVfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ2aXNpYmlsaXR5U3RhdGVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciBzdGF0ZTtcblxuICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IHRoaXMuZGF0YVNvdXJjZXMsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICB2YXIgX3JlZjI7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5Mikge1xuICAgICAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWYyID0gX2l0ZXJhdG9yMltfaTIrK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICAgICAgaWYgKF9pMi5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmMiA9IF9pMi52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBkYXRhU291cmNlID0gX3JlZjI7XG5cbiAgICAgICAgaWYgKHN0YXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBzdGF0ZSA9IHRoaXMuZ2V0RGF0YVNvdXJjZVN0YXRlKGRhdGFTb3VyY2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBvdGhlclN0YXRlID0gdGhpcy5nZXREYXRhU291cmNlU3RhdGUoZGF0YVNvdXJjZSk7XG5cbiAgICAgICAgICBpZiAob3RoZXJTdGF0ZSAhPT0gc3RhdGUpIHtcbiAgICAgICAgICAgIHN0YXRlID0gVmlzaWJpbGl0eVN0YXRlLklOREVURVJNSU5BVEU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN0YXRlID09PSBWaXNpYmlsaXR5U3RhdGUuSU5ERVRFUk1JTkFURSkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2Ygc3RhdGUgIT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtaXNzaW5nIHN0YXRlJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gR3JvdXA7XG59KCk7XG5cbmV4cG9ydCBkZWZhdWx0IEdyb3VwOyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb0RhdGFzb3VyY2VEYXRhU291cmNlIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9EYXRhU291cmNlLmpzJztcbmltcG9ydCBuZ2VvRGF0YXNvdXJjZURhdGFTb3VyY2VzIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9EYXRhU291cmNlcy5qcyc7XG5pbXBvcnQgbmdlb0Zvcm1hdFdGU0F0dHJpYnV0ZSBmcm9tICduZ2VvL2Zvcm1hdC9XRlNBdHRyaWJ1dGUuanMnO1xuaW1wb3J0IG5nZW9RdWVyeVF1ZXJlbnQgZnJvbSAnbmdlby9xdWVyeS9RdWVyZW50LmpzJztcbmltcG9ydCB7IGxpc3RlbiB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgeyBDb2xsZWN0aW9uRXZlbnQgfSBmcm9tICdvbC9Db2xsZWN0aW9uLmpzJztcbmV4cG9ydCB2YXIgRGF0YXNvdXJjZUhlbHBlciA9IGZ1bmN0aW9uICgpIHtcbiAgRGF0YXNvdXJjZUhlbHBlci4kaW5qZWN0ID0gW1wiJHFcIiwgXCJuZ2VvRGF0YVNvdXJjZXNcIiwgXCJuZ2VvUXVlcmVudFwiXTtcblxuICBmdW5jdGlvbiBEYXRhc291cmNlSGVscGVyKCRxLCBuZ2VvRGF0YVNvdXJjZXMsIG5nZW9RdWVyZW50KSB7XG4gICAgdGhpcy5xXyA9ICRxO1xuICAgIHRoaXMuY29sbGVjdGlvbl8gPSBuZ2VvRGF0YVNvdXJjZXMuY29sbGVjdGlvbjtcbiAgICB0aGlzLm5nZW9RdWVyZW50XyA9IG5nZW9RdWVyZW50O1xuICAgIHRoaXMuY2FjaGVfID0ge307XG4gICAgbGlzdGVuKHRoaXMuY29sbGVjdGlvbl8sICdhZGQnLCB0aGlzLmhhbmRsZURhdGFTb3VyY2VzQWRkXywgdGhpcyk7XG4gICAgbGlzdGVuKHRoaXMuY29sbGVjdGlvbl8sICdyZW1vdmUnLCB0aGlzLmhhbmRsZURhdGFTb3VyY2VzUmVtb3ZlXywgdGhpcyk7XG4gICAgdGhpcy5jb2xsZWN0aW9uXy5mb3JFYWNoKHRoaXMucmVnaXN0ZXJEYXRhU291cmNlXy5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBEYXRhc291cmNlSGVscGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZ2V0RGF0YVNvdXJjZSA9IGZ1bmN0aW9uIGdldERhdGFTb3VyY2UoaWQpIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZV9baWRdIHx8IG51bGw7XG4gIH07XG5cbiAgX3Byb3RvLmdldERhdGFTb3VyY2VBdHRyaWJ1dGVzID0gZnVuY3Rpb24gZ2V0RGF0YVNvdXJjZUF0dHJpYnV0ZXMoZGF0YVNvdXJjZSkge1xuICAgIHZhciB3ZnNEZXNjcmliZUZlYXR1cmVUeXBlRGVmZXIgPSB0aGlzLnFfLmRlZmVyKCk7XG5cbiAgICBpZiAoZGF0YVNvdXJjZS5hdHRyaWJ1dGVzKSB7XG4gICAgICB3ZnNEZXNjcmliZUZlYXR1cmVUeXBlRGVmZXIucmVzb2x2ZShkYXRhU291cmNlLmF0dHJpYnV0ZXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm5nZW9RdWVyZW50Xy53ZnNEZXNjcmliZUZlYXR1cmVUeXBlKGRhdGFTb3VyY2UpLnRoZW4oZnVuY3Rpb24gKGZlYXR1cmVUeXBlXykge1xuICAgICAgICB2YXIgb2djTGF5ZXJOYW1lID0gZGF0YVNvdXJjZS5nZXRXRlNMYXllck5hbWVzKClbMF07XG4gICAgICAgIGNvbnNvbGUuYXNzZXJ0KHR5cGVvZiBvZ2NMYXllck5hbWUgPT0gJ3N0cmluZycsICdUaGUgZGF0YSBzb3VyY2Ugc2hvdWxkIGhhdmUgb25seSBvbmUgb2djTGF5ZXIuJyk7XG4gICAgICAgIHZhciBmZWF0dXJlVHlwZSA9IGZlYXR1cmVUeXBlXztcblxuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBmZWF0dXJlVHlwZS5lbGVtZW50LCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICAgIHZhciBfcmVmO1xuXG4gICAgICAgICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmID0gX2l0ZXJhdG9yW19pKytdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgICAgICBpZiAoX2kuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGVsZW1lbnQgPSBfcmVmO1xuXG4gICAgICAgICAgaWYgKGVsZW1lbnQubmFtZSA9PT0gb2djTGF5ZXJOYW1lKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gZmVhdHVyZVR5cGUuY29tcGxleFR5cGUsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICAgICAgICB2YXIgX3JlZjI7XG5cbiAgICAgICAgICAgICAgaWYgKF9pc0FycmF5Mikge1xuICAgICAgICAgICAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgICAgICAgIF9yZWYyID0gX2l0ZXJhdG9yMltfaTIrK107XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICAgICAgICAgICAgaWYgKF9pMi5kb25lKSBicmVhaztcbiAgICAgICAgICAgICAgICBfcmVmMiA9IF9pMi52YWx1ZTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciB0eXBlID0gX3JlZjI7XG5cbiAgICAgICAgICAgICAgaWYgKHR5cGUubmFtZSA9PSBlbGVtZW50LnR5cGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29tcGxleENvbnRlbnQgPSB0eXBlLmNvbXBsZXhDb250ZW50O1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0gbmV3IG5nZW9Gb3JtYXRXRlNBdHRyaWJ1dGUoKS5yZWFkKGNvbXBsZXhDb250ZW50KTtcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnNldEF0dHJpYnV0ZXMoYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgd2ZzRGVzY3JpYmVGZWF0dXJlVHlwZURlZmVyLnJlc29sdmUoYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB3ZnNEZXNjcmliZUZlYXR1cmVUeXBlRGVmZXIucHJvbWlzZTtcbiAgfTtcblxuICBfcHJvdG8ucmVnaXN0ZXJEYXRhU291cmNlXyA9IGZ1bmN0aW9uIHJlZ2lzdGVyRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSkge1xuICAgIHRoaXMuY2FjaGVfW2RhdGFTb3VyY2UuaWRdID0gZGF0YVNvdXJjZTtcbiAgfTtcblxuICBfcHJvdG8udW5yZWdpc3RlckRhdGFTb3VyY2VfID0gZnVuY3Rpb24gdW5yZWdpc3RlckRhdGFTb3VyY2VfKGRhdGFTb3VyY2UpIHtcbiAgICBkZWxldGUgdGhpcy5jYWNoZV9bZGF0YVNvdXJjZS5pZF07XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZURhdGFTb3VyY2VzQWRkXyA9IGZ1bmN0aW9uIGhhbmRsZURhdGFTb3VyY2VzQWRkXyhldnQpIHtcbiAgICBpZiAoZXZ0IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgICB2YXIgZGF0YVNvdXJjZSA9IGV2dC5lbGVtZW50O1xuICAgICAgY29uc29sZS5hc3NlcnQoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIG5nZW9EYXRhc291cmNlRGF0YVNvdXJjZSk7XG4gICAgICB0aGlzLnJlZ2lzdGVyRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEYXRhU291cmNlc1JlbW92ZV8gPSBmdW5jdGlvbiBoYW5kbGVEYXRhU291cmNlc1JlbW92ZV8oZXZ0KSB7XG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgICAgdmFyIGRhdGFTb3VyY2UgPSBldnQuZWxlbWVudDtcbiAgICAgIHRoaXMudW5yZWdpc3RlckRhdGFTb3VyY2VfKGRhdGFTb3VyY2UpO1xuICAgIH1cbiAgfTtcblxuICBfY3JlYXRlQ2xhc3MoRGF0YXNvdXJjZUhlbHBlciwgW3tcbiAgICBrZXk6IFwiY29sbGVjdGlvblwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuY29sbGVjdGlvbl87XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIERhdGFzb3VyY2VIZWxwZXI7XG59KCk7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9EYXRhU291cmNlc0hlbHBlcicsIFtuZ2VvRGF0YXNvdXJjZURhdGFTb3VyY2VzLm5hbWUsIG5nZW9RdWVyeVF1ZXJlbnQubmFtZV0pO1xubW9kdWxlLnNlcnZpY2UoJ25nZW9EYXRhU291cmNlc0hlbHBlcicsIERhdGFzb3VyY2VIZWxwZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCB7IHB1c2hVbmxlc3NJbmNsdWRlZCB9IGZyb20gJ25nZW8vYXJyYXkuanMnO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlRGF0YVNvdXJjZSBmcm9tICduZ2VvL2RhdGFzb3VyY2UvRGF0YVNvdXJjZS5qcyc7XG5pbXBvcnQgbmdlb0ZpbHRlckNvbmRpdGlvbiBmcm9tICduZ2VvL2ZpbHRlci9Db25kaXRpb24uanMnO1xuaW1wb3J0IG5nZW9Gb3JtYXRBcmNHSVNHZW9KU09OIGZyb20gJ25nZW8vZm9ybWF0L0FyY0dJU0dlb0pTT04uanMnO1xuaW1wb3J0IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlIGZyb20gJ25nZW8vZm9ybWF0L0F0dHJpYnV0ZVR5cGUuanMnO1xuaW1wb3J0IG9sRm9ybWF0R01MMiBmcm9tICdvbC9mb3JtYXQvR01MMi5qcyc7XG5pbXBvcnQgb2xGb3JtYXRHTUwzIGZyb20gJ29sL2Zvcm1hdC9HTUwzLmpzJztcbmltcG9ydCBvbEZvcm1hdFdGUyBmcm9tICdvbC9mb3JtYXQvV0ZTLmpzJztcbmltcG9ydCBvbEZvcm1hdFdNU0dldEZlYXR1cmVJbmZvIGZyb20gJ29sL2Zvcm1hdC9XTVNHZXRGZWF0dXJlSW5mby5qcyc7XG5leHBvcnQgdmFyIFNlcnZlclR5cGUgPSB7XG4gIEFSQ0dJUzogJ2FyY2dpcycsXG4gIEdFT1NFUlZFUjogJ2dlb3NlcnZlcicsXG4gIE1BUFNFUlZFUjogJ21hcHNlcnZlcicsXG4gIFFHSVNTRVJWRVI6ICdxZ2lzc2VydmVyJ1xufTtcbmV4cG9ydCB2YXIgVHlwZSA9IHtcbiAgV01TOiAnV01TJyxcbiAgV01UUzogJ1dNVFMnXG59O1xudmFyIFdGU0ZlYXR1cmVQcmVmaXggPSB7XG4gIEZFQVRVUkU6ICdmZWF0dXJlJ1xufTtcbmV4cG9ydCB2YXIgV0ZTT3V0cHV0Rm9ybWF0ID0ge1xuICBHTUwyOiAnR01MMicsXG4gIEdNTDM6ICdHTUwzJ1xufTtcbmV4cG9ydCB2YXIgV01TSW5mb0Zvcm1hdCA9IHtcbiAgR0VPSlNPTjogJ2FwcGxpY2F0aW9uL2dlb2pzb24nLFxuICBHTUw6ICdhcHBsaWNhdGlvbi92bmQub2djLmdtbCdcbn07XG5leHBvcnQgdmFyIERFRkFVTFRfR0VPTUVUUllfTkFNRSA9ICdnZW9tJztcblxudmFyIE9HQyA9IGZ1bmN0aW9uIChfbmdlb0RhdGFzb3VyY2VEYXRhU28pIHtcbiAgX2luaGVyaXRzTG9vc2UoT0dDLCBfbmdlb0RhdGFzb3VyY2VEYXRhU28pO1xuXG4gIGZ1bmN0aW9uIE9HQyhvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX3RoaXMgPSBfbmdlb0RhdGFzb3VyY2VEYXRhU28uY2FsbCh0aGlzLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgIF90aGlzLmRpbWVuc2lvbnNDb25maWcgPSBvcHRpb25zLmRpbWVuc2lvbnNDb25maWcgfHwgbnVsbDtcbiAgICBfdGhpcy5kaW1lbnNpb25zRmlsdGVyc0NvbmZpZyA9IG9wdGlvbnMuZGltZW5zaW9uc0ZpbHRlcnNDb25maWcgfHwgbnVsbDtcbiAgICBfdGhpcy5maWx0ZXJDb25kaXRpb25fID0gb3B0aW9ucy5maWx0ZXJDb25kaXRpb24gfHwgbmdlb0ZpbHRlckNvbmRpdGlvbi5BTkQ7XG4gICAgX3RoaXMuZmlsdGVyUnVsZXMgPSBvcHRpb25zLmZpbHRlclJ1bGVzIHx8IG51bGw7XG4gICAgX3RoaXMuZmlsdHJhYmxlID0gb3B0aW9ucy5maWx0cmFibGUgfHwgbnVsbDtcbiAgICBfdGhpcy5jb3B5YWJsZV8gPSBvcHRpb25zLmNvcHlhYmxlID09PSB0cnVlO1xuICAgIF90aGlzLmRpbWVuc2lvbnNfID0gb3B0aW9ucy5kaW1lbnNpb25zIHx8IG51bGw7XG4gICAgX3RoaXMuZ2VvbWV0cnlOYW1lXyA9IERFRkFVTFRfR0VPTUVUUllfTkFNRTtcbiAgICBfdGhpcy5vZ2NJbWFnZVR5cGVfID0gb3B0aW9ucy5vZ2NJbWFnZVR5cGUgfHwgJ2ltYWdlL3BuZyc7XG4gICAgX3RoaXMud21zTGF5ZXJzXyA9IG9wdGlvbnMud21zTGF5ZXJzIHx8IG51bGw7XG4gICAgX3RoaXMud2ZzTGF5ZXJzXyA9IG9wdGlvbnMud2ZzTGF5ZXJzIHx8IG51bGw7XG4gICAgX3RoaXMub2djU2VydmVyVHlwZV8gPSBvcHRpb25zLm9nY1NlcnZlclR5cGUgfHwgU2VydmVyVHlwZS5NQVBTRVJWRVI7XG4gICAgX3RoaXMub2djVHlwZV8gPSBvcHRpb25zLm9nY1R5cGUgfHwgVHlwZS5XTVM7XG4gICAgX3RoaXMub2djQXR0cmlidXRlc18gPSBvcHRpb25zLm9nY0F0dHJpYnV0ZXM7XG4gICAgX3RoaXMuc25hcHBhYmxlXyA9IG9wdGlvbnMuc25hcHBhYmxlID09PSB0cnVlO1xuICAgIF90aGlzLnNuYXBwaW5nVG9FZGdlc18gPSBvcHRpb25zLnNuYXBwaW5nVG9FZGdlcyAhPT0gZmFsc2U7XG4gICAgX3RoaXMuc25hcHBpbmdUb1ZlcnRpY2VfID0gb3B0aW9ucy5zbmFwcGluZ1RvVmVydGljZSAhPT0gZmFsc2U7XG4gICAgX3RoaXMuc25hcHBpbmdUb2xlcmFuY2VfID0gb3B0aW9ucy5zbmFwcGluZ1RvbGVyYW5jZSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5zbmFwcGluZ1RvbGVyYW5jZSA6IDEwO1xuICAgIF90aGlzLnRpbWVBdHRyaWJ1dGVOYW1lXyA9IG9wdGlvbnMudGltZUF0dHJpYnV0ZU5hbWU7XG4gICAgX3RoaXMudGltZUxvd2VyVmFsdWUgPSBvcHRpb25zLnRpbWVMb3dlclZhbHVlO1xuICAgIF90aGlzLnRpbWVQcm9wZXJ0eV8gPSBvcHRpb25zLnRpbWVQcm9wZXJ0eSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy50aW1lUHJvcGVydHkgOiBudWxsO1xuICAgIF90aGlzLnRpbWVVcHBlclZhbHVlID0gb3B0aW9ucy50aW1lVXBwZXJWYWx1ZTtcbiAgICBfdGhpcy53ZnNGZWF0dXJlTlNfID0gb3B0aW9ucy53ZnNGZWF0dXJlTlM7XG4gICAgX3RoaXMud2ZzRmVhdHVyZVByZWZpeF8gPSBvcHRpb25zLndmc0ZlYXR1cmVQcmVmaXggfHwgV0ZTRmVhdHVyZVByZWZpeC5GRUFUVVJFO1xuICAgIF90aGlzLndmc091dHB1dEZvcm1hdF8gPSBvcHRpb25zLndmc091dHB1dEZvcm1hdCB8fCBXRlNPdXRwdXRGb3JtYXQuR01MMztcbiAgICBfdGhpcy53ZnNVcmxfID0gb3B0aW9ucy53ZnNVcmw7XG4gICAgdmFyIHdtc0luZm9Gb3JtYXQ7XG5cbiAgICBpZiAob3B0aW9ucy53bXNJbmZvRm9ybWF0KSB7XG4gICAgICB3bXNJbmZvRm9ybWF0ID0gb3B0aW9ucy53bXNJbmZvRm9ybWF0O1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoX3RoaXMub2djU2VydmVyVHlwZV8gPT09IFNlcnZlclR5cGUuQVJDR0lTKSB7XG4gICAgICAgIHdtc0luZm9Gb3JtYXQgPSBXTVNJbmZvRm9ybWF0LkdFT0pTT047XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3bXNJbmZvRm9ybWF0ID0gV01TSW5mb0Zvcm1hdC5HTUw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgX3RoaXMud21zSW5mb0Zvcm1hdF8gPSB3bXNJbmZvRm9ybWF0O1xuICAgIF90aGlzLndtc0lzU2luZ2xlVGlsZV8gPSBvcHRpb25zLndtc0lzU2luZ2xlVGlsZSA9PT0gdHJ1ZTtcbiAgICBfdGhpcy53bXNVcmxfID0gb3B0aW9ucy53bXNVcmw7XG4gICAgX3RoaXMud210c0xheWVyXyA9IG9wdGlvbnMud210c0xheWVyO1xuICAgIF90aGlzLndtdHNVcmxfID0gb3B0aW9ucy53bXRzVXJsO1xuICAgIHZhciB3ZnNMYXllck5hbWVzID0gW107XG4gICAgdmFyIHdtc0xheWVyTmFtZXMgPSBbXTtcblxuICAgIGlmIChfdGhpcy5xdWVyeWFibGUpIHtcbiAgICAgIHZhciB3ZnNMYXllcnMgPSBfdGhpcy53ZnNMYXllcnMgfHwgW107XG5cbiAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IHdmc0xheWVycywgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvciksIF9pID0gMCwgX2l0ZXJhdG9yID0gX2lzQXJyYXkgPyBfaXRlcmF0b3IgOiBfaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgdmFyIF9yZWY7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICAgICAgaWYgKF9pID49IF9pdGVyYXRvci5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2kgPSBfaXRlcmF0b3IubmV4dCgpO1xuICAgICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd2ZzTGF5ZXIgPSBfcmVmO1xuXG4gICAgICAgIGlmICh3ZnNMYXllci5xdWVyeWFibGUpIHtcbiAgICAgICAgICB3ZnNMYXllck5hbWVzLnB1c2god2ZzTGF5ZXIubmFtZSk7XG4gICAgICAgICAgd21zTGF5ZXJOYW1lcy5wdXNoKHdmc0xheWVyLm5hbWUpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciB3bXNMYXllcnMgPSBfdGhpcy53bXNMYXllcnMgfHwgW107XG5cbiAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB3bXNMYXllcnMsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICB2YXIgX3JlZjI7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5Mikge1xuICAgICAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWYyID0gX2l0ZXJhdG9yMltfaTIrK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICAgICAgaWYgKF9pMi5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmMiA9IF9pMi52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB3bXNMYXllciA9IF9yZWYyO1xuXG4gICAgICAgIGlmICh3bXNMYXllci5xdWVyeWFibGUpIHtcbiAgICAgICAgICBwdXNoVW5sZXNzSW5jbHVkZWQod21zTGF5ZXJOYW1lcywgd21zTGF5ZXIubmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgd2ZzRm9ybWF0ID0gbnVsbDtcblxuICAgIGlmIChfdGhpcy5zdXBwb3J0c1dGUyAmJiB3ZnNMYXllck5hbWVzLmxlbmd0aCkge1xuICAgICAgdmFyIGZvcm1hdDtcblxuICAgICAgaWYgKF90aGlzLndmc091dHB1dEZvcm1hdF8gPT09IFdGU091dHB1dEZvcm1hdC5HTUwzKSB7XG4gICAgICAgIGZvcm1hdCA9IG5ldyBvbEZvcm1hdEdNTDMoKTtcbiAgICAgIH0gZWxzZSBpZiAoX3RoaXMud2ZzT3V0cHV0Rm9ybWF0XyA9PT0gV0ZTT3V0cHV0Rm9ybWF0LkdNTDIpIHtcbiAgICAgICAgZm9ybWF0ID0gbmV3IG9sRm9ybWF0R01MMigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIEdNTCBvdXRwdXQgdmVyc2lvbicpO1xuICAgICAgfVxuXG4gICAgICB3ZnNGb3JtYXQgPSBuZXcgb2xGb3JtYXRXRlMoe1xuICAgICAgICBmZWF0dXJlTlM6IF90aGlzLndmc0ZlYXR1cmVOUyxcbiAgICAgICAgZmVhdHVyZVR5cGU6IHdmc0xheWVyTmFtZXMsXG4gICAgICAgIGdtbEZvcm1hdDogZm9ybWF0XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBfdGhpcy53ZnNGb3JtYXRfID0gd2ZzRm9ybWF0O1xuICAgIHZhciB3bXNGb3JtYXQgPSBudWxsO1xuXG4gICAgaWYgKF90aGlzLnN1cHBvcnRzV01TICYmIHdtc0xheWVyTmFtZXMubGVuZ3RoKSB7XG4gICAgICBpZiAoX3RoaXMud21zSW5mb0Zvcm1hdCA9PT0gV01TSW5mb0Zvcm1hdC5HTUwpIHtcbiAgICAgICAgd21zRm9ybWF0ID0gbmV3IG9sRm9ybWF0V01TR2V0RmVhdHVyZUluZm8oe1xuICAgICAgICAgIGxheWVyczogd21zTGF5ZXJOYW1lc1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoX3RoaXMud21zSW5mb0Zvcm1hdCA9PT0gV01TSW5mb0Zvcm1hdC5HRU9KU09OKSB7XG4gICAgICAgIGlmIChfdGhpcy5vZ2NTZXJ2ZXJUeXBlXyA9PT0gU2VydmVyVHlwZS5BUkNHSVMpIHtcbiAgICAgICAgICB3bXNGb3JtYXQgPSBuZXcgbmdlb0Zvcm1hdEFyY0dJU0dlb0pTT04oe1xuICAgICAgICAgICAgbGF5ZXJzOiB3bXNMYXllck5hbWVzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBfdGhpcy53bXNGb3JtYXRfID0gd21zRm9ybWF0O1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBPR0MucHJvdG90eXBlO1xuXG4gIF9wcm90by5zZXRBdHRyaWJ1dGVzID0gZnVuY3Rpb24gc2V0QXR0cmlidXRlcyhhdHRyaWJ1dGVzKSB7XG4gICAgX25nZW9EYXRhc291cmNlRGF0YVNvLnByb3RvdHlwZS5zZXRBdHRyaWJ1dGVzLmNhbGwodGhpcywgYXR0cmlidXRlcyk7XG5cbiAgICB0aGlzLnVwZGF0ZUdlb21ldHJ5TmFtZUZyb21BdHRyaWJ1dGVzXygpO1xuICB9O1xuXG4gIF9wcm90by5nZW9tZXRyeU5hbWUgPSBmdW5jdGlvbiBnZW9tZXRyeU5hbWUobGF5ZXIpIHtcbiAgICB2YXIgZ2VvbWV0cnlOYW1lID0gbnVsbDtcblxuICAgIGlmIChsYXllciAmJiB0aGlzLm9nY0F0dHJpYnV0ZXNfKSB7XG4gICAgICB2YXIgYXR0cmlidXRlcyA9IHRoaXMub2djQXR0cmlidXRlc19bbGF5ZXJdO1xuXG4gICAgICBmb3IgKHZhciBhdHRyaWJ1dGUgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBpZiAoYXR0cmlidXRlc1thdHRyaWJ1dGVdLm5hbWVzcGFjZSA9PSAnaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9nbWwnKSB7XG4gICAgICAgICAgZ2VvbWV0cnlOYW1lID0gYXR0cmlidXRlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFnZW9tZXRyeU5hbWUpIHtcbiAgICAgIGdlb21ldHJ5TmFtZSA9IHRoaXMuZ2VvbWV0cnlOYW1lXztcbiAgICB9XG5cbiAgICByZXR1cm4gZ2VvbWV0cnlOYW1lO1xuICB9O1xuXG4gIF9wcm90by5jb21iaW5hYmxlV2l0aERhdGFTb3VyY2VGb3JXRlMgPSBmdW5jdGlvbiBjb21iaW5hYmxlV2l0aERhdGFTb3VyY2VGb3JXRlMoZGF0YVNvdXJjZSkge1xuICAgIHJldHVybiB0aGlzLmNvbWJpbmFibGVGb3JXRlMgJiYgZGF0YVNvdXJjZS5jb21iaW5hYmxlRm9yV0ZTICYmIHRoaXMuc3VwcG9ydHNXRlMgJiYgZGF0YVNvdXJjZS5zdXBwb3J0c1dGUyAmJiB0aGlzLnF1ZXJ5YWJsZSAmJiBkYXRhU291cmNlLnF1ZXJ5YWJsZSAmJiB0aGlzLndmc1VybCA9PT0gZGF0YVNvdXJjZS53ZnNVcmwgJiYgdGhpcy5oYXZlVGhlU2FtZUFjdGl2ZURpbWVuc2lvbnMoZGF0YVNvdXJjZSk7XG4gIH07XG5cbiAgX3Byb3RvLmNvbWJpbmFibGVXaXRoRGF0YVNvdXJjZUZvcldNUyA9IGZ1bmN0aW9uIGNvbWJpbmFibGVXaXRoRGF0YVNvdXJjZUZvcldNUyhkYXRhU291cmNlKSB7XG4gICAgcmV0dXJuIHRoaXMuY29tYmluYWJsZUZvcldNUyAmJiBkYXRhU291cmNlLmNvbWJpbmFibGVGb3JXTVMgJiYgdGhpcy5zdXBwb3J0c1dNUyAmJiBkYXRhU291cmNlLnN1cHBvcnRzV01TICYmIHRoaXMucXVlcnlhYmxlICYmIGRhdGFTb3VyY2UucXVlcnlhYmxlICYmIHRoaXMud21zVXJsID09PSBkYXRhU291cmNlLndtc1VybCAmJiB0aGlzLmhhdmVUaGVTYW1lQWN0aXZlRGltZW5zaW9ucyhkYXRhU291cmNlKTtcbiAgfTtcblxuICBfcHJvdG8uaXNBbnlPR0NMYXllckluUmFuZ2UgPSBmdW5jdGlvbiBpc0FueU9HQ0xheWVySW5SYW5nZShyZXMsIHF1ZXJ5YWJsZU9ubHkpIHtcbiAgICBpZiAocXVlcnlhYmxlT25seSA9PT0gdm9pZCAwKSB7XG4gICAgICBxdWVyeWFibGVPbmx5ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuICEhdGhpcy5nZXRJblJhbmdlV0ZTTGF5ZXJOYW1lcyhyZXMsIHF1ZXJ5YWJsZU9ubHkpLmxlbmd0aDtcbiAgfTtcblxuICBfcHJvdG8uZ2V0V01TTGF5ZXJOYW1lcyA9IGZ1bmN0aW9uIGdldFdNU0xheWVyTmFtZXMocXVlcnlhYmxlT25seSkge1xuICAgIGlmIChxdWVyeWFibGVPbmx5ID09PSB2b2lkIDApIHtcbiAgICAgIHF1ZXJ5YWJsZU9ubHkgPSBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgbGF5ZXJOYW1lcyA9IFtdO1xuXG4gICAgaWYgKHRoaXMud21zTGF5ZXJzKSB7XG4gICAgICBmb3IgKHZhciBfaXRlcmF0b3IzID0gdGhpcy53bXNMYXllcnMsIF9pc0FycmF5MyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMyksIF9pMyA9IDAsIF9pdGVyYXRvcjMgPSBfaXNBcnJheTMgPyBfaXRlcmF0b3IzIDogX2l0ZXJhdG9yM1tTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICB2YXIgX3JlZjM7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5Mykge1xuICAgICAgICAgIGlmIChfaTMgPj0gX2l0ZXJhdG9yMy5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWYzID0gX2l0ZXJhdG9yM1tfaTMrK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2kzID0gX2l0ZXJhdG9yMy5uZXh0KCk7XG4gICAgICAgICAgaWYgKF9pMy5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmMyA9IF9pMy52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB3bXNMYXllciA9IF9yZWYzO1xuXG4gICAgICAgIGlmICghcXVlcnlhYmxlT25seSB8fCB3bXNMYXllci5xdWVyeWFibGUpIHtcbiAgICAgICAgICBsYXllck5hbWVzLnB1c2god21zTGF5ZXIubmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbGF5ZXJOYW1lcztcbiAgfTtcblxuICBfcHJvdG8uZ2V0SW5SYW5nZVdGU0xheWVyTmFtZXMgPSBmdW5jdGlvbiBnZXRJblJhbmdlV0ZTTGF5ZXJOYW1lcyhyZXMsIHF1ZXJ5YWJsZU9ubHkpIHtcbiAgICBpZiAocXVlcnlhYmxlT25seSA9PT0gdm9pZCAwKSB7XG4gICAgICBxdWVyeWFibGVPbmx5ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGxheWVyTmFtZXMgPSBbXTtcblxuICAgIGlmICh0aGlzLndmc0xheWVycykge1xuICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IHRoaXMud2ZzTGF5ZXJzLCBfaXNBcnJheTQgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjQpLCBfaTQgPSAwLCBfaXRlcmF0b3I0ID0gX2lzQXJyYXk0ID8gX2l0ZXJhdG9yNCA6IF9pdGVyYXRvcjRbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgdmFyIF9yZWY0O1xuXG4gICAgICAgIGlmIChfaXNBcnJheTQpIHtcbiAgICAgICAgICBpZiAoX2k0ID49IF9pdGVyYXRvcjQubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICBfcmVmNCA9IF9pdGVyYXRvcjRbX2k0KytdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9pNCA9IF9pdGVyYXRvcjQubmV4dCgpO1xuICAgICAgICAgIGlmIChfaTQuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgX3JlZjQgPSBfaTQudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd2ZzTGF5ZXIgPSBfcmVmNDtcbiAgICAgICAgdmFyIG1heFJlcyA9IHdmc0xheWVyLm1heFJlc29sdXRpb247XG4gICAgICAgIHZhciBtaW5SZXMgPSB3ZnNMYXllci5taW5SZXNvbHV0aW9uO1xuICAgICAgICB2YXIgaW5NaW5SYW5nZSA9IG1pblJlcyA9PT0gdW5kZWZpbmVkIHx8IHJlcyA+PSBtaW5SZXM7XG4gICAgICAgIHZhciBpbk1heFJhbmdlID0gbWF4UmVzID09PSB1bmRlZmluZWQgfHwgcmVzIDw9IG1heFJlcztcbiAgICAgICAgdmFyIGluUmFuZ2UgPSBpbk1pblJhbmdlICYmIGluTWF4UmFuZ2U7XG5cbiAgICAgICAgaWYgKGluUmFuZ2UgJiYgKCFxdWVyeWFibGVPbmx5IHx8IHdmc0xheWVyLnF1ZXJ5YWJsZSkpIHtcbiAgICAgICAgICBsYXllck5hbWVzLnB1c2god2ZzTGF5ZXIubmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbGF5ZXJOYW1lcztcbiAgfTtcblxuICBfcHJvdG8uZ2V0V0ZTTGF5ZXJOYW1lcyA9IGZ1bmN0aW9uIGdldFdGU0xheWVyTmFtZXMocXVlcnlhYmxlT25seSkge1xuICAgIGlmIChxdWVyeWFibGVPbmx5ID09PSB2b2lkIDApIHtcbiAgICAgIHF1ZXJ5YWJsZU9ubHkgPSBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgbGF5ZXJOYW1lcyA9IFtdO1xuXG4gICAgaWYgKHRoaXMud2ZzTGF5ZXJzKSB7XG4gICAgICBmb3IgKHZhciBfaXRlcmF0b3I1ID0gdGhpcy53ZnNMYXllcnMsIF9pc0FycmF5NSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNSksIF9pNSA9IDAsIF9pdGVyYXRvcjUgPSBfaXNBcnJheTUgPyBfaXRlcmF0b3I1IDogX2l0ZXJhdG9yNVtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICB2YXIgX3JlZjU7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5NSkge1xuICAgICAgICAgIGlmIChfaTUgPj0gX2l0ZXJhdG9yNS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWY1ID0gX2l0ZXJhdG9yNVtfaTUrK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2k1ID0gX2l0ZXJhdG9yNS5uZXh0KCk7XG4gICAgICAgICAgaWYgKF9pNS5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmNSA9IF9pNS52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB3ZnNMYXllciA9IF9yZWY1O1xuXG4gICAgICAgIGlmICghcXVlcnlhYmxlT25seSB8fCB3ZnNMYXllci5xdWVyeWFibGUpIHtcbiAgICAgICAgICBsYXllck5hbWVzLnB1c2god2ZzTGF5ZXIubmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbGF5ZXJOYW1lcztcbiAgfTtcblxuICBfcHJvdG8uZ2V0RmlsdHJhYmxlV0ZTTGF5ZXJOYW1lID0gZnVuY3Rpb24gZ2V0RmlsdHJhYmxlV0ZTTGF5ZXJOYW1lKCkge1xuICAgIGlmICghdGhpcy5maWx0cmFibGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmaWx0cmFibGUnKTtcbiAgICB9XG5cbiAgICB2YXIgbGF5ZXJOYW1lcyA9IHRoaXMuZ2V0V0ZTTGF5ZXJOYW1lcygpO1xuICAgIGNvbnNvbGUuYXNzZXJ0KGxheWVyTmFtZXMubGVuZ3RoID09PSAxKTtcbiAgICByZXR1cm4gbGF5ZXJOYW1lc1swXTtcbiAgfTtcblxuICBfcHJvdG8udXBkYXRlR2VvbWV0cnlOYW1lRnJvbUF0dHJpYnV0ZXNfID0gZnVuY3Rpb24gdXBkYXRlR2VvbWV0cnlOYW1lRnJvbUF0dHJpYnV0ZXNfKCkge1xuICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMpIHtcbiAgICAgIGZvciAodmFyIF9pdGVyYXRvcjYgPSB0aGlzLmF0dHJpYnV0ZXMsIF9pc0FycmF5NiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNiksIF9pNiA9IDAsIF9pdGVyYXRvcjYgPSBfaXNBcnJheTYgPyBfaXRlcmF0b3I2IDogX2l0ZXJhdG9yNltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICB2YXIgX3JlZjY7XG5cbiAgICAgICAgaWYgKF9pc0FycmF5Nikge1xuICAgICAgICAgIGlmIChfaTYgPj0gX2l0ZXJhdG9yNi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIF9yZWY2ID0gX2l0ZXJhdG9yNltfaTYrK107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX2k2ID0gX2l0ZXJhdG9yNi5uZXh0KCk7XG4gICAgICAgICAgaWYgKF9pNi5kb25lKSBicmVhaztcbiAgICAgICAgICBfcmVmNiA9IF9pNi52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBhdHRyaWJ1dGUgPSBfcmVmNjtcblxuICAgICAgICBpZiAoYXR0cmlidXRlLnR5cGUgPT09IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkdFT01FVFJZKSB7XG4gICAgICAgICAgdGhpcy5nZW9tZXRyeU5hbWVfID0gYXR0cmlidXRlLm5hbWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhdmVUaGVTYW1lQWN0aXZlRGltZW5zaW9ucyA9IGZ1bmN0aW9uIGhhdmVUaGVTYW1lQWN0aXZlRGltZW5zaW9ucyhkYXRhU291cmNlKSB7XG4gICAgdmFyIHNoYXJlID0gdHJ1ZTtcbiAgICB2YXIgbXlBY3RpdmUgPSB0aGlzLmFjdGl2ZURpbWVuc2lvbnM7XG4gICAgdmFyIGl0c0FjdGl2ZSA9IGRhdGFTb3VyY2UuYWN0aXZlRGltZW5zaW9ucztcblxuICAgIGZvciAodmFyIGtleSBpbiBteUFjdGl2ZSkge1xuICAgICAgaWYgKG15QWN0aXZlW2tleV0gIT09IGl0c0FjdGl2ZVtrZXldKSB7XG4gICAgICAgIHNoYXJlID0gZmFsc2U7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzaGFyZSkge1xuICAgICAgZm9yICh2YXIgX2tleSBpbiBpdHNBY3RpdmUpIHtcbiAgICAgICAgaWYgKGl0c0FjdGl2ZVtfa2V5XSAhPT0gbXlBY3RpdmVbX2tleV0pIHtcbiAgICAgICAgICBzaGFyZSA9IGZhbHNlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHNoYXJlO1xuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhPR0MsIFt7XG4gICAga2V5OiBcImRpbWVuc2lvbnNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmRpbWVuc2lvbnNfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJmaWx0ZXJDb25kaXRpb25cIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmZpbHRlckNvbmRpdGlvbl87XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChmaWx0ZXJDb25kaXRpb24pIHtcbiAgICAgIHRoaXMuZmlsdGVyQ29uZGl0aW9uXyA9IGZpbHRlckNvbmRpdGlvbjtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidGltZVJhbmdlVmFsdWVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciByYW5nZSA9IG51bGw7XG4gICAgICB2YXIgbG93ZXIgPSB0aGlzLnRpbWVMb3dlclZhbHVlO1xuICAgICAgdmFyIHVwcGVyID0gdGhpcy50aW1lVXBwZXJWYWx1ZTtcblxuICAgICAgaWYgKGxvd2VyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmFuZ2UgPSB7XG4gICAgICAgICAgc3RhcnQ6IGxvd2VyXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHVwcGVyICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHJhbmdlLmVuZCA9IHVwcGVyO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByYW5nZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHJhbmdlKSB7XG4gICAgICBpZiAocmFuZ2UpIHtcbiAgICAgICAgdGhpcy50aW1lVXBwZXJWYWx1ZSA9IHJhbmdlLmVuZDtcbiAgICAgICAgdGhpcy50aW1lTG93ZXJWYWx1ZSA9IHJhbmdlLnN0YXJ0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy50aW1lVXBwZXJWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy50aW1lTG93ZXJWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29weWFibGVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvcHlhYmxlXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwib2djSW1hZ2VUeXBlXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5vZ2NJbWFnZVR5cGVfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ3bXNMYXllcnNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndtc0xheWVyc187XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndmc0xheWVyc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud2ZzTGF5ZXJzXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwib2djU2VydmVyVHlwZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMub2djU2VydmVyVHlwZV87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm9nY1R5cGVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLm9nY1R5cGVfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzbmFwcGFibGVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnNuYXBwYWJsZV87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNuYXBwaW5nVG9FZGdlc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuc25hcHBpbmdUb0VkZ2VzXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic25hcHBpbmdUb1ZlcnRpY2VcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnNuYXBwaW5nVG9WZXJ0aWNlXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic25hcHBpbmdUb2xlcmFuY2VcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnNuYXBwaW5nVG9sZXJhbmNlXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidGltZUF0dHJpYnV0ZU5hbWVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnRpbWVBdHRyaWJ1dGVOYW1lXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidGltZVByb3BlcnR5XCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy50aW1lUHJvcGVydHlfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ3ZnNGZWF0dXJlTlNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndmc0ZlYXR1cmVOU187XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndmc0ZlYXR1cmVQcmVmaXhcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndmc0ZlYXR1cmVQcmVmaXhfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ3ZnNPdXRwdXRGb3JtYXRcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndmc091dHB1dEZvcm1hdF87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndmc1VybFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud2ZzVXJsXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwid21zSW5mb0Zvcm1hdFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud21zSW5mb0Zvcm1hdF87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndtc0lzU2luZ2xlVGlsZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud21zSXNTaW5nbGVUaWxlXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwid21zVXJsXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy53bXNVcmxfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ3bXRzTGF5ZXJcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndtdHNMYXllcl87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndtdHNVcmxcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndtdHNVcmxfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJhY3RpdmVEaW1lbnNpb25zXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICB2YXIgYWN0aXZlID0ge307XG4gICAgICB2YXIgZGltZW5zaW9ucyA9IHRoaXMuZGltZW5zaW9uc18gfHwge307XG4gICAgICB2YXIgY29uZmlnID0gdGhpcy5kaW1lbnNpb25zQ29uZmlnIHx8IHt9O1xuXG4gICAgICBmb3IgKHZhciBrZXkgaW4gY29uZmlnKSB7XG4gICAgICAgIHZhciBjb25maWdWYWx1ZSA9IGNvbmZpZ1trZXldO1xuXG4gICAgICAgIGlmIChjb25maWdWYWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIHZhciB2YWx1ZSA9IGRpbWVuc2lvbnNba2V5XTtcblxuICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICBhY3RpdmVba2V5XSA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhY3RpdmVba2V5XSA9IGNvbmZpZ1ZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBhY3RpdmU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvbWJpbmFibGVGb3JXRlNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmZpbHRlclJ1bGVzID09PSBudWxsICYmIHRoaXMudGltZVJhbmdlVmFsdWUgPT09IG51bGw7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvbWJpbmFibGVGb3JXTVNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmZpbHRlclJ1bGVzID09PSBudWxsICYmIHRoaXMudGltZVJhbmdlVmFsdWUgPT09IG51bGw7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInF1ZXJ5YWJsZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgdmFyIHF1ZXJ5YWJsZSA9IGZhbHNlO1xuXG4gICAgICBpZiAodGhpcy5zdXBwb3J0c1dGUyAmJiB0aGlzLndmc0xheWVycykge1xuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3I3ID0gdGhpcy53ZnNMYXllcnMsIF9pc0FycmF5NyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNyksIF9pNyA9IDAsIF9pdGVyYXRvcjcgPSBfaXNBcnJheTcgPyBfaXRlcmF0b3I3IDogX2l0ZXJhdG9yN1tTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICAgIHZhciBfcmVmNztcblxuICAgICAgICAgIGlmIChfaXNBcnJheTcpIHtcbiAgICAgICAgICAgIGlmIChfaTcgPj0gX2l0ZXJhdG9yNy5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgICAgX3JlZjcgPSBfaXRlcmF0b3I3W19pNysrXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2k3ID0gX2l0ZXJhdG9yNy5uZXh0KCk7XG4gICAgICAgICAgICBpZiAoX2k3LmRvbmUpIGJyZWFrO1xuICAgICAgICAgICAgX3JlZjcgPSBfaTcudmFsdWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHdmc0xheWVyID0gX3JlZjc7XG5cbiAgICAgICAgICBpZiAod2ZzTGF5ZXIucXVlcnlhYmxlID09PSB0cnVlKSB7XG4gICAgICAgICAgICBxdWVyeWFibGUgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnN1cHBvcnRzV01TICYmIHRoaXMud21zTGF5ZXJzICYmIHRoaXMud21zTGF5ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcXVlcnlhYmxlID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHF1ZXJ5YWJsZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic3VwcG9ydHNXRlNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndmc1VybCAhPT0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzdXBwb3J0c0F0dHJpYnV0ZXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZXMgIT09IG51bGwgfHwgdGhpcy5zdXBwb3J0c1dGUyAmJiB0aGlzLndmc0xheWVycyAhPT0gbnVsbCAmJiB0aGlzLndmc0xheWVycy5sZW5ndGggPT09IDEgJiYgdGhpcy53ZnNMYXllcnNbMF0ucXVlcnlhYmxlID09PSB0cnVlO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzdXBwb3J0c1dNU1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud21zVXJsICE9PSB1bmRlZmluZWQ7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInN1cHBvcnRzV01UU1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud210c1VybCAhPT0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ3ZnNGb3JtYXRcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLndmc0Zvcm1hdF87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIndtc0Zvcm1hdFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMud21zRm9ybWF0XztcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gT0dDO1xufShuZ2VvRGF0YXNvdXJjZURhdGFTb3VyY2UpO1xuXG5leHBvcnQgZnVuY3Rpb24gZ3Vlc3NTZXJ2aWNlVHlwZUJ5VXJsKHVybCkge1xuICB2YXIgdHlwZTtcblxuICBpZiAoLyh3bXRzKS9pLnRlc3QodXJsKSkge1xuICAgIHR5cGUgPSBUeXBlLldNVFM7XG4gIH0gZWxzZSB7XG4gICAgdHlwZSA9IFR5cGUuV01TO1xuICB9XG5cbiAgcmV0dXJuIHR5cGU7XG59XG5leHBvcnQgdmFyIFRpbWVQcm9wZXJ0eVdpZGdldEVudW0gPSB7XG4gIFNMSURFUjogJ3NsaWRlcicsXG4gIERBVEVQSUNLRVI6ICdkYXRlcGlja2VyJ1xufTtcbmV4cG9ydCB2YXIgVGltZVByb3BlcnR5TW9kZUVudW0gPSB7XG4gIFJBTkdFOiAncmFuZ2UnLFxuICBWQUxVRTogJ3ZhbHVlJyxcbiAgRElTQUJMRUQ6ICdkaXNhYmxlZCdcbn07XG5leHBvcnQgdmFyIFRpbWVQcm9wZXJ0eVJlc29sdXRpb25FbnVtID0ge1xuICBEQVk6ICdkYXknLFxuICBNT05USDogJ21vbnRoJyxcbiAgWUVBUjogJ3llYXInLFxuICBTRUNPTkQ6ICdzZWNvbmQnXG59O1xuZXhwb3J0IGRlZmF1bHQgT0dDOyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBuZ2VvRGF0YXNvdXJjZUdyb3VwIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9Hcm91cC5qcyc7XG5cbnZhciBfZGVmYXVsdCA9IGZ1bmN0aW9uIChfbmdlb0RhdGFzb3VyY2VHcm91cCkge1xuICBfaW5oZXJpdHNMb29zZShfZGVmYXVsdCwgX25nZW9EYXRhc291cmNlR3JvdXApO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfdGhpcyA9IF9uZ2VvRGF0YXNvdXJjZUdyb3VwLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICBfdGhpcy51cmxfID0gb3B0aW9ucy51cmw7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKF9kZWZhdWx0LCBbe1xuICAgIGtleTogXCJ1cmxcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnVybF87XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIF9kZWZhdWx0O1xufShuZ2VvRGF0YXNvdXJjZUdyb3VwKTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBuZ2VvRGF0YXNvdXJjZU9HQ0dyb3VwIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9PR0NHcm91cC5qcyc7XG5pbXBvcnQgbmdlb0RhdGFzb3VyY2VPR0MgZnJvbSAnbmdlby9kYXRhc291cmNlL09HQy5qcyc7XG5pbXBvcnQgeyByZW1vdmUgYXMgcmVtb3ZlRnJvbUFycmF5IH0gZnJvbSAnb2wvYXJyYXkuanMnO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoX25nZW9EYXRhc291cmNlT0dDR3JvKSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfbmdlb0RhdGFzb3VyY2VPR0NHcm8pO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMsIG5nZW9MYXllckhlbHBlcikge1xuICAgIHZhciBfdGhpcztcblxuICAgIF90aGlzID0gX25nZW9EYXRhc291cmNlT0dDR3JvLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICB2YXIgaW5qZWN0b3IgPSBvcHRpb25zLmluamVjdG9yO1xuICAgIF90aGlzLmxheWVyXyA9IG51bGw7XG4gICAgX3RoaXMubmdlb0xheWVySGVscGVyXyA9IG5nZW9MYXllckhlbHBlcjtcbiAgICBfdGhpcy5yb290U2NvcGVfID0gaW5qZWN0b3IuZ2V0KCckcm9vdFNjb3BlJyk7XG4gICAgX3RoaXMud21zRGF0YVNvdXJjZVVucmVnaXN0ZXJfID0ge307XG5cbiAgICBfdGhpcy5pbml0XygpO1xuXG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IF9kZWZhdWx0LnByb3RvdHlwZTtcblxuICBfcHJvdG8uaW5pdF8gPSBmdW5jdGlvbiBpbml0XygpIHtcbiAgICBpZiAoIXRoaXMuZGF0YVNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGF0YVNvdXJjZXMnKTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLmRhdGFTb3VyY2VzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGF0YVNvdXJjZSA9IF9yZWY7XG5cbiAgICAgIGlmIChkYXRhU291cmNlIGluc3RhbmNlb2Ygbmdlb0RhdGFzb3VyY2VPR0MpIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlckRhdGFTb3VyY2VfKGRhdGFTb3VyY2UpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uZGVzdHJveSA9IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IHRoaXMuZGF0YVNvdXJjZXMsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYyO1xuXG4gICAgICBpZiAoX2lzQXJyYXkyKSB7XG4gICAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmMiA9IF9pdGVyYXRvcjJbX2kyKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICAgIGlmIChfaTIuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYyID0gX2kyLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGF0YVNvdXJjZSA9IF9yZWYyO1xuXG4gICAgICBpZiAoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIG5nZW9EYXRhc291cmNlT0dDKSB7XG4gICAgICAgIHRoaXMudW5yZWdpc3RlckRhdGFTb3VyY2VfKGRhdGFTb3VyY2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIF9uZ2VvRGF0YXNvdXJjZU9HQ0dyby5wcm90b3R5cGUuZGVzdHJveS5jYWxsKHRoaXMpO1xuICB9O1xuXG4gIF9wcm90by5hZGREYXRhU291cmNlID0gZnVuY3Rpb24gYWRkRGF0YVNvdXJjZShkYXRhU291cmNlKSB7XG4gICAgX25nZW9EYXRhc291cmNlT0dDR3JvLnByb3RvdHlwZS5hZGREYXRhU291cmNlLmNhbGwodGhpcywgZGF0YVNvdXJjZSk7XG5cbiAgICBpZiAoIShkYXRhU291cmNlIGluc3RhbmNlb2Ygbmdlb0RhdGFzb3VyY2VPR0MpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGRhdGFzb3VyY2UgdHlwZScpO1xuICAgIH1cblxuICAgIHRoaXMucmVnaXN0ZXJEYXRhU291cmNlXyhkYXRhU291cmNlKTtcbiAgfTtcblxuICBfcHJvdG8ucmVnaXN0ZXJEYXRhU291cmNlXyA9IGZ1bmN0aW9uIHJlZ2lzdGVyRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSkge1xuICAgIHZhciBpZCA9IGRhdGFTb3VyY2UuaWQ7XG4gICAgdGhpcy53bXNEYXRhU291cmNlVW5yZWdpc3Rlcl9baWRdID0gdGhpcy5yb290U2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZGF0YVNvdXJjZS52aXNpYmxlO1xuICAgIH0sIHRoaXMuaGFuZGxlRGF0YVNvdXJjZVZpc2libGVDaGFuZ2VfLmJpbmQodGhpcykpO1xuXG4gICAgaWYgKCF0aGlzLmxheWVyXykge1xuICAgICAgdGhpcy5sYXllcl8gPSB0aGlzLm5nZW9MYXllckhlbHBlcl8uY3JlYXRlQmFzaWNXTVNMYXllckZyb21EYXRhU291cmNlKGRhdGFTb3VyY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxheWVyXy5nZXQoJ3F1ZXJ5U291cmNlSWRzJykucHVzaChpZCk7XG4gICAgICB0aGlzLnVwZGF0ZUxheWVyXygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRGF0YVNvdXJjZVZpc2libGVDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlRGF0YVNvdXJjZVZpc2libGVDaGFuZ2VfKHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBvbGRWYWx1ZSkge1xuICAgICAgdGhpcy51cGRhdGVMYXllcl8oKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnVwZGF0ZUxheWVyXyA9IGZ1bmN0aW9uIHVwZGF0ZUxheWVyXygpIHtcbiAgICB2YXIgbGF5ZXIgPSB0aGlzLmxheWVyO1xuICAgIHZhciBsYXllck5hbWVzID0gW107XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IzID0gdGhpcy5kYXRhU291cmNlcywgX2lzQXJyYXkzID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IzKSwgX2kzID0gMCwgX2l0ZXJhdG9yMyA9IF9pc0FycmF5MyA/IF9pdGVyYXRvcjMgOiBfaXRlcmF0b3IzW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjM7XG5cbiAgICAgIGlmIChfaXNBcnJheTMpIHtcbiAgICAgICAgaWYgKF9pMyA+PSBfaXRlcmF0b3IzLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYzID0gX2l0ZXJhdG9yM1tfaTMrK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaTMgPSBfaXRlcmF0b3IzLm5leHQoKTtcbiAgICAgICAgaWYgKF9pMy5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZjMgPSBfaTMudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBkYXRhU291cmNlID0gX3JlZjM7XG5cbiAgICAgIGlmIChkYXRhU291cmNlIGluc3RhbmNlb2Ygbmdlb0RhdGFzb3VyY2VPR0MgJiYgZGF0YVNvdXJjZS52aXNpYmxlKSB7XG4gICAgICAgIGxheWVyTmFtZXMgPSBsYXllck5hbWVzLmNvbmNhdChkYXRhU291cmNlLmdldFdNU0xheWVyTmFtZXMoKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5uZ2VvTGF5ZXJIZWxwZXJfLnVwZGF0ZVdNU0xheWVyU3RhdGUobGF5ZXIsIGxheWVyTmFtZXMuam9pbignLCcpKTtcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlRGF0YVNvdXJjZSA9IGZ1bmN0aW9uIHJlbW92ZURhdGFTb3VyY2UoZGF0YVNvdXJjZSkge1xuICAgIF9uZ2VvRGF0YXNvdXJjZU9HQ0dyby5wcm90b3R5cGUucmVtb3ZlRGF0YVNvdXJjZS5jYWxsKHRoaXMsIGRhdGFTb3VyY2UpO1xuXG4gICAgaWYgKGRhdGFTb3VyY2UgaW5zdGFuY2VvZiBuZ2VvRGF0YXNvdXJjZU9HQykge1xuICAgICAgdGhpcy51bnJlZ2lzdGVyRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by51bnJlZ2lzdGVyRGF0YVNvdXJjZV8gPSBmdW5jdGlvbiB1bnJlZ2lzdGVyRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSkge1xuICAgIHZhciBpZCA9IGRhdGFTb3VyY2UuaWQ7XG4gICAgdmFyIGxheWVyID0gdGhpcy5sYXllcjtcbiAgICB2YXIgdW5yZWdpc3RlciA9IHRoaXMud21zRGF0YVNvdXJjZVVucmVnaXN0ZXJfW2lkXTtcbiAgICB1bnJlZ2lzdGVyKCk7XG4gICAgZGVsZXRlIHRoaXMud21zRGF0YVNvdXJjZVVucmVnaXN0ZXJfW2lkXTtcbiAgICByZW1vdmVGcm9tQXJyYXkodGhpcy5kYXRhU291cmNlcywgZGF0YVNvdXJjZSk7XG4gICAgdmFyIGlkcyA9IHRoaXMubmdlb0xheWVySGVscGVyXy5nZXRRdWVyeVNvdXJjZUlkcyhsYXllcik7XG5cbiAgICBpZiAoaWRzKSB7XG4gICAgICByZW1vdmVGcm9tQXJyYXkoaWRzLCBpZCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YVNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICB0aGlzLnVwZGF0ZUxheWVyXygpO1xuICAgIH1cbiAgfTtcblxuICBfY3JlYXRlQ2xhc3MoX2RlZmF1bHQsIFt7XG4gICAga2V5OiBcImxheWVyXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICBpZiAoIXRoaXMubGF5ZXJfKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBsYXllcicpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5sYXllcl87XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIF9kZWZhdWx0O1xufShuZ2VvRGF0YXNvdXJjZU9HQ0dyb3VwKTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsIkRvd25sb2FkQ3N2U2VydmljZS4kaW5qZWN0ID0gW1wiJGluamVjdG9yXCIsIFwiZ2V0dGV4dENhdGFsb2dcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvRG93bmxvYWRTZXJ2aWNlIGZyb20gJ25nZW8vZG93bmxvYWQvc2VydmljZS5qcyc7XG5leHBvcnQgZnVuY3Rpb24gRG93bmxvYWRDc3ZTZXJ2aWNlKCRpbmplY3RvciwgZ2V0dGV4dENhdGFsb2cpIHtcbiAgdGhpcy5nZXR0ZXh0Q2F0YWxvZ18gPSBnZXR0ZXh0Q2F0YWxvZztcbiAgdGhpcy5lbmNvZGluZ18gPSAkaW5qZWN0b3IuaGFzKCduZ2VvQ3N2RW5jb2RpbmcnKSA/ICRpbmplY3Rvci5nZXQoJ25nZW9Dc3ZFbmNvZGluZycpIDogJ3V0Zi04JztcbiAgdGhpcy5leHRlbnNpb25fID0gJGluamVjdG9yLmhhcygnbmdlb0NzdkV4dGVuc2lvbicpID8gJGluamVjdG9yLmdldCgnbmdlb0NzdkV4dGVuc2lvbicpIDogJy5jc3YnO1xuICB0aGlzLmluY2x1ZGVIZWFkZXJfID0gJGluamVjdG9yLmhhcygnbmdlb0NzdkluY2x1ZGVIZWFkZXInKSA/ICRpbmplY3Rvci5nZXQoJ25nZW9Dc3ZJbmNsdWRlSGVhZGVyJykgOiB0cnVlO1xuICB0aGlzLnF1b3RlXyA9ICRpbmplY3Rvci5oYXMoJ25nZW9Dc3ZRdW90ZScpID8gJGluamVjdG9yLmdldCgnbmdlb0NzdlF1b3RlJykgOiAnXCInO1xuICB0aGlzLnNlcGFyYXRvcl8gPSAkaW5qZWN0b3IuaGFzKCduZ2VvQ3N2U2VwYXJhdG9yJykgPyAkaW5qZWN0b3IuZ2V0KCduZ2VvQ3N2U2VwYXJhdG9yJykgOiAnLCc7XG4gIHRoaXMuZG93bmxvYWRfID0gJGluamVjdG9yLmdldCgnbmdlb0Rvd25sb2FkJyk7XG59XG5cbkRvd25sb2FkQ3N2U2VydmljZS5wcm90b3R5cGUuZ2VuZXJhdGVDc3YgPSBmdW5jdGlvbiAoZGF0YSwgY29sdW1uRGVmcykge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIGlmIChkYXRhLmxlbmd0aCA9PSAwIHx8IGNvbHVtbkRlZnMubGVuZ3RoID09IDApIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICB2YXIgdHJhbnNsYXRlZENvbHVtbkhlYWRlcnMgPSBjb2x1bW5EZWZzLm1hcChmdW5jdGlvbiAoY29sdW1uSGVhZGVyKSB7XG4gICAgcmV0dXJuIF90aGlzLmdldHRleHRDYXRhbG9nXy5nZXRTdHJpbmcoY29sdW1uSGVhZGVyLm5hbWUpO1xuICB9KTtcbiAgdmFyIGhlYWRlciA9IHRoaXMuZ2V0Um93Xyh0cmFuc2xhdGVkQ29sdW1uSGVhZGVycyk7XG4gIHZhciBkYXRhUm93cyA9IGRhdGEubWFwKGZ1bmN0aW9uICh2YWx1ZXMpIHtcbiAgICB2YXIgcm93VmFsdWVzID0gY29sdW1uRGVmcy5tYXAoZnVuY3Rpb24gKGNvbHVtbkhlYWRlcikge1xuICAgICAgcmV0dXJuIHZhbHVlc1tjb2x1bW5IZWFkZXIubmFtZV07XG4gICAgfSk7XG4gICAgcmV0dXJuIF90aGlzLmdldFJvd18ocm93VmFsdWVzKTtcbiAgfSk7XG4gIHJldHVybiB0aGlzLmluY2x1ZGVIZWFkZXJfID8gaGVhZGVyICsgZGF0YVJvd3Muam9pbignJykgOiBkYXRhUm93cy5qb2luKCcnKTtcbn07XG5cbkRvd25sb2FkQ3N2U2VydmljZS5wcm90b3R5cGUuZ2V0Um93XyA9IGZ1bmN0aW9uICh2YWx1ZXMpIHtcbiAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgdmFyIG1hdGNoQWxsUXVvdGVzUmVnZXggPSBuZXcgUmVnRXhwKHRoaXMucXVvdGVfLCAnZycpO1xuICB2YXIgZG91YmxlUXVvdGUgPSB0aGlzLnF1b3RlXyArIHRoaXMucXVvdGVfO1xuICB2YXIgcm93VmFsdWVzID0gdmFsdWVzLm1hcChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgdmFsdWUgPSBcIlwiICsgdmFsdWU7XG4gICAgICByZXR1cm4gXCJcIiArIF90aGlzMi5xdW90ZV8gKyB2YWx1ZS5yZXBsYWNlKG1hdGNoQWxsUXVvdGVzUmVnZXgsIGRvdWJsZVF1b3RlKSArIF90aGlzMi5xdW90ZV87XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcm93VmFsdWVzLmpvaW4odGhpcy5zZXBhcmF0b3JfKSArIFwiXFxuXCI7XG59O1xuXG5Eb3dubG9hZENzdlNlcnZpY2UucHJvdG90eXBlLnN0YXJ0RG93bmxvYWQgPSBmdW5jdGlvbiAoZGF0YSwgY29sdW1uRGVmcywgZmlsZU5hbWUpIHtcbiAgdmFyIGZpbGVDb250ZW50ID0gdGhpcy5nZW5lcmF0ZUNzdihkYXRhLCBjb2x1bW5EZWZzKTtcbiAgdGhpcy5kb3dubG9hZF8oZmlsZUNvbnRlbnQsIGZpbGVOYW1lLCBcInRleHQvY3N2O2NoYXJzZXQ9XCIgKyB0aGlzLmVuY29kaW5nXyk7XG59O1xuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9Dc3ZEb3dubG9hZCcsIFtuZ2VvRG93bmxvYWRTZXJ2aWNlLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvQ3N2RG93bmxvYWQnLCBEb3dubG9hZENzdlNlcnZpY2UpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgaXNTYWZhcmkgfSBmcm9tICduZ2VvL3V0aWxzLmpzJztcbmltcG9ydCB7IHNhdmVBcyB9IGZyb20gJ2ZpbGUtc2F2ZXInO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvRG93bmxvYWQnLCBbXSk7XG5cbmZ1bmN0aW9uIGZhY3RvcnkoKSB7XG4gIGZ1bmN0aW9uIGRvd25sb2FkKGNvbnRlbnQsIGZpbGVOYW1lLCBvcHRfZmlsZVR5cGUpIHtcbiAgICB2YXIgZmlsZVR5cGUgPSBvcHRfZmlsZVR5cGUgIT09IHVuZGVmaW5lZCAmJiAhaXNTYWZhcmkoKSA/IG9wdF9maWxlVHlwZSA6ICd0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgnO1xuICAgIHZhciBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7XG4gICAgICB0eXBlOiBmaWxlVHlwZVxuICAgIH0pO1xuICAgIHNhdmVBcyhibG9iLCBmaWxlTmFtZSk7XG4gIH1cblxuICByZXR1cm4gZG93bmxvYWQ7XG59XG5cbm1vZHVsZS5mYWN0b3J5KCduZ2VvRG93bmxvYWQnLCBmYWN0b3J5KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvRHJhd0ZlYXR1cmVzIGZyb20gJ25nZW8vZHJhdy9mZWF0dXJlcy5qcyc7XG5pbXBvcnQgbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzIGZyb20gJ25nZW8vZm9ybWF0L0ZlYXR1cmVQcm9wZXJ0aWVzLmpzJztcbmltcG9ydCBuZ2VvR2VvbWV0cnlUeXBlIGZyb20gJ25nZW8vR2VvbWV0cnlUeXBlLmpzJztcbmltcG9ydCBuZ2VvTWlzY0J0bkNvbXBvbmVudCBmcm9tICduZ2VvL21pc2MvYnRuQ29tcG9uZW50LmpzJztcbmltcG9ydCB7IGludGVyYWN0aW9uRGVjb3JhdGlvbiBhcyBuZ2VvTWlzY0RlY29yYXRlSW50ZXJhY3Rpb24gfSBmcm9tICduZ2VvL21pc2MvZGVjb3JhdGUuanMnO1xuaW1wb3J0IG5nZW9NaXNjRmVhdHVyZUhlbHBlciBmcm9tICduZ2VvL21pc2MvRmVhdHVyZUhlbHBlci5qcyc7XG5pbXBvcnQgb2xGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuZXhwb3J0IHZhciBEcmF3Q29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgRHJhd0NvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcImdldHRleHRDYXRhbG9nXCIsIFwibmdlb0ZlYXR1cmVIZWxwZXJcIiwgXCJuZ2VvRmVhdHVyZXNcIl07XG5cbiAgZnVuY3Rpb24gRHJhd0NvbnRyb2xsZXIoJHNjb3BlLCBnZXR0ZXh0Q2F0YWxvZywgbmdlb0ZlYXR1cmVIZWxwZXIsIG5nZW9GZWF0dXJlcykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMuZmVhdHVyZXMgPSBudWxsO1xuICAgIHRoaXMubWFwID0gbnVsbDtcbiAgICB0aGlzLnNob3dNZWFzdXJlID0gZmFsc2U7XG4gICAgdGhpcy5nZXR0ZXh0Q2F0YWxvZ18gPSBnZXR0ZXh0Q2F0YWxvZztcbiAgICBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1BvaW50Jyk7XG4gICAgZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdMaW5lU3RyaW5nJyk7XG4gICAgZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdQb2x5Z29uJyk7XG4gICAgZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdDaXJjbGUnKTtcbiAgICBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1JlY3RhbmdsZScpO1xuICAgIGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnVGV4dCcpO1xuICAgIHRoaXMuZmVhdHVyZUhlbHBlcl8gPSBuZ2VvRmVhdHVyZUhlbHBlcjtcbiAgICB0aGlzLm5nZW9GZWF0dXJlc18gPSBuZ2VvRmVhdHVyZXM7XG4gICAgdGhpcy5pbnRlcmFjdGlvbnNfID0gW107XG4gICAgdGhpcy5kcmF3UG9pbnQgPSBudWxsO1xuICAgIHRoaXMubWVhc3VyZUxlbmd0aCA9IG51bGw7XG4gICAgdGhpcy5tZWFzdXJlQXJlYSA9IG51bGw7XG4gICAgdGhpcy5tZWFzdXJlQXppbXV0ID0gbnVsbDtcbiAgICB0aGlzLmRyYXdSZWN0YW5nbGUgPSBudWxsO1xuICAgIHRoaXMuZHJhd1RleHQgPSBudWxsO1xuICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF90aGlzLmFjdGl2ZTtcbiAgICB9LCBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgICBpZiAobmV3VmFsID09PSBmYWxzZSkge1xuICAgICAgICBfdGhpcy5pbnRlcmFjdGlvbnNfLmZvckVhY2goZnVuY3Rpb24gKGludGVyYWN0aW9uKSB7XG4gICAgICAgICAgaW50ZXJhY3Rpb24uc2V0QWN0aXZlKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gRHJhd0NvbnRyb2xsZXIucHJvdG90eXBlO1xuXG4gIF9wcm90by5yZWdpc3RlckludGVyYWN0aW9uID0gZnVuY3Rpb24gcmVnaXN0ZXJJbnRlcmFjdGlvbihpbnRlcmFjdGlvbikge1xuICAgIGlmICghdGhpcy5tYXApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXAnKTtcbiAgICB9XG5cbiAgICB0aGlzLmludGVyYWN0aW9uc18ucHVzaChpbnRlcmFjdGlvbik7XG4gICAgaW50ZXJhY3Rpb24uc2V0QWN0aXZlKGZhbHNlKTtcbiAgICBuZ2VvTWlzY0RlY29yYXRlSW50ZXJhY3Rpb24oaW50ZXJhY3Rpb24pO1xuICAgIHRoaXMubWFwLmFkZEludGVyYWN0aW9uKGludGVyYWN0aW9uKTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlQWN0aXZlQ2hhbmdlID0gZnVuY3Rpb24gaGFuZGxlQWN0aXZlQ2hhbmdlKGV2ZW50KSB7XG4gICAgdGhpcy5hY3RpdmUgPSB0aGlzLmludGVyYWN0aW9uc18uc29tZShmdW5jdGlvbiAoaW50ZXJhY3Rpb24pIHtcbiAgICAgIHJldHVybiBpbnRlcmFjdGlvbi5nZXRBY3RpdmUoKTtcbiAgICB9LCB0aGlzKTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRHJhd0VuZCA9IGZ1bmN0aW9uIGhhbmRsZURyYXdFbmQodHlwZSwgZXZlbnQpIHtcbiAgICB2YXIgc2tldGNoO1xuXG4gICAgaWYgKGV2ZW50LmZlYXR1cmUpIHtcbiAgICAgIHNrZXRjaCA9IGV2ZW50LmZlYXR1cmU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNrZXRjaCA9IGV2ZW50LmRldGFpbC5mZWF0dXJlO1xuICAgIH1cblxuICAgIGNvbnNvbGUuYXNzZXJ0KHNrZXRjaCk7XG4gICAgdmFyIGF6aW11dCA9IHNrZXRjaC5nZXQoJ2F6aW11dCcpO1xuICAgIHZhciBmZWF0dXJlcyA9IHRoaXMuZmVhdHVyZXMgfHwgdGhpcy5uZ2VvRmVhdHVyZXNfO1xuICAgIHZhciBmZWF0dXJlID0gbmV3IG9sRmVhdHVyZShza2V0Y2guZ2V0R2VvbWV0cnkoKSk7XG4gICAgdmFyIHByb3AgPSBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXM7XG5cbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2Ugbmdlb0dlb21ldHJ5VHlwZS5DSVJDTEU6XG4gICAgICAgIGZlYXR1cmUuc2V0KHByb3AuSVNfQ0lSQ0xFLCB0cnVlKTtcblxuICAgICAgICBpZiAoYXppbXV0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBmZWF0dXJlLnNldChwcm9wLkFaSU1VVCwgYXppbXV0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIG5nZW9HZW9tZXRyeVR5cGUuVEVYVDpcbiAgICAgICAgZmVhdHVyZS5zZXQocHJvcC5JU19URVhULCB0cnVlKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2Ugbmdlb0dlb21ldHJ5VHlwZS5SRUNUQU5HTEU6XG4gICAgICAgIGZlYXR1cmUuc2V0KHByb3AuSVNfUkVDVEFOR0xFLCB0cnVlKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHZhciBuYW1lID0gdGhpcy5nZXR0ZXh0Q2F0YWxvZ18uZ2V0U3RyaW5nKHR5cGUpO1xuICAgIGZlYXR1cmUuc2V0KHByb3AuTkFNRSwgbmFtZSArIFwiIFwiICsgKGZlYXR1cmVzLmdldExlbmd0aCgpICsgMSkpO1xuICAgIHZhciBjb2xvciA9IHR5cGUgIT09IG5nZW9HZW9tZXRyeVR5cGUuVEVYVCA/ICcjREI0NDM2JyA6ICcjMDAwMDAwJztcbiAgICBmZWF0dXJlLnNldChwcm9wLkNPTE9SLCBjb2xvcik7XG4gICAgZmVhdHVyZS5zZXQocHJvcC5BTkdMRSwgMCk7XG4gICAgZmVhdHVyZS5zZXQocHJvcC5PUEFDSVRZLCAwLjIpO1xuICAgIGZlYXR1cmUuc2V0KHByb3AuU0hPV19NRUFTVVJFLCB0aGlzLnNob3dNZWFzdXJlID8gdHJ1ZSA6IGZhbHNlKTtcbiAgICBmZWF0dXJlLnNldChwcm9wLlNIT1dfTEFCRUwsIGZhbHNlKTtcbiAgICBmZWF0dXJlLnNldChwcm9wLlNJWkUsIDEwKTtcbiAgICBmZWF0dXJlLnNldChwcm9wLlNUUk9LRSwgMik7XG4gICAgdGhpcy5mZWF0dXJlSGVscGVyXy5zZXRTdHlsZShmZWF0dXJlKTtcbiAgICBmZWF0dXJlcy5wdXNoKGZlYXR1cmUpO1xuICB9O1xuXG4gIHJldHVybiBEcmF3Q29udHJvbGxlcjtcbn0oKTtcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0RyYXdmZWF0dXJlQ29udHJvbGxlcicsIFtuZ2VvRHJhd0ZlYXR1cmVzLm5hbWUsIG5nZW9NaXNjQnRuQ29tcG9uZW50Lm5hbWUsIG5nZW9NaXNjRmVhdHVyZUhlbHBlci5uYW1lXSk7XG5tb2R1bGUuY29udHJvbGxlcignbmdlb0RyYXdmZWF0dXJlQ29udHJvbGxlcicsIERyYXdDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvRHJhd0NvbnRyb2xsZXIgZnJvbSAnbmdlby9kcmF3L0NvbnRyb2xsZXIuanMnO1xuaW1wb3J0IG5nZW9EcmF3UG9pbnQgZnJvbSAnbmdlby9kcmF3L3BvaW50LmpzJztcbmltcG9ydCBuZ2VvRHJhd1JlY3RhbmdsZSBmcm9tICduZ2VvL2RyYXcvcmVjdGFuZ2xlLmpzJztcbmltcG9ydCBuZ2VvRHJhd1RleHQgZnJvbSAnbmdlby9kcmF3L3RleHQuanMnO1xuaW1wb3J0IG5nZW9NZWFzdXJlQXJlYSBmcm9tICduZ2VvL21lYXN1cmUvYXJlYS5qcyc7XG5pbXBvcnQgbmdlb01lYXN1cmVBemltdXQgZnJvbSAnbmdlby9tZWFzdXJlL2F6aW11dC5qcyc7XG5pbXBvcnQgbmdlb01lYXN1cmVMZW5ndGggZnJvbSAnbmdlby9tZWFzdXJlL2xlbmd0aC5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9EcmF3ZmVhdHVyZScsIFtuZ2VvRHJhd0NvbnRyb2xsZXIubmFtZSwgbmdlb0RyYXdQb2ludC5uYW1lLCBuZ2VvRHJhd1JlY3RhbmdsZS5uYW1lLCBuZ2VvRHJhd1RleHQubmFtZSwgbmdlb01lYXN1cmVBcmVhLm5hbWUsIG5nZW9NZWFzdXJlQXppbXV0Lm5hbWUsIG5nZW9NZWFzdXJlTGVuZ3RoLm5hbWVdKTtcblxuZnVuY3Rpb24gZHJhd0NvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBjb250cm9sbGVyOiAnbmdlb0RyYXdmZWF0dXJlQ29udHJvbGxlciBhcyBkZkN0cmwnLFxuICAgIHNjb3BlOiB0cnVlLFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICdhY3RpdmUnOiAnPW5nZW9EcmF3ZmVhdHVyZUFjdGl2ZScsXG4gICAgICAnZmVhdHVyZXMnOiAnPT9uZ2VvRHJhd2ZlYXR1cmVGZWF0dXJlcycsXG4gICAgICAnbWFwJzogJz1uZ2VvRHJhd2ZlYXR1cmVNYXAnLFxuICAgICAgJ3Nob3dNZWFzdXJlJzogJz0/bmdlb0RyYXdmZWF0dXJlU2hvd21lYXN1cmUnXG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvRHJhd2ZlYXR1cmUnLCBkcmF3Q29tcG9uZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9GZWF0dXJlcycsIFtdKTtcbm1vZHVsZS52YWx1ZSgnbmdlb0ZlYXR1cmVzJywgbmV3IG9sQ29sbGVjdGlvbigpKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvR2VvbWV0cnlUeXBlIGZyb20gJ25nZW8vR2VvbWV0cnlUeXBlLmpzJztcbmltcG9ydCB7IGxpc3RlbiB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvbkRyYXcgZnJvbSAnb2wvaW50ZXJhY3Rpb24vRHJhdy5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9EcmF3cG9pbnQnLCBbXSk7XG5cbmZ1bmN0aW9uIGRyYXdQb2ludENvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHJlcXVpcmU6ICdeXm5nZW9EcmF3ZmVhdHVyZScsXG4gICAgbGluazogZnVuY3Rpb24gbGluaygkc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBkcmF3RmVhdHVyZUN0cmwpIHtcbiAgICAgIGlmICghZHJhd0ZlYXR1cmVDdHJsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkcmF3RmVhdHVyZUN0cmwnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGRyYXdQb2ludCA9IG5ldyBvbEludGVyYWN0aW9uRHJhdyh7XG4gICAgICAgIHR5cGU6ICdQb2ludCdcbiAgICAgIH0pO1xuICAgICAgZHJhd0ZlYXR1cmVDdHJsLnJlZ2lzdGVySW50ZXJhY3Rpb24oZHJhd1BvaW50KTtcbiAgICAgIGRyYXdGZWF0dXJlQ3RybC5kcmF3UG9pbnQgPSBkcmF3UG9pbnQ7XG4gICAgICBsaXN0ZW4oZHJhd1BvaW50LCAnZHJhd2VuZCcsIGRyYXdGZWF0dXJlQ3RybC5oYW5kbGVEcmF3RW5kLmJpbmQoZHJhd0ZlYXR1cmVDdHJsLCBuZ2VvR2VvbWV0cnlUeXBlLlBPSU5UKSwgZHJhd0ZlYXR1cmVDdHJsKTtcbiAgICAgIGxpc3RlbihkcmF3UG9pbnQsICdjaGFuZ2U6YWN0aXZlJywgZHJhd0ZlYXR1cmVDdHJsLmhhbmRsZUFjdGl2ZUNoYW5nZSwgZHJhd0ZlYXR1cmVDdHJsKTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9EcmF3cG9pbnQnLCBkcmF3UG9pbnRDb21wb25lbnQpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9HZW9tZXRyeVR5cGUgZnJvbSAnbmdlby9HZW9tZXRyeVR5cGUuanMnO1xuaW1wb3J0IHsgbGlzdGVuIH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbEludGVyYWN0aW9uRHJhdyBmcm9tICdvbC9pbnRlcmFjdGlvbi9EcmF3LmpzJztcbmltcG9ydCBvbEdlb21Qb2x5Z29uIGZyb20gJ29sL2dlb20vUG9seWdvbi5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9EcmF3cmVjdGFuZ2xlJywgW10pO1xuXG5mdW5jdGlvbiBkcmF3UmVjdGFuZ2xlQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgcmVxdWlyZTogJ15ebmdlb0RyYXdmZWF0dXJlJyxcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKCRzY29wZSwgZWxlbWVudCwgYXR0cnMsIGRyYXdGZWF0dXJlQ3RybCkge1xuICAgICAgaWYgKCFkcmF3RmVhdHVyZUN0cmwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGRyYXdGZWF0dXJlQ3RybCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZHJhd1JlY3RhbmdsZSA9IG5ldyBvbEludGVyYWN0aW9uRHJhdyh7XG4gICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJyxcbiAgICAgICAgZ2VvbWV0cnlGdW5jdGlvbjogZnVuY3Rpb24gZ2VvbWV0cnlGdW5jdGlvbihjb29yZGluYXRlcywgZ2VvbWV0cnkpIHtcbiAgICAgICAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICAgICAgICBnZW9tZXRyeSA9IG5ldyBvbEdlb21Qb2x5Z29uKFtdKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgc3RhcnQgPSBjb29yZGluYXRlc1swXTtcblxuICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzdGFydCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgY29vcmRpbmF0ZXMgdHlwZScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBlbmQgPSBjb29yZGluYXRlc1sxXTtcblxuICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShlbmQpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGNvb3JkaW5hdGVzIHR5cGUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBnZW9tZXRyeS5zZXRDb29yZGluYXRlcyhbW3N0YXJ0LCBbc3RhcnRbMF0sIGVuZFsxXV0sIGVuZCwgW2VuZFswXSwgc3RhcnRbMV1dLCBzdGFydF1dKTtcbiAgICAgICAgICByZXR1cm4gZ2VvbWV0cnk7XG4gICAgICAgIH0sXG4gICAgICAgIG1heFBvaW50czogMlxuICAgICAgfSk7XG4gICAgICBkcmF3RmVhdHVyZUN0cmwucmVnaXN0ZXJJbnRlcmFjdGlvbihkcmF3UmVjdGFuZ2xlKTtcbiAgICAgIGRyYXdGZWF0dXJlQ3RybC5kcmF3UmVjdGFuZ2xlID0gZHJhd1JlY3RhbmdsZTtcbiAgICAgIGxpc3RlbihkcmF3UmVjdGFuZ2xlLCAnZHJhd2VuZCcsIGRyYXdGZWF0dXJlQ3RybC5oYW5kbGVEcmF3RW5kLmJpbmQoZHJhd0ZlYXR1cmVDdHJsLCBuZ2VvR2VvbWV0cnlUeXBlLlJFQ1RBTkdMRSksIGRyYXdGZWF0dXJlQ3RybCk7XG4gICAgICBsaXN0ZW4oZHJhd1JlY3RhbmdsZSwgJ2NoYW5nZTphY3RpdmUnLCBkcmF3RmVhdHVyZUN0cmwuaGFuZGxlQWN0aXZlQ2hhbmdlLCBkcmF3RmVhdHVyZUN0cmwpO1xuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb0RyYXdyZWN0YW5nbGUnLCBkcmF3UmVjdGFuZ2xlQ29tcG9uZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvR2VvbWV0cnlUeXBlIGZyb20gJ25nZW8vR2VvbWV0cnlUeXBlLmpzJztcbmltcG9ydCB7IGxpc3RlbiB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvbkRyYXcgZnJvbSAnb2wvaW50ZXJhY3Rpb24vRHJhdy5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9EcmF3dGV4dCcsIFtdKTtcblxuZnVuY3Rpb24gZHJhd1RleHRDb21wb25lbnQoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICByZXF1aXJlOiAnXl5uZ2VvRHJhd2ZlYXR1cmUnLFxuICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsoJHNjb3BlLCBlbGVtZW50LCBhdHRycywgZHJhd0ZlYXR1cmVDdHJsKSB7XG4gICAgICBpZiAoIWRyYXdGZWF0dXJlQ3RybCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZHJhd0ZlYXR1cmVDdHJsJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBkcmF3VGV4dCA9IG5ldyBvbEludGVyYWN0aW9uRHJhdyh7XG4gICAgICAgIHR5cGU6ICdQb2ludCdcbiAgICAgIH0pO1xuICAgICAgZHJhd0ZlYXR1cmVDdHJsLnJlZ2lzdGVySW50ZXJhY3Rpb24oZHJhd1RleHQpO1xuICAgICAgZHJhd0ZlYXR1cmVDdHJsLmRyYXdUZXh0ID0gZHJhd1RleHQ7XG4gICAgICBsaXN0ZW4oZHJhd1RleHQsICdkcmF3ZW5kJywgZHJhd0ZlYXR1cmVDdHJsLmhhbmRsZURyYXdFbmQuYmluZChkcmF3RmVhdHVyZUN0cmwsIG5nZW9HZW9tZXRyeVR5cGUuVEVYVCksIGRyYXdGZWF0dXJlQ3RybCk7XG4gICAgICBsaXN0ZW4oZHJhd1RleHQsICdjaGFuZ2U6YWN0aXZlJywgZHJhd0ZlYXR1cmVDdHJsLmhhbmRsZUFjdGl2ZUNoYW5nZSwgZHJhd0ZlYXR1cmVDdHJsKTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9EcmF3dGV4dCcsIGRyYXdUZXh0Q29tcG9uZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCJuZ2VvRXZlbnRIZWxwZXJcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IGdldFVpZCBhcyBvbFV0aWxHZXRVaWQgfSBmcm9tICdvbC91dGlsLmpzJztcbmltcG9ydCB7IGxpc3RlbiB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgbmdlb01pc2NFdmVudEhlbHBlciBmcm9tICduZ2VvL21pc2MvRXZlbnRIZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9NaXNjRGF0ZXRpbWVwaWNrZXJDb21wb25lbnQgZnJvbSAnbmdlby9taXNjL2RhdGV0aW1lcGlja2VyQ29tcG9uZW50LmpzJztcbmltcG9ydCB7IE9iamVjdEV2ZW50IH0gZnJvbSAnb2wvT2JqZWN0LmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0F0dHJpYnV0ZXMnLCBbbmdlb01pc2NEYXRldGltZXBpY2tlckNvbXBvbmVudC5uYW1lLCBuZ2VvTWlzY0V2ZW50SGVscGVyLm5hbWVdKTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnbmdlby9lZGl0aW5nL2F0dHJpYnV0ZXNjb21wb25lbnQnLCByZXF1aXJlKCcuL2F0dHJpYnV0ZXNjb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcbm1vZHVsZS52YWx1ZSgnbmdlb0F0dHJpYnV0ZXNUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uICgkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzLm5nZW9BdHRyaWJ1dGVzVGVtcGxhdGVVcmw7XG4gIHJldHVybiB0ZW1wbGF0ZVVybCAhPT0gdW5kZWZpbmVkID8gdGVtcGxhdGVVcmwgOiAnbmdlby9lZGl0aW5nL2F0dHJpYnV0ZXNjb21wb25lbnQnO1xufSk7XG5uZ2VvQXR0cmlidXRlc1RlbXBsYXRlVXJsLiRpbmplY3QgPSBbXCIkYXR0cnNcIiwgXCJuZ2VvQXR0cmlidXRlc1RlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBuZ2VvQXR0cmlidXRlc1RlbXBsYXRlVXJsKCRhdHRycywgbmdlb0F0dHJpYnV0ZXNUZW1wbGF0ZVVybCkge1xuICByZXR1cm4gbmdlb0F0dHJpYnV0ZXNUZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG52YXIgZWRpdGluZ0F0dHJpYnV0ZUNvbXBvbmVudCA9IHtcbiAgY29udHJvbGxlcjogJ25nZW9BdHRyaWJ1dGVzQ29udHJvbGxlciBhcyBhdHRyQ3RybCcsXG4gIGJpbmRpbmdzOiB7XG4gICAgJ2F0dHJpYnV0ZXMnOiAnPW5nZW9BdHRyaWJ1dGVzQXR0cmlidXRlcycsXG4gICAgJ2Rpc2FibGVkJzogJzxuZ2VvQXR0cmlidXRlc0Rpc2FibGVkJyxcbiAgICAnZmVhdHVyZSc6ICc9bmdlb0F0dHJpYnV0ZXNGZWF0dXJlJ1xuICB9LFxuICByZXF1aXJlOiB7XG4gICAgJ2Zvcm0nOiAnXidcbiAgfSxcbiAgdGVtcGxhdGVVcmw6IG5nZW9BdHRyaWJ1dGVzVGVtcGxhdGVVcmxcbn07XG5tb2R1bGUuY29tcG9uZW50KCduZ2VvQXR0cmlidXRlcycsIGVkaXRpbmdBdHRyaWJ1dGVDb21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKCRzY29wZSwgbmdlb0V2ZW50SGVscGVyKSB7XG4gIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gIHRoaXMuZmVhdHVyZSA9IG51bGw7XG4gIHRoaXMucHJvcGVydGllcyA9IHt9O1xuICB0aGlzLnNjb3BlXyA9ICRzY29wZTtcbiAgdGhpcy5uZ2VvRXZlbnRIZWxwZXJfID0gbmdlb0V2ZW50SGVscGVyO1xuICB0aGlzLnVwZGF0aW5nXyA9IGZhbHNlO1xufVxuXG5Db250cm9sbGVyLnByb3RvdHlwZS4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMuZmVhdHVyZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlJyk7XG4gIH1cblxuICB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLmZlYXR1cmUuZ2V0UHJvcGVydGllcygpO1xuICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKHRoaXMpO1xuICB0aGlzLm5nZW9FdmVudEhlbHBlcl8uYWRkTGlzdGVuZXJLZXkodWlkLCBsaXN0ZW4odGhpcy5mZWF0dXJlLCAncHJvcGVydHljaGFuZ2UnLCB0aGlzLmhhbmRsZUZlYXR1cmVQcm9wZXJ0eUNoYW5nZV8sIHRoaXMpKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZUlucHV0Q2hhbmdlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgaWYgKCF0aGlzLnByb3BlcnRpZXMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcHJvcGVydGllcycpO1xuICB9XG5cbiAgaWYgKCF0aGlzLmZlYXR1cmUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZScpO1xuICB9XG5cbiAgdGhpcy51cGRhdGluZ18gPSB0cnVlO1xuICB2YXIgdmFsdWUgPSB0aGlzLnByb3BlcnRpZXNbbmFtZV07XG4gIHRoaXMuZmVhdHVyZS5zZXQobmFtZSwgdmFsdWUpO1xuICB0aGlzLnVwZGF0aW5nXyA9IGZhbHNlO1xufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuJG9uRGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHVpZCA9IG9sVXRpbEdldFVpZCh0aGlzKTtcbiAgdGhpcy5uZ2VvRXZlbnRIZWxwZXJfLmNsZWFyTGlzdGVuZXJLZXkodWlkKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZUZlYXR1cmVQcm9wZXJ0eUNoYW5nZV8gPSBmdW5jdGlvbiAoZXZ0KSB7XG4gIGlmIChldnQgaW5zdGFuY2VvZiBPYmplY3RFdmVudCkge1xuICAgIGlmICh0aGlzLnVwZGF0aW5nXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMucHJvcGVydGllc1tldnQua2V5XSA9IGV2dC50YXJnZXQuZ2V0KGV2dC5rZXkpO1xuICAgIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xuICB9XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignbmdlb0F0dHJpYnV0ZXNDb250cm9sbGVyJywgQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGZpZWxkc2V0IG5nLWRpc2FibGVkPVwiYXR0ckN0cmwuZGlzYWJsZWRcIj5cXG4gIDxkaXZcXG4gICAgICBjbGFzcz1cImZvcm0tZ3JvdXBcIlxcbiAgICAgIG5nLXJlcGVhdD1cImF0dHJpYnV0ZSBpbiA6OmF0dHJDdHJsLmF0dHJpYnV0ZXNcIj5cXG4gICAgPGRpdiBuZy1pZj1cImF0dHJpYnV0ZS50eXBlICE9PSBcXCdnZW9tZXRyeVxcJ1wiPlxcbiAgICAgIDxsYWJlbFxcbiAgICAgICAgICBuZy1pZj1cIjo6YXR0cmlidXRlLnR5cGUgIT09IFxcJ2Jvb2xlYW5cXCdcIlxcbiAgICAgICAgICBjbGFzcz1cImNvbC1mb3JtLWxhYmVsXCI+e3sgOjphdHRyaWJ1dGUubmFtZSB8IHRyYW5zbGF0ZSB9fSA8c3BhbiBjbGFzcz1cInRleHQtbXV0ZWRcIj57ezo6YXR0cmlidXRlLnJlcXVpcmVkID8gXCIqXCIgOiBcIlwifX08L3NwYW4+XFxuICAgICAgPC9sYWJlbD5cXG5cXG4gICAgICA8ZGl2XFxuICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgbmctaWY9XCI6OmF0dHJpYnV0ZS5yZWFkb25seVwiXFxuICAgICAgICAgIHJlYWRvbmx5PlxcbiAgICAgICAge3s6OmF0dHJDdHJsLnByb3BlcnRpZXNbYXR0cmlidXRlLm5hbWVdfX1cXG4gICAgICA8L2Rpdj5cXG5cXG4gICAgICA8ZGl2XFxuICAgICAgICAgIG5nLWlmPVwiOjohYXR0cmlidXRlLnJlYWRvbmx5XCJcXG4gICAgICAgICAgbmctc3dpdGNoPVwiOjphdHRyaWJ1dGUudHlwZVwiPlxcblxcbiAgICAgICAgPGRpdlxcbiAgICAgICAgICAgIG5nLXN3aXRjaC13aGVuPVwiYm9vbGVhblwiXFxuICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNoZWNrXCI+XFxuICAgICAgICAgIDxsYWJlbCBjbGFzcz1cImZvcm0tY2hlY2stbGFiZWxcIj5cXG4gICAgICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgICAgICAgbmFtZT1cInt7OjphdHRyaWJ1dGUubmFtZX19XCJcXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNoZWNrLWlucHV0XCJcXG4gICAgICAgICAgICAgICAgbmctbW9kZWw9XCJhdHRyQ3RybC5wcm9wZXJ0aWVzW2F0dHJpYnV0ZS5uYW1lXVwiXFxuICAgICAgICAgICAgICAgIG5nLWNoYW5nZT1cImF0dHJDdHJsLmhhbmRsZUlucHV0Q2hhbmdlKGF0dHJpYnV0ZS5uYW1lKTtcIlxcbiAgICAgICAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIj5cXG4gICAgICAgICAgICA8L2lucHV0PlxcbiAgICAgICAgICAgIDxzcGFuPiB7eyA6OmF0dHJpYnV0ZS5uYW1lIHwgdHJhbnNsYXRlIH19IDxzcGFuIGNsYXNzPVwidGV4dC1tdXRlZFwiPnt7OjphdHRyaWJ1dGUucmVxdWlyZWQgPyBcIipcIiA6IFwiXCJ9fTwvc3Bhbj48L3NwYW4+XFxuICAgICAgICAgIDwvbGFiZWw+XFxuICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgIDxzZWxlY3RcXG4gICAgICAgICAgICBuYW1lPVwie3s6OmF0dHJpYnV0ZS5uYW1lfX1cIlxcbiAgICAgICAgICAgIG5nLXJlcXVpcmVkPVwiYXR0cmlidXRlLnJlcXVpcmVkXCJcXG4gICAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cInNlbGVjdFwiXFxuICAgICAgICAgICAgbmctbW9kZWw9XCJhdHRyQ3RybC5wcm9wZXJ0aWVzW2F0dHJpYnV0ZS5uYW1lXVwiXFxuICAgICAgICAgICAgbmctY2hhbmdlPVwiYXR0ckN0cmwuaGFuZGxlSW5wdXRDaGFuZ2UoYXR0cmlidXRlLm5hbWUpO1wiXFxuICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCI+XFxuICAgICAgICAgIDxvcHRpb25cXG4gICAgICAgICAgICAgIG5nLXJlcGVhdD1cImF0dHJpYnV0ZSBpbiA6OmF0dHJpYnV0ZS5jaG9pY2VzXCJcXG4gICAgICAgICAgICAgIHZhbHVlPVwie3sgOjphdHRyaWJ1dGUgfX1cIj5cXG4gICAgICAgICAgICB7eyA6OmF0dHJpYnV0ZSB8IHRyYW5zbGF0ZSB9fVxcbiAgICAgICAgICA8L29wdGlvbj5cXG4gICAgICAgIDwvc2VsZWN0PlxcblxcbiAgICAgICAgPGlucHV0XFxuICAgICAgICAgICAgbmFtZT1cInt7OjphdHRyaWJ1dGUubmFtZX19XCJcXG4gICAgICAgICAgICBuZy1yZXF1aXJlZD1cImF0dHJpYnV0ZS5yZXF1aXJlZFwiXFxuICAgICAgICAgICAgbmctc3dpdGNoLXdoZW49XCJkYXRlXCJcXG4gICAgICAgICAgICBuZy1tb2RlbD1cImF0dHJDdHJsLnByb3BlcnRpZXNbYXR0cmlidXRlLm5hbWVdXCJcXG4gICAgICAgICAgICBuZy1jaGFuZ2U9XCJhdHRyQ3RybC5oYW5kbGVJbnB1dENoYW5nZShhdHRyaWJ1dGUubmFtZSk7XCJcXG4gICAgICAgICAgICBuZ2VvLWRhdGV0aW1lcGlja2VyXFxuICAgICAgICAgICAgbmdlby1kYXRldGltZXBpY2tlci1vcHRpb25zPVwiXFwneyZxdW90O3RpbWVwaWNrZXImcXVvdDs6IGZhbHNlLCAmcXVvdDtmb3JtYXQmcXVvdDs6ICZxdW90O1xcJyArIGF0dHJpYnV0ZS5mb3JtYXQgKyBcXCcmcXVvdDssICZxdW90O2FsbG93QmxhbmsmcXVvdDs6IHRydWUsICZxdW90O3RvZGF5QnV0dG9uJnF1b3Q7OiBmYWxzZSwgJnF1b3Q7bWFzayZxdW90OzogJnF1b3Q7XFwnICsgYXR0cmlidXRlLm1hc2sgKyBcXCcmcXVvdDt9XFwnXCJcXG4gICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgICAgdHlwZT1cInRleHRcIj5cXG4gICAgICAgIDwvaW5wdXQ+XFxuXFxuICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgICBuYW1lPVwie3s6OmF0dHJpYnV0ZS5uYW1lfX1cIlxcbiAgICAgICAgICAgIGlkPVwidGltZVwiXFxuICAgICAgICAgICAgbmctcmVxdWlyZWQ9XCJhdHRyaWJ1dGUucmVxdWlyZWRcIlxcbiAgICAgICAgICAgIG5nLXN3aXRjaC13aGVuPVwidGltZVwiXFxuICAgICAgICAgICAgbmctbW9kZWw9XCJhdHRyQ3RybC5wcm9wZXJ0aWVzW2F0dHJpYnV0ZS5uYW1lXVwiXFxuICAgICAgICAgICAgbmctY2hhbmdlPVwiYXR0ckN0cmwuaGFuZGxlSW5wdXRDaGFuZ2UoYXR0cmlidXRlLm5hbWUpO1wiXFxuICAgICAgICAgICAgbmdlby1kYXRldGltZXBpY2tlclxcbiAgICAgICAgICAgIG5nZW8tZGF0ZXRpbWVwaWNrZXItb3B0aW9ucz1cIlxcJ3smcXVvdDtkYXRlcGlja2VyJnF1b3Q7OiBmYWxzZSwgJnF1b3Q7Zm9ybWF0JnF1b3Q7OiAmcXVvdDtcXCcgKyBhdHRyaWJ1dGUuZm9ybWF0ICsgXFwnJnF1b3Q7LCAmcXVvdDt0b2RheUJ1dHRvbiZxdW90OzogZmFsc2UsICZxdW90O21hc2smcXVvdDs6ICZxdW90O1xcJyArIGF0dHJpYnV0ZS5tYXNrICsgXFwnJnF1b3Q7LCAmcXVvdDtkZWZhdWx0VGltZSZxdW90OzogJnF1b3Q7MDA6MDAmcXVvdDt9XFwnXCJcXG4gICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgICAgdHlwZT1cInRleHRcIj5cXG4gICAgICAgIDwvaW5wdXQ+XFxuXFxuICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgICBuYW1lPVwie3s6OmF0dHJpYnV0ZS5uYW1lfX1cIlxcbiAgICAgICAgICAgIG5nLXJlcXVpcmVkPVwiYXR0cmlidXRlLnJlcXVpcmVkXCJcXG4gICAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cImRhdGV0aW1lXCJcXG4gICAgICAgICAgICBuZy1tb2RlbD1cImF0dHJDdHJsLnByb3BlcnRpZXNbYXR0cmlidXRlLm5hbWVdXCJcXG4gICAgICAgICAgICBuZy1jaGFuZ2U9XCJhdHRyQ3RybC5oYW5kbGVJbnB1dENoYW5nZShhdHRyaWJ1dGUubmFtZSk7XCJcXG4gICAgICAgICAgICBuZ2VvLWRhdGV0aW1lcGlja2VyXFxuICAgICAgICAgICAgbmdlby1kYXRldGltZXBpY2tlci1vcHRpb25zPVwiXFwneyZxdW90O3Njcm9sbFRpbWUmcXVvdDs6IGZhbHNlLCAmcXVvdDtmb3JtYXQmcXVvdDs6ICZxdW90O1xcJyArIGF0dHJpYnV0ZS5mb3JtYXQgKyBcXCcmcXVvdDssICZxdW90O2FsbG93QmxhbmsmcXVvdDs6IHRydWUsICZxdW90O3RvZGF5QnV0dG9uJnF1b3Q7OiBmYWxzZSwgJnF1b3Q7bWFzayZxdW90OzogJnF1b3Q7XFwnICsgYXR0cmlidXRlLm1hc2sgKyBcXCcmcXVvdDssICZxdW90O2RlZmF1bHRUaW1lJnF1b3Q7OiAmcXVvdDswMDowMCZxdW90O31cXCdcIlxcbiAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiPlxcbiAgICAgICAgPC9pbnB1dD5cXG5cXG4gICAgICAgIDxkaXZcXG4gICAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cIm51bWJlclwiXFxuICAgICAgICAgICAgbmctc3dpdGNoPVwiOjphdHRyaWJ1dGUubnVtVHlwZVwiPlxcbiAgICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgICAgIG5hbWU9XCJ7ezo6YXR0cmlidXRlLm5hbWV9fVwiXFxuICAgICAgICAgICAgICBuZy1yZXF1aXJlZD1cImF0dHJpYnV0ZS5yZXF1aXJlZFwiXFxuICAgICAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cImludGVnZXJcIlxcbiAgICAgICAgICAgICAgbmctbW9kZWw9XCJhdHRyQ3RybC5wcm9wZXJ0aWVzW2F0dHJpYnV0ZS5uYW1lXVwiXFxuICAgICAgICAgICAgICBuZy1jaGFuZ2U9XCJhdHRyQ3RybC5oYW5kbGVJbnB1dENoYW5nZShhdHRyaWJ1dGUubmFtZSk7XCJcXG4gICAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgICAgIHN0ZXA9XCIxXCJcXG4gICAgICAgICAgICAgIHR5cGU9XCJudW1iZXJcIj5cXG4gICAgICAgICAgPC9pbnB1dD5cXG4gICAgICAgICAgPGlucHV0XFxuICAgICAgICAgICAgICBuYW1lPVwie3s6OmF0dHJpYnV0ZS5uYW1lfX1cIlxcbiAgICAgICAgICAgICAgbmctcmVxdWlyZWQ9XCJhdHRyaWJ1dGUucmVxdWlyZWRcIlxcbiAgICAgICAgICAgICAgbmctc3dpdGNoLWRlZmF1bHRcXG4gICAgICAgICAgICAgIG5nLW1vZGVsPVwiYXR0ckN0cmwucHJvcGVydGllc1thdHRyaWJ1dGUubmFtZV1cIlxcbiAgICAgICAgICAgICAgbmctY2hhbmdlPVwiYXR0ckN0cmwuaGFuZGxlSW5wdXRDaGFuZ2UoYXR0cmlidXRlLm5hbWUpO1wiXFxuICAgICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCI+XFxuICAgICAgICAgIDwvaW5wdXQ+XFxuICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgIDxpbnB1dFxcbiAgICAgICAgICAgIG5hbWU9XCJ7ezo6YXR0cmlidXRlLm5hbWV9fVwiXFxuICAgICAgICAgICAgbmctcmVxdWlyZWQ9XCJhdHRyaWJ1dGUucmVxdWlyZWRcIlxcbiAgICAgICAgICAgIG5nLXN3aXRjaC1kZWZhdWx0XFxuICAgICAgICAgICAgbmctbW9kZWw9XCJhdHRyQ3RybC5wcm9wZXJ0aWVzW2F0dHJpYnV0ZS5uYW1lXVwiXFxuICAgICAgICAgICAgbmctY2hhbmdlPVwiYXR0ckN0cmwuaGFuZGxlSW5wdXRDaGFuZ2UoYXR0cmlidXRlLm5hbWUpO1wiXFxuICAgICAgICAgICAgbmctbWF4bGVuZ3RoPVwiYXR0cmlidXRlLm1heExlbmd0aFwiXFxuICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCI+XFxuICAgICAgICA8L2lucHV0PlxcblxcbiAgICAgICAgPGRpdiBuZy1zaG93PVwiYXR0ckN0cmwuZm9ybS4kc3VibWl0dGVkIHx8IGF0dHJDdHJsLmZvcm1bYXR0cmlidXRlLm5hbWVdLiR0b3VjaGVkXCI+XFxuICAgICAgICAgIDxwIGNsYXNzPVwidGV4dC1kYW5nZXJcIlxcbiAgICAgICAgICAgICBuZy1zaG93PVwiYXR0ckN0cmwuZm9ybVthdHRyaWJ1dGUubmFtZV0uJGVycm9yLnJlcXVpcmVkXCI+XFxuICAgICAgICAgICAge3tcXCdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkXFwnIHwgdHJhbnNsYXRlfX1cXG4gICAgICAgICAgPC9wPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuPC9maWVsZHNldD5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiZ2V0dGV4dENhdGFsb2dcIiwgXCIkY29tcGlsZVwiLCBcIiRmaWx0ZXJcIiwgXCIkaW5qZWN0b3JcIiwgXCIkc2NvcGVcIiwgXCIkdGltZW91dFwiLCBcIm5nZW9FdmVudEhlbHBlclwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9NaXNjRmlsdGVycyBmcm9tICduZ2VvL21pc2MvZmlsdGVycy5qcyc7XG5pbXBvcnQgbmdlb0dlb21ldHJ5VHlwZSBmcm9tICduZ2VvL0dlb21ldHJ5VHlwZS5qcyc7XG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uTWVhc3VyZUFyZWEgZnJvbSAnbmdlby9pbnRlcmFjdGlvbi9NZWFzdXJlQXJlYS5qcyc7XG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uTWVhc3VyZUxlbmd0aCBmcm9tICduZ2VvL2ludGVyYWN0aW9uL01lYXN1cmVMZW5ndGguanMnO1xuaW1wb3J0IG5nZW9NaXNjRXZlbnRIZWxwZXIgZnJvbSAnbmdlby9taXNjL0V2ZW50SGVscGVyLmpzJztcbmltcG9ydCB7IHRvTXVsdGkgfSBmcm9tICduZ2VvL3V0aWxzLmpzJztcbmltcG9ydCB7IGdldFVpZCBhcyBvbFV0aWxHZXRVaWQgfSBmcm9tICdvbC91dGlsLmpzJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4gfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sRmVhdHVyZSBmcm9tICdvbC9GZWF0dXJlLmpzJztcbmltcG9ydCBvbEludGVyYWN0aW9uRHJhdyBmcm9tICdvbC9pbnRlcmFjdGlvbi9EcmF3LmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvQ3JlYXRlZmVhdHVyZScsIFtuZ2VvTWlzY0V2ZW50SGVscGVyLm5hbWUsIG5nZW9NaXNjRmlsdGVycy5uYW1lXSk7XG5cbmZ1bmN0aW9uIGVkaXRpbmdDcmVhdGVGZWF0dXJlQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIGNvbnRyb2xsZXI6ICduZ2VvQ3JlYXRlZmVhdHVyZUNvbnRyb2xsZXInLFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgc2NvcGU6IHtcbiAgICAgICdhY3RpdmUnOiAnPW5nZW9DcmVhdGVmZWF0dXJlQWN0aXZlJyxcbiAgICAgICdmZWF0dXJlcyc6ICc9bmdlb0NyZWF0ZWZlYXR1cmVGZWF0dXJlcycsXG4gICAgICAnZ2VvbVR5cGUnOiAnPW5nZW9DcmVhdGVmZWF0dXJlR2VvbVR5cGUnLFxuICAgICAgJ21hcCc6ICc9bmdlb0NyZWF0ZWZlYXR1cmVNYXAnXG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvQ3JlYXRlZmVhdHVyZScsIGVkaXRpbmdDcmVhdGVGZWF0dXJlQ29tcG9uZW50KTtcblxuZnVuY3Rpb24gQ29udHJvbGxlcihnZXR0ZXh0Q2F0YWxvZywgJGNvbXBpbGUsICRmaWx0ZXIsICRpbmplY3RvciwgJHNjb3BlLCAkdGltZW91dCwgbmdlb0V2ZW50SGVscGVyKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgdGhpcy5mZWF0dXJlcyA9IG51bGw7XG4gIHRoaXMuZ2VvbVR5cGUgPSAnJztcbiAgdGhpcy5tYXAgPSBudWxsO1xuICB0aGlzLmdldHRleHRDYXRhbG9nXyA9IGdldHRleHRDYXRhbG9nO1xuICB0aGlzLmNvbXBpbGVfID0gJGNvbXBpbGU7XG4gIHRoaXMuZmlsdGVyXyA9ICRmaWx0ZXI7XG4gIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICB0aGlzLnRpbWVvdXRfID0gJHRpbWVvdXQ7XG4gIHRoaXMubmdlb0V2ZW50SGVscGVyXyA9IG5nZW9FdmVudEhlbHBlcjtcbiAgdGhpcy5pbmplY3Rvcl8gPSAkaW5qZWN0b3I7XG4gIHRoaXMuaW50ZXJhY3Rpb25fID0gbnVsbDtcbiAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIF90aGlzLmFjdGl2ZTtcbiAgfSwgZnVuY3Rpb24gKG5ld1ZhbCkge1xuICAgIGlmICghX3RoaXMuaW50ZXJhY3Rpb25fKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgaW50ZXJhY3Rpb24nKTtcbiAgICB9XG5cbiAgICBfdGhpcy5pbnRlcmFjdGlvbl8uc2V0QWN0aXZlKG5ld1ZhbCk7XG4gIH0pO1xufVxuXG5Db250cm9sbGVyLnByb3RvdHlwZS4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmFjdGl2ZSA9IHRoaXMuYWN0aXZlID09PSB0cnVlO1xuICB2YXIgZ2V0dGV4dENhdGFsb2cgPSB0aGlzLmdldHRleHRDYXRhbG9nXztcbiAgdmFyIGludGVyYWN0aW9uO1xuXG4gIGlmICh0aGlzLmdlb21UeXBlID09PSBuZ2VvR2VvbWV0cnlUeXBlLlBPSU5UIHx8IHRoaXMuZ2VvbVR5cGUgPT09IG5nZW9HZW9tZXRyeVR5cGUuTVVMVElfUE9JTlQpIHtcbiAgICBpbnRlcmFjdGlvbiA9IG5ldyBvbEludGVyYWN0aW9uRHJhdyh7XG4gICAgICB0eXBlOiAnUG9pbnQnXG4gICAgfSk7XG4gIH0gZWxzZSBpZiAodGhpcy5nZW9tVHlwZSA9PT0gbmdlb0dlb21ldHJ5VHlwZS5MSU5FX1NUUklORyB8fCB0aGlzLmdlb21UeXBlID09PSBuZ2VvR2VvbWV0cnlUeXBlLk1VTFRJX0xJTkVfU1RSSU5HKSB7XG4gICAgdmFyIGhlbHBNc2cgPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0NsaWNrIHRvIHN0YXJ0IGRyYXdpbmcgbGVuZ3RoJyk7XG4gICAgdmFyIGNvbnRNc2cgPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0NsaWNrIHRvIGNvbnRpbnVlIGRyYXdpbmc8YnIvPicgKyAnRG91YmxlLWNsaWNrIG9yIGNsaWNrIGxhc3QgcG9pbnQgdG8gZmluaXNoJyk7XG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICBzdHlsZTogbmV3IG9sU3R5bGVTdHlsZSgpLFxuICAgICAgc3RhcnRNc2c6IHRoaXMuY29tcGlsZV8oXCI8ZGl2IHRyYW5zbGF0ZT5cIiArIGhlbHBNc2cgKyBcIjwvZGl2PlwiKSh0aGlzLnNjb3BlXylbMF0sXG4gICAgICBjb250aW51ZU1zZzogdGhpcy5jb21waWxlXyhcIjxkaXYgdHJhbnNsYXRlPlwiICsgY29udE1zZyArIFwiPC9kaXY+XCIpKHRoaXMuc2NvcGVfKVswXVxuICAgIH07XG5cbiAgICBpZiAodGhpcy5pbmplY3Rvcl8uaGFzKCduZ2VvU25hcHBpbmdUb2xlcmFuY2UnKSkge1xuICAgICAgb3B0aW9ucy50b2xlcmFuY2UgPSB0aGlzLmluamVjdG9yXy5nZXQoJ25nZW9TbmFwcGluZ1RvbGVyYW5jZScpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmluamVjdG9yXy5oYXMoJ25nZW9TbmFwcGluZ1NvdXJjZScpKSB7XG4gICAgICBvcHRpb25zLnNvdXJjZSA9IHRoaXMuaW5qZWN0b3JfLmdldCgnbmdlb1NuYXBwaW5nU291cmNlJyk7XG4gICAgfVxuXG4gICAgaW50ZXJhY3Rpb24gPSBuZXcgbmdlb0ludGVyYWN0aW9uTWVhc3VyZUxlbmd0aCh0aGlzLmZpbHRlcl8oJ25nZW9Vbml0UHJlZml4JyksIGdldHRleHRDYXRhbG9nLCBvcHRpb25zKTtcbiAgfSBlbHNlIGlmICh0aGlzLmdlb21UeXBlID09PSBuZ2VvR2VvbWV0cnlUeXBlLlBPTFlHT04gfHwgdGhpcy5nZW9tVHlwZSA9PT0gbmdlb0dlb21ldHJ5VHlwZS5NVUxUSV9QT0xZR09OKSB7XG4gICAgdmFyIF9oZWxwTXNnID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdDbGljayB0byBzdGFydCBkcmF3aW5nIGFyZWEnKTtcblxuICAgIHZhciBfY29udE1zZyA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQ2xpY2sgdG8gY29udGludWUgZHJhd2luZzxici8+JyArICdEb3VibGUtY2xpY2sgb3IgY2xpY2sgc3RhcnRpbmcgcG9pbnQgdG8gZmluaXNoJyk7XG5cbiAgICBpbnRlcmFjdGlvbiA9IG5ldyBuZ2VvSW50ZXJhY3Rpb25NZWFzdXJlQXJlYSh0aGlzLmZpbHRlcl8oJ25nZW9Vbml0UHJlZml4JyksIGdldHRleHRDYXRhbG9nLCB7XG4gICAgICBzdHlsZTogbmV3IG9sU3R5bGVTdHlsZSgpLFxuICAgICAgc3RhcnRNc2c6IHRoaXMuY29tcGlsZV8oXCI8ZGl2IHRyYW5zbGF0ZT5cIiArIF9oZWxwTXNnICsgXCI8L2Rpdj5cIikodGhpcy5zY29wZV8pWzBdLFxuICAgICAgY29udGludWVNc2c6IHRoaXMuY29tcGlsZV8oXCI8ZGl2IHRyYW5zbGF0ZT5cIiArIF9jb250TXNnICsgXCI8L2Rpdj5cIikodGhpcy5zY29wZV8pWzBdXG4gICAgfSk7XG4gIH1cblxuICBpZiAoIWludGVyYWN0aW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGludGVyYWN0aW9uJyk7XG4gIH1cblxuICBpZiAoIXRoaXMubWFwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICB9XG5cbiAgaW50ZXJhY3Rpb24uc2V0QWN0aXZlKHRoaXMuYWN0aXZlKTtcbiAgdGhpcy5pbnRlcmFjdGlvbl8gPSBpbnRlcmFjdGlvbjtcbiAgdGhpcy5tYXAuYWRkSW50ZXJhY3Rpb24oaW50ZXJhY3Rpb24pO1xuICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKHRoaXMpO1xuXG4gIGlmIChpbnRlcmFjdGlvbiBpbnN0YW5jZW9mIG9sSW50ZXJhY3Rpb25EcmF3KSB7XG4gICAgdGhpcy5uZ2VvRXZlbnRIZWxwZXJfLmFkZExpc3RlbmVyS2V5KHVpZCwgbGlzdGVuKGludGVyYWN0aW9uLCAnZHJhd2VuZCcsIHRoaXMuaGFuZGxlRHJhd0VuZF8sIHRoaXMpKTtcbiAgfSBlbHNlIGlmIChpbnRlcmFjdGlvbiBpbnN0YW5jZW9mIG5nZW9JbnRlcmFjdGlvbk1lYXN1cmVMZW5ndGggfHwgaW50ZXJhY3Rpb24gaW5zdGFuY2VvZiBuZ2VvSW50ZXJhY3Rpb25NZWFzdXJlQXJlYSkge1xuICAgIHRoaXMubmdlb0V2ZW50SGVscGVyXy5hZGRMaXN0ZW5lcktleSh1aWQsIGxpc3RlbihpbnRlcmFjdGlvbiwgJ21lYXN1cmVlbmQnLCB0aGlzLmhhbmRsZURyYXdFbmRfLCB0aGlzKSk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZURyYXdFbmRfID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gIHZhciBza2V0Y2g7XG5cbiAgaWYgKGV2ZW50LmZlYXR1cmUpIHtcbiAgICBza2V0Y2ggPSBldmVudC5mZWF0dXJlO1xuICB9IGVsc2Uge1xuICAgIHNrZXRjaCA9IGV2ZW50LmRldGFpbC5mZWF0dXJlO1xuICB9XG5cbiAgY29uc29sZS5hc3NlcnQoc2tldGNoKTtcbiAgdmFyIGdlb21ldHJ5ID0gc2tldGNoLmdldEdlb21ldHJ5KCk7XG4gIHZhciB0eXBlID0gZ2VvbWV0cnkuZ2V0VHlwZSgpO1xuXG4gIGlmICh0aGlzLmdlb21UeXBlLmluZGV4T2YoJ011bHRpJykgIT0gdHlwZS5pbmRleE9mKCdNdWx0aScpKSB7XG4gICAgZ2VvbWV0cnkgPSB0b011bHRpKGdlb21ldHJ5KTtcbiAgfVxuXG4gIHZhciBmZWF0dXJlID0gbmV3IG9sRmVhdHVyZShnZW9tZXRyeSk7XG5cbiAgaWYgKHRoaXMuZmVhdHVyZXMgaW5zdGFuY2VvZiBvbENvbGxlY3Rpb24pIHtcbiAgICB0aGlzLmZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCF0aGlzLmZlYXR1cmVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZXMnKTtcbiAgICB9XG5cbiAgICB0aGlzLmZlYXR1cmVzLmFkZEZlYXR1cmUoZmVhdHVyZSk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLiRvbkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIHRoaXMudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgIGlmICghX3RoaXMyLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIGlmICghX3RoaXMyLmludGVyYWN0aW9uXykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGludGVyYWN0aW9uJyk7XG4gICAgfVxuXG4gICAgdmFyIHVpZCA9IG9sVXRpbEdldFVpZChfdGhpczIpO1xuXG4gICAgX3RoaXMyLm5nZW9FdmVudEhlbHBlcl8uY2xlYXJMaXN0ZW5lcktleSh1aWQpO1xuXG4gICAgX3RoaXMyLmludGVyYWN0aW9uXy5zZXRBY3RpdmUoZmFsc2UpO1xuXG4gICAgX3RoaXMyLm1hcC5yZW1vdmVJbnRlcmFjdGlvbihfdGhpczIuaW50ZXJhY3Rpb25fKTtcbiAgfSwgMCk7XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignbmdlb0NyZWF0ZWZlYXR1cmVDb250cm9sbGVyJywgQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkaW5qZWN0b3JcIiwgXCIkc2NvcGVcIiwgXCJuZ2VvRmVhdHVyZUhlbHBlclwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9NaXNjRmVhdHVyZUhlbHBlciwgeyBGZWF0dXJlRm9ybWF0VHlwZSB9IGZyb20gJ25nZW8vbWlzYy9GZWF0dXJlSGVscGVyLmpzJztcbmltcG9ydCB7IGdldFVpZCBhcyBvbFV0aWxHZXRVaWQgfSBmcm9tICdvbC91dGlsLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0V4cG9ydGZlYXR1cmVzJywgW25nZW9NaXNjRmVhdHVyZUhlbHBlci5uYW1lXSk7XG5cbmZ1bmN0aW9uIGVkaXRpbmdFeHBvcnRGZWF0dXJlc0NvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBjb250cm9sbGVyOiAnbmdlb0V4cG9ydGZlYXR1cmVzQ29udHJvbGxlciBhcyBlZkN0cmwnLFxuICAgIHNjb3BlOiB0cnVlLFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICdmZWF0dXJlcyc6ICc9bmdlb0V4cG9ydGZlYXR1cmVzRmVhdHVyZXMnXG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvRXhwb3J0ZmVhdHVyZXMnLCBlZGl0aW5nRXhwb3J0RmVhdHVyZXNDb21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKCRlbGVtZW50LCAkaW5qZWN0b3IsICRzY29wZSwgbmdlb0ZlYXR1cmVIZWxwZXIpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLmZlYXR1cmVzID0gbnVsbDtcbiAgdGhpcy5lbGVtZW50XyA9ICRlbGVtZW50O1xuICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKHRoaXMpO1xuICB2YXIgaWQgPSBbJ25nZW8tZXhwb3J0ZmVhdHVyZScsIHVpZF0uam9pbignLScpO1xuICB0aGlzLmlkXyA9IGlkO1xuICB0aGlzLmZlYXR1cmVIZWxwZXJfID0gbmdlb0ZlYXR1cmVIZWxwZXI7XG4gIHZhciBmb3JtYXRzO1xuXG4gIGlmICgkaW5qZWN0b3IuaGFzKCduZ2VvRXhwb3J0RmVhdHVyZUZvcm1hdHMnKSkge1xuICAgIGZvcm1hdHMgPSAkaW5qZWN0b3IuZ2V0KCduZ2VvRXhwb3J0RmVhdHVyZUZvcm1hdHMnKTtcbiAgfSBlbHNlIHtcbiAgICBmb3JtYXRzID0gW0ZlYXR1cmVGb3JtYXRUeXBlLktNTF07XG4gIH1cblxuICB0aGlzLm1lbnVfID0gbnVsbDtcbiAgdGhpcy5pdGVtc18gPSBbXTtcblxuICBpZiAoZm9ybWF0cy5sZW5ndGggPiAxKSB7XG4gICAgJGVsZW1lbnQuYXR0cignaWQnLCBpZCk7XG4gICAgdmFyICRtZW51ID0gJCgnPHVsIC8+Jywge1xuICAgICAgJ2NsYXNzJzogJ2Ryb3Bkb3duLW1lbnUnLFxuICAgICAgJ2FyaWEtbGFiZWxsZWRieSc6IGlkXG4gICAgfSkuYXBwZW5kVG8oJGVsZW1lbnQucGFyZW50KClbMF0pO1xuICAgIHRoaXMubWVudV8gPSAkbWVudTtcbiAgICB2YXIgJGl0ZW07XG4gICAgZm9ybWF0cy5mb3JFYWNoKGZ1bmN0aW9uIChmb3JtYXQpIHtcbiAgICAgICRpdGVtID0gJCgnPGxpIC8+JykuYXBwZW5kVG8oJG1lbnUpLmFwcGVuZCgkKCc8YSAvPicsIHtcbiAgICAgICAgJ2hyZWYnOiAnIycsXG4gICAgICAgICd0ZXh0JzogZm9ybWF0XG4gICAgICB9KS5vbihbJ2NsaWNrJywgaWRdLmpvaW4oJy4nKSwgX3RoaXMuaGFuZGxlTWVudUl0ZW1DbGlja18uYmluZChfdGhpcywgZm9ybWF0KSkpO1xuXG4gICAgICBfdGhpcy5pdGVtc18ucHVzaCgkaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmZvcm1hdHNfID0gZm9ybWF0cztcbiAgJGVsZW1lbnQub24oWydjbGljaycsIGlkXS5qb2luKCcuJyksIHRoaXMuaGFuZGxlRWxlbWVudENsaWNrXy5iaW5kKHRoaXMpKTtcbiAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCB0aGlzLmhhbmRsZURlc3Ryb3lfLmJpbmQodGhpcykpO1xufVxuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVFbGVtZW50Q2xpY2tfID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMyID0gdGhpcztcblxuICBpZiAoIXRoaXMuZmVhdHVyZXMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZXMnKTtcbiAgfVxuXG4gIHZhciBmZWF0dXJlcyA9IHRoaXMuZmVhdHVyZXMuZ2V0QXJyYXkoKTtcblxuICBpZiAodGhpcy5mb3JtYXRzXy5sZW5ndGggPT09IDEpIHtcbiAgICB0aGlzLmZlYXR1cmVIZWxwZXJfLmV4cG9ydChmZWF0dXJlcywgdGhpcy5mb3JtYXRzX1swXSk7XG4gIH0gZWxzZSBpZiAoZmVhdHVyZXMubGVuZ3RoID09PSAxKSB7XG4gICAgdmFyIGZlYXR1cmUgPSBmZWF0dXJlc1swXTtcbiAgICB2YXIgZ2VvbWV0cnkgPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICB2YXIgZ2VvbWV0cnlUeXBlID0gZ2VvbWV0cnkuZ2V0VHlwZSgpO1xuICAgIHZhciAkaXRlbTtcbiAgICB0aGlzLmZvcm1hdHNfLmZvckVhY2goZnVuY3Rpb24gKGZvcm1hdCwgaSkge1xuICAgICAgJGl0ZW0gPSBfdGhpczIuaXRlbXNfW2ldO1xuXG4gICAgICBpZiAoZm9ybWF0ID09PSBGZWF0dXJlRm9ybWF0VHlwZS5HUFgpIHtcbiAgICAgICAgaWYgKGdlb21ldHJ5VHlwZSA9PT0gJ1BvaW50JyB8fCBnZW9tZXRyeVR5cGUgPT09ICdMaW5lU3RyaW5nJykge1xuICAgICAgICAgICRpdGVtLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRpdGVtLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZU1lbnVJdGVtQ2xpY2tfID0gZnVuY3Rpb24gKGZvcm1hdCwgZXZlbnQpIHtcbiAgaWYgKCF0aGlzLmZlYXR1cmVzKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmVzJyk7XG4gIH1cblxuICBpZiAoIWV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50Jyk7XG4gIH1cblxuICBpZiAoISQoZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XG4gICAgdmFyIGZlYXR1cmVzID0gdGhpcy5mZWF0dXJlcy5nZXRBcnJheSgpO1xuICAgIHRoaXMuZmVhdHVyZUhlbHBlcl8uZXhwb3J0KGZlYXR1cmVzLCBmb3JtYXQpO1xuICB9XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVEZXN0cm95XyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGlkID0gdGhpcy5pZF87XG4gIHRoaXMuZWxlbWVudF8ub2ZmKFsnY2xpY2snLCBpZF0uam9pbignLicpKTtcblxuICBpZiAodGhpcy5tZW51Xykge1xuICAgIHRoaXMubWVudV8ucmVtb3ZlKCk7XG4gICAgdGhpcy5pdGVtc18uZm9yRWFjaChmdW5jdGlvbiAoJGl0ZW0pIHtcbiAgICAgICRpdGVtLm9mZihbJ2NsaWNrJywgaWRdLmpvaW4oJy4nKSk7XG4gICAgfSk7XG4gICAgdGhpcy5pdGVtc18ubGVuZ3RoID0gMDtcbiAgICB0aGlzLm1lbnVfID0gbnVsbDtcbiAgfVxufTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ25nZW9FeHBvcnRmZWF0dXJlc0NvbnRyb2xsZXInLCBDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgeyB1bmxpc3RlbkJ5S2V5IH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmV4cG9ydCBmdW5jdGlvbiB1bmxpc3RlbkJ5S2V5cyhrZXlzKSB7XG4gIGZvciAodmFyIF9pdGVyYXRvciA9IGtleXMsIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IpLCBfaSA9IDAsIF9pdGVyYXRvciA9IF9pc0FycmF5ID8gX2l0ZXJhdG9yIDogX2l0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgdmFyIF9yZWY7XG5cbiAgICBpZiAoX2lzQXJyYXkpIHtcbiAgICAgIGlmIChfaSA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcbiAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgfSBlbHNlIHtcbiAgICAgIF9pID0gX2l0ZXJhdG9yLm5leHQoKTtcbiAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgIF9yZWYgPSBfaS52YWx1ZTtcbiAgICB9XG5cbiAgICB2YXIga2V5ID0gX3JlZjtcbiAgICB1bmxpc3RlbkJ5S2V5KGtleSk7XG4gIH1cblxuICBrZXlzLmxlbmd0aCA9IDA7XG59IiwiZXhwb3J0IGRlZmF1bHQge1xuICBBTkQ6ICcmJicsXG4gIE5PVDogJyEnLFxuICBPUjogJ3x8J1xufTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvRmlsdGVyQ29uZGl0aW9uIGZyb20gJ25nZW8vZmlsdGVyL0NvbmRpdGlvbi5qcyc7XG5pbXBvcnQgbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUgZnJvbSAnbmdlby9mb3JtYXQvQXR0cmlidXRlVHlwZS5qcyc7XG5pbXBvcnQgbmdlb01pc2NGZWF0dXJlSGVscGVyIGZyb20gJ25nZW8vbWlzYy9GZWF0dXJlSGVscGVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY1dNU1RpbWUgZnJvbSAnbmdlby9taXNjL1dNU1RpbWUuanMnO1xuaW1wb3J0IG5nZW9SdWxlRGF0ZSBmcm9tICduZ2VvL3J1bGUvRGF0ZS5qcyc7XG5pbXBvcnQgbmdlb1J1bGVHZW9tZXRyeSBmcm9tICduZ2VvL3J1bGUvR2VvbWV0cnkuanMnO1xuaW1wb3J0IG5nZW9SdWxlUnVsZSwgeyBSdWxlT3BlcmF0b3JUeXBlLCBSdWxlU3BhdGlhbE9wZXJhdG9yVHlwZSwgUnVsZVRlbXBvcmFsT3BlcmF0b3JUeXBlIH0gZnJvbSAnbmdlby9ydWxlL1J1bGUuanMnO1xuaW1wb3J0IG5nZW9SdWxlU2VsZWN0IGZyb20gJ25nZW8vcnVsZS9TZWxlY3QuanMnO1xuaW1wb3J0IG5nZW9SdWxlVGV4dCBmcm9tICduZ2VvL3J1bGUvVGV4dC5qcyc7XG5pbXBvcnQgeyB3cml0ZUZpbHRlciB9IGZyb20gJ29sL2Zvcm1hdC9XRlMuanMnO1xuaW1wb3J0ICogYXMgb2xGb3JtYXRGaWx0ZXIgZnJvbSAnb2wvZm9ybWF0L2ZpbHRlci5qcyc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5leHBvcnQgdmFyIFJ1bGVIZWxwZXIgPSBmdW5jdGlvbiAoKSB7XG4gIFJ1bGVIZWxwZXIuJGluamVjdCA9IFtcImdldHRleHRDYXRhbG9nXCIsIFwibmdlb0ZlYXR1cmVIZWxwZXJcIiwgXCJuZ2VvV01TVGltZVwiXTtcblxuICBmdW5jdGlvbiBSdWxlSGVscGVyKGdldHRleHRDYXRhbG9nLCBuZ2VvRmVhdHVyZUhlbHBlciwgbmdlb1dNU1RpbWUpIHtcbiAgICB0aGlzLmdldHRleHRDYXRhbG9nXyA9IGdldHRleHRDYXRhbG9nO1xuICAgIHRoaXMubmdlb0ZlYXR1cmVIZWxwZXJfID0gbmdlb0ZlYXR1cmVIZWxwZXI7XG4gICAgdGhpcy5uZ2VvV01TVGltZV8gPSBuZ2VvV01TVGltZTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBSdWxlSGVscGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uY3JlYXRlUnVsZXNGcm9tQXR0cmlidXRlcyA9IGZ1bmN0aW9uIGNyZWF0ZVJ1bGVzRnJvbUF0dHJpYnV0ZXMoYXR0cmlidXRlcywgb3B0X2lzQ3VzdG9tKSB7XG4gICAgdmFyIHJ1bGVzID0gW107XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBhdHRyaWJ1dGVzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgYXR0cmlidXRlID0gX3JlZjtcbiAgICAgIHJ1bGVzLnB1c2godGhpcy5jcmVhdGVSdWxlRnJvbUF0dHJpYnV0ZShhdHRyaWJ1dGUsIG9wdF9pc0N1c3RvbSkpO1xuICAgIH1cblxuICAgIHJldHVybiBydWxlcztcbiAgfTtcblxuICBfcHJvdG8uY3JlYXRlUnVsZUZyb21BdHRyaWJ1dGUgPSBmdW5jdGlvbiBjcmVhdGVSdWxlRnJvbUF0dHJpYnV0ZShhdHRyaWJ1dGUsIG9wdF9pc0N1c3RvbSkge1xuICAgIHZhciBydWxlO1xuICAgIHZhciBpc0N1c3RvbSA9IG9wdF9pc0N1c3RvbSA9PT0gdHJ1ZTtcbiAgICB2YXIgbmFtZSA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfLmdldFN0cmluZyhhdHRyaWJ1dGUubmFtZSk7XG5cbiAgICBzd2l0Y2ggKGF0dHJpYnV0ZS50eXBlKSB7XG4gICAgICBjYXNlIG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkRBVEU6XG4gICAgICBjYXNlIG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkRBVEVUSU1FOlxuICAgICAgICBpZiAoaXNDdXN0b20pIHtcbiAgICAgICAgICBydWxlID0gbmV3IG5nZW9SdWxlRGF0ZSh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFJ1bGVUZW1wb3JhbE9wZXJhdG9yVHlwZS5FUVVBTFMsXG4gICAgICAgICAgICBvcGVyYXRvcnM6IFtSdWxlVGVtcG9yYWxPcGVyYXRvclR5cGUuRVFVQUxTLCBSdWxlVGVtcG9yYWxPcGVyYXRvclR5cGUuQkVHSU5TLCBSdWxlVGVtcG9yYWxPcGVyYXRvclR5cGUuRU5EU10sXG4gICAgICAgICAgICBwcm9wZXJ0eU5hbWU6IGF0dHJpYnV0ZS5uYW1lLFxuICAgICAgICAgICAgdHlwZTogYXR0cmlidXRlLnR5cGVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBydWxlID0gbmV3IG5nZW9SdWxlRGF0ZSh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFJ1bGVUZW1wb3JhbE9wZXJhdG9yVHlwZS5EVVJJTkcsXG4gICAgICAgICAgICBwcm9wZXJ0eU5hbWU6IGF0dHJpYnV0ZS5uYW1lLFxuICAgICAgICAgICAgdHlwZTogYXR0cmlidXRlLnR5cGVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkdFT01FVFJZOlxuICAgICAgICBydWxlID0gbmV3IG5nZW9SdWxlR2VvbWV0cnkoe1xuICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgb3BlcmF0b3I6IFJ1bGVTcGF0aWFsT3BlcmF0b3JUeXBlLklOVEVSU0VDVFMsXG4gICAgICAgICAgb3BlcmF0b3JzOiBbUnVsZVNwYXRpYWxPcGVyYXRvclR5cGUuQ09OVEFJTlMsIFJ1bGVTcGF0aWFsT3BlcmF0b3JUeXBlLklOVEVSU0VDVFMsIFJ1bGVTcGF0aWFsT3BlcmF0b3JUeXBlLldJVEhJTl0sXG4gICAgICAgICAgcHJvcGVydHlOYW1lOiBhdHRyaWJ1dGUubmFtZSxcbiAgICAgICAgICB0eXBlOiBhdHRyaWJ1dGUudHlwZVxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2Ugbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuTlVNQkVSOlxuICAgICAgICBpZiAoaXNDdXN0b20pIHtcbiAgICAgICAgICBydWxlID0gbmV3IG5nZW9SdWxlUnVsZSh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFJ1bGVPcGVyYXRvclR5cGUuRVFVQUxfVE8sXG4gICAgICAgICAgICBvcGVyYXRvcnM6IFtSdWxlT3BlcmF0b3JUeXBlLkVRVUFMX1RPLCBSdWxlT3BlcmF0b3JUeXBlLkdSRUFURVJfVEhBTiwgUnVsZU9wZXJhdG9yVHlwZS5HUkVBVEVSX1RIQU5fT1JfRVFVQUxfVE8sIFJ1bGVPcGVyYXRvclR5cGUuTEVTU0VSX1RIQU4sIFJ1bGVPcGVyYXRvclR5cGUuTEVTU0VSX1RIQU5fT1JfRVFVQUxfVE8sIFJ1bGVPcGVyYXRvclR5cGUuTk9UX0VRVUFMX1RPXSxcbiAgICAgICAgICAgIHByb3BlcnR5TmFtZTogYXR0cmlidXRlLm5hbWUsXG4gICAgICAgICAgICB0eXBlOiBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5OVU1CRVJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBydWxlID0gbmV3IG5nZW9SdWxlUnVsZSh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFJ1bGVPcGVyYXRvclR5cGUuQkVUV0VFTixcbiAgICAgICAgICAgIHByb3BlcnR5TmFtZTogYXR0cmlidXRlLm5hbWUsXG4gICAgICAgICAgICB0eXBlOiBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5OVU1CRVJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLlNFTEVDVDpcbiAgICAgICAgcnVsZSA9IG5ldyBuZ2VvUnVsZVNlbGVjdCh7XG4gICAgICAgICAgY2hvaWNlczogYXR0cmlidXRlLmNob2ljZXMsXG4gICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICBwcm9wZXJ0eU5hbWU6IGF0dHJpYnV0ZS5uYW1lXG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGlzQ3VzdG9tKSB7XG4gICAgICAgICAgcnVsZSA9IG5ldyBuZ2VvUnVsZVRleHQoe1xuICAgICAgICAgICAgdGV4dDogJycsXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFJ1bGVPcGVyYXRvclR5cGUuTElLRSxcbiAgICAgICAgICAgIG9wZXJhdG9yczogW1J1bGVPcGVyYXRvclR5cGUuTElLRSwgUnVsZU9wZXJhdG9yVHlwZS5FUVVBTF9UTywgUnVsZU9wZXJhdG9yVHlwZS5OT1RfRVFVQUxfVE9dLFxuICAgICAgICAgICAgcHJvcGVydHlOYW1lOiBhdHRyaWJ1dGUubmFtZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJ1bGUgPSBuZXcgbmdlb1J1bGVUZXh0KHtcbiAgICAgICAgICAgIHRleHQ6ICcnLFxuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBSdWxlT3BlcmF0b3JUeXBlLkxJS0UsXG4gICAgICAgICAgICBwcm9wZXJ0eU5hbWU6IGF0dHJpYnV0ZS5uYW1lXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gcnVsZTtcbiAgfTtcblxuICBfcHJvdG8uY3JlYXRlUnVsZXMgPSBmdW5jdGlvbiBjcmVhdGVSdWxlcyhvcHRpb25zTGlzdCkge1xuICAgIHZhciBydWxlcyA9IFtdO1xuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IG9wdGlvbnNMaXN0LCBfaXNBcnJheTIgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjIpLCBfaTIgPSAwLCBfaXRlcmF0b3IyID0gX2lzQXJyYXkyID8gX2l0ZXJhdG9yMiA6IF9pdGVyYXRvcjJbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgIHZhciBfcmVmMjtcblxuICAgICAgaWYgKF9pc0FycmF5Mikge1xuICAgICAgICBpZiAoX2kyID49IF9pdGVyYXRvcjIubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZjIgPSBfaXRlcmF0b3IyW19pMisrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pMiA9IF9pdGVyYXRvcjIubmV4dCgpO1xuICAgICAgICBpZiAoX2kyLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmMiA9IF9pMi52YWx1ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIG9wdGlvbnMgPSBfcmVmMjtcbiAgICAgIHJ1bGVzLnB1c2godGhpcy5jcmVhdGVSdWxlKG9wdGlvbnMpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcnVsZXM7XG4gIH07XG5cbiAgX3Byb3RvLmNyZWF0ZVJ1bGUgPSBmdW5jdGlvbiBjcmVhdGVSdWxlKG9wdGlvbnMpIHtcbiAgICB2YXIgcnVsZTtcblxuICAgIHN3aXRjaCAob3B0aW9ucy50eXBlKSB7XG4gICAgICBjYXNlIG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkRBVEU6XG4gICAgICBjYXNlIG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkRBVEVUSU1FOlxuICAgICAgICBydWxlID0gbmV3IG5nZW9SdWxlRGF0ZShvcHRpb25zKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2Ugbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuR0VPTUVUUlk6XG4gICAgICAgIHJ1bGUgPSBuZXcgbmdlb1J1bGVHZW9tZXRyeShvcHRpb25zKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2Ugbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuU0VMRUNUOlxuICAgICAgICB2YXIgc2VsZWN0T3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIGNvbnNvbGUuYXNzZXJ0KHNlbGVjdE9wdGlvbnMuY2hvaWNlcyk7XG4gICAgICAgIHJ1bGUgPSBuZXcgbmdlb1J1bGVTZWxlY3Qoc2VsZWN0T3B0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBydWxlID0gbmV3IG5nZW9SdWxlVGV4dChvcHRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJ1bGU7XG4gIH07XG5cbiAgX3Byb3RvLmNsb25lUnVsZSA9IGZ1bmN0aW9uIGNsb25lUnVsZShydWxlKSB7XG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICBpc0N1c3RvbTogcnVsZS5pc0N1c3RvbSxcbiAgICAgIG5hbWU6IHJ1bGUubmFtZSxcbiAgICAgIHByb3BlcnR5TmFtZTogcnVsZS5wcm9wZXJ0eU5hbWUsXG4gICAgICB0eXBlOiBydWxlLnR5cGVcbiAgICB9O1xuICAgIHZhciBleHByZXNzaW9uID0gcnVsZS5nZXRFeHByZXNzaW9uKCk7XG5cbiAgICBpZiAoZXhwcmVzc2lvbiAhPT0gbnVsbCkge1xuICAgICAgb3B0aW9ucy5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgICB9XG5cbiAgICBpZiAocnVsZS5sb3dlckJvdW5kYXJ5ICE9PSBudWxsKSB7XG4gICAgICBvcHRpb25zLmxvd2VyQm91bmRhcnkgPSBydWxlLmxvd2VyQm91bmRhcnk7XG4gICAgfVxuXG4gICAgaWYgKHJ1bGUub3BlcmF0b3IpIHtcbiAgICAgIG9wdGlvbnMub3BlcmF0b3IgPSBydWxlLm9wZXJhdG9yO1xuICAgIH1cblxuICAgIGlmIChydWxlLm9wZXJhdG9ycykge1xuICAgICAgb3B0aW9ucy5vcGVyYXRvcnMgPSBydWxlLm9wZXJhdG9ycy5zbGljZSgwKTtcbiAgICB9XG5cbiAgICBpZiAocnVsZS51cHBlckJvdW5kYXJ5ICE9PSBudWxsKSB7XG4gICAgICBvcHRpb25zLnVwcGVyQm91bmRhcnkgPSBydWxlLnVwcGVyQm91bmRhcnk7XG4gICAgfVxuXG4gICAgdmFyIGNsb25lO1xuXG4gICAgaWYgKHJ1bGUgaW5zdGFuY2VvZiBuZ2VvUnVsZURhdGUpIHtcbiAgICAgIGNsb25lID0gbmV3IG5nZW9SdWxlRGF0ZShvcHRpb25zKTtcbiAgICB9IGVsc2UgaWYgKHJ1bGUgaW5zdGFuY2VvZiBuZ2VvUnVsZUdlb21ldHJ5KSB7XG4gICAgICBjbG9uZSA9IG5ldyBuZ2VvUnVsZUdlb21ldHJ5KG9wdGlvbnMpO1xuICAgICAgY2xvbmUuZmVhdHVyZS5zZXRQcm9wZXJ0aWVzKHRoaXMubmdlb0ZlYXR1cmVIZWxwZXJfLmdldE5vblNwYXRpYWxQcm9wZXJ0aWVzKHJ1bGUuZmVhdHVyZSkpO1xuICAgIH0gZWxzZSBpZiAocnVsZSBpbnN0YW5jZW9mIG5nZW9SdWxlU2VsZWN0KSB7XG4gICAgICB2YXIgb3B0ID0gb3B0aW9ucztcbiAgICAgIG9wdC5jaG9pY2VzID0gcnVsZS5jaG9pY2VzLnNsaWNlKDApO1xuICAgICAgY2xvbmUgPSBuZXcgbmdlb1J1bGVTZWxlY3Qob3B0KTtcbiAgICB9IGVsc2UgaWYgKHJ1bGUgaW5zdGFuY2VvZiBuZ2VvUnVsZVRleHQpIHtcbiAgICAgIHZhciBfb3B0ID0gb3B0aW9ucztcbiAgICAgIGNsb25lID0gbmV3IG5nZW9SdWxlVGV4dChfb3B0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2xvbmUgPSBuZXcgbmdlb1J1bGVSdWxlKG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHJldHVybiBjbG9uZTtcbiAgfTtcblxuICBfcHJvdG8uZXh0ZW5kUnVsZSA9IGZ1bmN0aW9uIGV4dGVuZFJ1bGUoc291cmNlUnVsZSwgZGVzdFJ1bGUpIHtcbiAgICBpZiAoZGVzdFJ1bGUuZ2V0RXhwcmVzc2lvbigpICE9PSBzb3VyY2VSdWxlLmdldEV4cHJlc3Npb24oKSkge1xuICAgICAgZGVzdFJ1bGUuc2V0RXhwcmVzc2lvbihzb3VyY2VSdWxlLmdldEV4cHJlc3Npb24oKSk7XG4gICAgfVxuXG4gICAgaWYgKGRlc3RSdWxlLmxvd2VyQm91bmRhcnkgIT09IHNvdXJjZVJ1bGUubG93ZXJCb3VuZGFyeSkge1xuICAgICAgZGVzdFJ1bGUubG93ZXJCb3VuZGFyeSA9IHNvdXJjZVJ1bGUubG93ZXJCb3VuZGFyeTtcbiAgICB9XG5cbiAgICBpZiAoZGVzdFJ1bGUub3BlcmF0b3IgIT09IHNvdXJjZVJ1bGUub3BlcmF0b3IpIHtcbiAgICAgIGRlc3RSdWxlLm9wZXJhdG9yID0gc291cmNlUnVsZS5vcGVyYXRvcjtcbiAgICB9XG5cbiAgICBpZiAoZGVzdFJ1bGUudXBwZXJCb3VuZGFyeSAhPT0gc291cmNlUnVsZS51cHBlckJvdW5kYXJ5KSB7XG4gICAgICBkZXN0UnVsZS51cHBlckJvdW5kYXJ5ID0gc291cmNlUnVsZS51cHBlckJvdW5kYXJ5O1xuICAgIH1cblxuICAgIGlmIChzb3VyY2VSdWxlIGluc3RhbmNlb2Ygbmdlb1J1bGVHZW9tZXRyeSAmJiBkZXN0UnVsZSBpbnN0YW5jZW9mIG5nZW9SdWxlR2VvbWV0cnkpIHtcbiAgICAgIHRoaXMubmdlb0ZlYXR1cmVIZWxwZXJfLmNsZWFyTm9uU3BhdGlhbFByb3BlcnRpZXMoZGVzdFJ1bGUuZmVhdHVyZSk7XG4gICAgICBkZXN0UnVsZS5mZWF0dXJlLnNldFByb3BlcnRpZXModGhpcy5uZ2VvRmVhdHVyZUhlbHBlcl8uZ2V0Tm9uU3BhdGlhbFByb3BlcnRpZXMoc291cmNlUnVsZS5mZWF0dXJlKSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5zZXJpYWxpemVSdWxlcyA9IGZ1bmN0aW9uIHNlcmlhbGl6ZVJ1bGVzKHJ1bGVzKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHJldHVybiBydWxlcy5tYXAoZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgIHZhciBzZXJpYWxpemVkUnVsZSA9IF90aGlzLnNlcmlhbGl6ZVJ1bGUocnVsZSk7XG5cbiAgICAgIHJldHVybiBzZXJpYWxpemVkUnVsZTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uc2VyaWFsaXplUnVsZSA9IGZ1bmN0aW9uIHNlcmlhbGl6ZVJ1bGUocnVsZSkge1xuICAgIHZhciBvYmogPSB7XG4gICAgICBuYW1lOiBydWxlLm5hbWUsXG4gICAgICBwcm9wZXJ0eU5hbWU6IHJ1bGUucHJvcGVydHlOYW1lLFxuICAgICAgdHlwZTogcnVsZS50eXBlXG4gICAgfTtcblxuICAgIGlmIChydWxlLmV4cHJlc3Npb24gIT09IG51bGwpIHtcbiAgICAgIG9iai5leHByZXNzaW9uID0gcnVsZS5leHByZXNzaW9uO1xuICAgIH1cblxuICAgIGlmIChydWxlLmxvd2VyQm91bmRhcnkgIT09IG51bGwpIHtcbiAgICAgIG9iai5sb3dlckJvdW5kYXJ5ID0gcnVsZS5sb3dlckJvdW5kYXJ5O1xuICAgIH1cblxuICAgIGlmIChydWxlLm9wZXJhdG9yICE9PSBudWxsKSB7XG4gICAgICBvYmoub3BlcmF0b3IgPSBydWxlLm9wZXJhdG9yO1xuICAgIH1cblxuICAgIGlmIChydWxlLm9wZXJhdG9ycyAhPT0gbnVsbCkge1xuICAgICAgb2JqLm9wZXJhdG9ycyA9IHJ1bGUub3BlcmF0b3JzLnNsaWNlKDApO1xuICAgIH1cblxuICAgIGlmIChydWxlLnVwcGVyQm91bmRhcnkgIT09IG51bGwpIHtcbiAgICAgIG9iai51cHBlckJvdW5kYXJ5ID0gcnVsZS51cHBlckJvdW5kYXJ5O1xuICAgIH1cblxuICAgIGlmIChydWxlIGluc3RhbmNlb2Ygbmdlb1J1bGVHZW9tZXRyeSkge1xuICAgICAgdmFyIG9wdCA9IG9iajtcbiAgICAgIG9wdC5mZWF0dXJlUHJvcGVydGllcyA9IHRoaXMubmdlb0ZlYXR1cmVIZWxwZXJfLmdldE5vblNwYXRpYWxQcm9wZXJ0aWVzKHJ1bGUuZmVhdHVyZSk7XG4gICAgfVxuXG4gICAgaWYgKHJ1bGUgaW5zdGFuY2VvZiBuZ2VvUnVsZVNlbGVjdCkge1xuICAgICAgdmFyIF9vcHQyID0gb2JqO1xuICAgICAgX29wdDIuY2hvaWNlcyA9IHJ1bGUuY2hvaWNlcztcbiAgICB9XG5cbiAgICByZXR1cm4gb2JqO1xuICB9O1xuXG4gIF9wcm90by5jcmVhdGVGaWx0ZXIgPSBmdW5jdGlvbiBjcmVhdGVGaWx0ZXIob3B0aW9ucykge1xuICAgIHZhciBkYXRhU291cmNlID0gb3B0aW9ucy5kYXRhU291cmNlO1xuICAgIHZhciBtYWluRmlsdGVyID0gbnVsbDtcblxuICAgIGlmIChvcHRpb25zLmZpbHRlcikge1xuICAgICAgbWFpbkZpbHRlciA9IG9wdGlvbnMuZmlsdGVyO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgcnVsZXMgPSBvcHRpb25zLmZpbHRlclJ1bGVzIHx8IGRhdGFTb3VyY2UuZmlsdGVyUnVsZXM7XG4gICAgICB2YXIgY29uZGl0aW9ucyA9IFtdO1xuXG4gICAgICBpZiAocnVsZXMgJiYgcnVsZXMubGVuZ3RoKSB7XG4gICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjMgPSBydWxlcywgX2lzQXJyYXkzID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IzKSwgX2kzID0gMCwgX2l0ZXJhdG9yMyA9IF9pc0FycmF5MyA/IF9pdGVyYXRvcjMgOiBfaXRlcmF0b3IzW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgICAgdmFyIF9yZWYzO1xuXG4gICAgICAgICAgaWYgKF9pc0FycmF5Mykge1xuICAgICAgICAgICAgaWYgKF9pMyA+PSBfaXRlcmF0b3IzLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmMyA9IF9pdGVyYXRvcjNbX2kzKytdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfaTMgPSBfaXRlcmF0b3IzLm5leHQoKTtcbiAgICAgICAgICAgIGlmIChfaTMuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmMyA9IF9pMy52YWx1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgcnVsZSA9IF9yZWYzO1xuICAgICAgICAgIHZhciBmaWx0ZXIgPSB0aGlzLmNyZWF0ZUZpbHRlckZyb21SdWxlXyhydWxlLCBkYXRhU291cmNlLCBvcHRpb25zLnNyc05hbWUpO1xuXG4gICAgICAgICAgaWYgKGZpbHRlcikge1xuICAgICAgICAgICAgY29uZGl0aW9ucy5wdXNoKGZpbHRlcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBjb25kaXRpb24gPSBkYXRhU291cmNlLmZpbHRlckNvbmRpdGlvbjtcblxuICAgICAgaWYgKGNvbmRpdGlvbnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIG1haW5GaWx0ZXIgPSBjb25kaXRpb25zWzBdO1xuICAgICAgfSBlbHNlIGlmIChjb25kaXRpb25zLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgIGlmIChjb25kaXRpb24gPT09IG5nZW9GaWx0ZXJDb25kaXRpb24uQU5EKSB7XG4gICAgICAgICAgbWFpbkZpbHRlciA9IG9sRm9ybWF0RmlsdGVyLmFuZC5hcHBseShudWxsLCBjb25kaXRpb25zKTtcbiAgICAgICAgfSBlbHNlIGlmIChjb25kaXRpb24gPT09IG5nZW9GaWx0ZXJDb25kaXRpb24uT1IgfHwgY29uZGl0aW9uID09PSBuZ2VvRmlsdGVyQ29uZGl0aW9uLk5PVCkge1xuICAgICAgICAgIG1haW5GaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5vci5hcHBseShudWxsLCBjb25kaXRpb25zKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAobWFpbkZpbHRlciAmJiBjb25kaXRpb24gPT09IG5nZW9GaWx0ZXJDb25kaXRpb24uTk9UKSB7XG4gICAgICAgIG1haW5GaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5ub3QobWFpbkZpbHRlcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMuaW5jVGltZSkge1xuICAgICAgdmFyIHRpbWVGaWx0ZXIgPSB0aGlzLmNyZWF0ZVRpbWVGaWx0ZXJGcm9tRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSk7XG4gICAgICBtYWluRmlsdGVyID0gdGhpcy5qb2luRmlsdGVycyhtYWluRmlsdGVyLCB0aW1lRmlsdGVyKTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucy5pbmNEaW1lbnNpb25zKSB7XG4gICAgICB2YXIgZGltZW5zaW9uc0ZpbHRlciA9IHRoaXMuY3JlYXRlRGltZW5zaW9uc0ZpbHRlckZyb21EYXRhU291cmNlXyhkYXRhU291cmNlKTtcbiAgICAgIG1haW5GaWx0ZXIgPSB0aGlzLmpvaW5GaWx0ZXJzKG1haW5GaWx0ZXIsIGRpbWVuc2lvbnNGaWx0ZXIpO1xuICAgIH1cblxuICAgIHJldHVybiBtYWluRmlsdGVyO1xuICB9O1xuXG4gIF9wcm90by5jcmVhdGVGaWx0ZXJTdHJpbmcgPSBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJTdHJpbmcob3B0aW9ucykge1xuICAgIHZhciBmaWx0ZXJTdHJpbmcgPSBudWxsO1xuICAgIHZhciBmaWx0ZXIgPSB0aGlzLmNyZWF0ZUZpbHRlcihvcHRpb25zKTtcblxuICAgIGlmIChmaWx0ZXIpIHtcbiAgICAgIHZhciBmaWx0ZXJOb2RlID0gd3JpdGVGaWx0ZXIoZmlsdGVyKTtcbiAgICAgIHZhciB4bWxTZXJpYWxpemVyID0gbmV3IFhNTFNlcmlhbGl6ZXIoKTtcbiAgICAgIGZpbHRlclN0cmluZyA9IHhtbFNlcmlhbGl6ZXIuc2VyaWFsaXplVG9TdHJpbmcoZmlsdGVyTm9kZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbHRlclN0cmluZztcbiAgfTtcblxuICBfcHJvdG8uam9pbkZpbHRlcnMgPSBmdW5jdGlvbiBqb2luRmlsdGVycyhmaWx0ZXJBLCBmaWx0ZXJCKSB7XG4gICAgdmFyIGZpbHRlciA9IG51bGw7XG5cbiAgICBpZiAoZmlsdGVyQSAmJiBmaWx0ZXJCKSB7XG4gICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5hbmQuYXBwbHkobnVsbCwgW2ZpbHRlckEsIGZpbHRlckJdKTtcbiAgICB9IGVsc2UgaWYgKGZpbHRlckEpIHtcbiAgICAgIGZpbHRlciA9IGZpbHRlckE7XG4gICAgfSBlbHNlIGlmIChmaWx0ZXJCKSB7XG4gICAgICBmaWx0ZXIgPSBmaWx0ZXJCO1xuICAgIH1cblxuICAgIHJldHVybiBmaWx0ZXI7XG4gIH07XG5cbiAgX3Byb3RvLmNyZWF0ZUZpbHRlckZyb21SdWxlXyA9IGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZyb21SdWxlXyhydWxlLCBkYXRhU291cmNlLCBvcHRfc3JzTmFtZSkge1xuICAgIHZhciBmaWx0ZXIgPSBudWxsO1xuICAgIHZhciB2YWx1ZSA9IHJ1bGUudmFsdWU7XG5cbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgZXhwcmVzc2lvbiA9IHZhbHVlLmV4cHJlc3Npb247XG4gICAgdmFyIGxvd2VyQm91bmRhcnkgPSB2YWx1ZS5sb3dlckJvdW5kYXJ5O1xuICAgIHZhciBvcGVyYXRvciA9IHZhbHVlLm9wZXJhdG9yO1xuICAgIHZhciBwcm9wZXJ0eU5hbWUgPSB2YWx1ZS5wcm9wZXJ0eU5hbWU7XG4gICAgdmFyIHVwcGVyQm91bmRhcnkgPSB2YWx1ZS51cHBlckJvdW5kYXJ5O1xuICAgIHZhciByb3QgPSBSdWxlT3BlcmF0b3JUeXBlO1xuICAgIHZhciByc290ID0gUnVsZVNwYXRpYWxPcGVyYXRvclR5cGU7XG4gICAgdmFyIHJ0b3QgPSBSdWxlVGVtcG9yYWxPcGVyYXRvclR5cGU7XG4gICAgdmFyIHNwYXRpYWxUeXBlcyA9IFtyc290LkNPTlRBSU5TLCByc290LklOVEVSU0VDVFMsIHJzb3QuV0lUSElOXTtcbiAgICB2YXIgbnVtZXJpY1R5cGVzID0gW3JvdC5HUkVBVEVSX1RIQU4sIHJvdC5HUkVBVEVSX1RIQU5fT1JfRVFVQUxfVE8sIHJvdC5MRVNTRVJfVEhBTiwgcm90LkxFU1NFUl9USEFOX09SX0VRVUFMX1RPXTtcblxuICAgIGlmIChydWxlIGluc3RhbmNlb2Ygbmdlb1J1bGVEYXRlKSB7XG4gICAgICB2YXIgYmVnaW5WYWx1ZTtcbiAgICAgIHZhciBlbmRWYWx1ZTtcblxuICAgICAgaWYgKG9wZXJhdG9yID09PSBydG90LkRVUklORykge1xuICAgICAgICBiZWdpblZhbHVlID0gbW9tZW50KGxvd2VyQm91bmRhcnkpLmZvcm1hdCgnWVlZWS1NTS1ERCcpO1xuICAgICAgICBlbmRWYWx1ZSA9IG1vbWVudCh1cHBlckJvdW5kYXJ5KS5mb3JtYXQoJ1lZWVktTU0tREQnKTtcbiAgICAgIH0gZWxzZSBpZiAob3BlcmF0b3IgPT09IHJ0b3QuRVFVQUxTKSB7XG4gICAgICAgIGJlZ2luVmFsdWUgPSBtb21lbnQoZXhwcmVzc2lvbikuZm9ybWF0KCdZWVlZLU1NLUREJyk7XG4gICAgICAgIGVuZFZhbHVlID0gYmVnaW5WYWx1ZTtcbiAgICAgIH0gZWxzZSBpZiAob3BlcmF0b3IgPT09IHJ0b3QuQkVHSU5TKSB7XG4gICAgICAgIGJlZ2luVmFsdWUgPSBtb21lbnQoZXhwcmVzc2lvbikuZm9ybWF0KCdZWVlZLU1NLUREJyk7XG4gICAgICAgIGVuZFZhbHVlID0gbW9tZW50KGV4cHJlc3Npb24pLmFkZCgzMCwgJ3llYXJzJykuZm9ybWF0KCdZWVlZLU1NLUREJyk7XG4gICAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSBydG90LkVORFMpIHtcbiAgICAgICAgYmVnaW5WYWx1ZSA9ICcxOTcwLTAxLTAxJztcbiAgICAgICAgZW5kVmFsdWUgPSBtb21lbnQoZXhwcmVzc2lvbikuZm9ybWF0KCdZWVlZLU1NLUREJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChiZWdpblZhbHVlICYmIGVuZFZhbHVlKSB7XG4gICAgICAgIGZpbHRlciA9IG9sRm9ybWF0RmlsdGVyLmR1cmluZyhwcm9wZXJ0eU5hbWUsIGJlZ2luVmFsdWUsIGVuZFZhbHVlKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHJ1bGUgaW5zdGFuY2VvZiBuZ2VvUnVsZVNlbGVjdCkge1xuICAgICAgdmFyIHNlbGVjdGVkQ2hvaWNlcyA9IHJ1bGUuc2VsZWN0ZWRDaG9pY2VzO1xuXG4gICAgICBpZiAoc2VsZWN0ZWRDaG9pY2VzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5lcXVhbFRvKHByb3BlcnR5TmFtZSwgc2VsZWN0ZWRDaG9pY2VzWzBdKTtcbiAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRDaG9pY2VzLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgIHZhciBjb25kaXRpb25zID0gW107XG5cbiAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IHNlbGVjdGVkQ2hvaWNlcywgX2lzQXJyYXk0ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I0KSwgX2k0ID0gMCwgX2l0ZXJhdG9yNCA9IF9pc0FycmF5NCA/IF9pdGVyYXRvcjQgOiBfaXRlcmF0b3I0W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgICAgdmFyIF9yZWY0O1xuXG4gICAgICAgICAgaWYgKF9pc0FycmF5NCkge1xuICAgICAgICAgICAgaWYgKF9pNCA+PSBfaXRlcmF0b3I0Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmNCA9IF9pdGVyYXRvcjRbX2k0KytdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfaTQgPSBfaXRlcmF0b3I0Lm5leHQoKTtcbiAgICAgICAgICAgIGlmIChfaTQuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmNCA9IF9pNC52YWx1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgc2VsZWN0ZWRDaG9pY2UgPSBfcmVmNDtcbiAgICAgICAgICBjb25kaXRpb25zLnB1c2gob2xGb3JtYXRGaWx0ZXIuZXF1YWxUbyhwcm9wZXJ0eU5hbWUsIHNlbGVjdGVkQ2hvaWNlKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5vci5hcHBseShudWxsLCBjb25kaXRpb25zKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHNwYXRpYWxUeXBlcy5pbmNsdWRlcyhvcGVyYXRvcikpIHtcbiAgICAgIHZhciBmZWF0dXJlTmFtZXMgPSBkYXRhU291cmNlLmdldEZpbHRyYWJsZVdGU0xheWVyTmFtZSgpO1xuICAgICAgdmFyIGdlb21ldHJ5TmFtZSA9IGRhdGFTb3VyY2UuZ2VvbWV0cnlOYW1lKGZlYXR1cmVOYW1lcyA/IGZlYXR1cmVOYW1lc1swXSA6IG51bGwpO1xuXG4gICAgICBpZiAocnVsZSBpbnN0YW5jZW9mIG5nZW9SdWxlR2VvbWV0cnkpIHtcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gcnVsZS5nZW9tZXRyeTtcblxuICAgICAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdlb21ldHJ5Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2VvbWV0cnlOYW1lID09PSBudWxsKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdlb21ldHJ5TmFtZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wZXJhdG9yID09PSByc290LkNPTlRBSU5TKSB7XG4gICAgICAgICAgZmlsdGVyID0gb2xGb3JtYXRGaWx0ZXIuY29udGFpbnMoZ2VvbWV0cnlOYW1lLCBnZW9tZXRyeSwgb3B0X3Nyc05hbWUpO1xuICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSByc290LklOVEVSU0VDVFMpIHtcbiAgICAgICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5pbnRlcnNlY3RzKGdlb21ldHJ5TmFtZSwgZ2VvbWV0cnksIG9wdF9zcnNOYW1lKTtcbiAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRvciA9PT0gcnNvdC5XSVRISU4pIHtcbiAgICAgICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci53aXRoaW4oZ2VvbWV0cnlOYW1lLCBnZW9tZXRyeSwgb3B0X3Nyc05hbWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChudW1lcmljVHlwZXMuaW5jbHVkZXMob3BlcmF0b3IpKSB7XG4gICAgICBpZiAodHlwZW9mIGV4cHJlc3Npb24gIT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZXhwcmVzc2lvbiB0eXBlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcGVyYXRvciA9PT0gcm90LkdSRUFURVJfVEhBTikge1xuICAgICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5ncmVhdGVyVGhhbihwcm9wZXJ0eU5hbWUsIGV4cHJlc3Npb24pO1xuICAgICAgfSBlbHNlIGlmIChvcGVyYXRvciA9PT0gcm90LkdSRUFURVJfVEhBTl9PUl9FUVVBTF9UTykge1xuICAgICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5ncmVhdGVyVGhhbk9yRXF1YWxUbyhwcm9wZXJ0eU5hbWUsIGV4cHJlc3Npb24pO1xuICAgICAgfSBlbHNlIGlmIChvcGVyYXRvciA9PT0gcm90LkxFU1NFUl9USEFOKSB7XG4gICAgICAgIGZpbHRlciA9IG9sRm9ybWF0RmlsdGVyLmxlc3NUaGFuKHByb3BlcnR5TmFtZSwgZXhwcmVzc2lvbik7XG4gICAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSByb3QuTEVTU0VSX1RIQU5fT1JfRVFVQUxfVE8pIHtcbiAgICAgICAgZmlsdGVyID0gb2xGb3JtYXRGaWx0ZXIubGVzc1RoYW5PckVxdWFsVG8ocHJvcGVydHlOYW1lLCBleHByZXNzaW9uKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSByb3QuQkVUV0VFTikge1xuICAgICAgZmlsdGVyID0gb2xGb3JtYXRGaWx0ZXIuYmV0d2Vlbihwcm9wZXJ0eU5hbWUsIGxvd2VyQm91bmRhcnksIHVwcGVyQm91bmRhcnkpO1xuICAgIH0gZWxzZSBpZiAob3BlcmF0b3IgPT09IHJvdC5FUVVBTF9UTykge1xuICAgICAgZmlsdGVyID0gb2xGb3JtYXRGaWx0ZXIuZXF1YWxUbyhwcm9wZXJ0eU5hbWUsIGV4cHJlc3Npb24pO1xuICAgIH0gZWxzZSBpZiAob3BlcmF0b3IgPT09IHJvdC5MSUtFKSB7XG4gICAgICB2YXIgc3RyaW5nRXhwcmVzc2lvbiA9IFN0cmluZyhleHByZXNzaW9uKS5yZXBsYWNlKC8hL2csICchIScpLnJlcGxhY2UoL1xcLi9nLCAnIS4nKS5yZXBsYWNlKC9cXCovZywgJyEqJyk7XG4gICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5saWtlKHByb3BlcnR5TmFtZSwgXCIqXCIgKyBzdHJpbmdFeHByZXNzaW9uICsgXCIqXCIsICcqJywgJy4nLCAnIScsIGZhbHNlKTtcbiAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSByb3QuTk9UX0VRVUFMX1RPKSB7XG4gICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5ub3RFcXVhbFRvKHByb3BlcnR5TmFtZSwgZXhwcmVzc2lvbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbHRlcjtcbiAgfTtcblxuICBfcHJvdG8uY3JlYXRlRGltZW5zaW9uc0ZpbHRlckZyb21EYXRhU291cmNlXyA9IGZ1bmN0aW9uIGNyZWF0ZURpbWVuc2lvbnNGaWx0ZXJGcm9tRGF0YVNvdXJjZV8oZGF0YVNvdXJjZSkge1xuICAgIHZhciBjb25maWcgPSBkYXRhU291cmNlLmRpbWVuc2lvbnNGaWx0ZXJzQ29uZmlnIHx8IHt9O1xuICAgIHZhciBkaW1lbnNpb25zID0gZGF0YVNvdXJjZS5kaW1lbnNpb25zO1xuXG4gICAgaWYgKCFkaW1lbnNpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGltZW5zaW9ucycpO1xuICAgIH1cblxuICAgIHZhciBjb25kaXRpb25zID0gW107XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gY29uZmlnKSB7XG4gICAgICB2YXIgdmFsdWUgPSBjb25maWdba2V5XS52YWx1ZTtcblxuICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIHZhciBkaW1lbnNpb25WYWx1ZSA9IGRpbWVuc2lvbnNba2V5XTtcblxuICAgICAgICBpZiAoZGltZW5zaW9uVmFsdWUgIT09IHVuZGVmaW5lZCAmJiBkaW1lbnNpb25WYWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgIHZhbHVlID0gZGltZW5zaW9uVmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgIGNvbmRpdGlvbnMucHVzaChvbEZvcm1hdEZpbHRlci5lcXVhbFRvKGNvbmZpZ1trZXldLmZpZWxkLCB2YWx1ZSwgdHJ1ZSkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb25kaXRpb25zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgcmV0dXJuIGNvbmRpdGlvbnNbMF07XG4gICAgfSBlbHNlIGlmIChjb25kaXRpb25zLmxlbmd0aCA+PSAyKSB7XG4gICAgICByZXR1cm4gb2xGb3JtYXRGaWx0ZXIuYW5kLmFwcGx5KG51bGwsIGNvbmRpdGlvbnMpO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIF9wcm90by5jcmVhdGVUaW1lRmlsdGVyRnJvbURhdGFTb3VyY2VfID0gZnVuY3Rpb24gY3JlYXRlVGltZUZpbHRlckZyb21EYXRhU291cmNlXyhkYXRhU291cmNlKSB7XG4gICAgdmFyIGZpbHRlciA9IG51bGw7XG4gICAgdmFyIHJhbmdlID0gZGF0YVNvdXJjZS50aW1lUmFuZ2VWYWx1ZTtcbiAgICB2YXIgdGltZVByb3BlcnR5ID0gZGF0YVNvdXJjZS50aW1lUHJvcGVydHk7XG4gICAgdmFyIG5hbWUgPSBkYXRhU291cmNlLnRpbWVBdHRyaWJ1dGVOYW1lO1xuXG4gICAgaWYgKHJhbmdlICYmIHRpbWVQcm9wZXJ0eSAmJiBuYW1lKSB7XG4gICAgICBpZiAocmFuZ2UuZW5kICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIHZhbHVlcyA9IHRoaXMubmdlb1dNU1RpbWVfLmZvcm1hdFdNU1RpbWVQYXJhbSh0aW1lUHJvcGVydHksIHJhbmdlKS5zcGxpdCgnLycpO1xuICAgICAgICBmaWx0ZXIgPSBvbEZvcm1hdEZpbHRlci5kdXJpbmcobmFtZSwgdmFsdWVzWzBdLCB2YWx1ZXNbMV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHJlc29sdXRpb24gPSB0aW1lUHJvcGVydHkucmVzb2x1dGlvbiB8fCAnc2Vjb25kcyc7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMubmdlb1dNU1RpbWVfLmZvcm1hdFdNU1RpbWVQYXJhbSh0aW1lUHJvcGVydHksIHJhbmdlKTtcbiAgICAgICAgdmFyIG1vbWVudEVuZDtcblxuICAgICAgICBzd2l0Y2ggKHJlc29sdXRpb24pIHtcbiAgICAgICAgICBjYXNlICd5ZWFyJzpcbiAgICAgICAgICAgIG1vbWVudEVuZCA9IG1vbWVudCh2YWx1ZSkuYWRkKDEsICd5ZWFycycpLnN1YnRyYWN0KDEsICdzZWNvbmRzJyk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICAgIG1vbWVudEVuZCA9IG1vbWVudCh2YWx1ZSkuYWRkKDEsICdtb250aHMnKS5zdWJ0cmFjdCgxLCAnc2Vjb25kcycpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdkYXknOlxuICAgICAgICAgICAgbW9tZW50RW5kID0gbW9tZW50KHZhbHVlKS5hZGQoMSwgJ2RheXMnKS5zdWJ0cmFjdCgxLCAnc2Vjb25kcycpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1vbWVudEVuZCkge1xuICAgICAgICAgIHZhciBzdGFydFZhbHVlID0gbW9tZW50KHZhbHVlKS51dGMoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKTtcbiAgICAgICAgICB2YXIgZW5kVmFsdWUgPSBtb21lbnRFbmQudXRjKCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyk7XG4gICAgICAgICAgZmlsdGVyID0gb2xGb3JtYXRGaWx0ZXIuZHVyaW5nKG5hbWUsIHN0YXJ0VmFsdWUsIGVuZFZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmaWx0ZXI7XG4gIH07XG5cbiAgcmV0dXJuIFJ1bGVIZWxwZXI7XG59KCk7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9SdWxlSGVscGVyJywgW25nZW9NaXNjRmVhdHVyZUhlbHBlci5uYW1lLCBuZ2VvTWlzY1dNU1RpbWUubmFtZV0pO1xubW9kdWxlLnNlcnZpY2UoJ25nZW9SdWxlSGVscGVyJywgUnVsZUhlbHBlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdiBjbGFzcz1cImRyb3Bkb3duXCI+XFxuICA8YnV0dG9uXFxuICAgICAgY2xhc3M9XCJidG4gYnRuLWxpbmsgZHJvcGRvd24tdG9nZ2xlIG5nZW8tZmlsdGVyLWNvbmRpdGlvbi1idXR0b25cIlxcbiAgICAgIG5nLWNsYXNzPVwie2Rpc2FibGVkOiAkY3RybC5hUnVsZUlzQWN0aXZlfVwiXFxuICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiXFxuICAgICAgbmctZGlzYWJsZWQ9XCIkY3RybC5hUnVsZUlzQWN0aXZlXCI+XFxuICAgIDxzcGFuIGNsYXNzPVwiZmEgZmEtY29nXCI+PC9zcGFuPlxcbiAgPC9idXR0b24+XFxuICA8dWwgY2xhc3M9XCJkcm9wZG93bi1tZW51XCI+XFxuICAgIDxsaSBuZy1yZXBlYXQ9XCJjb25kaXRpb24gaW4gOjokY3RybC5jb25kaXRpb25zXCI+XFxuICAgICAgPGFcXG4gICAgICAgICAgaHJlZlxcbiAgICAgICAgICBuZy1jbGljaz1cIiRjdHJsLnNldENvbmRpdGlvbihjb25kaXRpb24pXCI+XFxuICAgICAgICAgIDxzcGFuXFxuICAgICAgICAgICAgICBuZy1jbGFzcz1cIntcXCduZ2VvLWZpbHRlci1jb25kaXRpb24tY3JpdGVyaWEtYWN0aXZlXFwnOiBjb25kaXRpb24udmFsdWUgPT0gJGN0cmwuZGF0YXNvdXJjZS5maWx0ZXJDb25kaXRpb259XCJcXG4gICAgICAgICAgICAgIGNsYXNzPVwiZmEgZmEtY2hlY2sgbmdlby1maWx0ZXItY29uZGl0aW9uLWNyaXRlcmlhXCI+XFxuICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgPHNwYW4+e3s6OmNvbmRpdGlvbi50ZXh0IHwgdHJhbnNsYXRlfX08L3NwYW4+XFxuICAgICAgPC9hPlxcbiAgICA8L2xpPlxcbiAgPC91bD5cXG48L2Rpdj5cXG5cXG48bmdlby1ydWxlXFxuICAgIG5nLXJlcGVhdD1cInJ1bGUgaW4gJGN0cmwuZGlyZWN0ZWRSdWxlc1wiXFxuICAgIGZlYXR1cmUtb3ZlcmxheT1cIjo6JGN0cmwuZmVhdHVyZU92ZXJsYXlcIlxcbiAgICBjbGFzcz1cIm5nZW8tZmlsdGVyLXJ1bGUtZGlyZWN0ZWRcIlxcbiAgICBtYXA9XCIkY3RybC5tYXBcIlxcbiAgICBydWxlPVwicnVsZVwiXFxuICAgIHRvb2wtZ3JvdXA9XCIkY3RybC50b29sR3JvdXBcIj5cXG48L25nZW8tcnVsZT5cXG5cXG48aHIgY2xhc3M9XCJuZ2VvLWZpbHRlci1zZXBhcmF0b3ItcnVsZXNcIiAvPlxcblxcbjxkaXYgbmctcmVwZWF0PVwicnVsZSBpbiAkY3RybC5jdXN0b21SdWxlc1wiPlxcbiAgPGFcXG4gICAgICBjbGFzcz1cImJ0biBidG4tc20gYnRuLWxpbmsgbmdlby1maWx0ZXItcnVsZS1jdXN0b20tcm0tYnRuXCJcXG4gICAgICBuZy1jbGljaz1cIiEkY3RybC5hUnVsZUlzQWN0aXZlICYmICRjdHJsLnJlbW92ZUN1c3RvbVJ1bGUocnVsZSlcIlxcbiAgICAgIG5nLWRpc2FibGVkPVwiJGN0cmwuYVJ1bGVJc0FjdGl2ZVwiXFxuICAgICAgaHJlZj5cXG4gICAgPHNwYW4gY2xhc3M9XCJmYSBmYS10aW1lc1wiPjwvc3Bhbj5cXG4gIDwvYT5cXG4gIDxuZ2VvLXJ1bGVcXG4gICAgICBmZWF0dXJlLW92ZXJsYXk9XCI6OiRjdHJsLmZlYXR1cmVPdmVybGF5XCJcXG4gICAgICBjbGFzcz1cIm5nZW8tZmlsdGVyLXJ1bGUtY3VzdG9tXCJcXG4gICAgICBtYXA9XCIkY3RybC5tYXBcIlxcbiAgICAgIHJ1bGU9XCJydWxlXCJcXG4gICAgICB0b29sLWdyb3VwPVwiJGN0cmwudG9vbEdyb3VwXCI+XFxuICA8L25nZW8tcnVsZT5cXG48L2Rpdj5cXG5cXG48ZGl2IGNsYXNzPVwiZHJvcGRvd25cIj5cXG4gIDxidXR0b25cXG4gICAgICBjbGFzcz1cImJ0biBidG4tbGluayBkcm9wZG93bi10b2dnbGVcIlxcbiAgICAgIG5nLWNsYXNzPVwie2Rpc2FibGVkOiAkY3RybC5hUnVsZUlzQWN0aXZlfVwiXFxuICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiXFxuICAgICAgbmctZGlzYWJsZWQ9XCIkY3RybC5hUnVsZUlzQWN0aXZlXCI+XFxuICAgIDxzcGFuIHRyYW5zbGF0ZT4rIEFkZCBhIG5ldyBjcml0ZXJpYTwvc3Bhbj5cXG4gIDwvYnV0dG9uPlxcbiAgPHVsIGNsYXNzPVwiZHJvcGRvd24tbWVudVwiPlxcbiAgICA8bGkgbmctcmVwZWF0PVwiYXR0cmlidXRlIGluIDo6JGN0cmwuZ2VvbWV0cnlBdHRyaWJ1dGVzXCI+XFxuICAgICAgPGFcXG4gICAgICAgICAgaHJlZlxcbiAgICAgICAgICBuZy1jbGljaz1cIiRjdHJsLmNyZWF0ZUFuZEFkZEN1c3RvbVJ1bGUoYXR0cmlidXRlKVwiPlxcbiAgICAgICAgICA8c3BhbiB0cmFuc2xhdGU+U3BhdGlhbCBmaWx0ZXI8L3NwYW4+XFxuICAgICAgPC9hPlxcbiAgICA8L2xpPlxcbiAgICA8bGkgcm9sZT1cInByZXNlbnRhdGlvblwiIGNsYXNzPVwiZGl2aWRlclwiPjwvbGk+XFxuICAgIDxsaSBuZy1yZXBlYXQ9XCJhdHRyaWJ1dGUgaW4gOjokY3RybC5vdGhlckF0dHJpYnV0ZXNcIj5cXG4gICAgICA8YVxcbiAgICAgICAgICBocmVmXFxuICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuY3JlYXRlQW5kQWRkQ3VzdG9tUnVsZShhdHRyaWJ1dGUpXCI+XFxuICAgICAgICAgIDxzcGFuPnt7OjphdHRyaWJ1dGUubmFtZSB8IHRyYW5zbGF0ZX19PC9zcGFuPlxcbiAgICAgIDwvYT5cXG4gICAgPC9saT5cXG4gIDwvdWw+XFxuPC9kaXY+XFxuXFxuPGhyIGNsYXNzPVwibmdlby1maWx0ZXItc2VwYXJhdG9yLWNyaXRlcmlhXCIgLz5cXG5cXG48YnV0dG9uXFxuICAgIGNsYXNzPVwiYnRuIGJ0bi1saW5rXCJcXG4gICAgdHlwZT1cImJ1dHRvblwiXFxuICAgIG5nLWNsaWNrPVwiJGN0cmwuYXBwbHkoKVwiXFxuICAgIG5nLWRpc2FibGVkPVwiJGN0cmwuZGF0YXNvdXJjZS52aXNpYmxlID09PSBmYWxzZVwiPlxcbiAgPHNwYW4gY2xhc3M9XCJmYSBmYS1jaGVja1wiPjwvc3Bhbj5cXG4gIDxzcGFuIHRyYW5zbGF0ZT5BcHBseSBmaWx0ZXI8L3NwYW4+XFxuPC9idXR0b24+XFxuXFxuPGJ1dHRvblxcbiAgICBjbGFzcz1cImJ0biBidG4tbGlua1wiXFxuICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICBuZy1jbGljaz1cIiRjdHJsLmdldERhdGEoKVwiXFxuICAgIG5nLWRpc2FibGVkPVwiJGN0cmwuZGF0YXNvdXJjZS52aXNpYmxlID09PSBmYWxzZVwiPlxcbiAgPHNwYW4gY2xhc3M9XCJmYSBmYS1jaGV2cm9uLXJpZ2h0XCI+PC9zcGFuPlxcbiAgPHNwYW4gdHJhbnNsYXRlPkdldCBkYXRhPC9zcGFuPlxcbjwvYnV0dG9uPlxcbic7XG5cbn1cbnJldHVybiBfX3Bcbn0iLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvUXVlcnlNYXBRdWVyZW50IGZyb20gJ25nZW8vcXVlcnkvTWFwUXVlcmVudC5qcyc7XG5pbXBvcnQgbmdlb0ZpbHRlckNvbmRpdGlvbiBmcm9tICduZ2VvL2ZpbHRlci9Db25kaXRpb24uanMnO1xuaW1wb3J0IG5nZW9GaWx0ZXJSdWxlQ29tcG9uZW50IGZyb20gJ25nZW8vZmlsdGVyL3J1bGVDb21wb25lbnQuanMnO1xuaW1wb3J0IG5nZW9GaWx0ZXJSdWxlSGVscGVyIGZyb20gJ25nZW8vZmlsdGVyL1J1bGVIZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlIGZyb20gJ25nZW8vZm9ybWF0L0F0dHJpYnV0ZVR5cGUuanMnO1xuaW1wb3J0IG5nZW9SdWxlR2VvbWV0cnkgZnJvbSAnbmdlby9ydWxlL0dlb21ldHJ5LmpzJztcbmltcG9ydCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXkgZnJvbSAnbmdlby9tYXAvRmVhdHVyZU92ZXJsYXkuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0IHsgcmVtb3ZlIGFzIHJlbW92ZUZyb21BcnJheSB9IGZyb20gJ29sL2FycmF5LmpzJztcbmltcG9ydCAnbmdlby9zYXNzL2ZvbnQuc2Nzcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9GaWx0ZXInLCBbbmdlb0ZpbHRlclJ1bGVIZWxwZXIubmFtZSwgbmdlb0ZpbHRlclJ1bGVDb21wb25lbnQubmFtZSwgbmdlb01hcEZlYXR1cmVPdmVybGF5Lm5hbWUsIG5nZW9RdWVyeU1hcFF1ZXJlbnQubmFtZV0pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCduZ2VvL2ZpbHRlcicsIHJlcXVpcmUoJy4vY29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5tb2R1bGUudmFsdWUoJ25nZW9GaWx0ZXJUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uICgkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzLm5nZW9GaWx0ZXJUZW1wbGF0ZVVybDtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICduZ2VvL2ZpbHRlcic7XG59KTtcbm5nZW9GaWx0ZXJUZW1wbGF0ZVVybC4kaW5qZWN0ID0gW1wiJGF0dHJzXCIsIFwibmdlb0ZpbHRlclRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBuZ2VvRmlsdGVyVGVtcGxhdGVVcmwoJGF0dHJzLCBuZ2VvRmlsdGVyVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIG5nZW9GaWx0ZXJUZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG5tb2R1bGUuY29tcG9uZW50KCduZ2VvRmlsdGVyJywge1xuICBiaW5kaW5nczoge1xuICAgICdhUnVsZUlzQWN0aXZlJzogJz0nLFxuICAgICdjdXN0b21SdWxlcyc6ICc8JyxcbiAgICAnZGF0YXNvdXJjZSc6ICc8JyxcbiAgICAnZGlyZWN0ZWRSdWxlcyc6ICc8JyxcbiAgICAnZmVhdHVyZU92ZXJsYXknOiAnPCcsXG4gICAgJ2ZpbHRlcklzQXBwbGllZCc6ICc9JyxcbiAgICAnbWFwJzogJzwnLFxuICAgICd0b29sR3JvdXAnOiAnPCdcbiAgfSxcbiAgY29udHJvbGxlcjogJ25nZW9GaWx0ZXJDb250cm9sbGVyJyxcbiAgdGVtcGxhdGVVcmw6IG5nZW9GaWx0ZXJUZW1wbGF0ZVVybFxufSk7XG5cbnZhciBGaWx0ZXJDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICBGaWx0ZXJDb250cm9sbGVyLiRpbmplY3QgPSBbXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIiRzY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwibmdlb01hcFF1ZXJlbnRcIiwgXCJuZ2VvUnVsZUhlbHBlclwiXTtcblxuICBmdW5jdGlvbiBGaWx0ZXJDb250cm9sbGVyKGdldHRleHRDYXRhbG9nLCAkc2NvcGUsICR0aW1lb3V0LCBuZ2VvTWFwUXVlcmVudCwgbmdlb1J1bGVIZWxwZXIpIHtcbiAgICB0aGlzLmFSdWxlSXNBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLmN1c3RvbVJ1bGVzID0gW107XG4gICAgdGhpcy5kYXRhc291cmNlID0gbnVsbDtcbiAgICB0aGlzLmRpcmVjdGVkUnVsZXMgPSBbXTtcbiAgICB0aGlzLmZlYXR1cmVPdmVybGF5ID0gbnVsbDtcbiAgICB0aGlzLm1hcCA9IG51bGw7XG4gICAgdGhpcy50b29sR3JvdXAgPSAnJztcbiAgICB0aGlzLmZpbHRlcklzQXBwbGllZCA9IGZhbHNlO1xuICAgIHRoaXMuZ2V0dGV4dENhdGFsb2dfID0gZ2V0dGV4dENhdGFsb2c7XG4gICAgdGhpcy5zY29wZV8gPSAkc2NvcGU7XG4gICAgdGhpcy50aW1lb3V0XyA9ICR0aW1lb3V0O1xuICAgIHRoaXMubmdlb01hcFF1ZXJlbnRfID0gbmdlb01hcFF1ZXJlbnQ7XG4gICAgdGhpcy5uZ2VvUnVsZUhlbHBlcl8gPSBuZ2VvUnVsZUhlbHBlcjtcbiAgICB0aGlzLmNvbmRpdGlvbnMgPSBbe1xuICAgICAgdGV4dDogZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdNYXRjaCBhbGwgY3JpdGVyaWEnKSxcbiAgICAgIHZhbHVlOiBuZ2VvRmlsdGVyQ29uZGl0aW9uLkFORFxuICAgIH0sIHtcbiAgICAgIHRleHQ6IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnTWF0Y2ggYXQgbGVhc3Qgb25lIGNyaXRlcmlvbicpLFxuICAgICAgdmFsdWU6IG5nZW9GaWx0ZXJDb25kaXRpb24uT1JcbiAgICB9LCB7XG4gICAgICB0ZXh0OiBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0RvZXMgbm90IG1hdGNoIGFueSBjcml0ZXJpb24nKSxcbiAgICAgIHZhbHVlOiBuZ2VvRmlsdGVyQ29uZGl0aW9uLk5PVFxuICAgIH1dO1xuICAgIHRoaXMuZ2VvbWV0cnlBdHRyaWJ1dGVzID0gW107XG4gICAgdGhpcy5vdGhlckF0dHJpYnV0ZXMgPSBbXTtcbiAgICB0aGlzLnJ1bGVVbmxpc3RlbmVyc18gPSB7fTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBGaWx0ZXJDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uJG9uSW5pdCA9IGZ1bmN0aW9uICRvbkluaXQoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIGlmICghdGhpcy5kYXRhc291cmNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGF0YXNvdXJjZScpO1xuICAgIH1cblxuICAgIHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMuYVJ1bGVJc0FjdGl2ZTtcbiAgICB9LCB0aGlzLmhhbmRsZUFSdWxlSXNBY3RpdmVDaGFuZ2VfLmJpbmQodGhpcykpO1xuICAgIHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMuZGF0YXNvdXJjZS5maWx0ZXJSdWxlcztcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5maWx0ZXJJc0FwcGxpZWQgPSBfdGhpcy5oYXNBUnVsZUFjdGl2ZSgpO1xuICAgIH0pO1xuICAgIHZhciBhdHRyaWJ1dGVzID0gdGhpcy5kYXRhc291cmNlLmF0dHJpYnV0ZXM7XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBhdHRyaWJ1dGVzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgYXR0cmlidXRlID0gX3JlZjtcblxuICAgICAgaWYgKGF0dHJpYnV0ZS50eXBlID09PSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5HRU9NRVRSWSkge1xuICAgICAgICB0aGlzLmdlb21ldHJ5QXR0cmlidXRlcy5wdXNoKGF0dHJpYnV0ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm90aGVyQXR0cmlidXRlcy5wdXNoKGF0dHJpYnV0ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IHRoaXMuY3VzdG9tUnVsZXMsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYyO1xuXG4gICAgICBpZiAoX2lzQXJyYXkyKSB7XG4gICAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmMiA9IF9pdGVyYXRvcjJbX2kyKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICAgIGlmIChfaTIuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYyID0gX2kyLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgcnVsZSA9IF9yZWYyO1xuICAgICAgdGhpcy5yZWdpc3RlclJ1bGVfKHJ1bGUpO1xuICAgIH1cblxuICAgIGZvciAodmFyIF9pdGVyYXRvcjMgPSB0aGlzLmRpcmVjdGVkUnVsZXMsIF9pc0FycmF5MyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMyksIF9pMyA9IDAsIF9pdGVyYXRvcjMgPSBfaXNBcnJheTMgPyBfaXRlcmF0b3IzIDogX2l0ZXJhdG9yM1tTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYzO1xuXG4gICAgICBpZiAoX2lzQXJyYXkzKSB7XG4gICAgICAgIGlmIChfaTMgPj0gX2l0ZXJhdG9yMy5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmMyA9IF9pdGVyYXRvcjNbX2kzKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kzID0gX2l0ZXJhdG9yMy5uZXh0KCk7XG4gICAgICAgIGlmIChfaTMuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYzID0gX2kzLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgX3J1bGUgPSBfcmVmMztcbiAgICAgIHRoaXMucmVnaXN0ZXJSdWxlXyhfcnVsZSk7XG4gICAgfVxuXG4gICAgdGhpcy5hcHBseSgpO1xuICB9O1xuXG4gIF9wcm90by4kb25EZXN0cm95ID0gZnVuY3Rpb24gJG9uRGVzdHJveSgpIHtcbiAgICBpZiAoIXRoaXMuZGF0YXNvdXJjZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGRhdGFzb3VyY2UnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuZmVhdHVyZU92ZXJsYXkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlT3ZlcmxheScpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGFzb3VyY2UuZmlsdGVyUnVsZXMgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuZGF0YXNvdXJjZS5maWx0ZXJSdWxlcyA9IG51bGw7XG4gICAgfVxuXG4gICAgdGhpcy5mZWF0dXJlT3ZlcmxheS5jbGVhcigpO1xuICB9O1xuXG4gIF9wcm90by5oYXNBUnVsZUFjdGl2ZSA9IGZ1bmN0aW9uIGhhc0FSdWxlQWN0aXZlKCkge1xuICAgIHZhciBjdXN0b21SdWxlQWN0aXZlID0gZmFsc2U7XG4gICAgdmFyIGRpcmVjdGVkUnVsZUFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IHRoaXMuY3VzdG9tUnVsZXMsIF9pc0FycmF5NCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNCksIF9pNCA9IDAsIF9pdGVyYXRvcjQgPSBfaXNBcnJheTQgPyBfaXRlcmF0b3I0IDogX2l0ZXJhdG9yNFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY0O1xuXG4gICAgICBpZiAoX2lzQXJyYXk0KSB7XG4gICAgICAgIGlmIChfaTQgPj0gX2l0ZXJhdG9yNC5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmNCA9IF9pdGVyYXRvcjRbX2k0KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k0ID0gX2l0ZXJhdG9yNC5uZXh0KCk7XG4gICAgICAgIGlmIChfaTQuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWY0ID0gX2k0LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgcnVsZSA9IF9yZWY0O1xuXG4gICAgICBpZiAocnVsZS5leHByZXNzaW9uKSB7XG4gICAgICAgIGN1c3RvbVJ1bGVBY3RpdmUgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIF9pdGVyYXRvcjUgPSB0aGlzLmRpcmVjdGVkUnVsZXMsIF9pc0FycmF5NSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNSksIF9pNSA9IDAsIF9pdGVyYXRvcjUgPSBfaXNBcnJheTUgPyBfaXRlcmF0b3I1IDogX2l0ZXJhdG9yNVtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY1O1xuXG4gICAgICBpZiAoX2lzQXJyYXk1KSB7XG4gICAgICAgIGlmIChfaTUgPj0gX2l0ZXJhdG9yNS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmNSA9IF9pdGVyYXRvcjVbX2k1KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k1ID0gX2l0ZXJhdG9yNS5uZXh0KCk7XG4gICAgICAgIGlmIChfaTUuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWY1ID0gX2k1LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgX3J1bGUyID0gX3JlZjU7XG5cbiAgICAgIGlmIChfcnVsZTIuZXhwcmVzc2lvbikge1xuICAgICAgICBkaXJlY3RlZFJ1bGVBY3RpdmUgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBjdXN0b21SdWxlQWN0aXZlIHx8IGRpcmVjdGVkUnVsZUFjdGl2ZTtcbiAgfTtcblxuICBfcHJvdG8uYXBwbHkgPSBmdW5jdGlvbiBhcHBseSgpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIGlmICghdGhpcy5kYXRhc291cmNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGF0YXNvdXJjZScpO1xuICAgIH1cblxuICAgIHRoaXMuZGF0YXNvdXJjZS5maWx0ZXJSdWxlcyA9IG51bGw7XG4gICAgdGhpcy50aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZmlsdGVyUnVsZXMgPSBfdGhpczIuZ2V0UnVsZXNXaXRoVmFsdWVfKCk7XG5cbiAgICAgIGlmIChmaWx0ZXJSdWxlcy5sZW5ndGgpIHtcbiAgICAgICAgaWYgKCFfdGhpczIuZGF0YXNvdXJjZSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkYXRhc291cmNlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpczIuZGF0YXNvdXJjZS5maWx0ZXJSdWxlcyA9IGZpbHRlclJ1bGVzO1xuXG4gICAgICAgIF90aGlzMi5uZ2VvTWFwUXVlcmVudF8uY2xlYXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0RGF0YSA9IGZ1bmN0aW9uIGdldERhdGEoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGFzb3VyY2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkYXRhc291cmNlJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIHZhciBmaWx0ZXJSdWxlcyA9IHRoaXMuZ2V0UnVsZXNXaXRoVmFsdWVfKCk7XG5cbiAgICBpZiAoIWZpbHRlclJ1bGVzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBkYXRhU291cmNlID0gdGhpcy5kYXRhc291cmNlO1xuICAgIHZhciBsaW1pdCA9IDEwMDA7XG4gICAgdmFyIG1hcCA9IHRoaXMubWFwO1xuICAgIHZhciBwcm9qQ29kZSA9IG1hcC5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpLmdldENvZGUoKTtcbiAgICB2YXIgZmlsdGVyID0gdGhpcy5uZ2VvUnVsZUhlbHBlcl8uY3JlYXRlRmlsdGVyKHtcbiAgICAgIGRhdGFTb3VyY2U6IGRhdGFTb3VyY2UsXG4gICAgICBmaWx0ZXJSdWxlczogZmlsdGVyUnVsZXMsXG4gICAgICBzcnNOYW1lOiBwcm9qQ29kZVxuICAgIH0pO1xuXG4gICAgaWYgKCFmaWx0ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmaWx0ZXInKTtcbiAgICB9XG5cbiAgICB0aGlzLm5nZW9NYXBRdWVyZW50Xy5pc3N1ZSh7XG4gICAgICBkYXRhU291cmNlczogW2RhdGFTb3VyY2VdLFxuICAgICAgZmlsdGVyOiBmaWx0ZXIsXG4gICAgICBsaW1pdDogbGltaXQsXG4gICAgICBtYXA6IG1hcFxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5nZXRSdWxlc1dpdGhWYWx1ZV8gPSBmdW5jdGlvbiBnZXRSdWxlc1dpdGhWYWx1ZV8oKSB7XG4gICAgdmFyIGZpbHRlclJ1bGVzID0gW107XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3I2ID0gdGhpcy5jdXN0b21SdWxlcywgX2lzQXJyYXk2ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I2KSwgX2k2ID0gMCwgX2l0ZXJhdG9yNiA9IF9pc0FycmF5NiA/IF9pdGVyYXRvcjYgOiBfaXRlcmF0b3I2W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjY7XG5cbiAgICAgIGlmIChfaXNBcnJheTYpIHtcbiAgICAgICAgaWYgKF9pNiA+PSBfaXRlcmF0b3I2Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWY2ID0gX2l0ZXJhdG9yNltfaTYrK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaTYgPSBfaXRlcmF0b3I2Lm5leHQoKTtcbiAgICAgICAgaWYgKF9pNi5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZjYgPSBfaTYudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBydWxlID0gX3JlZjY7XG5cbiAgICAgIGlmIChydWxlLnZhbHVlKSB7XG4gICAgICAgIGZpbHRlclJ1bGVzLnB1c2gocnVsZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yNyA9IHRoaXMuZGlyZWN0ZWRSdWxlcywgX2lzQXJyYXk3ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I3KSwgX2k3ID0gMCwgX2l0ZXJhdG9yNyA9IF9pc0FycmF5NyA/IF9pdGVyYXRvcjcgOiBfaXRlcmF0b3I3W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjc7XG5cbiAgICAgIGlmIChfaXNBcnJheTcpIHtcbiAgICAgICAgaWYgKF9pNyA+PSBfaXRlcmF0b3I3Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWY3ID0gX2l0ZXJhdG9yN1tfaTcrK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaTcgPSBfaXRlcmF0b3I3Lm5leHQoKTtcbiAgICAgICAgaWYgKF9pNy5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZjcgPSBfaTcudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBfcnVsZTMgPSBfcmVmNztcblxuICAgICAgaWYgKF9ydWxlMy52YWx1ZSkge1xuICAgICAgICBmaWx0ZXJSdWxlcy5wdXNoKF9ydWxlMyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbHRlclJ1bGVzO1xuICB9O1xuXG4gIF9wcm90by5jcmVhdGVBbmRBZGRDdXN0b21SdWxlID0gZnVuY3Rpb24gY3JlYXRlQW5kQWRkQ3VzdG9tUnVsZShhdHRyaWJ1dGUpIHtcbiAgICB2YXIgcnVsZSA9IHRoaXMubmdlb1J1bGVIZWxwZXJfLmNyZWF0ZVJ1bGVGcm9tQXR0cmlidXRlKGF0dHJpYnV0ZSwgdHJ1ZSk7XG4gICAgdGhpcy5yZWdpc3RlclJ1bGVfKHJ1bGUpO1xuICAgIHRoaXMuY3VzdG9tUnVsZXMucHVzaChydWxlKTtcbiAgICB0aGlzLnRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJ1bGUuYWN0aXZlID0gdHJ1ZTtcbiAgICB9LCAxKTtcbiAgfTtcblxuICBfcHJvdG8uc2V0Q29uZGl0aW9uID0gZnVuY3Rpb24gc2V0Q29uZGl0aW9uKGNvbmRpdGlvbikge1xuICAgIGlmICghdGhpcy5kYXRhc291cmNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGF0YXNvdXJjZScpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGFzb3VyY2UuZmlsdGVyQ29uZGl0aW9uICE9PSBjb25kaXRpb24udmFsdWUpIHtcbiAgICAgIHRoaXMuZGF0YXNvdXJjZS5maWx0ZXJDb25kaXRpb24gPSBjb25kaXRpb24udmFsdWU7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5yZW1vdmVDdXN0b21SdWxlID0gZnVuY3Rpb24gcmVtb3ZlQ3VzdG9tUnVsZShydWxlKSB7XG4gICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICBydWxlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMudGltZW91dF8oZnVuY3Rpb24gKCkge1xuICAgICAgcmVtb3ZlRnJvbUFycmF5KF90aGlzMy5jdXN0b21SdWxlcywgcnVsZSk7XG5cbiAgICAgIF90aGlzMy51bnJlZ2lzdGVyUnVsZV8ocnVsZSk7XG5cbiAgICAgIHJ1bGUuZGVzdHJveSgpO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5yZWdpc3RlclJ1bGVfID0gZnVuY3Rpb24gcmVnaXN0ZXJSdWxlXyhydWxlKSB7XG4gICAgaWYgKCF0aGlzLmZlYXR1cmVPdmVybGF5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZU92ZXJsYXknKTtcbiAgICB9XG5cbiAgICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKHJ1bGUpO1xuICAgIHRoaXMucnVsZVVubGlzdGVuZXJzX1t1aWRdID0gdGhpcy5zY29wZV8uJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBydWxlLmFjdGl2ZTtcbiAgICB9LCB0aGlzLmhhbmRsZVJ1bGVBY3RpdmVDaGFuZ2VfLmJpbmQodGhpcykpO1xuXG4gICAgaWYgKHJ1bGUgaW5zdGFuY2VvZiBuZ2VvUnVsZUdlb21ldHJ5KSB7XG4gICAgICB0aGlzLmZlYXR1cmVPdmVybGF5LmFkZEZlYXR1cmUocnVsZS5mZWF0dXJlKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnVucmVnaXN0ZXJSdWxlXyA9IGZ1bmN0aW9uIHVucmVnaXN0ZXJSdWxlXyhydWxlKSB7XG4gICAgaWYgKCF0aGlzLmZlYXR1cmVPdmVybGF5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZU92ZXJsYXknKTtcbiAgICB9XG5cbiAgICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKHJ1bGUpO1xuICAgIHZhciB1bmxpc3RlbmVyID0gdGhpcy5ydWxlVW5saXN0ZW5lcnNfW3VpZF07XG4gICAgY29uc29sZS5hc3NlcnQodW5saXN0ZW5lcik7XG4gICAgdW5saXN0ZW5lcigpO1xuICAgIGRlbGV0ZSB0aGlzLnJ1bGVVbmxpc3RlbmVyc19bdWlkXTtcblxuICAgIGlmIChydWxlIGluc3RhbmNlb2Ygbmdlb1J1bGVHZW9tZXRyeSkge1xuICAgICAgdGhpcy5mZWF0dXJlT3ZlcmxheS5yZW1vdmVGZWF0dXJlKHJ1bGUuZmVhdHVyZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVSdWxlQWN0aXZlQ2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZVJ1bGVBY3RpdmVDaGFuZ2VfKCkge1xuICAgIHZhciBhUnVsZUlzQWN0aXZlID0gZmFsc2U7XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3I4ID0gdGhpcy5jdXN0b21SdWxlcywgX2lzQXJyYXk4ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I4KSwgX2k4ID0gMCwgX2l0ZXJhdG9yOCA9IF9pc0FycmF5OCA/IF9pdGVyYXRvcjggOiBfaXRlcmF0b3I4W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjg7XG5cbiAgICAgIGlmIChfaXNBcnJheTgpIHtcbiAgICAgICAgaWYgKF9pOCA+PSBfaXRlcmF0b3I4Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWY4ID0gX2l0ZXJhdG9yOFtfaTgrK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaTggPSBfaXRlcmF0b3I4Lm5leHQoKTtcbiAgICAgICAgaWYgKF9pOC5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZjggPSBfaTgudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBydWxlID0gX3JlZjg7XG5cbiAgICAgIGlmIChydWxlLmFjdGl2ZSkge1xuICAgICAgICBhUnVsZUlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yOSA9IHRoaXMuZGlyZWN0ZWRSdWxlcywgX2lzQXJyYXk5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I5KSwgX2k5ID0gMCwgX2l0ZXJhdG9yOSA9IF9pc0FycmF5OSA/IF9pdGVyYXRvcjkgOiBfaXRlcmF0b3I5W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjk7XG5cbiAgICAgIGlmIChfaXNBcnJheTkpIHtcbiAgICAgICAgaWYgKF9pOSA+PSBfaXRlcmF0b3I5Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWY5ID0gX2l0ZXJhdG9yOVtfaTkrK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaTkgPSBfaXRlcmF0b3I5Lm5leHQoKTtcbiAgICAgICAgaWYgKF9pOS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZjkgPSBfaTkudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBfcnVsZTQgPSBfcmVmOTtcblxuICAgICAgaWYgKF9ydWxlNC5hY3RpdmUpIHtcbiAgICAgICAgYVJ1bGVJc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuYVJ1bGVJc0FjdGl2ZSA9IGFSdWxlSXNBY3RpdmU7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUFSdWxlSXNBY3RpdmVDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlQVJ1bGVJc0FjdGl2ZUNoYW5nZV8oKSB7XG4gICAgaWYgKHRoaXMuYVJ1bGVJc0FjdGl2ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAodmFyIF9pdGVyYXRvcjEwID0gdGhpcy5jdXN0b21SdWxlcywgX2lzQXJyYXkxMCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMTApLCBfaTEwID0gMCwgX2l0ZXJhdG9yMTAgPSBfaXNBcnJheTEwID8gX2l0ZXJhdG9yMTAgOiBfaXRlcmF0b3IxMFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYxMDtcblxuICAgICAgaWYgKF9pc0FycmF5MTApIHtcbiAgICAgICAgaWYgKF9pMTAgPj0gX2l0ZXJhdG9yMTAubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZjEwID0gX2l0ZXJhdG9yMTBbX2kxMCsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pMTAgPSBfaXRlcmF0b3IxMC5uZXh0KCk7XG4gICAgICAgIGlmIChfaTEwLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmMTAgPSBfaTEwLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgcnVsZSA9IF9yZWYxMDtcblxuICAgICAgaWYgKHJ1bGUuYWN0aXZlKSB7XG4gICAgICAgIHJ1bGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIF9pdGVyYXRvcjExID0gdGhpcy5kaXJlY3RlZFJ1bGVzLCBfaXNBcnJheTExID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IxMSksIF9pMTEgPSAwLCBfaXRlcmF0b3IxMSA9IF9pc0FycmF5MTEgPyBfaXRlcmF0b3IxMSA6IF9pdGVyYXRvcjExW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjExO1xuXG4gICAgICBpZiAoX2lzQXJyYXkxMSkge1xuICAgICAgICBpZiAoX2kxMSA+PSBfaXRlcmF0b3IxMS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmMTEgPSBfaXRlcmF0b3IxMVtfaTExKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kxMSA9IF9pdGVyYXRvcjExLm5leHQoKTtcbiAgICAgICAgaWYgKF9pMTEuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYxMSA9IF9pMTEudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBfcnVsZTUgPSBfcmVmMTE7XG5cbiAgICAgIGlmIChfcnVsZTUuYWN0aXZlKSB7XG4gICAgICAgIF9ydWxlNS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBGaWx0ZXJDb250cm9sbGVyO1xufSgpO1xuXG5tb2R1bGUuY29udHJvbGxlcignbmdlb0ZpbHRlckNvbnRyb2xsZXInLCBGaWx0ZXJDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvTWVudSBmcm9tICduZ2VvL01lbnUuanMnO1xuaW1wb3J0IG5nZW9EcmF3Q29tcG9uZW50IGZyb20gJ25nZW8vZHJhdy9jb21wb25lbnQuanMnO1xuaW1wb3J0IG5nZW9GaWx0ZXJSdWxlSGVscGVyIGZyb20gJ25nZW8vZmlsdGVyL1J1bGVIZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlIGZyb20gJ25nZW8vZm9ybWF0L0F0dHJpYnV0ZVR5cGUuanMnO1xuaW1wb3J0IG5nZW9HZW9tZXRyeVR5cGUgZnJvbSAnbmdlby9HZW9tZXRyeVR5cGUuanMnO1xuaW1wb3J0IG5nZW9JbnRlcmFjdGlvbk1vZGlmeSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL01vZGlmeS5qcyc7XG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uUm90YXRlIGZyb20gJ25nZW8vaW50ZXJhY3Rpb24vUm90YXRlLmpzJztcbmltcG9ydCBuZ2VvSW50ZXJhY3Rpb25UcmFuc2xhdGUgZnJvbSAnbmdlby9pbnRlcmFjdGlvbi9UcmFuc2xhdGUuanMnO1xuaW1wb3J0IG5nZW9NYXBGZWF0dXJlT3ZlcmxheSBmcm9tICduZ2VvL21hcC9GZWF0dXJlT3ZlcmxheS5qcyc7XG5pbXBvcnQgbmdlb01pc2NEYXRlcGlja2VyQ29tcG9uZW50IGZyb20gJ25nZW8vbWlzYy9kYXRlcGlja2VyQ29tcG9uZW50LmpzJztcbmltcG9ydCB7IGludGVyYWN0aW9uRGVjb3JhdGlvbiBhcyBuZ2VvTWlzY0RlY29yYXRlSW50ZXJhY3Rpb24gfSBmcm9tICduZ2VvL21pc2MvZGVjb3JhdGUuanMnO1xuaW1wb3J0IG5nZW9NaXNjRmVhdHVyZUhlbHBlciBmcm9tICduZ2VvL21pc2MvRmVhdHVyZUhlbHBlci5qcyc7XG5pbXBvcnQgbmdlb01pc2NUb29sQWN0aXZhdGUgZnJvbSAnbmdlby9taXNjL1Rvb2xBY3RpdmF0ZS5qcyc7XG5pbXBvcnQgbmdlb01pc2NUb29sQWN0aXZhdGVNZ3IgZnJvbSAnbmdlby9taXNjL1Rvb2xBY3RpdmF0ZU1nci5qcyc7XG5pbXBvcnQgeyBSdWxlT3BlcmF0b3JUeXBlLCBSdWxlU3BhdGlhbE9wZXJhdG9yVHlwZSwgUnVsZVRlbXBvcmFsT3BlcmF0b3JUeXBlIH0gZnJvbSAnbmdlby9ydWxlL1J1bGUuanMnO1xuaW1wb3J0IG5nZW9SdWxlR2VvbWV0cnkgZnJvbSAnbmdlby9ydWxlL0dlb21ldHJ5LmpzJztcbmltcG9ydCB7IGdldFVpZCBhcyBvbFV0aWxHZXRVaWQgfSBmcm9tICdvbC91dGlsLmpzJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4sIHVubGlzdGVuQnlLZXkgfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sU3R5bGVTdHlsZSBmcm9tICdvbC9zdHlsZS9TdHlsZS5qcyc7XG5pbXBvcnQgb2xTdHlsZVRleHQgZnJvbSAnb2wvc3R5bGUvVGV4dC5qcyc7XG5pbXBvcnQgb2xTdHlsZUZpbGwgZnJvbSAnb2wvc3R5bGUvRmlsbC5qcyc7XG5pbXBvcnQgeyBDb2xsZWN0aW9uRXZlbnQgfSBmcm9tICdvbC9Db2xsZWN0aW9uLmpzJztcbmltcG9ydCBGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuaW1wb3J0ICduZ2VvL3Nhc3MvZm9udC5zY3NzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb1J1bGUnLCBbbmdlb0RyYXdDb21wb25lbnQubmFtZSwgbmdlb0ZpbHRlclJ1bGVIZWxwZXIubmFtZSwgbmdlb01hcEZlYXR1cmVPdmVybGF5Lm5hbWUsIG5nZW9NaXNjRGF0ZXBpY2tlckNvbXBvbmVudC5uYW1lLCBuZ2VvTWlzY0ZlYXR1cmVIZWxwZXIubmFtZSwgbmdlb01pc2NUb29sQWN0aXZhdGVNZ3IubmFtZV0pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCduZ2VvL2ZpbHRlci9ydWxlY29tcG9uZW50JywgcmVxdWlyZSgnLi9ydWxlY29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5tb2R1bGUudmFsdWUoJ25nZW9SdWxlVGVtcGxhdGVVcmwnLCBmdW5jdGlvbiAoJGF0dHJzKSB7XG4gIHZhciB0ZW1wbGF0ZVVybCA9ICRhdHRyc1snbmdlb1J1bGVUZW1wbGF0ZVVybCddO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ25nZW8vZmlsdGVyL3J1bGVjb21wb25lbnQnO1xufSk7XG5uZ2VvUnVsZVRlbXBsYXRlVXJsLiRpbmplY3QgPSBbXCIkYXR0cnNcIiwgXCJuZ2VvUnVsZVRlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBuZ2VvUnVsZVRlbXBsYXRlVXJsKCRhdHRycywgbmdlb1J1bGVUZW1wbGF0ZVVybCkge1xuICByZXR1cm4gbmdlb1J1bGVUZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG52YXIgUnVsZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIFJ1bGVDb250cm9sbGVyLiRpbmplY3QgPSBbXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIiRzY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwibmdlb0ZlYXR1cmVIZWxwZXJcIiwgXCJuZ2VvUnVsZUhlbHBlclwiLCBcIm5nZW9Ub29sQWN0aXZhdGVNZ3JcIl07XG5cbiAgZnVuY3Rpb24gUnVsZUNvbnRyb2xsZXIoZ2V0dGV4dENhdGFsb2csICRzY29wZSwgJHRpbWVvdXQsIG5nZW9GZWF0dXJlSGVscGVyLCBuZ2VvUnVsZUhlbHBlciwgbmdlb1Rvb2xBY3RpdmF0ZU1ncikge1xuICAgIHZhciBfdGhpcyRvcGVyYXRvcnMsIF90aGlzJG9wZXJhdG9yc1Nob3J0RjtcblxuICAgIHRoaXMuZmVhdHVyZU92ZXJsYXkgPSBudWxsO1xuICAgIHRoaXMubWFwID0gbnVsbDtcbiAgICB0aGlzLnJ1bGUgPSBudWxsO1xuICAgIHRoaXMudG9vbEdyb3VwID0gJyc7XG4gICAgdGhpcy5nZXR0ZXh0Q2F0YWxvZ18gPSBnZXR0ZXh0Q2F0YWxvZztcbiAgICB0aGlzLnNjb3BlXyA9ICRzY29wZTtcbiAgICB0aGlzLnRpbWVvdXRfID0gJHRpbWVvdXQ7XG4gICAgdGhpcy5uZ2VvRmVhdHVyZUhlbHBlcl8gPSBuZ2VvRmVhdHVyZUhlbHBlcjtcbiAgICB0aGlzLm5nZW9SdWxlSGVscGVyXyA9IG5nZW9SdWxlSGVscGVyO1xuICAgIHRoaXMubmdlb1Rvb2xBY3RpdmF0ZU1ncl8gPSBuZ2VvVG9vbEFjdGl2YXRlTWdyO1xuICAgIHRoaXMuY2xvbmUgPSBudWxsO1xuICAgIHZhciBvcGVyYXRvclR5cGUgPSBSdWxlT3BlcmF0b3JUeXBlO1xuICAgIHZhciBzcGF0aWFsT3BlcmF0b3JUeXBlID0gUnVsZVNwYXRpYWxPcGVyYXRvclR5cGU7XG4gICAgdmFyIHRlbXBvcmFsT3BlcmF0b3JUeXBlID0gUnVsZVRlbXBvcmFsT3BlcmF0b3JUeXBlO1xuICAgIHRoaXMub3BlcmF0b3JzID0gKF90aGlzJG9wZXJhdG9ycyA9IHt9LCBfdGhpcyRvcGVyYXRvcnNbb3BlcmF0b3JUeXBlLkVRVUFMX1RPXSA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnSXMgZXF1YWwgdG8nKSwgX3RoaXMkb3BlcmF0b3JzW29wZXJhdG9yVHlwZS5HUkVBVEVSX1RIQU5dID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdJcyBncmVhdGVyIHRoYW4nKSwgX3RoaXMkb3BlcmF0b3JzW29wZXJhdG9yVHlwZS5HUkVBVEVSX1RIQU5fT1JfRVFVQUxfVE9dID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdJcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8nKSwgX3RoaXMkb3BlcmF0b3JzW29wZXJhdG9yVHlwZS5MRVNTRVJfVEhBTl0gPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0lzIGxlc3NlciB0aGFuJyksIF90aGlzJG9wZXJhdG9yc1tvcGVyYXRvclR5cGUuTEVTU0VSX1RIQU5fT1JfRVFVQUxfVE9dID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdJcyBsZXNzZXIgdGhhbiBvciBlcXVhbCB0bycpLCBfdGhpcyRvcGVyYXRvcnNbb3BlcmF0b3JUeXBlLk5PVF9FUVVBTF9UT10gPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0lzIG5vdCBlcXVhbCB0bycpLCBfdGhpcyRvcGVyYXRvcnNbb3BlcmF0b3JUeXBlLkxJS0VdID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdDb250YWlucycpLCBfdGhpcyRvcGVyYXRvcnNbc3BhdGlhbE9wZXJhdG9yVHlwZS5DT05UQUlOU10gPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0NvbnRhaW5zJyksIF90aGlzJG9wZXJhdG9yc1tzcGF0aWFsT3BlcmF0b3JUeXBlLklOVEVSU0VDVFNdID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdJbnRlcnNlY3RzJyksIF90aGlzJG9wZXJhdG9yc1tzcGF0aWFsT3BlcmF0b3JUeXBlLldJVEhJTl0gPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ0lzIGluc2lkZSBvZicpLCBfdGhpcyRvcGVyYXRvcnNbdGVtcG9yYWxPcGVyYXRvclR5cGUuQkVHSU5TXSA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQmVnaW5zIGF0JyksIF90aGlzJG9wZXJhdG9yc1t0ZW1wb3JhbE9wZXJhdG9yVHlwZS5EVVJJTkddID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdEdXJpbmcnKSwgX3RoaXMkb3BlcmF0b3JzW3RlbXBvcmFsT3BlcmF0b3JUeXBlLkVORFNdID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdFbmRzIGF0JyksIF90aGlzJG9wZXJhdG9yc1t0ZW1wb3JhbE9wZXJhdG9yVHlwZS5FUVVBTFNdID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdJcyBlcXVhbCB0bycpLCBfdGhpcyRvcGVyYXRvcnMpO1xuICAgIHRoaXMub3BlcmF0b3JzU2hvcnRGb3JtYXQgPSAoX3RoaXMkb3BlcmF0b3JzU2hvcnRGID0ge30sIF90aGlzJG9wZXJhdG9yc1Nob3J0RltvcGVyYXRvclR5cGUuRVFVQUxfVE9dID0gJz0nLCBfdGhpcyRvcGVyYXRvcnNTaG9ydEZbb3BlcmF0b3JUeXBlLkdSRUFURVJfVEhBTl0gPSAnPicsIF90aGlzJG9wZXJhdG9yc1Nob3J0RltvcGVyYXRvclR5cGUuR1JFQVRFUl9USEFOX09SX0VRVUFMX1RPXSA9ICc+PScsIF90aGlzJG9wZXJhdG9yc1Nob3J0RltvcGVyYXRvclR5cGUuTEVTU0VSX1RIQU5dID0gJzwnLCBfdGhpcyRvcGVyYXRvcnNTaG9ydEZbb3BlcmF0b3JUeXBlLkxFU1NFUl9USEFOX09SX0VRVUFMX1RPXSA9ICc8PScsIF90aGlzJG9wZXJhdG9yc1Nob3J0RltvcGVyYXRvclR5cGUuTk9UX0VRVUFMX1RPXSA9ICchPScsIF90aGlzJG9wZXJhdG9yc1Nob3J0RltvcGVyYXRvclR5cGUuTElLRV0gPSAnficsIF90aGlzJG9wZXJhdG9yc1Nob3J0Rlt0ZW1wb3JhbE9wZXJhdG9yVHlwZS5CRUdJTlNdID0gJz49JywgX3RoaXMkb3BlcmF0b3JzU2hvcnRGW3RlbXBvcmFsT3BlcmF0b3JUeXBlLkVORFNdID0gJzw9JywgX3RoaXMkb3BlcmF0b3JzU2hvcnRGW3RlbXBvcmFsT3BlcmF0b3JUeXBlLkVRVUFMU10gPSAnPScsIF90aGlzJG9wZXJhdG9yc1Nob3J0Rik7XG4gICAgdGhpcy50aW1lUmFuZ2VNb2RlID0ge1xuICAgICAgd2lkZ2V0OiAnZGF0ZXBpY2tlcicsXG4gICAgICBtYXhWYWx1ZTogbnVsbCxcbiAgICAgIG1pblZhbHVlOiBudWxsLFxuICAgICAgbWF4RGVmVmFsdWU6IHRoaXMuY3JlYXRlRGF0ZV8oKSxcbiAgICAgIG1pbkRlZlZhbHVlOiB0aGlzLmNyZWF0ZVdlZWtBZ29EYXRlXygpLFxuICAgICAgbW9kZTogJ3JhbmdlJyxcbiAgICAgIGludGVydmFsOiBbMCwgMSwgMCwgMF1cbiAgICB9O1xuICAgIHRoaXMudGltZVZhbHVlTW9kZSA9IHtcbiAgICAgIHdpZGdldDogJ2RhdGVwaWNrZXInLFxuICAgICAgbWF4VmFsdWU6IG51bGwsXG4gICAgICBtaW5WYWx1ZTogbnVsbCxcbiAgICAgIG1heERlZlZhbHVlOiB0aGlzLmNyZWF0ZURhdGVfKCksXG4gICAgICBtaW5EZWZWYWx1ZTogdGhpcy5jcmVhdGVEYXRlXygpLFxuICAgICAgbW9kZTogJ3ZhbHVlJyxcbiAgICAgIGludGVydmFsOiBbMCwgMSwgMCwgMF1cbiAgICB9O1xuICAgIHRoaXMudG9vbEFjdGl2YXRlXyA9IG51bGw7XG4gICAgdGhpcy51bmxpc3RlbmVyc18gPSBbXTtcbiAgICB0aGlzLmRyYXdBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLmRyYXdUb29sQWN0aXZhdGUgPSBuZXcgbmdlb01pc2NUb29sQWN0aXZhdGUodGhpcywgJ2RyYXdBY3RpdmUnKTtcbiAgICB0aGlzLmRyYXduRmVhdHVyZXMgPSBuZXcgb2xDb2xsZWN0aW9uKCk7XG4gICAgdGhpcy5tZW51XyA9IG51bGw7XG4gICAgdGhpcy5zZWxlY3RlZEZlYXR1cmVzID0gbmV3IG9sQ29sbGVjdGlvbigpO1xuICAgIHRoaXMuaW50ZXJhY3Rpb25zXyA9IG5ldyBvbENvbGxlY3Rpb24oKTtcbiAgICB0aGlzLm1vZGlmeV8gPSBuZXcgbmdlb0ludGVyYWN0aW9uTW9kaWZ5KHtcbiAgICAgIGZlYXR1cmVzOiB0aGlzLnNlbGVjdGVkRmVhdHVyZXMsXG4gICAgICBzdHlsZTogbmdlb0ZlYXR1cmVIZWxwZXIuZ2V0VmVydGV4U3R5bGUoZmFsc2UpXG4gICAgfSk7XG4gICAgdGhpcy5pbnRlcmFjdGlvbnNfLnB1c2godGhpcy5tb2RpZnlfKTtcbiAgICB0aGlzLnJvdGF0ZV8gPSBuZXcgbmdlb0ludGVyYWN0aW9uUm90YXRlKHtcbiAgICAgIGZlYXR1cmVzOiB0aGlzLnNlbGVjdGVkRmVhdHVyZXMsXG4gICAgICBzdHlsZTogbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICAgIHRleHQ6IG5ldyBvbFN0eWxlVGV4dCh7XG4gICAgICAgICAgdGV4dDogXCJcXHVGMDFFXCIsXG4gICAgICAgICAgZm9udDogJzkwMCAxOHB4IFwiRm9udCBBd2Vzb21lIDUgRnJlZVwiJyxcbiAgICAgICAgICBmaWxsOiBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgICAgICAgY29sb3I6ICcjN2E3YTdhJ1xuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pO1xuICAgIHRoaXMuaW50ZXJhY3Rpb25zXy5wdXNoKHRoaXMucm90YXRlXyk7XG4gICAgdGhpcy50cmFuc2xhdGVfID0gbmV3IG5nZW9JbnRlcmFjdGlvblRyYW5zbGF0ZSh7XG4gICAgICBmZWF0dXJlczogdGhpcy5zZWxlY3RlZEZlYXR1cmVzLFxuICAgICAgc3R5bGU6IG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgICB0ZXh0OiBuZXcgb2xTdHlsZVRleHQoe1xuICAgICAgICAgIHRleHQ6IFwiXFx1RjBCMlwiLFxuICAgICAgICAgIGZvbnQ6ICc5MDAgMThweCBcIkZvbnQgQXdlc29tZSA1IEZyZWVcIicsXG4gICAgICAgICAgZmlsbDogbmV3IG9sU3R5bGVGaWxsKHtcbiAgICAgICAgICAgIGNvbG9yOiAnIzdhN2E3YSdcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9KTtcbiAgICB0aGlzLmludGVyYWN0aW9uc18ucHVzaCh0aGlzLnRyYW5zbGF0ZV8pO1xuICAgIHRoaXMubGlzdGVuZXJLZXlzXyA9IFtdO1xuICAgIHRoaXMuaW5pdGlhbGl6ZUludGVyYWN0aW9uc18oKTtcbiAgICB0aGlzLm1vZGlmeVRvb2xBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSh0aGlzLm1vZGlmeV8sICdhY3RpdmUnKTtcbiAgICB0aGlzLnJvdGF0ZVRvb2xBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSh0aGlzLnJvdGF0ZV8sICdhY3RpdmUnKTtcbiAgICB0aGlzLnRyYW5zbGF0ZVRvb2xBY3RpdmF0ZSA9IG5ldyBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZSh0aGlzLnRyYW5zbGF0ZV8sICdhY3RpdmUnKTtcbiAgICB0aGlzLmdlb21UeXBlID0gbnVsbDtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBSdWxlQ29udHJvbGxlci5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLiRvbkluaXQgPSBmdW5jdGlvbiAkb25Jbml0KCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBpZiAoIXRoaXMucnVsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJ1bGUnKTtcbiAgICB9XG5cbiAgICB0aGlzLmNsb25lID0gdGhpcy5uZ2VvUnVsZUhlbHBlcl8uY2xvbmVSdWxlKHRoaXMucnVsZSk7XG4gICAgdGhpcy50b29sQWN0aXZhdGVfID0gbmV3IG5nZW9NaXNjVG9vbEFjdGl2YXRlKHRoaXMucnVsZSwgJ2FjdGl2ZScpO1xuICAgIHRoaXMubmdlb1Rvb2xBY3RpdmF0ZU1ncl8ucmVnaXN0ZXJUb29sKHRoaXMudG9vbEdyb3VwLCB0aGlzLnRvb2xBY3RpdmF0ZV8pO1xuICAgIHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIV90aGlzLnJ1bGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJ1bGUnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIF90aGlzLnJ1bGUuYWN0aXZlO1xuICAgIH0sIHRoaXMuaGFuZGxlQWN0aXZlQ2hhbmdlXy5iaW5kKHRoaXMpKTtcblxuICAgIGlmICh0aGlzLmNsb25lLnR5cGUgPT09IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkRBVEUgfHwgdGhpcy5jbG9uZS50eXBlID09PSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5EQVRFVElNRSkge1xuICAgICAgdGhpcy51bmxpc3RlbmVyc18ucHVzaCh0aGlzLnNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIV90aGlzLmNsb25lKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNsb25lJyk7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpcy5jbG9uZS5nZXRFeHByZXNzaW9uKCk7XG4gICAgICB9LCBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmV3VmFsID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgX3RoaXMudGltZVZhbHVlTW9kZS5taW5EZWZWYWx1ZSA9IG5ld1ZhbCB8fCBfdGhpcy5jcmVhdGVEYXRlXygpO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgICB0aGlzLnVubGlzdGVuZXJzXy5wdXNoKHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghX3RoaXMuY2xvbmUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY2xvbmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90aGlzLmNsb25lLmxvd2VyQm91bmRhcnk7XG4gICAgICB9LCBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmV3VmFsID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgX3RoaXMudGltZVJhbmdlTW9kZS5taW5EZWZWYWx1ZSA9IG5ld1ZhbCB8fCBfdGhpcy5jcmVhdGVXZWVrQWdvRGF0ZV8oKTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgICAgdGhpcy51bmxpc3RlbmVyc18ucHVzaCh0aGlzLnNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIV90aGlzLmNsb25lKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNsb25lJyk7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpcy5jbG9uZS51cHBlckJvdW5kYXJ5O1xuICAgICAgfSwgZnVuY3Rpb24gKG5ld1ZhbCkge1xuICAgICAgICBpZiAodHlwZW9mIG5ld1ZhbCA9PSAnc3RyaW5nJykge1xuICAgICAgICAgIF90aGlzLnRpbWVSYW5nZU1vZGUubWF4RGVmVmFsdWUgPSBuZXdWYWwgfHwgX3RoaXMuY3JlYXRlRGF0ZV8oKTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5jbG9uZS50eXBlID09PSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5HRU9NRVRSWSkge1xuICAgICAgdGhpcy51bmxpc3RlbmVyc18ucHVzaCh0aGlzLnNjb3BlXy4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIV90aGlzLmNsb25lKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNsb25lJyk7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpcy5jbG9uZS5vcGVyYXRvcjtcbiAgICAgIH0sIGZ1bmN0aW9uIChuZXdWYWwpIHtcbiAgICAgICAgX3RoaXMuZHJhd0FjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChuZXdWYWwgJiYgbmV3VmFsID09PSBSdWxlU3BhdGlhbE9wZXJhdG9yVHlwZS5DT05UQUlOUykge1xuICAgICAgICAgIHZhciBjbG9uZSA9IF90aGlzLmNsb25lO1xuXG4gICAgICAgICAgaWYgKGNsb25lIGluc3RhbmNlb2Ygbmdlb1J1bGVHZW9tZXRyeSkge1xuICAgICAgICAgICAgdmFyIGdlb21ldHJ5ID0gY2xvbmUuZmVhdHVyZS5nZXRHZW9tZXRyeSgpO1xuXG4gICAgICAgICAgICBpZiAoZ2VvbWV0cnkpIHtcbiAgICAgICAgICAgICAgdmFyIGdlb21UeXBlID0gX3RoaXMubmdlb0ZlYXR1cmVIZWxwZXJfLmdldFR5cGUoY2xvbmUuZmVhdHVyZSk7XG5cbiAgICAgICAgICAgICAgdmFyIHN1cHBvcnRlZFR5cGVzID0gW25nZW9HZW9tZXRyeVR5cGUuQ0lSQ0xFLCBuZ2VvR2VvbWV0cnlUeXBlLlBPTFlHT04sIG5nZW9HZW9tZXRyeVR5cGUuUkVDVEFOR0xFXTtcblxuICAgICAgICAgICAgICBpZiAoIXN1cHBvcnRlZFR5cGVzLmluY2x1ZGVzKGdlb21UeXBlKSkge1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuY2xvbmUpIHtcbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjbG9uZScpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF90aGlzLmNsb25lLnNldEV4cHJlc3Npb24obnVsbCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICAgIHRoaXMudW5saXN0ZW5lcnNfLnB1c2godGhpcy5zY29wZV8uJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFfdGhpcy5jbG9uZSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjbG9uZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXMuY2xvbmUuZXhwcmVzc2lvbjtcbiAgICAgIH0sIGZ1bmN0aW9uIChuZXdWYWwpIHtcbiAgICAgICAgaWYgKG5ld1ZhbCkge1xuICAgICAgICAgIHZhciBjbG9uZSA9IF90aGlzLmNsb25lO1xuXG4gICAgICAgICAgaWYgKGNsb25lIGluc3RhbmNlb2Ygbmdlb1J1bGVHZW9tZXRyeSkge1xuICAgICAgICAgICAgX3RoaXMuZ2VvbVR5cGUgPSBfdGhpcy5uZ2VvRmVhdHVyZUhlbHBlcl8uZ2V0VHlwZShjbG9uZS5mZWF0dXJlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMuZ2VvbVR5cGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgICB0aGlzLnVubGlzdGVuZXJzXy5wdXNoKHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghX3RoaXMuY2xvbmUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY2xvbmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghX3RoaXMucnVsZSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBydWxlJyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgaGFzRXhwcmVzc2lvbiA9IF90aGlzLmNsb25lLmdldEV4cHJlc3Npb24oKSAhPT0gbnVsbDtcbiAgICAgICAgdmFyIGlzQWN0aXZlID0gX3RoaXMucnVsZS5hY3RpdmUgPT09IHRydWU7XG5cbiAgICAgICAgdmFyIGVkaXRUb29sSXNBY3RpdmUgPSBfdGhpcy5tb2RpZnlfLmdldEFjdGl2ZSgpIHx8IF90aGlzLnJvdGF0ZV8uZ2V0QWN0aXZlKCkgfHwgX3RoaXMudHJhbnNsYXRlXy5nZXRBY3RpdmUoKTtcblxuICAgICAgICByZXR1cm4gaGFzRXhwcmVzc2lvbiAmJiBpc0FjdGl2ZSAmJiBlZGl0VG9vbElzQWN0aXZlO1xuICAgICAgfSwgZnVuY3Rpb24gKG5ld1ZhbCkge1xuICAgICAgICBpZiAobmV3VmFsKSB7XG4gICAgICAgICAgdmFyIGNsb25lID0gX3RoaXMuY2xvbmU7XG5cbiAgICAgICAgICBpZiAoY2xvbmUgaW5zdGFuY2VvZiBuZ2VvUnVsZUdlb21ldHJ5KSB7XG4gICAgICAgICAgICBfdGhpcy5zZWxlY3RlZEZlYXR1cmVzLnB1c2goY2xvbmUuZmVhdHVyZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzLnNlbGVjdGVkRmVhdHVyZXMuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uJG9uRGVzdHJveSA9IGZ1bmN0aW9uICRvbkRlc3Ryb3koKSB7XG4gICAgaWYgKCF0aGlzLmNsb25lKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY2xvbmUnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMucnVsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJ1bGUnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMudG9vbEFjdGl2YXRlXykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHRvb2xBY3RpdmF0ZScpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnJ1bGUuYWN0aXZlKSB7XG4gICAgICB0aGlzLnJ1bGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmhhbmRsZUFjdGl2ZUNoYW5nZV8oZmFsc2UsIHRydWUpO1xuICAgIH1cblxuICAgIHRoaXMubmdlb1Rvb2xBY3RpdmF0ZU1ncl8udW5yZWdpc3RlclRvb2wodGhpcy50b29sR3JvdXAsIHRoaXMudG9vbEFjdGl2YXRlXyk7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLnVubGlzdGVuZXJzXy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICB0aGlzLnVubGlzdGVuZXJzX1tpXSgpO1xuICAgIH1cblxuICAgIHRoaXMudW5saXN0ZW5lcnNfLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5jbG9uZS5kZXN0cm95KCk7XG4gIH07XG5cbiAgX3Byb3RvLnRvZ2dsZSA9IGZ1bmN0aW9uIHRvZ2dsZSgpIHtcbiAgICBpZiAoIXRoaXMucnVsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJ1bGUnKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5ydWxlLmFjdGl2ZSkge1xuICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ydWxlLmFjdGl2ZSA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5hcHBseSA9IGZ1bmN0aW9uIGFwcGx5KCkge1xuICAgIGlmICghdGhpcy5jbG9uZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNsb25lJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnJ1bGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBydWxlJyk7XG4gICAgfVxuXG4gICAgdGhpcy5uZ2VvUnVsZUhlbHBlcl8uZXh0ZW5kUnVsZSh0aGlzLmNsb25lLCB0aGlzLnJ1bGUpO1xuICAgIHRoaXMucnVsZS5hY3RpdmUgPSBmYWxzZTtcbiAgfTtcblxuICBfcHJvdG8uY2FuY2VsID0gZnVuY3Rpb24gY2FuY2VsKCkge1xuICAgIGlmICghdGhpcy5ydWxlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcnVsZScpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5jbG9uZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNsb25lJyk7XG4gICAgfVxuXG4gICAgdGhpcy5uZ2VvUnVsZUhlbHBlcl8uZXh0ZW5kUnVsZSh0aGlzLnJ1bGUsIHRoaXMuY2xvbmUpO1xuICAgIHRoaXMucnVsZS5hY3RpdmUgPSBmYWxzZTtcbiAgfTtcblxuICBfcHJvdG8ucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHtcbiAgICBpZiAoIXRoaXMucnVsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJ1bGUnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuY2xvbmUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjbG9uZScpO1xuICAgIH1cblxuICAgIHRoaXMuY2xvbmUucmVzZXQoKTtcbiAgICB0aGlzLnJ1bGUucmVzZXQoKTtcbiAgfTtcblxuICBfcHJvdG8udG9nZ2xlQ2hvaWNlU2VsZWN0aW9uID0gZnVuY3Rpb24gdG9nZ2xlQ2hvaWNlU2VsZWN0aW9uKGNob2ljZSkge1xuICAgIGlmICghdGhpcy5jbG9uZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNsb25lJyk7XG4gICAgfVxuXG4gICAgdmFyIHJ1bGUgPSB0aGlzLmNsb25lO1xuICAgIHZhciBjaG9pY2VzID0gcnVsZS5nZXRFeHByZXNzaW9uKCkgPyBydWxlLmdldEV4cHJlc3Npb24oKS5zcGxpdCgnLCcpIDogW107XG4gICAgdmFyIGlkeCA9IGNob2ljZXMuaW5kZXhPZihjaG9pY2UpO1xuXG4gICAgaWYgKGlkeCA+IC0xKSB7XG4gICAgICBjaG9pY2VzLnNwbGljZShpZHgsIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjaG9pY2VzLnB1c2goY2hvaWNlKTtcbiAgICB9XG5cbiAgICBydWxlLnNldEV4cHJlc3Npb24oY2hvaWNlcy5sZW5ndGggPyBjaG9pY2VzLmpvaW4oJywnKSA6IG51bGwpO1xuICB9O1xuXG4gIF9wcm90by5vbkRhdGVTZWxlY3RlZCA9IGZ1bmN0aW9uIG9uRGF0ZVNlbGVjdGVkKGRhdGUpIHtcbiAgICBpZiAoIXRoaXMuY2xvbmUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjbG9uZScpO1xuICAgIH1cblxuICAgIHRoaXMuY2xvbmUuc2V0RXhwcmVzc2lvbihkYXRlLnN0YXJ0KTtcbiAgfTtcblxuICBfcHJvdG8ub25EYXRlUmFuZ2VTZWxlY3RlZCA9IGZ1bmN0aW9uIG9uRGF0ZVJhbmdlU2VsZWN0ZWQoZGF0ZSkge1xuICAgIGlmICghdGhpcy5jbG9uZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNsb25lJyk7XG4gICAgfVxuXG4gICAgdGhpcy5jbG9uZS5sb3dlckJvdW5kYXJ5ID0gZGF0ZS5zdGFydDtcbiAgICB0aGlzLmNsb25lLnVwcGVyQm91bmRhcnkgPSBkYXRlLmVuZDtcbiAgfTtcblxuICBfcHJvdG8uY3JlYXRlRGF0ZV8gPSBmdW5jdGlvbiBjcmVhdGVEYXRlXyhvcHRfdGltZURlbHRhKSB7XG4gICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuXG4gICAgaWYgKG9wdF90aW1lRGVsdGEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFyIHRpbWUgPSBkYXRlLmdldFRpbWUoKSAtIG9wdF90aW1lRGVsdGE7XG4gICAgICBkYXRlLnNldFRpbWUodGltZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKTtcbiAgfTtcblxuICBfcHJvdG8uY3JlYXRlV2Vla0Fnb0RhdGVfID0gZnVuY3Rpb24gY3JlYXRlV2Vla0Fnb0RhdGVfKCkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZURhdGVfKDEwMDAgKiA2MCAqIDYwICogMjQgKiA3KTtcbiAgfTtcblxuICBfcHJvdG8udGltZVRvRGF0ZSA9IGZ1bmN0aW9uIHRpbWVUb0RhdGUodGltZSkge1xuICAgIHZhciBkYXRlID0gbmV3IERhdGUodGltZSk7XG4gICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUFjdGl2ZUNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVBY3RpdmVDaGFuZ2VfKGFjdGl2ZSwgb2xkQWN0aXZlKSB7XG4gICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5mZWF0dXJlT3ZlcmxheSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmVPdmVybGF5Jyk7XG4gICAgfVxuXG4gICAgaWYgKCEodGhpcy5ydWxlIGluc3RhbmNlb2Ygbmdlb1J1bGVHZW9tZXRyeSkgfHwgISh0aGlzLmNsb25lIGluc3RhbmNlb2Ygbmdlb1J1bGVHZW9tZXRyeSkgfHwgYWN0aXZlID09PSBvbGRBY3RpdmUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIga2V5cyA9IHRoaXMubGlzdGVuZXJLZXlzXztcbiAgICB2YXIgdWlkID0gWyduZ2VvLXJ1bGUtJywgb2xVdGlsR2V0VWlkKHRoaXMpXS5qb2luKCctJyk7XG4gICAgdmFyIHRvb2xNZ3IgPSB0aGlzLm5nZW9Ub29sQWN0aXZhdGVNZ3JfO1xuICAgIHZhciBydWxlRmVhdHVyZSA9IHRoaXMucnVsZS5mZWF0dXJlO1xuICAgIHZhciBjbG9uZUZlYXR1cmUgPSB0aGlzLmNsb25lLmZlYXR1cmU7XG4gICAgdmFyIG1hcERpdiA9IHRoaXMubWFwLmdldFZpZXdwb3J0KCk7XG4gICAgY29uc29sZS5hc3NlcnQobWFwRGl2KTtcblxuICAgIGlmIChhY3RpdmUpIHtcbiAgICAgIGtleXMucHVzaChsaXN0ZW4odGhpcy5kcmF3bkZlYXR1cmVzLCAnYWRkJywgdGhpcy5oYW5kbGVGZWF0dXJlc0FkZF8sIHRoaXMpLCBsaXN0ZW4obWFwRGl2LCAnY29udGV4dG1lbnUnLCB0aGlzLmhhbmRsZU1hcENvbnRleHRNZW51XywgdGhpcyksIGxpc3Rlbih0aGlzLnRyYW5zbGF0ZV8sICd0cmFuc2xhdGVlbmQnLCB0aGlzLmhhbmRsZVRyYW5zbGF0ZUVuZF8sIHRoaXMpLCBsaXN0ZW4odGhpcy5yb3RhdGVfLCAncm90YXRlZW5kJywgdGhpcy5oYW5kbGVSb3RhdGVFbmRfLCB0aGlzKSk7XG4gICAgICB0aGlzLmZlYXR1cmVPdmVybGF5LnJlbW92ZUZlYXR1cmUocnVsZUZlYXR1cmUpO1xuICAgICAgdGhpcy5mZWF0dXJlT3ZlcmxheS5hZGRGZWF0dXJlKGNsb25lRmVhdHVyZSk7XG4gICAgICB0aGlzLnJlZ2lzdGVySW50ZXJhY3Rpb25zXygpO1xuICAgICAgdG9vbE1nci5yZWdpc3RlclRvb2wodWlkLCB0aGlzLmRyYXdUb29sQWN0aXZhdGUsIGZhbHNlKTtcbiAgICAgIHRvb2xNZ3IucmVnaXN0ZXJUb29sKHVpZCwgdGhpcy5tb2RpZnlUb29sQWN0aXZhdGUsIHRydWUpO1xuICAgICAgdG9vbE1nci5yZWdpc3RlclRvb2wodWlkLCB0aGlzLnJvdGF0ZVRvb2xBY3RpdmF0ZSwgZmFsc2UpO1xuICAgICAgdG9vbE1nci5yZWdpc3RlclRvb2wodWlkLCB0aGlzLnRyYW5zbGF0ZVRvb2xBY3RpdmF0ZSwgZmFsc2UpO1xuICAgICAgdGhpcy5tb2RpZnlfLnNldEFjdGl2ZSh0cnVlKTtcblxuICAgICAgaWYgKGNsb25lRmVhdHVyZS5nZXRHZW9tZXRyeSgpKSB7XG4gICAgICAgIHRoaXMubmdlb0ZlYXR1cmVIZWxwZXJfLnNldFN0eWxlKGNsb25lRmVhdHVyZSwgdHJ1ZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNsb25lRmVhdHVyZS5zZXRTdHlsZShudWxsKTtcbiAgICAgIGtleXMuZm9yRWFjaCh1bmxpc3RlbkJ5S2V5KTtcbiAgICAgIGtleXMubGVuZ3RoID0gMDtcbiAgICAgIHRoaXMuZHJhd0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgdG9vbE1nci51bnJlZ2lzdGVyVG9vbCh1aWQsIHRoaXMuZHJhd1Rvb2xBY3RpdmF0ZSk7XG4gICAgICB0b29sTWdyLnVucmVnaXN0ZXJUb29sKHVpZCwgdGhpcy5tb2RpZnlUb29sQWN0aXZhdGUpO1xuICAgICAgdG9vbE1nci51bnJlZ2lzdGVyVG9vbCh1aWQsIHRoaXMucm90YXRlVG9vbEFjdGl2YXRlKTtcbiAgICAgIHRvb2xNZ3IudW5yZWdpc3RlclRvb2wodWlkLCB0aGlzLnRyYW5zbGF0ZVRvb2xBY3RpdmF0ZSk7XG4gICAgICB0aGlzLm1vZGlmeV8uc2V0QWN0aXZlKGZhbHNlKTtcbiAgICAgIHRoaXMudW5yZWdpc3RlckludGVyYWN0aW9uc18oKTtcblxuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGZWF0dXJlcy5nZXRMZW5ndGgoKSkge1xuICAgICAgICB0aGlzLmZlYXR1cmVPdmVybGF5LnJlbW92ZUZlYXR1cmUoY2xvbmVGZWF0dXJlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5mZWF0dXJlT3ZlcmxheS5hZGRGZWF0dXJlKHJ1bGVGZWF0dXJlKTtcbiAgICAgIHRoaXMuc2VsZWN0ZWRGZWF0dXJlcy5jbGVhcigpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaW5pdGlhbGl6ZUludGVyYWN0aW9uc18gPSBmdW5jdGlvbiBpbml0aWFsaXplSW50ZXJhY3Rpb25zXygpIHtcbiAgICB0aGlzLmludGVyYWN0aW9uc18uZm9yRWFjaChmdW5jdGlvbiAoaW50ZXJhY3Rpb24pIHtcbiAgICAgIGludGVyYWN0aW9uLnNldEFjdGl2ZShmYWxzZSk7XG4gICAgICBuZ2VvTWlzY0RlY29yYXRlSW50ZXJhY3Rpb24oaW50ZXJhY3Rpb24pO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5yZWdpc3RlckludGVyYWN0aW9uc18gPSBmdW5jdGlvbiByZWdpc3RlckludGVyYWN0aW9uc18oKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB0aGlzLmludGVyYWN0aW9uc18uZm9yRWFjaChmdW5jdGlvbiAoaW50ZXJhY3Rpb24pIHtcbiAgICAgIGlmICghX3RoaXMyLm1hcCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICB9XG5cbiAgICAgIF90aGlzMi5tYXAuYWRkSW50ZXJhY3Rpb24oaW50ZXJhY3Rpb24pO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by51bnJlZ2lzdGVySW50ZXJhY3Rpb25zXyA9IGZ1bmN0aW9uIHVucmVnaXN0ZXJJbnRlcmFjdGlvbnNfKCkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdGhpcy5pbnRlcmFjdGlvbnNfLmZvckVhY2goZnVuY3Rpb24gKGludGVyYWN0aW9uKSB7XG4gICAgICBpZiAoIV90aGlzMy5tYXApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcCcpO1xuICAgICAgfVxuXG4gICAgICBfdGhpczMubWFwLnJlbW92ZUludGVyYWN0aW9uKGludGVyYWN0aW9uKTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRmVhdHVyZXNBZGRfID0gZnVuY3Rpb24gaGFuZGxlRmVhdHVyZXNBZGRfKGV2dCkge1xuICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgICAgdGhpcy50aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IF90aGlzNC5jbG9uZTtcblxuICAgICAgICBpZiAoY2xvbmUgaW5zdGFuY2VvZiBuZ2VvUnVsZUdlb21ldHJ5KSB7XG4gICAgICAgICAgdmFyIGZlYXR1cmUgPSBjbG9uZS5mZWF0dXJlO1xuICAgICAgICAgIHZhciBkcmF3bkZlYXR1cmUgPSBldnQuZWxlbWVudDtcbiAgICAgICAgICB2YXIgZ2VvbWV0cnkgPSBkcmF3bkZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcbiAgICAgICAgICBjbG9uZS5nZW9tZXRyeSA9IGdlb21ldHJ5O1xuICAgICAgICAgIF90aGlzNC5kcmF3QWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgICB2YXIgcHJvcGVydGllcyA9IF90aGlzNC5uZ2VvRmVhdHVyZUhlbHBlcl8uZ2V0Tm9uU3BhdGlhbFByb3BlcnRpZXMoZHJhd25GZWF0dXJlKTtcblxuICAgICAgICAgIF90aGlzNC5uZ2VvRmVhdHVyZUhlbHBlcl8uY2xlYXJOb25TcGF0aWFsUHJvcGVydGllcyhmZWF0dXJlKTtcblxuICAgICAgICAgIGZlYXR1cmUuc2V0UHJvcGVydGllcyhwcm9wZXJ0aWVzKTtcblxuICAgICAgICAgIF90aGlzNC5uZ2VvRmVhdHVyZUhlbHBlcl8uc2V0U3R5bGUoZmVhdHVyZSwgdHJ1ZSk7XG5cbiAgICAgICAgICBfdGhpczQuc2NvcGVfLiRhcHBseSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmdldFJ1bGVHZW9tZXRyeVR5cGUgPSBmdW5jdGlvbiBnZXRSdWxlR2VvbWV0cnlUeXBlKCkge1xuICAgIHZhciBydWxlID0gdGhpcy5ydWxlO1xuXG4gICAgaWYgKHJ1bGUgaW5zdGFuY2VvZiBuZ2VvUnVsZUdlb21ldHJ5KSB7XG4gICAgICByZXR1cm4gdGhpcy5uZ2VvRmVhdHVyZUhlbHBlcl8uZ2V0VHlwZShydWxlLmZlYXR1cmUpO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVNYXBDb250ZXh0TWVudV8gPSBmdW5jdGlvbiBoYW5kbGVNYXBDb250ZXh0TWVudV8oZXZ0KSB7XG4gICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICBpZiAoZXZ0IGluc3RhbmNlb2YgRXZlbnQgfHwgZXZ0IGluc3RhbmNlb2YgVG91Y2hFdmVudCkge1xuICAgICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucmVtb3ZlTWVudV8oKTtcbiAgICAgIHZhciBwaXhlbCA9IHRoaXMubWFwLmdldEV2ZW50UGl4ZWwoZXZ0KTtcbiAgICAgIHZhciBjb29yZGluYXRlID0gdGhpcy5tYXAuZ2V0Q29vcmRpbmF0ZUZyb21QaXhlbChwaXhlbCk7XG4gICAgICB2YXIgZmVhdHVyZSA9IHRoaXMubWFwLmZvckVhY2hGZWF0dXJlQXRQaXhlbChwaXhlbCwgZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgICAgdmFyIHJldCA9IG51bGw7XG5cbiAgICAgICAgaWYgKCEoZmVhdHVyZSBpbnN0YW5jZW9mIEZlYXR1cmUpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBmZWF0dXJlIHR5cGUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChfdGhpczUuc2VsZWN0ZWRGZWF0dXJlcy5nZXRBcnJheSgpLmluY2x1ZGVzKGZlYXR1cmUpKSB7XG4gICAgICAgICAgcmV0ID0gZmVhdHVyZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmV0KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgICB9KTtcbiAgICAgIHZhciBhY3Rpb25zID0gW107XG5cbiAgICAgIGlmIChmZWF0dXJlKSB7XG4gICAgICAgIHZhciB0eXBlID0gdGhpcy5uZ2VvRmVhdHVyZUhlbHBlcl8uZ2V0VHlwZShmZWF0dXJlKTtcbiAgICAgICAgdmFyIGdldHRleHRDYXRhbG9nID0gdGhpcy5nZXR0ZXh0Q2F0YWxvZ187XG5cbiAgICAgICAgaWYgKHR5cGUgPT0gbmdlb0dlb21ldHJ5VHlwZS5DSVJDTEUgfHwgdHlwZSA9PSBuZ2VvR2VvbWV0cnlUeXBlLkxJTkVfU1RSSU5HIHx8IHR5cGUgPT0gbmdlb0dlb21ldHJ5VHlwZS5QT0xZR09OIHx8IHR5cGUgPT0gbmdlb0dlb21ldHJ5VHlwZS5SRUNUQU5HTEUpIHtcbiAgICAgICAgICBhY3Rpb25zLnB1c2goe1xuICAgICAgICAgICAgY2xzOiAnZmFzIGZhLWFycm93cy1hbHQnLFxuICAgICAgICAgICAgbGFiZWw6IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnTW92ZScpLFxuICAgICAgICAgICAgbmFtZTogJ21vdmUnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZSA9PSBuZ2VvR2VvbWV0cnlUeXBlLkxJTkVfU1RSSU5HIHx8IHR5cGUgPT0gbmdlb0dlb21ldHJ5VHlwZS5QT0xZR09OIHx8IHR5cGUgPT0gbmdlb0dlb21ldHJ5VHlwZS5SRUNUQU5HTEUpIHtcbiAgICAgICAgICBhY3Rpb25zLnB1c2goe1xuICAgICAgICAgICAgY2xzOiAnZmFzIGZhLXVuZG8gZmEtZmxpcC1ob3Jpem9udGFsJyxcbiAgICAgICAgICAgIGxhYmVsOiBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ1JvdGF0ZScpLFxuICAgICAgICAgICAgbmFtZTogJ3JvdGF0ZSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoYWN0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5tZW51XyA9IG5ldyBuZ2VvTWVudSh7XG4gICAgICAgICAgYWN0aW9uczogYWN0aW9uc1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5saXN0ZW5lcktleXNfLnB1c2gobGlzdGVuKHRoaXMubWVudV8sICdhY3Rpb25jbGljaycsIHRoaXMuaGFuZGxlTWVudUFjdGlvbkNsaWNrXywgdGhpcykpO1xuICAgICAgICB0aGlzLm1hcC5hZGRPdmVybGF5KHRoaXMubWVudV8pO1xuICAgICAgICB0aGlzLm1lbnVfLm9wZW4oY29vcmRpbmF0ZSk7XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlTWVudV8gPSBmdW5jdGlvbiByZW1vdmVNZW51XygpIHtcbiAgICBpZiAodGhpcy5tZW51Xykge1xuICAgICAgaWYgKCF0aGlzLm1hcCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwJyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubGlzdGVuZXJLZXlzXy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgICAgdGhpcy5tYXAucmVtb3ZlT3ZlcmxheSh0aGlzLm1lbnVfKTtcbiAgICAgIHRoaXMubWVudV8gPSBudWxsO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlTWVudUFjdGlvbkNsaWNrXyA9IGZ1bmN0aW9uIGhhbmRsZU1lbnVBY3Rpb25DbGlja18oZXZ0KSB7XG4gICAgdmFyIGFjdGlvbiA9IGV2dC5kZXRhaWwuYWN0aW9uO1xuXG4gICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgIGNhc2UgJ21vdmUnOlxuICAgICAgICB0aGlzLnRyYW5zbGF0ZV8uc2V0QWN0aXZlKHRydWUpO1xuICAgICAgICB0aGlzLnNjb3BlXy4kYXBwbHkoKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ3JvdGF0ZSc6XG4gICAgICAgIHRoaXMucm90YXRlXy5zZXRBY3RpdmUodHJ1ZSk7XG4gICAgICAgIHRoaXMuc2NvcGVfLiRhcHBseSgpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY29uc29sZS5sb2coXCJGSVhNRSAtIHN1cHBvcnQ6IFwiICsgYWN0aW9uKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVSb3RhdGVFbmRfID0gZnVuY3Rpb24gaGFuZGxlUm90YXRlRW5kXyhldnQpIHtcbiAgICB0aGlzLnJvdGF0ZV8uc2V0QWN0aXZlKGZhbHNlKTtcbiAgICB0aGlzLnNjb3BlXy4kYXBwbHkoKTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlVHJhbnNsYXRlRW5kXyA9IGZ1bmN0aW9uIGhhbmRsZVRyYW5zbGF0ZUVuZF8oZXZ0KSB7XG4gICAgdGhpcy50cmFuc2xhdGVfLnNldEFjdGl2ZShmYWxzZSk7XG4gICAgdGhpcy5zY29wZV8uJGFwcGx5KCk7XG4gIH07XG5cbiAgcmV0dXJuIFJ1bGVDb250cm9sbGVyO1xufSgpO1xuXG5tb2R1bGUuY29tcG9uZW50KCduZ2VvUnVsZScsIHtcbiAgYmluZGluZ3M6IHtcbiAgICAnZmVhdHVyZU92ZXJsYXknOiAnPCcsXG4gICAgJ21hcCc6ICc8JyxcbiAgICAncnVsZSc6ICc8JyxcbiAgICAndG9vbEdyb3VwJzogJzwnXG4gIH0sXG4gIGNvbnRyb2xsZXI6IFJ1bGVDb250cm9sbGVyLFxuICB0ZW1wbGF0ZVVybDogbmdlb1J1bGVUZW1wbGF0ZVVybFxufSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdiBjbGFzcz1cImRyb3Bkb3duXCI+XFxuICA8YnV0dG9uXFxuICAgICAgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtIGJ0bi1ibG9jayBkcm9wZG93bi10b2dnbGVcIlxcbiAgICAgIHR5cGU9XCJidXR0b25cIlxcbiAgICAgIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIlxcbiAgICAgIG5nLWNsaWNrPVwiJGN0cmwudG9nZ2xlKClcIj5cXG4gICAgPHNwYW4+e3sgOjokY3RybC5jbG9uZS5uYW1lIHwgdHJhbnNsYXRlIH19PC9zcGFuPlxcbiAgPC9idXR0b24+XFxuICA8ZGl2XFxuICAgIGNsYXNzPVwiZHJvcGRvd24tbWVudSBmb3JtLWdyb3VwXCJcXG4gICAgbmctY2xhc3M9XCJ7c2hvdzogJGN0cmwucnVsZS5hY3RpdmV9XCI+XFxuXFxuICAgIDxzZWxlY3RcXG4gICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sIG5nZW8tcnVsZS1vcGVyYXRvcnMtbGlzdFwiXFxuICAgICAgICBuZy1pZj1cIjo6JGN0cmwuY2xvbmUub3BlcmF0b3JzXCJcXG4gICAgICAgIG5nLW1vZGVsPVwiJGN0cmwuY2xvbmUub3BlcmF0b3JcIlxcbiAgICAgICAgbmctb3B0aW9ucz1cIiRjdHJsLm9wZXJhdG9yc1tvcGVyYXRvcl0gfCB0cmFuc2xhdGUgZm9yIG9wZXJhdG9yIGluIDo6JGN0cmwuY2xvbmUub3BlcmF0b3JzIHRyYWNrIGJ5IG9wZXJhdG9yXCI+XFxuICAgIDwvc2VsZWN0PlxcblxcbiAgICA8ZGl2IG5nLXN3aXRjaD1cIjo6JGN0cmwuY2xvbmUudHlwZVwiPlxcblxcbiAgICAgIDxkaXZcXG4gICAgICAgICAgY2xhc3M9XCJuZ2VvLXJ1bGUtdHlwZS1kYXRlIGZvcm0tZ3JvdXBcIlxcbiAgICAgICAgICBuZy1pZj1cIiRjdHJsLnJ1bGUuYWN0aXZlXCJcXG4gICAgICAgICAgbmctc3dpdGNoLXdoZW49XCJkYXRlfGRhdGV0aW1lXCJcXG4gICAgICAgICAgbmctc3dpdGNoLXdoZW4tc2VwYXJhdG9yPVwifFwiPlxcbiAgICAgICAgPGRpdiBuZy1zd2l0Y2g9XCIkY3RybC5jbG9uZS5vcGVyYXRvclwiPlxcbiAgICAgICAgICA8ZGl2IG5nLXN3aXRjaC13aGVuPVwiLi58dGltZV9kdXJpbmdcIiBuZy1zd2l0Y2gtd2hlbi1zZXBhcmF0b3I9XCJ8XCI+XFxuICAgICAgICAgICAgPG5nZW8tZGF0ZS1waWNrZXJcXG4gICAgICAgICAgICAgICAgdGltZT1cIiRjdHJsLnRpbWVSYW5nZU1vZGVcIlxcbiAgICAgICAgICAgICAgICBvbi1kYXRlLXNlbGVjdGVkPVwiJGN0cmwub25EYXRlUmFuZ2VTZWxlY3RlZCh0aW1lKVwiPlxcbiAgICAgICAgICAgIDwvbmdlby1kYXRlLXBpY2tlcj5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgIDxkaXYgbmctc3dpdGNoLWRlZmF1bHQ+XFxuICAgICAgICAgICAgPG5nZW8tZGF0ZS1waWNrZXJcXG4gICAgICAgICAgICAgICAgdGltZT1cIiRjdHJsLnRpbWVWYWx1ZU1vZGVcIlxcbiAgICAgICAgICAgICAgICBvbi1kYXRlLXNlbGVjdGVkPVwiJGN0cmwub25EYXRlU2VsZWN0ZWQodGltZSlcIj5cXG4gICAgICAgICAgICA8L25nZW8tZGF0ZS1waWNrZXI+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuXFxuICAgICAgPGRpdlxcbiAgICAgICAgICBjbGFzcz1cIm5nZW8tcnVsZS10eXBlLWdlb21ldHJ5IGZvcm0tZ3JvdXBcIlxcbiAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cImdlb21ldHJ5XCI+XFxuICAgICAgICA8ZGl2IG5nLXN3aXRjaD1cIiRjdHJsLmdlb21UeXBlXCI+XFxuICAgICAgICAgIDxzcGFuXFxuICAgICAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cIlBvaW50XCI+XFxuICAgICAgICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL3BvaW50LnN2ZycpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgPHNwYW5cXG4gICAgICAgICAgICAgIG5nLXN3aXRjaC13aGVuPVwiTGluZVN0cmluZ1wiPlxcbiAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9saW5lLnN2ZycpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgPHNwYW5cXG4gICAgICAgICAgICAgIG5nLXN3aXRjaC13aGVuPVwiUG9seWdvblwiPlxcbiAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9wb2x5Z29uLnN2ZycpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgPHNwYW5cXG4gICAgICAgICAgICAgIG5nLXN3aXRjaC13aGVuPVwiQ2lyY2xlXCI+XFxuICAgICAgICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL2NpcmNsZS5zdmcnKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgICAgICAgICA8L3NwYW4+XFxuICAgICAgICAgIDxzcGFuXFxuICAgICAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cIlJlY3RhbmdsZVwiPlxcbiAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9yZWN0YW5nbGUuc3ZnJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbidcXG4gICAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8bmdlby1kcmF3ZmVhdHVyZVxcbiAgICAgICAgICAgIG5nZW8tZHJhd2ZlYXR1cmUtYWN0aXZlPVwiJGN0cmwuZHJhd0FjdGl2ZVwiXFxuICAgICAgICAgICAgbmdlby1kcmF3ZmVhdHVyZS1mZWF0dXJlcz1cIiRjdHJsLmRyYXduRmVhdHVyZXNcIlxcbiAgICAgICAgICAgIG5nZW8tZHJhd2ZlYXR1cmUtbWFwPVwiJGN0cmwubWFwXCI+XFxuICAgICAgICAgIDxkaXZcXG4gICAgICAgICAgICAgIG5nZW8tYnRuLWdyb3VwXFxuICAgICAgICAgICAgICBjbGFzcz1cImJ0bi1ncm91cFwiPlxcbiAgICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgICAgICAgICAgICAgdGl0bGU9XCJ7e1xcJ0RyYXcgYSBwb2ludCBvbiB0aGUgbWFwXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICAgICAgICAgICAgICBocmVmXFxuICAgICAgICAgICAgICAgIG5nZW8tYnRuXFxuICAgICAgICAgICAgICAgIG5nZW8tZHJhd3BvaW50XFxuICAgICAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCBuZ2VvLWRyYXdmZWF0dXJlLXBvaW50XCJcXG4gICAgICAgICAgICAgICAgbmctc2hvdz1cIltcXCdpbnRlcnNlY3RzXFwnLCBcXCd3aXRoaW5cXCddLmluZGV4T2YoJGN0cmwuY2xvbmUub3BlcmF0b3IpICE9PSAtMVwiXFxuICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwie2FjdGl2ZTogZGZDdHJsLmRyYXdQb2ludC5hY3RpdmV9XCJcXG4gICAgICAgICAgICAgICAgbmctbW9kZWw9XCJkZkN0cmwuZHJhd1BvaW50LmFjdGl2ZVwiPlxcbiAgICAgICAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9wb2ludC5zdmcnKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgICAgICAgICAgICAgPC9hPlxcbiAgICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgICAgICAgICAgICAgdGl0bGU9XCJ7e1xcJ0RyYXcgYSBsaW5lIG9uIHRoZSBtYXBcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgICAgICAgICAgICAgIGhyZWZcXG4gICAgICAgICAgICAgICAgbmdlby1idG5cXG4gICAgICAgICAgICAgICAgbmdlby1tZWFzdXJlbGVuZ3RoXFxuICAgICAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCBuZ2VvLWRyYXdmZWF0dXJlLWxpbmVzdHJpbmdcIlxcbiAgICAgICAgICAgICAgICBuZy1zaG93PVwiW1xcJ2ludGVyc2VjdHNcXCcsIFxcJ3dpdGhpblxcJ10uaW5kZXhPZigkY3RybC5jbG9uZS5vcGVyYXRvcikgIT09IC0xXCJcXG4gICAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7YWN0aXZlOiBkZkN0cmwubWVhc3VyZUxlbmd0aC5hY3RpdmV9XCJcXG4gICAgICAgICAgICAgICAgbmctbW9kZWw9XCJkZkN0cmwubWVhc3VyZUxlbmd0aC5hY3RpdmVcIj5cXG4gICAgICAgICAgICAgICAgJyArXG4oKF9fdCA9IChyZXF1aXJlKCdnbWYvaWNvbnMvbGluZS5zdmcnKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgICAgICAgICAgICAgPC9hPlxcbiAgICAgICAgICAgICAgPGFcXG4gICAgICAgICAgICAgICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgICAgICAgICAgICAgdGl0bGU9XCJ7e1xcJ0RyYXcgYSBwb2x5Z29uIG9uIHRoZSBtYXBcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgICAgICAgICAgICAgIGhyZWZcXG4gICAgICAgICAgICAgICAgbmdlby1idG5cXG4gICAgICAgICAgICAgICAgbmdlby1tZWFzdXJlYXJlYVxcbiAgICAgICAgICAgICAgICBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRlZmF1bHQgbmdlby1kcmF3ZmVhdHVyZS1wb2x5Z29uXCJcXG4gICAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7YWN0aXZlOiBkZkN0cmwubWVhc3VyZUFyZWEuYWN0aXZlfVwiXFxuICAgICAgICAgICAgICAgIG5nLW1vZGVsPVwiZGZDdHJsLm1lYXN1cmVBcmVhLmFjdGl2ZVwiPlxcbiAgICAgICAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9wb2x5Z29uLnN2ZycpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICAgICAgICAgICAgICA8L2E+XFxuICAgICAgICAgICAgICA8YVxcbiAgICAgICAgICAgICAgICBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIlxcbiAgICAgICAgICAgICAgICB0aXRsZT1cInt7XFwnRHJhdyBhIGNpcmNsZSBvbiB0aGUgbWFwXFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICAgICAgICAgICAgICBocmVmXFxuICAgICAgICAgICAgICAgIG5nZW8tYnRuXFxuICAgICAgICAgICAgICAgIG5nZW8tbWVhc3VyZWF6aW11dFxcbiAgICAgICAgICAgICAgICBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRlZmF1bHQgbmdlby1kcmF3ZmVhdHVyZS1jaXJjbGVcIlxcbiAgICAgICAgICAgICAgICBuZy1jbGFzcz1cInthY3RpdmU6IGRmQ3RybC5tZWFzdXJlQXppbXV0LmFjdGl2ZX1cIlxcbiAgICAgICAgICAgICAgICBuZy1tb2RlbD1cImRmQ3RybC5tZWFzdXJlQXppbXV0LmFjdGl2ZVwiPlxcbiAgICAgICAgICAgICAgICAnICtcbigoX190ID0gKHJlcXVpcmUoJ2dtZi9pY29ucy9jaXJjbGUuc3ZnJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbidcXG4gICAgICAgICAgICAgIDwvYT5cXG4gICAgICAgICAgICAgIDxhXFxuICAgICAgICAgICAgICAgIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXFxuICAgICAgICAgICAgICAgIHRpdGxlPVwie3tcXCdEcmF3IGEgcmVjdGFuZ2xlIG9uIHRoZSBtYXBcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgICAgICAgICAgICAgIGhyZWZcXG4gICAgICAgICAgICAgICAgbmdlby1idG5cXG4gICAgICAgICAgICAgICAgbmdlby1kcmF3cmVjdGFuZ2xlXFxuICAgICAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCBuZ2VvLWRyYXdmZWF0dXJlLXJlY3RhbmdsZVwiXFxuICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwie2FjdGl2ZTogZGZDdHJsLmRyYXdSZWN0YW5nbGUuYWN0aXZlfVwiXFxuICAgICAgICAgICAgICAgIG5nLW1vZGVsPVwiZGZDdHJsLmRyYXdSZWN0YW5nbGUuYWN0aXZlXCI+XFxuICAgICAgICAgICAgICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnZ21mL2ljb25zL3JlY3RhbmdsZS5zdmcnKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgICAgICAgICAgICAgPC9hPlxcbiAgICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgICAgPGRpdlxcbiAgICAgICAgICAgICAgY2xhc3M9XCJuZ2VvLXJ1bGUtdHlwZS1nZW9tZXRyeS1pbnN0cnVjdGlvbnNcIlxcbiAgICAgICAgICAgICAgbmctaWY9XCIkY3RybC5kcmF3QWN0aXZlXCI+XFxuICAgICAgICAgICAgPHNwYW4gbmctaWY9XCJkZkN0cmwuZHJhd1BvaW50LmFjdGl2ZVwiPlxcbiAgICAgICAgICAgICAge3sgXFwnRHJhdyBhIHBvaW50IG9uIHRoZSBtYXAuXFwnIHwgdHJhbnNsYXRlIH19XFxuICAgICAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgICAgIDxzcGFuIG5nLWlmPVwiZGZDdHJsLm1lYXN1cmVMZW5ndGguYWN0aXZlXCI+XFxuICAgICAgICAgICAgICB7eyBcXCdEcmF3IGEgbGluZSBzdHJpbmcgb24gdGhlIG1hcC5cXCcgfCB0cmFuc2xhdGUgfX1cXG4gICAgICAgICAgICA8L3NwYW4+XFxuICAgICAgICAgICAgPHNwYW4gbmctaWY9XCJkZkN0cmwubWVhc3VyZUFyZWEuYWN0aXZlXCI+XFxuICAgICAgICAgICAgICB7eyBcXCdEcmF3IGEgcG9seWdvbiBvbiB0aGUgbWFwLlxcJyB8IHRyYW5zbGF0ZSB9fVxcbiAgICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgICA8c3BhbiBuZy1pZj1cImRmQ3RybC5tZWFzdXJlQXppbXV0LmFjdGl2ZVwiPlxcbiAgICAgICAgICAgICAge3sgXFwnRHJhdyBhIGNpcmNsZSBvbiB0aGUgbWFwLlxcJyB8IHRyYW5zbGF0ZSB9fVxcbiAgICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgICA8c3BhbiBuZy1pZj1cImRmQ3RybC5kcmF3UmVjdGFuZ2xlLmFjdGl2ZVwiPlxcbiAgICAgICAgICAgICAge3sgXFwnRHJhdyBhIHJlY3RhbmdsZSBvbiB0aGUgbWFwLlxcJyB8IHRyYW5zbGF0ZSB9fVxcbiAgICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L25nZW8tZHJhd2ZlYXR1cmU+XFxuICAgICAgPC9kaXY+XFxuXFxuICAgICAgPGRpdlxcbiAgICAgICAgICBjbGFzcz1cImNoZWNrYm94IG5nZW8tcnVsZS10eXBlLXNlbGVjdFwiXFxuICAgICAgICAgIG5nLXN3aXRjaC13aGVuPVwic2VsZWN0XCI+XFxuICAgICAgICA8YVxcbiAgICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuc2VsZWN0QWxsQ2hvaWNlcygpXCJcXG4gICAgICAgICAgICBocmVmPnt7IEFsbCB8IHRyYW5zbGF0ZX19XFxuICAgICAgICA8L2E+XFxuICAgICAgICA8bGFiZWxcXG4gICAgICAgICAgICBjbGFzcz1cImZvcm0tZ3JvdXAgb2wtdW5zZWxlY3RhYmxlXCJcXG4gICAgICAgICAgICBuZy1yZXBlYXQ9XCJjaG9pY2UgaW4gOjokY3RybC5jbG9uZS5jaG9pY2VzXCI+XFxuICAgICAgICAgIDxpbnB1dFxcbiAgICAgICAgICAgICAgbmctY2hlY2tlZD1cIiRjdHJsLmNsb25lLmdldEV4cHJlc3Npb24oKSAmJiAkY3RybC5jbG9uZS5nZXRFeHByZXNzaW9uKCkuc3BsaXQoXFwnLFxcJykuaW5kZXhPZihjaG9pY2UpID4gLTFcIlxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCIkY3RybC50b2dnbGVDaG9pY2VTZWxlY3Rpb24oY2hvaWNlKVwiXFxuICAgICAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxcbiAgICAgICAgICAgICAgdmFsdWU9XCJjaG9pY2VcIiAvPlxcbiAgICAgICAgICA8c3Bhbj57eyBjaG9pY2UgfCB0cmFuc2xhdGUgfX08L3NwYW4+XFxuICAgICAgICA8L2xhYmVsPlxcblxcbiAgICAgIDwvZGl2PlxcblxcbiAgICAgIDxkaXZcXG4gICAgICAgICAgY2xhc3M9XCJmb3JtLWdyb3VwIG5nZW8tcnVsZS10eXBlLXRleHRcIlxcbiAgICAgICAgICBuZy1zd2l0Y2gtZGVmYXVsdD5cXG4gICAgICAgIDxkaXYgbmctc3dpdGNoPVwiJGN0cmwuY2xvbmUub3BlcmF0b3JcIj5cXG4gICAgICAgICAgPGRpdiBuZy1zd2l0Y2gtd2hlbj1cIi4uXCI+XFxuICAgICAgICAgICAgPGlucHV0XFxuICAgICAgICAgICAgICAgIHR5cGU9XCJudW1iZXJcIlxcbiAgICAgICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXFxuICAgICAgICAgICAgICAgIG5nLW1vZGVsPVwiJGN0cmwuY2xvbmUubG93ZXJCb3VuZGFyeVwiLz5cXG4gICAgICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXFxuICAgICAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgICAgICAgbmctbW9kZWw9XCIkY3RybC5jbG9uZS51cHBlckJvdW5kYXJ5XCIvPlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgPGRpdiBuZy1zd2l0Y2gtZGVmYXVsdD5cXG4gICAgICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXFxuICAgICAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcXG4gICAgICAgICAgICAgICAgbmctaWY9XCIkY3RybC5jbG9uZS50eXBlID09PSBcXCdudW1iZXJcXCdcIlxcbiAgICAgICAgICAgICAgICBuZy1tb2RlbD1cIiRjdHJsLmNsb25lLmV4cHJlc3Npb25cIi8+XFxuICAgICAgICAgICAgPGlucHV0XFxuICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxcbiAgICAgICAgICAgICAgICBuZy1pZj1cIiRjdHJsLmNsb25lLnR5cGUgIT09IFxcJ251bWJlclxcJ1wiXFxuICAgICAgICAgICAgICAgIG5nLW1vZGVsPVwiJGN0cmwuY2xvbmUuZXhwcmVzc2lvblwiLz5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG5cXG4gICAgICA8ZGl2IGNsYXNzPVwibmdlby1ydWxlLWJ0bnNcIj5cXG4gICAgICAgIDxidXR0b25cXG4gICAgICAgICAgICBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRlZmF1bHRcIlxcbiAgICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuYXBwbHkoKVwiXFxuICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiPnt7XFwnQXBwbHlcXCcgfCB0cmFuc2xhdGV9fTwvYnV0dG9uPlxcbiAgICAgICAgPGJ1dHRvblxcbiAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdFwiXFxuICAgICAgICAgICAgbmctY2xpY2s9XCIkY3RybC5jYW5jZWwoKVwiXFxuICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiPnt7XFwnQ2FuY2VsXFwnIHwgdHJhbnNsYXRlfX08L2J1dHRvbj5cXG4gICAgICA8L2Rpdj5cXG5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG48L2Rpdj5cXG5cXG5cXG48ZGl2XFxuICAgIGNsYXNzPVwibmdlby1ydWxlLXZhbHVlXCJcXG4gICAgbmctaWY9XCIkY3RybC5ydWxlLnZhbHVlICE9PSBudWxsXCI+XFxuXFxuICA8YVxcbiAgICAgIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tbGlua1wiXFxuICAgICAgbmctY2xpY2s9XCIhJGN0cmwucnVsZS5hY3RpdmUgJiYgJGN0cmwucmVzZXQoKVwiXFxuICAgICAgbmctZGlzYWJsZWQ9XCIkY3RybC5ydWxlLmFjdGl2ZVwiXFxuICAgICAgaHJlZj5cXG4gICAgPHNwYW4gY2xhc3M9XCJmYSBmYS10aW1lc1wiPjwvc3Bhbj5cXG4gIDwvYT5cXG5cXG4gIDxkaXYgbmctc3dpdGNoPVwiOjokY3RybC5ydWxlLnR5cGVcIj5cXG5cXG4gICAgPGRpdlxcbiAgICAgICAgbmctc3dpdGNoLXdoZW49XCJkYXRlfGRhdGV0aW1lXCJcXG4gICAgICAgIG5nLXN3aXRjaC13aGVuLXNlcGFyYXRvcj1cInxcIj5cXG4gICAgICA8ZGl2IG5nLXN3aXRjaD1cIiRjdHJsLnJ1bGUub3BlcmF0b3JcIj5cXG4gICAgICAgIDxkaXYgbmctc3dpdGNoLXdoZW49XCIuLnx0aW1lX2R1cmluZ1wiIG5nLXN3aXRjaC13aGVuLXNlcGFyYXRvcj1cInxcIj5cXG4gICAgICAgICAgPHNwYW4gdHJhbnNsYXRlPkZyb20gPC9zcGFuPlxcbiAgICAgICAgICA8c3Bhbj57eyAkY3RybC50aW1lVG9EYXRlKCRjdHJsLnJ1bGUubG93ZXJCb3VuZGFyeSkgfX08L3NwYW4+XFxuICAgICAgICAgIDxzcGFuIHRyYW5zbGF0ZT4gdG8gPC9zcGFuPlxcbiAgICAgICAgICA8c3Bhbj57eyAkY3RybC50aW1lVG9EYXRlKCRjdHJsLnJ1bGUudXBwZXJCb3VuZGFyeSkgfX08L3NwYW4+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDxkaXYgbmctc3dpdGNoLWRlZmF1bHQ+XFxuICAgICAgICAgIDxzcGFuPnt7ICRjdHJsLm9wZXJhdG9yc1Nob3J0Rm9ybWF0WyRjdHJsLnJ1bGUub3BlcmF0b3JdIH19PC9zcGFuPlxcbiAgICAgICAgICA8c3Bhbj57eyAkY3RybC50aW1lVG9EYXRlKCRjdHJsLnJ1bGUuZ2V0RXhwcmVzc2lvbigpKSB9fTwvc3Bhbj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG5cXG4gICAgPGRpdiBuZy1zd2l0Y2gtd2hlbj1cImdlb21ldHJ5XCI+XFxuICAgICAgPHNwYW4+e3sgJGN0cmwub3BlcmF0b3JzWyRjdHJsLnJ1bGUub3BlcmF0b3JdIH19PC9zcGFuPlxcbiAgICAgIDxzcGFuIG5nLXN3aXRjaD1cIiRjdHJsLmdldFJ1bGVHZW9tZXRyeVR5cGUoKVwiPlxcbiAgICAgICAgPHNwYW5cXG4gICAgICAgICAgICBjbGFzcz1cImdtZi1pY29uIGdtZi1pY29uLXBvaW50XCJcXG4gICAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cIlBvaW50XCI+XFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgICA8c3BhblxcbiAgICAgICAgICAgIGNsYXNzPVwiZ21mLWljb24gZ21mLWljb24tbGluZVwiXFxuICAgICAgICAgICAgbmctc3dpdGNoLXdoZW49XCJMaW5lU3RyaW5nXCI+XFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgICA8c3BhblxcbiAgICAgICAgICAgIGNsYXNzPVwiZ21mLWljb24gZ21mLWljb24tcG9seWdvblwiXFxuICAgICAgICAgICAgbmctc3dpdGNoLXdoZW49XCJQb2x5Z29uXCI+XFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgICA8c3BhblxcbiAgICAgICAgICAgIGNsYXNzPVwiZ21mLWljb24gZ21mLWljb24tY2lyY2xlXCJcXG4gICAgICAgICAgICBuZy1zd2l0Y2gtd2hlbj1cIkNpcmNsZVwiPlxcbiAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgPHNwYW5cXG4gICAgICAgICAgICBjbGFzcz1cImdtZi1pY29uIGdtZi1pY29uLXJlY3RhbmdsZVwiXFxuICAgICAgICAgICAgbmctc3dpdGNoLXdoZW49XCJSZWN0YW5nbGVcIj5cXG4gICAgICAgIDwvc3Bhbj5cXG4gICAgICA8L3NwYW4+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8ZGl2IG5nLXN3aXRjaC13aGVuPVwic2VsZWN0XCI+XFxuICAgICAgPHNwYW4gbmctcmVwZWF0PVwiY2hvaWNlIGluICRjdHJsLnJ1bGUuZ2V0RXhwcmVzc2lvbigpLnNwbGl0KFxcJyxcXCcpXCI+XFxuICAgICAgICB7eyBjaG9pY2UgfCB0cmFuc2xhdGUgfX17eyAkbGFzdCA/IFxcJ1xcJyA6IFxcJywgXFwnIH19XFxuICAgICAgPC9zcGFuPlxcbiAgICA8L2Rpdj5cXG5cXG4gICAgPGRpdiBuZy1zd2l0Y2gtZGVmYXVsdD5cXG4gICAgICA8ZGl2IG5nLXN3aXRjaD1cIiRjdHJsLnJ1bGUub3BlcmF0b3JcIj5cXG4gICAgICAgIDxkaXYgbmctc3dpdGNoLXdoZW49XCIuLnx0aW1lX2R1cmluZ1wiIG5nLXN3aXRjaC13aGVuLXNlcGFyYXRvcj1cInxcIj5cXG4gICAgICAgICAgPHNwYW4gdHJhbnNsYXRlPkJldHdlZW4gPC9zcGFuPlxcbiAgICAgICAgICA8c3Bhbj57eyAkY3RybC5ydWxlLmxvd2VyQm91bmRhcnkgfX08L3NwYW4+XFxuICAgICAgICAgIDxzcGFuIHRyYW5zbGF0ZT4gYW5kIDwvc3Bhbj5cXG4gICAgICAgICAgPHNwYW4+e3sgJGN0cmwucnVsZS51cHBlckJvdW5kYXJ5IH19PC9zcGFuPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IG5nLXN3aXRjaC1kZWZhdWx0PlxcbiAgICAgICAgICA8c3Bhbj57eyAkY3RybC5vcGVyYXRvcnNTaG9ydEZvcm1hdFskY3RybC5ydWxlLm9wZXJhdG9yXSB9fTwvc3Bhbj5cXG4gICAgICAgICAgPHNwYW4+e3sgJGN0cmwucnVsZS5nZXRFeHByZXNzaW9uKCkgfX08L3NwYW4+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuXFxuICA8L2Rpdj5cXG48L2Rpdj5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCB7IGluY2x1ZGVzIGFzIG9sQXJyYXlJbmNsdWRlcyB9IGZyb20gJ29sL2FycmF5LmpzJztcbmltcG9ydCBvbEZvcm1hdEdlb0pTT04gZnJvbSAnb2wvZm9ybWF0L0dlb0pTT04uanMnO1xudmFyIGxheWVySWRlbnRpZmllciA9ICdsYXllck5hbWUnO1xuXG52YXIgQXJjR0lTR2VvSlNPTiA9IGZ1bmN0aW9uIChfb2xGb3JtYXRHZW9KU09OKSB7XG4gIF9pbmhlcml0c0xvb3NlKEFyY0dJU0dlb0pTT04sIF9vbEZvcm1hdEdlb0pTT04pO1xuXG4gIGZ1bmN0aW9uIEFyY0dJU0dlb0pTT04ob3B0X29wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgb3B0aW9ucyA9IG9wdF9vcHRpb25zID8gb3B0X29wdGlvbnMgOiB7fTtcbiAgICBfdGhpcyA9IF9vbEZvcm1hdEdlb0pTT04uY2FsbCh0aGlzLCBvcHRfb3B0aW9ucykgfHwgdGhpcztcbiAgICBfdGhpcy5sYXllcnNfID0gb3B0aW9ucy5sYXllcnMgPyBvcHRpb25zLmxheWVycyA6IG51bGw7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IEFyY0dJU0dlb0pTT04ucHJvdG90eXBlO1xuXG4gIF9wcm90by5nZXRMYXllcnMgPSBmdW5jdGlvbiBnZXRMYXllcnMoKSB7XG4gICAgcmV0dXJuIHRoaXMubGF5ZXJzXztcbiAgfTtcblxuICBfcHJvdG8uc2V0TGF5ZXJzID0gZnVuY3Rpb24gc2V0TGF5ZXJzKGxheWVycykge1xuICAgIHRoaXMubGF5ZXJzXyA9IGxheWVycztcbiAgfTtcblxuICBfcHJvdG8ucmVhZEZlYXR1cmVzRnJvbU9iamVjdCA9IGZ1bmN0aW9uIHJlYWRGZWF0dXJlc0Zyb21PYmplY3Qob2JqZWN0LCBvcHRfb3B0aW9ucykge1xuICAgIHZhciBnZW9KU09OT2JqZWN0ID0gb2JqZWN0O1xuICAgIHZhciBmZWF0dXJlcyA9IFtdO1xuICAgIHZhciBnZW9KU09ORmVhdHVyZXMgPSBudWxsO1xuXG4gICAgaWYgKGdlb0pTT05PYmplY3RbJ3R5cGUnXSA9PT0gJ0ZlYXR1cmVDb2xsZWN0aW9uJykge1xuICAgICAgdmFyIGdlb0pTT05GZWF0dXJlQ29sbGVjdGlvbiA9IG9iamVjdDtcbiAgICAgIGdlb0pTT05GZWF0dXJlcyA9IGdlb0pTT05GZWF0dXJlQ29sbGVjdGlvblsnZmVhdHVyZXMnXTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VvSlNPTkZlYXR1cmVzID0gW29iamVjdF07XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZ2VvSlNPTkZlYXR1cmVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIHZhciBsYXllck5hbWUgPSBnZW9KU09ORmVhdHVyZXNbaV1bbGF5ZXJJZGVudGlmaWVyXTtcblxuICAgICAgaWYgKHRoaXMubGF5ZXJzXyAmJiAhb2xBcnJheUluY2x1ZGVzKHRoaXMubGF5ZXJzXywgbGF5ZXJOYW1lKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgZmVhdHVyZXMucHVzaCh0aGlzLnJlYWRGZWF0dXJlRnJvbU9iamVjdChnZW9KU09ORmVhdHVyZXNbaV0sIG9wdF9vcHRpb25zKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZlYXR1cmVzO1xuICB9O1xuXG4gIHJldHVybiBBcmNHSVNHZW9KU09OO1xufShvbEZvcm1hdEdlb0pTT04pO1xuXG5leHBvcnQgZGVmYXVsdCBBcmNHSVNHZW9KU09OOyIsImltcG9ydCBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZSBmcm9tICduZ2VvL2Zvcm1hdC9BdHRyaWJ1dGVUeXBlLmpzJztcbmV4cG9ydCBmdW5jdGlvbiBzZXRHZW9tZXRyeVR5cGUoYXR0cmlidXRlLCB0eXBlKSB7XG4gIHZhciBnZW9tUmVnZXggPSAvZ21sOigoTXVsdGkpPyhQb2ludHxMaW5lfFBvbHlnb258Q3VydmV8U3VyZmFjZXxHZW9tZXRyeSkpLiovO1xuXG4gIGlmIChnZW9tUmVnZXguZXhlYyh0eXBlKSkge1xuICAgIGF0dHJpYnV0ZS50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuR0VPTUVUUlk7XG5cbiAgICBpZiAoL15nbWw6UG9pbnQvLmV4ZWModHlwZSkpIHtcbiAgICAgIGF0dHJpYnV0ZS5nZW9tVHlwZSA9ICdQb2ludCc7XG4gICAgfSBlbHNlIGlmICgvXmdtbDpMaW5lU3RyaW5nfF5nbWw6Q3VydmUvLmV4ZWModHlwZSkpIHtcbiAgICAgIGF0dHJpYnV0ZS5nZW9tVHlwZSA9ICdMaW5lU3RyaW5nJztcbiAgICB9IGVsc2UgaWYgKC9eZ21sOlBvbHlnb258XmdtbDpTdXJmYWNlLy5leGVjKHR5cGUpKSB7XG4gICAgICBhdHRyaWJ1dGUuZ2VvbVR5cGUgPSAnUG9seWdvbic7XG4gICAgfSBlbHNlIGlmICgvXmdtbDpNdWx0aVBvaW50Ly5leGVjKHR5cGUpKSB7XG4gICAgICBhdHRyaWJ1dGUuZ2VvbVR5cGUgPSAnTXVsdGlQb2ludCc7XG4gICAgfSBlbHNlIGlmICgvXmdtbDpNdWx0aUxpbmVTdHJpbmd8XmdtbDpNdWx0aUN1cnZlLy5leGVjKHR5cGUpKSB7XG4gICAgICBhdHRyaWJ1dGUuZ2VvbVR5cGUgPSAnTXVsdGlMaW5lU3RyaW5nJztcbiAgICB9IGVsc2UgaWYgKC9eZ21sOk11bHRpUG9seWdvbnxeZ21sOk11bHRpU3VyZmFjZS8uZXhlYyh0eXBlKSkge1xuICAgICAgYXR0cmlidXRlLmdlb21UeXBlID0gJ011bHRpUG9seWdvbic7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuICEhYXR0cmlidXRlLnR5cGUgJiYgISFhdHRyaWJ1dGUuZ2VvbVR5cGU7XG59XG5leHBvcnQgZGVmYXVsdCBudWxsOyIsImV4cG9ydCBkZWZhdWx0IHtcbiAgQk9PTEVBTjogJ2Jvb2xlYW4nLFxuICBEQVRFOiAnZGF0ZScsXG4gIERBVEVUSU1FOiAnZGF0ZXRpbWUnLFxuICBUSU1FOiAndGltZScsXG4gIEdFT01FVFJZOiAnZ2VvbWV0cnknLFxuICBOVU1CRVI6ICdudW1iZXInLFxuICBTRUxFQ1Q6ICdzZWxlY3QnLFxuICBURVhUOiAndGV4dCdcbn07IiwiZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMgZnJvbSAnbmdlby9mb3JtYXQvRmVhdHVyZVByb3BlcnRpZXMuanMnO1xuaW1wb3J0IG5nZW9Gb3JtYXRGZWF0dXJlSGFzaFN0eWxlVHlwZSBmcm9tICduZ2VvL2Zvcm1hdC9GZWF0dXJlSGFzaFN0eWxlVHlwZS5qcyc7XG5pbXBvcnQgeyByZ2JBcnJheVRvSGV4IH0gZnJvbSAnbmdlby91dGlscy5qcyc7XG5pbXBvcnQgeyBhc0FycmF5IGFzIGFzQ29sb3JBcnJheSB9IGZyb20gJ29sL2NvbG9yLmpzJztcbmltcG9ydCBvbEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyB0cmFuc2Zvcm1HZW9tZXRyeVdpdGhPcHRpb25zIH0gZnJvbSAnb2wvZm9ybWF0L0ZlYXR1cmUuanMnO1xuaW1wb3J0IG9sRm9ybWF0VGV4dEZlYXR1cmUgZnJvbSAnb2wvZm9ybWF0L1RleHRGZWF0dXJlLmpzJztcbmltcG9ydCBvbEdlb21HZW9tZXRyeUxheW91dCBmcm9tICdvbC9nZW9tL0dlb21ldHJ5TGF5b3V0LmpzJztcbmltcG9ydCBvbEdlb21MaW5lU3RyaW5nIGZyb20gJ29sL2dlb20vTGluZVN0cmluZy5qcyc7XG5pbXBvcnQgb2xHZW9tTXVsdGlMaW5lU3RyaW5nIGZyb20gJ29sL2dlb20vTXVsdGlMaW5lU3RyaW5nLmpzJztcbmltcG9ydCBvbEdlb21NdWx0aVBvaW50IGZyb20gJ29sL2dlb20vTXVsdGlQb2ludC5qcyc7XG5pbXBvcnQgb2xHZW9tTXVsdGlQb2x5Z29uIGZyb20gJ29sL2dlb20vTXVsdGlQb2x5Z29uLmpzJztcbmltcG9ydCBvbEdlb21Qb2ludCBmcm9tICdvbC9nZW9tL1BvaW50LmpzJztcbmltcG9ydCBvbEdlb21Qb2x5Z29uIGZyb20gJ29sL2dlb20vUG9seWdvbi5qcyc7XG5pbXBvcnQgb2xTdHlsZUNpcmNsZSBmcm9tICdvbC9zdHlsZS9DaXJjbGUuanMnO1xuaW1wb3J0IG9sU3R5bGVGaWxsIGZyb20gJ29sL3N0eWxlL0ZpbGwuanMnO1xuaW1wb3J0IG9sU3R5bGVTdHJva2UgZnJvbSAnb2wvc3R5bGUvU3Ryb2tlLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xuaW1wb3J0IG9sU3R5bGVUZXh0IGZyb20gJ29sL3N0eWxlL1RleHQuanMnO1xuaW1wb3J0IEdlb21ldHJ5IGZyb20gJ29sL2dlb20vR2VvbWV0cnkuanMnO1xudmFyIExlZ2FjeVByb3BlcnRpZXNfID0ge307XG52YXIgREVGQVVMVF9BQ0NVUkFDWSA9IDAuMTtcbnZhciBTdHlsZVR5cGVzXyA9IHtcbiAgJ0xpbmVTdHJpbmcnOiBuZ2VvRm9ybWF0RmVhdHVyZUhhc2hTdHlsZVR5cGUuTElORV9TVFJJTkcsXG4gICdQb2ludCc6IG5nZW9Gb3JtYXRGZWF0dXJlSGFzaFN0eWxlVHlwZS5QT0lOVCxcbiAgJ1BvbHlnb24nOiBuZ2VvRm9ybWF0RmVhdHVyZUhhc2hTdHlsZVR5cGUuUE9MWUdPTixcbiAgJ011bHRpTGluZVN0cmluZyc6IG5nZW9Gb3JtYXRGZWF0dXJlSGFzaFN0eWxlVHlwZS5MSU5FX1NUUklORyxcbiAgJ011bHRpUG9pbnQnOiBuZ2VvRm9ybWF0RmVhdHVyZUhhc2hTdHlsZVR5cGUuUE9JTlQsXG4gICdNdWx0aVBvbHlnb24nOiBuZ2VvRm9ybWF0RmVhdHVyZUhhc2hTdHlsZVR5cGUuUE9MWUdPTlxufTtcbnZhciBDSEFSNjRfID0gJy4tXyEqQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5YWJjZGVmZ2hqa21ucHFyc3R1dnd4eXonO1xudmFyIEdFT01FVFJZX1JFQURFUlNfID0ge1xuICAnUCc6IHJlYWRNdWx0aVBvaW50R2VvbWV0cnlfLFxuICAnTCc6IHJlYWRNdWx0aUxpbmVTdHJpbmdHZW9tZXRyeV8sXG4gICdBJzogcmVhZE11bHRpUG9seWdvbkdlb21ldHJ5XyxcbiAgJ2wnOiByZWFkTGluZVN0cmluZ0dlb21ldHJ5XyxcbiAgJ3AnOiByZWFkUG9pbnRHZW9tZXRyeV8sXG4gICdhJzogcmVhZFBvbHlnb25HZW9tZXRyeV9cbn07XG52YXIgR0VPTUVUUllfV1JJVEVSU18gPSB7XG4gICdNdWx0aUxpbmVTdHJpbmcnOiB3cml0ZU11bHRpTGluZVN0cmluZ0dlb21ldHJ5XyxcbiAgJ011bHRpUG9pbnQnOiB3cml0ZU11bHRpUG9pbnRHZW9tZXRyeV8sXG4gICdNdWx0aVBvbHlnb24nOiB3cml0ZU11bHRpUG9seWdvbkdlb21ldHJ5XyxcbiAgJ0xpbmVTdHJpbmcnOiB3cml0ZUxpbmVTdHJpbmdHZW9tZXRyeV8sXG4gICdQb2ludCc6IHdyaXRlUG9pbnRHZW9tZXRyeV8sXG4gICdQb2x5Z29uJzogd3JpdGVQb2x5Z29uR2VvbWV0cnlfXG59O1xuXG52YXIgRmVhdHVyZUhhc2ggPSBmdW5jdGlvbiAoX29sRm9ybWF0VGV4dEZlYXR1cmUpIHtcbiAgX2luaGVyaXRzTG9vc2UoRmVhdHVyZUhhc2gsIF9vbEZvcm1hdFRleHRGZWF0dXJlKTtcblxuICBmdW5jdGlvbiBGZWF0dXJlSGFzaChvcHRfb3B0aW9ucykge1xuICAgIHZhciBfdGhpcztcblxuICAgIF90aGlzID0gX29sRm9ybWF0VGV4dEZlYXR1cmUuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgIHZhciBvcHRpb25zID0gb3B0X29wdGlvbnMgfHwge307XG4gICAgX3RoaXMuYWNjdXJhY3lfID0gb3B0aW9ucy5hY2N1cmFjeSB8fCBERUZBVUxUX0FDQ1VSQUNZO1xuICAgIF90aGlzLmVuY29kZVN0eWxlc18gPSBvcHRpb25zLmVuY29kZVN0eWxlcyB8fCB0cnVlO1xuICAgIF90aGlzLnByb3BlcnRpZXNGdW5jdGlvbl8gPSBvcHRpb25zLnByb3BlcnRpZXMgfHwgZGVmYXVsdFByb3BlcnRpZXNGdW5jdGlvbl87XG4gICAgX3RoaXMuc2V0U3R5bGVfID0gb3B0aW9ucy5zZXRTdHlsZSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5zZXRTdHlsZSA6IHRydWU7XG4gICAgX3RoaXMucHJldlhfID0gMDtcbiAgICBfdGhpcy5wcmV2WV8gPSAwO1xuICAgIExlZ2FjeVByb3BlcnRpZXNfID0gb3B0aW9ucy5wcm9wZXJ0aWVzVHlwZSB8fCB7fTtcbiAgICBfdGhpcy5kZWZhdWx0VmFsdWVzXyA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlcyB8fCB7fTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gRmVhdHVyZUhhc2gucHJvdG90eXBlO1xuXG4gIF9wcm90by5kZWNvZGVDb29yZGluYXRlc18gPSBmdW5jdGlvbiBkZWNvZGVDb29yZGluYXRlc18odGV4dCwgb3B0X2ZsYXRDb29yZGluYXRlcykge1xuICAgIHZhciBsZW4gPSB0ZXh0Lmxlbmd0aDtcbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBmbGF0Q29vcmRpbmF0ZXMgPSBvcHRfZmxhdENvb3JkaW5hdGVzICE9PSB1bmRlZmluZWQgPyBvcHRfZmxhdENvb3JkaW5hdGVzIDogW107XG4gICAgdmFyIGkgPSBmbGF0Q29vcmRpbmF0ZXMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGluZGV4IDwgbGVuKSB7XG4gICAgICB2YXIgYiA9IHZvaWQgMDtcbiAgICAgIHZhciBzaGlmdCA9IDA7XG4gICAgICB2YXIgcmVzdWx0ID0gMDtcblxuICAgICAgZG8ge1xuICAgICAgICBiID0gQ0hBUjY0Xy5pbmRleE9mKHRleHQuY2hhckF0KGluZGV4KyspKTtcbiAgICAgICAgcmVzdWx0IHw9IChiICYgMHgxZikgPDwgc2hpZnQ7XG4gICAgICAgIHNoaWZ0ICs9IDU7XG4gICAgICB9IHdoaWxlIChiID49IDMyKTtcblxuICAgICAgdmFyIGR4ID0gcmVzdWx0ICYgMSA/IH4ocmVzdWx0ID4+IDEpIDogcmVzdWx0ID4+IDE7XG4gICAgICB0aGlzLnByZXZYXyArPSBkeDtcbiAgICAgIHNoaWZ0ID0gMDtcbiAgICAgIHJlc3VsdCA9IDA7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgYiA9IENIQVI2NF8uaW5kZXhPZih0ZXh0LmNoYXJBdChpbmRleCsrKSk7XG4gICAgICAgIHJlc3VsdCB8PSAoYiAmIDB4MWYpIDw8IHNoaWZ0O1xuICAgICAgICBzaGlmdCArPSA1O1xuICAgICAgfSB3aGlsZSAoYiA+PSAzMik7XG5cbiAgICAgIHZhciBkeSA9IHJlc3VsdCAmIDEgPyB+KHJlc3VsdCA+PiAxKSA6IHJlc3VsdCA+PiAxO1xuICAgICAgdGhpcy5wcmV2WV8gKz0gZHk7XG4gICAgICBmbGF0Q29vcmRpbmF0ZXNbaSsrXSA9IHRoaXMucHJldlhfICogdGhpcy5hY2N1cmFjeV87XG4gICAgICBmbGF0Q29vcmRpbmF0ZXNbaSsrXSA9IHRoaXMucHJldllfICogdGhpcy5hY2N1cmFjeV87XG4gICAgfVxuXG4gICAgcmV0dXJuIGZsYXRDb29yZGluYXRlcztcbiAgfTtcblxuICBfcHJvdG8uZW5jb2RlQ29vcmRpbmF0ZXNfID0gZnVuY3Rpb24gZW5jb2RlQ29vcmRpbmF0ZXNfKGZsYXRDb29yZGluYXRlcywgc3RyaWRlLCBvZmZzZXQsIGVuZCkge1xuICAgIHZhciBlbmNvZGVkQ29vcmRpbmF0ZXMgPSAnJztcblxuICAgIGZvciAodmFyIGkgPSBvZmZzZXQ7IGkgPCBlbmQ7IGkgKz0gc3RyaWRlKSB7XG4gICAgICB2YXIgeCA9IGZsYXRDb29yZGluYXRlc1tpXTtcbiAgICAgIHZhciB5ID0gZmxhdENvb3JkaW5hdGVzW2kgKyAxXTtcbiAgICAgIHggPSBNYXRoLmZsb29yKHggLyB0aGlzLmFjY3VyYWN5Xyk7XG4gICAgICB5ID0gTWF0aC5mbG9vcih5IC8gdGhpcy5hY2N1cmFjeV8pO1xuICAgICAgdmFyIGR4ID0geCAtIHRoaXMucHJldlhfO1xuICAgICAgdmFyIGR5ID0geSAtIHRoaXMucHJldllfO1xuICAgICAgdGhpcy5wcmV2WF8gPSB4O1xuICAgICAgdGhpcy5wcmV2WV8gPSB5O1xuICAgICAgZW5jb2RlZENvb3JkaW5hdGVzICs9IGVuY29kZVNpZ25lZE51bWJlcl8oZHgpICsgZW5jb2RlU2lnbmVkTnVtYmVyXyhkeSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVuY29kZWRDb29yZGluYXRlcztcbiAgfTtcblxuICBfcHJvdG8ucmVhZEZlYXR1cmVGcm9tVGV4dCA9IGZ1bmN0aW9uIHJlYWRGZWF0dXJlRnJvbVRleHQodGV4dCwgb3B0X29wdGlvbnMpIHtcbiAgICBjb25zb2xlLmFzc2VydCh0ZXh0Lmxlbmd0aCA+IDIpO1xuICAgIGNvbnNvbGUuYXNzZXJ0KHRleHRbMV0gPT09ICcoJyk7XG4gICAgY29uc29sZS5hc3NlcnQodGV4dC5lbmRzV2l0aCgnKScpKTtcbiAgICB2YXIgc3BsaXRJbmRleCA9IHRleHQuaW5kZXhPZignficpO1xuICAgIHZhciBnZW9tZXRyeVRleHQgPSBzcGxpdEluZGV4ID49IDAgPyB0ZXh0LnN1YnN0cmluZygwLCBzcGxpdEluZGV4KSArIFwiKVwiIDogdGV4dDtcbiAgICB2YXIgZ2VvbWV0cnkgPSB0aGlzLnJlYWRHZW9tZXRyeUZyb21UZXh0KGdlb21ldHJ5VGV4dCwgb3B0X29wdGlvbnMpO1xuICAgIHZhciBmZWF0dXJlID0gbmV3IG9sRmVhdHVyZShnZW9tZXRyeSk7XG5cbiAgICBpZiAoc3BsaXRJbmRleCA+PSAwKSB7XG4gICAgICB2YXIgYXR0cmlidXRlc0FuZFN0eWxlc1RleHQgPSB0ZXh0LnN1YnN0cmluZyhzcGxpdEluZGV4ICsgMSwgdGV4dC5sZW5ndGggLSAxKTtcbiAgICAgIHNwbGl0SW5kZXggPSBhdHRyaWJ1dGVzQW5kU3R5bGVzVGV4dC5pbmRleE9mKCd+Jyk7XG4gICAgICB2YXIgYXR0cmlidXRlc1RleHQgPSBzcGxpdEluZGV4ID49IDAgPyBhdHRyaWJ1dGVzQW5kU3R5bGVzVGV4dC5zdWJzdHJpbmcoMCwgc3BsaXRJbmRleCkgOiBhdHRyaWJ1dGVzQW5kU3R5bGVzVGV4dDtcblxuICAgICAgaWYgKGF0dHJpYnV0ZXNUZXh0ICE9ICcnKSB7XG4gICAgICAgIHZhciBwYXJ0cyA9IGF0dHJpYnV0ZXNUZXh0LnNwbGl0KCdcXCcnKTtcblxuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBwYXJ0cywgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvciksIF9pID0gMCwgX2l0ZXJhdG9yID0gX2lzQXJyYXkgPyBfaXRlcmF0b3IgOiBfaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgICB2YXIgX3JlZjtcblxuICAgICAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICAgICAgaWYgKF9pID49IF9pdGVyYXRvci5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2kgPSBfaXRlcmF0b3IubmV4dCgpO1xuICAgICAgICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBlbmNvZGVkUGFydCA9IF9yZWY7XG4gICAgICAgICAgdmFyIHBhcnQgPSBkZWNvZGVVUklDb21wb25lbnQoZW5jb2RlZFBhcnQpO1xuICAgICAgICAgIHZhciBrZXlWYWwgPSBwYXJ0LnNwbGl0KCcqJyk7XG4gICAgICAgICAgY29uc29sZS5hc3NlcnQoa2V5VmFsLmxlbmd0aCA9PT0gMik7XG4gICAgICAgICAgdmFyIGtleSA9IGtleVZhbFswXTtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBrZXlWYWxbMV07XG5cbiAgICAgICAgICBpZiAoIXRoaXMuc2V0U3R5bGVfICYmIExlZ2FjeVByb3BlcnRpZXNfW2tleV0pIHtcbiAgICAgICAgICAgIGtleSA9IExlZ2FjeVByb3BlcnRpZXNfW2tleV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZmVhdHVyZS5zZXQoa2V5LCBjYXN0VmFsdWVfKGtleSwgdmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoc3BsaXRJbmRleCA+PSAwKSB7XG4gICAgICAgIHZhciBzdHlsZXNUZXh0ID0gYXR0cmlidXRlc0FuZFN0eWxlc1RleHQuc3Vic3RyaW5nKHNwbGl0SW5kZXggKyAxKTtcblxuICAgICAgICBpZiAodGhpcy5zZXRTdHlsZV8pIHtcbiAgICAgICAgICBzZXRTdHlsZUluRmVhdHVyZV8oc3R5bGVzVGV4dCwgZmVhdHVyZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2V0U3R5bGVQcm9wZXJ0aWVzXyhzdHlsZXNUZXh0LCBmZWF0dXJlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmZWF0dXJlO1xuICB9O1xuXG4gIF9wcm90by5yZWFkRmVhdHVyZXNGcm9tVGV4dCA9IGZ1bmN0aW9uIHJlYWRGZWF0dXJlc0Zyb21UZXh0KHRleHQsIG9wdF9vcHRpb25zKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICBjb25zb2xlLmFzc2VydCh0ZXh0LnN0YXJ0c1dpdGgoJ0YnKSk7XG4gICAgdGhpcy5wcmV2WF8gPSAwO1xuICAgIHRoaXMucHJldllfID0gMDtcbiAgICB2YXIgZmVhdHVyZXMgPSBbXTtcbiAgICB0ZXh0ID0gdGV4dC5zdWJzdHJpbmcoMSk7XG5cbiAgICB3aGlsZSAodGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgaW5kZXggPSB0ZXh0LmluZGV4T2YoJyknKTtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KGluZGV4ID49IDApO1xuICAgICAgdmFyIGZlYXR1cmUgPSB0aGlzLnJlYWRGZWF0dXJlRnJvbVRleHQodGV4dC5zdWJzdHJpbmcoMCwgaW5kZXggKyAxKSwgb3B0X29wdGlvbnMpO1xuICAgICAgZmVhdHVyZXMucHVzaChmZWF0dXJlKTtcbiAgICAgIHRleHQgPSB0ZXh0LnN1YnN0cmluZyhpbmRleCArIDEpO1xuICAgIH1cblxuICAgIGZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgIGZvciAodmFyIGtleSBpbiBfdGhpczIuZGVmYXVsdFZhbHVlc18pIHtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gTGVnYWN5UHJvcGVydGllc19ba2V5XTtcblxuICAgICAgICBpZiAoZmVhdHVyZS5nZXQocHJvcGVydHkpID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBmZWF0dXJlLnNldChwcm9wZXJ0eSwgX3RoaXMyLmRlZmF1bHRWYWx1ZXNfW2tleV0uY2FsbChudWxsLCBmZWF0dXJlKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZmVhdHVyZXM7XG4gIH07XG5cbiAgX3Byb3RvLnJlYWRHZW9tZXRyeUZyb21UZXh0ID0gZnVuY3Rpb24gcmVhZEdlb21ldHJ5RnJvbVRleHQodGV4dCwgb3B0X29wdGlvbnMpIHtcbiAgICB2YXIgZ2VvbWV0cnlSZWFkZXIgPSBHRU9NRVRSWV9SRUFERVJTX1t0ZXh0WzBdXTtcbiAgICBjb25zb2xlLmFzc2VydChnZW9tZXRyeVJlYWRlciAhPT0gdW5kZWZpbmVkKTtcbiAgICByZXR1cm4gZ2VvbWV0cnlSZWFkZXIuY2FsbCh0aGlzLCB0ZXh0KTtcbiAgfTtcblxuICBfcHJvdG8ud3JpdGVGZWF0dXJlVGV4dCA9IGZ1bmN0aW9uIHdyaXRlRmVhdHVyZVRleHQoZmVhdHVyZSwgb3B0X29wdGlvbnMpIHtcbiAgICB2YXIgZW5jb2RlZFBhcnRzID0gW107XG4gICAgdmFyIGVuY29kZWRHZW9tZXRyeSA9ICcnO1xuICAgIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgIGlmIChnZW9tZXRyeSkge1xuICAgICAgZW5jb2RlZEdlb21ldHJ5ID0gdGhpcy53cml0ZUdlb21ldHJ5VGV4dChnZW9tZXRyeSwgb3B0X29wdGlvbnMpO1xuICAgIH1cblxuICAgIGlmIChlbmNvZGVkR2VvbWV0cnkubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5hc3NlcnQoZW5jb2RlZEdlb21ldHJ5LmVuZHNXaXRoKCcpJykpO1xuICAgICAgZW5jb2RlZEdlb21ldHJ5ID0gZW5jb2RlZEdlb21ldHJ5LnN1YnN0cmluZygwLCBlbmNvZGVkR2VvbWV0cnkubGVuZ3RoIC0gMSk7XG4gICAgICBlbmNvZGVkUGFydHMucHVzaChlbmNvZGVkR2VvbWV0cnkpO1xuICAgIH1cblxuICAgIHZhciBlbmNvZGVkUHJvcGVydGllcyA9IFtdO1xuICAgIHZhciBwcm9wRnVuY3Rpb24gPSB0aGlzLnByb3BlcnRpZXNGdW5jdGlvbl8oZmVhdHVyZSk7XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gcHJvcEZ1bmN0aW9uKSB7XG4gICAgICB2YXIgdmFsdWUgPSBwcm9wRnVuY3Rpb25ba2V5XTtcblxuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwgJiYga2V5ICE9PSBmZWF0dXJlLmdldEdlb21ldHJ5TmFtZSgpKSB7XG4gICAgICAgIGlmIChlbmNvZGVkUHJvcGVydGllcy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICBlbmNvZGVkUHJvcGVydGllcy5wdXNoKCdcXCcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBlbmNvZGVkID0gZW5jb2RlVVJJQ29tcG9uZW50KGtleS5yZXBsYWNlKC9bKCknKl0vZywgJ18nKSArIFwiKlwiICsgdmFsdWUudG9TdHJpbmcoKS5yZXBsYWNlKC9bKCknKl0vZywgJ18nKSk7XG4gICAgICAgIGVuY29kZWRQcm9wZXJ0aWVzLnB1c2goZW5jb2RlZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGVuY29kZWRQcm9wZXJ0aWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGVuY29kZWRQYXJ0cy5wdXNoKCd+Jyk7XG4gICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShlbmNvZGVkUGFydHMsIGVuY29kZWRQcm9wZXJ0aWVzKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5lbmNvZGVTdHlsZXNfKSB7XG4gICAgICB2YXIgc3R5bGVGdW5jdGlvbiA9IGZlYXR1cmUuZ2V0U3R5bGVGdW5jdGlvbigpO1xuXG4gICAgICBpZiAoc3R5bGVGdW5jdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciBzdHlsZXMgPSBzdHlsZUZ1bmN0aW9uKGZlYXR1cmUsIDApO1xuXG4gICAgICAgIGlmIChzdHlsZXMgIT09IG51bGwpIHtcbiAgICAgICAgICB2YXIgZW5jb2RlZFN0eWxlcyA9IFtdO1xuICAgICAgICAgIHN0eWxlcyA9IEFycmF5LmlzQXJyYXkoc3R5bGVzKSA/IHN0eWxlcyA6IFtzdHlsZXNdO1xuXG4gICAgICAgICAgaWYgKCFnZW9tZXRyeSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdlb21ldHJ5Jyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZW5jb2RlU3R5bGVzXyhzdHlsZXMsIGdlb21ldHJ5LmdldFR5cGUoKSwgZW5jb2RlZFN0eWxlcyk7XG5cbiAgICAgICAgICBpZiAoZW5jb2RlZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBlbmNvZGVkUGFydHMucHVzaCgnficpO1xuICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoZW5jb2RlZFBhcnRzLCBlbmNvZGVkU3R5bGVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBlbmNvZGVkUGFydHMucHVzaCgnKScpO1xuICAgIHJldHVybiBlbmNvZGVkUGFydHMuam9pbignJyk7XG4gIH07XG5cbiAgX3Byb3RvLndyaXRlRmVhdHVyZXNUZXh0ID0gZnVuY3Rpb24gd3JpdGVGZWF0dXJlc1RleHQoZmVhdHVyZXMsIG9wdF9vcHRpb25zKSB7XG4gICAgdGhpcy5wcmV2WF8gPSAwO1xuICAgIHRoaXMucHJldllfID0gMDtcbiAgICB2YXIgdGV4dEFycmF5ID0gW107XG5cbiAgICBpZiAoZmVhdHVyZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGV4dEFycmF5LnB1c2goJ0YnKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZmVhdHVyZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICB0ZXh0QXJyYXkucHVzaCh0aGlzLndyaXRlRmVhdHVyZVRleHQoZmVhdHVyZXNbaV0sIG9wdF9vcHRpb25zKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRleHRBcnJheS5qb2luKCcnKTtcbiAgfTtcblxuICBfcHJvdG8ud3JpdGVHZW9tZXRyeVRleHQgPSBmdW5jdGlvbiB3cml0ZUdlb21ldHJ5VGV4dChnZW9tZXRyeSwgb3B0X29wdGlvbnMpIHtcbiAgICB2YXIgZ2VvbWV0cnlXcml0ZXIgPSBHRU9NRVRSWV9XUklURVJTX1tnZW9tZXRyeS5nZXRUeXBlKCldO1xuICAgIGNvbnNvbGUuYXNzZXJ0KGdlb21ldHJ5V3JpdGVyICE9PSB1bmRlZmluZWQpO1xuICAgIHZhciB0cmFuc2Zvcm1lZEdlb21ldHJ5ID0gdHJhbnNmb3JtR2VvbWV0cnlXaXRoT3B0aW9ucyhnZW9tZXRyeSwgdHJ1ZSwgb3B0X29wdGlvbnMpO1xuXG4gICAgaWYgKCEodHJhbnNmb3JtZWRHZW9tZXRyeSBpbnN0YW5jZW9mIEdlb21ldHJ5KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHRyYW5zZm9ybWVkR2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICB2YXIgZW5jR2VvbSA9IGdlb21ldHJ5V3JpdGVyLmNhbGwodGhpcywgdHJhbnNmb3JtZWRHZW9tZXRyeSk7XG5cbiAgICBpZiAoIWVuY0dlb20pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBlbmNvZGVkR2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZW5jR2VvbTtcbiAgfTtcblxuICByZXR1cm4gRmVhdHVyZUhhc2g7XG59KG9sRm9ybWF0VGV4dEZlYXR1cmUpO1xuXG5leHBvcnQgZGVmYXVsdCBGZWF0dXJlSGFzaDtcblxuZnVuY3Rpb24gZGVmYXVsdFByb3BlcnRpZXNGdW5jdGlvbl8oZmVhdHVyZSkge1xuICByZXR1cm4gZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCk7XG59XG5cbmZ1bmN0aW9uIGVuY29kZVNpZ25lZE51bWJlcl8obnVtKSB7XG4gIHZhciBzaWduZWROdW0gPSBudW0gPDwgMTtcblxuICBpZiAobnVtIDwgMCkge1xuICAgIHNpZ25lZE51bSA9IH5zaWduZWROdW07XG4gIH1cblxuICByZXR1cm4gZW5jb2RlTnVtYmVyXyhzaWduZWROdW0pO1xufVxuXG5mdW5jdGlvbiBlbmNvZGVOdW1iZXJfKG51bSkge1xuICB2YXIgZW5jb2RlZE51bWJlciA9ICcnO1xuXG4gIHdoaWxlIChudW0gPj0gMHgyMCkge1xuICAgIGVuY29kZWROdW1iZXIgKz0gQ0hBUjY0Xy5jaGFyQXQoMHgyMCB8IG51bSAmIDB4MWYpO1xuICAgIG51bSA+Pj0gNTtcbiAgfVxuXG4gIGVuY29kZWROdW1iZXIgKz0gQ0hBUjY0Xy5jaGFyQXQobnVtKTtcbiAgcmV0dXJuIGVuY29kZWROdW1iZXI7XG59XG5cbmZ1bmN0aW9uIGVuY29kZVN0eWxlc18oc3R5bGVzLCBnZW9tZXRyeVR5cGUsIGVuY29kZWRTdHlsZXMpIHtcbiAgdmFyIHN0eWxlVHlwZSA9IFN0eWxlVHlwZXNfW2dlb21ldHJ5VHlwZV07XG4gIGNvbnNvbGUuYXNzZXJ0KHN0eWxlVHlwZSAhPT0gdW5kZWZpbmVkKTtcblxuICBmb3IgKHZhciBfaXRlcmF0b3IyID0gc3R5bGVzLCBfaXNBcnJheTIgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjIpLCBfaTIgPSAwLCBfaXRlcmF0b3IyID0gX2lzQXJyYXkyID8gX2l0ZXJhdG9yMiA6IF9pdGVyYXRvcjJbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICB2YXIgX3JlZjI7XG5cbiAgICBpZiAoX2lzQXJyYXkyKSB7XG4gICAgICBpZiAoX2kyID49IF9pdGVyYXRvcjIubGVuZ3RoKSBicmVhaztcbiAgICAgIF9yZWYyID0gX2l0ZXJhdG9yMltfaTIrK107XG4gICAgfSBlbHNlIHtcbiAgICAgIF9pMiA9IF9pdGVyYXRvcjIubmV4dCgpO1xuICAgICAgaWYgKF9pMi5kb25lKSBicmVhaztcbiAgICAgIF9yZWYyID0gX2kyLnZhbHVlO1xuICAgIH1cblxuICAgIHZhciBzdHlsZSA9IF9yZWYyO1xuICAgIHZhciBmaWxsU3R5bGUgPSBzdHlsZS5nZXRGaWxsKCk7XG4gICAgdmFyIGltYWdlU3R5bGUgPSBzdHlsZS5nZXRJbWFnZSgpO1xuICAgIHZhciBzdHJva2VTdHlsZSA9IHN0eWxlLmdldFN0cm9rZSgpO1xuICAgIHZhciB0ZXh0U3R5bGUgPSBzdHlsZS5nZXRUZXh0KCk7XG5cbiAgICBpZiAoc3R5bGVUeXBlID09IG5nZW9Gb3JtYXRGZWF0dXJlSGFzaFN0eWxlVHlwZS5QT0xZR09OKSB7XG4gICAgICBpZiAoZmlsbFN0eWxlICE9PSBudWxsKSB7XG4gICAgICAgIGVuY29kZVN0eWxlUG9seWdvbl8oZmlsbFN0eWxlLCBzdHJva2VTdHlsZSwgZW5jb2RlZFN0eWxlcyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzdHlsZVR5cGUgPT0gbmdlb0Zvcm1hdEZlYXR1cmVIYXNoU3R5bGVUeXBlLkxJTkVfU1RSSU5HKSB7XG4gICAgICBpZiAoc3Ryb2tlU3R5bGUgIT09IG51bGwpIHtcbiAgICAgICAgZW5jb2RlU3R5bGVMaW5lXyhzdHJva2VTdHlsZSwgZW5jb2RlZFN0eWxlcyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzdHlsZVR5cGUgPT0gbmdlb0Zvcm1hdEZlYXR1cmVIYXNoU3R5bGVUeXBlLlBPSU5UKSB7XG4gICAgICBpZiAoaW1hZ2VTdHlsZSAhPT0gbnVsbCkge1xuICAgICAgICBlbmNvZGVTdHlsZVBvaW50XyhpbWFnZVN0eWxlLCBlbmNvZGVkU3R5bGVzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGV4dFN0eWxlICE9PSBudWxsKSB7XG4gICAgICBlbmNvZGVTdHlsZVRleHRfKHRleHRTdHlsZSwgZW5jb2RlZFN0eWxlcyk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGVuY29kZVN0eWxlTGluZV8oc3Ryb2tlU3R5bGUsIGVuY29kZWRTdHlsZXMpIHtcbiAgZW5jb2RlU3R5bGVTdHJva2VfKHN0cm9rZVN0eWxlLCBlbmNvZGVkU3R5bGVzKTtcbn1cblxuZnVuY3Rpb24gZW5jb2RlU3R5bGVQb2ludF8oaW1hZ2VTdHlsZSwgZW5jb2RlZFN0eWxlcykge1xuICBpZiAoaW1hZ2VTdHlsZSBpbnN0YW5jZW9mIG9sU3R5bGVDaXJjbGUpIHtcbiAgICB2YXIgcmFkaXVzID0gaW1hZ2VTdHlsZS5nZXRSYWRpdXMoKTtcblxuICAgIGlmIChlbmNvZGVkU3R5bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGVuY29kZWRTdHlsZXMucHVzaCgnXFwnJyk7XG4gICAgfVxuXG4gICAgZW5jb2RlZFN0eWxlcy5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChcInBvaW50UmFkaXVzKlwiICsgcmFkaXVzKSk7XG4gICAgdmFyIGZpbGxTdHlsZSA9IGltYWdlU3R5bGUuZ2V0RmlsbCgpO1xuXG4gICAgaWYgKGZpbGxTdHlsZSAhPT0gbnVsbCkge1xuICAgICAgZW5jb2RlU3R5bGVGaWxsXyhmaWxsU3R5bGUsIGVuY29kZWRTdHlsZXMpO1xuICAgIH1cblxuICAgIHZhciBzdHJva2VTdHlsZSA9IGltYWdlU3R5bGUuZ2V0U3Ryb2tlKCk7XG5cbiAgICBpZiAoc3Ryb2tlU3R5bGUgIT09IG51bGwpIHtcbiAgICAgIGVuY29kZVN0eWxlU3Ryb2tlXyhzdHJva2VTdHlsZSwgZW5jb2RlZFN0eWxlcyk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGVuY29kZVN0eWxlUG9seWdvbl8oZmlsbFN0eWxlLCBzdHJva2VTdHlsZSwgZW5jb2RlZFN0eWxlcykge1xuICBlbmNvZGVTdHlsZUZpbGxfKGZpbGxTdHlsZSwgZW5jb2RlZFN0eWxlcyk7XG5cbiAgaWYgKHN0cm9rZVN0eWxlICE9PSBudWxsKSB7XG4gICAgZW5jb2RlU3R5bGVTdHJva2VfKHN0cm9rZVN0eWxlLCBlbmNvZGVkU3R5bGVzKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBlbmNvZGVTdHlsZUZpbGxfKGZpbGxTdHlsZSwgZW5jb2RlZFN0eWxlcywgcHJvcGVydHlOYW1lKSB7XG4gIGlmIChwcm9wZXJ0eU5hbWUgPT09IHZvaWQgMCkge1xuICAgIHByb3BlcnR5TmFtZSA9ICdmaWxsQ29sb3InO1xuICB9XG5cbiAgdmFyIGZpbGxDb2xvciA9IGZpbGxTdHlsZS5nZXRDb2xvcigpO1xuICB2YXIgZmlsbENvbG9ySGV4O1xuXG4gIGlmIChmaWxsQ29sb3IgIT09IG51bGwpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShmaWxsQ29sb3IpKSB7XG4gICAgICBmaWxsQ29sb3JIZXggPSByZ2JBcnJheVRvSGV4KGZpbGxDb2xvcik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZmlsbENvbG9yID09PSAnc3RyaW5nJykge1xuICAgICAgZmlsbENvbG9ySGV4ID0gcmdiQXJyYXlUb0hleChhc0NvbG9yQXJyYXkoZmlsbENvbG9yKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgY29sb3InKTtcbiAgICB9XG5cbiAgICBpZiAoZW5jb2RlZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICBlbmNvZGVkU3R5bGVzLnB1c2goJ1xcJycpO1xuICAgIH1cblxuICAgIGVuY29kZWRTdHlsZXMucHVzaChlbmNvZGVVUklDb21wb25lbnQocHJvcGVydHlOYW1lICsgXCIqXCIgKyBmaWxsQ29sb3JIZXgpKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBlbmNvZGVTdHlsZVN0cm9rZV8oc3Ryb2tlU3R5bGUsIGVuY29kZWRTdHlsZXMpIHtcbiAgdmFyIHN0cm9rZUNvbG9yID0gc3Ryb2tlU3R5bGUuZ2V0Q29sb3IoKTtcblxuICBpZiAoc3Ryb2tlQ29sb3IgIT09IG51bGwpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShzdHJva2VDb2xvcikpIHtcbiAgICAgIHZhciBzdHJva2VDb2xvckhleCA9IHJnYkFycmF5VG9IZXgoc3Ryb2tlQ29sb3IpO1xuXG4gICAgICBpZiAoZW5jb2RlZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGVuY29kZWRTdHlsZXMucHVzaCgnXFwnJyk7XG4gICAgICB9XG5cbiAgICAgIGVuY29kZWRTdHlsZXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoXCJzdHJva2VDb2xvcipcIiArIHN0cm9rZUNvbG9ySGV4KSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIHN0cm9rZVdpZHRoID0gc3Ryb2tlU3R5bGUuZ2V0V2lkdGgoKTtcblxuICBpZiAoc3Ryb2tlV2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgIGlmIChlbmNvZGVkU3R5bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGVuY29kZWRTdHlsZXMucHVzaCgnXFwnJyk7XG4gICAgfVxuXG4gICAgZW5jb2RlZFN0eWxlcy5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChcInN0cm9rZVdpZHRoKlwiICsgc3Ryb2tlV2lkdGgpKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBlbmNvZGVTdHlsZVRleHRfKHRleHRTdHlsZSwgZW5jb2RlZFN0eWxlcykge1xuICB2YXIgZm9udFN0eWxlID0gdGV4dFN0eWxlLmdldEZvbnQoKTtcblxuICBpZiAoZm9udFN0eWxlICE9PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgZm9udCA9IGZvbnRTdHlsZS5zcGxpdCgnICcpO1xuXG4gICAgaWYgKGZvbnQubGVuZ3RoID49IDMpIHtcbiAgICAgIGlmIChlbmNvZGVkU3R5bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZW5jb2RlZFN0eWxlcy5wdXNoKCdcXCcnKTtcbiAgICAgIH1cblxuICAgICAgZW5jb2RlZFN0eWxlcy5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChcImZvbnRTaXplKlwiICsgZm9udFsxXSkpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBmaWxsU3R5bGUgPSB0ZXh0U3R5bGUuZ2V0RmlsbCgpO1xuXG4gIGlmIChmaWxsU3R5bGUgIT09IG51bGwpIHtcbiAgICBlbmNvZGVTdHlsZUZpbGxfKGZpbGxTdHlsZSwgZW5jb2RlZFN0eWxlcywgJ2ZvbnRDb2xvcicpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlYWRMaW5lU3RyaW5nR2VvbWV0cnlfKHRleHQpIHtcbiAgY29uc29sZS5hc3NlcnQodGV4dC5zdGFydHNXaXRoKCdsKCcpKTtcbiAgY29uc29sZS5hc3NlcnQodGV4dC5lbmRzV2l0aCgnKScpKTtcbiAgdGV4dCA9IHRleHQuc3Vic3RyaW5nKDIsIHRleHQubGVuZ3RoIC0gMSk7XG4gIHZhciBmbGF0Q29vcmRpbmF0ZXMgPSB0aGlzLmRlY29kZUNvb3JkaW5hdGVzXyh0ZXh0KTtcbiAgcmV0dXJuIG5ldyBvbEdlb21MaW5lU3RyaW5nKGZsYXRDb29yZGluYXRlcywgb2xHZW9tR2VvbWV0cnlMYXlvdXQuWFkpO1xufVxuXG5mdW5jdGlvbiByZWFkTXVsdGlMaW5lU3RyaW5nR2VvbWV0cnlfKHRleHQpIHtcbiAgY29uc29sZS5hc3NlcnQodGV4dC5zdGFydHNXaXRoKCdMKCcpKTtcbiAgY29uc29sZS5hc3NlcnQodGV4dC5lbmRzV2l0aCgnKScpKTtcbiAgdGV4dCA9IHRleHQuc3Vic3RyaW5nKDIsIHRleHQubGVuZ3RoIC0gMSk7XG4gIHZhciBmbGF0Q29vcmRpbmF0ZXMgPSBbXTtcbiAgdmFyIGVuZHMgPSBbXTtcbiAgdmFyIGxpbmVTdHJpbmdzID0gdGV4dC5zcGxpdCgnXFwnJyk7XG5cbiAgZm9yICh2YXIgaSA9IDAsIGlpID0gbGluZVN0cmluZ3MubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgIGZsYXRDb29yZGluYXRlcyA9IHRoaXMuZGVjb2RlQ29vcmRpbmF0ZXNfKGxpbmVTdHJpbmdzW2ldLCBmbGF0Q29vcmRpbmF0ZXMpO1xuICAgIGVuZHNbaV0gPSBmbGF0Q29vcmRpbmF0ZXMubGVuZ3RoO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBvbEdlb21NdWx0aUxpbmVTdHJpbmcoZmxhdENvb3JkaW5hdGVzLCBvbEdlb21HZW9tZXRyeUxheW91dC5YWSwgZW5kcyk7XG59XG5cbmZ1bmN0aW9uIHJlYWRQb2ludEdlb21ldHJ5Xyh0ZXh0KSB7XG4gIGNvbnNvbGUuYXNzZXJ0KHRleHQuc3RhcnRzV2l0aCgncCgnKSk7XG4gIGNvbnNvbGUuYXNzZXJ0KHRleHQuZW5kc1dpdGgoJyknKSk7XG4gIHRleHQgPSB0ZXh0LnN1YnN0cmluZygyLCB0ZXh0Lmxlbmd0aCAtIDEpO1xuICB2YXIgZmxhdENvb3JkaW5hdGVzID0gdGhpcy5kZWNvZGVDb29yZGluYXRlc18odGV4dCk7XG4gIGNvbnNvbGUuYXNzZXJ0KGZsYXRDb29yZGluYXRlcy5sZW5ndGggPT09IDIpO1xuICByZXR1cm4gbmV3IG9sR2VvbVBvaW50KGZsYXRDb29yZGluYXRlcywgb2xHZW9tR2VvbWV0cnlMYXlvdXQuWFkpO1xufVxuXG5mdW5jdGlvbiByZWFkTXVsdGlQb2ludEdlb21ldHJ5Xyh0ZXh0KSB7XG4gIGNvbnNvbGUuYXNzZXJ0KHRleHQuc3RhcnRzV2l0aCgnUCgnKSk7XG4gIGNvbnNvbGUuYXNzZXJ0KHRleHQuZW5kc1dpdGgoJyknKSk7XG4gIHRleHQgPSB0ZXh0LnN1YnN0cmluZygyLCB0ZXh0Lmxlbmd0aCAtIDEpO1xuICB2YXIgZmxhdENvb3JkaW5hdGVzID0gdGhpcy5kZWNvZGVDb29yZGluYXRlc18odGV4dCk7XG4gIHJldHVybiBuZXcgb2xHZW9tTXVsdGlQb2ludChmbGF0Q29vcmRpbmF0ZXMsIG9sR2VvbUdlb21ldHJ5TGF5b3V0LlhZKTtcbn1cblxuZnVuY3Rpb24gcmVhZFBvbHlnb25HZW9tZXRyeV8odGV4dCkge1xuICBjb25zb2xlLmFzc2VydCh0ZXh0LnN0YXJ0c1dpdGgoJ2EoJykpO1xuICBjb25zb2xlLmFzc2VydCh0ZXh0LmVuZHNXaXRoKCcpJykpO1xuICB0ZXh0ID0gdGV4dC5zdWJzdHJpbmcoMiwgdGV4dC5sZW5ndGggLSAxKTtcbiAgdmFyIGZsYXRDb29yZGluYXRlcyA9IFtdO1xuICB2YXIgZW5kcyA9IFtdO1xuICB2YXIgcmluZ3MgPSB0ZXh0LnNwbGl0KCdcXCcnKTtcblxuICBmb3IgKHZhciBpID0gMCwgaWkgPSByaW5ncy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgZmxhdENvb3JkaW5hdGVzID0gdGhpcy5kZWNvZGVDb29yZGluYXRlc18ocmluZ3NbaV0sIGZsYXRDb29yZGluYXRlcyk7XG4gICAgdmFyIGVuZCA9IGZsYXRDb29yZGluYXRlcy5sZW5ndGg7XG5cbiAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgZmxhdENvb3JkaW5hdGVzW2VuZCsrXSA9IGZsYXRDb29yZGluYXRlc1swXTtcbiAgICAgIGZsYXRDb29yZGluYXRlc1tlbmQrK10gPSBmbGF0Q29vcmRpbmF0ZXNbMV07XG4gICAgfSBlbHNlIHtcbiAgICAgIGZsYXRDb29yZGluYXRlc1tlbmQrK10gPSBmbGF0Q29vcmRpbmF0ZXNbZW5kc1tpIC0gMV1dO1xuICAgICAgZmxhdENvb3JkaW5hdGVzW2VuZCsrXSA9IGZsYXRDb29yZGluYXRlc1tlbmRzW2kgLSAxXSArIDFdO1xuICAgIH1cblxuICAgIGVuZHNbaV0gPSBlbmQ7XG4gIH1cblxuICByZXR1cm4gbmV3IG9sR2VvbVBvbHlnb24oZmxhdENvb3JkaW5hdGVzLCBvbEdlb21HZW9tZXRyeUxheW91dC5YWSwgZW5kcyk7XG59XG5cbmZ1bmN0aW9uIHJlYWRNdWx0aVBvbHlnb25HZW9tZXRyeV8odGV4dCkge1xuICBjb25zb2xlLmFzc2VydCh0ZXh0LnN0YXJ0c1dpdGgoJ0EoJykpO1xuICBjb25zb2xlLmFzc2VydCh0ZXh0LmVuZHNXaXRoKCcpJykpO1xuICB0ZXh0ID0gdGV4dC5zdWJzdHJpbmcoMiwgdGV4dC5sZW5ndGggLSAxKTtcbiAgdmFyIGZsYXRDb29yZGluYXRlcyA9IFtdO1xuICB2YXIgZW5kc3MgPSBbXTtcbiAgdmFyIHBvbHlnb25zID0gdGV4dC5zcGxpdCgnKSgnKTtcblxuICBmb3IgKHZhciBpID0gMCwgaWkgPSBwb2x5Z29ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgdmFyIHJpbmdzID0gcG9seWdvbnNbaV0uc3BsaXQoJ1xcJycpO1xuICAgIGVuZHNzW2ldID0gW107XG4gICAgdmFyIGVuZHMgPSBlbmRzc1tpXTtcblxuICAgIGZvciAodmFyIGogPSAwLCBqaiA9IHJpbmdzLmxlbmd0aDsgaiA8IGpqOyArK2opIHtcbiAgICAgIGZsYXRDb29yZGluYXRlcyA9IHRoaXMuZGVjb2RlQ29vcmRpbmF0ZXNfKHJpbmdzW2pdLCBmbGF0Q29vcmRpbmF0ZXMpO1xuICAgICAgdmFyIGVuZCA9IGZsYXRDb29yZGluYXRlcy5sZW5ndGg7XG5cbiAgICAgIGlmIChqID09PSAwKSB7XG4gICAgICAgIGZsYXRDb29yZGluYXRlc1tlbmQrK10gPSBmbGF0Q29vcmRpbmF0ZXNbMF07XG4gICAgICAgIGZsYXRDb29yZGluYXRlc1tlbmQrK10gPSBmbGF0Q29vcmRpbmF0ZXNbMV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmbGF0Q29vcmRpbmF0ZXNbZW5kKytdID0gZmxhdENvb3JkaW5hdGVzW2VuZHNbaiAtIDFdXTtcbiAgICAgICAgZmxhdENvb3JkaW5hdGVzW2VuZCsrXSA9IGZsYXRDb29yZGluYXRlc1tlbmRzW2ogLSAxXSArIDFdO1xuICAgICAgfVxuXG4gICAgICBlbmRzW2pdID0gZW5kO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgb2xHZW9tTXVsdGlQb2x5Z29uKGZsYXRDb29yZGluYXRlcywgb2xHZW9tR2VvbWV0cnlMYXlvdXQuWFksIGVuZHNzKTtcbn1cblxuZnVuY3Rpb24gc2V0U3R5bGVJbkZlYXR1cmVfKHRleHQsIGZlYXR1cmUpIHtcbiAgaWYgKHRleHQgPT0gJycpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgcHJvcGVydGllcyA9IGdldFN0eWxlUHJvcGVydGllc18odGV4dCwgZmVhdHVyZSk7XG4gIHZhciBmaWxsQ29sb3IgPSBwcm9wZXJ0aWVzLmZpbGxDb2xvcjtcbiAgdmFyIGZvbnRTaXplID0gcHJvcGVydGllcy5mb250U2l6ZTtcbiAgdmFyIGZvbnRDb2xvciA9IHByb3BlcnRpZXMuZm9udENvbG9yO1xuICB2YXIgcG9pbnRSYWRpdXMgPSBwcm9wZXJ0aWVzLnBvaW50UmFkaXVzO1xuICB2YXIgc3Ryb2tlQ29sb3IgPSBwcm9wZXJ0aWVzLnN0cm9rZUNvbG9yO1xuICB2YXIgc3Ryb2tlV2lkdGggPSBwcm9wZXJ0aWVzLnN0cm9rZVdpZHRoO1xuICB2YXIgZmlsbFN0eWxlID0gbnVsbDtcblxuICBpZiAoZmlsbENvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICBmaWxsU3R5bGUgPSBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgY29sb3I6IGZpbGxDb2xvclxuICAgIH0pO1xuICB9XG5cbiAgdmFyIHN0cm9rZVN0eWxlID0gbnVsbDtcblxuICBpZiAoc3Ryb2tlQ29sb3IgIT09IHVuZGVmaW5lZCAmJiBzdHJva2VXaWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBzdHJva2VXaWR0aCAhPSAnbnVtYmVyJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHN0cm9rZVdpZHRoJyk7XG4gICAgfVxuXG4gICAgc3Ryb2tlU3R5bGUgPSBuZXcgb2xTdHlsZVN0cm9rZSh7XG4gICAgICBjb2xvcjogc3Ryb2tlQ29sb3IsXG4gICAgICB3aWR0aDogc3Ryb2tlV2lkdGhcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBpbWFnZVN0eWxlID0gbnVsbDtcblxuICBpZiAocG9pbnRSYWRpdXMgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmICh0eXBlb2YgcG9pbnRSYWRpdXMgIT0gJ251bWJlcicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBwb2ludFJhZGl1cycpO1xuICAgIH1cblxuICAgIHZhciBfb3B0aW9ucyA9IHtcbiAgICAgIHJhZGl1czogcG9pbnRSYWRpdXNcbiAgICB9O1xuXG4gICAgaWYgKGZpbGxTdHlsZSkge1xuICAgICAgX29wdGlvbnMuZmlsbCA9IGZpbGxTdHlsZTtcbiAgICB9XG5cbiAgICBpZiAoc3Ryb2tlU3R5bGUpIHtcbiAgICAgIF9vcHRpb25zLnN0cm9rZSA9IHN0cm9rZVN0eWxlO1xuICAgIH1cblxuICAgIGltYWdlU3R5bGUgPSBuZXcgb2xTdHlsZUNpcmNsZShfb3B0aW9ucyk7XG4gICAgZmlsbFN0eWxlID0gbnVsbDtcbiAgICBzdHJva2VTdHlsZSA9IG51bGw7XG4gIH1cblxuICB2YXIgdGV4dFN0eWxlID0gbnVsbDtcblxuICBpZiAoZm9udFNpemUgIT09IHVuZGVmaW5lZCAmJiBmb250Q29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgIHRleHRTdHlsZSA9IG5ldyBvbFN0eWxlVGV4dCh7XG4gICAgICBmb250OiBmb250U2l6ZSArIFwiIHNhbnMtc2VyaWZcIixcbiAgICAgIGZpbGw6IG5ldyBvbFN0eWxlRmlsbCh7XG4gICAgICAgIGNvbG9yOiBmb250Q29sb3JcbiAgICAgIH0pXG4gICAgfSk7XG4gIH1cblxuICB2YXIgb3B0aW9ucyA9IHt9O1xuXG4gIGlmIChmaWxsU3R5bGUpIHtcbiAgICBvcHRpb25zLmZpbGwgPSBmaWxsU3R5bGU7XG4gIH1cblxuICBpZiAoc3Ryb2tlU3R5bGUpIHtcbiAgICBvcHRpb25zLnN0cm9rZSA9IHN0cm9rZVN0eWxlO1xuICB9XG5cbiAgaWYgKGltYWdlU3R5bGUpIHtcbiAgICBvcHRpb25zLmltYWdlID0gaW1hZ2VTdHlsZTtcbiAgfVxuXG4gIGlmICh0ZXh0U3R5bGUpIHtcbiAgICBvcHRpb25zLnRleHQgPSB0ZXh0U3R5bGU7XG4gIH1cblxuICB2YXIgc3R5bGUgPSBuZXcgb2xTdHlsZVN0eWxlKG9wdGlvbnMpO1xuICBmZWF0dXJlLnNldFN0eWxlKHN0eWxlKTtcbn1cblxuZnVuY3Rpb24gc2V0U3R5bGVQcm9wZXJ0aWVzXyh0ZXh0LCBmZWF0dXJlKSB7XG4gIHZhciBwcm9wZXJ0aWVzID0gZ2V0U3R5bGVQcm9wZXJ0aWVzXyh0ZXh0LCBmZWF0dXJlKTtcbiAgdmFyIGdlb21ldHJ5ID0gZmVhdHVyZS5nZXRHZW9tZXRyeSgpO1xuXG4gIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbVBvaW50KSB7XG4gICAgaWYgKHByb3BlcnRpZXMuaXNMYWJlbCB8fCBwcm9wZXJ0aWVzW25nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5JU19URVhUXSkge1xuICAgICAgZGVsZXRlIHByb3BlcnRpZXMuc3Ryb2tlQ29sb3I7XG4gICAgICBkZWxldGUgcHJvcGVydGllcy5maWxsQ29sb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRlbGV0ZSBwcm9wZXJ0aWVzLmZvbnRDb2xvcjtcbiAgICAgIGRlbGV0ZSBwcm9wZXJ0aWVzLmZvbnRTaXplO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBkZWxldGUgcHJvcGVydGllcy5mb250Q29sb3I7XG5cbiAgICBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21MaW5lU3RyaW5nKSB7XG4gICAgICBkZWxldGUgcHJvcGVydGllcy5maWxsQ29sb3I7XG4gICAgICBkZWxldGUgcHJvcGVydGllcy5maWxsT3BhY2l0eTtcbiAgICB9XG4gIH1cblxuICBpZiAocHJvcGVydGllcy5mb250U2l6ZSkge1xuICAgIHZhciBmb250U2l6ZVN0ciA9IHByb3BlcnRpZXMuZm9udFNpemU7XG5cbiAgICBpZiAodHlwZW9mIGZvbnRTaXplU3RyICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBmb250U2l6ZVN0ciB0eXBlJyk7XG4gICAgfVxuXG4gICAgdmFyIGZvbnRTaXplID0gcGFyc2VGbG9hdChmb250U2l6ZVN0cik7XG5cbiAgICBpZiAoZm9udFNpemVTdHIuaW5jbHVkZXMoJ3B4JykpIHtcbiAgICAgIGZvbnRTaXplID0gTWF0aC5yb3VuZChmb250U2l6ZSAvIDEuMzMzMzMzKTtcbiAgICB9XG5cbiAgICBwcm9wZXJ0aWVzLmZvbnRTaXplID0gZm9udFNpemU7XG4gIH1cblxuICB2YXIgY2xvbmUgPSB7fTtcblxuICBmb3IgKHZhciBrZXkgaW4gcHJvcGVydGllcykge1xuICAgIHZhciB2YWx1ZSA9IHByb3BlcnRpZXNba2V5XTtcblxuICAgIGlmIChMZWdhY3lQcm9wZXJ0aWVzX1trZXldKSB7XG4gICAgICBjbG9uZVtMZWdhY3lQcm9wZXJ0aWVzX1trZXldXSA9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjbG9uZVtrZXldID0gdmFsdWU7XG4gICAgfVxuICB9XG5cbiAgZmVhdHVyZS5zZXRQcm9wZXJ0aWVzKGNsb25lKTtcbn1cblxuZnVuY3Rpb24gY2FzdFZhbHVlXyhrZXksIHZhbHVlKSB7XG4gIHZhciBudW1Qcm9wZXJ0aWVzID0gW25nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5BTkdMRSwgbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLk9QQUNJVFksIG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5TSVpFLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU1RST0tFLCAncG9pbnRSYWRpdXMnLCAnc3Ryb2tlV2lkdGgnXTtcbiAgdmFyIGJvb2xQcm9wZXJ0aWVzID0gW25nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5JU19DSVJDTEUsIG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5JU19SRUNUQU5HTEUsIG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5JU19URVhULCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU0hPV19NRUFTVVJFLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU0hPV19MQUJFTCwgJ2lzQ2lyY2xlJywgJ2lzUmVjdGFuZ2xlJywgJ2lzTGFiZWwnLCAnc2hvd01lYXN1cmUnLCAnc2hvd0xhYmVsJ107XG5cbiAgaWYgKG51bVByb3BlcnRpZXMuaW5jbHVkZXMoa2V5KSkge1xuICAgIHJldHVybiArdmFsdWU7XG4gIH0gZWxzZSBpZiAoYm9vbFByb3BlcnRpZXMuaW5jbHVkZXMoa2V5KSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gJ3RydWUnID8gdHJ1ZSA6IGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRTdHlsZVByb3BlcnRpZXNfKHRleHQsIGZlYXR1cmUpIHtcbiAgdmFyIHBhcnRzID0gdGV4dC5zcGxpdCgnXFwnJyk7XG4gIHZhciBwcm9wZXJ0aWVzID0ge307XG5cbiAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IHBhcnRzLCBfaXNBcnJheTMgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjMpLCBfaTMgPSAwLCBfaXRlcmF0b3IzID0gX2lzQXJyYXkzID8gX2l0ZXJhdG9yMyA6IF9pdGVyYXRvcjNbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICB2YXIgX3JlZjM7XG5cbiAgICBpZiAoX2lzQXJyYXkzKSB7XG4gICAgICBpZiAoX2kzID49IF9pdGVyYXRvcjMubGVuZ3RoKSBicmVhaztcbiAgICAgIF9yZWYzID0gX2l0ZXJhdG9yM1tfaTMrK107XG4gICAgfSBlbHNlIHtcbiAgICAgIF9pMyA9IF9pdGVyYXRvcjMubmV4dCgpO1xuICAgICAgaWYgKF9pMy5kb25lKSBicmVhaztcbiAgICAgIF9yZWYzID0gX2kzLnZhbHVlO1xuICAgIH1cblxuICAgIHZhciBlbmNvZGVkUGFydCA9IF9yZWYzO1xuICAgIHZhciBwYXJ0ID0gZGVjb2RlVVJJQ29tcG9uZW50KGVuY29kZWRQYXJ0KTtcbiAgICB2YXIga2V5VmFsID0gcGFydC5zcGxpdCgnKicpO1xuICAgIGNvbnNvbGUuYXNzZXJ0KGtleVZhbC5sZW5ndGggPT09IDIpO1xuICAgIHZhciBrZXkgPSBrZXlWYWxbMF07XG4gICAgdmFyIHZhbCA9IGtleVZhbFsxXTtcbiAgICBwcm9wZXJ0aWVzW2tleV0gPSBjYXN0VmFsdWVfKGtleSwgdmFsKTtcbiAgfVxuXG4gIHJldHVybiBwcm9wZXJ0aWVzO1xufVxuXG5mdW5jdGlvbiB3cml0ZUxpbmVTdHJpbmdHZW9tZXRyeV8oZ2VvbWV0cnkpIHtcbiAgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTGluZVN0cmluZykge1xuICAgIHZhciBmbGF0Q29vcmRpbmF0ZXMgPSBnZW9tZXRyeS5nZXRGbGF0Q29vcmRpbmF0ZXMoKTtcbiAgICB2YXIgc3RyaWRlID0gZ2VvbWV0cnkuZ2V0U3RyaWRlKCk7XG4gICAgdmFyIGVuZCA9IGZsYXRDb29yZGluYXRlcy5sZW5ndGg7XG4gICAgcmV0dXJuIFwibChcIiArIHRoaXMuZW5jb2RlQ29vcmRpbmF0ZXNfKGZsYXRDb29yZGluYXRlcywgc3RyaWRlLCAwLCBlbmQpICsgXCIpXCI7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gd3JpdGVNdWx0aUxpbmVTdHJpbmdHZW9tZXRyeV8oZ2VvbWV0cnkpIHtcbiAgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTXVsdGlMaW5lU3RyaW5nKSB7XG4gICAgdmFyIGVuZHMgPSBnZW9tZXRyeS5nZXRFbmRzKCk7XG4gICAgdmFyIGxpbmVTdHJpbmdDb3VudCA9IGVuZHMubGVuZ3RoO1xuICAgIHZhciBmbGF0Q29vcmRpbmF0ZXMgPSBnZW9tZXRyeS5nZXRGbGF0Q29vcmRpbmF0ZXMoKTtcbiAgICB2YXIgc3RyaWRlID0gZ2VvbWV0cnkuZ2V0U3RyaWRlKCk7XG4gICAgdmFyIG9mZnNldCA9IDA7XG4gICAgdmFyIHRleHRBcnJheSA9IFsnTCgnXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZVN0cmluZ0NvdW50OyArK2kpIHtcbiAgICAgIHZhciBlbmQgPSBlbmRzW2ldO1xuICAgICAgdmFyIHRleHQgPSB0aGlzLmVuY29kZUNvb3JkaW5hdGVzXyhmbGF0Q29vcmRpbmF0ZXMsIHN0cmlkZSwgb2Zmc2V0LCBlbmQpO1xuXG4gICAgICBpZiAoaSAhPT0gMCkge1xuICAgICAgICB0ZXh0QXJyYXkucHVzaCgnXFwnJyk7XG4gICAgICB9XG5cbiAgICAgIHRleHRBcnJheS5wdXNoKHRleHQpO1xuICAgICAgb2Zmc2V0ID0gZW5kO1xuICAgIH1cblxuICAgIHRleHRBcnJheS5wdXNoKCcpJyk7XG4gICAgcmV0dXJuIHRleHRBcnJheS5qb2luKCcnKTtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiB3cml0ZVBvaW50R2VvbWV0cnlfKGdlb21ldHJ5KSB7XG4gIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbVBvaW50KSB7XG4gICAgdmFyIGZsYXRDb29yZGluYXRlcyA9IGdlb21ldHJ5LmdldEZsYXRDb29yZGluYXRlcygpO1xuICAgIHZhciBzdHJpZGUgPSBnZW9tZXRyeS5nZXRTdHJpZGUoKTtcbiAgICB2YXIgZW5kID0gZmxhdENvb3JkaW5hdGVzLmxlbmd0aDtcbiAgICByZXR1cm4gXCJwKFwiICsgdGhpcy5lbmNvZGVDb29yZGluYXRlc18oZmxhdENvb3JkaW5hdGVzLCBzdHJpZGUsIDAsIGVuZCkgKyBcIilcIjtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiB3cml0ZU11bHRpUG9pbnRHZW9tZXRyeV8oZ2VvbWV0cnkpIHtcbiAgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTXVsdGlQb2ludCkge1xuICAgIHZhciBmbGF0Q29vcmRpbmF0ZXMgPSBnZW9tZXRyeS5nZXRGbGF0Q29vcmRpbmF0ZXMoKTtcbiAgICB2YXIgc3RyaWRlID0gZ2VvbWV0cnkuZ2V0U3RyaWRlKCk7XG4gICAgdmFyIGVuZCA9IGZsYXRDb29yZGluYXRlcy5sZW5ndGg7XG4gICAgcmV0dXJuIFwiUChcIiArIHRoaXMuZW5jb2RlQ29vcmRpbmF0ZXNfKGZsYXRDb29yZGluYXRlcywgc3RyaWRlLCAwLCBlbmQpICsgXCIpXCI7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gZW5jb2RlUmluZ3NfKGZsYXRDb29yZGluYXRlcywgc3RyaWRlLCBvZmZzZXQsIGVuZHMsIHRleHRBcnJheSkge1xuICB2YXIgbGluZWFyUmluZ0NvdW50ID0gZW5kcy5sZW5ndGg7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lYXJSaW5nQ291bnQ7ICsraSkge1xuICAgIHZhciBlbmQgPSBlbmRzW2ldIC0gc3RyaWRlO1xuICAgIHZhciB0ZXh0ID0gdGhpcy5lbmNvZGVDb29yZGluYXRlc18oZmxhdENvb3JkaW5hdGVzLCBzdHJpZGUsIG9mZnNldCwgZW5kKTtcblxuICAgIGlmIChpICE9PSAwKSB7XG4gICAgICB0ZXh0QXJyYXkucHVzaCgnXFwnJyk7XG4gICAgfVxuXG4gICAgdGV4dEFycmF5LnB1c2godGV4dCk7XG4gICAgb2Zmc2V0ID0gZW5kc1tpXTtcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQ7XG59XG5cbmZ1bmN0aW9uIHdyaXRlUG9seWdvbkdlb21ldHJ5XyhnZW9tZXRyeSkge1xuICBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21Qb2x5Z29uKSB7XG4gICAgdmFyIGZsYXRDb29yZGluYXRlcyA9IGdlb21ldHJ5LmdldEZsYXRDb29yZGluYXRlcygpO1xuICAgIHZhciBzdHJpZGUgPSBnZW9tZXRyeS5nZXRTdHJpZGUoKTtcbiAgICB2YXIgZW5kcyA9IGdlb21ldHJ5LmdldEVuZHMoKTtcbiAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICB2YXIgdGV4dEFycmF5ID0gWydhKCddO1xuICAgIGVuY29kZVJpbmdzXy5jYWxsKHRoaXMsIGZsYXRDb29yZGluYXRlcywgc3RyaWRlLCBvZmZzZXQsIGVuZHMsIHRleHRBcnJheSk7XG4gICAgdGV4dEFycmF5LnB1c2goJyknKTtcbiAgICByZXR1cm4gdGV4dEFycmF5LmpvaW4oJycpO1xuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIHdyaXRlTXVsdGlQb2x5Z29uR2VvbWV0cnlfKGdlb21ldHJ5KSB7XG4gIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbU11bHRpUG9seWdvbikge1xuICAgIHZhciBmbGF0Q29vcmRpbmF0ZXMgPSBnZW9tZXRyeS5nZXRGbGF0Q29vcmRpbmF0ZXMoKTtcbiAgICB2YXIgc3RyaWRlID0gZ2VvbWV0cnkuZ2V0U3RyaWRlKCk7XG4gICAgdmFyIGVuZHNzID0gZ2VvbWV0cnkuZ2V0RW5kc3MoKTtcbiAgICB2YXIgcG9seWdvbkNvdW50ID0gZW5kc3MubGVuZ3RoO1xuICAgIHZhciBvZmZzZXQgPSAwO1xuICAgIHZhciB0ZXh0QXJyYXkgPSBbJ0EnXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9seWdvbkNvdW50OyArK2kpIHtcbiAgICAgIHZhciBlbmRzID0gZW5kc3NbaV07XG4gICAgICB0ZXh0QXJyYXkucHVzaCgnKCcpO1xuICAgICAgb2Zmc2V0ID0gZW5jb2RlUmluZ3NfLmNhbGwodGhpcywgZmxhdENvb3JkaW5hdGVzLCBzdHJpZGUsIG9mZnNldCwgZW5kcywgdGV4dEFycmF5KTtcbiAgICAgIHRleHRBcnJheS5wdXNoKCcpJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRleHRBcnJheS5qb2luKCcnKTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGdlb21ldHJ5IHR5cGUnKTtcbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IHtcbiAgTElORV9TVFJJTkc6ICdMaW5lU3RyaW5nJyxcbiAgUE9JTlQ6ICdQb2ludCcsXG4gIFBPTFlHT046ICdQb2x5Z29uJ1xufTsiLCJleHBvcnQgZGVmYXVsdCB7XG4gIEFOR0xFOiAnYScsXG4gIENPTE9SOiAnYycsXG4gIElTX0NJUkNMRTogJ2wnLFxuICBJU19SRUNUQU5HTEU6ICdyJyxcbiAgSVNfVEVYVDogJ3QnLFxuICBOQU1FOiAnbicsXG4gIFNIT1dfTEFCRUw6ICdiJyxcbiAgT1BBQ0lUWTogJ28nLFxuICBBWklNVVQ6ICd6JyxcbiAgU0hPV19NRUFTVVJFOiAnbScsXG4gIFNJWkU6ICdzJyxcbiAgU1RST0tFOiAnaydcbn07IiwiaW1wb3J0IHsgc2V0R2VvbWV0cnlUeXBlIH0gZnJvbSAnbmdlby9mb3JtYXQvQXR0cmlidXRlLmpzJztcbmltcG9ydCBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZSBmcm9tICduZ2VvL2Zvcm1hdC9BdHRyaWJ1dGVUeXBlLmpzJztcbmltcG9ydCB7IEZvcm1hdE51bWJlclR5cGUgfSBmcm9tICduZ2VvL2Zvcm1hdC9YU0RBdHRyaWJ1dGUuanMnO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIF9kZWZhdWx0KCkge31cblxuICB2YXIgX3Byb3RvID0gX2RlZmF1bHQucHJvdG90eXBlO1xuXG4gIF9wcm90by5yZWFkID0gZnVuY3Rpb24gcmVhZChjb21wbGV4VHlwZUVsZW1lbnRzKSB7XG4gICAgcmV0dXJuIGNvbXBsZXhUeXBlRWxlbWVudHMubWFwKHRoaXMucmVhZEZyb21Db21wbGV4VHlwZUVsZW1lbnRfKTtcbiAgfTtcblxuICBfcHJvdG8ucmVhZEZyb21Db21wbGV4VHlwZUVsZW1lbnRfID0gZnVuY3Rpb24gcmVhZEZyb21Db21wbGV4VHlwZUVsZW1lbnRfKG9iamVjdCkge1xuICAgIHZhciBuYW1lID0gb2JqZWN0Lm5hbWU7XG4gICAgdmFyIGFsaWFzID0gb2JqZWN0LmFsaWFzIHx8IG51bGw7XG4gICAgdmFyIHJlcXVpcmVkID0gb2JqZWN0Lm1pbk9jY3VycyAhPSAnMCc7XG4gICAgdmFyIGF0dHJpYnV0ZSA9IHtcbiAgICAgIG5hbWU6IG5hbWUsXG4gICAgICBhbGlhczogYWxpYXMsXG4gICAgICByZXF1aXJlZDogcmVxdWlyZWRcbiAgICB9O1xuICAgIHZhciB0eXBlID0gb2JqZWN0LnR5cGU7XG5cbiAgICBpZiAoIXNldEdlb21ldHJ5VHlwZShhdHRyaWJ1dGUsIHR5cGUpKSB7XG4gICAgICBpZiAodHlwZSA9PT0gJ2dtbDpUaW1lSW5zdGFudFR5cGUnIHx8IHR5cGUgPT09ICdkYXRlVGltZScpIHtcbiAgICAgICAgYXR0cmlidXRlLnR5cGUgPSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5EQVRFVElNRTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2RhdGUnKSB7XG4gICAgICAgIGF0dHJpYnV0ZS50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuREFURTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3RpbWUnKSB7XG4gICAgICAgIGF0dHJpYnV0ZS50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuVElNRTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2RlY2ltYWwnIHx8IHR5cGUgPT09ICdkb3VibGUnKSB7XG4gICAgICAgIGF0dHJpYnV0ZS50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuTlVNQkVSO1xuICAgICAgICBhdHRyaWJ1dGUubnVtVHlwZSA9IEZvcm1hdE51bWJlclR5cGUuRkxPQVQ7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdpbnRlZ2VyJyB8fCB0eXBlID09PSAnbG9uZycpIHtcbiAgICAgICAgYXR0cmlidXRlLnR5cGUgPSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5OVU1CRVI7XG4gICAgICAgIGF0dHJpYnV0ZS5udW1UeXBlID0gRm9ybWF0TnVtYmVyVHlwZS5JTlRFR0VSO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgYXR0cmlidXRlLnR5cGUgPSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5CT09MRUFOO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXR0cmlidXRlLnR5cGUgPSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5URVhUO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBhdHRyaWJ1dGU7XG4gIH07XG5cbiAgcmV0dXJuIF9kZWZhdWx0O1xufSgpO1xuXG5leHBvcnQgeyBfZGVmYXVsdCBhcyBkZWZhdWx0IH07IiwiZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCB7IHNldEdlb21ldHJ5VHlwZSB9IGZyb20gJ25nZW8vZm9ybWF0L0F0dHJpYnV0ZS5qcyc7XG5pbXBvcnQgbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUgZnJvbSAnbmdlby9mb3JtYXQvQXR0cmlidXRlVHlwZS5qcyc7XG5pbXBvcnQgb2xGb3JtYXRYTUwgZnJvbSAnb2wvZm9ybWF0L1hNTC5qcyc7XG5leHBvcnQgdmFyIEZvcm1hdE51bWJlclR5cGUgPSB7XG4gIEZMT0FUOiAnZmxvYXQnLFxuICBJTlRFR0VSOiAnaW50ZWdlcidcbn07XG5cbnZhciBYU0RBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoX29sRm9ybWF0WE1MKSB7XG4gIF9pbmhlcml0c0xvb3NlKFhTREF0dHJpYnV0ZSwgX29sRm9ybWF0WE1MKTtcblxuICBmdW5jdGlvbiBYU0RBdHRyaWJ1dGUoKSB7XG4gICAgcmV0dXJuIF9vbEZvcm1hdFhNTC5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gWFNEQXR0cmlidXRlLnByb3RvdHlwZTtcblxuICBfcHJvdG8ucmVhZCA9IGZ1bmN0aW9uIHJlYWQoc291cmNlKSB7XG4gICAgcmV0dXJuIG9sRm9ybWF0WE1MLnByb3RvdHlwZS5yZWFkLmNhbGwodGhpcywgc291cmNlKTtcbiAgfTtcblxuICBfcHJvdG8ucmVhZEZyb21Eb2N1bWVudCA9IGZ1bmN0aW9uIHJlYWRGcm9tRG9jdW1lbnQoZG9jKSB7XG4gICAgY29uc29sZS5hc3NlcnQoZG9jLm5vZGVUeXBlID09IE5vZGUuRE9DVU1FTlRfTk9ERSwgJ2RvYy5ub2RlVHlwZSBzaG91bGQgYmUgRE9DVU1FTlQnKTtcbiAgICB2YXIgbjtcblxuICAgIGZvciAobiA9IGRvYy5maXJzdENoaWxkOyBuOyBuID0gbi5uZXh0U2libGluZykge1xuICAgICAgaWYgKG4ubm9kZVR5cGUgPT0gTm9kZS5FTEVNRU5UX05PREUpIHtcbiAgICAgICAgaWYgKCEobiBpbnN0YW5jZW9mIEVsZW1lbnQpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyB0eXBlJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5yZWFkRnJvbU5vZGUobik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgX3Byb3RvLnJlYWRGcm9tTm9kZSA9IGZ1bmN0aW9uIHJlYWRGcm9tTm9kZShub2RlKSB7XG4gICAgY29uc29sZS5hc3NlcnQobm9kZS5sb2NhbE5hbWUgPT0gJ3NjaGVtYScsICdsb2NhbE5hbWUgc2hvdWxkIGJlIHNjaGVtYScpO1xuICAgIHZhciBlbGVtZW50cyA9IG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2VsZW1lbnQnKTtcblxuICAgIGlmICghZWxlbWVudHMubGVuZ3RoKSB7XG4gICAgICBlbGVtZW50cyA9IG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3hzZDplbGVtZW50Jyk7XG4gICAgfVxuXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBbXTtcbiAgICB2YXIgYXR0cmlidXRlO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZWxlbWVudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgYXR0cmlidXRlID0gdGhpcy5yZWFkRnJvbUVsZW1lbnROb2RlXyhlbGVtZW50c1tpXSk7XG5cbiAgICAgIGlmIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgYXR0cmlidXRlcy5wdXNoKGF0dHJpYnV0ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGF0dHJpYnV0ZXM7XG4gIH07XG5cbiAgX3Byb3RvLnJlYWRGcm9tRWxlbWVudE5vZGVfID0gZnVuY3Rpb24gcmVhZEZyb21FbGVtZW50Tm9kZV8obm9kZSkge1xuICAgIGNvbnNvbGUuYXNzZXJ0KG5vZGUubm9kZVR5cGUgPT0gTm9kZS5FTEVNRU5UX05PREUsICdub2RlLm5vZGVUeXBlIHNob3VsZCBiZSBFTEVNRU5UJyk7XG4gICAgdmFyIGVsZW1lbnROb2RlID0gbm9kZTtcbiAgICB2YXIgbmFtZSA9IGVsZW1lbnROb2RlLmdldEF0dHJpYnV0ZSgnbmFtZScpO1xuXG4gICAgaWYgKCFuYW1lKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ25hbWUgc2hvdWxkIGJlIGRlZmluZWQgaW4gZWxlbWVudCBub2RlJyk7XG4gICAgfVxuXG4gICAgdmFyIGFsaWFzID0gZWxlbWVudE5vZGUuZ2V0QXR0cmlidXRlKCdhbGlhcycpO1xuICAgIHZhciBuaWxsYWJsZSA9IGVsZW1lbnROb2RlLmdldEF0dHJpYnV0ZSgnbmlsbGFibGUnKTtcbiAgICB2YXIgcmVxdWlyZWQgPSBuaWxsYWJsZSAhPT0gJ3RydWUnO1xuICAgIHZhciByZWFkb25seUVscyA9IGVsZW1lbnROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdyZWFkb25seScpO1xuICAgIHZhciByZWFkb25seSA9IHJlYWRvbmx5RWxzWzBdID8gcmVhZG9ubHlFbHNbMF0uZ2V0QXR0cmlidXRlKCd2YWx1ZScpID09PSAndHJ1ZScgOiBmYWxzZTtcbiAgICB2YXIgYXR0cmlidXRlID0ge1xuICAgICAgbmFtZTogbmFtZSxcbiAgICAgIHJlYWRvbmx5OiByZWFkb25seSxcbiAgICAgIHJlcXVpcmVkOiByZXF1aXJlZFxuICAgIH07XG5cbiAgICBpZiAoYWxpYXMpIHtcbiAgICAgIGF0dHJpYnV0ZS5hbGlhcyA9IGFsaWFzO1xuICAgIH1cblxuICAgIHZhciB0eXBlID0gZWxlbWVudE5vZGUuZ2V0QXR0cmlidXRlKCd0eXBlJyk7XG5cbiAgICBpZiAodHlwZSkge1xuICAgICAgaWYgKCFzZXRHZW9tZXRyeVR5cGUoYXR0cmlidXRlLCB0eXBlKSkge1xuICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZUJ5WHNkVHlwZV8oYXR0cmlidXRlLCB0eXBlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGVudW1lcmF0aW9ucyA9IGVsZW1lbnROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdlbnVtZXJhdGlvbicpO1xuXG4gICAgICBpZiAoIWVudW1lcmF0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgZW51bWVyYXRpb25zID0gZWxlbWVudE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3hzZDplbnVtZXJhdGlvbicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZW51bWVyYXRpb25zLmxlbmd0aCkge1xuICAgICAgICBhdHRyaWJ1dGUudHlwZSA9IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLlNFTEVDVDtcbiAgICAgICAgdmFyIGNob2ljZXMgPSBbXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBlbnVtZXJhdGlvbnMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgIHZhciB2YWx1ZSA9IGVudW1lcmF0aW9uc1tpXS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG5cbiAgICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdmFsdWUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjaG9pY2VzLnB1c2godmFsdWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXR0cmlidXRlLmNob2ljZXMgPSBjaG9pY2VzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHJlc3RyaWN0aW9ucyA9IGVsZW1lbnROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdyZXN0cmljdGlvbicpO1xuXG4gICAgICAgIGlmICghcmVzdHJpY3Rpb25zLmxlbmd0aCkge1xuICAgICAgICAgIHJlc3RyaWN0aW9ucyA9IGVsZW1lbnROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd4c2Q6cmVzdHJpY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXN0cmljdGlvbnMubGVuZ3RoICYmIHJlc3RyaWN0aW9uc1swXSkge1xuICAgICAgICAgIHZhciByZXN0cmljdGlvbk5vZGUgPSByZXN0cmljdGlvbnNbMF07XG4gICAgICAgICAgdmFyIGJhc2UgPSByZXN0cmljdGlvbk5vZGUuZ2V0QXR0cmlidXRlKCdiYXNlJyk7XG5cbiAgICAgICAgICBpZiAoIWJhc2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBiYXNlJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGVCeVhzZFR5cGVfKGF0dHJpYnV0ZSwgYmFzZSk7XG4gICAgICAgICAgdmFyIG1heExlbmd0aHMgPSBlbGVtZW50Tm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWF4TGVuZ3RoJyk7XG5cbiAgICAgICAgICBpZiAoIW1heExlbmd0aHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBtYXhMZW5ndGhzID0gZWxlbWVudE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3hzZDptYXhMZW5ndGgnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAobWF4TGVuZ3Rocy5sZW5ndGggJiYgbWF4TGVuZ3Roc1swXSkge1xuICAgICAgICAgICAgYXR0cmlidXRlLm1heExlbmd0aCA9IE51bWJlcihtYXhMZW5ndGhzWzBdLmdldEF0dHJpYnV0ZSgndmFsdWUnKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFhdHRyaWJ1dGUudHlwZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc29sZS5hc3NlcnQoYXR0cmlidXRlLnR5cGUpO1xuICAgIHJldHVybiBhdHRyaWJ1dGU7XG4gIH07XG5cbiAgX3Byb3RvLnNldEF0dHJpYnV0ZUJ5WHNkVHlwZV8gPSBmdW5jdGlvbiBzZXRBdHRyaWJ1dGVCeVhzZFR5cGVfKGF0dHJpYnV0ZSwgdHlwZSkge1xuICAgIGlmICh0eXBlID09PSAneHNkOmJvb2xlYW4nKSB7XG4gICAgICBhdHRyaWJ1dGUudHlwZSA9IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkJPT0xFQU47XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAneHNkOmRhdGUnKSB7XG4gICAgICBhdHRyaWJ1dGUudHlwZSA9IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLkRBVEU7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAneHNkOmRhdGVUaW1lJykge1xuICAgICAgYXR0cmlidXRlLnR5cGUgPSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5EQVRFVElNRTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd4c2Q6dGltZScpIHtcbiAgICAgIGF0dHJpYnV0ZS50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuVElNRTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd4c2Q6ZGVjaW1hbCcgfHwgdHlwZSA9PT0gJ3hzZDpkb3VibGUnKSB7XG4gICAgICBhdHRyaWJ1dGUudHlwZSA9IG5nZW9Gb3JtYXRBdHRyaWJ1dGVUeXBlLk5VTUJFUjtcbiAgICAgIGF0dHJpYnV0ZS5udW1UeXBlID0gRm9ybWF0TnVtYmVyVHlwZS5GTE9BVDtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd4c2Q6aW50ZWdlcicpIHtcbiAgICAgIGF0dHJpYnV0ZS50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuTlVNQkVSO1xuICAgICAgYXR0cmlidXRlLm51bVR5cGUgPSBGb3JtYXROdW1iZXJUeXBlLklOVEVHRVI7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAneHNkOnN0cmluZycpIHtcbiAgICAgIGF0dHJpYnV0ZS50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuVEVYVDtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFhTREF0dHJpYnV0ZTtcbn0ob2xGb3JtYXRYTUwpO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0R2VvbWV0cnlBdHRyaWJ1dGUoYXR0cmlidXRlcykge1xuICB2YXIgZ2VvbUF0dHJpYnV0ZSA9IG51bGw7XG5cbiAgZm9yICh2YXIgaSA9IDAsIGlpID0gYXR0cmlidXRlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgaWYgKGF0dHJpYnV0ZXNbaV0udHlwZSA9PT0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuR0VPTUVUUlkpIHtcbiAgICAgIGdlb21BdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW2ldO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdlb21BdHRyaWJ1dGU7XG59XG5leHBvcnQgZGVmYXVsdCBYU0RBdHRyaWJ1dGU7IiwiQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIm5nZW9GZWF0dXJlT3ZlcmxheU1nclwiLCBcIm5nZW9Ob3RpZmljYXRpb25cIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXlNZ3IgZnJvbSAnbmdlby9tYXAvRmVhdHVyZU92ZXJsYXlNZ3IuanMnO1xuaW1wb3J0IG5nZW9NZXNzYWdlTm90aWZpY2F0aW9uIGZyb20gJ25nZW8vbWVzc2FnZS9Ob3RpZmljYXRpb24uanMnO1xuaW1wb3J0ICogYXMgb2xFYXNpbmcgZnJvbSAnb2wvZWFzaW5nLmpzJztcbmltcG9ydCB7IGxpc3RlbiB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuaW1wb3J0IG9sR2VvbG9jYXRpb24gZnJvbSAnb2wvR2VvbG9jYXRpb24uanMnO1xuaW1wb3J0IG9sTWFwIGZyb20gJ29sL01hcC5qcyc7XG5pbXBvcnQgb2xHZW9tUG9pbnQgZnJvbSAnb2wvZ2VvbS9Qb2ludC5qcyc7XG5pbXBvcnQgUG9seWdvbiBmcm9tICdvbC9nZW9tL1BvbHlnb24uanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvR2VvbG9jYXRpb24nLCBbbmdlb01hcEZlYXR1cmVPdmVybGF5TWdyLm5hbWUsIG5nZW9NZXNzYWdlTm90aWZpY2F0aW9uLm5hbWVdKTtcbnZhciBHZW9sb2NhdGlvbkV2ZW50VHlwZSA9IHtcbiAgRVJST1I6ICdnZW9sb2NhdGlvbi1lcnJvcidcbn07XG5cbmZ1bmN0aW9uIGdlb2xvY2F0aW9uQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgc2NvcGU6IHtcbiAgICAgICdnZXRNYXBGbic6ICcmbmdlb0dlb2xvY2F0aW9uTWFwJyxcbiAgICAgICdnZXRPcHRpb25zRm4nOiAnJm5nZW9HZW9sb2NhdGlvbk9wdGlvbnMnXG4gICAgfSxcbiAgICBjb250cm9sbGVyOiAnbmdlb0dlb2xvY2F0aW9uQ29udHJvbGxlcidcbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb0dlb2xvY2F0aW9uJywgZ2VvbG9jYXRpb25Db21wb25lbnQpO1xuXG5mdW5jdGlvbiBDb250cm9sbGVyKCRzY29wZSwgJGVsZW1lbnQsIGdldHRleHRDYXRhbG9nLCBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IsIG5nZW9Ob3RpZmljYXRpb24pIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICAkZWxlbWVudC5vbignY2xpY2snLCB0aGlzLnRvZ2dsZVRyYWNraW5nLmJpbmQodGhpcykpO1xuICB2YXIgbWFwID0gJHNjb3BlLmdldE1hcEZuKCk7XG5cbiAgaWYgKCEobWFwIGluc3RhbmNlb2Ygb2xNYXApKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBtYXAgdHlwZScpO1xuICB9XG5cbiAgdGhpcy4kc2NvcGVfID0gJHNjb3BlO1xuICB0aGlzLm1hcF8gPSBtYXA7XG4gIHZhciBvcHRpb25zID0gJHNjb3BlLmdldE9wdGlvbnNGbigpIHx8IHt9O1xuICBjb25zb2xlLmFzc2VydChvcHRpb25zKTtcbiAgdGhpcy5ub3RpZmljYXRpb25fID0gbmdlb05vdGlmaWNhdGlvbjtcbiAgdGhpcy5mZWF0dXJlT3ZlcmxheV8gPSBuZ2VvRmVhdHVyZU92ZXJsYXlNZ3IuZ2V0RmVhdHVyZU92ZXJsYXkoKTtcbiAgdGhpcy5nZW9sb2NhdGlvbl8gPSBuZXcgb2xHZW9sb2NhdGlvbih7XG4gICAgcHJvamVjdGlvbjogbWFwLmdldFZpZXcoKS5nZXRQcm9qZWN0aW9uKCksXG4gICAgdHJhY2tpbmdPcHRpb25zOiB7XG4gICAgICBlbmFibGVIaWdoQWNjdXJhY3k6IHRydWVcbiAgICB9XG4gIH0pO1xuXG4gIGlmIChvcHRpb25zLmF1dG9yb3RhdGUpIHtcbiAgICB0aGlzLmF1dG9yb3RhdGVMaXN0ZW5lcigpO1xuICB9XG5cbiAgdGhpcy5nZW9sb2NhdGlvbl8ub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgX3RoaXMudW50cmFja18oKTtcblxuICAgIHZhciBtc2c7XG5cbiAgICBzd2l0Y2ggKGVycm9yLmNvZGUpIHtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgbXNnID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdVc2VyIGRlbmllZCB0aGUgcmVxdWVzdCBmb3IgR2VvbG9jYXRpb24uJyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIDI6XG4gICAgICAgIG1zZyA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnTG9jYXRpb24gaW5mb3JtYXRpb24gaXMgdW5hdmFpbGFibGUuJyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIDM6XG4gICAgICAgIG1zZyA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnVGhlIHJlcXVlc3QgdG8gZ2V0IHVzZXIgbG9jYXRpb24gdGltZWQgb3V0LicpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgbXNnID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdHZW9sb2NhdGlvbjogQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZC4nKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgX3RoaXMubm90aWZpY2F0aW9uXy5lcnJvcihtc2cpO1xuXG4gICAgJHNjb3BlLiRlbWl0KEdlb2xvY2F0aW9uRXZlbnRUeXBlLkVSUk9SLCBlcnJvcik7XG4gIH0pO1xuICB0aGlzLnBvc2l0aW9uRmVhdHVyZV8gPSBuZXcgb2xGZWF0dXJlKCk7XG5cbiAgaWYgKG9wdGlvbnMucG9zaXRpb25GZWF0dXJlU3R5bGUpIHtcbiAgICB0aGlzLnBvc2l0aW9uRmVhdHVyZV8uc2V0U3R5bGUob3B0aW9ucy5wb3NpdGlvbkZlYXR1cmVTdHlsZSk7XG4gIH1cblxuICB0aGlzLmFjY3VyYWN5RmVhdHVyZV8gPSBuZXcgb2xGZWF0dXJlKCk7XG5cbiAgaWYgKG9wdGlvbnMuYWNjdXJhY3lGZWF0dXJlU3R5bGUpIHtcbiAgICB0aGlzLmFjY3VyYWN5RmVhdHVyZV8uc2V0U3R5bGUob3B0aW9ucy5hY2N1cmFjeUZlYXR1cmVTdHlsZSk7XG4gIH1cblxuICB0aGlzLnpvb21fID0gb3B0aW9ucy56b29tO1xuICB0aGlzLmZvbGxvd18gPSBmYWxzZTtcbiAgdGhpcy52aWV3Q2hhbmdlZEJ5TWVfID0gZmFsc2U7XG4gIGxpc3Rlbih0aGlzLmdlb2xvY2F0aW9uXywgJ2NoYW5nZTphY2N1cmFjeUdlb21ldHJ5JywgZnVuY3Rpb24gKCkge1xuICAgIHZhciBnZW9tZXRyeSA9IF90aGlzLmdlb2xvY2F0aW9uXy5nZXRBY2N1cmFjeUdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICBfdGhpcy5hY2N1cmFjeUZlYXR1cmVfLnNldEdlb21ldHJ5KGdlb21ldHJ5KTtcblxuICAgIF90aGlzLnNldFBvc2l0aW9uXygpO1xuICB9KTtcbiAgbGlzdGVuKHRoaXMuZ2VvbG9jYXRpb25fLCAnY2hhbmdlOnBvc2l0aW9uJywgZnVuY3Rpb24gKCkge1xuICAgIF90aGlzLnNldFBvc2l0aW9uXygpO1xuICB9KTtcbiAgdmFyIHZpZXcgPSBtYXAuZ2V0VmlldygpO1xuICBsaXN0ZW4odmlldywgJ2NoYW5nZTpjZW50ZXInLCB0aGlzLmhhbmRsZVZpZXdDaGFuZ2VfLCB0aGlzKTtcbiAgbGlzdGVuKHZpZXcsICdjaGFuZ2U6cmVzb2x1dGlvbicsIHRoaXMuaGFuZGxlVmlld0NoYW5nZV8sIHRoaXMpO1xufVxuXG5Db250cm9sbGVyLnByb3RvdHlwZS50b2dnbGVUcmFja2luZyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuZ2VvbG9jYXRpb25fLmdldFRyYWNraW5nKCkpIHtcbiAgICB2YXIgY3VycmVudFBvc2l0aW9uID0gdGhpcy5nZW9sb2NhdGlvbl8uZ2V0UG9zaXRpb24oKTtcblxuICAgIGlmIChjdXJyZW50UG9zaXRpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy51bnRyYWNrXygpO1xuICAgICAgdGhpcy4kc2NvcGVfLiRlbWl0KEdlb2xvY2F0aW9uRXZlbnRUeXBlLkVSUk9SLCBudWxsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zb2xlLmFzc2VydChjdXJyZW50UG9zaXRpb24gIT09IHVuZGVmaW5lZCk7XG4gICAgdmFyIHZpZXcgPSB0aGlzLm1hcF8uZ2V0VmlldygpO1xuICAgIHZhciBjZW50ZXIgPSB2aWV3LmdldENlbnRlcigpO1xuXG4gICAgaWYgKCFjZW50ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjZW50ZXInKTtcbiAgICB9XG5cbiAgICB2YXIgZGlmZiA9IE1hdGguYWJzKGN1cnJlbnRQb3NpdGlvblswXSAtIGNlbnRlclswXSkgKyBNYXRoLmFicyhjdXJyZW50UG9zaXRpb25bMV0gLSBjZW50ZXJbMV0pO1xuXG4gICAgaWYgKGRpZmYgPCAyKSB7XG4gICAgICB0aGlzLnVudHJhY2tfKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZpZXcuc2V0Q2VudGVyKGN1cnJlbnRQb3NpdGlvbik7XG4gICAgICB0aGlzLnVudHJhY2tfKCk7XG4gICAgICB0aGlzLnRyYWNrXygpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aGlzLnRyYWNrXygpO1xuICB9XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS50cmFja18gPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuZmVhdHVyZU92ZXJsYXlfLmFkZEZlYXR1cmUodGhpcy5wb3NpdGlvbkZlYXR1cmVfKTtcbiAgdGhpcy5mZWF0dXJlT3ZlcmxheV8uYWRkRmVhdHVyZSh0aGlzLmFjY3VyYWN5RmVhdHVyZV8pO1xuICB0aGlzLmZvbGxvd18gPSB0cnVlO1xuICB0aGlzLmdlb2xvY2F0aW9uXy5zZXRUcmFja2luZyh0cnVlKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnVudHJhY2tfID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmZlYXR1cmVPdmVybGF5Xy5jbGVhcigpO1xuICB0aGlzLmZvbGxvd18gPSBmYWxzZTtcbiAgdGhpcy5nZW9sb2NhdGlvbl8uc2V0VHJhY2tpbmcoZmFsc2UpO1xuICB0aGlzLm5vdGlmaWNhdGlvbl8uY2xlYXIoKTtcbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnNldFBvc2l0aW9uXyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHZpZXcgPSB0aGlzLm1hcF8uZ2V0VmlldygpO1xuICB2YXIgcG9zaXRpb24gPSB0aGlzLmdlb2xvY2F0aW9uXy5nZXRQb3NpdGlvbigpO1xuXG4gIGlmIChwb3NpdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHBvc2l0aW9uJyk7XG4gIH1cblxuICB2YXIgcG9pbnQgPSBuZXcgb2xHZW9tUG9pbnQocG9zaXRpb24pO1xuICB0aGlzLnBvc2l0aW9uRmVhdHVyZV8uc2V0R2VvbWV0cnkocG9pbnQpO1xuICB2YXIgYWNjdXJhY3kgPSB0aGlzLmFjY3VyYWN5RmVhdHVyZV8uZ2V0R2VvbWV0cnkoKTtcblxuICBpZiAodGhpcy5mb2xsb3dfKSB7XG4gICAgdGhpcy52aWV3Q2hhbmdlZEJ5TWVfID0gdHJ1ZTtcblxuICAgIGlmICh0aGlzLnpvb21fICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHZpZXcuc2V0Q2VudGVyKHBvc2l0aW9uKTtcbiAgICAgIHZpZXcuc2V0Wm9vbSh0aGlzLnpvb21fKTtcbiAgICB9IGVsc2UgaWYgKGFjY3VyYWN5IGluc3RhbmNlb2YgUG9seWdvbikge1xuICAgICAgdmFyIHNpemUgPSB0aGlzLm1hcF8uZ2V0U2l6ZSgpO1xuXG4gICAgICBpZiAoc2l6ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBzaXplJyk7XG4gICAgICB9XG5cbiAgICAgIHZpZXcuZml0KGFjY3VyYWN5LCB7XG4gICAgICAgIHNpemU6IHNpemVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMudmlld0NoYW5nZWRCeU1lXyA9IGZhbHNlO1xuICB9XG59O1xuXG5Db250cm9sbGVyLnByb3RvdHlwZS5oYW5kbGVWaWV3Q2hhbmdlXyA9IGZ1bmN0aW9uIChldmVudCkge1xuICBpZiAodGhpcy5mb2xsb3dfICYmICF0aGlzLnZpZXdDaGFuZ2VkQnlNZV8pIHtcbiAgICB0aGlzLmZvbGxvd18gPSBmYWxzZTtcbiAgfVxufTtcblxuQ29udHJvbGxlci5wcm90b3R5cGUuYXV0b3JvdGF0ZUxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3RoaXMyID0gdGhpcztcblxuICB2YXIgY3VycmVudEFscGhhID0gMDtcblxuICBpZiAod2luZG93Lmhhc093blByb3BlcnR5KCdvbmRldmljZW9yaWVudGF0aW9uYWJzb2x1dGUnKSkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkZXZpY2VvcmllbnRhdGlvbmFic29sdXRlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBpZiAoIShldmVudCBpbnN0YW5jZW9mIERldmljZU9yaWVudGF0aW9uRXZlbnQpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZXZlbnQgdHlwZScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXZlbnQuYWxwaGEgIT09IG51bGwpIHtcbiAgICAgICAgY3VycmVudEFscGhhID0gX3RoaXMyLmhhbmRsZVJvdGF0ZV8oZXZlbnQuYWxwaGEsIGN1cnJlbnRBbHBoYSk7XG4gICAgICB9XG4gICAgfSwgdHJ1ZSk7XG4gIH0gZWxzZSBpZiAod2luZG93Lmhhc093blByb3BlcnR5KCdvbmRldmljZW9yaWVudGF0aW9uJykpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZGV2aWNlb3JpZW50YXRpb24nLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICBpZiAoZXZ0LndlYmtpdENvbXBhc3NIZWFkaW5nKSB7XG4gICAgICAgIGN1cnJlbnRBbHBoYSA9IF90aGlzMi5oYW5kbGVSb3RhdGVfKC1ldnQud2Via2l0Q29tcGFzc0hlYWRpbmcsIGN1cnJlbnRBbHBoYSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIWV2dC5hbHBoYSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBldnQuYWxwaGEnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGN1cnJlbnRBbHBoYSA9IF90aGlzMi5oYW5kbGVSb3RhdGVfKGV2dC5hbHBoYSAtIDI3MCwgY3VycmVudEFscGhhKTtcbiAgICAgIH1cbiAgICB9LCB0cnVlKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmVycm9yKCdPcmllbnRhdGlvbiBpcyBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgZGV2aWNlJyk7XG4gIH1cbn07XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLmhhbmRsZVJvdGF0ZV8gPSBmdW5jdGlvbiAoZXZlbnRBbHBoYSwgY3VycmVudEFscGhhKSB7XG4gIGlmICh0aGlzLmdlb2xvY2F0aW9uXy5nZXRUcmFja2luZygpICYmIE1hdGguYWJzKGV2ZW50QWxwaGEgLSBjdXJyZW50QWxwaGEpID4gMC4yKSB7XG4gICAgY3VycmVudEFscGhhID0gZXZlbnRBbHBoYTtcbiAgICB2YXIgcmFkQWxwaGEgPSBjdXJyZW50QWxwaGEgKiBNYXRoLlBJIC8gMTgwO1xuICAgIHRoaXMubWFwXy5nZXRWaWV3KCkuYW5pbWF0ZSh7XG4gICAgICByb3RhdGlvbjogcmFkQWxwaGEsXG4gICAgICBkdXJhdGlvbjogMzUwLFxuICAgICAgZWFzaW5nOiBvbEVhc2luZy5saW5lYXJcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBjdXJyZW50QWxwaGE7XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignbmdlb0dlb2xvY2F0aW9uQ29udHJvbGxlcicsIENvbnRyb2xsZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCB7IGdldFVpZCBhcyBvbFV0aWxHZXRVaWQgfSBmcm9tICdvbC91dGlsLmpzJztcblxuZnVuY3Rpb24gR3JpZENvbmZpZyhkYXRhLCBjb2x1bW5EZWZzKSB7XG4gIHRoaXMuZGF0YSA9IGRhdGE7XG4gIHRoaXMuY29sdW1uRGVmcyA9IGNvbHVtbkRlZnM7XG4gIHRoaXMuc2VsZWN0ZWRSb3dzID0ge307XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSb3dVaWQoYXR0cmlidXRlcykge1xuICByZXR1cm4gXCJcIiArIG9sVXRpbEdldFVpZChhdHRyaWJ1dGVzKTtcbn1cblxuR3JpZENvbmZpZy5wcm90b3R5cGUuaXNSb3dTZWxlY3RlZCA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzKSB7XG4gIHJldHVybiAhIXRoaXMuc2VsZWN0ZWRSb3dzW2dldFJvd1VpZChhdHRyaWJ1dGVzKV07XG59O1xuXG5HcmlkQ29uZmlnLnByb3RvdHlwZS5nZXRTZWxlY3RlZENvdW50ID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5zZWxlY3RlZFJvd3MpLmxlbmd0aDtcbn07XG5cbkdyaWRDb25maWcucHJvdG90eXBlLmdldFNlbGVjdGVkUm93cyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICBpZiAoIXRoaXMuZGF0YSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkYXRhJyk7XG4gIH1cblxuICByZXR1cm4gdGhpcy5kYXRhLmZpbHRlcihmdW5jdGlvbiAocm93KSB7XG4gICAgcmV0dXJuIF90aGlzLmlzUm93U2VsZWN0ZWQocm93KTtcbiAgfSk7XG59O1xuXG5HcmlkQ29uZmlnLnByb3RvdHlwZS5zZWxlY3RSb3cgPSBmdW5jdGlvbiAoYXR0cmlidXRlcykge1xuICB2YXIgdWlkID0gZ2V0Um93VWlkKGF0dHJpYnV0ZXMpO1xuICB0aGlzLnNlbGVjdGVkUm93c1t1aWRdID0gYXR0cmlidXRlcztcbn07XG5cbkdyaWRDb25maWcucHJvdG90eXBlLnRvZ2dsZVJvdyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzKSB7XG4gIHZhciB1aWQgPSBnZXRSb3dVaWQoYXR0cmlidXRlcyk7XG4gIHZhciBpc1NlbGVjdGVkID0gdGhpcy5pc1Jvd1NlbGVjdGVkKGF0dHJpYnV0ZXMpO1xuXG4gIGlmIChpc1NlbGVjdGVkKSB7XG4gICAgZGVsZXRlIHRoaXMuc2VsZWN0ZWRSb3dzW3VpZF07XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5zZWxlY3RlZFJvd3NbdWlkXSA9IGF0dHJpYnV0ZXM7XG4gIH1cbn07XG5cbkdyaWRDb25maWcucHJvdG90eXBlLnNlbGVjdEFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgaWYgKCF0aGlzLmRhdGEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGF0YScpO1xuICB9XG5cbiAgdGhpcy5kYXRhLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZXMpIHtcbiAgICBfdGhpczIuc2VsZWN0Um93KGF0dHJpYnV0ZXMpO1xuICB9KTtcbn07XG5cbkdyaWRDb25maWcucHJvdG90eXBlLnVuc2VsZWN0QWxsID0gZnVuY3Rpb24gKCkge1xuICBmb3IgKHZhciByb3dJZCBpbiB0aGlzLnNlbGVjdGVkUm93cykge1xuICAgIGRlbGV0ZSB0aGlzLnNlbGVjdGVkUm93c1tyb3dJZF07XG4gIH1cbn07XG5cbkdyaWRDb25maWcucHJvdG90eXBlLmludmVydFNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgaWYgKCF0aGlzLmRhdGEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGF0YScpO1xuICB9XG5cbiAgdGhpcy5kYXRhLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZXMpIHtcbiAgICBfdGhpczMudG9nZ2xlUm93KGF0dHJpYnV0ZXMpO1xuICB9KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEdyaWRDb25maWc7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdiBjbGFzcz1cIm5nZW8tZ3JpZC10YWJsZS1jb250YWluZXJcIj5cXG4gIDx0YWJsZSBmbG9hdC10aGVhZD1cIiRjdHJsLmZsb2F0VGhlYWRDb25maWdcIiBuZy1tb2RlbD1cIiRjdHJsLmNvbmZpZ3VyYXRpb24uZGF0YVwiXFxuICAgICAgICAgY2xhc3M9XCJ0YWJsZSB0YWJsZS1ib3JkZXJlZCB0YWJsZS1zdHJpcGVkIHRhYmxlLWhvdmVyXCI+XFxuICAgIDx0aGVhZCBjbGFzcz1cInRhYmxlLWhlYWRlclwiPlxcbiAgICAgIDx0cj5cXG4gICAgICAgIDx0aCBuZy1yZXBlYXQ9XCJjb2x1bW5EZWZzIGluICRjdHJsLmNvbmZpZ3VyYXRpb24uY29sdW1uRGVmc1wiXFxuICAgICAgICAgICAgbmctY2xpY2s9XCIkY3RybC5zb3J0KGNvbHVtbkRlZnMubmFtZSlcIiBuZy1iaW5kLWh0bWw9XCJjb2x1bW5EZWZzLm5hbWUgfCBuZ2VvVHJ1c3RIdG1sIHwgdHJhbnNsYXRlXCI+XFxuICAgICAgICAgIDxpIG5nLXNob3c9XCIkY3RybC5zb3J0ZWRCeSAhPT0gY29sdW1uRGVmcy5uYW1lXCIgY2xhc3M9XCJmYSBmYS1md1wiPjwvaT5cXG4gICAgICAgICAgPGkgbmctc2hvdz1cIiRjdHJsLnNvcnRlZEJ5ID09PSBjb2x1bW5EZWZzLm5hbWUgJiYgJGN0cmwuc29ydEFzY2VuZGluZyA9PT0gdHJ1ZVwiIGNsYXNzPVwiZmEgZmEtY2FyZXQtdXBcIj48L2k+XFxuICAgICAgICAgIDxpIG5nLXNob3c9XCIkY3RybC5zb3J0ZWRCeSA9PT0gY29sdW1uRGVmcy5uYW1lICYmICRjdHJsLnNvcnRBc2NlbmRpbmcgPT09IGZhbHNlXCIgY2xhc3M9XCJmYSBmYS1jYXJldC1kb3duXCI+PC9pPlxcbiAgICAgICAgPC90aD5cXG4gICAgICA8L3RyPlxcbiAgICA8L3RoZWFkPlxcbiAgICA8dGJvZHk+XFxuICAgICAgPHRyIG5nLXJlcGVhdD1cImF0dHJpYnV0ZXMgaW4gJGN0cmwuY29uZmlndXJhdGlvbi5kYXRhXCJcXG4gICAgICAgICAgbmctY2xhc3M9XCJbXFwncm93LVxcJyArICRjdHJsLmNvbmZpZ3VyYXRpb24uZ2V0Um93VWlkKGF0dHJpYnV0ZXMpLCAkY3RybC5jb25maWd1cmF0aW9uLmlzUm93U2VsZWN0ZWQoYXR0cmlidXRlcykgPyBcXCduZ2VvLWdyaWQtYWN0aXZlXFwnOiBcXCdcXCddXCJcXG4gICAgICAgICAgbmctY2xpY2s9XCIkY3RybC5jbGlja1JvdyhhdHRyaWJ1dGVzLCAkZXZlbnQpXCIgbmctbW91c2Vkb3duPVwiJGN0cmwucHJldmVudFRleHRTZWxlY3Rpb24oJGV2ZW50KVwiPlxcbiAgICAgICAgPHRkIG5nLXJlcGVhdD1cImNvbHVtbkRlZnMgaW4gJGN0cmwuY29uZmlndXJhdGlvbi5jb2x1bW5EZWZzXCIgbmctYmluZC1odG1sPVwiYXR0cmlidXRlc1tjb2x1bW5EZWZzLm5hbWVdIHwgcmVtb3ZlQ0RBVEEgfCBuZ2VvVHJ1c3RIdG1sQXV0b1wiPjwvdGQ+XFxuICAgICAgPC90cj5cXG4gICAgPC90Ym9keT5cXG4gIDwvdGFibGU+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsIkdyaWRDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvTWlzY0ZpbHRlcnMgZnJvbSAnbmdlby9taXNjL2ZpbHRlcnMuanMnO1xuaW1wb3J0IHsgZ2V0Um93VWlkIH0gZnJvbSAnbmdlby9ncmlkL0NvbmZpZy5qcyc7XG5pbXBvcnQgeyBNQUMgfSBmcm9tICdvbC9oYXMuanMnO1xuaW1wb3J0ICdmbG9hdHRoZWFkJztcbmltcG9ydCAnYW5ndWxhci1mbG9hdC10aGVhZCc7XG5pbXBvcnQgJ25nZW8vc2Fzcy9mb250LnNjc3MnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvR3JpZCcsIFtuZ2VvTWlzY0ZpbHRlcnMubmFtZSwgJ2Zsb2F0VGhlYWQnXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ25nZW8vZ3JpZCcsIHJlcXVpcmUoJy4vY29tcG9uZW50Lmh0bWwnKSk7XG59XSk7XG5tb2R1bGUudmFsdWUoJ25nZW9HcmlkVGVtcGxhdGVVcmwnLCBmdW5jdGlvbiAoJGF0dHJzKSB7XG4gIHZhciB0ZW1wbGF0ZVVybCA9ICRhdHRycy5uZ2VvR3JpZFRlbXBsYXRldXJsO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ25nZW8vZ3JpZCc7XG59KTtcbm5nZW9HcmlkVGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRhdHRyc1wiLCBcIm5nZW9HcmlkVGVtcGxhdGVVcmxcIl07XG5cbmZ1bmN0aW9uIG5nZW9HcmlkVGVtcGxhdGVVcmwoJGF0dHJzLCBuZ2VvR3JpZFRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBuZ2VvR3JpZFRlbXBsYXRlVXJsKCRhdHRycyk7XG59XG5cbnZhciBncmlkQ29tcG9uZW50ID0ge1xuICBjb250cm9sbGVyOiBHcmlkQ29udHJvbGxlcixcbiAgYmluZGluZ3M6IHtcbiAgICAnY29uZmlndXJhdGlvbic6ICc9bmdlb0dyaWRDb25maWd1cmF0aW9uJ1xuICB9LFxuICB0ZW1wbGF0ZVVybDogbmdlb0dyaWRUZW1wbGF0ZVVybFxufTtcbm1vZHVsZS5jb21wb25lbnQoJ25nZW9HcmlkJywgZ3JpZENvbXBvbmVudCk7XG5leHBvcnQgZnVuY3Rpb24gR3JpZENvbnRyb2xsZXIoJHNjb3BlKSB7XG4gIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICB0aGlzLmNvbmZpZ3VyYXRpb24gPSBudWxsO1xuICB0aGlzLnNlbGVjdGVkUm93cyA9IHt9O1xuICB0aGlzLnNvcnRlZEJ5ID0gJyc7XG4gIHRoaXMuc29ydEFzY2VuZGluZyA9IHRydWU7XG4gIHRoaXMuZmxvYXRUaGVhZENvbmZpZyA9IHtcbiAgICBzY3JvbGxDb250YWluZXI6IGZ1bmN0aW9uIHNjcm9sbENvbnRhaW5lcigkdGFibGUpIHtcbiAgICAgIHJldHVybiAkdGFibGUuY2xvc2VzdCgnLm5nZW8tZ3JpZC10YWJsZS1jb250YWluZXInKTtcbiAgICB9XG4gIH07XG59XG5cbkdyaWRDb250cm9sbGVyLnByb3RvdHlwZS4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMuY29uZmlndXJhdGlvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjb25maWd1cmF0aW9uJyk7XG4gIH1cblxuICB0aGlzLnNlbGVjdGVkUm93cyA9IHRoaXMuY29uZmlndXJhdGlvbi5zZWxlY3RlZFJvd3M7XG59O1xuXG5HcmlkQ29udHJvbGxlci5wcm90b3R5cGUuc29ydCA9IGZ1bmN0aW9uIChjb2x1bW5OYW1lKSB7XG4gIGlmICghdGhpcy5jb25maWd1cmF0aW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNvbmZpZ3VyYXRpb24nKTtcbiAgfVxuXG4gIGlmICghdGhpcy5jb25maWd1cmF0aW9uLmRhdGEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY29uZmlndXJhdGlvbi5kYXRhJyk7XG4gIH1cblxuICB0aGlzLnNvcnRBc2NlbmRpbmcgPSB0aGlzLnNvcnRlZEJ5ID09PSBjb2x1bW5OYW1lID8gIXRoaXMuc29ydEFzY2VuZGluZyA6IHRydWU7XG4gIHRoaXMuc29ydGVkQnkgPSBjb2x1bW5OYW1lO1xuICB2YXIgYXNjID0gdGhpcy5zb3J0QXNjZW5kaW5nID8gMSA6IC0xO1xuICB0aGlzLmNvbmZpZ3VyYXRpb24uZGF0YS5zb3J0KGZ1bmN0aW9uIChhdHRyaWJ1dGVzMSwgYXR0cmlidXRlczIpIHtcbiAgICBpZiAoIWF0dHJpYnV0ZXMxW2NvbHVtbk5hbWVdKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9XG5cbiAgICBpZiAoIWF0dHJpYnV0ZXMyW2NvbHVtbk5hbWVdKSB7XG4gICAgICByZXR1cm4gLTE7XG4gICAgfVxuXG4gICAgcmV0dXJuIGF0dHJpYnV0ZXMxW2NvbHVtbk5hbWVdID4gYXR0cmlidXRlczJbY29sdW1uTmFtZV0gPyBhc2MgOiAtYXNjO1xuICB9KTtcbn07XG5cbkdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5jbGlja1JvdyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzLCBldmVudCkge1xuICB2YXIgc2hpZnRLZXkgPSBpc1NoaWZ0S2V5T25seShldmVudCk7XG4gIHZhciBwbGF0Zm9ybU1vZGlmaWVyS2V5ID0gaXNQbGF0Zm9ybU1vZGlmaWVyS2V5T25seShldmVudCk7XG4gIHRoaXMuY2xpY2tSb3dfKGF0dHJpYnV0ZXMsIHNoaWZ0S2V5LCBwbGF0Zm9ybU1vZGlmaWVyS2V5KTtcbn07XG5cbkdyaWRDb250cm9sbGVyLnByb3RvdHlwZS5jbGlja1Jvd18gPSBmdW5jdGlvbiAoYXR0cmlidXRlcywgc2hpZnRLZXksIHBsYXRmb3JtTW9kaWZpZXJLZXkpIHtcbiAgaWYgKCF0aGlzLmNvbmZpZ3VyYXRpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY29uZmlndXJhdGlvbicpO1xuICB9XG5cbiAgaWYgKHNoaWZ0S2V5ICYmICFwbGF0Zm9ybU1vZGlmaWVyS2V5KSB7XG4gICAgdGhpcy5zZWxlY3RSYW5nZV8oYXR0cmlidXRlcyk7XG4gIH0gZWxzZSBpZiAoIXNoaWZ0S2V5ICYmIHBsYXRmb3JtTW9kaWZpZXJLZXkpIHtcbiAgICB0aGlzLmNvbmZpZ3VyYXRpb24udG9nZ2xlUm93KGF0dHJpYnV0ZXMpO1xuICB9IGVsc2Uge1xuICAgIHZhciBpc1NlbGVjdGVkID0gdGhpcy5jb25maWd1cmF0aW9uLmlzUm93U2VsZWN0ZWQoYXR0cmlidXRlcyk7XG4gICAgdGhpcy5jb25maWd1cmF0aW9uLnVuc2VsZWN0QWxsKCk7XG5cbiAgICBpZiAoIWlzU2VsZWN0ZWQpIHtcbiAgICAgIHRoaXMuY29uZmlndXJhdGlvbi5zZWxlY3RSb3coYXR0cmlidXRlcyk7XG4gICAgfVxuICB9XG59O1xuXG5HcmlkQ29udHJvbGxlci5wcm90b3R5cGUuc2VsZWN0UmFuZ2VfID0gZnVuY3Rpb24gKGF0dHJpYnV0ZXMpIHtcbiAgaWYgKCF0aGlzLmNvbmZpZ3VyYXRpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY29uZmlndXJhdGlvbicpO1xuICB9XG5cbiAgaWYgKCF0aGlzLmNvbmZpZ3VyYXRpb24uZGF0YSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjb25maWd1cmF0aW9uLmRhdGEnKTtcbiAgfVxuXG4gIHZhciB0YXJnZXRVaWQgPSBnZXRSb3dVaWQoYXR0cmlidXRlcyk7XG4gIHZhciBkYXRhID0gdGhpcy5jb25maWd1cmF0aW9uLmRhdGE7XG5cbiAgaWYgKHRoaXMuY29uZmlndXJhdGlvbi5pc1Jvd1NlbGVjdGVkKGF0dHJpYnV0ZXMpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHBvc0NsaWNrZWRSb3cgPSAwO1xuICB2YXIgcG9zU2VsZWN0ZWRSb3dzID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGN1cnJlbnRSb3cgPSBkYXRhW2ldO1xuICAgIHZhciBjdXJyZW50VWlkID0gZ2V0Um93VWlkKGN1cnJlbnRSb3cpO1xuXG4gICAgaWYgKHRhcmdldFVpZCA9PT0gY3VycmVudFVpZCkge1xuICAgICAgcG9zQ2xpY2tlZFJvdyA9IGk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbmZpZ3VyYXRpb24uaXNSb3dTZWxlY3RlZChjdXJyZW50Um93KSkge1xuICAgICAgcG9zU2VsZWN0ZWRSb3dzLnB1c2goaSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHBvc1NlbGVjdGVkUm93cy5sZW5ndGggPT0gMCkge1xuICAgIHRoaXMuY29uZmlndXJhdGlvbi5zZWxlY3RSb3coYXR0cmlidXRlcyk7XG4gIH1cblxuICB2YXIgZGlzdGFuY2UgPSBJbmZpbml0eTtcbiAgdmFyIHBvc0Nsb3Nlc3RSb3cgPSBwb3NTZWxlY3RlZFJvd3NbMF07XG5cbiAgZm9yICh2YXIgX2kgPSAwLCBfcG9zU2VsZWN0ZWRSb3dzID0gcG9zU2VsZWN0ZWRSb3dzOyBfaSA8IF9wb3NTZWxlY3RlZFJvd3MubGVuZ3RoOyBfaSsrKSB7XG4gICAgdmFyIHBvc1NlbGVjdGVkUm93ID0gX3Bvc1NlbGVjdGVkUm93c1tfaV07XG4gICAgdmFyIGN1cnJlbnRQb3MgPSBwb3NTZWxlY3RlZFJvdztcbiAgICB2YXIgY3VycmVudERpc3RhbmNlID0gTWF0aC5hYnMoY3VycmVudFBvcyAtIHBvc0NsaWNrZWRSb3cpO1xuXG4gICAgaWYgKGRpc3RhbmNlID4gY3VycmVudERpc3RhbmNlKSB7XG4gICAgICBkaXN0YW5jZSA9IGN1cnJlbnREaXN0YW5jZTtcbiAgICAgIHBvc0Nsb3Nlc3RSb3cgPSBjdXJyZW50UG9zO1xuICAgIH1cbiAgfVxuXG4gIHZhciByYW5nZVN0YXJ0ID0gcG9zQ2xpY2tlZFJvdyA8IHBvc0Nsb3Nlc3RSb3cgPyBwb3NDbGlja2VkUm93IDogcG9zQ2xvc2VzdFJvdztcbiAgdmFyIHJhbmdlRW5kID0gcG9zQ2xpY2tlZFJvdyA+IHBvc0Nsb3Nlc3RSb3cgPyBwb3NDbGlja2VkUm93IDogcG9zQ2xvc2VzdFJvdztcblxuICBmb3IgKHZhciBsID0gcmFuZ2VTdGFydDsgbCA8PSByYW5nZUVuZDsgbCsrKSB7XG4gICAgdGhpcy5jb25maWd1cmF0aW9uLnNlbGVjdFJvdyhkYXRhW2xdKTtcbiAgfVxufTtcblxuR3JpZENvbnRyb2xsZXIucHJvdG90eXBlLnByZXZlbnRUZXh0U2VsZWN0aW9uID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gIHZhciBzaGlmdEtleSA9IGlzU2hpZnRLZXlPbmx5KGV2ZW50KTtcbiAgdmFyIHBsYXRmb3JtTW9kaWZpZXJLZXkgPSBpc1BsYXRmb3JtTW9kaWZpZXJLZXlPbmx5KGV2ZW50KTtcblxuICBpZiAoc2hpZnRLZXkgfHwgcGxhdGZvcm1Nb2RpZmllcktleSkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGlzUGxhdGZvcm1Nb2RpZmllcktleU9ubHkoZXZlbnQpIHtcbiAgcmV0dXJuICFldmVudC5hbHRLZXkgJiYgKE1BQyA/IGV2ZW50Lm1ldGFLZXkgOiBldmVudC5jdHJsS2V5KSAmJiAhZXZlbnQuc2hpZnRLZXk7XG59XG5cbmZ1bmN0aW9uIGlzU2hpZnRLZXlPbmx5KGV2ZW50KSB7XG4gIHJldHVybiAhZXZlbnQuYWx0S2V5ICYmICEoZXZlbnQubWV0YUtleSB8fCBldmVudC5jdHJsS2V5KSAmJiBldmVudC5zaGlmdEtleTtcbn1cblxubW9kdWxlLmNvbnRyb2xsZXIoJ25nZW9HcmlkQ29udHJvbGxlcicsIEdyaWRDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAxNiAxNlxcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk03Ljk0OCAxMC4yNWMtMS4yNi4wMDktMi4zNDktMS4yMy0yLjE4NC0yLjQ4LjExLTEuMTUzIDEuMjE4LTIuMTI0IDIuMzg3LTIuMDEzIDEuMDY0LjA2IDIuMDIyLjk1NiAyLjA5IDIuMDI4LjEuOTc1LS40OTIgMS45NzMtMS40MiAyLjMxYTIuMjExIDIuMjExIDAgMDEtLjg3My4xNTV6bS4wNDctMS4zNTdjLjYwNi4wMyAxLjEwMy0uNzAzLjgyNy0xLjI0OC0uMjE1LS40OTktLjkzNC0uNzA5LTEuMzU3LS4zNDMtLjM5My4zLS40Ny45NDEtLjExIDEuMjk1LjE2LjE4LjM5NS4yOTUuNjQuMjk2elxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB2aWV3Qm94PVxcXCIwIDAgMTYgMTZcXFwiIHdpZHRoPVxcXCIxZW1cXFwiIGhlaWdodD1cXFwiMWVtXFxcIj48cGF0aCBkPVxcXCJNNS4wNDUtLjAyOWMtMS4yNi0uMDA4LTIuMzUgMS4yMy0yLjE4NCAyLjQ4LjA2LjYzMi40MyAxLjIwMi45MzYgMS41NzYtLjQ3OSAxLjM1OC0uOTY4IDIuNzE0LTEuNDUgNC4wNzItMS4yNTctLjAwOC0yLjM2MyAxLjIzLTIuMiAyLjQ4LjEwNSAxLjE2IDEuMjI4IDIuMTMgMi40MDIgMi4wMTJhMi4yOTUgMi4yOTUgMCAwMDEuNDUtLjY3YzEuMjczLjUzIDIuNTUzIDEuMDU2IDMuODIzIDEuNTlhMS45OTIgMS45OTIgMCAwMDAgLjQzOGMuMDc0IDEuMTY1IDEuMTc2IDIuMTcgMi4zNTUgMi4wNzQgMS4wNy0uMDQyIDIuMDU3LS45MzIgMi4xMzgtMi4wMTJhMi4yOTUgMi4yOTUgMCAwMC0uNDUzLTEuNjA3Yy40MzUtLjU5My44NzMtMS4xODYgMS4zMS0xLjc3OC4xODYuMDQuMzY5LjA0Ny41NjIuMDMxIDEuMDY3LS4wNDcgMi4wNC0uOTM1IDIuMTIyLTIuMDEyLjExLS45NjQtLjQ2NC0xLjk1OS0xLjM3My0yLjMxYTIuMjAyIDIuMjAyIDAgMDAtLjM0My0uMTA4IDQ0NC4yNyA0NDQuMjcgMCAwMS0uMTI1LTEuODU3Yy43NDMtLjMxMyAxLjMyNi0xLjAzNiAxLjM4OC0xLjg1Ni4xMS0uOTY0LS40NjMtMS45NTgtMS4zNzItMi4zMDlhMi4xOTYgMi4xOTYgMCAwMC0uOTItLjE3MmMtLjA4IDAtLjE1OC0uMDA4LS4yMzUgMC0uODQxLjA5OC0xLjU2NS43NS0xLjg0IDEuNTQ1LTEuMjYtLjAwNC0yLjUzLS4wMDktMy43OTEtLjAxNkM3LjA0NS45MTggNi41NjQuMzYxIDUuOTE5LjEyN2EyLjIxMSAyLjIxMSAwIDAwLS44NzQtLjE1NnptLjA0NyAxLjM1N2MuNjA1LS4wMyAxLjEwMy43MDQuODI3IDEuMjQ4LS4yMTUuNDk5LS45MzQuNzEtMS4zNTguMzQzLS4zOTItLjI5OS0uNDctLjk0LS4xMDktMS4yOTRhLjg3NC44NzQgMCAwMS42NC0uMjk3em04LjA4LjA2M2MuNjItLjAyNiAxLjA5OS43MTkuNzk2IDEuMjYzLS4yMzIuNDk4LS45NjcuNjkyLTEuMzczLjI5Ny0uMzYxLS4zMDgtLjQzMS0uOTM5LS4wNzgtMS4yOGEuODk5Ljg5OSAwIDAxLjY1Ni0uMjh6TTcuMjQ2IDIuOTE5YzEuMjU3LjAwNSAyLjUxNy4wMjQgMy43NzUuMDMyYTIuMzMzIDIuMzMzIDAgMDAxLjYyMiAxLjUxM2MuMDQzLjYyNC4wODQgMS4yNDguMTI1IDEuODcyLS44NzcuMzc2LTEuNTExIDEuMzIyLTEuMzg4IDIuMjkzLjA0Mi40ODIuMjY3Ljk0LjU5MiAxLjI5NS0uNDE2LjU2Ny0uODI2IDEuMTM2LTEuMjQ4IDEuN2EyLjA0NSAyLjA0NSAwIDAwLS42Ny0uMTA5di4wMTZjLS42MzItLjAxMi0xLjIzNS4yODctMS42NTQuNzQ4LTEuMjYtLjUyNS0yLjUxNy0xLjA2My0zLjc3NS0xLjU5LjAwNS0uMDQzLjAxMy0uMDgzLjAxNS0uMTI2YTIuMjc0IDIuMjc0IDAgMDAtLjk2Ny0yLjA3NGMuNDcyLTEuMzQyLjk0NC0yLjY4NSAxLjQyLTQuMDI1LjA1MiAwIC4xMDQuMDA1LjE1NiAwIC44OTgtLjA1IDEuNzItLjcgMS45OTctMS41NDV6bTYuMzggNC42MDJjLjYyLS4wMjUgMS4wOTguNzIuNzk2IDEuMjY0LS4yMzMuNDk3LS45NjcuNjkxLTEuMzczLjI5Ni0uMzYyLS4zMDgtLjQzMi0uOTM4LS4wNzgtMS4yNzlhLjg5OS44OTkgMCAwMS42NTUtLjI4ek0yLjM5MyA5LjQ1NmMuNjEyLS4wMjggMS4xMDkuNzI5LjgxMSAxLjI4LS4yMjguNDkzLS45NDIuNjgtMS4zNTcuMzExLS4zNzctLjMtLjQ2LS45MjYtLjExLTEuMjhhLjkuOSAwIDAxLjY1Ni0uMzExem03LjY2IDMuNDMyYy42MTUtLjAzNyAxLjEyLjcxMS44MjYgMS4yNjMtLjIxNy40OC0uOTEuNjg0LTEuMzI2LjM0NC0uNDIzLS4yOTctLjQ5NS0uOTg2LS4xMDktMS4zNDJhLjg1Ny44NTcgMCAwMS42MDktLjI2NXpcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgdmlld0JveD1cXFwiMCAwIDE2IDE2XFxcIiB3aWR0aD1cXFwiMWVtXFxcIiBoZWlnaHQ9XFxcIjFlbVxcXCI+PHBhdGggZD1cXFwiTTIuMzE3IDE0LjQ5MWEyLjIwMyAyLjIwMyAwIDAxLS44NzQtLjE1NkMuMjU3IDEzLjkxLS4zNDMgMTIuMzguMjQyIDExLjI2MmEyLjI2NSAyLjI2NSAwIDAxMS4yOC0xLjEzOWwtLjAxNi00LjI1OGMtLjAyLS4wMDgtLjA0Mi0uMDA4LS4wNjMtLjAxNkMuMjU4IDUuNDI0LS4zNDMgMy44OTQuMjQzIDIuNzc2Ljc0IDEuNzMxIDIuMTE1IDEuMTk0IDMuMTc0IDEuN2MuNTcyLjI0NiAxLjAwNy43NDcgMS4yMTcgMS4zMjZMMTEuNiAzLjAxYy4wMjgtLjA3Ny4wNTUtLjE2LjA5My0uMjM0LjUtMS4wNDUgMS44NzQtMS41ODIgMi45MzMtMS4wNzYuOTc5LjQyMiAxLjU4NCAxLjU5IDEuMjggMi42MmEyLjMwMiAyLjMwMiAwIDAxLTEuNDY3IDEuNTc2bC4wMTYgNC4yMjhjLjA1Ny4wMi4xMTUuMDM1LjE3MS4wNjIuOTc5LjQyMiAxLjU4NCAxLjU5IDEuMjggMi42MjEtLjI0Ljk1LTEuMTUxIDEuNjg4LTIuMTM3IDEuNjg1YTIuMjAzIDIuMjAzIDAgMDEtLjg3NC0uMTU2Yy0uNjI1LS4yMjQtMS4wODMtLjc1Ny0xLjI5NS0xLjM3M2wtNy4yMDcuMDE1Yy0uMzAyLjg2NC0xLjE1MSAxLjUxNi0yLjA3NSAxLjUxM3ptLS4xNC0xLjM1N2MuNTA4LjA1MiAxLjA0NS0uNDIuOTgyLS45NTEtLjAzLS41NDItLjYzLS45NzgtMS4xNTQtLjc4LS40NzIuMTQ2LS43NjQuNzEzLS41NDcgMS4xNy4wODkuMjIzLjI3LjQxMy41LjQ5OWEuNzkuNzkgMCAwMC4yMTguMDYyem0xMS40NSAwYy41MDkuMDUyIDEuMDQ1LS40Mi45ODItLjk1MS0uMDMtLjU0Mi0uNjMtLjk3OC0xLjE1NC0uNzgtLjQ3Mi4xNDYtLjc2NC43MTMtLjU0NiAxLjE3LjA4OC4yMjMuMjcuNDEzLjQ5OS40OTlhLjc5Ljc5IDAgMDAuMjE4LjA2MnpNNC4zOSAxMS41MjdsNy4xOTItLjAxNWMuMDMtLjA4NC4wNjctLjE3LjEwOS0uMjUuMjU5LS41NDIuNzQ3LS45NDQgMS4zMS0xLjEzOVY1Ljg4Yy0uMDM2LS4wMTItLjA3My0uMDE3LS4xMDktLjAzMS0uNjI4LS4yMjUtMS4wODUtLjc2OC0xLjI5NS0xLjM4OEg0LjQwN2EyLjMzNCAyLjMzNCAwIDAxLTEuNDIgMS40MzVsLjAxNSA0LjIyN2MuMDU2LjAyLjExOC4wMzcuMTcyLjA2My41NzYuMjQ4IDEuMDA5Ljc1NyAxLjIxNyAxLjM0MnptLTIuMjE1LTYuODhjLjUxLjA1MiAxLjA0Ni0uNDIuOTgzLS45NS0uMDMtLjU0My0uNjMtLjk3OS0xLjE1NC0uNzgxLS40NzIuMTQ2LS43NjQuNzE0LS41NDcgMS4xNy4wODkuMjI0LjI3LjQxNC41LjVhLjc5Ljc5IDAgMDAuMjE4LjA2MnptMTEuNDUgMGMuNTEuMDUyIDEuMDQ2LS40Mi45ODMtLjk1LS4wMy0uNTQzLS42My0uOTc5LTEuMTU0LS43ODEtLjQ3Mi4xNDYtLjc2NC43MTQtLjU0NiAxLjE3LjA4OC4yMjQuMjcuNDE0LjQ5OS41YS43OS43OSAwIDAwLjIxOC4wNjJ6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIGFyaWEtaGlkZGVuPVxcXCJ0cnVlXFxcIiBkYXRhLXByZWZpeD1cXFwiZmFzXFxcIiBkYXRhLWljb249XFxcInNvcnRcXFwiIGNsYXNzPVxcXCJzdmctaW5saW5lLS1mYSBmYS1zb3J0IGZhLXctMTBcXFwiIHZpZXdCb3g9XFxcIjAgMCAxNiAxNlxcXCIgd2lkdGg9XFxcIjFlbVxcXCIgaGVpZ2h0PVxcXCIxZW1cXFwiPjxwYXRoIGQ9XFxcIk05LjI4NiAxMi43ODNWMy4yMTdjMC0uODYgMS4wNDEtMS4yOSAxLjY0OC0uNjgzbDQuNzgzIDQuNzgzYS45Ni45NiAwIDAxMCAxLjM2MmwtNC43ODMgNC43ODdjLS42MDcuNjA3LTEuNjQ4LjE3Ny0xLjY0OC0uNjgzek01LjA2NiAyLjUzNEwuMjgzIDcuMzE3YS45Ni45NiAwIDAwMCAxLjM2Mmw0Ljc4MyA0Ljc4N2MuNjA3LjYwNyAxLjY0OC4xNzcgMS42NDgtLjY4M1YzLjIxN2MwLS44Ni0xLjA0MS0xLjI5LTEuNjQ4LS42ODN6XFxcIiBmaWxsPVxcXCJjdXJyZW50Q29sb3JcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgYXJpYS1oaWRkZW49XFxcInRydWVcXFwiIGRhdGEtcHJlZml4PVxcXCJmYXNcXFwiIGRhdGEtaWNvbj1cXFwic29ydFxcXCIgY2xhc3M9XFxcInN2Zy1pbmxpbmUtLWZhIGZhLXNvcnQgZmEtdy0xMFxcXCIgdmlld0JveD1cXFwiMCAwIDE2IDE2XFxcIiB3aWR0aD1cXFwiMWVtXFxcIiBoZWlnaHQ9XFxcIjFlbVxcXCI+PHBhdGggZD1cXFwiTTkuMjg2IDEyLjc4M1YzLjIxN2MwLS44NiAxLjA0MS0xLjI5IDEuNjQ4LS42ODNsNC43ODMgNC43ODNhLjk2Ljk2IDAgMDEwIDEuMzYybC00Ljc4MyA0Ljc4N2MtLjYwNy42MDctMS42NDguMTc3LTEuNjQ4LS42ODN6TTUuMDY2IDIuNTM0TC4yODMgNy4zMTdhLjk2Ljk2IDAgMDAwIDEuMzYybDQuNzgzIDQuNzg3Yy42MDcuNjA3IDEuNjQ4LjE3NyAxLjY0OC0uNjgzVjMuMjE3YzAtLjg2LTEuMDQxLTEuMjktMS42NDgtLjY4M3pcXFwiIGZpbGw9XFxcImN1cnJlbnRDb2xvclxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwiZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgeyBnZXREZWZhdWx0RHJhd1N0eWxlRnVuY3Rpb24gfSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL2NvbW1vbi5qcyc7XG5pbXBvcnQgbmdlb0N1c3RvbUV2ZW50IGZyb20gJ25nZW8vQ3VzdG9tRXZlbnQuanMnO1xuaW1wb3J0IEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4gfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IHsgRkFMU0UgfSBmcm9tICdvbC9mdW5jdGlvbnMuanMnO1xuaW1wb3J0IG9sR2VvbUNpcmNsZSBmcm9tICdvbC9nZW9tL0NpcmNsZS5qcyc7XG5pbXBvcnQgb2xHZW9tR2VvbWV0cnlDb2xsZWN0aW9uIGZyb20gJ29sL2dlb20vR2VvbWV0cnlDb2xsZWN0aW9uLmpzJztcbmltcG9ydCBvbEdlb21MaW5lU3RyaW5nIGZyb20gJ29sL2dlb20vTGluZVN0cmluZy5qcyc7XG5pbXBvcnQgb2xHZW9tUG9pbnQgZnJvbSAnb2wvZ2VvbS9Qb2ludC5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvblBvaW50ZXIgZnJvbSAnb2wvaW50ZXJhY3Rpb24vRHJhdy5qcyc7XG5pbXBvcnQgb2xMYXllclZlY3RvciBmcm9tICdvbC9sYXllci9WZWN0b3IuanMnO1xuaW1wb3J0IFZlY3RvclNvdXJjZSBmcm9tICdvbC9zb3VyY2UvVmVjdG9yLmpzJztcblxudmFyIERyYXdBemltdXQgPSBmdW5jdGlvbiAoX29sSW50ZXJhY3Rpb25Qb2ludGVyKSB7XG4gIF9pbmhlcml0c0xvb3NlKERyYXdBemltdXQsIF9vbEludGVyYWN0aW9uUG9pbnRlcik7XG5cbiAgZnVuY3Rpb24gRHJhd0F6aW11dChvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX3RoaXMgPSBfb2xJbnRlcmFjdGlvblBvaW50ZXIuY2FsbCh0aGlzLCB7XG4gICAgICB0eXBlOiAnJ1xuICAgIH0pIHx8IHRoaXM7XG4gICAgX3RoaXMuc2hvdWxkU3RvcEV2ZW50ID0gRkFMU0U7XG4gICAgX3RoaXMuZG93blB4XyA9IFtdO1xuICAgIF90aGlzLnNvdXJjZV8gPSBvcHRpb25zLnNvdXJjZTtcbiAgICBfdGhpcy5zdGFydGVkXyA9IGZhbHNlO1xuICAgIF90aGlzLnNrZXRjaEZlYXR1cmVfID0gbmV3IEZlYXR1cmUoKTtcbiAgICBfdGhpcy5za2V0Y2hQb2ludF8gPSBuZXcgRmVhdHVyZSgpO1xuICAgIF90aGlzLnNxdWFyZWRDbGlja1RvbGVyYW5jZV8gPSA0O1xuICAgIF90aGlzLnNrZXRjaExheWVyXyA9IG5ldyBvbExheWVyVmVjdG9yKHtcbiAgICAgIHNvdXJjZTogbmV3IFZlY3RvclNvdXJjZSh7XG4gICAgICAgIHVzZVNwYXRpYWxJbmRleDogZmFsc2UsXG4gICAgICAgIHdyYXBYOiBmYWxzZVxuICAgICAgfSksXG4gICAgICBzdHlsZTogb3B0aW9ucy5zdHlsZSB8fCBnZXREZWZhdWx0RHJhd1N0eWxlRnVuY3Rpb24oKVxuICAgIH0pO1xuICAgIGxpc3RlbihfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgJ2NoYW5nZTphY3RpdmUnLCBfdGhpcy51cGRhdGVTdGF0ZV8sIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gRHJhd0F6aW11dC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmhhbmRsZVBvaW50ZXJNb3ZlXyA9IGZ1bmN0aW9uIGhhbmRsZVBvaW50ZXJNb3ZlXyhldmVudCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWRfKSB7XG4gICAgICB0aGlzLm1vZGlmeURyYXdpbmdfKGV2ZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jcmVhdGVPclVwZGF0ZVNrZXRjaFBvaW50XyhldmVudCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgX3Byb3RvLmNyZWF0ZU9yVXBkYXRlU2tldGNoUG9pbnRfID0gZnVuY3Rpb24gY3JlYXRlT3JVcGRhdGVTa2V0Y2hQb2ludF8oZXZlbnQpIHtcbiAgICB2YXIgY29vcmRpbmF0ZXMgPSBldmVudC5jb29yZGluYXRlLnNsaWNlKCk7XG4gICAgdmFyIHNrZXRjaFBvaW50R2VvbSA9IHRoaXMuc2tldGNoUG9pbnRfLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIXNrZXRjaFBvaW50R2VvbSkge1xuICAgICAgdGhpcy5za2V0Y2hQb2ludF8gPSBuZXcgRmVhdHVyZShuZXcgb2xHZW9tUG9pbnQoY29vcmRpbmF0ZXMpKTtcbiAgICAgIHRoaXMudXBkYXRlU2tldGNoRmVhdHVyZXNfKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNrZXRjaFBvaW50R2VvbS5zZXRDb29yZGluYXRlcyhjb29yZGluYXRlcyk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by51cGRhdGVTa2V0Y2hGZWF0dXJlc18gPSBmdW5jdGlvbiB1cGRhdGVTa2V0Y2hGZWF0dXJlc18oKSB7XG4gICAgdmFyIHNrZXRjaEZlYXR1cmVzID0gW107XG4gICAgc2tldGNoRmVhdHVyZXMucHVzaCh0aGlzLnNrZXRjaEZlYXR1cmVfKTtcbiAgICBza2V0Y2hGZWF0dXJlcy5wdXNoKHRoaXMuc2tldGNoUG9pbnRfKTtcbiAgICB2YXIgc291cmNlID0gdGhpcy5za2V0Y2hMYXllcl8uZ2V0U291cmNlKCk7XG4gICAgc291cmNlLmNsZWFyKHRydWUpO1xuICAgIHNvdXJjZS5hZGRGZWF0dXJlcyhza2V0Y2hGZWF0dXJlcyk7XG4gIH07XG5cbiAgX3Byb3RvLnN0YXJ0RHJhd2luZ18gPSBmdW5jdGlvbiBzdGFydERyYXdpbmdfKGV2ZW50KSB7XG4gICAgdmFyIHN0YXJ0ID0gZXZlbnQuY29vcmRpbmF0ZTtcbiAgICB0aGlzLnN0YXJ0ZWRfID0gdHJ1ZTtcbiAgICB2YXIgbGluZSA9IG5ldyBvbEdlb21MaW5lU3RyaW5nKFtzdGFydC5zbGljZSgpLCBzdGFydC5zbGljZSgpXSk7XG4gICAgdmFyIGNpcmNsZSA9IG5ldyBvbEdlb21DaXJjbGUoc3RhcnQsIDApO1xuICAgIHZhciBnZW9tZXRyeSA9IG5ldyBvbEdlb21HZW9tZXRyeUNvbGxlY3Rpb24oW2xpbmUsIGNpcmNsZV0pO1xuICAgIHRoaXMuc2tldGNoRmVhdHVyZV8gPSBuZXcgRmVhdHVyZSgpO1xuICAgIHRoaXMuc2tldGNoRmVhdHVyZV8uc2V0R2VvbWV0cnkoZ2VvbWV0cnkpO1xuICAgIHRoaXMudXBkYXRlU2tldGNoRmVhdHVyZXNfKCk7XG4gICAgdmFyIGV2dCA9IG5ldyBuZ2VvQ3VzdG9tRXZlbnQoJ2RyYXdzdGFydCcsIHtcbiAgICAgIGZlYXR1cmU6IHRoaXMuc2tldGNoRmVhdHVyZV9cbiAgICB9KTtcbiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZ0KTtcbiAgfTtcblxuICBfcHJvdG8ubW9kaWZ5RHJhd2luZ18gPSBmdW5jdGlvbiBtb2RpZnlEcmF3aW5nXyhldmVudCkge1xuICAgIHZhciBjb29yZGluYXRlID0gZXZlbnQuY29vcmRpbmF0ZTtcbiAgICB2YXIgZ2VvbWV0cnkgPSB0aGlzLnNrZXRjaEZlYXR1cmVfLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIShnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbUdlb21ldHJ5Q29sbGVjdGlvbikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZW9tZXRyeScpO1xuICAgIH1cblxuICAgIHZhciBnZW9tZXRyaWVzID0gZ2VvbWV0cnkuZ2V0R2VvbWV0cmllc0FycmF5KCk7XG4gICAgdmFyIGxpbmUgPSBnZW9tZXRyaWVzWzBdO1xuXG4gICAgaWYgKGxpbmUgaW5zdGFuY2VvZiBvbEdlb21MaW5lU3RyaW5nKSB7XG4gICAgICB2YXIgY29vcmRpbmF0ZXMgPSBsaW5lLmdldENvb3JkaW5hdGVzKCk7XG4gICAgICB2YXIgc2tldGNoUG9pbnRHZW9tID0gdGhpcy5za2V0Y2hQb2ludF8uZ2V0R2VvbWV0cnkoKTtcblxuICAgICAgaWYgKHNrZXRjaFBvaW50R2VvbSBpbnN0YW5jZW9mIG9sR2VvbVBvaW50KSB7XG4gICAgICAgIHNrZXRjaFBvaW50R2VvbS5zZXRDb29yZGluYXRlcyhjb29yZGluYXRlKTtcbiAgICAgICAgdmFyIGxhc3QgPSBjb29yZGluYXRlc1tjb29yZGluYXRlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgbGFzdFswXSA9IGNvb3JkaW5hdGVbMF07XG4gICAgICAgIGxhc3RbMV0gPSBjb29yZGluYXRlWzFdO1xuICAgICAgICBjb25zb2xlLmFzc2VydChsaW5lIGluc3RhbmNlb2Ygb2xHZW9tTGluZVN0cmluZyk7XG4gICAgICAgIGxpbmUuc2V0Q29vcmRpbmF0ZXMoY29vcmRpbmF0ZXMpO1xuICAgICAgICB2YXIgY2lyY2xlID0gZ2VvbWV0cmllc1sxXTtcblxuICAgICAgICBpZiAoY2lyY2xlIGluc3RhbmNlb2Ygb2xHZW9tQ2lyY2xlKSB7XG4gICAgICAgICAgY2lyY2xlLnNldFJhZGl1cyhsaW5lLmdldExlbmd0aCgpKTtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVNrZXRjaEZlYXR1cmVzXygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5hYm9ydERyYXdpbmdfID0gZnVuY3Rpb24gYWJvcnREcmF3aW5nXygpIHtcbiAgICB0aGlzLnN0YXJ0ZWRfID0gZmFsc2U7XG4gICAgdmFyIHNrZXRjaEZlYXR1cmUgPSB0aGlzLnNrZXRjaEZlYXR1cmVfO1xuICAgIHRoaXMuc2tldGNoRmVhdHVyZV8gPSBuZXcgRmVhdHVyZSgpO1xuICAgIHRoaXMuc2tldGNoUG9pbnRfID0gbmV3IEZlYXR1cmUoKTtcbiAgICB2YXIgc291cmNlID0gdGhpcy5za2V0Y2hMYXllcl8uZ2V0U291cmNlKCk7XG5cbiAgICBpZiAoIShzb3VyY2UgaW5zdGFuY2VvZiBWZWN0b3JTb3VyY2UpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc291cmNlJyk7XG4gICAgfVxuXG4gICAgc291cmNlLmNsZWFyKHRydWUpO1xuICAgIHJldHVybiBza2V0Y2hGZWF0dXJlO1xuICB9O1xuXG4gIF9wcm90by51cGRhdGVTdGF0ZV8gPSBmdW5jdGlvbiB1cGRhdGVTdGF0ZV8oKSB7XG4gICAgdmFyIG1hcCA9IHRoaXMuZ2V0TWFwKCk7XG4gICAgdmFyIGFjdGl2ZSA9IHRoaXMuZ2V0QWN0aXZlKCk7XG5cbiAgICBpZiAobWFwID09PSBudWxsIHx8ICFhY3RpdmUpIHtcbiAgICAgIHRoaXMuYWJvcnREcmF3aW5nXygpO1xuICAgIH1cblxuICAgIHRoaXMuc2tldGNoTGF5ZXJfLnNldE1hcChhY3RpdmUgPyBtYXAgOiBudWxsKTtcbiAgfTtcblxuICBfcHJvdG8uZmluaXNoRHJhd2luZ18gPSBmdW5jdGlvbiBmaW5pc2hEcmF3aW5nXygpIHtcbiAgICB2YXIgc2tldGNoRmVhdHVyZSA9IHRoaXMuYWJvcnREcmF3aW5nXygpO1xuICAgIHRoaXMuc291cmNlXy5hZGRGZWF0dXJlKHNrZXRjaEZlYXR1cmUpO1xuICAgIHZhciBldmVudCA9IG5ldyBuZ2VvQ3VzdG9tRXZlbnQoJ2RyYXdlbmQnLCB7XG4gICAgICBmZWF0dXJlOiB0aGlzLnNrZXRjaEZlYXR1cmVfXG4gICAgfSk7XG4gICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfTtcblxuICBfcHJvdG8uc2V0TWFwID0gZnVuY3Rpb24gc2V0TWFwKG1hcCkge1xuICAgIG9sSW50ZXJhY3Rpb25Qb2ludGVyLnByb3RvdHlwZS5zZXRNYXAuY2FsbCh0aGlzLCBtYXApO1xuICAgIHRoaXMudXBkYXRlU3RhdGVfKCk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZURvd25FdmVudCA9IGZ1bmN0aW9uIGhhbmRsZURvd25FdmVudChldmVudCkge1xuICAgIHRoaXMuZG93blB4XyA9IGV2ZW50LnBpeGVsO1xuICAgIHJldHVybiB0cnVlO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVVcEV2ZW50ID0gZnVuY3Rpb24gaGFuZGxlVXBFdmVudChldmVudCkge1xuICAgIGlmICghdGhpcy5kb3duUHhfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZG93blB4Jyk7XG4gICAgfVxuXG4gICAgdmFyIGRvd25QeCA9IHRoaXMuZG93blB4XztcbiAgICB2YXIgY2xpY2tQeCA9IGV2ZW50LnBpeGVsO1xuICAgIHZhciBkeCA9IGRvd25QeFswXSAtIGNsaWNrUHhbMF07XG4gICAgdmFyIGR5ID0gZG93blB4WzFdIC0gY2xpY2tQeFsxXTtcbiAgICB2YXIgc3F1YXJlZERpc3RhbmNlID0gZHggKiBkeCArIGR5ICogZHk7XG4gICAgdmFyIHBhc3MgPSB0cnVlO1xuXG4gICAgaWYgKHNxdWFyZWREaXN0YW5jZSA8PSB0aGlzLnNxdWFyZWRDbGlja1RvbGVyYW5jZV8pIHtcbiAgICAgIHRoaXMuaGFuZGxlUG9pbnRlck1vdmVfKGV2ZW50KTtcblxuICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWRfKSB7XG4gICAgICAgIHRoaXMuc3RhcnREcmF3aW5nXyhldmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmZpbmlzaERyYXdpbmdfKCk7XG4gICAgICB9XG5cbiAgICAgIHBhc3MgPSBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGFzcztcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRXZlbnQgPSBmdW5jdGlvbiBoYW5kbGVFdmVudChtYXBCcm93c2VyRXZlbnQpIHtcbiAgICB2YXIgcGFzcyA9IHRydWU7XG5cbiAgICBpZiAobWFwQnJvd3NlckV2ZW50LnR5cGUgPT09ICdwb2ludGVybW92ZScpIHtcbiAgICAgIHBhc3MgPSB0aGlzLmhhbmRsZVBvaW50ZXJNb3ZlXyhtYXBCcm93c2VyRXZlbnQpO1xuICAgIH0gZWxzZSBpZiAobWFwQnJvd3NlckV2ZW50LnR5cGUgPT09ICdkYmxjbGljaycpIHtcbiAgICAgIHBhc3MgPSBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gX29sSW50ZXJhY3Rpb25Qb2ludGVyLnByb3RvdHlwZS5oYW5kbGVFdmVudC5jYWxsKHRoaXMsIG1hcEJyb3dzZXJFdmVudCkgJiYgcGFzcztcbiAgfTtcblxuICByZXR1cm4gRHJhd0F6aW11dDtcbn0ob2xJbnRlcmFjdGlvblBvaW50ZXIpO1xuXG5leHBvcnQgZGVmYXVsdCBEcmF3QXppbXV0OyIsImZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IG5nZW9DdXN0b21FdmVudCBmcm9tICduZ2VvL0N1c3RvbUV2ZW50LmpzJztcbmltcG9ydCAqIGFzIG9sRG9tIGZyb20gJ29sL2RvbS5qcyc7XG5pbXBvcnQgKiBhcyBvbFByb2ogZnJvbSAnb2wvcHJvai5qcyc7XG5pbXBvcnQgb2xPdmVybGF5IGZyb20gJ29sL092ZXJsYXkuanMnO1xuaW1wb3J0ICogYXMgb2xTcGhlcmUgZnJvbSAnb2wvc3BoZXJlLmpzJztcbmltcG9ydCB7IGxpc3RlbiwgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvbkludGVyYWN0aW9uIGZyb20gJ29sL2ludGVyYWN0aW9uL0ludGVyYWN0aW9uLmpzJztcbmltcG9ydCBvbExheWVyVmVjdG9yIGZyb20gJ29sL2xheWVyL1ZlY3Rvci5qcyc7XG5pbXBvcnQgb2xTb3VyY2VWZWN0b3IgZnJvbSAnb2wvc291cmNlL1ZlY3Rvci5qcyc7XG5pbXBvcnQgb2xTdHlsZUZpbGwgZnJvbSAnb2wvc3R5bGUvRmlsbC5qcyc7XG5pbXBvcnQgb2xTdHlsZVN0cm9rZSBmcm9tICdvbC9zdHlsZS9TdHJva2UuanMnO1xuaW1wb3J0IG9sU3R5bGVTdHlsZSBmcm9tICdvbC9zdHlsZS9TdHlsZS5qcyc7XG5pbXBvcnQgVmVjdG9yU291cmNlIGZyb20gJ29sL3NvdXJjZS9WZWN0b3IuanMnO1xuXG52YXIgTWVhc3VyZSA9IGZ1bmN0aW9uIChfb2xJbnRlcmFjdGlvbkludGVyYWMpIHtcbiAgX2luaGVyaXRzTG9vc2UoTWVhc3VyZSwgX29sSW50ZXJhY3Rpb25JbnRlcmFjKTtcblxuICBmdW5jdGlvbiBNZWFzdXJlKG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuXG4gICAgX3RoaXMgPSBfb2xJbnRlcmFjdGlvbkludGVyYWMuY2FsbCh0aGlzLCB7XG4gICAgICBoYW5kbGVFdmVudDogaGFuZGxlRXZlbnRfXG4gICAgfSkgfHwgdGhpcztcbiAgICBfdGhpcy5oZWxwVG9vbHRpcEVsZW1lbnRfID0gbnVsbDtcbiAgICBfdGhpcy5oZWxwVG9vbHRpcE92ZXJsYXlfID0gbnVsbDtcbiAgICBfdGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfID0gbnVsbDtcbiAgICBfdGhpcy5tZWFzdXJlVG9vbHRpcE92ZXJsYXlfID0gbnVsbDtcbiAgICBfdGhpcy5tZWFzdXJlVG9vbHRpcE92ZXJsYXlDb29yZF8gPSBudWxsO1xuICAgIF90aGlzLnNrZXRjaEZlYXR1cmUgPSBudWxsO1xuICAgIF90aGlzLmNvbnRpbnVlTXNnID0gbnVsbDtcbiAgICBfdGhpcy5kZWNpbWFscyA9IG9wdGlvbnMuZGVjaW1hbHM7XG4gICAgX3RoaXMucHJlY2lzaW9uID0gb3B0aW9ucy5wcmVjaXNpb247XG4gICAgX3RoaXMuZGlzcGxheUhlbHBUb29sdGlwXyA9IG9wdGlvbnMuZGlzcGxheUhlbHBUb29sdGlwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmRpc3BsYXlIZWxwVG9vbHRpcCA6IHRydWU7XG4gICAgdmFyIHN0YXJ0TXNnO1xuXG4gICAgaWYgKG9wdGlvbnMuc3RhcnRNc2cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc3RhcnRNc2cgPSBvcHRpb25zLnN0YXJ0TXNnO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGFydE1zZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIHN0YXJ0TXNnLnRleHRDb250ZW50ID0gJ0NsaWNrIHRvIHN0YXJ0IGRyYXdpbmcuJztcbiAgICB9XG5cbiAgICBfdGhpcy5zdGFydE1zZyA9IHN0YXJ0TXNnO1xuICAgIF90aGlzLmNoYW5nZUV2ZW50S2V5XyA9IG51bGw7XG4gICAgX3RoaXMucG9zdGNvbXBvc2VFdmVudEtleV8gPSBudWxsO1xuICAgIHZhciBzdHlsZSA9IG9wdGlvbnMuc3R5bGUgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuc3R5bGUgOiBbbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICBmaWxsOiBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgICBjb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKSdcbiAgICAgIH0pXG4gICAgfSksIG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgc3Ryb2tlOiBuZXcgb2xTdHlsZVN0cm9rZSh7XG4gICAgICAgIGNvbG9yOiAnd2hpdGUnLFxuICAgICAgICB3aWR0aDogNVxuICAgICAgfSlcbiAgICB9KSwgbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICBzdHJva2U6IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICAgICAgY29sb3I6ICcjZmZjYzMzJyxcbiAgICAgICAgd2lkdGg6IDNcbiAgICAgIH0pXG4gICAgfSldO1xuICAgIF90aGlzLnZlY3RvckxheWVyXyA9IG5ldyBvbExheWVyVmVjdG9yKHtcbiAgICAgIHNvdXJjZTogbmV3IG9sU291cmNlVmVjdG9yKCksXG4gICAgICBzdHlsZTogc3R5bGVcbiAgICB9KTtcblxuICAgIHZhciBzb3VyY2UgPSBfdGhpcy52ZWN0b3JMYXllcl8uZ2V0U291cmNlKCk7XG5cbiAgICBpZiAoIShzb3VyY2UgaW5zdGFuY2VvZiBWZWN0b3JTb3VyY2UpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc291cmNlJyk7XG4gICAgfVxuXG4gICAgdmFyIGRyYXdJbnRlcmFjdGlvbiA9IF90aGlzLmNyZWF0ZURyYXdJbnRlcmFjdGlvbihvcHRpb25zLnNrZXRjaFN0eWxlLCBzb3VyY2UpO1xuXG4gICAgaWYgKCFkcmF3SW50ZXJhY3Rpb24pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBkcmF3SW50ZXJhY3Rpb24nKTtcbiAgICB9XG5cbiAgICBfdGhpcy5kcmF3SW50ZXJhY3Rpb25fID0gZHJhd0ludGVyYWN0aW9uO1xuICAgIF90aGlzLnNob3VsZEhhbmRsZURyYXdJbnRlcmFjdGlvbkFjdGl2ZUNoYW5nZV8gPSB0cnVlO1xuICAgIGxpc3RlbihfdGhpcy5kcmF3SW50ZXJhY3Rpb25fLCAnY2hhbmdlOmFjdGl2ZScsIF90aGlzLmhhbmRsZURyYXdJbnRlcmFjdGlvbkFjdGl2ZUNoYW5nZV8sIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcbiAgICBsaXN0ZW4oX3RoaXMuZHJhd0ludGVyYWN0aW9uXywgJ2RyYXdzdGFydCcsIF90aGlzLm9uRHJhd1N0YXJ0XywgX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpO1xuICAgIGxpc3RlbihfdGhpcy5kcmF3SW50ZXJhY3Rpb25fLCAnZHJhd2VuZCcsIF90aGlzLm9uRHJhd0VuZF8sIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcbiAgICBsaXN0ZW4oX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICdjaGFuZ2U6YWN0aXZlJywgX3RoaXMudXBkYXRlU3RhdGVfLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IE1lYXN1cmUucHJvdG90eXBlO1xuXG4gIF9wcm90by5nZXREcmF3SW50ZXJhY3Rpb24gPSBmdW5jdGlvbiBnZXREcmF3SW50ZXJhY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZHJhd0ludGVyYWN0aW9uXztcbiAgfTtcblxuICBfcHJvdG8uY3JlYXRlRHJhd0ludGVyYWN0aW9uID0gZnVuY3Rpb24gY3JlYXRlRHJhd0ludGVyYWN0aW9uKHN0eWxlLCBzb3VyY2UpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICBfcHJvdG8uc2V0TWFwID0gZnVuY3Rpb24gc2V0TWFwKG1hcCkge1xuICAgIG9sSW50ZXJhY3Rpb25JbnRlcmFjdGlvbi5wcm90b3R5cGUuc2V0TWFwLmNhbGwodGhpcywgbWFwKTtcbiAgICB0aGlzLnZlY3RvckxheWVyXy5zZXRNYXAobWFwKTtcbiAgICB2YXIgcHJldk1hcCA9IHRoaXMuZHJhd0ludGVyYWN0aW9uXy5nZXRNYXAoKTtcblxuICAgIGlmIChwcmV2TWFwICE9PSBudWxsKSB7XG4gICAgICBwcmV2TWFwLnJlbW92ZUludGVyYWN0aW9uKHRoaXMuZHJhd0ludGVyYWN0aW9uXyk7XG4gICAgfVxuXG4gICAgaWYgKG1hcCAhPT0gbnVsbCkge1xuICAgICAgbWFwLmFkZEludGVyYWN0aW9uKHRoaXMuZHJhd0ludGVyYWN0aW9uXyk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5vbkRyYXdTdGFydF8gPSBmdW5jdGlvbiBvbkRyYXdTdGFydF8oZXZ0KSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB0aGlzLnNrZXRjaEZlYXR1cmUgPSBldnQuZmVhdHVyZSB8fCBldnQuZGV0YWlsLmZlYXR1cmU7XG4gICAgdmFyIHNvdXJjZSA9IHRoaXMudmVjdG9yTGF5ZXJfLmdldFNvdXJjZSgpO1xuXG4gICAgaWYgKCEoc291cmNlIGluc3RhbmNlb2YgVmVjdG9yU291cmNlKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNvdXJjZScpO1xuICAgIH1cblxuICAgIHNvdXJjZS5jbGVhcih0cnVlKTtcbiAgICB0aGlzLmNyZWF0ZU1lYXN1cmVUb29sdGlwXygpO1xuXG4gICAgaWYgKCF0aGlzLnNrZXRjaEZlYXR1cmUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBza2V0Y2hGZWF0dXJlJyk7XG4gICAgfVxuXG4gICAgdmFyIGdlb21ldHJ5ID0gdGhpcy5za2V0Y2hGZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmFzc2VydChnZW9tZXRyeSAhPT0gdW5kZWZpbmVkKTtcbiAgICB0aGlzLmNoYW5nZUV2ZW50S2V5XyA9IGxpc3RlbihnZW9tZXRyeSwgJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzMi5oYW5kbGVNZWFzdXJlKGZ1bmN0aW9uIChtZWFzdXJlLCBjb29yZCkge1xuICAgICAgICBpZiAoY29vcmQgIT09IG51bGwpIHtcbiAgICAgICAgICBpZiAoIV90aGlzMi5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWVhc3VyZVRvb2x0aXBFbGVtZW50Jyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgX3RoaXMyLm1lYXN1cmVUb29sdGlwRWxlbWVudF8uaW5uZXJIVE1MID0gbWVhc3VyZTtcbiAgICAgICAgICBfdGhpczIubWVhc3VyZVRvb2x0aXBPdmVybGF5Q29vcmRfID0gY29vcmQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHRoaXMucG9zdGNvbXBvc2VFdmVudEtleV8gPSBsaXN0ZW4odGhpcy5nZXRNYXAoKSwgJ3Bvc3Rjb21wb3NlJywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKF90aGlzMi5tZWFzdXJlVG9vbHRpcE92ZXJsYXlfICYmIF90aGlzMi5tZWFzdXJlVG9vbHRpcE92ZXJsYXlDb29yZF8pIHtcbiAgICAgICAgX3RoaXMyLm1lYXN1cmVUb29sdGlwT3ZlcmxheV8uc2V0UG9zaXRpb24oX3RoaXMyLm1lYXN1cmVUb29sdGlwT3ZlcmxheUNvb3JkXyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLm9uRHJhd0VuZF8gPSBmdW5jdGlvbiBvbkRyYXdFbmRfKGV2dCkge1xuICAgIGlmICghdGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWVhc3VyZVRvb2x0aXBFbGVtZW50Jyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm1lYXN1cmVUb29sdGlwT3ZlcmxheV8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtZWFzdXJlVG9vbHRpcE92ZXJsYXknKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuc2tldGNoRmVhdHVyZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNrZXRjaEZlYXR1cmUnKTtcbiAgICB9XG5cbiAgICB0aGlzLm1lYXN1cmVUb29sdGlwRWxlbWVudF8uY2xhc3NMaXN0LmFkZCgnbmdlby10b29sdGlwLXN0YXRpYycpO1xuICAgIHRoaXMubWVhc3VyZVRvb2x0aXBPdmVybGF5Xy5zZXRPZmZzZXQoWzAsIC03XSk7XG4gICAgdmFyIGV2ZW50ID0gbmV3IG5nZW9DdXN0b21FdmVudCgnbWVhc3VyZWVuZCcsIHtcbiAgICAgIGZlYXR1cmU6IHRoaXMuc2tldGNoRmVhdHVyZVxuICAgIH0pO1xuICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgdGhpcy5za2V0Y2hGZWF0dXJlID0gbnVsbDtcbiAgICB0aGlzLnVubGlzdGVuZXJFdmVudF8oKTtcbiAgfTtcblxuICBfcHJvdG8udW5saXN0ZW5lckV2ZW50XyA9IGZ1bmN0aW9uIHVubGlzdGVuZXJFdmVudF8oKSB7XG4gICAgaWYgKHRoaXMuY2hhbmdlRXZlbnRLZXlfICE9PSBudWxsICYmIHRoaXMucG9zdGNvbXBvc2VFdmVudEtleV8gIT09IG51bGwpIHtcbiAgICAgIHVubGlzdGVuQnlLZXkodGhpcy5jaGFuZ2VFdmVudEtleV8pO1xuICAgICAgdW5saXN0ZW5CeUtleSh0aGlzLnBvc3Rjb21wb3NlRXZlbnRLZXlfKTtcbiAgICAgIHRoaXMuY2hhbmdlRXZlbnRLZXlfID0gbnVsbDtcbiAgICAgIHRoaXMucG9zdGNvbXBvc2VFdmVudEtleV8gPSBudWxsO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uY3JlYXRlSGVscFRvb2x0aXBfID0gZnVuY3Rpb24gY3JlYXRlSGVscFRvb2x0aXBfKCkge1xuICAgIHRoaXMucmVtb3ZlSGVscFRvb2x0aXBfKCk7XG5cbiAgICBpZiAodGhpcy5kaXNwbGF5SGVscFRvb2x0aXBfKSB7XG4gICAgICB0aGlzLmhlbHBUb29sdGlwRWxlbWVudF8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIHRoaXMuaGVscFRvb2x0aXBFbGVtZW50Xy5jbGFzc0xpc3QuYWRkKCd0b29sdGlwJyk7XG4gICAgICB0aGlzLmhlbHBUb29sdGlwT3ZlcmxheV8gPSBuZXcgb2xPdmVybGF5KHtcbiAgICAgICAgc3RvcEV2ZW50OiBmYWxzZSxcbiAgICAgICAgZWxlbWVudDogdGhpcy5oZWxwVG9vbHRpcEVsZW1lbnRfLFxuICAgICAgICBvZmZzZXQ6IFsxNSwgMF0sXG4gICAgICAgIHBvc2l0aW9uaW5nOiAnY2VudGVyLWxlZnQnXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZ2V0TWFwKCkuYWRkT3ZlcmxheSh0aGlzLmhlbHBUb29sdGlwT3ZlcmxheV8pO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlSGVscFRvb2x0aXBfID0gZnVuY3Rpb24gcmVtb3ZlSGVscFRvb2x0aXBfKCkge1xuICAgIGlmICh0aGlzLmRpc3BsYXlIZWxwVG9vbHRpcF8pIHtcbiAgICAgIGlmICh0aGlzLmhlbHBUb29sdGlwT3ZlcmxheV8gIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5nZXRNYXAoKS5yZW1vdmVPdmVybGF5KHRoaXMuaGVscFRvb2x0aXBPdmVybGF5Xyk7XG4gICAgICAgIHRoaXMuaGVscFRvb2x0aXBPdmVybGF5XyA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmhlbHBUb29sdGlwRWxlbWVudF8gIT09IG51bGwpIHtcbiAgICAgICAgaWYgKHRoaXMuaGVscFRvb2x0aXBFbGVtZW50Xy5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgdGhpcy5oZWxwVG9vbHRpcEVsZW1lbnRfLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5oZWxwVG9vbHRpcEVsZW1lbnRfKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaGVscFRvb2x0aXBFbGVtZW50XyA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5jcmVhdGVNZWFzdXJlVG9vbHRpcF8gPSBmdW5jdGlvbiBjcmVhdGVNZWFzdXJlVG9vbHRpcF8oKSB7XG4gICAgdGhpcy5yZW1vdmVNZWFzdXJlVG9vbHRpcF8oKTtcbiAgICB0aGlzLm1lYXN1cmVUb29sdGlwRWxlbWVudF8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aGlzLm1lYXN1cmVUb29sdGlwRWxlbWVudF8uY2xhc3NMaXN0LmFkZCgndG9vbHRpcCcpO1xuICAgIHRoaXMubWVhc3VyZVRvb2x0aXBFbGVtZW50Xy5jbGFzc0xpc3QuYWRkKCduZ2VvLXRvb2x0aXAtbWVhc3VyZScpO1xuICAgIHRoaXMubWVhc3VyZVRvb2x0aXBPdmVybGF5XyA9IG5ldyBvbE92ZXJsYXkoe1xuICAgICAgZWxlbWVudDogdGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfLFxuICAgICAgb2Zmc2V0OiBbMCwgLTE1XSxcbiAgICAgIHBvc2l0aW9uaW5nOiAnYm90dG9tLWNlbnRlcicsXG4gICAgICBzdG9wRXZlbnQ6IGZhbHNlXG4gICAgfSk7XG4gICAgdGhpcy5nZXRNYXAoKS5hZGRPdmVybGF5KHRoaXMubWVhc3VyZVRvb2x0aXBPdmVybGF5Xyk7XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZU1lYXN1cmVUb29sdGlwXyA9IGZ1bmN0aW9uIHJlbW92ZU1lYXN1cmVUb29sdGlwXygpIHtcbiAgICBpZiAodGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfICE9PSBudWxsKSB7XG4gICAgICBpZiAoIXRoaXMubWVhc3VyZVRvb2x0aXBFbGVtZW50Xy5wYXJlbnROb2RlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtZWFzdXJlVG9vbHRpcEVsZW1lbnRfLnBhcmVudE5vZGUnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfKTtcbiAgICAgIHRoaXMubWVhc3VyZVRvb2x0aXBFbGVtZW50XyA9IG51bGw7XG4gICAgICB0aGlzLm1lYXN1cmVUb29sdGlwT3ZlcmxheV8gPSBudWxsO1xuICAgICAgdGhpcy5tZWFzdXJlVG9vbHRpcE92ZXJsYXlDb29yZF8gPSBudWxsO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8udXBkYXRlU3RhdGVfID0gZnVuY3Rpb24gdXBkYXRlU3RhdGVfKCkge1xuICAgIHZhciBhY3RpdmUgPSB0aGlzLmdldEFjdGl2ZSgpO1xuICAgIHRoaXMuc2hvdWxkSGFuZGxlRHJhd0ludGVyYWN0aW9uQWN0aXZlQ2hhbmdlXyA9IGZhbHNlO1xuICAgIHRoaXMuZHJhd0ludGVyYWN0aW9uXy5zZXRBY3RpdmUoYWN0aXZlKTtcbiAgICB0aGlzLnNob3VsZEhhbmRsZURyYXdJbnRlcmFjdGlvbkFjdGl2ZUNoYW5nZV8gPSB0cnVlO1xuXG4gICAgaWYgKCF0aGlzLmdldE1hcCgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGFjdGl2ZSkge1xuICAgICAgaWYgKCF0aGlzLm1lYXN1cmVUb29sdGlwT3ZlcmxheV8pIHtcbiAgICAgICAgdGhpcy5jcmVhdGVNZWFzdXJlVG9vbHRpcF8oKTtcbiAgICAgICAgdGhpcy5jcmVhdGVIZWxwVG9vbHRpcF8oKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCF0aGlzLm1lYXN1cmVUb29sdGlwT3ZlcmxheV8pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1lYXN1cmVUb29sdGlwT3ZlcmxheScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgc291cmNlID0gdGhpcy52ZWN0b3JMYXllcl8uZ2V0U291cmNlKCk7XG5cbiAgICAgIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIFZlY3RvclNvdXJjZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1lYXN1cmVUb29sdGlwT3ZlcmxheScpO1xuICAgICAgfVxuXG4gICAgICBzb3VyY2UuY2xlYXIodHJ1ZSk7XG4gICAgICB0aGlzLmdldE1hcCgpLnJlbW92ZU92ZXJsYXkodGhpcy5tZWFzdXJlVG9vbHRpcE92ZXJsYXlfKTtcbiAgICAgIHRoaXMucmVtb3ZlTWVhc3VyZVRvb2x0aXBfKCk7XG4gICAgICB0aGlzLnJlbW92ZUhlbHBUb29sdGlwXygpO1xuICAgICAgdGhpcy51bmxpc3RlbmVyRXZlbnRfKCk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVNZWFzdXJlID0gZnVuY3Rpb24gaGFuZGxlTWVhc3VyZShjYWxsYmFjaykge307XG5cbiAgX3Byb3RvLmdldFRvb2x0aXBFbGVtZW50ID0gZnVuY3Rpb24gZ2V0VG9vbHRpcEVsZW1lbnQoKSB7XG4gICAgaWYgKCF0aGlzLm1lYXN1cmVUb29sdGlwRWxlbWVudF8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtZWFzdXJlVG9vbHRpcEVsZW1lbnQnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5tZWFzdXJlVG9vbHRpcEVsZW1lbnRfO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEcmF3SW50ZXJhY3Rpb25BY3RpdmVDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlRHJhd0ludGVyYWN0aW9uQWN0aXZlQ2hhbmdlXygpIHtcbiAgICBpZiAodGhpcy5zaG91bGRIYW5kbGVEcmF3SW50ZXJhY3Rpb25BY3RpdmVDaGFuZ2VfKSB7XG4gICAgICB0aGlzLnNldEFjdGl2ZSh0aGlzLmRyYXdJbnRlcmFjdGlvbl8uZ2V0QWN0aXZlKCkpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gTWVhc3VyZTtcbn0ob2xJbnRlcmFjdGlvbkludGVyYWN0aW9uKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZvcm1hdHRlZEFyZWEocG9seWdvbiwgcHJvamVjdGlvbiwgcHJlY2lzaW9uLCBmb3JtYXQpIHtcbiAgdmFyIGdlb20gPSBwb2x5Z29uLmNsb25lKCkudHJhbnNmb3JtKHByb2plY3Rpb24sICdFUFNHOjQzMjYnKTtcbiAgdmFyIGFyZWEgPSBNYXRoLmFicyhvbFNwaGVyZS5nZXRBcmVhKGdlb20sIHtcbiAgICAncHJvamVjdGlvbic6ICdFUFNHOjQzMjYnXG4gIH0pKTtcbiAgcmV0dXJuIGZvcm1hdChhcmVhLCAnbcKyJywgJ3NxdWFyZScsIHByZWNpc2lvbik7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0Rm9ybWF0dGVkQ2lyY2xlQXJlYShjaXJjbGUsIHByZWNpc2lvbiwgZm9ybWF0KSB7XG4gIHZhciBhcmVhID0gTWF0aC5QSSAqIE1hdGgucG93KGNpcmNsZS5nZXRSYWRpdXMoKSwgMik7XG4gIHJldHVybiBmb3JtYXQoYXJlYSwgJ23CsicsICdzcXVhcmUnLCBwcmVjaXNpb24pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEZvcm1hdHRlZExlbmd0aChsaW5lU3RyaW5nLCBwcm9qZWN0aW9uLCBwcmVjaXNpb24sIGZvcm1hdCkge1xuICB2YXIgbGVuZ3RoID0gMDtcbiAgdmFyIGNvb3JkaW5hdGVzID0gbGluZVN0cmluZy5nZXRDb29yZGluYXRlcygpO1xuXG4gIGZvciAodmFyIGkgPSAwLCBpaSA9IGNvb3JkaW5hdGVzLmxlbmd0aCAtIDE7IGkgPCBpaTsgKytpKSB7XG4gICAgdmFyIGMxID0gb2xQcm9qLnRyYW5zZm9ybShjb29yZGluYXRlc1tpXSwgcHJvamVjdGlvbiwgJ0VQU0c6NDMyNicpO1xuICAgIHZhciBjMiA9IG9sUHJvai50cmFuc2Zvcm0oY29vcmRpbmF0ZXNbaSArIDFdLCBwcm9qZWN0aW9uLCAnRVBTRzo0MzI2Jyk7XG4gICAgbGVuZ3RoICs9IG9sU3BoZXJlLmdldERpc3RhbmNlKGMxLCBjMik7XG4gIH1cblxuICByZXR1cm4gZm9ybWF0KGxlbmd0aCwgJ20nLCAndW5pdCcsIHByZWNpc2lvbik7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0Rm9ybWF0dGVkUG9pbnQocG9pbnQsIGRlY2ltYWxzLCBmb3JtYXQsIG9wdF90ZW1wbGF0ZSkge1xuICByZXR1cm4gZm9ybWF0KHBvaW50LmdldENvb3JkaW5hdGVzKCksIGRlY2ltYWxzLCBvcHRfdGVtcGxhdGUpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVFdmVudF8oZXZ0KSB7XG4gIGlmIChldnQudHlwZSAhPSAncG9pbnRlcm1vdmUnIHx8IGV2dC5kcmFnZ2luZykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgdmFyIGhlbHBNc2cgPSB0aGlzLnNrZXRjaEZlYXR1cmUgPT09IG51bGwgPyB0aGlzLnN0YXJ0TXNnIDogdGhpcy5jb250aW51ZU1zZztcblxuICBpZiAodGhpcy5kaXNwbGF5SGVscFRvb2x0aXBfICYmIGhlbHBNc2cpIHtcbiAgICBpZiAoIXRoaXMuaGVscFRvb2x0aXBFbGVtZW50Xykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGhlbHBUb29sdGlwRWxlbWVudCcpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5oZWxwVG9vbHRpcE92ZXJsYXlfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgaGVscFRvb2x0aXBPdmVybGF5Jyk7XG4gICAgfVxuXG4gICAgb2xEb20ucmVtb3ZlQ2hpbGRyZW4odGhpcy5oZWxwVG9vbHRpcEVsZW1lbnRfKTtcbiAgICB0aGlzLmhlbHBUb29sdGlwRWxlbWVudF8uYXBwZW5kQ2hpbGQoaGVscE1zZyk7XG4gICAgdGhpcy5oZWxwVG9vbHRpcE92ZXJsYXlfLnNldFBvc2l0aW9uKGV2dC5jb29yZGluYXRlKTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuXG5leHBvcnQgZGVmYXVsdCBNZWFzdXJlOyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uTWVhc3VyZSwgeyBnZXRGb3JtYXR0ZWRBcmVhIH0gZnJvbSAnbmdlby9pbnRlcmFjdGlvbi9NZWFzdXJlLmpzJztcbmltcG9ydCBvbEludGVyYWN0aW9uRHJhdyBmcm9tICdvbC9pbnRlcmFjdGlvbi9EcmF3LmpzJztcbmltcG9ydCBQb2x5Z29uIGZyb20gJ29sL2dlb20vUG9seWdvbi5qcyc7XG5cbnZhciBfZGVmYXVsdCA9IGZ1bmN0aW9uIChfbmdlb0ludGVyYWN0aW9uTWVhc3UpIHtcbiAgX2luaGVyaXRzTG9vc2UoX2RlZmF1bHQsIF9uZ2VvSW50ZXJhY3Rpb25NZWFzdSk7XG5cbiAgZnVuY3Rpb24gX2RlZmF1bHQoZm9ybWF0LCBnZXR0ZXh0Q2F0YWxvZywgb3B0aW9ucykge1xuICAgIHZhciBfdGhpcztcblxuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICB9XG5cbiAgICBfdGhpcyA9IF9uZ2VvSW50ZXJhY3Rpb25NZWFzdS5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgdmFyIGNvbnRpbnVlTXNnO1xuXG4gICAgaWYgKG9wdGlvbnMuY29udGludWVNc2cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29udGludWVNc2cgPSBvcHRpb25zLmNvbnRpbnVlTXNnO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250aW51ZU1zZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIGNvbnRpbnVlTXNnLnRleHRDb250ZW50ID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdDbGljayB0byBjb250aW51ZSBkcmF3aW5nIHRoZSBwb2x5Z29uLicpO1xuICAgICAgdmFyIGJyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKTtcbiAgICAgIGJyLnRleHRDb250ZW50ID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdEb3VibGUtY2xpY2sgb3IgY2xpY2sgc3RhcnRpbmcgcG9pbnQgdG8gZmluaXNoLicpO1xuICAgICAgY29udGludWVNc2cuYXBwZW5kQ2hpbGQoYnIpO1xuICAgIH1cblxuICAgIF90aGlzLmNvbnRpbnVlTXNnID0gY29udGludWVNc2c7XG4gICAgX3RoaXMuZm9ybWF0ID0gZm9ybWF0O1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBfZGVmYXVsdC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmNyZWF0ZURyYXdJbnRlcmFjdGlvbiA9IGZ1bmN0aW9uIGNyZWF0ZURyYXdJbnRlcmFjdGlvbihzdHlsZSwgc291cmNlKSB7XG4gICAgcmV0dXJuIG5ldyBvbEludGVyYWN0aW9uRHJhdyh7XG4gICAgICB0eXBlOiAnUG9seWdvbicsXG4gICAgICBzb3VyY2U6IHNvdXJjZSxcbiAgICAgIHN0eWxlOiBzdHlsZVxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVNZWFzdXJlID0gZnVuY3Rpb24gaGFuZGxlTWVhc3VyZShjYWxsYmFjaykge1xuICAgIGlmICghdGhpcy5za2V0Y2hGZWF0dXJlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc2tldGNoRmVhdHVyZScpO1xuICAgIH1cblxuICAgIHZhciBnZW9tID0gdGhpcy5za2V0Y2hGZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIShnZW9tIGluc3RhbmNlb2YgUG9seWdvbikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZW9tZXRyeScpO1xuICAgIH1cblxuICAgIHZhciBwcm9qID0gdGhpcy5nZXRNYXAoKS5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpO1xuICAgIGNvbnNvbGUuYXNzZXJ0KHByb2opO1xuICAgIHZhciBvdXRwdXQgPSBnZXRGb3JtYXR0ZWRBcmVhKGdlb20sIHByb2osIHRoaXMucHJlY2lzaW9uLCB0aGlzLmZvcm1hdCk7XG4gICAgdmFyIHZlcnRpY2VzQ291bnQgPSBnZW9tLmdldENvb3JkaW5hdGVzKClbMF0ubGVuZ3RoO1xuICAgIHZhciBjb29yZCA9IG51bGw7XG5cbiAgICBpZiAodmVydGljZXNDb3VudCA+IDMpIHtcbiAgICAgIGNvb3JkID0gZ2VvbS5nZXRJbnRlcmlvclBvaW50KCkuZ2V0Q29vcmRpbmF0ZXMoKTtcbiAgICB9XG5cbiAgICBjYWxsYmFjayhvdXRwdXQsIGNvb3JkKTtcbiAgfTtcblxuICByZXR1cm4gX2RlZmF1bHQ7XG59KG5nZW9JbnRlcmFjdGlvbk1lYXN1cmUpO1xuXG5leHBvcnQgeyBfZGVmYXVsdCBhcyBkZWZhdWx0IH07IiwiZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBuZ2VvSW50ZXJhY3Rpb25EcmF3QXppbXV0IGZyb20gJ25nZW8vaW50ZXJhY3Rpb24vRHJhd0F6aW11dC5qcyc7XG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uTWVhc3VyZSwgeyBnZXRGb3JtYXR0ZWRMZW5ndGggfSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL01lYXN1cmUuanMnO1xuaW1wb3J0IExpbmVTdHJpbmcgZnJvbSAnb2wvZ2VvbS9MaW5lU3RyaW5nLmpzJztcbmltcG9ydCBHZW9tZXRyeUNvbGxlY3Rpb24gZnJvbSAnb2wvZ2VvbS9HZW9tZXRyeUNvbGxlY3Rpb24uanMnO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoX25nZW9JbnRlcmFjdGlvbk1lYXN1KSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfbmdlb0ludGVyYWN0aW9uTWVhc3UpO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KHVuaXRQcmVmaXhGb3JtYXQsIG51bWJlckZvcm1hdCwgb3B0aW9ucykge1xuICAgIHZhciBfdGhpcztcblxuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICB9XG5cbiAgICBfdGhpcyA9IF9uZ2VvSW50ZXJhY3Rpb25NZWFzdS5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgdmFyIGNvbnRpbnVlTXNnO1xuXG4gICAgaWYgKG9wdGlvbnMuY29udGludWVNc2cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29udGludWVNc2cgPSBvcHRpb25zLmNvbnRpbnVlTXNnO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250aW51ZU1zZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIGNvbnRpbnVlTXNnLnRleHRDb250ZW50ID0gJ0NsaWNrIHRvIGZpbmlzaC4nO1xuICAgIH1cblxuICAgIF90aGlzLmNvbnRpbnVlTXNnID0gY29udGludWVNc2c7XG4gICAgX3RoaXMubnVtYmVyRm9ybWF0ID0gbnVtYmVyRm9ybWF0O1xuICAgIF90aGlzLnVuaXRQcmVmaXhGb3JtYXQgPSB1bml0UHJlZml4Rm9ybWF0O1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBfZGVmYXVsdC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmNyZWF0ZURyYXdJbnRlcmFjdGlvbiA9IGZ1bmN0aW9uIGNyZWF0ZURyYXdJbnRlcmFjdGlvbihzdHlsZSwgc291cmNlKSB7XG4gICAgcmV0dXJuIG5ldyBuZ2VvSW50ZXJhY3Rpb25EcmF3QXppbXV0KHtcbiAgICAgIHNvdXJjZTogc291cmNlLFxuICAgICAgc3R5bGU6IHN0eWxlXG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZU1lYXN1cmUgPSBmdW5jdGlvbiBoYW5kbGVNZWFzdXJlKGNhbGxiYWNrKSB7XG4gICAgaWYgKCF0aGlzLnNrZXRjaEZlYXR1cmUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBza2V0Y2hGZWF0dXJlJyk7XG4gICAgfVxuXG4gICAgdmFyIGdlb20gPSB0aGlzLnNrZXRjaEZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgIGlmICghKGdlb20gaW5zdGFuY2VvZiBHZW9tZXRyeUNvbGxlY3Rpb24pKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICB2YXIgbGluZSA9IGdlb20uZ2V0R2VvbWV0cmllcygpWzBdO1xuXG4gICAgaWYgKCEobGluZSBpbnN0YW5jZW9mIExpbmVTdHJpbmcpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbGluZScpO1xuICAgIH1cblxuICAgIHZhciBvdXRwdXQgPSBnZXRGb3JtYXR0ZWRBemltdXRSYWRpdXMobGluZSwgdGhpcy5nZXRNYXAoKS5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpLCB0aGlzLmRlY2ltYWxzLCB0aGlzLnByZWNpc2lvbiwgdGhpcy51bml0UHJlZml4Rm9ybWF0LCB0aGlzLm51bWJlckZvcm1hdCk7XG4gICAgY2FsbGJhY2sob3V0cHV0LCBsaW5lLmdldExhc3RDb29yZGluYXRlKCkpO1xuICB9O1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0obmdlb0ludGVyYWN0aW9uTWVhc3VyZSk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTtcbmV4cG9ydCBmdW5jdGlvbiBnZXRBemltdXQobGluZSkge1xuICB2YXIgY29vcmRzID0gbGluZS5nZXRDb29yZGluYXRlcygpO1xuICB2YXIgZHggPSBjb29yZHNbMV1bMF0gLSBjb29yZHNbMF1bMF07XG4gIHZhciBkeSA9IGNvb3Jkc1sxXVsxXSAtIGNvb3Jkc1swXVsxXTtcbiAgdmFyIHJhZCA9IE1hdGguYWNvcyhkeSAvIE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSkpO1xuICB2YXIgZmFjdG9yID0gZHggPiAwID8gMSA6IC0xO1xuICByZXR1cm4gZmFjdG9yICogcmFkICogMTgwIC8gTWF0aC5QSSAlIDM2MDtcbn1cblxuZnVuY3Rpb24gZ2V0Rm9ybWF0dGVkQXppbXV0KGxpbmUsIGRlY2ltYWxzLCBmb3JtYXQpIHtcbiAgdmFyIGF6aW11dCA9IGdldEF6aW11dChsaW5lKTtcbiAgcmV0dXJuIGZvcm1hdChhemltdXQsIGRlY2ltYWxzKSArIFwiXFx4QjBcIjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZvcm1hdHRlZEF6aW11dFJhZGl1cyhsaW5lLCBwcm9qZWN0aW9uLCBkZWNpbWFscywgcHJlY2lzaW9uLCBmb3JtYXRMZW5ndGgsIGZvcm1hdEF6aW11dCkge1xuICB2YXIgb3V0cHV0ID0gZ2V0Rm9ybWF0dGVkQXppbXV0KGxpbmUsIGRlY2ltYWxzLCBmb3JtYXRBemltdXQpO1xuICBvdXRwdXQgKz0gXCIsIFwiICsgZ2V0Rm9ybWF0dGVkTGVuZ3RoKGxpbmUsIHByb2plY3Rpb24sIHByZWNpc2lvbiwgZm9ybWF0TGVuZ3RoKTtcbiAgcmV0dXJuIG91dHB1dDtcbn0iLCJmdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IG5nZW9JbnRlcmFjdGlvbk1lYXN1cmUsIHsgZ2V0Rm9ybWF0dGVkTGVuZ3RoIH0gZnJvbSAnbmdlby9pbnRlcmFjdGlvbi9NZWFzdXJlLmpzJztcbmltcG9ydCBvbEludGVyYWN0aW9uRHJhdyBmcm9tICdvbC9pbnRlcmFjdGlvbi9EcmF3LmpzJztcbmltcG9ydCBMaW5lU3RyaW5nIGZyb20gJ29sL2dlb20vTGluZVN0cmluZy5qcyc7XG5pbXBvcnQgeyBkaXN0YW5jZSB9IGZyb20gJ29sL2Nvb3JkaW5hdGUuanMnO1xuaW1wb3J0IHsgY29udGFpbnNYWSB9IGZyb20gJ29sL2V4dGVudC5qcyc7XG52YXIgbW9kaWZpZXJQcmVzc2VkO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoX25nZW9JbnRlcmFjdGlvbk1lYXN1KSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfbmdlb0ludGVyYWN0aW9uTWVhc3UpO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KGZvcm1hdCwgZ2V0dGV4dENhdGFsb2csIG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuXG4gICAgX3RoaXMgPSBfbmdlb0ludGVyYWN0aW9uTWVhc3UuY2FsbCh0aGlzLCBvcHRpb25zKSB8fCB0aGlzO1xuXG4gICAgaWYgKG1vZGlmaWVyUHJlc3NlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBtb2RpZmllclByZXNzZWQgPSBmYWxzZTtcbiAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgbW9kaWZpZXJQcmVzc2VkID0gZXZ0LmtleUNvZGUgPT09IDE3O1xuICAgICAgfSk7XG4gICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBtb2RpZmllclByZXNzZWQgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zLmNvbnRpbnVlTXNnICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIF90aGlzLmNvbnRpbnVlTXNnID0gb3B0aW9ucy5jb250aW51ZU1zZztcbiAgICB9IGVsc2Uge1xuICAgICAgX3RoaXMuY29udGludWVNc2cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICBfdGhpcy5jb250aW51ZU1zZy50ZXh0Q29udGVudCA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQ2xpY2sgdG8gY29udGludWUgZHJhd2luZyB0aGUgbGluZS4nKTtcbiAgICAgIHZhciBiciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJyk7XG4gICAgICBici50ZXh0Q29udGVudCA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnRG91YmxlLWNsaWNrIG9yIGNsaWNrIGxhc3QgcG9pbnQgdG8gZmluaXNoLicpO1xuXG4gICAgICBfdGhpcy5jb250aW51ZU1zZy5hcHBlbmRDaGlsZChicik7XG4gICAgfVxuXG4gICAgX3RoaXMuZm9ybWF0ID0gZm9ybWF0O1xuICAgIF90aGlzLnRvbGVyYW5jZSA9IG9wdGlvbnMudG9sZXJhbmNlO1xuICAgIF90aGlzLnNvdXJjZSA9IG9wdGlvbnMuc291cmNlO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBfZGVmYXVsdC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmNyZWF0ZURyYXdJbnRlcmFjdGlvbiA9IGZ1bmN0aW9uIGNyZWF0ZURyYXdJbnRlcmFjdGlvbihzdHlsZSwgc291cmNlKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IG9sSW50ZXJhY3Rpb25EcmF3KHtcbiAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJyxcbiAgICAgIGdlb21ldHJ5RnVuY3Rpb246IGZ1bmN0aW9uIGdlb21ldHJ5RnVuY3Rpb24oY29vcmRpbmF0ZXMsIG9wdF9nZW9tZXRyeSkge1xuICAgICAgICByZXR1cm4gX3RoaXMyLmxpbmVzdHJpbmdHZW9tZXRyeUZ1bmN0aW9uKGNvb3JkaW5hdGVzLCBvcHRfZ2VvbWV0cnkpO1xuICAgICAgfSxcbiAgICAgIGNvbmRpdGlvbjogZnVuY3Rpb24gY29uZGl0aW9uKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0sXG4gICAgICBzdHlsZTogc3R5bGUsXG4gICAgICBzb3VyY2U6IHNvdXJjZVxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5saW5lc3RyaW5nR2VvbWV0cnlGdW5jdGlvbiA9IGZ1bmN0aW9uIGxpbmVzdHJpbmdHZW9tZXRyeUZ1bmN0aW9uKGNvb3JkaW5hdGVzLCBvcHRfZ2VvbWV0cnkpIHtcbiAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgIGlmIChtb2RpZmllclByZXNzZWQpIHtcbiAgICAgIHZhciB2aWV3Um90YXRpb24gPSB0aGlzLmdldE1hcCgpLmdldFZpZXcoKS5nZXRSb3RhdGlvbigpO1xuICAgICAgdmFyIGFuZ2xlID0gTWF0aC5QSSAvIDQ7XG4gICAgICB2YXIgZnJvbSA9IGNvb3JkaW5hdGVzW2Nvb3JkaW5hdGVzLmxlbmd0aCAtIDJdO1xuICAgICAgdmFyIHRvID0gY29vcmRpbmF0ZXNbY29vcmRpbmF0ZXMubGVuZ3RoIC0gMV07XG4gICAgICB2YXIgZHggPSBmcm9tWzBdIC0gdG9bMF07XG4gICAgICB2YXIgZHkgPSBmcm9tWzFdIC0gdG9bMV07XG4gICAgICB2YXIgbGVuZ3RoID0gZGlzdGFuY2UoZnJvbSwgdG8pO1xuICAgICAgdmFyIHJvdGF0aW9uID0gdmlld1JvdGF0aW9uICsgTWF0aC5yb3VuZCgoTWF0aC5hdGFuMihkeSwgZHgpIC0gdmlld1JvdGF0aW9uKSAvIGFuZ2xlKSAqIGFuZ2xlO1xuICAgICAgdG9bMF0gPSBmcm9tWzBdIC0gbGVuZ3RoICogTWF0aC5jb3Mocm90YXRpb24pO1xuICAgICAgdG9bMV0gPSBmcm9tWzFdIC0gbGVuZ3RoICogTWF0aC5zaW4ocm90YXRpb24pO1xuXG4gICAgICBpZiAodGhpcy50b2xlcmFuY2UgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNvdXJjZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy5nZXRNYXAoKS5nZXRWaWV3KCk7XG5cbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHZpZXcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciByZXNvbHV0aW9uID0gdmlldy5nZXRSZXNvbHV0aW9uKCk7XG5cbiAgICAgICAgaWYgKCFyZXNvbHV0aW9uKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJlc29sdXRpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBkZWx0YSA9IHJlc29sdXRpb24gKiB0aGlzLnRvbGVyYW5jZTtcbiAgICAgICAgdmFyIGJib3ggPSBbdG9bMF0gLSBkZWx0YSwgdG9bMV0gLSBkZWx0YSwgdG9bMF0gKyBkZWx0YSwgdG9bMV0gKyBkZWx0YV07XG4gICAgICAgIHZhciBsYXllclNvdXJjZSA9IHRoaXMuc291cmNlO1xuICAgICAgICB2YXIgZmVhdHVyZXNJbkV4dGVudCA9IGxheWVyU291cmNlLmdldEZlYXR1cmVzSW5FeHRlbnQoYmJveCk7XG4gICAgICAgIGZlYXR1cmVzSW5FeHRlbnQuZm9yRWFjaChmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICAgIHZhciBsYXN0SW50ZXJzZWN0aW9uID0gW107XG4gICAgICAgICAgdmFyIGJlc3RJbnRlcnNlY3Rpb24gPSBbXTtcbiAgICAgICAgICB2YXIgYmVzdERpc3RhbmNlID0gSW5maW5pdHk7XG4gICAgICAgICAgdmFyIGRpc3RhbmNlRnJvbVRvID0gZGlzdGFuY2UoZnJvbSwgdG8pO1xuICAgICAgICAgIHZhciBheCA9IGZyb21bMF07XG4gICAgICAgICAgdmFyIGF5ID0gZnJvbVsxXTtcbiAgICAgICAgICB2YXIgbXggPSB0b1swXTtcbiAgICAgICAgICB2YXIgbXkgPSB0b1sxXTtcbiAgICAgICAgICB2YXIgdW5pdFZlY3RvciA9IFsobXggLSBheCkgLyBkaXN0YW5jZUZyb21UbywgKG15IC0gYXkpIC8gZGlzdGFuY2VGcm9tVG9dO1xuICAgICAgICAgIHZhciBiID0gW2F4ICsgKGRpc3RhbmNlRnJvbVRvICsgZGVsdGEpICogdW5pdFZlY3RvclswXSwgYXkgKyAoZGlzdGFuY2VGcm9tVG8gKyBkZWx0YSkgKiB1bml0VmVjdG9yWzFdXTtcbiAgICAgICAgICB2YXIgZ2VvbSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgICAgICAgIGlmICghKGdlb20gaW5zdGFuY2VvZiBMaW5lU3RyaW5nKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBnZW9tZXRyeSB0eXBlJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZ2VvbS5mb3JFYWNoU2VnbWVudChmdW5jdGlvbiAocG9pbnQxLCBwb2ludDIpIHtcbiAgICAgICAgICAgIGxhc3RJbnRlcnNlY3Rpb24gPSBfdGhpczMuY29tcHV0ZUxpbmVTZWdtZW50SW50ZXJzZWN0aW9uKFtmcm9tLCBiXSwgW3BvaW50MSwgcG9pbnQyXSk7XG5cbiAgICAgICAgICAgIGlmIChsYXN0SW50ZXJzZWN0aW9uICE9PSB1bmRlZmluZWQgJiYgY29udGFpbnNYWShiYm94LCBsYXN0SW50ZXJzZWN0aW9uWzBdLCBsYXN0SW50ZXJzZWN0aW9uWzFdKSkge1xuICAgICAgICAgICAgICB2YXIgbGFzdERpc3RhbmNlID0gZGlzdGFuY2UodG8sIGxhc3RJbnRlcnNlY3Rpb24pO1xuXG4gICAgICAgICAgICAgIGlmIChsYXN0RGlzdGFuY2UgPCBiZXN0RGlzdGFuY2UpIHtcbiAgICAgICAgICAgICAgICBiZXN0RGlzdGFuY2UgPSBsYXN0RGlzdGFuY2U7XG4gICAgICAgICAgICAgICAgYmVzdEludGVyc2VjdGlvbiA9IGxhc3RJbnRlcnNlY3Rpb247XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGlmIChiZXN0SW50ZXJzZWN0aW9uKSB7XG4gICAgICAgICAgICB0b1swXSA9IGJlc3RJbnRlcnNlY3Rpb25bMF0gfHwgdG9bMF07XG4gICAgICAgICAgICB0b1sxXSA9IGJlc3RJbnRlcnNlY3Rpb25bMV0gfHwgdG9bMV07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZ2VvbWV0cnkgPSBvcHRfZ2VvbWV0cnk7XG5cbiAgICBpZiAoZ2VvbWV0cnkpIHtcbiAgICAgIGdlb21ldHJ5LnNldENvb3JkaW5hdGVzKGNvb3JkaW5hdGVzKTtcbiAgICAgIHJldHVybiBnZW9tZXRyeTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IExpbmVTdHJpbmcoY29vcmRpbmF0ZXMpO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVNZWFzdXJlID0gZnVuY3Rpb24gaGFuZGxlTWVhc3VyZShjYWxsYmFjaykge1xuICAgIGlmICghdGhpcy5za2V0Y2hGZWF0dXJlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgc2tldGNoRmVhdHVyZScpO1xuICAgIH1cblxuICAgIHZhciBnZW9tID0gdGhpcy5za2V0Y2hGZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIShnZW9tIGluc3RhbmNlb2YgTGluZVN0cmluZykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZ2VvbWV0cnkgdHlwZScpO1xuICAgIH1cblxuICAgIHZhciBwcm9qID0gdGhpcy5nZXRNYXAoKS5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpO1xuICAgIGNvbnNvbGUuYXNzZXJ0KHByb2opO1xuICAgIHZhciBvdXRwdXQgPSBnZXRGb3JtYXR0ZWRMZW5ndGgoZ2VvbSwgcHJvaiwgdGhpcy5wcmVjaXNpb24sIHRoaXMuZm9ybWF0KTtcbiAgICB2YXIgY29vcmQgPSBnZW9tLmdldExhc3RDb29yZGluYXRlKCk7XG4gICAgY2FsbGJhY2sob3V0cHV0LCBjb29yZCk7XG4gIH07XG5cbiAgX3Byb3RvLmNvbXB1dGVMaW5lU2VnbWVudEludGVyc2VjdGlvbiA9IGZ1bmN0aW9uIGNvbXB1dGVMaW5lU2VnbWVudEludGVyc2VjdGlvbihsaW5lMSwgbGluZTIpIHtcbiAgICB2YXIgbnVtZXJhdG9yMUEgPSAobGluZTJbMV1bMF0gLSBsaW5lMlswXVswXSkgKiAobGluZTFbMF1bMV0gLSBsaW5lMlswXVsxXSkgLSAobGluZTJbMV1bMV0gLSBsaW5lMlswXVsxXSkgKiAobGluZTFbMF1bMF0gLSBsaW5lMlswXVswXSk7XG4gICAgdmFyIG51bWVyYXRvcjFCID0gKGxpbmUxWzFdWzBdIC0gbGluZTFbMF1bMF0pICogKGxpbmUxWzBdWzFdIC0gbGluZTJbMF1bMV0pIC0gKGxpbmUxWzFdWzFdIC0gbGluZTFbMF1bMV0pICogKGxpbmUxWzBdWzBdIC0gbGluZTJbMF1bMF0pO1xuICAgIHZhciBkZW5vbWluYXRvcjEgPSAobGluZTJbMV1bMV0gLSBsaW5lMlswXVsxXSkgKiAobGluZTFbMV1bMF0gLSBsaW5lMVswXVswXSkgLSAobGluZTJbMV1bMF0gLSBsaW5lMlswXVswXSkgKiAobGluZTFbMV1bMV0gLSBsaW5lMVswXVsxXSk7XG5cbiAgICBpZiAoZGVub21pbmF0b3IxID09PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHVhMSA9IG51bWVyYXRvcjFBIC8gZGVub21pbmF0b3IxO1xuICAgIHZhciB1YjEgPSBudW1lcmF0b3IxQiAvIGRlbm9taW5hdG9yMTtcblxuICAgIGlmICh1YTEgPj0gMCAmJiB1YTEgPD0gMSAmJiB1YjEgPj0gMCAmJiB1YjEgPD0gMSkge1xuICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgcmVzdWx0WzBdID0gbGluZTFbMF1bMF0gKyB1YTEgKiAobGluZTFbMV1bMF0gLSBsaW5lMVswXVswXSk7XG4gICAgICByZXN1bHRbMV0gPSBsaW5lMVswXVsxXSArIHVhMSAqIChsaW5lMVsxXVsxXSAtIGxpbmUxWzBdWzFdKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0obmdlb0ludGVyYWN0aW9uTWVhc3VyZSk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJmdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IHsgZGVsZXRlQ29uZGl0aW9uIH0gZnJvbSAnbmdlby91dGlscy5qcyc7XG5pbXBvcnQgbmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzIGZyb20gJ25nZW8vZm9ybWF0L0ZlYXR1cmVQcm9wZXJ0aWVzLmpzJztcbmltcG9ydCBuZ2VvSW50ZXJhY3Rpb25Nb2RpZnlDaXJjbGUgZnJvbSAnbmdlby9pbnRlcmFjdGlvbi9Nb2RpZnlDaXJjbGUuanMnO1xuaW1wb3J0IG5nZW9JbnRlcmFjdGlvbk1vZGlmeVJlY3RhbmdsZSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL01vZGlmeVJlY3RhbmdsZS5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4sIHVubGlzdGVuQnlLZXkgfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IHsgVFJVRSB9IGZyb20gJ29sL2Z1bmN0aW9ucy5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvbkludGVyYWN0aW9uIGZyb20gJ29sL2ludGVyYWN0aW9uL0ludGVyYWN0aW9uLmpzJztcbmltcG9ydCBvbENvbGxlY3Rpb24gZnJvbSAnb2wvQ29sbGVjdGlvbi5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvbk1vZGlmeSBmcm9tICdvbC9pbnRlcmFjdGlvbi9Nb2RpZnkuanMnO1xuaW1wb3J0IG9sRmVhdHVyZSBmcm9tICdvbC9GZWF0dXJlLmpzJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoX29sSW50ZXJhY3Rpb25JbnRlcmFjKSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfb2xJbnRlcmFjdGlvbkludGVyYWMpO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfdGhpcyA9IF9vbEludGVyYWN0aW9uSW50ZXJhYy5jYWxsKHRoaXMsIHtcbiAgICAgIGhhbmRsZUV2ZW50OiBUUlVFXG4gICAgfSkgfHwgdGhpcztcbiAgICBjb25zb2xlLmFzc2VydChvcHRpb25zLmZlYXR1cmVzKTtcbiAgICBfdGhpcy5mZWF0dXJlc18gPSBvcHRpb25zLmZlYXR1cmVzO1xuICAgIF90aGlzLmxpc3RlbmVyS2V5c18gPSBbXTtcbiAgICBfdGhpcy5pbnRlcmFjdGlvbnNfID0gW107XG4gICAgX3RoaXMub3RoZXJGZWF0dXJlc18gPSBuZXcgb2xDb2xsZWN0aW9uKCk7XG5cbiAgICBfdGhpcy5pbnRlcmFjdGlvbnNfLnB1c2gobmV3IG9sSW50ZXJhY3Rpb25Nb2RpZnkoe1xuICAgICAgZGVsZXRlQ29uZGl0aW9uOiBkZWxldGVDb25kaXRpb24sXG4gICAgICBmZWF0dXJlczogX3RoaXMub3RoZXJGZWF0dXJlc18sXG4gICAgICBwaXhlbFRvbGVyYW5jZTogb3B0aW9ucy5waXhlbFRvbGVyYW5jZSxcbiAgICAgIHN0eWxlOiBvcHRpb25zLnN0eWxlLFxuICAgICAgd3JhcFg6IG9wdGlvbnMud3JhcFhcbiAgICB9KSk7XG5cbiAgICBfdGhpcy5jaXJjbGVGZWF0dXJlc18gPSBuZXcgb2xDb2xsZWN0aW9uKCk7XG5cbiAgICBfdGhpcy5pbnRlcmFjdGlvbnNfLnB1c2gobmV3IG5nZW9JbnRlcmFjdGlvbk1vZGlmeUNpcmNsZSh7XG4gICAgICBmZWF0dXJlczogX3RoaXMuY2lyY2xlRmVhdHVyZXNfLFxuICAgICAgcGl4ZWxUb2xlcmFuY2U6IG9wdGlvbnMucGl4ZWxUb2xlcmFuY2UsXG4gICAgICBzdHlsZTogb3B0aW9ucy5zdHlsZSxcbiAgICAgIHdyYXBYOiBvcHRpb25zLndyYXBYXG4gICAgfSkpO1xuXG4gICAgX3RoaXMucmVjdGFuZ2xlRmVhdHVyZXNfID0gbmV3IG9sQ29sbGVjdGlvbigpO1xuXG4gICAgX3RoaXMuaW50ZXJhY3Rpb25zXy5wdXNoKG5ldyBuZ2VvSW50ZXJhY3Rpb25Nb2RpZnlSZWN0YW5nbGUoe1xuICAgICAgZmVhdHVyZXM6IF90aGlzLnJlY3RhbmdsZUZlYXR1cmVzXyxcbiAgICAgIHBpeGVsVG9sZXJhbmNlOiBvcHRpb25zLnBpeGVsVG9sZXJhbmNlLFxuICAgICAgc3R5bGU6IG9wdGlvbnMuc3R5bGUsXG4gICAgICB3cmFwWDogb3B0aW9ucy53cmFwWFxuICAgIH0pKTtcblxuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBfZGVmYXVsdC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLnNldEFjdGl2ZSA9IGZ1bmN0aW9uIHNldEFjdGl2ZShhY3RpdmUpIHtcbiAgICBfb2xJbnRlcmFjdGlvbkludGVyYWMucHJvdG90eXBlLnNldEFjdGl2ZS5jYWxsKHRoaXMsIGFjdGl2ZSk7XG5cbiAgICB0aGlzLnNldFN0YXRlXygpO1xuICB9O1xuXG4gIF9wcm90by5zZXRNYXAgPSBmdW5jdGlvbiBzZXRNYXAobWFwKSB7XG4gICAgdmFyIGludGVyYWN0aW9ucyA9IHRoaXMuaW50ZXJhY3Rpb25zXztcbiAgICB2YXIgY3VycmVudE1hcCA9IHRoaXMuZ2V0TWFwKCk7XG5cbiAgICBpZiAoY3VycmVudE1hcCkge1xuICAgICAgaW50ZXJhY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGludGVyYWN0aW9uKSB7XG4gICAgICAgIGN1cnJlbnRNYXAucmVtb3ZlSW50ZXJhY3Rpb24oaW50ZXJhY3Rpb24pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgX29sSW50ZXJhY3Rpb25JbnRlcmFjLnByb3RvdHlwZS5zZXRNYXAuY2FsbCh0aGlzLCBtYXApO1xuXG4gICAgaWYgKG1hcCkge1xuICAgICAgaW50ZXJhY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGludGVyYWN0aW9uKSB7XG4gICAgICAgIG1hcC5hZGRJbnRlcmFjdGlvbihpbnRlcmFjdGlvbik7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlXygpO1xuICB9O1xuXG4gIF9wcm90by5zZXRTdGF0ZV8gPSBmdW5jdGlvbiBzZXRTdGF0ZV8oKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgbWFwID0gdGhpcy5nZXRNYXAoKTtcblxuICAgIGlmICghbWFwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGFjdGl2ZSA9IHRoaXMuZ2V0QWN0aXZlKCk7XG4gICAgdmFyIGludGVyYWN0aW9ucyA9IHRoaXMuaW50ZXJhY3Rpb25zXztcbiAgICB2YXIga2V5cyA9IHRoaXMubGlzdGVuZXJLZXlzXztcbiAgICBpbnRlcmFjdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoaW50ZXJhY3Rpb24pIHtcbiAgICAgIGludGVyYWN0aW9uLnNldEFjdGl2ZShhY3RpdmUgJiYgISFtYXApO1xuICAgIH0pO1xuXG4gICAgaWYgKGFjdGl2ZSAmJiBtYXApIHtcbiAgICAgIHRoaXMuZmVhdHVyZXNfLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzMi5hZGRGZWF0dXJlXyhmZWF0dXJlKTtcbiAgICAgIH0pO1xuICAgICAga2V5cy5wdXNoKGxpc3Rlbih0aGlzLmZlYXR1cmVzXywgJ2FkZCcsIHRoaXMuaGFuZGxlRmVhdHVyZXNBZGRfLCB0aGlzKSwgbGlzdGVuKHRoaXMuZmVhdHVyZXNfLCAncmVtb3ZlJywgdGhpcy5oYW5kbGVGZWF0dXJlc1JlbW92ZV8sIHRoaXMpKTtcbiAgICB9IGVsc2Uge1xuICAgICAga2V5cy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgICAga2V5cy5sZW5ndGggPSAwO1xuICAgICAgdGhpcy5mZWF0dXJlc18uZm9yRWFjaChmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICByZXR1cm4gX3RoaXMyLnJlbW92ZUZlYXR1cmVfKGZlYXR1cmUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVGZWF0dXJlc0FkZF8gPSBmdW5jdGlvbiBoYW5kbGVGZWF0dXJlc0FkZF8oZXZ0KSB7XG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgICAgdmFyIGZlYXR1cmUgPSBldnQuZWxlbWVudDtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KGZlYXR1cmUgaW5zdGFuY2VvZiBvbEZlYXR1cmUsICdmZWF0dXJlIHNob3VsZCBiZSBhbiBvbC5GZWF0dXJlJyk7XG4gICAgICB0aGlzLmFkZEZlYXR1cmVfKGZlYXR1cmUpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRmVhdHVyZXNSZW1vdmVfID0gZnVuY3Rpb24gaGFuZGxlRmVhdHVyZXNSZW1vdmVfKGV2dCkge1xuICAgIGlmIChldnQgaW5zdGFuY2VvZiBDb2xsZWN0aW9uRXZlbnQpIHtcbiAgICAgIHZhciBmZWF0dXJlID0gZXZ0LmVsZW1lbnQ7XG4gICAgICB0aGlzLnJlbW92ZUZlYXR1cmVfKGZlYXR1cmUpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uYWRkRmVhdHVyZV8gPSBmdW5jdGlvbiBhZGRGZWF0dXJlXyhmZWF0dXJlKSB7XG4gICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzLmdldEZlYXR1cmVDb2xsZWN0aW9uXyhmZWF0dXJlKTtcbiAgICBjb2xsZWN0aW9uLnB1c2goZmVhdHVyZSk7XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZUZlYXR1cmVfID0gZnVuY3Rpb24gcmVtb3ZlRmVhdHVyZV8oZmVhdHVyZSkge1xuICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcy5nZXRGZWF0dXJlQ29sbGVjdGlvbl8oZmVhdHVyZSk7XG4gICAgY29sbGVjdGlvbi5yZW1vdmUoZmVhdHVyZSk7XG4gIH07XG5cbiAgX3Byb3RvLmdldEZlYXR1cmVDb2xsZWN0aW9uXyA9IGZ1bmN0aW9uIGdldEZlYXR1cmVDb2xsZWN0aW9uXyhmZWF0dXJlKSB7XG4gICAgdmFyIGZlYXR1cmVzO1xuICAgIHZhciBpc0NpcmNsZSA9IGZlYXR1cmUuZ2V0KG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5JU19DSVJDTEUpO1xuICAgIHZhciBpc1JlY3RhbmdsZSA9IGZlYXR1cmUuZ2V0KG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5JU19SRUNUQU5HTEUpO1xuXG4gICAgaWYgKGlzQ2lyY2xlID09PSB0cnVlIHx8IGlzQ2lyY2xlID09PSAndHJ1ZScpIHtcbiAgICAgIGZlYXR1cmVzID0gdGhpcy5jaXJjbGVGZWF0dXJlc187XG4gICAgfSBlbHNlIGlmIChpc1JlY3RhbmdsZSA9PT0gdHJ1ZSB8fCBpc1JlY3RhbmdsZSA9PT0gJ3RydWUnKSB7XG4gICAgICBmZWF0dXJlcyA9IHRoaXMucmVjdGFuZ2xlRmVhdHVyZXNfO1xuICAgIH0gZWxzZSB7XG4gICAgICBmZWF0dXJlcyA9IHRoaXMub3RoZXJGZWF0dXJlc187XG4gICAgfVxuXG4gICAgcmV0dXJuIGZlYXR1cmVzO1xuICB9O1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0ob2xJbnRlcmFjdGlvbkludGVyYWN0aW9uKTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IG5nZW9DdXN0b21FdmVudCBmcm9tICduZ2VvL0N1c3RvbUV2ZW50LmpzJztcbmltcG9ydCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMgZnJvbSAnbmdlby9mb3JtYXQvRmVhdHVyZVByb3BlcnRpZXMuanMnO1xuaW1wb3J0IHsgZ2V0RGVmYXVsdE1vZGlmeVN0eWxlRnVuY3Rpb24gfSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL2NvbW1vbi5qcyc7XG5pbXBvcnQgeyBnZXRBemltdXQgfSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL01lYXN1cmVBemltdXQuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0IG9sRmVhdHVyZSBmcm9tICdvbC9GZWF0dXJlLmpzJztcbmltcG9ydCBvbE1hcEJyb3dzZXJQb2ludGVyRXZlbnQgZnJvbSAnb2wvTWFwQnJvd3NlclBvaW50ZXJFdmVudC5qcyc7XG5pbXBvcnQgKiBhcyBvbENvb3JkaW5hdGUgZnJvbSAnb2wvY29vcmRpbmF0ZS5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4gfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0ICogYXMgb2xFeHRlbnQgZnJvbSAnb2wvZXh0ZW50LmpzJztcbmltcG9ydCBvbEdlb21DaXJjbGUgZnJvbSAnb2wvZ2VvbS9DaXJjbGUuanMnO1xuaW1wb3J0IG9sR2VvbUxpbmVTdHJpbmcgZnJvbSAnb2wvZ2VvbS9MaW5lU3RyaW5nLmpzJztcbmltcG9ydCBvbEdlb21Qb2ludCBmcm9tICdvbC9nZW9tL1BvaW50LmpzJztcbmltcG9ydCB7IGZyb21DaXJjbGUgfSBmcm9tICdvbC9nZW9tL1BvbHlnb24uanMnO1xuaW1wb3J0IG9sSW50ZXJhY3Rpb25Qb2ludGVyIGZyb20gJ29sL2ludGVyYWN0aW9uL1BvaW50ZXIuanMnO1xuaW1wb3J0IG9sTGF5ZXJWZWN0b3IgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yLmpzJztcbmltcG9ydCBvbFNvdXJjZVZlY3RvciBmcm9tICdvbC9zb3VyY2UvVmVjdG9yLmpzJztcbmltcG9ydCBvbFN0cnVjdHNSQnVzaCBmcm9tICdvbC9zdHJ1Y3RzL1JCdXNoLmpzJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoX29sSW50ZXJhY3Rpb25Qb2ludGVyKSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfb2xJbnRlcmFjdGlvblBvaW50ZXIpO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfdGhpcyA9IF9vbEludGVyYWN0aW9uUG9pbnRlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgX3RoaXMuaGFuZGxlRG93bkV2ZW50ID0gX3RoaXMuaGFuZGxlRG93bkV2ZW50XztcbiAgICBfdGhpcy5oYW5kbGVEcmFnRXZlbnQgPSBfdGhpcy5oYW5kbGVEcmFnRXZlbnRfO1xuICAgIF90aGlzLmhhbmRsZUV2ZW50ID0gX3RoaXMuaGFuZGxlRXZlbnQ7XG4gICAgX3RoaXMuaGFuZGxlVXBFdmVudCA9IF90aGlzLmhhbmRsZVVwRXZlbnRfO1xuICAgIGNvbnNvbGUuYXNzZXJ0KG9wdGlvbnMuZmVhdHVyZXMpO1xuICAgIF90aGlzLnZlcnRleEZlYXR1cmVfID0gbnVsbDtcbiAgICBfdGhpcy5sYXN0UGl4ZWxfID0gWzAsIDBdO1xuICAgIF90aGlzLm1vZGlmaWVkXyA9IGZhbHNlO1xuICAgIF90aGlzLnJCdXNoXyA9IG5ldyBvbFN0cnVjdHNSQnVzaCgpO1xuICAgIF90aGlzLnBpeGVsVG9sZXJhbmNlXyA9IG9wdGlvbnMucGl4ZWxUb2xlcmFuY2UgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucGl4ZWxUb2xlcmFuY2UgOiAxMDtcbiAgICBfdGhpcy5zbmFwcGVkVG9WZXJ0ZXhfID0gZmFsc2U7XG4gICAgX3RoaXMuY2hhbmdpbmdGZWF0dXJlXyA9IGZhbHNlO1xuICAgIF90aGlzLmRyYWdTZWdtZW50c18gPSBbXTtcbiAgICBfdGhpcy5vdmVybGF5XyA9IG5ldyBvbExheWVyVmVjdG9yKHtcbiAgICAgIHNvdXJjZTogbmV3IG9sU291cmNlVmVjdG9yKHtcbiAgICAgICAgdXNlU3BhdGlhbEluZGV4OiBmYWxzZSxcbiAgICAgICAgd3JhcFg6ICEhb3B0aW9ucy53cmFwWFxuICAgICAgfSksXG4gICAgICBzdHlsZTogb3B0aW9ucy5zdHlsZSB8fCBnZXREZWZhdWx0TW9kaWZ5U3R5bGVGdW5jdGlvbigpLFxuICAgICAgdXBkYXRlV2hpbGVBbmltYXRpbmc6IHRydWUsXG4gICAgICB1cGRhdGVXaGlsZUludGVyYWN0aW5nOiB0cnVlXG4gICAgfSk7XG4gICAgX3RoaXMuZmVhdHVyZXNfID0gb3B0aW9ucy5mZWF0dXJlcztcblxuICAgIF90aGlzLmZlYXR1cmVzXy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgICByZXR1cm4gX3RoaXMuYWRkRmVhdHVyZV8oZmVhdHVyZSk7XG4gICAgfSk7XG5cbiAgICBsaXN0ZW4oX3RoaXMuZmVhdHVyZXNfLCAnYWRkJywgX3RoaXMuaGFuZGxlRmVhdHVyZUFkZF8sIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcbiAgICBsaXN0ZW4oX3RoaXMuZmVhdHVyZXNfLCAncmVtb3ZlJywgX3RoaXMuaGFuZGxlRmVhdHVyZVJlbW92ZV8sIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gX2RlZmF1bHQucHJvdG90eXBlO1xuXG4gIF9wcm90by5hZGRGZWF0dXJlXyA9IGZ1bmN0aW9uIGFkZEZlYXR1cmVfKGZlYXR1cmUpIHtcbiAgICB2YXIgZ2VvbWV0cnkgPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICBpZiAoZ2VvbWV0cnkuZ2V0VHlwZSgpID09PSAnUG9seWdvbicgJiYgISFmZWF0dXJlLmdldChuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuSVNfQ0lSQ0xFKSkge1xuICAgICAgdmFyIF9nZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgICAgdGhpcy53cml0ZUNpcmNsZUdlb21ldHJ5XyhmZWF0dXJlLCBfZ2VvbWV0cnkpO1xuICAgICAgdmFyIG1hcCA9IHRoaXMuZ2V0TWFwKCk7XG5cbiAgICAgIGlmIChtYXApIHtcbiAgICAgICAgdGhpcy5oYW5kbGVQb2ludGVyQXRQaXhlbF8odGhpcy5sYXN0UGl4ZWxfLCBtYXApO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ud2lsbE1vZGlmeUZlYXR1cmVzXyA9IGZ1bmN0aW9uIHdpbGxNb2RpZnlGZWF0dXJlc18oZXZ0KSB7XG4gICAgaWYgKCF0aGlzLm1vZGlmaWVkXykge1xuICAgICAgdGhpcy5tb2RpZmllZF8gPSB0cnVlO1xuICAgICAgdmFyIGV2ZW50ID0gbmV3IG5nZW9DdXN0b21FdmVudCgnbW9kaWZ5c3RhcnQnLCB7XG4gICAgICAgIGZlYXR1cmVzOiB0aGlzLmZlYXR1cmVzX1xuICAgICAgfSk7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlRmVhdHVyZV8gPSBmdW5jdGlvbiByZW1vdmVGZWF0dXJlXyhmZWF0dXJlKSB7XG4gICAgdGhpcy5yZW1vdmVGZWF0dXJlU2VnbWVudERhdGFfKGZlYXR1cmUpO1xuXG4gICAgaWYgKHRoaXMudmVydGV4RmVhdHVyZV8gJiYgdGhpcy5mZWF0dXJlc18uZ2V0TGVuZ3RoKCkgPT09IDApIHtcbiAgICAgIHRoaXMub3ZlcmxheV8uZ2V0U291cmNlKCkucmVtb3ZlRmVhdHVyZSh0aGlzLnZlcnRleEZlYXR1cmVfKTtcbiAgICAgIHRoaXMudmVydGV4RmVhdHVyZV8gPSBudWxsO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlRmVhdHVyZVNlZ21lbnREYXRhXyA9IGZ1bmN0aW9uIHJlbW92ZUZlYXR1cmVTZWdtZW50RGF0YV8oZmVhdHVyZSkge1xuICAgIHZhciByQnVzaCA9IHRoaXMuckJ1c2hfO1xuICAgIHZhciBub2Rlc1RvUmVtb3ZlID0gW107XG4gICAgckJ1c2guZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgaWYgKGZlYXR1cmUgPT09IG5vZGUuZmVhdHVyZSkge1xuICAgICAgICBub2Rlc1RvUmVtb3ZlLnB1c2gobm9kZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBmb3IgKHZhciBpID0gbm9kZXNUb1JlbW92ZS5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgckJ1c2gucmVtb3ZlKG5vZGVzVG9SZW1vdmVbaV0pO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uc2V0TWFwID0gZnVuY3Rpb24gc2V0TWFwKG1hcCkge1xuICAgIHRoaXMub3ZlcmxheV8uc2V0TWFwKG1hcCk7XG5cbiAgICBfb2xJbnRlcmFjdGlvblBvaW50ZXIucHJvdG90eXBlLnNldE1hcC5jYWxsKHRoaXMsIG1hcCk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUZlYXR1cmVBZGRfID0gZnVuY3Rpb24gaGFuZGxlRmVhdHVyZUFkZF8oZXZ0KSB7XG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgICAgdmFyIGZlYXR1cmUgPSBldnQuZWxlbWVudDtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KGZlYXR1cmUgaW5zdGFuY2VvZiBvbEZlYXR1cmUsICdmZWF0dXJlIHNob3VsZCBiZSBhbiBvbC5GZWF0dXJlJyk7XG4gICAgICB0aGlzLmFkZEZlYXR1cmVfKGZlYXR1cmUpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRmVhdHVyZVJlbW92ZV8gPSBmdW5jdGlvbiBoYW5kbGVGZWF0dXJlUmVtb3ZlXyhldnQpIHtcbiAgICBpZiAoZXZ0IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgICB2YXIgZmVhdHVyZSA9IGV2dC5lbGVtZW50O1xuICAgICAgdGhpcy5yZW1vdmVGZWF0dXJlXyhmZWF0dXJlKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLndyaXRlQ2lyY2xlR2VvbWV0cnlfID0gZnVuY3Rpb24gd3JpdGVDaXJjbGVHZW9tZXRyeV8oZmVhdHVyZSwgZ2VvbWV0cnkpIHtcbiAgICB2YXIgcmluZ3MgPSBnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpO1xuICAgIHZhciBjb29yZGluYXRlcywgaSwgaWksIGosIGpqLCBzZWdtZW50LCBzZWdtZW50RGF0YTtcblxuICAgIGZvciAoaiA9IDAsIGpqID0gcmluZ3MubGVuZ3RoOyBqIDwgamo7ICsraikge1xuICAgICAgY29vcmRpbmF0ZXMgPSByaW5nc1tqXTtcblxuICAgICAgZm9yIChpID0gMCwgaWkgPSBjb29yZGluYXRlcy5sZW5ndGggLSAxOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBzZWdtZW50ID0gY29vcmRpbmF0ZXMuc2xpY2UoaSwgaSArIDIpO1xuICAgICAgICBzZWdtZW50RGF0YSA9IHtcbiAgICAgICAgICBmZWF0dXJlOiBmZWF0dXJlLFxuICAgICAgICAgIGdlb21ldHJ5OiBnZW9tZXRyeSxcbiAgICAgICAgICBkZXB0aDogW2pdLFxuICAgICAgICAgIGluZGV4OiBpLFxuICAgICAgICAgIHNlZ21lbnQ6IHNlZ21lbnRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yQnVzaF8uaW5zZXJ0KG9sRXh0ZW50LmJvdW5kaW5nRXh0ZW50KHNlZ21lbnQpLCBzZWdtZW50RGF0YSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5jcmVhdGVPclVwZGF0ZVZlcnRleEZlYXR1cmVfID0gZnVuY3Rpb24gY3JlYXRlT3JVcGRhdGVWZXJ0ZXhGZWF0dXJlXyhjb29yZGluYXRlcykge1xuICAgIHZhciB2ZXJ0ZXhGZWF0dXJlID0gdGhpcy52ZXJ0ZXhGZWF0dXJlXztcblxuICAgIGlmICghdmVydGV4RmVhdHVyZSkge1xuICAgICAgdmVydGV4RmVhdHVyZSA9IG5ldyBvbEZlYXR1cmUobmV3IG9sR2VvbVBvaW50KGNvb3JkaW5hdGVzKSk7XG4gICAgICB0aGlzLnZlcnRleEZlYXR1cmVfID0gdmVydGV4RmVhdHVyZTtcbiAgICAgIHRoaXMub3ZlcmxheV8uZ2V0U291cmNlKCkuYWRkRmVhdHVyZSh2ZXJ0ZXhGZWF0dXJlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGdlb21ldHJ5ID0gdmVydGV4RmVhdHVyZS5nZXRHZW9tZXRyeSgpO1xuXG4gICAgICBpZiAoIShnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbVBvaW50KSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGdlb21ldHJ5IHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgZ2VvbWV0cnkuc2V0Q29vcmRpbmF0ZXMoY29vcmRpbmF0ZXMpO1xuICAgIH1cblxuICAgIHJldHVybiB2ZXJ0ZXhGZWF0dXJlO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVQb2ludGVyTW92ZV8gPSBmdW5jdGlvbiBoYW5kbGVQb2ludGVyTW92ZV8oZXZ0KSB7XG4gICAgdGhpcy5sYXN0UGl4ZWxfID0gZXZ0LnBpeGVsO1xuICAgIHRoaXMuaGFuZGxlUG9pbnRlckF0UGl4ZWxfKGV2dC5waXhlbCwgZXZ0Lm1hcCk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZVBvaW50ZXJBdFBpeGVsXyA9IGZ1bmN0aW9uIGhhbmRsZVBvaW50ZXJBdFBpeGVsXyhwaXhlbCwgbWFwKSB7XG4gICAgdmFyIHBpeGVsQ29vcmRpbmF0ZSA9IG1hcC5nZXRDb29yZGluYXRlRnJvbVBpeGVsKHBpeGVsKTtcblxuICAgIHZhciBzb3J0QnlEaXN0YW5jZSA9IGZ1bmN0aW9uIHNvcnRCeURpc3RhbmNlKGEsIGIpIHtcbiAgICAgIHJldHVybiBvbENvb3JkaW5hdGUuc3F1YXJlZERpc3RhbmNlVG9TZWdtZW50KHBpeGVsQ29vcmRpbmF0ZSwgYS5zZWdtZW50KSAtIG9sQ29vcmRpbmF0ZS5zcXVhcmVkRGlzdGFuY2VUb1NlZ21lbnQocGl4ZWxDb29yZGluYXRlLCBiLnNlZ21lbnQpO1xuICAgIH07XG5cbiAgICB2YXIgbG93ZXJMZWZ0ID0gbWFwLmdldENvb3JkaW5hdGVGcm9tUGl4ZWwoW3BpeGVsWzBdIC0gdGhpcy5waXhlbFRvbGVyYW5jZV8sIHBpeGVsWzFdICsgdGhpcy5waXhlbFRvbGVyYW5jZV9dKTtcbiAgICB2YXIgdXBwZXJSaWdodCA9IG1hcC5nZXRDb29yZGluYXRlRnJvbVBpeGVsKFtwaXhlbFswXSArIHRoaXMucGl4ZWxUb2xlcmFuY2VfLCBwaXhlbFsxXSAtIHRoaXMucGl4ZWxUb2xlcmFuY2VfXSk7XG4gICAgdmFyIGJveCA9IG9sRXh0ZW50LmJvdW5kaW5nRXh0ZW50KFtsb3dlckxlZnQsIHVwcGVyUmlnaHRdKTtcbiAgICB2YXIgbm9kZXMgPSB0aGlzLnJCdXNoXy5nZXRJbkV4dGVudChib3gpO1xuXG4gICAgaWYgKG5vZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIG5vZGVzLnNvcnQoc29ydEJ5RGlzdGFuY2UpO1xuICAgICAgdmFyIG5vZGUgPSBub2Rlc1swXTtcbiAgICAgIHZhciBjbG9zZXN0U2VnbWVudCA9IG5vZGUuc2VnbWVudDtcbiAgICAgIHZhciB2ZXJ0ZXggPSBvbENvb3JkaW5hdGUuY2xvc2VzdE9uU2VnbWVudChwaXhlbENvb3JkaW5hdGUsIGNsb3Nlc3RTZWdtZW50KTtcbiAgICAgIHZhciB2ZXJ0ZXhQaXhlbCA9IG1hcC5nZXRQaXhlbEZyb21Db29yZGluYXRlKHZlcnRleCk7XG5cbiAgICAgIGlmIChNYXRoLnNxcnQob2xDb29yZGluYXRlLnNxdWFyZWREaXN0YW5jZShwaXhlbCwgdmVydGV4UGl4ZWwpKSA8PSB0aGlzLnBpeGVsVG9sZXJhbmNlXykge1xuICAgICAgICB2YXIgcGl4ZWwxID0gbWFwLmdldFBpeGVsRnJvbUNvb3JkaW5hdGUoY2xvc2VzdFNlZ21lbnRbMF0pO1xuICAgICAgICB2YXIgcGl4ZWwyID0gbWFwLmdldFBpeGVsRnJvbUNvb3JkaW5hdGUoY2xvc2VzdFNlZ21lbnRbMV0pO1xuICAgICAgICB2YXIgc3F1YXJlZERpc3QxID0gb2xDb29yZGluYXRlLnNxdWFyZWREaXN0YW5jZSh2ZXJ0ZXhQaXhlbCwgcGl4ZWwxKTtcbiAgICAgICAgdmFyIHNxdWFyZWREaXN0MiA9IG9sQ29vcmRpbmF0ZS5zcXVhcmVkRGlzdGFuY2UodmVydGV4UGl4ZWwsIHBpeGVsMik7XG4gICAgICAgIHZhciBkaXN0ID0gTWF0aC5zcXJ0KE1hdGgubWluKHNxdWFyZWREaXN0MSwgc3F1YXJlZERpc3QyKSk7XG4gICAgICAgIHRoaXMuc25hcHBlZFRvVmVydGV4XyA9IGRpc3QgPD0gdGhpcy5waXhlbFRvbGVyYW5jZV87XG5cbiAgICAgICAgaWYgKHRoaXMuc25hcHBlZFRvVmVydGV4Xykge1xuICAgICAgICAgIHZlcnRleCA9IHNxdWFyZWREaXN0MSA+IHNxdWFyZWREaXN0MiA/IGNsb3Nlc3RTZWdtZW50WzFdIDogY2xvc2VzdFNlZ21lbnRbMF07XG4gICAgICAgICAgdGhpcy5jcmVhdGVPclVwZGF0ZVZlcnRleEZlYXR1cmVfKHZlcnRleCk7XG4gICAgICAgICAgdmFyIHZlcnRleFNlZ21lbnRzID0ge307XG4gICAgICAgICAgdmVydGV4U2VnbWVudHNbb2xVdGlsR2V0VWlkKGNsb3Nlc3RTZWdtZW50KV0gPSB0cnVlO1xuICAgICAgICAgIHZhciBzZWdtZW50O1xuXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDEsIGlpID0gbm9kZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgICAgc2VnbWVudCA9IG5vZGVzW2ldLnNlZ21lbnQ7XG5cbiAgICAgICAgICAgIGlmIChvbENvb3JkaW5hdGUuZXF1YWxzKGNsb3Nlc3RTZWdtZW50WzBdLCBzZWdtZW50WzBdKSAmJiBvbENvb3JkaW5hdGUuZXF1YWxzKGNsb3Nlc3RTZWdtZW50WzFdLCBzZWdtZW50WzFdKSB8fCBvbENvb3JkaW5hdGUuZXF1YWxzKGNsb3Nlc3RTZWdtZW50WzBdLCBzZWdtZW50WzFdKSAmJiBvbENvb3JkaW5hdGUuZXF1YWxzKGNsb3Nlc3RTZWdtZW50WzFdLCBzZWdtZW50WzBdKSkge1xuICAgICAgICAgICAgICB2ZXJ0ZXhTZWdtZW50c1tvbFV0aWxHZXRVaWQoc2VnbWVudCldID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLnZlcnRleEZlYXR1cmVfKSB7XG4gICAgICB0aGlzLm92ZXJsYXlfLmdldFNvdXJjZSgpLnJlbW92ZUZlYXR1cmUodGhpcy52ZXJ0ZXhGZWF0dXJlXyk7XG4gICAgICB0aGlzLnZlcnRleEZlYXR1cmVfID0gbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnNldEdlb21ldHJ5Q29vcmRpbmF0ZXNfID0gZnVuY3Rpb24gc2V0R2VvbWV0cnlDb29yZGluYXRlc18oZ2VvbWV0cnksIGNvb3JkaW5hdGVzKSB7XG4gICAgdGhpcy5jaGFuZ2luZ0ZlYXR1cmVfID0gdHJ1ZTtcbiAgICBnZW9tZXRyeS5zZXRDb29yZGluYXRlcyhjb29yZGluYXRlcyk7XG4gICAgdGhpcy5jaGFuZ2luZ0ZlYXR1cmVfID0gZmFsc2U7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZURvd25FdmVudF8gPSBmdW5jdGlvbiBoYW5kbGVEb3duRXZlbnRfKGV2dCkge1xuICAgIHRoaXMuaGFuZGxlUG9pbnRlckF0UGl4ZWxfKGV2dC5waXhlbCwgZXZ0Lm1hcCk7XG4gICAgdGhpcy5kcmFnU2VnbWVudHNfID0gW107XG4gICAgdGhpcy5tb2RpZmllZF8gPSBmYWxzZTtcbiAgICB2YXIgdmVydGV4RmVhdHVyZSA9IHRoaXMudmVydGV4RmVhdHVyZV87XG5cbiAgICBpZiAodmVydGV4RmVhdHVyZSkge1xuICAgICAgdmFyIGdlb21ldHJ5ID0gdmVydGV4RmVhdHVyZS5nZXRHZW9tZXRyeSgpO1xuXG4gICAgICBpZiAoIShnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbVBvaW50KSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIGdlb21ldHJ5IHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHZlcnRleCA9IGdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCk7XG4gICAgICB2YXIgdmVydGV4RXh0ZW50ID0gb2xFeHRlbnQuYm91bmRpbmdFeHRlbnQoW3ZlcnRleF0pO1xuICAgICAgdmFyIHNlZ21lbnREYXRhTWF0Y2hlcyA9IHRoaXMuckJ1c2hfLmdldEluRXh0ZW50KHZlcnRleEV4dGVudCk7XG4gICAgICB2YXIgY29tcG9uZW50U2VnbWVudHMgPSB7fTtcbiAgICAgIHNlZ21lbnREYXRhTWF0Y2hlcy5zb3J0KGNvbXBhcmVJbmRleGVzKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gc2VnbWVudERhdGFNYXRjaGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgdmFyIHNlZ21lbnREYXRhTWF0Y2ggPSBzZWdtZW50RGF0YU1hdGNoZXNbaV07XG4gICAgICAgIHZhciBzZWdtZW50ID0gc2VnbWVudERhdGFNYXRjaC5zZWdtZW50O1xuICAgICAgICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKHNlZ21lbnREYXRhTWF0Y2guZmVhdHVyZSk7XG4gICAgICAgIHZhciBkZXB0aCA9IHNlZ21lbnREYXRhTWF0Y2guZGVwdGg7XG5cbiAgICAgICAgaWYgKGRlcHRoKSB7XG4gICAgICAgICAgdWlkICs9IFwiLVwiICsgZGVwdGguam9pbignLScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjb21wb25lbnRTZWdtZW50c1t1aWRdKSB7XG4gICAgICAgICAgY29tcG9uZW50U2VnbWVudHNbdWlkXSA9IG5ldyBBcnJheSgyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvbENvb3JkaW5hdGUuZXF1YWxzKHNlZ21lbnRbMF0sIHZlcnRleCkgJiYgIWNvbXBvbmVudFNlZ21lbnRzW3VpZF1bMF0pIHtcbiAgICAgICAgICB0aGlzLmRyYWdTZWdtZW50c18ucHVzaChbc2VnbWVudERhdGFNYXRjaCwgMF0pO1xuICAgICAgICAgIGNvbXBvbmVudFNlZ21lbnRzW3VpZF1bMF0gPSBzZWdtZW50RGF0YU1hdGNoO1xuICAgICAgICB9IGVsc2UgaWYgKG9sQ29vcmRpbmF0ZS5lcXVhbHMoc2VnbWVudFsxXSwgdmVydGV4KSAmJiAhY29tcG9uZW50U2VnbWVudHNbdWlkXVsxXSkge1xuICAgICAgICAgIHRoaXMuZHJhZ1NlZ21lbnRzXy5wdXNoKFtzZWdtZW50RGF0YU1hdGNoLCAxXSk7XG4gICAgICAgICAgY29tcG9uZW50U2VnbWVudHNbdWlkXVsxXSA9IHNlZ21lbnREYXRhTWF0Y2g7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gISF0aGlzLnZlcnRleEZlYXR1cmVfO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEcmFnRXZlbnRfID0gZnVuY3Rpb24gaGFuZGxlRHJhZ0V2ZW50XyhldnQpIHtcbiAgICB0aGlzLndpbGxNb2RpZnlGZWF0dXJlc18oZXZ0KTtcbiAgICB2YXIgdmVydGV4ID0gZXZ0LmNvb3JkaW5hdGU7XG4gICAgdmFyIGdlb21ldHJ5ID0gdGhpcy5kcmFnU2VnbWVudHNfWzBdWzBdLmdlb21ldHJ5O1xuICAgIHZhciBjZW50ZXIgPSBvbEV4dGVudC5nZXRDZW50ZXIoZ2VvbWV0cnkuZ2V0RXh0ZW50KCkpO1xuICAgIHZhciBsaW5lID0gbmV3IG9sR2VvbUxpbmVTdHJpbmcoW2NlbnRlciwgdmVydGV4XSk7XG4gICAgdmFyIGNpcmNsZSA9IG5ldyBvbEdlb21DaXJjbGUoY2VudGVyLCBsaW5lLmdldExlbmd0aCgpKTtcbiAgICB2YXIgY29vcmRpbmF0ZXMgPSBmcm9tQ2lyY2xlKGNpcmNsZSwgNjQpLmdldENvb3JkaW5hdGVzKCk7XG4gICAgdGhpcy5zZXRHZW9tZXRyeUNvb3JkaW5hdGVzXyhnZW9tZXRyeSwgY29vcmRpbmF0ZXMpO1xuICAgIHZhciBhemltdXQgPSBnZXRBemltdXQobGluZSk7XG4gICAgdGhpcy5mZWF0dXJlc18uZ2V0QXJyYXkoKVswXS5zZXQobmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLkFaSU1VVCwgYXppbXV0KTtcbiAgICB0aGlzLmNyZWF0ZU9yVXBkYXRlVmVydGV4RmVhdHVyZV8odmVydGV4KTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlVXBFdmVudF8gPSBmdW5jdGlvbiBoYW5kbGVVcEV2ZW50XyhldnQpIHtcbiAgICB0aGlzLnJCdXNoXy5jbGVhcigpO1xuICAgIHRoaXMud3JpdGVDaXJjbGVHZW9tZXRyeV8odGhpcy5kcmFnU2VnbWVudHNfWzBdWzBdLmZlYXR1cmUsIHRoaXMuZHJhZ1NlZ21lbnRzX1swXVswXS5nZW9tZXRyeSk7XG5cbiAgICBpZiAodGhpcy5tb2RpZmllZF8pIHtcbiAgICAgIHZhciBldmVudCA9IG5ldyBuZ2VvQ3VzdG9tRXZlbnQoJ21vZGlmeWVuZCcsIHtcbiAgICAgICAgZmVhdHVyZXM6IHRoaXMuZmVhdHVyZXNfXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICB0aGlzLm1vZGlmaWVkXyA9IGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRXZlbnQgPSBmdW5jdGlvbiBoYW5kbGVFdmVudChtYXBCcm93c2VyRXZlbnQpIHtcbiAgICBpZiAoIShtYXBCcm93c2VyRXZlbnQgaW5zdGFuY2VvZiBvbE1hcEJyb3dzZXJQb2ludGVyRXZlbnQpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgaGFuZGxlZDtcblxuICAgIGlmICghbWFwQnJvd3NlckV2ZW50Lm1hcC5nZXRWaWV3KCkuZ2V0SW50ZXJhY3RpbmcoKSAmJiBtYXBCcm93c2VyRXZlbnQudHlwZSA9PSAncG9pbnRlcm1vdmUnICYmICF0aGlzLmhhbmRsaW5nRG93blVwU2VxdWVuY2UpIHtcbiAgICAgIHRoaXMuaGFuZGxlUG9pbnRlck1vdmVfKG1hcEJyb3dzZXJFdmVudCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9vbEludGVyYWN0aW9uUG9pbnRlci5wcm90b3R5cGUuaGFuZGxlRXZlbnQuY2FsbCh0aGlzLCBtYXBCcm93c2VyRXZlbnQpICYmICFoYW5kbGVkO1xuICB9O1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0ob2xJbnRlcmFjdGlvblBvaW50ZXIpO1xuXG5leHBvcnQgeyBfZGVmYXVsdCBhcyBkZWZhdWx0IH07XG5cbmZ1bmN0aW9uIGNvbXBhcmVJbmRleGVzKGEsIGIpIHtcbiAgcmV0dXJuIGEuaW5kZXggLSBiLmluZGV4O1xufSIsImZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IHsgZ2V0RGVmYXVsdE1vZGlmeVN0eWxlRnVuY3Rpb24gfSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL2NvbW1vbi5qcyc7XG5pbXBvcnQgbmdlb0N1c3RvbUV2ZW50IGZyb20gJ25nZW8vQ3VzdG9tRXZlbnQuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0IG9sRmVhdHVyZSBmcm9tICdvbC9GZWF0dXJlLmpzJztcbmltcG9ydCB7IGxpc3RlbiB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xHZW9tUG9pbnQgZnJvbSAnb2wvZ2VvbS9Qb2ludC5qcyc7XG5pbXBvcnQgb2xHZW9tUG9seWdvbiBmcm9tICdvbC9nZW9tL1BvbHlnb24uanMnO1xuaW1wb3J0IG9sSW50ZXJhY3Rpb25Qb2ludGVyIGZyb20gJ29sL2ludGVyYWN0aW9uL1BvaW50ZXIuanMnO1xuaW1wb3J0IG9sTGF5ZXJWZWN0b3IgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yLmpzJztcbmltcG9ydCBvbFNvdXJjZVZlY3RvciBmcm9tICdvbC9zb3VyY2UvVmVjdG9yLmpzJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuXG52YXIgTW9kaWZ5UmVjdGFuZ2xlID0gZnVuY3Rpb24gKF9vbEludGVyYWN0aW9uUG9pbnRlcikge1xuICBfaW5oZXJpdHNMb29zZShNb2RpZnlSZWN0YW5nbGUsIF9vbEludGVyYWN0aW9uUG9pbnRlcik7XG5cbiAgZnVuY3Rpb24gTW9kaWZ5UmVjdGFuZ2xlKG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfdGhpcyA9IF9vbEludGVyYWN0aW9uUG9pbnRlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgY29uc29sZS5hc3NlcnQob3B0aW9ucy5mZWF0dXJlcyk7XG4gICAgX3RoaXMuaGFuZGxlRG93bkV2ZW50ID0gX3RoaXMuaGFuZGxlRG93bl87XG4gICAgX3RoaXMuaGFuZGxlRHJhZ0V2ZW50ID0gX3RoaXMuaGFuZGxlRHJhZ187XG4gICAgX3RoaXMuaGFuZGxlVXBFdmVudCA9IF90aGlzLmhhbmRsZVVwXztcbiAgICBfdGhpcy5tb2RpZmllZF8gPSBmYWxzZTtcbiAgICBfdGhpcy52ZWN0b3JQb2ludHNfID0gbmV3IG9sTGF5ZXJWZWN0b3Ioe1xuICAgICAgc291cmNlOiBuZXcgb2xTb3VyY2VWZWN0b3Ioe1xuICAgICAgICB3cmFwWDogISFvcHRpb25zLndyYXBYXG4gICAgICB9KSxcbiAgICAgIHZpc2libGU6IF90aGlzLmdldEFjdGl2ZSgpLFxuICAgICAgc3R5bGU6IG9wdGlvbnMuc3R5bGUgfHwgZ2V0RGVmYXVsdE1vZGlmeVN0eWxlRnVuY3Rpb24oKSxcbiAgICAgIHVwZGF0ZVdoaWxlQW5pbWF0aW5nOiB0cnVlLFxuICAgICAgdXBkYXRlV2hpbGVJbnRlcmFjdGluZzogdHJ1ZVxuICAgIH0pO1xuICAgIF90aGlzLmZlYXR1cmVzXyA9IG9wdGlvbnMuZmVhdHVyZXM7XG4gICAgX3RoaXMuZmVhdHVyZV8gPSBudWxsO1xuICAgIF90aGlzLmNhY2hlXyA9IHt9O1xuICAgIF90aGlzLnBhcmFtc18gPSBudWxsO1xuICAgIGxpc3RlbihfdGhpcy5mZWF0dXJlc18sICdhZGQnLCBfdGhpcy5oYW5kbGVGZWF0dXJlQWRkXywgX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpO1xuICAgIGxpc3RlbihfdGhpcy5mZWF0dXJlc18sICdyZW1vdmUnLCBfdGhpcy5oYW5kbGVGZWF0dXJlUmVtb3ZlXywgX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpO1xuXG4gICAgX3RoaXMuZmVhdHVyZXNfLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgIF90aGlzLmFkZEZlYXR1cmVfKGZlYXR1cmUpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IE1vZGlmeVJlY3RhbmdsZS5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLnNldEFjdGl2ZSA9IGZ1bmN0aW9uIHNldEFjdGl2ZShhY3RpdmUpIHtcbiAgICBvbEludGVyYWN0aW9uUG9pbnRlci5wcm90b3R5cGUuc2V0QWN0aXZlLmNhbGwodGhpcywgYWN0aXZlKTtcblxuICAgIGlmICh0aGlzLnZlY3RvclBvaW50c18pIHtcbiAgICAgIHRoaXMudmVjdG9yUG9pbnRzXy5zZXRWaXNpYmxlKGFjdGl2ZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5hZGRGZWF0dXJlXyA9IGZ1bmN0aW9uIGFkZEZlYXR1cmVfKGZlYXR1cmUpIHtcbiAgICB2YXIgZmVhdHVyZUdlb20gPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoZmVhdHVyZUdlb20gaW5zdGFuY2VvZiBvbEdlb21Qb2x5Z29uKSB7XG4gICAgICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKGZlYXR1cmUpO1xuICAgICAgdmFyIGl0ZW0gPSB0aGlzLmNhY2hlX1t1aWRdO1xuXG4gICAgICBpZiAoaXRlbSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBwb2ludFNvdXJjZSA9IHRoaXMudmVjdG9yUG9pbnRzXy5nZXRTb3VyY2UoKTtcbiAgICAgIHZhciBjb3JuZXJzID0gZmVhdHVyZUdlb20uZ2V0Q29vcmRpbmF0ZXMoKVswXTtcblxuICAgICAgd2hpbGUgKGNvcm5lcnMubGVuZ3RoID4gNCkge1xuICAgICAgICBpZiAoY29ybmVyc1swXVswXSA8IGNvcm5lcnNbMV1bMF0gJiYgY29ybmVyc1swXVsxXSA8PSBjb3JuZXJzWzFdWzFdKSB7XG4gICAgICAgICAgY29ybmVycy5wb3AoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb3JuZXJzLnNoaWZ0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIHBvaW50RmVhdHVyZXMgPSBbXTtcbiAgICAgIHZhciBjb3JuZXJQb2ludDtcbiAgICAgIHZhciBjb3JuZXJGZWF0dXJlO1xuICAgICAgY29ybmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjb3JuZXIpIHtcbiAgICAgICAgY29ybmVyUG9pbnQgPSBuZXcgb2xHZW9tUG9pbnQoY29ybmVyKTtcbiAgICAgICAgY29ybmVyRmVhdHVyZSA9IG5ldyBvbEZlYXR1cmUoe1xuICAgICAgICAgICdjb3JuZXInOiB0cnVlLFxuICAgICAgICAgICdnZW9tZXRyeSc6IGNvcm5lclBvaW50LFxuICAgICAgICAgICdzaWJsaW5nWCc6IG51bGwsXG4gICAgICAgICAgJ3NpYmxpbmdZJzogbnVsbCxcbiAgICAgICAgICAnYm94RmVhdHVyZSc6IGZlYXR1cmVcbiAgICAgICAgfSk7XG4gICAgICAgIHBvaW50RmVhdHVyZXMucHVzaChjb3JuZXJGZWF0dXJlKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgICAgaXRlbSA9IHtcbiAgICAgICAgY29ybmVyczogcG9pbnRGZWF0dXJlc1xuICAgICAgfTtcbiAgICAgIHRoaXMuY2FjaGVfW3VpZF0gPSBpdGVtO1xuICAgICAgdmFyIHByZXZpb3VzRmVhdHVyZTtcbiAgICAgIHZhciBuZXh0RmVhdHVyZTtcbiAgICAgIHBvaW50RmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbiAoY29ybmVyRmVhdHVyZSwgaW5kZXgpIHtcbiAgICAgICAgcHJldmlvdXNGZWF0dXJlID0gcG9pbnRGZWF0dXJlc1tpbmRleCAtIDFdO1xuXG4gICAgICAgIGlmICghcHJldmlvdXNGZWF0dXJlKSB7XG4gICAgICAgICAgcHJldmlvdXNGZWF0dXJlID0gcG9pbnRGZWF0dXJlc1twb2ludEZlYXR1cmVzLmxlbmd0aCAtIDFdO1xuICAgICAgICB9XG5cbiAgICAgICAgbmV4dEZlYXR1cmUgPSBwb2ludEZlYXR1cmVzW2luZGV4ICsgMV07XG5cbiAgICAgICAgaWYgKCFuZXh0RmVhdHVyZSkge1xuICAgICAgICAgIG5leHRGZWF0dXJlID0gcG9pbnRGZWF0dXJlc1swXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbmRleCAlIDIgPT09IDApIHtcbiAgICAgICAgICBjb3JuZXJGZWF0dXJlLnNldCgnc2libGluZ1gnLCBuZXh0RmVhdHVyZSk7XG4gICAgICAgICAgY29ybmVyRmVhdHVyZS5zZXQoJ3NpYmxpbmdZJywgcHJldmlvdXNGZWF0dXJlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb3JuZXJGZWF0dXJlLnNldCgnc2libGluZ1gnLCBwcmV2aW91c0ZlYXR1cmUpO1xuICAgICAgICAgIGNvcm5lckZlYXR1cmUuc2V0KCdzaWJsaW5nWScsIG5leHRGZWF0dXJlKTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcyk7XG4gICAgICBwb2ludFNvdXJjZS5hZGRGZWF0dXJlcyhwb2ludEZlYXR1cmVzKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLndpbGxNb2RpZnlGZWF0dXJlc18gPSBmdW5jdGlvbiB3aWxsTW9kaWZ5RmVhdHVyZXNfKGV2dCkge1xuICAgIGlmICghdGhpcy5tb2RpZmllZF8pIHtcbiAgICAgIHRoaXMubW9kaWZpZWRfID0gdHJ1ZTtcbiAgICAgIHZhciBldmVudCA9IG5ldyBuZ2VvQ3VzdG9tRXZlbnQoJ21vZGlmeXN0YXJ0Jywge1xuICAgICAgICBmZWF0dXJlczogdGhpcy5mZWF0dXJlc19cbiAgICAgIH0pO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgIHRoaXMucGFyYW1zXyA9IHRoaXMuaW5pdGlhbGl6ZVBhcmFtc18oKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmluaXRpYWxpemVQYXJhbXNfID0gZnVuY3Rpb24gaW5pdGlhbGl6ZVBhcmFtc18oKSB7XG4gICAgaWYgKCF0aGlzLmZlYXR1cmVfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZScpO1xuICAgIH1cblxuICAgIHZhciBmZWF0dXJlID0gdGhpcy5mZWF0dXJlXztcbiAgICB2YXIgc2libGluZ1kgPSBmZWF0dXJlLmdldCgnc2libGluZ1gnKTtcbiAgICBjb25zb2xlLmFzc2VydChzaWJsaW5nWSBpbnN0YW5jZW9mIG9sRmVhdHVyZSk7XG4gICAgdmFyIG9yaWdpbiA9IHNpYmxpbmdZLmdldCgnc2libGluZ1knKTtcbiAgICBjb25zb2xlLmFzc2VydChvcmlnaW4gaW5zdGFuY2VvZiBvbEZlYXR1cmUpO1xuICAgIHZhciBvcmlnaW5Qb2ludCA9IG9yaWdpbi5nZXRHZW9tZXRyeSgpO1xuICAgIGNvbnNvbGUuYXNzZXJ0KG9yaWdpblBvaW50IGluc3RhbmNlb2Ygb2xHZW9tUG9pbnQpO1xuICAgIHZhciBvcmlnaW5Db29yZGluYXRlID0gb3JpZ2luUG9pbnQuZ2V0Q29vcmRpbmF0ZXMoKTtcbiAgICB2YXIgb3JpZ2luUGl4ZWwgPSB0aGlzLmdldE1hcCgpLmdldFBpeGVsRnJvbUNvb3JkaW5hdGUob3JpZ2luQ29vcmRpbmF0ZSk7XG4gICAgdmFyIHNpYmxpbmdYID0gb3JpZ2luLmdldCgnc2libGluZ1gnKTtcbiAgICBjb25zb2xlLmFzc2VydChzaWJsaW5nWCBpbnN0YW5jZW9mIG9sRmVhdHVyZSk7XG4gICAgdmFyIHNpYmxpbmdYUG9pbnQgPSBzaWJsaW5nWC5nZXRHZW9tZXRyeSgpO1xuICAgIGNvbnNvbGUuYXNzZXJ0KHNpYmxpbmdYUG9pbnQgaW5zdGFuY2VvZiBvbEdlb21Qb2ludCk7XG4gICAgdmFyIHNpYmxpbmdYQ29vcmRpbmF0ZSA9IHNpYmxpbmdYUG9pbnQuZ2V0Q29vcmRpbmF0ZXMoKTtcbiAgICB2YXIgc2libGluZ1hQaXhlbCA9IHRoaXMuZ2V0TWFwKCkuZ2V0UGl4ZWxGcm9tQ29vcmRpbmF0ZShzaWJsaW5nWENvb3JkaW5hdGUpO1xuICAgIHZhciB2ZWN0b3JYID0gW3NpYmxpbmdYUGl4ZWxbMF0gLSBvcmlnaW5QaXhlbFswXSwgc2libGluZ1hQaXhlbFsxXSAtIG9yaWdpblBpeGVsWzFdXTtcbiAgICB2YXIgdmVjdG9yWE1hZ25pdHVkZSA9IE1hdGguc3FydCh2ZWN0b3JYWzBdICogdmVjdG9yWFswXSArIHZlY3RvclhbMV0gKiB2ZWN0b3JYWzFdKTtcbiAgICB2ZWN0b3JYWzBdIC89IHZlY3RvclhNYWduaXR1ZGU7XG4gICAgdmVjdG9yWFsxXSAvPSB2ZWN0b3JYTWFnbml0dWRlO1xuICAgIHZhciBzaWJsaW5nWVBvaW50ID0gc2libGluZ1kuZ2V0R2VvbWV0cnkoKTtcbiAgICBjb25zb2xlLmFzc2VydChzaWJsaW5nWVBvaW50IGluc3RhbmNlb2Ygb2xHZW9tUG9pbnQpO1xuICAgIHZhciBzaWJsaW5nWUNvb3JkaW5hdGUgPSBzaWJsaW5nWVBvaW50LmdldENvb3JkaW5hdGVzKCk7XG4gICAgdmFyIHNpYmxpbmdZUGl4ZWwgPSB0aGlzLmdldE1hcCgpLmdldFBpeGVsRnJvbUNvb3JkaW5hdGUoc2libGluZ1lDb29yZGluYXRlKTtcbiAgICB2YXIgdmVjdG9yWSA9IFtzaWJsaW5nWVBpeGVsWzBdIC0gb3JpZ2luUGl4ZWxbMF0sIHNpYmxpbmdZUGl4ZWxbMV0gLSBvcmlnaW5QaXhlbFsxXV07XG4gICAgdmFyIHZlY3RvcllNYWduaXR1ZGUgPSBNYXRoLnNxcnQodmVjdG9yWVswXSAqIHZlY3RvcllbMF0gKyB2ZWN0b3JZWzFdICogdmVjdG9yWVsxXSk7XG4gICAgdmVjdG9yWVswXSAvPSB2ZWN0b3JZTWFnbml0dWRlO1xuICAgIHZlY3RvcllbMV0gLz0gdmVjdG9yWU1hZ25pdHVkZTtcblxuICAgIGlmIChpc05hTih2ZWN0b3JYWzBdKSAmJiBpc05hTih2ZWN0b3JZWzBdKSkge1xuICAgICAgdmVjdG9yWCA9IFswLCAxXTtcbiAgICAgIHZlY3RvclkgPSBbMSwgMF07XG4gICAgfSBlbHNlIGlmIChpc05hTih2ZWN0b3JYWzBdKSkge1xuICAgICAgdmVjdG9yWCA9IFt2ZWN0b3JZWzFdLCAtdmVjdG9yWVswXV07XG4gICAgfSBlbHNlIGlmIChpc05hTih2ZWN0b3JZWzBdKSkge1xuICAgICAgdmVjdG9yWSA9IFt2ZWN0b3JYWzFdLCAtdmVjdG9yWFswXV07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIG9yaWdpbkNvb3JkaW5hdGU6IG9yaWdpbkNvb3JkaW5hdGUsXG4gICAgICBvcmlnaW5QaXhlbDogb3JpZ2luUGl4ZWwsXG4gICAgICBzaWJsaW5nWFBvaW50OiBzaWJsaW5nWFBvaW50LFxuICAgICAgc2libGluZ1lQb2ludDogc2libGluZ1lQb2ludCxcbiAgICAgIHZlY3Rvclg6IHZlY3RvclgsXG4gICAgICB2ZWN0b3JZOiB2ZWN0b3JZXG4gICAgfTtcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlRmVhdHVyZV8gPSBmdW5jdGlvbiByZW1vdmVGZWF0dXJlXyhmZWF0dXJlKSB7XG4gICAgdmFyIHVpZCA9IG9sVXRpbEdldFVpZChmZWF0dXJlKTtcbiAgICB2YXIgaXRlbSA9IHRoaXMuY2FjaGVfW3VpZF07XG4gICAgdmFyIGNvcm5lcnMgPSBpdGVtLmNvcm5lcnM7XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBjb3JuZXJzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgY29ybmVyID0gX3JlZjtcbiAgICAgIHRoaXMudmVjdG9yUG9pbnRzXy5nZXRTb3VyY2UoKS5yZW1vdmVGZWF0dXJlKGNvcm5lcik7XG4gICAgfVxuXG4gICAgdGhpcy5mZWF0dXJlXyA9IG51bGw7XG4gICAgY29ybmVycy5sZW5ndGggPSAwO1xuICAgIGRlbGV0ZSB0aGlzLmNhY2hlX1t1aWRdO1xuICB9O1xuXG4gIF9wcm90by5zZXRNYXAgPSBmdW5jdGlvbiBzZXRNYXAobWFwKSB7XG4gICAgdGhpcy52ZWN0b3JQb2ludHNfLnNldE1hcChtYXApO1xuICAgIG9sSW50ZXJhY3Rpb25Qb2ludGVyLnByb3RvdHlwZS5zZXRNYXAuY2FsbCh0aGlzLCBtYXApO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVGZWF0dXJlQWRkXyA9IGZ1bmN0aW9uIGhhbmRsZUZlYXR1cmVBZGRfKGV2dCkge1xuICAgIGlmIChldnQgaW5zdGFuY2VvZiBDb2xsZWN0aW9uRXZlbnQpIHtcbiAgICAgIHZhciBmZWF0dXJlID0gZXZ0LmVsZW1lbnQ7XG4gICAgICBjb25zb2xlLmFzc2VydChmZWF0dXJlIGluc3RhbmNlb2Ygb2xGZWF0dXJlLCAnZmVhdHVyZSBzaG91bGQgYmUgYW4gb2wuRmVhdHVyZScpO1xuICAgICAgdGhpcy5hZGRGZWF0dXJlXyhmZWF0dXJlKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUZlYXR1cmVSZW1vdmVfID0gZnVuY3Rpb24gaGFuZGxlRmVhdHVyZVJlbW92ZV8oZXZ0KSB7XG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgICAgdmFyIGZlYXR1cmUgPSBldnQuZWxlbWVudDtcbiAgICAgIHRoaXMucmVtb3ZlRmVhdHVyZV8oZmVhdHVyZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEb3duXyA9IGZ1bmN0aW9uIGhhbmRsZURvd25fKGV2dCkge1xuICAgIHZhciBtYXAgPSBldnQubWFwO1xuICAgIHZhciBmZWF0dXJlID0gbWFwLmZvckVhY2hGZWF0dXJlQXRQaXhlbChldnQucGl4ZWwsIGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgICByZXR1cm4gZmVhdHVyZS5nZXQoJ3NpYmxpbmdYJykgJiYgZmVhdHVyZS5nZXQoJ3NpYmxpbmdZJykgPyBmZWF0dXJlIDogdW5kZWZpbmVkO1xuICAgIH0pO1xuXG4gICAgaWYgKGZlYXR1cmUpIHtcbiAgICAgIHRoaXMuZmVhdHVyZV8gPSBmZWF0dXJlO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEcmFnXyA9IGZ1bmN0aW9uIGhhbmRsZURyYWdfKGV2dCkge1xuICAgIHRoaXMud2lsbE1vZGlmeUZlYXR1cmVzXyhldnQpO1xuXG4gICAgaWYgKCF0aGlzLmZlYXR1cmVfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmVhdHVyZScpO1xuICAgIH1cblxuICAgIHZhciBmZWF0dXJlID0gdGhpcy5mZWF0dXJlXztcbiAgICB2YXIgZ2VvbWV0cnkgPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21Qb2ludCkge1xuICAgICAgZ2VvbWV0cnkuc2V0Q29vcmRpbmF0ZXMoZXZ0LmNvb3JkaW5hdGUpO1xuXG4gICAgICBpZiAoIXRoaXMucGFyYW1zXykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcGFyYW1zJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBkZXN0aW5hdGlvblBpeGVsID0gZXZ0LnBpeGVsO1xuICAgICAgdmFyIG9yaWdpblBpeGVsID0gdGhpcy5wYXJhbXNfLm9yaWdpblBpeGVsO1xuICAgICAgdmFyIHNpYmxpbmdYUG9pbnQgPSB0aGlzLnBhcmFtc18uc2libGluZ1hQb2ludDtcbiAgICAgIHZhciBzaWJsaW5nWVBvaW50ID0gdGhpcy5wYXJhbXNfLnNpYmxpbmdZUG9pbnQ7XG4gICAgICB2YXIgdmVjdG9yWCA9IHRoaXMucGFyYW1zXy52ZWN0b3JYO1xuICAgICAgdmFyIHZlY3RvclkgPSB0aGlzLnBhcmFtc18udmVjdG9yWTtcbiAgICAgIHZhciBvcmlnaW5Db29yZGluYXRlID0gdGhpcy5wYXJhbXNfLm9yaWdpbkNvb3JkaW5hdGU7XG4gICAgICB2YXIgYjJQaXhlbCA9IHRoaXMuY2FsY3VsYXRlTmV3UGl4ZWxfKG9yaWdpblBpeGVsLCBkZXN0aW5hdGlvblBpeGVsLCB2ZWN0b3JYKTtcbiAgICAgIHZhciBiMkNvb3JkaW5hdGUgPSB0aGlzLmdldE1hcCgpLmdldENvb3JkaW5hdGVGcm9tUGl4ZWwoYjJQaXhlbCk7XG4gICAgICBzaWJsaW5nWFBvaW50LnNldENvb3JkaW5hdGVzKGIyQ29vcmRpbmF0ZSk7XG4gICAgICB2YXIgYzJQaXhlbCA9IHRoaXMuY2FsY3VsYXRlTmV3UGl4ZWxfKG9yaWdpblBpeGVsLCBkZXN0aW5hdGlvblBpeGVsLCB2ZWN0b3JZKTtcbiAgICAgIHZhciBjMkNvb3JkaW5hdGUgPSB0aGlzLmdldE1hcCgpLmdldENvb3JkaW5hdGVGcm9tUGl4ZWwoYzJQaXhlbCk7XG4gICAgICBzaWJsaW5nWVBvaW50LnNldENvb3JkaW5hdGVzKGMyQ29vcmRpbmF0ZSk7XG4gICAgICB2YXIgYm94RmVhdHVyZSA9IGZlYXR1cmUuZ2V0KCdib3hGZWF0dXJlJyk7XG4gICAgICB2YXIgZ2VvbSA9IGJveEZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KGdlb20gaW5zdGFuY2VvZiBvbEdlb21Qb2x5Z29uKTtcbiAgICAgIGdlb20uc2V0Q29vcmRpbmF0ZXMoW1tldnQuY29vcmRpbmF0ZSwgYjJDb29yZGluYXRlLCBvcmlnaW5Db29yZGluYXRlLCBjMkNvb3JkaW5hdGUsIGV2dC5jb29yZGluYXRlXV0pO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uY2FsY3VsYXRlTmV3UGl4ZWxfID0gZnVuY3Rpb24gY2FsY3VsYXRlTmV3UGl4ZWxfKG9yaWdpbiwgZGVzdGluYXRpb24sIHZlY3Rvcikge1xuICAgIHZhciBhVmVjdG9yID0gW2Rlc3RpbmF0aW9uWzBdIC0gb3JpZ2luWzBdLCBkZXN0aW5hdGlvblsxXSAtIG9yaWdpblsxXV07XG4gICAgdmFyIGFiU2NhbGFyUHJvZHVjdCA9IGFWZWN0b3JbMF0gKiB2ZWN0b3JbMF0gKyBhVmVjdG9yWzFdICogdmVjdG9yWzFdO1xuICAgIHZhciBkZWx0YVZlY3RvciA9IFt2ZWN0b3JbMF0gKiBhYlNjYWxhclByb2R1Y3QsIHZlY3RvclsxXSAqIGFiU2NhbGFyUHJvZHVjdF07XG4gICAgcmV0dXJuIFtkZWx0YVZlY3RvclswXSArIG9yaWdpblswXSwgZGVsdGFWZWN0b3JbMV0gKyBvcmlnaW5bMV1dO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVVcF8gPSBmdW5jdGlvbiBoYW5kbGVVcF8oZXZ0KSB7XG4gICAgaWYgKHRoaXMubW9kaWZpZWRfKSB7XG4gICAgICB2YXIgZXZlbnQgPSBuZXcgbmdlb0N1c3RvbUV2ZW50KCdtb2RpZnllbmQnLCB7XG4gICAgICAgIGZlYXR1cmVzOiB0aGlzLmZlYXR1cmVzX1xuICAgICAgfSk7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgdGhpcy5wYXJhbXNfID0gbnVsbDtcbiAgICAgIHRoaXMubW9kaWZpZWRfID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHJldHVybiBNb2RpZnlSZWN0YW5nbGU7XG59KG9sSW50ZXJhY3Rpb25Qb2ludGVyKTtcblxuZXhwb3J0IGRlZmF1bHQgTW9kaWZ5UmVjdGFuZ2xlOyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgeyBnZXREZWZhdWx0TW9kaWZ5U3R5bGVGdW5jdGlvbiB9IGZyb20gJ25nZW8vaW50ZXJhY3Rpb24vY29tbW9uLmpzJztcbmltcG9ydCBuZ2VvQ3VzdG9tRXZlbnQgZnJvbSAnbmdlby9DdXN0b21FdmVudC5qcyc7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG5pbXBvcnQgKiBhcyBvbEV4dGVudCBmcm9tICdvbC9leHRlbnQuanMnO1xuaW1wb3J0IG9sRmVhdHVyZSBmcm9tICdvbC9GZWF0dXJlLmpzJztcbmltcG9ydCB7IGxpc3RlbiwgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvblBvaW50ZXIgZnJvbSAnb2wvaW50ZXJhY3Rpb24vUG9pbnRlci5qcyc7XG5pbXBvcnQgb2xHZW9tUG9pbnQgZnJvbSAnb2wvZ2VvbS9Qb2ludC5qcyc7XG5pbXBvcnQgb2xHZW9tTGluZVN0cmluZyBmcm9tICdvbC9nZW9tL0xpbmVTdHJpbmcuanMnO1xuaW1wb3J0IG9sR2VvbVBvbHlnb24gZnJvbSAnb2wvZ2VvbS9Qb2x5Z29uLmpzJztcbmltcG9ydCBvbExheWVyVmVjdG9yIGZyb20gJ29sL2xheWVyL1ZlY3Rvci5qcyc7XG5pbXBvcnQgb2xTb3VyY2VWZWN0b3IgZnJvbSAnb2wvc291cmNlL1ZlY3Rvci5qcyc7XG5pbXBvcnQgeyBDb2xsZWN0aW9uRXZlbnQgfSBmcm9tICdvbC9Db2xsZWN0aW9uLmpzJztcblxudmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gKF9vbEludGVyYWN0aW9uUG9pbnRlcikge1xuICBfaW5oZXJpdHNMb29zZShfZGVmYXVsdCwgX29sSW50ZXJhY3Rpb25Qb2ludGVyKTtcblxuICBmdW5jdGlvbiBfZGVmYXVsdChvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX3RoaXMgPSBfb2xJbnRlcmFjdGlvblBvaW50ZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgIGNvbnNvbGUuYXNzZXJ0KG9wdGlvbnMuZmVhdHVyZXMpO1xuICAgIF90aGlzLmhhbmRsZURvd25FdmVudCA9IF90aGlzLmhhbmRsZURvd25fO1xuICAgIF90aGlzLmhhbmRsZURyYWdFdmVudCA9IF90aGlzLmhhbmRsZURyYWdfO1xuICAgIF90aGlzLmhhbmRsZVVwRXZlbnQgPSBfdGhpcy5oYW5kbGVVcF87XG4gICAgX3RoaXMubGlzdGVuZXJLZXlzXyA9IFtdO1xuICAgIF90aGlzLm1vZGlmaWVkXyA9IGZhbHNlO1xuICAgIF90aGlzLmtleVByZXNzTGlzdGVuZXJLZXlfID0gbnVsbDtcbiAgICBfdGhpcy5jaGFuZ2luZ0ZlYXR1cmVfID0gZmFsc2U7XG4gICAgX3RoaXMucGl4ZWxUb2xlcmFuY2VfID0gb3B0aW9ucy5waXhlbFRvbGVyYW5jZSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5waXhlbFRvbGVyYW5jZSA6IDEwO1xuICAgIF90aGlzLmZlYXR1cmVzXyA9IG9wdGlvbnMuZmVhdHVyZXM7XG4gICAgX3RoaXMuZmVhdHVyZV8gPSBudWxsO1xuICAgIF90aGlzLmNvb3JkaW5hdGVfID0gbnVsbDtcbiAgICBfdGhpcy5jZW50ZXJDb29yZGluYXRlXyA9IG51bGw7XG4gICAgX3RoaXMub3ZlcmxheV8gPSBuZXcgb2xMYXllclZlY3Rvcih7XG4gICAgICBzb3VyY2U6IG5ldyBvbFNvdXJjZVZlY3Rvcih7XG4gICAgICAgIHVzZVNwYXRpYWxJbmRleDogZmFsc2UsXG4gICAgICAgIHdyYXBYOiAhIW9wdGlvbnMud3JhcFhcbiAgICAgIH0pLFxuICAgICAgc3R5bGU6IG9wdGlvbnMuc3R5bGUgfHwgZ2V0RGVmYXVsdE1vZGlmeVN0eWxlRnVuY3Rpb24oKSxcbiAgICAgIHVwZGF0ZVdoaWxlQW5pbWF0aW5nOiB0cnVlLFxuICAgICAgdXBkYXRlV2hpbGVJbnRlcmFjdGluZzogdHJ1ZVxuICAgIH0pO1xuICAgIF90aGlzLmNlbnRlckZlYXR1cmVzXyA9IHt9O1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBfZGVmYXVsdC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLnNldEFjdGl2ZSA9IGZ1bmN0aW9uIHNldEFjdGl2ZShhY3RpdmUpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIGlmICghdGhpcy5mZWF0dXJlc18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5rZXlQcmVzc0xpc3RlbmVyS2V5Xykge1xuICAgICAgdW5saXN0ZW5CeUtleSh0aGlzLmtleVByZXNzTGlzdGVuZXJLZXlfKTtcbiAgICAgIHRoaXMua2V5UHJlc3NMaXN0ZW5lcktleV8gPSBudWxsO1xuICAgIH1cblxuICAgIG9sSW50ZXJhY3Rpb25Qb2ludGVyLnByb3RvdHlwZS5zZXRBY3RpdmUuY2FsbCh0aGlzLCBhY3RpdmUpO1xuXG4gICAgaWYgKGFjdGl2ZSkge1xuICAgICAgdGhpcy5rZXlQcmVzc0xpc3RlbmVyS2V5XyA9IGxpc3Rlbihkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5oYW5kbGVLZXlVcF8sIHRoaXMpO1xuICAgICAgdGhpcy5mZWF0dXJlc18uZm9yRWFjaChmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICByZXR1cm4gX3RoaXMyLmFkZEZlYXR1cmVfKGZlYXR1cmUpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmxpc3RlbmVyS2V5c18ucHVzaChsaXN0ZW4odGhpcy5mZWF0dXJlc18sICdhZGQnLCB0aGlzLmhhbmRsZUZlYXR1cmVBZGRfLCB0aGlzKSwgbGlzdGVuKHRoaXMuZmVhdHVyZXNfLCAncmVtb3ZlJywgdGhpcy5oYW5kbGVGZWF0dXJlUmVtb3ZlXywgdGhpcykpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxpc3RlbmVyS2V5c18uZm9yRWFjaCh1bmxpc3RlbkJ5S2V5KTtcbiAgICAgIHRoaXMubGlzdGVuZXJLZXlzXy5sZW5ndGggPSAwO1xuICAgICAgdGhpcy5mZWF0dXJlc18uZm9yRWFjaChmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgICByZXR1cm4gX3RoaXMyLnJlbW92ZUZlYXR1cmVfKGZlYXR1cmUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5hZGRGZWF0dXJlXyA9IGZ1bmN0aW9uIGFkZEZlYXR1cmVfKGZlYXR1cmUpIHtcbiAgICB2YXIgZ2VvbWV0cnkgPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgICB9XG5cbiAgICBmZWF0dXJlLnNldCgnYW5nbGUnLCAwKTtcbiAgICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKGZlYXR1cmUpO1xuICAgIHZhciBwb2ludCA9IG5ldyBvbEdlb21Qb2ludCh0aGlzLmdldENlbnRlckNvb3JkaW5hdGVfKGdlb21ldHJ5KSk7XG4gICAgdmFyIGNlbnRlckZlYXR1cmUgPSBuZXcgb2xGZWF0dXJlKHBvaW50KTtcbiAgICB0aGlzLmNlbnRlckZlYXR1cmVzX1t1aWRdID0gY2VudGVyRmVhdHVyZTtcbiAgICB0aGlzLm92ZXJsYXlfLmdldFNvdXJjZSgpLmFkZEZlYXR1cmUoY2VudGVyRmVhdHVyZSk7XG4gIH07XG5cbiAgX3Byb3RvLndpbGxNb2RpZnlGZWF0dXJlc18gPSBmdW5jdGlvbiB3aWxsTW9kaWZ5RmVhdHVyZXNfKGV2dCkge1xuICAgIGlmICghdGhpcy5tb2RpZmllZF8pIHtcbiAgICAgIHRoaXMubW9kaWZpZWRfID0gdHJ1ZTtcbiAgICAgIHZhciBldmVudCA9IG5ldyBuZ2VvQ3VzdG9tRXZlbnQoJ21vZGlmeXN0YXJ0Jywge1xuICAgICAgICBmZWF0dXJlczogdGhpcy5mZWF0dXJlc19cbiAgICAgIH0pO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZUZlYXR1cmVfID0gZnVuY3Rpb24gcmVtb3ZlRmVhdHVyZV8oZmVhdHVyZSkge1xuICAgIHRoaXMuZmVhdHVyZV8gPSBudWxsO1xuXG4gICAgaWYgKGZlYXR1cmUpIHtcbiAgICAgIHZhciB1aWQgPSBvbFV0aWxHZXRVaWQoZmVhdHVyZSk7XG5cbiAgICAgIGlmICh0aGlzLmNlbnRlckZlYXR1cmVzX1t1aWRdKSB7XG4gICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLm92ZXJsYXlfLmdldFNvdXJjZSgpO1xuXG4gICAgICAgIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIG9sU291cmNlVmVjdG9yKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV3Jvbmcgc291cmNlIHR5cGUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNvdXJjZS5yZW1vdmVGZWF0dXJlKHRoaXMuY2VudGVyRmVhdHVyZXNfW3VpZF0pO1xuICAgICAgICBkZWxldGUgdGhpcy5jZW50ZXJGZWF0dXJlc19bdWlkXTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLnNldE1hcCA9IGZ1bmN0aW9uIHNldE1hcChtYXApIHtcbiAgICB0aGlzLm92ZXJsYXlfLnNldE1hcChtYXApO1xuICAgIG9sSW50ZXJhY3Rpb25Qb2ludGVyLnByb3RvdHlwZS5zZXRNYXAuY2FsbCh0aGlzLCBtYXApO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVGZWF0dXJlQWRkXyA9IGZ1bmN0aW9uIGhhbmRsZUZlYXR1cmVBZGRfKGV2dCkge1xuICAgIGlmIChldnQgaW5zdGFuY2VvZiBDb2xsZWN0aW9uRXZlbnQpIHtcbiAgICAgIHZhciBmZWF0dXJlID0gZXZ0LmVsZW1lbnQ7XG4gICAgICBjb25zb2xlLmFzc2VydChmZWF0dXJlIGluc3RhbmNlb2Ygb2xGZWF0dXJlLCAnZmVhdHVyZSBzaG91bGQgYmUgYW4gb2wuRmVhdHVyZScpO1xuICAgICAgdGhpcy5hZGRGZWF0dXJlXyhmZWF0dXJlKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUZlYXR1cmVSZW1vdmVfID0gZnVuY3Rpb24gaGFuZGxlRmVhdHVyZVJlbW92ZV8oZXZ0KSB7XG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgICAgdmFyIGZlYXR1cmUgPSBldnQuZWxlbWVudDtcbiAgICAgIHRoaXMucmVtb3ZlRmVhdHVyZV8oZmVhdHVyZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVEb3duXyA9IGZ1bmN0aW9uIGhhbmRsZURvd25fKGV2dCkge1xuICAgIHZhciBtYXAgPSBldnQubWFwO1xuICAgIHZhciBmZWF0dXJlID0gbWFwLmZvckVhY2hGZWF0dXJlQXRQaXhlbChldnQucGl4ZWwsIGZ1bmN0aW9uIChmZWF0dXJlLCBsYXllcikge1xuICAgICAgcmV0dXJuIGZlYXR1cmU7XG4gICAgfSwgdW5kZWZpbmVkKTtcblxuICAgIGlmIChmZWF0dXJlKSB7XG4gICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgIHRoaXMuZmVhdHVyZXNfLmZvckVhY2goZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgaWYgKG9sVXRpbEdldFVpZChmKSA9PSBvbFV0aWxHZXRVaWQoZmVhdHVyZSkpIHtcbiAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWZvdW5kKSB7XG4gICAgICAgIGZlYXR1cmUgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZlYXR1cmUpIHtcbiAgICAgIHRoaXMuY29vcmRpbmF0ZV8gPSBldnQuY29vcmRpbmF0ZTtcbiAgICAgIHRoaXMuZmVhdHVyZV8gPSBmZWF0dXJlO1xuICAgICAgdmFyIGdlb21ldHJ5ID0gdGhpcy5mZWF0dXJlXy5nZXRHZW9tZXRyeSgpO1xuXG4gICAgICBpZiAoZ2VvbWV0cnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNlbnRlckNvb3JkaW5hdGVfID0gdGhpcy5nZXRDZW50ZXJDb29yZGluYXRlXyhnZW9tZXRyeSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0Q2VudGVyQ29vcmRpbmF0ZV8gPSBmdW5jdGlvbiBnZXRDZW50ZXJDb29yZGluYXRlXyhnZW9tZXRyeSkge1xuICAgIHZhciBjZW50ZXI7XG5cbiAgICBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21MaW5lU3RyaW5nKSB7XG4gICAgICBjZW50ZXIgPSBnZW9tZXRyeS5nZXRGbGF0TWlkcG9pbnQoKTtcbiAgICB9IGVsc2UgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tUG9seWdvbikge1xuICAgICAgY2VudGVyID0gZ2VvbWV0cnkuZ2V0RmxhdEludGVyaW9yUG9pbnQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGV4dGVudCA9IGdlb21ldHJ5LmdldEV4dGVudCgpO1xuICAgICAgY2VudGVyID0gb2xFeHRlbnQuZ2V0Q2VudGVyKGV4dGVudCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNlbnRlcjtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRHJhZ18gPSBmdW5jdGlvbiBoYW5kbGVEcmFnXyhldnQpIHtcbiAgICB0aGlzLndpbGxNb2RpZnlGZWF0dXJlc18oZXZ0KTtcblxuICAgIGlmICghdGhpcy5mZWF0dXJlXykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZlYXR1cmUnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuY29vcmRpbmF0ZV8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjb29yZGluYXRlJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmNlbnRlckNvb3JkaW5hdGVfKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY2VudGVyQ29vcmRpbmF0ZScpO1xuICAgIH1cblxuICAgIHZhciBnZW9tZXRyeSA9IHRoaXMuZmVhdHVyZV8uZ2V0R2VvbWV0cnkoKTtcblxuICAgIGlmICghZ2VvbWV0cnkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZW9tZXRyeScpO1xuICAgIH1cblxuICAgIHZhciBvbGRYID0gdGhpcy5jb29yZGluYXRlX1swXTtcbiAgICB2YXIgb2xkWSA9IHRoaXMuY29vcmRpbmF0ZV9bMV07XG4gICAgdmFyIGNlbnRlclggPSB0aGlzLmNlbnRlckNvb3JkaW5hdGVfWzBdO1xuICAgIHZhciBjZW50ZXJZID0gdGhpcy5jZW50ZXJDb29yZGluYXRlX1sxXTtcbiAgICB2YXIgZHgxID0gb2xkWCAtIGNlbnRlclg7XG4gICAgdmFyIGR5MSA9IG9sZFkgLSBjZW50ZXJZO1xuICAgIHZhciBkeDAgPSBldnQuY29vcmRpbmF0ZVswXSAtIGNlbnRlclg7XG4gICAgdmFyIGR5MCA9IGV2dC5jb29yZGluYXRlWzFdIC0gY2VudGVyWTtcbiAgICB0aGlzLmNvb3JkaW5hdGVfWzBdID0gZXZ0LmNvb3JkaW5hdGVbMF07XG4gICAgdGhpcy5jb29yZGluYXRlX1sxXSA9IGV2dC5jb29yZGluYXRlWzFdO1xuICAgIHZhciBhMCA9IE1hdGguYXRhbjIoZHkwLCBkeDApO1xuICAgIHZhciBhMSA9IE1hdGguYXRhbjIoZHkxLCBkeDEpO1xuICAgIHZhciBhbmdsZSA9IGExIC0gYTA7XG4gICAgZ2VvbWV0cnkucm90YXRlKC1hbmdsZSwgW2NlbnRlclgsIGNlbnRlclldKTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlVXBfID0gZnVuY3Rpb24gaGFuZGxlVXBfKGV2dCkge1xuICAgIGlmICh0aGlzLm1vZGlmaWVkXykge1xuICAgICAgaWYgKCF0aGlzLmZlYXR1cmVfKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBldmVudCA9IG5ldyBuZ2VvQ3VzdG9tRXZlbnQoJ3JvdGF0ZWVuZCcsIHtcbiAgICAgICAgZmVhdHVyZTogdGhpcy5mZWF0dXJlX1xuICAgICAgfSk7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgdGhpcy5tb2RpZmllZF8gPSBmYWxzZTtcbiAgICAgIHRoaXMuc2V0QWN0aXZlKGZhbHNlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUtleVVwXyA9IGZ1bmN0aW9uIGhhbmRsZUtleVVwXyhldnQpIHtcbiAgICBpZiAoZXZ0IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCAmJiBldnQua2V5Q29kZSA9PT0gMjcpIHtcbiAgICAgIHRoaXMuc2V0QWN0aXZlKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIF9kZWZhdWx0O1xufShvbEludGVyYWN0aW9uUG9pbnRlcik7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJmdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0ICogYXMgb2xFeHRlbnQgZnJvbSAnb2wvZXh0ZW50LmpzJztcbmltcG9ydCBvbEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4sIHVubGlzdGVuQnlLZXkgfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG9sR2VvbUdlb21ldHJ5IGZyb20gJ29sL2dlb20vR2VvbWV0cnkuanMnO1xuaW1wb3J0IG9sR2VvbUxpbmVTdHJpbmcgZnJvbSAnb2wvZ2VvbS9MaW5lU3RyaW5nLmpzJztcbmltcG9ydCBvbEdlb21Qb2ludCBmcm9tICdvbC9nZW9tL1BvaW50LmpzJztcbmltcG9ydCBvbEdlb21Qb2x5Z29uIGZyb20gJ29sL2dlb20vUG9seWdvbi5qcyc7XG5pbXBvcnQgb2xJbnRlcmFjdGlvblRyYW5zbGF0ZSBmcm9tICdvbC9pbnRlcmFjdGlvbi9UcmFuc2xhdGUuanMnO1xuaW1wb3J0IG9sTGF5ZXJWZWN0b3IgZnJvbSAnb2wvbGF5ZXIvVmVjdG9yLmpzJztcbmltcG9ydCBvbFNvdXJjZVZlY3RvciBmcm9tICdvbC9zb3VyY2UvVmVjdG9yLmpzJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoX29sSW50ZXJhY3Rpb25UcmFuc2xhKSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfb2xJbnRlcmFjdGlvblRyYW5zbGEpO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfdGhpcyA9IF9vbEludGVyYWN0aW9uVHJhbnNsYS5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgX3RoaXMubGlzdGVuZXJLZXlzXyA9IFtdO1xuICAgIF90aGlzLmZlYXR1cmVMaXN0ZW5lcktleXNfID0ge307XG4gICAgX3RoaXMua2V5UHJlc3NMaXN0ZW5lcktleV8gPSBudWxsO1xuICAgIF90aGlzLm15RmVhdHVyZXNfID0gb3B0aW9ucy5mZWF0dXJlcyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5mZWF0dXJlcyA6IG51bGw7XG4gICAgX3RoaXMudmVjdG9yU291cmNlXyA9IG5ldyBvbFNvdXJjZVZlY3Rvcih7XG4gICAgICB1c2VTcGF0aWFsSW5kZXg6IGZhbHNlXG4gICAgfSk7XG4gICAgX3RoaXMudmVjdG9yTGF5ZXJfID0gbmV3IG9sTGF5ZXJWZWN0b3Ioe1xuICAgICAgc291cmNlOiBfdGhpcy52ZWN0b3JTb3VyY2VfLFxuICAgICAgc3R5bGU6IG9wdGlvbnMuc3R5bGUsXG4gICAgICB1cGRhdGVXaGlsZUFuaW1hdGluZzogdHJ1ZSxcbiAgICAgIHVwZGF0ZVdoaWxlSW50ZXJhY3Rpbmc6IHRydWVcbiAgICB9KTtcbiAgICBfdGhpcy5jZW50ZXJGZWF0dXJlc18gPSB7fTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gX2RlZmF1bHQucHJvdG90eXBlO1xuXG4gIF9wcm90by5zZXRBY3RpdmUgPSBmdW5jdGlvbiBzZXRBY3RpdmUoYWN0aXZlKSB7XG4gICAgaWYgKHRoaXMua2V5UHJlc3NMaXN0ZW5lcktleV8pIHtcbiAgICAgIHVubGlzdGVuQnlLZXkodGhpcy5rZXlQcmVzc0xpc3RlbmVyS2V5Xyk7XG4gICAgICB0aGlzLmtleVByZXNzTGlzdGVuZXJLZXlfID0gbnVsbDtcbiAgICB9XG5cbiAgICBvbEludGVyYWN0aW9uVHJhbnNsYXRlLnByb3RvdHlwZS5zZXRBY3RpdmUuY2FsbCh0aGlzLCBhY3RpdmUpO1xuXG4gICAgaWYgKGFjdGl2ZSkge1xuICAgICAgdGhpcy5rZXlQcmVzc0xpc3RlbmVyS2V5XyA9IGxpc3Rlbihkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5oYW5kbGVLZXlVcF8sIHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGVfKCk7XG4gIH07XG5cbiAgX3Byb3RvLnNldE1hcCA9IGZ1bmN0aW9uIHNldE1hcChtYXApIHtcbiAgICB2YXIgY3VycmVudE1hcCA9IHRoaXMuZ2V0TWFwKCk7XG5cbiAgICBpZiAoY3VycmVudE1hcCkge1xuICAgICAgdGhpcy52ZWN0b3JMYXllcl8uc2V0TWFwKG51bGwpO1xuICAgIH1cblxuICAgIG9sSW50ZXJhY3Rpb25UcmFuc2xhdGUucHJvdG90eXBlLnNldE1hcC5jYWxsKHRoaXMsIG1hcCk7XG5cbiAgICBpZiAobWFwKSB7XG4gICAgICB0aGlzLnZlY3RvckxheWVyXy5zZXRNYXAobWFwKTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlXygpO1xuICB9O1xuXG4gIF9wcm90by5zZXRTdGF0ZV8gPSBmdW5jdGlvbiBzZXRTdGF0ZV8oKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgbWFwID0gdGhpcy5nZXRNYXAoKTtcblxuICAgIGlmICghbWFwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGFjdGl2ZSA9IHRoaXMuZ2V0QWN0aXZlKCk7XG4gICAgdmFyIGZlYXR1cmVzID0gdGhpcy5teUZlYXR1cmVzXztcblxuICAgIGlmICghZmVhdHVyZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlcycpO1xuICAgIH1cblxuICAgIHZhciBrZXlzID0gdGhpcy5saXN0ZW5lcktleXNfO1xuXG4gICAgaWYgKG1hcCAmJiBhY3RpdmUgJiYgZmVhdHVyZXMpIHtcbiAgICAgIGZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzMi5hZGRGZWF0dXJlXyhmZWF0dXJlKTtcbiAgICAgIH0pO1xuICAgICAga2V5cy5wdXNoKGxpc3RlbihmZWF0dXJlcywgJ2FkZCcsIHRoaXMuaGFuZGxlRmVhdHVyZXNBZGRfLCB0aGlzKSwgbGlzdGVuKGZlYXR1cmVzLCAncmVtb3ZlJywgdGhpcy5oYW5kbGVGZWF0dXJlc1JlbW92ZV8sIHRoaXMpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG1hcCkge1xuICAgICAgICB2YXIgZWxlbSA9IG1hcC5nZXRUYXJnZXRFbGVtZW50KCk7XG4gICAgICAgIGVsZW0uc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnO1xuICAgICAgfVxuXG4gICAgICBrZXlzLmZvckVhY2godW5saXN0ZW5CeUtleSk7XG4gICAgICBrZXlzLmxlbmd0aCA9IDA7XG4gICAgICBmZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgICAgIHJldHVybiBfdGhpczIucmVtb3ZlRmVhdHVyZV8oZmVhdHVyZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUZlYXR1cmVzQWRkXyA9IGZ1bmN0aW9uIGhhbmRsZUZlYXR1cmVzQWRkXyhldnQpIHtcbiAgICBpZiAoZXZ0IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgICB2YXIgZmVhdHVyZSA9IGV2dC5lbGVtZW50O1xuICAgICAgY29uc29sZS5hc3NlcnQoZmVhdHVyZSBpbnN0YW5jZW9mIG9sRmVhdHVyZSwgJ2ZlYXR1cmUgc2hvdWxkIGJlIGFuIG9sLkZlYXR1cmUnKTtcbiAgICAgIHRoaXMuYWRkRmVhdHVyZV8oZmVhdHVyZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVGZWF0dXJlc1JlbW92ZV8gPSBmdW5jdGlvbiBoYW5kbGVGZWF0dXJlc1JlbW92ZV8oZXZ0KSB7XG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgICAgdmFyIGZlYXR1cmUgPSBldnQuZWxlbWVudDtcbiAgICAgIHRoaXMucmVtb3ZlRmVhdHVyZV8oZmVhdHVyZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5hZGRGZWF0dXJlXyA9IGZ1bmN0aW9uIGFkZEZlYXR1cmVfKGZlYXR1cmUpIHtcbiAgICB2YXIgdWlkID0gb2xVdGlsR2V0VWlkKGZlYXR1cmUpO1xuICAgIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgIGlmICghZ2VvbWV0cnkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZW9tZXRyeScpO1xuICAgIH1cblxuICAgIHRoaXMuZmVhdHVyZUxpc3RlbmVyS2V5c19bdWlkXSA9IGxpc3RlbihnZW9tZXRyeSwgJ2NoYW5nZScsIHRoaXMuaGFuZGxlR2VvbWV0cnlDaGFuZ2VfLmJpbmQodGhpcywgZmVhdHVyZSksIHRoaXMpO1xuICAgIHZhciBwb2ludCA9IHRoaXMuZ2V0R2VvbWV0cnlDZW50ZXJQb2ludF8oZ2VvbWV0cnkpO1xuICAgIHZhciBjZW50ZXJGZWF0dXJlID0gbmV3IG9sRmVhdHVyZShwb2ludCk7XG4gICAgdGhpcy5jZW50ZXJGZWF0dXJlc19bdWlkXSA9IGNlbnRlckZlYXR1cmU7XG4gICAgdGhpcy52ZWN0b3JTb3VyY2VfLmFkZEZlYXR1cmUoY2VudGVyRmVhdHVyZSk7XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZUZlYXR1cmVfID0gZnVuY3Rpb24gcmVtb3ZlRmVhdHVyZV8oZmVhdHVyZSkge1xuICAgIHZhciB1aWQgPSBvbFV0aWxHZXRVaWQoZmVhdHVyZSk7XG5cbiAgICBpZiAodGhpcy5mZWF0dXJlTGlzdGVuZXJLZXlzX1t1aWRdKSB7XG4gICAgICB1bmxpc3RlbkJ5S2V5KHRoaXMuZmVhdHVyZUxpc3RlbmVyS2V5c19bdWlkXSk7XG4gICAgICBkZWxldGUgdGhpcy5mZWF0dXJlTGlzdGVuZXJLZXlzX1t1aWRdO1xuICAgICAgdGhpcy52ZWN0b3JTb3VyY2VfLnJlbW92ZUZlYXR1cmUodGhpcy5jZW50ZXJGZWF0dXJlc19bdWlkXSk7XG4gICAgICBkZWxldGUgdGhpcy5jZW50ZXJGZWF0dXJlc19bdWlkXTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUdlb21ldHJ5Q2hhbmdlXyA9IGZ1bmN0aW9uIGhhbmRsZUdlb21ldHJ5Q2hhbmdlXyhmZWF0dXJlLCBldnQpIHtcbiAgICB2YXIgZ2VvbWV0cnkgPSBldnQudGFyZ2V0O1xuICAgIGNvbnNvbGUuYXNzZXJ0KGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tR2VvbWV0cnkpO1xuICAgIHZhciBwb2ludCA9IHRoaXMuZ2V0R2VvbWV0cnlDZW50ZXJQb2ludF8oZ2VvbWV0cnkpO1xuICAgIHZhciB1aWQgPSBvbFV0aWxHZXRVaWQoZmVhdHVyZSk7XG4gICAgdGhpcy5jZW50ZXJGZWF0dXJlc19bdWlkXS5zZXRHZW9tZXRyeShwb2ludCk7XG4gIH07XG5cbiAgX3Byb3RvLmdldEdlb21ldHJ5Q2VudGVyUG9pbnRfID0gZnVuY3Rpb24gZ2V0R2VvbWV0cnlDZW50ZXJQb2ludF8oZ2VvbWV0cnkpIHtcbiAgICB2YXIgY2VudGVyO1xuICAgIHZhciBwb2ludDtcblxuICAgIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbVBvbHlnb24pIHtcbiAgICAgIHBvaW50ID0gZ2VvbWV0cnkuZ2V0SW50ZXJpb3JQb2ludCgpO1xuICAgIH0gZWxzZSBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21MaW5lU3RyaW5nKSB7XG4gICAgICBjZW50ZXIgPSBnZW9tZXRyeS5nZXRDb29yZGluYXRlQXQoMC41KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGV4dGVudCA9IGdlb21ldHJ5LmdldEV4dGVudCgpO1xuICAgICAgY2VudGVyID0gb2xFeHRlbnQuZ2V0Q2VudGVyKGV4dGVudCk7XG4gICAgfVxuXG4gICAgaWYgKCFwb2ludCAmJiBjZW50ZXIpIHtcbiAgICAgIHBvaW50ID0gbmV3IG9sR2VvbVBvaW50KGNlbnRlcik7XG4gICAgfVxuXG4gICAgaWYgKCFwb2ludCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHBvaW50Jyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBvaW50O1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVLZXlVcF8gPSBmdW5jdGlvbiBoYW5kbGVLZXlVcF8oZXZ0KSB7XG4gICAgaWYgKGV2dCBpbnN0YW5jZW9mIEtleWJvYXJkRXZlbnQgJiYgZXZ0LmtleUNvZGUgPT09IDI3KSB7XG4gICAgICB0aGlzLnNldEFjdGl2ZShmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0ob2xJbnRlcmFjdGlvblRyYW5zbGF0ZSk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJpbXBvcnQgeyBjcmVhdGVFZGl0aW5nU3R5bGUgfSBmcm9tICdvbC9zdHlsZS9TdHlsZS5qcyc7XG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdERyYXdTdHlsZUZ1bmN0aW9uKCkge1xuICB2YXIgc3R5bGUgPSBjcmVhdGVFZGl0aW5nU3R5bGUoKTtcbiAgcmV0dXJuIGZ1bmN0aW9uIChmZWF0dXJlLCByZXNvbHV0aW9uKSB7XG4gICAgdmFyIGdlb21ldHJ5ID0gZmVhdHVyZS5nZXRHZW9tZXRyeSgpO1xuXG4gICAgaWYgKGdlb21ldHJ5KSB7XG4gICAgICByZXR1cm4gc3R5bGVbZ2VvbWV0cnkuZ2V0VHlwZSgpXTtcbiAgICB9XG4gIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdE1vZGlmeVN0eWxlRnVuY3Rpb24oKSB7XG4gIHZhciBzdHlsZSA9IGNyZWF0ZUVkaXRpbmdTdHlsZSgpO1xuICByZXR1cm4gZnVuY3Rpb24gKGZlYXR1cmUsIHJlc29sdXRpb24pIHtcbiAgICByZXR1cm4gc3R5bGUuUG9pbnQ7XG4gIH07XG59IiwiTGF5ZXJ0cmVlQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRhdHRyc1wiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgbGF5ZXJMb2FkaW5nLCBsYXllckRlY29yYXRpb24gfSBmcm9tICduZ2VvL21pc2MvZGVjb3JhdGUuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xuaW1wb3J0IHsgbGlzdGVuIH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbExheWVyR3JvdXAgZnJvbSAnb2wvbGF5ZXIvR3JvdXAuanMnO1xuaW1wb3J0IG9sTGF5ZXJMYXllciBmcm9tICdvbC9sYXllci9MYXllci5qcyc7XG5leHBvcnQgZnVuY3Rpb24gTGF5ZXJ0cmVlQ29udHJvbGxlcigkc2NvcGUsICRyb290U2NvcGUsICRhdHRycykge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHZhciBpc1Jvb3QgPSAkYXR0cnMubmdlb0xheWVydHJlZU5vdHJvb3QgPT09IHVuZGVmaW5lZDtcbiAgdGhpcy5pc1Jvb3QgPSBpc1Jvb3Q7XG4gIHZhciBub2RlRXhwciA9ICRhdHRycy5uZ2VvTGF5ZXJ0cmVlO1xuICB0aGlzLnJvb3RTY29wZV8gPSAkcm9vdFNjb3BlO1xuICB0aGlzLnByb3BlcnRpZXMgPSB7fTtcbiAgdGhpcy5zdGF0ZV8gPSAnb2ZmJztcbiAgdmFyIG5vZGU7XG5cbiAgaWYgKGlzUm9vdCkge1xuICAgICRzY29wZS4kd2F0Y2gobm9kZUV4cHIsIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xuICAgICAgX3RoaXMubm9kZSA9IG5ld1ZhbDtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBub2RlID0gJHNjb3BlLiRldmFsKG5vZGVFeHByKTtcbiAgfVxuXG4gIHRoaXMubm9kZSA9IG5vZGU7XG4gIHZhciBtYXBFeHByID0gJGF0dHJzLm5nZW9MYXllcnRyZWVNYXA7XG4gIHZhciBtYXAgPSAkc2NvcGUuJGV2YWwobWFwRXhwcik7XG4gIGNvbnNvbGUuYXNzZXJ0KG1hcCAhPT0gdW5kZWZpbmVkKTtcbiAgdGhpcy5wYXJlbnQgPSAkc2NvcGUuJHBhcmVudC5sYXllcnRyZWVDdHJsO1xuICB0aGlzLmNoaWxkcmVuID0gW107XG5cbiAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4ucHVzaCh0aGlzKTtcbiAgfVxuXG4gICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgIGlmIChfdGhpcy5wYXJlbnQpIHtcbiAgICAgIHZhciBpbmRleCA9IF90aGlzLnBhcmVudC5jaGlsZHJlbi5pbmRleE9mKF90aGlzKTtcblxuICAgICAgY29uc29sZS5hc3NlcnQoaW5kZXggPj0gMCk7XG5cbiAgICAgIF90aGlzLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbiAgfSk7XG4gIHRoaXMudWlkID0gb2xVdGlsR2V0VWlkKHRoaXMpO1xuICB0aGlzLmRlcHRoID0gaXNSb290ID8gMCA6IHRoaXMucGFyZW50LmRlcHRoICsgMTtcbiAgJHNjb3BlLnVpZCA9IHRoaXMudWlkO1xuICAkc2NvcGUuZGVwdGggPSB0aGlzLmRlcHRoO1xuICB0aGlzLm1hcCA9IG1hcDtcbiAgdmFyIG5vZGVsYXllckV4cHIgPSAkYXR0cnMubmdlb0xheWVydHJlZU5vZGVsYXllcjtcblxuICBpZiAobm9kZWxheWVyRXhwciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIG5vZGVsYXllcmV4cHJFeHByID0gJGF0dHJzLm5nZW9MYXllcnRyZWVOb2RlbGF5ZXJleHByO1xuICAgIHZhciBuZXdOb2RlbGF5ZXJFeHByID0gJHNjb3BlLiRldmFsKG5vZGVsYXllcmV4cHJFeHByKTtcbiAgICBjb25zb2xlLmFzc2VydCh0eXBlb2YgbmV3Tm9kZWxheWVyRXhwciA9PSAnc3RyaW5nJyk7XG4gICAgbm9kZWxheWVyRXhwciA9IG5ld05vZGVsYXllckV4cHI7XG4gIH1cblxuICBjb25zb2xlLmFzc2VydChub2RlbGF5ZXJFeHByICE9PSB1bmRlZmluZWQpO1xuICB0aGlzLm5vZGVsYXllckV4cHIgPSBub2RlbGF5ZXJFeHByO1xuICB0aGlzLmxheWVyID0gbnVsbDtcblxuICBpZiAoIWlzUm9vdCkge1xuICAgIHZhciBsYXllciA9ICRzY29wZS4kZXZhbChub2RlbGF5ZXJFeHByLCB7XG4gICAgICAndHJlZUN0cmwnOiB0aGlzXG4gICAgfSkgfHwgbnVsbDtcblxuICAgIGlmIChsYXllcikge1xuICAgICAgY29uc29sZS5hc3NlcnQobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyTGF5ZXIgfHwgbGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyR3JvdXApO1xuICAgICAgdGhpcy5sYXllciA9IGxheWVyO1xuICAgIH1cbiAgfVxuXG4gIHRoaXMuZGF0YVNvdXJjZV8gPSBudWxsO1xuXG4gIGlmICh0aGlzLmxheWVyKSB7XG4gICAgbGF5ZXJMb2FkaW5nKHRoaXMubGF5ZXIsICRzY29wZSk7XG4gICAgbGF5ZXJEZWNvcmF0aW9uKHRoaXMubGF5ZXIpO1xuICAgIGxpc3Rlbih0aGlzLmxheWVyLCAnY2hhbmdlOm9wYWNpdHknLCBmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5yb290U2NvcGVfLiRicm9hZGNhc3QoJ25nZW8tbGF5ZXJ0cmVlLW9wYWNpdHknLCBfdGhpcyk7XG4gICAgfSk7XG4gIH1cblxuICB2YXIgbGlzdGVuZXJzRXhwciA9ICRhdHRycy5uZ2VvTGF5ZXJ0cmVlTGlzdGVuZXJzO1xuXG4gIGlmIChsaXN0ZW5lcnNFeHByID09PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgbGlzdGVuZXJzZXhwckV4cHIgPSAkYXR0cnMubmdlb0xheWVydHJlZUxpc3RlbmVyc2V4cHI7XG4gICAgbGlzdGVuZXJzRXhwciA9ICRzY29wZS4kZXZhbChsaXN0ZW5lcnNleHByRXhwcik7XG4gIH1cblxuICBpZiAobGlzdGVuZXJzRXhwciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc29sZS5hc3NlcnQodHlwZW9mIGxpc3RlbmVyc0V4cHIgPT0gJ3N0cmluZycpO1xuICB9XG5cbiAgdGhpcy5saXN0ZW5lcnNFeHByID0gbGlzdGVuZXJzRXhwcjtcblxuICBpZiAobGlzdGVuZXJzRXhwcikge1xuICAgICRzY29wZS4kZXZhbChsaXN0ZW5lcnNFeHByLCB7XG4gICAgICAndHJlZVNjb3BlJzogJHNjb3BlLFxuICAgICAgJ3RyZWVDdHJsJzogdGhpc1xuICAgIH0pO1xuICB9XG5cbiAgJHNjb3BlLmxheWVydHJlZUN0cmwgPSB0aGlzO1xufVxuXG5MYXllcnRyZWVDb250cm9sbGVyLnByb3RvdHlwZS5nZXRTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMuc3RhdGVfO1xufTtcblxuTGF5ZXJ0cmVlQ29udHJvbGxlci5wcm90b3R5cGUuc2V0U3RhdGUgPSBmdW5jdGlvbiAoc3RhdGUsIG9wdF9icm9hZGNhc3QpIHtcbiAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgaWYgKHN0YXRlID09PSB0aGlzLnN0YXRlXykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuc2V0U3RhdGVJbnRlcm5hbF8oc3RhdGUpO1xuXG4gIGlmICh0aGlzLnBhcmVudCkge1xuICAgIHRoaXMucGFyZW50LnJlZnJlc2hTdGF0ZSh0aGlzLCBvcHRfYnJvYWRjYXN0KTtcbiAgfVxuXG4gIHZhciBmaXJzdFBhcmVudHMgPSB0aGlzLmlzUm9vdCA/IHRoaXMuY2hpbGRyZW4gOiBbZ2V0Rmlyc3RQYXJlbnRUcmVlKHRoaXMpXTtcblxuICBpZiAob3B0X2Jyb2FkY2FzdCA9PT0gdW5kZWZpbmVkIHx8IG9wdF9icm9hZGNhc3QpIHtcbiAgICBmaXJzdFBhcmVudHMuZm9yRWFjaChmdW5jdGlvbiAoZmlyc3RQYXJlbnQpIHtcbiAgICAgIF90aGlzMi5yb290U2NvcGVfLiRicm9hZGNhc3QoJ25nZW8tbGF5ZXJ0cmVlLXN0YXRlJywgX3RoaXMyLCBmaXJzdFBhcmVudCk7XG4gICAgfSk7XG4gIH1cbn07XG5cbkxheWVydHJlZUNvbnRyb2xsZXIucHJvdG90eXBlLnNldFN0YXRlSW50ZXJuYWxfID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gIHRoaXMuc3RhdGVfID0gc3RhdGUgPT09ICdvbicgPyAnb24nIDogJ29mZic7XG5cbiAgaWYgKHRoaXMuc3RhdGVfID09PSAnb24nICYmIHRoaXMubm9kZS5tZXRhZGF0YSAmJiB0aGlzLm5vZGUubWV0YWRhdGEuZXhjbHVzaXZlR3JvdXApIHtcbiAgICB2YXIgZmlyc3RDaGlsZDtcblxuICAgIGZvciAodmFyIF9pdGVyYXRvciA9IHRoaXMuY2hpbGRyZW4sIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IpLCBfaSA9IDAsIF9pdGVyYXRvciA9IF9pc0FycmF5ID8gX2l0ZXJhdG9yIDogX2l0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjtcblxuICAgICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICAgIGlmIChfaSA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pID0gX2l0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBjaGlsZCA9IF9yZWY7XG5cbiAgICAgIGlmICghZmlyc3RDaGlsZCkge1xuICAgICAgICBmaXJzdENoaWxkID0gY2hpbGQ7XG4gICAgICAgIGNoaWxkLnNldFN0YXRlSW50ZXJuYWxfKCdvbicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hpbGQuc2V0U3RhdGVJbnRlcm5hbF8oJ29mZicpO1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICBjaGlsZC5zZXRTdGF0ZUludGVybmFsXyhfdGhpczMuc3RhdGVfKTtcbiAgICB9KTtcbiAgfVxufTtcblxuTGF5ZXJ0cmVlQ29udHJvbGxlci5wcm90b3R5cGUucmVmcmVzaFN0YXRlID0gZnVuY3Rpb24gKG9wdF9vbkNoaWxkLCBvcHRfYnJvYWRjYXN0KSB7XG4gIHZhciBncm91cCA9IHRoaXMubm9kZTtcblxuICBpZiAoZ3JvdXAuY2hpbGRyZW4gJiYgb3B0X29uQ2hpbGQgJiYgb3B0X29uQ2hpbGQuZ2V0U3RhdGUoKSAhPT0gJ29mZicgJiYgdGhpcy5ub2RlLm1ldGFkYXRhICYmIHRoaXMubm9kZS5tZXRhZGF0YS5leGNsdXNpdmVHcm91cCkge1xuICAgIHZhciBvbkNoaWxkID0gb3B0X29uQ2hpbGQ7XG4gICAgdGhpcy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgaWYgKGNoaWxkICE9PSBvbkNoaWxkKSB7XG4gICAgICAgIGNoaWxkLnNldFN0YXRlKCdvZmYnLCBvcHRfYnJvYWRjYXN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHZhciBuZXdTdGF0ZSA9IHRoaXMuZ2V0Q2FsY3VsYXRlU3RhdGUoKTtcblxuICBpZiAodGhpcy5zdGF0ZV8gPT09IG5ld1N0YXRlKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5zdGF0ZV8gPSBuZXdTdGF0ZTtcblxuICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICB0aGlzLnBhcmVudC5yZWZyZXNoU3RhdGUodGhpcywgb3B0X2Jyb2FkY2FzdCk7XG4gIH1cbn07XG5cbkxheWVydHJlZUNvbnRyb2xsZXIucHJvdG90eXBlLmdldENhbGN1bGF0ZVN0YXRlID0gZnVuY3Rpb24gKCkge1xuICB2YXIgZ3JvdXAgPSB0aGlzLm5vZGU7XG5cbiAgaWYgKGdyb3VwLmNoaWxkcmVuID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZV87XG4gIH1cblxuICB2YXIgY2hpbGRTdGF0ZSA9ICcnO1xuICB2YXIgcHJldmlvdXNDaGlsZFN0YXRlO1xuICB0aGlzLmNoaWxkcmVuLnNvbWUoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgY2hpbGRTdGF0ZSA9IGNoaWxkLmdldENhbGN1bGF0ZVN0YXRlKCk7XG5cbiAgICBpZiAocHJldmlvdXNDaGlsZFN0YXRlKSB7XG4gICAgICBpZiAocHJldmlvdXNDaGlsZFN0YXRlICE9PSBjaGlsZFN0YXRlKSB7XG4gICAgICAgIGNoaWxkU3RhdGUgPSAnaW5kZXRlcm1pbmF0ZSc7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHByZXZpb3VzQ2hpbGRTdGF0ZSA9IGNoaWxkU3RhdGU7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcbiAgcmV0dXJuIGNoaWxkU3RhdGU7XG59O1xuXG5MYXllcnRyZWVDb250cm9sbGVyLnByb3RvdHlwZS5nZXRTZXRBY3RpdmUgPSBmdW5jdGlvbiAodmFsKSB7XG4gIHZhciBsYXllciA9IHRoaXMubGF5ZXI7XG4gIHZhciBtYXAgPSB0aGlzLm1hcDtcblxuICBpZiAoIWxheWVyKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKCF2YWwpIHtcbiAgICAgIG1hcC5yZW1vdmVMYXllcihsYXllcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1hcC5hZGRMYXllcihsYXllcik7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtYXAuZ2V0TGF5ZXJzKCkuZ2V0QXJyYXkoKS5pbmNsdWRlcyhsYXllcik7XG4gIH1cbn07XG5cbkxheWVydHJlZUNvbnRyb2xsZXIucHJvdG90eXBlLmdldERhdGFTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmRhdGFTb3VyY2VfO1xufTtcblxuTGF5ZXJ0cmVlQ29udHJvbGxlci5wcm90b3R5cGUuc2V0RGF0YVNvdXJjZSA9IGZ1bmN0aW9uIChkYXRhU291cmNlKSB7XG4gIHRoaXMuZGF0YVNvdXJjZV8gPSBkYXRhU291cmNlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpcnN0UGFyZW50VHJlZSh0cmVlQ3RybCkge1xuICB2YXIgdHJlZSA9IHRyZWVDdHJsO1xuXG4gIHdoaWxlICghdHJlZS5wYXJlbnQuaXNSb290KSB7XG4gICAgdHJlZSA9IHRyZWUucGFyZW50O1xuICB9XG5cbiAgcmV0dXJuIHRyZWU7XG59XG5leHBvcnQgdmFyIExheWVydHJlZVZpc2l0b3JEZWNpc2lvbiA9IHtcbiAgU1RPUDogJ1NUT1AnLFxuICBTS0lQOiAnU0tJUCcsXG4gIERFU0NFTkQ6ICdERVNDRU5EJ1xufTtcblxuTGF5ZXJ0cmVlQ29udHJvbGxlci5wcm90b3R5cGUudHJhdmVyc2VEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKHZpc2l0b3IpIHtcbiAgdmFyIGRlY2lzaW9uID0gdmlzaXRvcih0aGlzKSB8fCBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24uREVTQ0VORDtcblxuICBzd2l0Y2ggKGRlY2lzaW9uKSB7XG4gICAgY2FzZSBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24uU1RPUDpcbiAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgY2FzZSBMYXllcnRyZWVWaXNpdG9yRGVjaXNpb24uU0tJUDpcbiAgICAgIHJldHVybiBmYWxzZTtcblxuICAgIGNhc2UgTGF5ZXJ0cmVlVmlzaXRvckRlY2lzaW9uLkRFU0NFTkQ6XG4gICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gdGhpcy5jaGlsZHJlbiwgX2lzQXJyYXkyID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IyKSwgX2kyID0gMCwgX2l0ZXJhdG9yMiA9IF9pc0FycmF5MiA/IF9pdGVyYXRvcjIgOiBfaXRlcmF0b3IyW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgIHZhciBfcmVmMjtcblxuICAgICAgICBpZiAoX2lzQXJyYXkyKSB7XG4gICAgICAgICAgaWYgKF9pMiA+PSBfaXRlcmF0b3IyLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgX3JlZjIgPSBfaXRlcmF0b3IyW19pMisrXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfaTIgPSBfaXRlcmF0b3IyLm5leHQoKTtcbiAgICAgICAgICBpZiAoX2kyLmRvbmUpIGJyZWFrO1xuICAgICAgICAgIF9yZWYyID0gX2kyLnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGNoaWxkID0gX3JlZjI7XG4gICAgICAgIHZhciBzdG9wID0gY2hpbGQudHJhdmVyc2VEZXB0aEZpcnN0KHZpc2l0b3IpO1xuXG4gICAgICAgIGlmIChzdG9wKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93ICdVbmhhbmRsZWQgY2FzZSc7XG4gIH1cbn07XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0xheWVydHJlZUNvbnRyb2xsZXInLCBbXSk7XG5tb2R1bGUuY29udHJvbGxlcignbmdlb0xheWVydHJlZUNvbnRyb2xsZXInLCBMYXllcnRyZWVDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaikge1xub2JqIHx8IChvYmogPSB7fSk7XG52YXIgX190LCBfX3AgPSAnJztcbndpdGggKG9iaikge1xuX19wICs9ICc8c3BhbiBuZy1pZj1cIjo6IWxheWVydHJlZUN0cmwuaXNSb290XCI+e3s6OmxheWVydHJlZUN0cmwubm9kZS5uYW1lfX08L3NwYW4+XFxuPGlucHV0XFxuICB0eXBlPVwiY2hlY2tib3hcIlxcbiAgbmctaWY9XCI6OmxheWVydHJlZUN0cmwubm9kZSAmJiAhbGF5ZXJ0cmVlQ3RybC5ub2RlLmNoaWxkcmVuXCJcXG4gIG5nLW1vZGVsPVwibGF5ZXJ0cmVlQ3RybC5nZXRTZXRBY3RpdmVcIlxcbiAgbmctbW9kZWwtb3B0aW9ucz1cIntnZXR0ZXJTZXR0ZXI6IHRydWV9XCIvPlxcbjx1bCBuZy1pZj1cIjo6bGF5ZXJ0cmVlQ3RybC5ub2RlLmNoaWxkcmVuXCI+XFxuICA8bGlcXG4gICAgbmctcmVwZWF0PVwibm9kZSBpbiA6OmxheWVydHJlZUN0cmwubm9kZS5jaGlsZHJlblwiXFxuICAgIG5nZW8tbGF5ZXJ0cmVlPVwiOjpub2RlXCJcXG4gICAgbmdlby1sYXllcnRyZWUtbm90cm9vdFxcbiAgICBuZ2VvLWxheWVydHJlZS1tYXA9XCJsYXllcnRyZWVDdHJsLm1hcFwiXFxuICAgIG5nZW8tbGF5ZXJ0cmVlLW5vZGVsYXllcmV4cHI9XCJsYXllcnRyZWVDdHJsLm5vZGVsYXllckV4cHJcIlxcbiAgICBuZ2VvLWxheWVydHJlZS1saXN0ZW5lcnNleHByPVwibGF5ZXJ0cmVlQ3RybC5saXN0ZW5lcnNFeHByXCI+XFxuICA8L2xpPlxcbjwvdWw+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImdtZkxheWVydHJlZUNvbXBvbmVudC4kaW5qZWN0ID0gW1wibmdlb0xheWVydHJlZVRlbXBsYXRlVXJsXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb0xheWVydHJlZUNvbnRyb2xsZXIsIHsgTGF5ZXJ0cmVlQ29udHJvbGxlciB9IGZyb20gJ25nZW8vbGF5ZXJ0cmVlL0NvbnRyb2xsZXIuanMnO1xuaW1wb3J0ICdib290c3RyYXAvanMvc3JjL2NvbGxhcHNlLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0xheWVydHJlZScsIFtuZ2VvTGF5ZXJ0cmVlQ29udHJvbGxlci5uYW1lXSk7XG5tb2R1bGUudmFsdWUoJ25nZW9MYXllcnRyZWVUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uIChlbGVtZW50LCBhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSBhdHRyc1snbmdlb0xheWVydHJlZVRlbXBsYXRldXJsJ107XG4gIHJldHVybiB0ZW1wbGF0ZVVybCAhPT0gdW5kZWZpbmVkID8gdGVtcGxhdGVVcmwgOiAnbmdlby9sYXllcnRyZWUnO1xufSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ25nZW8vbGF5ZXJ0cmVlJywgcmVxdWlyZSgnLi9jb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcblxuZnVuY3Rpb24gZ21mTGF5ZXJ0cmVlQ29tcG9uZW50KG5nZW9MYXllcnRyZWVUZW1wbGF0ZVVybCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgc2NvcGU6IHRydWUsXG4gICAgdGVtcGxhdGVVcmw6IG5nZW9MYXllcnRyZWVUZW1wbGF0ZVVybCxcbiAgICBjb250cm9sbGVyOiBMYXllcnRyZWVDb250cm9sbGVyXG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9MYXllcnRyZWUnLCBnbWZMYXllcnRyZWVDb21wb25lbnQpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvQ3VzdG9tRXZlbnQgZnJvbSAnbmdlby9DdXN0b21FdmVudC5qcyc7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG5pbXBvcnQgb2xPYnNlcnZhYmxlIGZyb20gJ29sL09ic2VydmFibGUuanMnO1xuaW1wb3J0IG9sTGF5ZXJHcm91cCBmcm9tICdvbC9sYXllci9Hcm91cC5qcyc7XG5pbXBvcnQgb2xMYXllckxheWVyIGZyb20gJ29sL2xheWVyL0xheWVyLmpzJztcbmltcG9ydCBvbFNvdXJjZUltYWdlV01TIGZyb20gJ29sL3NvdXJjZS9JbWFnZVdNUy5qcyc7XG5pbXBvcnQgb2xTb3VyY2VUaWxlV01TIGZyb20gJ29sL3NvdXJjZS9UaWxlV01TLmpzJztcbmltcG9ydCBvbFNvdXJjZVdNVFMgZnJvbSAnb2wvc291cmNlL1dNVFMuanMnO1xuaW1wb3J0IG5nZW9MYXllckhlbHBlciBmcm9tICduZ2VvL21hcC9MYXllckhlbHBlci5qcyc7XG52YXIgQkFDS0dST1VORExBWUVSR1JPVVBfTkFNRSA9ICdiYWNrZ3JvdW5kJztcbmV4cG9ydCB2YXIgTWFwQmFja2dyb3VuZExheWVyTWFuYWdlciA9IGZ1bmN0aW9uIChfb2xPYnNlcnZhYmxlKSB7XG4gIE1hcEJhY2tncm91bmRMYXllck1hbmFnZXIuJGluamVjdCA9IFtcIm5nZW9MYXllckhlbHBlclwiXTtcblxuICBfaW5oZXJpdHNMb29zZShNYXBCYWNrZ3JvdW5kTGF5ZXJNYW5hZ2VyLCBfb2xPYnNlcnZhYmxlKTtcblxuICBmdW5jdGlvbiBNYXBCYWNrZ3JvdW5kTGF5ZXJNYW5hZ2VyKG5nZW9MYXllckhlbHBlcikge1xuICAgIHZhciBfdGhpcztcblxuICAgIF90aGlzID0gX29sT2JzZXJ2YWJsZS5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgX3RoaXMubWFwVWlkc18gPSB7fTtcbiAgICBfdGhpcy5uZ2VvTGF5ZXJIZWxwZXJfID0gbmdlb0xheWVySGVscGVyO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBNYXBCYWNrZ3JvdW5kTGF5ZXJNYW5hZ2VyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZ2V0ID0gZnVuY3Rpb24gZ2V0KG1hcCkge1xuICAgIHZhciBtYXBVaWQgPSBvbFV0aWxHZXRVaWQobWFwKS50b1N0cmluZygpO1xuICAgIHJldHVybiBtYXBVaWQgaW4gdGhpcy5tYXBVaWRzXyA/IHRoaXMubmdlb0xheWVySGVscGVyXy5nZXRHcm91cEZyb21NYXAobWFwLCBCQUNLR1JPVU5ETEFZRVJHUk9VUF9OQU1FKS5nZXRMYXllcnMoKS5pdGVtKDApIDogbnVsbDtcbiAgfTtcblxuICBfcHJvdG8uc2V0ID0gZnVuY3Rpb24gc2V0KG1hcCwgbGF5ZXIpIHtcbiAgICB2YXIgWkluZGV4ID0gLTIwMDtcbiAgICB2YXIgbWFwVWlkID0gb2xVdGlsR2V0VWlkKG1hcCkudG9TdHJpbmcoKTtcbiAgICB2YXIgcHJldmlvdXMgPSB0aGlzLmdldChtYXApO1xuXG4gICAgaWYgKGxheWVyICE9PSBudWxsKSB7XG4gICAgICBsYXllci5zZXRaSW5kZXgoWkluZGV4KTtcbiAgICAgIHRoaXMubmdlb0xheWVySGVscGVyXy5zZXRaSW5kZXhUb0ZpcnN0TGV2ZWxDaGlsZHJlbihsYXllciwgWkluZGV4KTtcbiAgICB9XG5cbiAgICB2YXIgYmdHcm91cCA9IHRoaXMubmdlb0xheWVySGVscGVyXy5nZXRHcm91cEZyb21NYXAobWFwLCBCQUNLR1JPVU5ETEFZRVJHUk9VUF9OQU1FKTtcblxuICAgIGlmIChwcmV2aW91cyAhPT0gbnVsbCkge1xuICAgICAgY29uc29sZS5hc3NlcnQobWFwVWlkIGluIHRoaXMubWFwVWlkc18pO1xuXG4gICAgICBpZiAobGF5ZXIgIT09IG51bGwpIHtcbiAgICAgICAgYmdHcm91cC5nZXRMYXllcnMoKS5zZXRBdCgwLCBsYXllcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBiZ0dyb3VwLmdldExheWVycygpLnJlbW92ZUF0KDApO1xuICAgICAgICBkZWxldGUgdGhpcy5tYXBVaWRzX1ttYXBVaWRdO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAobGF5ZXIgIT09IG51bGwpIHtcbiAgICAgIGJnR3JvdXAuZ2V0TGF5ZXJzKCkuaW5zZXJ0QXQoMCwgbGF5ZXIpO1xuICAgICAgdGhpcy5tYXBVaWRzX1ttYXBVaWRdID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgZXZlbnQgPSBuZXcgbmdlb0N1c3RvbUV2ZW50KCdjaGFuZ2UnLCB7XG4gICAgICBjdXJyZW50OiBsYXllcixcbiAgICAgIHByZXZpb3VzOiBwcmV2aW91c1xuICAgIH0pO1xuICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgcmV0dXJuIHByZXZpb3VzO1xuICB9O1xuXG4gIF9wcm90by5nZXRPcGFjaXR5QmdMYXllciA9IGZ1bmN0aW9uIGdldE9wYWNpdHlCZ0xheWVyKG1hcCkge1xuICAgIHZhciBtYXBVaWQgPSBvbFV0aWxHZXRVaWQobWFwKS50b1N0cmluZygpO1xuICAgIHJldHVybiBtYXBVaWQgaW4gdGhpcy5tYXBVaWRzXyA/IHRoaXMubmdlb0xheWVySGVscGVyXy5nZXRHcm91cEZyb21NYXAobWFwLCBCQUNLR1JPVU5ETEFZRVJHUk9VUF9OQU1FKS5nZXRMYXllcnMoKS5pdGVtKDEpIDogbnVsbDtcbiAgfTtcblxuICBfcHJvdG8uc2V0T3BhY2l0eUJnTGF5ZXIgPSBmdW5jdGlvbiBzZXRPcGFjaXR5QmdMYXllcihtYXAsIGxheWVyKSB7XG4gICAgdmFyIGJnR3JvdXAgPSB0aGlzLm5nZW9MYXllckhlbHBlcl8uZ2V0R3JvdXBGcm9tTWFwKG1hcCwgQkFDS0dST1VORExBWUVSR1JPVVBfTkFNRSk7XG4gICAgdmFyIG9wYWNpdHlCYWNrZ3JvdW5kTGF5ZXIgPSB0aGlzLmdldE9wYWNpdHlCZ0xheWVyKG1hcCk7XG5cbiAgICBpZiAob3BhY2l0eUJhY2tncm91bmRMYXllcikge1xuICAgICAgdmFyIHByZXZpb3VzID0gYmdHcm91cC5nZXRMYXllcnMoKS5yZW1vdmUob3BhY2l0eUJhY2tncm91bmRMYXllcik7XG4gICAgICBsYXllci5zZXRPcGFjaXR5KHByZXZpb3VzID8gcHJldmlvdXMuZ2V0T3BhY2l0eSgpIDogMCk7XG4gICAgICBsYXllci5zZXRWaXNpYmxlKHByZXZpb3VzID8gcHJldmlvdXMuZ2V0VmlzaWJsZSgpIDogdHJ1ZSk7XG4gICAgfVxuXG4gICAgdmFyIFpJbmRleCA9IC0xMDA7XG4gICAgbGF5ZXIuc2V0WkluZGV4KFpJbmRleCk7XG4gICAgdGhpcy5uZ2VvTGF5ZXJIZWxwZXJfLnNldFpJbmRleFRvRmlyc3RMZXZlbENoaWxkcmVuKGxheWVyLCBaSW5kZXgpO1xuICAgIHZhciBpbmRleCA9IGJnR3JvdXAuZ2V0TGF5ZXJzKCkuZ2V0QXJyYXkoKS5pbmRleE9mKGxheWVyKTtcblxuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgIGJnR3JvdXAuZ2V0TGF5ZXJzKCkucHVzaChsYXllcik7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by51cGRhdGVEaW1lbnNpb25zID0gZnVuY3Rpb24gdXBkYXRlRGltZW5zaW9ucyhtYXAsIGRpbWVuc2lvbnMpIHtcbiAgICB2YXIgYmFzZUJnTGF5ZXIgPSB0aGlzLmdldChtYXApO1xuXG4gICAgaWYgKGJhc2VCZ0xheWVyKSB7XG4gICAgICB2YXIgbGF5ZXJzID0gW2Jhc2VCZ0xheWVyXTtcblxuICAgICAgaWYgKGJhc2VCZ0xheWVyIGluc3RhbmNlb2Ygb2xMYXllckdyb3VwKSB7XG4gICAgICAgIGxheWVycyA9IGJhc2VCZ0xheWVyLmdldExheWVycygpLmdldEFycmF5KCk7XG4gICAgICB9XG5cbiAgICAgIGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYXllcikge1xuICAgICAgICBpZiAobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyTGF5ZXIpIHtcbiAgICAgICAgICB2YXIgaGFzVXBkYXRlcyA9IGZhbHNlO1xuICAgICAgICAgIHZhciB1cGRhdGVkRGltZW5zaW9ucyA9IHt9O1xuXG4gICAgICAgICAgZm9yICh2YXIga2V5IGluIGxheWVyLmdldCgnZGltZW5zaW9ucycpKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBkaW1lbnNpb25zW2tleV07XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIHVwZGF0ZWREaW1lbnNpb25zW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgaGFzVXBkYXRlcyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGhhc1VwZGF0ZXMpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBsYXllci5nZXRTb3VyY2UoKTtcblxuICAgICAgICAgICAgaWYgKHNvdXJjZSBpbnN0YW5jZW9mIG9sU291cmNlV01UUykge1xuICAgICAgICAgICAgICBzb3VyY2UudXBkYXRlRGltZW5zaW9ucyh1cGRhdGVkRGltZW5zaW9ucyk7XG4gICAgICAgICAgICAgIHNvdXJjZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNvdXJjZSBpbnN0YW5jZW9mIG9sU291cmNlVGlsZVdNUyB8fCBzb3VyY2UgaW5zdGFuY2VvZiBvbFNvdXJjZUltYWdlV01TKSB7XG4gICAgICAgICAgICAgIHNvdXJjZS51cGRhdGVQYXJhbXModXBkYXRlZERpbWVuc2lvbnMpO1xuICAgICAgICAgICAgICBzb3VyY2UucmVmcmVzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBNYXBCYWNrZ3JvdW5kTGF5ZXJNYW5hZ2VyO1xufShvbE9ic2VydmFibGUpO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvQmFja2dyb3VuZExheWVyTWdyJywgW25nZW9MYXllckhlbHBlci5uYW1lXSk7XG5tb2R1bGUuc2VydmljZSgnbmdlb0JhY2tncm91bmRMYXllck1ncicsIE1hcEJhY2tncm91bmRMYXllck1hbmFnZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgbGlzdGVuLCB1bmxpc3RlbkJ5S2V5IH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCB7IENvbGxlY3Rpb25FdmVudCB9IGZyb20gJ29sL0NvbGxlY3Rpb24uanMnO1xuZXhwb3J0IGZ1bmN0aW9uIEZlYXR1cmVPdmVybGF5KG1hbmFnZXIsIGluZGV4KSB7XG4gIHRoaXMubWFuYWdlcl8gPSBtYW5hZ2VyO1xuICB0aGlzLmZlYXR1cmVzXyA9IG51bGw7XG4gIHRoaXMuaW5kZXhfID0gaW5kZXg7XG4gIHRoaXMubGlzdGVuZXJLZXlzXyA9IFtdO1xufVxuXG5GZWF0dXJlT3ZlcmxheS5wcm90b3R5cGUuYWRkRmVhdHVyZSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHRoaXMubWFuYWdlcl8uYWRkRmVhdHVyZShmZWF0dXJlLCB0aGlzLmluZGV4Xyk7XG59O1xuXG5GZWF0dXJlT3ZlcmxheS5wcm90b3R5cGUucmVtb3ZlRmVhdHVyZSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHRoaXMubWFuYWdlcl8ucmVtb3ZlRmVhdHVyZShmZWF0dXJlLCB0aGlzLmluZGV4Xyk7XG59O1xuXG5GZWF0dXJlT3ZlcmxheS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMubWFuYWdlcl8uY2xlYXIodGhpcy5pbmRleF8pO1xufTtcblxuRmVhdHVyZU92ZXJsYXkucHJvdG90eXBlLnNldEZlYXR1cmVzID0gZnVuY3Rpb24gKGZlYXR1cmVzKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgaWYgKHRoaXMuZmVhdHVyZXNfICE9PSBudWxsKSB7XG4gICAgdGhpcy5mZWF0dXJlc18uY2xlYXIoKTtcbiAgICB0aGlzLmxpc3RlbmVyS2V5c18uZm9yRWFjaCh1bmxpc3RlbkJ5S2V5KTtcbiAgfVxuXG4gIGlmIChmZWF0dXJlcyAhPT0gbnVsbCkge1xuICAgIGZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgIF90aGlzLmFkZEZlYXR1cmUoZmVhdHVyZSk7XG4gICAgfSk7XG4gICAgdGhpcy5saXN0ZW5lcktleXNfLnB1c2gobGlzdGVuKGZlYXR1cmVzLCAnYWRkJywgdGhpcy5oYW5kbGVGZWF0dXJlQWRkXywgdGhpcykpO1xuICAgIHRoaXMubGlzdGVuZXJLZXlzXy5wdXNoKGxpc3RlbihmZWF0dXJlcywgJ3JlbW92ZScsIHRoaXMuaGFuZGxlRmVhdHVyZVJlbW92ZV8sIHRoaXMpKTtcbiAgfVxuXG4gIHRoaXMuZmVhdHVyZXNfID0gZmVhdHVyZXM7XG59O1xuXG5GZWF0dXJlT3ZlcmxheS5wcm90b3R5cGUuc2V0U3R5bGUgPSBmdW5jdGlvbiAoc3R5bGUpIHtcbiAgdGhpcy5tYW5hZ2VyXy5zZXRTdHlsZShzdHlsZSwgdGhpcy5pbmRleF8pO1xufTtcblxuRmVhdHVyZU92ZXJsYXkucHJvdG90eXBlLmhhbmRsZUZlYXR1cmVBZGRfID0gZnVuY3Rpb24gKGV2dCkge1xuICBpZiAoZXZ0IGluc3RhbmNlb2YgQ29sbGVjdGlvbkV2ZW50KSB7XG4gICAgdmFyIGZlYXR1cmUgPSBldnQuZWxlbWVudDtcbiAgICB0aGlzLmFkZEZlYXR1cmUoZmVhdHVyZSk7XG4gIH1cbn07XG5cbkZlYXR1cmVPdmVybGF5LnByb3RvdHlwZS5oYW5kbGVGZWF0dXJlUmVtb3ZlXyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgaWYgKGV2dCBpbnN0YW5jZW9mIENvbGxlY3Rpb25FdmVudCkge1xuICAgIHZhciBmZWF0dXJlID0gZXZ0LmVsZW1lbnQ7XG4gICAgdGhpcy5yZW1vdmVGZWF0dXJlKGZlYXR1cmUpO1xuICB9XG59O1xuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9GZWF0dXJlT3ZlcmxheScsIFtdKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXksIHsgRmVhdHVyZU92ZXJsYXkgfSBmcm9tICduZ2VvL21hcC9GZWF0dXJlT3ZlcmxheS5qcyc7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG5pbXBvcnQgb2xMYXllclZlY3RvciBmcm9tICdvbC9sYXllci9WZWN0b3IuanMnO1xuaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ29sL29iai5qcyc7XG5pbXBvcnQgb2xTb3VyY2VWZWN0b3IgZnJvbSAnb2wvc291cmNlL1ZlY3Rvci5qcyc7XG5pbXBvcnQgeyB0b0Z1bmN0aW9uIGFzIHRvU3R5bGVGdW5jdGlvbiwgY3JlYXRlRGVmYXVsdFN0eWxlIGFzIG9sU3R5bGVEZWZhdWx0RnVuY3Rpb24gfSBmcm9tICdvbC9zdHlsZS9TdHlsZS5qcyc7XG5leHBvcnQgZnVuY3Rpb24gRmVhdHVyZU92ZXJsYXlNZ3IoKSB7XG4gIHRoaXMuZmVhdHVyZVVpZFRvR3JvdXBJbmRleF8gPSB7fTtcbiAgdGhpcy5ncm91cHNfID0gW107XG4gIHRoaXMuc291cmNlXyA9IG5ldyBvbFNvdXJjZVZlY3Rvcih7XG4gICAgdXNlU3BhdGlhbEluZGV4OiBmYWxzZVxuICB9KTtcbiAgdGhpcy5sYXllcl8gPSBuZXcgb2xMYXllclZlY3Rvcih7XG4gICAgc291cmNlOiB0aGlzLnNvdXJjZV8sXG4gICAgc3R5bGU6IHRoaXMuc3R5bGVGdW5jdGlvbl8uYmluZCh0aGlzKSxcbiAgICB1cGRhdGVXaGlsZUFuaW1hdGluZzogdHJ1ZSxcbiAgICB1cGRhdGVXaGlsZUludGVyYWN0aW5nOiB0cnVlXG4gIH0pO1xufVxuXG5GZWF0dXJlT3ZlcmxheU1nci5wcm90b3R5cGUuYWRkRmVhdHVyZSA9IGZ1bmN0aW9uIChmZWF0dXJlLCBncm91cEluZGV4KSB7XG4gIGNvbnNvbGUuYXNzZXJ0KGdyb3VwSW5kZXggPj0gMCk7XG4gIGNvbnNvbGUuYXNzZXJ0KGdyb3VwSW5kZXggPCB0aGlzLmdyb3Vwc18ubGVuZ3RoKTtcbiAgdmFyIGZlYXR1cmVVaWQgPSBvbFV0aWxHZXRVaWQoZmVhdHVyZSkudG9TdHJpbmcoKTtcbiAgdGhpcy5mZWF0dXJlVWlkVG9Hcm91cEluZGV4X1tmZWF0dXJlVWlkXSA9IGdyb3VwSW5kZXg7XG4gIHRoaXMuZ3JvdXBzX1tncm91cEluZGV4XS5mZWF0dXJlc1tmZWF0dXJlVWlkXSA9IGZlYXR1cmU7XG4gIHRoaXMuc291cmNlXy5hZGRGZWF0dXJlKGZlYXR1cmUpO1xufTtcblxuRmVhdHVyZU92ZXJsYXlNZ3IucHJvdG90eXBlLnJlbW92ZUZlYXR1cmUgPSBmdW5jdGlvbiAoZmVhdHVyZSwgZ3JvdXBJbmRleCkge1xuICBjb25zb2xlLmFzc2VydChncm91cEluZGV4ID49IDApO1xuICBjb25zb2xlLmFzc2VydChncm91cEluZGV4IDwgdGhpcy5ncm91cHNfLmxlbmd0aCk7XG4gIHZhciBmZWF0dXJlVWlkID0gb2xVdGlsR2V0VWlkKGZlYXR1cmUpLnRvU3RyaW5nKCk7XG4gIGRlbGV0ZSB0aGlzLmZlYXR1cmVVaWRUb0dyb3VwSW5kZXhfW2ZlYXR1cmVVaWRdO1xuICBkZWxldGUgdGhpcy5ncm91cHNfW2dyb3VwSW5kZXhdLmZlYXR1cmVzW2ZlYXR1cmVVaWRdO1xuICB0aGlzLnNvdXJjZV8ucmVtb3ZlRmVhdHVyZShmZWF0dXJlKTtcbn07XG5cbkZlYXR1cmVPdmVybGF5TWdyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uIChncm91cEluZGV4KSB7XG4gIGNvbnNvbGUuYXNzZXJ0KGdyb3VwSW5kZXggPj0gMCk7XG4gIGNvbnNvbGUuYXNzZXJ0KGdyb3VwSW5kZXggPCB0aGlzLmdyb3Vwc18ubGVuZ3RoKTtcbiAgdmFyIGdyb3VwID0gdGhpcy5ncm91cHNfW2dyb3VwSW5kZXhdO1xuXG4gIGZvciAodmFyIGZlYXR1cmVVaWQgaW4gZ3JvdXAuZmVhdHVyZXMpIHtcbiAgICB0aGlzLnJlbW92ZUZlYXR1cmUoZ3JvdXAuZmVhdHVyZXNbZmVhdHVyZVVpZF0sIGdyb3VwSW5kZXgpO1xuICB9XG5cbiAgY29uc29sZS5hc3NlcnQoaXNFbXB0eShncm91cC5mZWF0dXJlcykpO1xufTtcblxuRmVhdHVyZU92ZXJsYXlNZ3IucHJvdG90eXBlLmdldExheWVyID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5sYXllcl87XG59O1xuXG5GZWF0dXJlT3ZlcmxheU1nci5wcm90b3R5cGUuZ2V0RmVhdHVyZU92ZXJsYXkgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBncm91cEluZGV4ID0gdGhpcy5ncm91cHNfLmxlbmd0aDtcbiAgdGhpcy5ncm91cHNfLnB1c2goe1xuICAgIHN0eWxlRnVuY3Rpb246IG9sU3R5bGVEZWZhdWx0RnVuY3Rpb24sXG4gICAgZmVhdHVyZXM6IHt9XG4gIH0pO1xuICByZXR1cm4gbmV3IEZlYXR1cmVPdmVybGF5KHRoaXMsIGdyb3VwSW5kZXgpO1xufTtcblxuRmVhdHVyZU92ZXJsYXlNZ3IucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAobWFwKSB7XG4gIHRoaXMubGF5ZXJfLnNldE1hcChtYXApO1xufTtcblxuRmVhdHVyZU92ZXJsYXlNZ3IucHJvdG90eXBlLnNldFN0eWxlID0gZnVuY3Rpb24gKHN0eWxlLCBncm91cEluZGV4KSB7XG4gIGNvbnNvbGUuYXNzZXJ0KGdyb3VwSW5kZXggPj0gMCk7XG4gIGNvbnNvbGUuYXNzZXJ0KGdyb3VwSW5kZXggPCB0aGlzLmdyb3Vwc18ubGVuZ3RoKTtcbiAgdGhpcy5ncm91cHNfW2dyb3VwSW5kZXhdLnN0eWxlRnVuY3Rpb24gPSBzdHlsZSA9PT0gbnVsbCA/IG9sU3R5bGVEZWZhdWx0RnVuY3Rpb24gOiB0b1N0eWxlRnVuY3Rpb24oc3R5bGUpO1xufTtcblxuRmVhdHVyZU92ZXJsYXlNZ3IucHJvdG90eXBlLnN0eWxlRnVuY3Rpb25fID0gZnVuY3Rpb24gKGZlYXR1cmUsIHJlc29sdXRpb24pIHtcbiAgdmFyIGZlYXR1cmVVaWQgPSBvbFV0aWxHZXRVaWQoZmVhdHVyZSkudG9TdHJpbmcoKTtcbiAgY29uc29sZS5hc3NlcnQoZmVhdHVyZVVpZCBpbiB0aGlzLmZlYXR1cmVVaWRUb0dyb3VwSW5kZXhfKTtcbiAgdmFyIGdyb3VwSW5kZXggPSB0aGlzLmZlYXR1cmVVaWRUb0dyb3VwSW5kZXhfW2ZlYXR1cmVVaWRdO1xuICB2YXIgZ3JvdXAgPSB0aGlzLmdyb3Vwc19bZ3JvdXBJbmRleF07XG4gIHJldHVybiBncm91cC5zdHlsZUZ1bmN0aW9uKGZlYXR1cmUsIHJlc29sdXRpb24pO1xufTtcblxudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvRmVhdHVyZU92ZXJsYXlNZ3InLCBbbmdlb01hcEZlYXR1cmVPdmVybGF5Lm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvRmVhdHVyZU92ZXJsYXlNZ3InLCBGZWF0dXJlT3ZlcmxheU1ncik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiTGF5ZXJIZWxwZXIuJGluamVjdCA9IFtcIiRxXCIsIFwiJGh0dHBcIiwgXCJuZ2VvVGlsZXNQcmVsb2FkaW5nTGltaXRcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCAqIGFzIG9sQXJyYXkgZnJvbSAnb2wvYXJyYXkuanMnO1xuaW1wb3J0IG9sRm9ybWF0V01UU0NhcGFiaWxpdGllcyBmcm9tICdvbC9mb3JtYXQvV01UU0NhcGFiaWxpdGllcy5qcyc7XG5pbXBvcnQgb2xMYXllckdyb3VwIGZyb20gJ29sL2xheWVyL0dyb3VwLmpzJztcbmltcG9ydCBvbExheWVySW1hZ2UgZnJvbSAnb2wvbGF5ZXIvSW1hZ2UuanMnO1xuaW1wb3J0IG9sTGF5ZXJUaWxlIGZyb20gJ29sL2xheWVyL1RpbGUuanMnO1xuaW1wb3J0IG9sTGF5ZXJMYXllciBmcm9tICdvbC9sYXllci9MYXllci5qcyc7XG5pbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSAnb2wvb2JqLmpzJztcbmltcG9ydCBvbFNvdXJjZUltYWdlV01TIGZyb20gJ29sL3NvdXJjZS9JbWFnZVdNUy5qcyc7XG5pbXBvcnQgb2xTb3VyY2VUaWxlV01TIGZyb20gJ29sL3NvdXJjZS9UaWxlV01TLmpzJztcbmltcG9ydCBvbFNvdXJjZVdNVFMsIHsgb3B0aW9uc0Zyb21DYXBhYmlsaXRpZXMgfSBmcm9tICdvbC9zb3VyY2UvV01UUy5qcyc7XG5pbXBvcnQgeyBhcHBlbmRQYXJhbXMgYXMgb2xVcmlBcHBlbmRQYXJhbXMgfSBmcm9tICdvbC91cmkuanMnO1xuaW1wb3J0IHsgU2VydmVyVHlwZSB9IGZyb20gJ25nZW8vZGF0YXNvdXJjZS9PR0MuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIExheWVySGVscGVyKCRxLCAkaHR0cCwgbmdlb1RpbGVzUHJlbG9hZGluZ0xpbWl0KSB7XG4gIHRoaXMuJHFfID0gJHE7XG4gIHRoaXMuJGh0dHBfID0gJGh0dHA7XG4gIHRoaXMudGlsZXNQcmVsb2FkaW5nTGltaXRfID0gbmdlb1RpbGVzUHJlbG9hZGluZ0xpbWl0O1xufVxudmFyIEdST1VQX0tFWSA9ICdncm91cE5hbWUnO1xudmFyIFJFRlJFU0hfUEFSQU0gPSAncmFuZG9tJztcblxuTGF5ZXJIZWxwZXIucHJvdG90eXBlLmNyZWF0ZUJhc2ljV01TTGF5ZXIgPSBmdW5jdGlvbiAoc291cmNlVVJMLCBzb3VyY2VMYXllcnNOYW1lLCBzb3VyY2VGb3JtYXQsIG9wdF9zZXJ2ZXJUeXBlLCBvcHRfdGltZSwgb3B0X3BhcmFtcywgb3B0X2Nyb3NzT3JpZ2luLCBvcHRfY3VzdG9tU291cmNlT3B0aW9ucywgb3B0X2N1c3RvbUxheWVyT3B0aW9ucykge1xuICB2YXIgcGFyYW1zID0ge1xuICAgIEZPUk1BVDogc291cmNlRm9ybWF0LFxuICAgIExBWUVSUzogc291cmNlTGF5ZXJzTmFtZVxuICB9O1xuICB2YXIgb2xTZXJ2ZXJUeXBlO1xuXG4gIGlmIChvcHRfdGltZSkge1xuICAgIHBhcmFtcy5USU1FID0gb3B0X3RpbWU7XG4gIH1cblxuICBpZiAob3B0X3NlcnZlclR5cGUpIHtcbiAgICBwYXJhbXMuU0VSVkVSVFlQRSA9IG9wdF9zZXJ2ZXJUeXBlO1xuICAgIG9sU2VydmVyVHlwZSA9IG9wdF9zZXJ2ZXJUeXBlLnJlcGxhY2UoU2VydmVyVHlwZS5RR0lTU0VSVkVSLCAncWdpcycpO1xuICB9XG5cbiAgdmFyIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRfY3VzdG9tU291cmNlT3B0aW9ucywge1xuICAgIHVybDogc291cmNlVVJMLFxuICAgIHBhcmFtczogcGFyYW1zLFxuICAgIHNlcnZlclR5cGU6IG9sU2VydmVyVHlwZSxcbiAgICBjcm9zc09yaWdpbjogb3B0X2Nyb3NzT3JpZ2luXG4gIH0pO1xuICB2YXIgc291cmNlID0gbmV3IG9sU291cmNlSW1hZ2VXTVMob3B0aW9ucyk7XG5cbiAgaWYgKG9wdF9wYXJhbXMpIHtcbiAgICBzb3VyY2UudXBkYXRlUGFyYW1zKG9wdF9wYXJhbXMpO1xuICB9XG5cbiAgdmFyIGxheWVyT3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdF9jdXN0b21MYXllck9wdGlvbnMsIHtcbiAgICBzb3VyY2U6IHNvdXJjZVxuICB9KTtcbiAgcmV0dXJuIG5ldyBvbExheWVySW1hZ2UobGF5ZXJPcHRpb25zKTtcbn07XG5cbkxheWVySGVscGVyLnByb3RvdHlwZS5jcmVhdGVCYXNpY1dNU0xheWVyRnJvbURhdGFTb3VyY2UgPSBmdW5jdGlvbiAoZGF0YVNvdXJjZSwgb3B0X2Nyb3NzT3JpZ2luKSB7XG4gIHZhciB1cmwgPSBkYXRhU291cmNlLndtc1VybDtcblxuICBpZiAodXJsID09PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdXJsJyk7XG4gIH1cblxuICB2YXIgbGF5ZXJOYW1lcyA9IGRhdGFTb3VyY2UuZ2V0V01TTGF5ZXJOYW1lcygpLmpvaW4oJywnKTtcbiAgdmFyIHNlcnZlclR5cGUgPSBkYXRhU291cmNlLm9nY1NlcnZlclR5cGU7XG4gIHZhciBpbWFnZVR5cGUgPSBkYXRhU291cmNlLm9nY0ltYWdlVHlwZTtcbiAgdmFyIGxheWVyID0gdGhpcy5jcmVhdGVCYXNpY1dNU0xheWVyKHVybCwgbGF5ZXJOYW1lcywgaW1hZ2VUeXBlLCBzZXJ2ZXJUeXBlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgb3B0X2Nyb3NzT3JpZ2luKTtcbiAgbGF5ZXIuc2V0VmlzaWJsZShkYXRhU291cmNlLnZpc2libGUpO1xuICBsYXllci5zZXQoJ3F1ZXJ5U291cmNlSWRzJywgW2RhdGFTb3VyY2UuaWRdKTtcbiAgbGF5ZXIuc2V0KCdkYXRhU291cmNlSWQnLCBkYXRhU291cmNlLmlkKTtcbiAgcmV0dXJuIGxheWVyO1xufTtcblxuTGF5ZXJIZWxwZXIucHJvdG90eXBlLmNyZWF0ZVdNVFNMYXllckZyb21DYXBhYmlsaXRpdGVzID0gZnVuY3Rpb24gKGNhcGFiaWxpdGllc1VSTCwgbGF5ZXJOYW1lLCBvcHRfbWF0cml4U2V0LCBvcHRfZGltZW5zaW9ucywgb3B0X2N1c3RvbU9wdGlvbnMsIG9wdF9taW5SZXNvbHV0aW9uLCBvcHRfbWF4UmVzb2x1dGlvbikge1xuICB2YXIgcGFyc2VyID0gbmV3IG9sRm9ybWF0V01UU0NhcGFiaWxpdGllcygpO1xuICB2YXIgbGF5ZXIgPSBuZXcgb2xMYXllclRpbGUoe1xuICAgIHByZWxvYWQ6IHRoaXMudGlsZXNQcmVsb2FkaW5nTGltaXRfLFxuICAgIG1pblJlc29sdXRpb246IG9wdF9taW5SZXNvbHV0aW9uLFxuICAgIG1heFJlc29sdXRpb246IG9wdF9tYXhSZXNvbHV0aW9uXG4gIH0pO1xuICB2YXIgJHEgPSB0aGlzLiRxXztcbiAgcmV0dXJuIHRoaXMuJGh0dHBfLmdldChjYXBhYmlsaXRpZXNVUkwsIHtcbiAgICBjYWNoZTogdHJ1ZVxuICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIHZhciByZXN1bHQ7XG5cbiAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgcmVzdWx0ID0gcGFyc2VyLnJlYWQocmVzcG9uc2UuZGF0YSk7XG4gICAgfVxuXG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRfY3VzdG9tT3B0aW9ucywgb3B0aW9uc0Zyb21DYXBhYmlsaXRpZXMocmVzdWx0LCB7XG4gICAgICAgIG1hdHJpeFNldDogb3B0X21hdHJpeFNldCxcbiAgICAgICAgY3Jvc3NPcmlnaW46ICdhbm9ueW1vdXMnLFxuICAgICAgICBsYXllcjogbGF5ZXJOYW1lXG4gICAgICB9KSk7XG4gICAgICB2YXIgc291cmNlID0gbmV3IG9sU291cmNlV01UUyhvcHRpb25zKTtcblxuICAgICAgaWYgKG9wdF9kaW1lbnNpb25zICYmICFpc0VtcHR5KG9wdF9kaW1lbnNpb25zKSkge1xuICAgICAgICBzb3VyY2UudXBkYXRlRGltZW5zaW9ucyhvcHRfZGltZW5zaW9ucyk7XG4gICAgICB9XG5cbiAgICAgIGxheWVyLnNldFNvdXJjZShzb3VyY2UpO1xuICAgICAgdmFyIGxheWVycyA9IHJlc3VsdC5Db250ZW50cy5MYXllcjtcbiAgICAgIHZhciBsID0gb2xBcnJheS5maW5kKGxheWVycywgZnVuY3Rpb24gKGVsdCwgaW5kZXgsIGFycmF5KSB7XG4gICAgICAgIHJldHVybiBlbHQuSWRlbnRpZmllciA9PSBsYXllck5hbWU7XG4gICAgICB9KTtcblxuICAgICAgaWYgKCFsKSB7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoXCJMYXllciBcIiArIGxheWVyTmFtZSArIFwiIG5vdCBhYmFsYWJsZSBpbiBXTVRTIGNhcGFiaWxpdGllcyBmcm9tIFwiICsgY2FwYWJpbGl0aWVzVVJMKTtcbiAgICAgIH1cblxuICAgICAgbGF5ZXIuc2V0KCdjYXBhYmlsaXRpZXNTdHlsZXMnLCBsLlN0eWxlKTtcbiAgICAgIHJldHVybiAkcS5yZXNvbHZlKGxheWVyKTtcbiAgICB9XG5cbiAgICByZXR1cm4gJHEucmVqZWN0KFwiRmFpbGVkIHRvIGdldCBXTVRTIGNhcGFiaWxpdGllcyBmcm9tIFwiICsgY2FwYWJpbGl0aWVzVVJMKTtcbiAgfSk7XG59O1xuXG5MYXllckhlbHBlci5wcm90b3R5cGUuY3JlYXRlV01UU0xheWVyRnJvbUNhcGFiaWxpdGl0ZXNPYmogPSBmdW5jdGlvbiAoY2FwYWJpbGl0aWVzLCBsYXllckNhcCwgb3B0X2RpbWVuc2lvbnMpIHtcbiAgdmFyIG9wdGlvbnMgPSBvcHRpb25zRnJvbUNhcGFiaWxpdGllcyhjYXBhYmlsaXRpZXMsIHtcbiAgICBjcm9zc09yaWdpbjogJ2Fub255bW91cycsXG4gICAgbGF5ZXI6IGxheWVyQ2FwLklkZW50aWZpZXJcbiAgfSk7XG4gIGNvbnNvbGUuYXNzZXJ0KG9wdGlvbnMpO1xuICB2YXIgc291cmNlID0gbmV3IG9sU291cmNlV01UUyhvcHRpb25zKTtcblxuICBpZiAob3B0X2RpbWVuc2lvbnMgJiYgIWlzRW1wdHkob3B0X2RpbWVuc2lvbnMpKSB7XG4gICAgc291cmNlLnVwZGF0ZURpbWVuc2lvbnMob3B0X2RpbWVuc2lvbnMpO1xuICB9XG5cbiAgdmFyIHJlc3VsdCA9IG5ldyBvbExheWVyVGlsZSh7XG4gICAgcHJlbG9hZDogSW5maW5pdHksXG4gICAgc291cmNlOiBzb3VyY2VcbiAgfSk7XG4gIHJlc3VsdC5zZXQoJ2NhcGFiaWxpdGllc1N0eWxlcycsIGxheWVyQ2FwLlN0eWxlKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbkxheWVySGVscGVyLnByb3RvdHlwZS5jcmVhdGVCYXNpY0dyb3VwID0gZnVuY3Rpb24gKG9wdF9sYXllcnMpIHtcbiAgdmFyIGdyb3VwID0gbmV3IG9sTGF5ZXJHcm91cCgpO1xuXG4gIGlmIChvcHRfbGF5ZXJzKSB7XG4gICAgZ3JvdXAuc2V0TGF5ZXJzKG9wdF9sYXllcnMpO1xuICB9XG5cbiAgcmV0dXJuIGdyb3VwO1xufTtcblxuTGF5ZXJIZWxwZXIucHJvdG90eXBlLmdldEdyb3VwRnJvbU1hcCA9IGZ1bmN0aW9uIChtYXAsIGdyb3VwTmFtZSkge1xuICB2YXIgZ3JvdXBzID0gbWFwLmdldExheWVyR3JvdXAoKS5nZXRMYXllcnMoKTtcbiAgdmFyIGdyb3VwO1xuICBncm91cHMuZ2V0QXJyYXkoKS5zb21lKGZ1bmN0aW9uIChleGlzdGluZ0dyb3VwKSB7XG4gICAgaWYgKGV4aXN0aW5nR3JvdXAuZ2V0KEdST1VQX0tFWSkgPT09IGdyb3VwTmFtZSkge1xuICAgICAgZ3JvdXAgPSBleGlzdGluZ0dyb3VwO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0pO1xuXG4gIGlmICghZ3JvdXApIHtcbiAgICBncm91cCA9IHRoaXMuY3JlYXRlQmFzaWNHcm91cCgpO1xuICAgIGdyb3VwLnNldChHUk9VUF9LRVksIGdyb3VwTmFtZSk7XG4gICAgbWFwLmFkZExheWVyKGdyb3VwKTtcbiAgfVxuXG4gIHJldHVybiBncm91cDtcbn07XG5cbkxheWVySGVscGVyLnByb3RvdHlwZS5nZXRGbGF0TGF5ZXJzID0gZnVuY3Rpb24gKGxheWVyKSB7XG4gIGlmIChsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJHcm91cCkge1xuICAgIHZhciBzdWJsYXllcnMgPSBsYXllci5nZXRMYXllcnMoKS5nZXRBcnJheSgpO1xuICAgIHZhciBoYXNHcm91cExheWVyID0gc3VibGF5ZXJzLnNvbWUoZnVuY3Rpb24gKHN1YmxheWVyKSB7XG4gICAgICByZXR1cm4gc3VibGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyR3JvdXA7XG4gICAgfSk7XG5cbiAgICBpZiAoIWhhc0dyb3VwTGF5ZXIpIHtcbiAgICAgIHJldHVybiBzdWJsYXllcnMuc2xpY2UoKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcy5nZXRGbGF0TGF5ZXJzXyhsYXllciwgW10sIHVuZGVmaW5lZCk7XG59O1xuXG5MYXllckhlbHBlci5wcm90b3R5cGUuZ2V0RmxhdExheWVyc18gPSBmdW5jdGlvbiAobGF5ZXIsIGFycmF5LCBjb21wdXRlZE9wYWNpdHkpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB2YXIgb3BhY2l0eSA9IGxheWVyLmdldE9wYWNpdHkoKTtcblxuICBpZiAoY29tcHV0ZWRPcGFjaXR5ICE9PSB1bmRlZmluZWQpIHtcbiAgICBjb21wdXRlZE9wYWNpdHkgKj0gb3BhY2l0eTtcbiAgfSBlbHNlIHtcbiAgICBjb21wdXRlZE9wYWNpdHkgPSBvcGFjaXR5O1xuICB9XG5cbiAgaWYgKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckdyb3VwKSB7XG4gICAgdmFyIHN1YmxheWVycyA9IGxheWVyLmdldExheWVycygpO1xuICAgIHN1YmxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChsKSB7XG4gICAgICBfdGhpcy5nZXRGbGF0TGF5ZXJzXyhsLCBhcnJheSwgY29tcHV0ZWRPcGFjaXR5KTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJMYXllcikge1xuICAgIGlmICghYXJyYXkuaW5jbHVkZXMobGF5ZXIpKSB7XG4gICAgICBsYXllci5zZXQoJ2luaGVyaXRlZE9wYWNpdHknLCBjb21wdXRlZE9wYWNpdHksIHRydWUpO1xuICAgICAgYXJyYXkucHVzaChsYXllcik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGFycmF5O1xufTtcblxuTGF5ZXJIZWxwZXIucHJvdG90eXBlLmdldExheWVyQnlOYW1lID0gZnVuY3Rpb24gKGxheWVyTmFtZSwgbGF5ZXJzKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIHZhciBmb3VuZCA9IG51bGw7XG4gIGxheWVycy5zb21lKGZ1bmN0aW9uIChsYXllcikge1xuICAgIGlmIChsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJHcm91cCkge1xuICAgICAgdmFyIHN1YmxheWVycyA9IGxheWVyLmdldExheWVycygpLmdldEFycmF5KCk7XG4gICAgICBmb3VuZCA9IF90aGlzMi5nZXRMYXllckJ5TmFtZShsYXllck5hbWUsIHN1YmxheWVycyk7XG4gICAgfSBlbHNlIGlmIChsYXllci5nZXQoJ2xheWVyTm9kZU5hbWUnKSA9PT0gbGF5ZXJOYW1lKSB7XG4gICAgICBmb3VuZCA9IGxheWVyO1xuICAgIH1cblxuICAgIHJldHVybiAhIWZvdW5kO1xuICB9KTtcbiAgcmV0dXJuIGZvdW5kO1xufTtcblxuTGF5ZXJIZWxwZXIucHJvdG90eXBlLmdldFdNVFNMZWdlbmRVUkwgPSBmdW5jdGlvbiAobGF5ZXIpIHtcbiAgdmFyIHVybDtcbiAgdmFyIHN0eWxlcyA9IGxheWVyLmdldCgnY2FwYWJpbGl0aWVzU3R5bGVzJyk7XG5cbiAgaWYgKHN0eWxlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIGxlZ2VuZFVSTCA9IHN0eWxlc1swXS5sZWdlbmRVUkw7XG5cbiAgICBpZiAobGVnZW5kVVJMICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHVybCA9IGxlZ2VuZFVSTFswXS5ocmVmO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB1cmw7XG59O1xuXG5MYXllckhlbHBlci5wcm90b3R5cGUuZ2V0V01TTGVnZW5kVVJMID0gZnVuY3Rpb24gKHVybCwgbGF5ZXJOYW1lLCBvcHRfc2NhbGUsIG9wdF9sZWdlbmRSdWxlLCBvcHRfbGVnZW5kV2lkdGgsIG9wdF9sZWdlbmRIZWlnaHQsIG9wdF9zZXJ2ZXJ0eXBlLCBvcHRfZHBpLCBvcHRfYmJveCwgb3B0X3Nycywgb3B0X2FkZGl0aW9uYWxRdWVyeVN0cmluZykge1xuICBpZiAoIXVybCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgcXVlcnlTdHJpbmcgPSB7XG4gICAgRk9STUFUOiAnaW1hZ2UvcG5nJyxcbiAgICBUUkFOU1BBUkVOVDogdHJ1ZSxcbiAgICBTRVJWSUNFOiAnV01TJyxcbiAgICBWRVJTSU9OOiAnMS4xLjEnLFxuICAgIFJFUVVFU1Q6ICdHZXRMZWdlbmRHcmFwaGljJyxcbiAgICBMQVlFUjogbGF5ZXJOYW1lXG4gIH07XG5cbiAgaWYgKG9wdF9zY2FsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcXVlcnlTdHJpbmcuU0NBTEUgPSBvcHRfc2NhbGU7XG4gIH1cblxuICBpZiAob3B0X2xlZ2VuZFJ1bGUgIT09IHVuZGVmaW5lZCkge1xuICAgIHF1ZXJ5U3RyaW5nLlJVTEUgPSBvcHRfbGVnZW5kUnVsZTtcblxuICAgIGlmIChvcHRfbGVnZW5kV2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnlTdHJpbmcuV0lEVEggPSBvcHRfbGVnZW5kV2lkdGg7XG4gICAgfVxuXG4gICAgaWYgKG9wdF9sZWdlbmRIZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnlTdHJpbmcuSEVJR0hUID0gb3B0X2xlZ2VuZEhlaWdodDtcbiAgICB9XG4gIH1cblxuICBpZiAob3B0X3NlcnZlcnR5cGUgPT0gJ3FnaXMnKSB7XG4gICAgaWYgKG9wdF9kcGkgIT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdWVyeVN0cmluZy5EUEkgPSBvcHRfZHBpO1xuICAgIH1cblxuICAgIGlmIChvcHRfYmJveCAhPSB1bmRlZmluZWQgJiYgb3B0X3NycyAhPSB1bmRlZmluZWQgJiYgb3B0X3NjYWxlICE9IHVuZGVmaW5lZCAmJiBvcHRfZHBpICE9IHVuZGVmaW5lZCAmJiBvcHRfbGVnZW5kUnVsZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgIHF1ZXJ5U3RyaW5nLkJCT1ggPSBvcHRfYmJveC5qb2luKCcsJyk7XG4gICAgICBxdWVyeVN0cmluZy5TUlMgPSBvcHRfc3JzO1xuICAgICAgcXVlcnlTdHJpbmcuV0lEVEggPSBNYXRoLnJvdW5kKChvcHRfYmJveFsyXSAtIG9wdF9iYm94WzBdKSAvIG9wdF9zY2FsZSAqIDM5LjM3ICogb3B0X2RwaSk7XG4gICAgICBxdWVyeVN0cmluZy5IRUlHSFQgPSBNYXRoLnJvdW5kKChvcHRfYmJveFszXSAtIG9wdF9iYm94WzFdKSAvIG9wdF9zY2FsZSAqIDM5LjM3ICogb3B0X2RwaSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG9wdF9hZGRpdGlvbmFsUXVlcnlTdHJpbmcpIHtcbiAgICBPYmplY3QuYXNzaWduKHF1ZXJ5U3RyaW5nLCBvcHRfYWRkaXRpb25hbFF1ZXJ5U3RyaW5nKTtcbiAgfVxuXG4gIHJldHVybiBvbFVyaUFwcGVuZFBhcmFtcyh1cmwsIHF1ZXJ5U3RyaW5nKTtcbn07XG5cbkxheWVySGVscGVyLnByb3RvdHlwZS5pc0xheWVyVmlzaWJsZSA9IGZ1bmN0aW9uIChsYXllciwgbWFwKSB7XG4gIGlmICghbGF5ZXIuZ2V0VmlzaWJsZSgpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdmFyIGN1cnJlbnRSZXNvbHV0aW9uID0gbWFwLmdldFZpZXcoKS5nZXRSZXNvbHV0aW9uKCk7XG5cbiAgaWYgKGN1cnJlbnRSZXNvbHV0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVzb2x1dGlvbicpO1xuICB9XG5cbiAgcmV0dXJuIGN1cnJlbnRSZXNvbHV0aW9uID4gbGF5ZXIuZ2V0TWluUmVzb2x1dGlvbigpICYmIGN1cnJlbnRSZXNvbHV0aW9uIDwgbGF5ZXIuZ2V0TWF4UmVzb2x1dGlvbigpO1xufTtcblxuTGF5ZXJIZWxwZXIucHJvdG90eXBlLnJlZnJlc2hXTVNMYXllciA9IGZ1bmN0aW9uIChsYXllcikge1xuICB2YXIgc291cmNlXyA9IGxheWVyLmdldFNvdXJjZSgpO1xuICBjb25zb2xlLmFzc2VydChzb3VyY2VfIGluc3RhbmNlb2Ygb2xTb3VyY2VJbWFnZVdNUyB8fCBzb3VyY2VfIGluc3RhbmNlb2Ygb2xTb3VyY2VUaWxlV01TKTtcbiAgdmFyIHNvdXJjZSA9IHNvdXJjZV87XG4gIHZhciBwYXJhbXMgPSBzb3VyY2UuZ2V0UGFyYW1zKCk7XG4gIHBhcmFtc1tSRUZSRVNIX1BBUkFNXSA9IE1hdGgucmFuZG9tKCk7XG4gIHNvdXJjZS51cGRhdGVQYXJhbXMocGFyYW1zKTtcbn07XG5cbkxheWVySGVscGVyLnByb3RvdHlwZS5zZXRaSW5kZXhUb0ZpcnN0TGV2ZWxDaGlsZHJlbiA9IGZ1bmN0aW9uIChlbGVtZW50LCBaSW5kZXgpIHtcbiAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBvbExheWVyR3JvdXApIHtcbiAgICB2YXIgaW5uZXJHcm91cExheWVycyA9IGVsZW1lbnQuZ2V0TGF5ZXJzKCk7XG4gICAgaW5uZXJHcm91cExheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChpbm5lckxheWVyKSB7XG4gICAgICByZXR1cm4gaW5uZXJMYXllci5zZXRaSW5kZXgoWkluZGV4KTtcbiAgICB9KTtcbiAgfVxufTtcblxuTGF5ZXJIZWxwZXIucHJvdG90eXBlLnVwZGF0ZVdNU0xheWVyU3RhdGUgPSBmdW5jdGlvbiAobGF5ZXIsIG5hbWVzLCBvcHRfdGltZSkge1xuICBpZiAobmFtZXMubGVuZ3RoIDw9IDApIHtcbiAgICBsYXllci5zZXRWaXNpYmxlKGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICBsYXllci5zZXRWaXNpYmxlKHRydWUpO1xuICAgIHZhciBzb3VyY2UgPSBsYXllci5nZXRTb3VyY2UoKTtcblxuICAgIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIG9sU291cmNlSW1hZ2VXTVMpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIHNvdXJjZSB0eXBlJyk7XG4gICAgfVxuXG4gICAgaWYgKG9wdF90aW1lKSB7XG4gICAgICBzb3VyY2UudXBkYXRlUGFyYW1zKHtcbiAgICAgICAgJ0xBWUVSUyc6IG5hbWVzLFxuICAgICAgICAnVElNRSc6IG9wdF90aW1lXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgc291cmNlLnVwZGF0ZVBhcmFtcyh7XG4gICAgICAgICdMQVlFUlMnOiBuYW1lc1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59O1xuXG5MYXllckhlbHBlci5wcm90b3R5cGUuZ2V0UXVlcnlTb3VyY2VJZHMgPSBmdW5jdGlvbiAobGF5ZXIpIHtcbiAgcmV0dXJuIGxheWVyLmdldCgncXVlcnlTb3VyY2VJZHMnKTtcbn07XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0xheWVySGVscGVyJywgW10pO1xubW9kdWxlLnNlcnZpY2UoJ25nZW9MYXllckhlbHBlcicsIExheWVySGVscGVyKTtcbm1vZHVsZS52YWx1ZSgnbmdlb1RpbGVzUHJlbG9hZGluZ0xpbWl0JywgSW5maW5pdHkpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1hcENvbXBvbmVudC4kaW5qZWN0ID0gW1wiJHdpbmRvd1wiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgbGlzdGVuIH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbE1hcCBmcm9tICdvbC9NYXAuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvTWFwJywgW10pO1xuXG5mdW5jdGlvbiBtYXBDb21wb25lbnQoJHdpbmRvdykge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIHZhciBhdHRyID0gJ25nZW9NYXAnO1xuICAgICAgdmFyIHByb3AgPSBhdHRyc1thdHRyXTtcbiAgICAgIHZhciBtYXAgPSBzY29wZS4kZXZhbChwcm9wKTtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KG1hcCBpbnN0YW5jZW9mIG9sTWFwKTtcbiAgICAgIG1hcC5zZXRUYXJnZXQoZWxlbWVudFswXSk7XG4gICAgICB2YXIgbWFuYWdlUmVzaXplQXR0ciA9ICduZ2VvTWFwTWFuYWdlUmVzaXplJztcbiAgICAgIHZhciBtYW5hZ2VSZXNpemVQcm9wID0gYXR0cnNbbWFuYWdlUmVzaXplQXR0cl07XG4gICAgICB2YXIgbWFuYWdlUmVzaXplID0gc2NvcGUuJGV2YWwobWFuYWdlUmVzaXplUHJvcCk7XG5cbiAgICAgIGlmIChtYW5hZ2VSZXNpemUpIHtcbiAgICAgICAgdmFyIHJlc2l6ZVRyYW5zaXRpb25BdHRyID0gJ25nZW9NYXBSZXNpemVUcmFuc2l0aW9uJztcbiAgICAgICAgdmFyIHJlc2l6ZVRyYW5zaXRpb25Qcm9wID0gYXR0cnNbcmVzaXplVHJhbnNpdGlvbkF0dHJdO1xuICAgICAgICB2YXIgcmVzaXplVHJhbnNpdGlvbiA9IHNjb3BlLiRldmFsKHJlc2l6ZVRyYW5zaXRpb25Qcm9wKTtcbiAgICAgICAgbGlzdGVuKCR3aW5kb3csICdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKHJlc2l6ZVRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IERhdGUubm93KCk7XG4gICAgICAgICAgICB2YXIgbG9vcCA9IHRydWU7XG5cbiAgICAgICAgICAgIHZhciBhZGp1c3RTaXplID0gZnVuY3Rpb24gYWRqdXN0U2l6ZSgpIHtcbiAgICAgICAgICAgICAgbWFwLnVwZGF0ZVNpemUoKTtcbiAgICAgICAgICAgICAgbWFwLnJlbmRlclN5bmMoKTtcblxuICAgICAgICAgICAgICBpZiAobG9vcCkge1xuICAgICAgICAgICAgICAgICR3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFkanVzdFNpemUpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydCA+IHJlc2l6ZVRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBsb29wID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGFkanVzdFNpemUoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWFwLnVwZGF0ZVNpemUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb01hcCcsIG1hcENvbXBvbmVudCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb01hcEJhY2tncm91bmRMYXllck1nciBmcm9tICduZ2VvL21hcC9CYWNrZ3JvdW5kTGF5ZXJNZ3IuanMnO1xuaW1wb3J0IG5nZW9NYXBDb21wb25lbnQgZnJvbSAnbmdlby9tYXAvY29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvTWFwRmVhdHVyZU92ZXJsYXlNZ3IgZnJvbSAnbmdlby9tYXAvRmVhdHVyZU92ZXJsYXlNZ3IuanMnO1xuaW1wb3J0IG5nZW9NYXBSZWNlbnRlciBmcm9tICduZ2VvL21hcC9yZWNlbnRlci5qcyc7XG5pbXBvcnQgbmdlb01hcFJlc2l6ZW1hcCBmcm9tICduZ2VvL21hcC9yZXNpemVtYXAuanMnO1xuaW1wb3J0IG5nZW9NYXBTY2FsZXNlbGVjdG9yIGZyb20gJ25nZW8vbWFwL3NjYWxlc2VsZWN0b3IuanMnO1xuZXhwb3J0IGRlZmF1bHQgYW5ndWxhci5tb2R1bGUoJ25nZW9NYXBNb2R1bGUnLCBbbmdlb01hcEJhY2tncm91bmRMYXllck1nci5uYW1lLCBuZ2VvTWFwQ29tcG9uZW50Lm5hbWUsIG5nZW9NYXBGZWF0dXJlT3ZlcmxheU1nci5uYW1lLCBuZ2VvTWFwUmVjZW50ZXIubmFtZSwgbmdlb01hcFJlc2l6ZW1hcC5uYW1lLCBuZ2VvTWFwU2NhbGVzZWxlY3Rvci5uYW1lXSk7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9SZWNlbnRlcicsIFtdKTtcblxuZnVuY3Rpb24gbWFwUmVzZW50ZXJDb21wb25lbnQoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuICAgICAgdmFyIG1hcEV4cHIgPSAkYXR0cnMubmdlb1JlY2VudGVyTWFwO1xuICAgICAgdmFyIG1hcCA9ICRzY29wZS4kZXZhbChtYXBFeHByKTtcblxuICAgICAgZnVuY3Rpb24gcmVjZW50ZXIoZWxlbWVudCkge1xuICAgICAgICB2YXIgZXh0ZW50ID0gZWxlbWVudC5hdHRyKCduZ2VvLWV4dGVudCcpO1xuXG4gICAgICAgIGlmIChleHRlbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHZhciBzaXplID0gbWFwLmdldFNpemUoKTtcblxuICAgICAgICAgIGlmIChzaXplID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBzaXplJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbWFwLmdldFZpZXcoKS5maXQoJHNjb3BlLiRldmFsKGV4dGVudCksIHtcbiAgICAgICAgICAgIHNpemU6IHNpemVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB6b29tID0gZWxlbWVudC5hdHRyKCduZ2VvLXpvb20nKTtcblxuICAgICAgICBpZiAoem9vbSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgbWFwLmdldFZpZXcoKS5zZXRab29tKCRzY29wZS4kZXZhbCh6b29tKSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgJGVsZW1lbnQub24oJ2NsaWNrJywgJyonLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmVjZW50ZXIoYW5ndWxhci5lbGVtZW50KCQodGhpcykpKTtcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgY2UgPSBmdW5jdGlvbiBjZShldmVudCkge1xuICAgICAgICB2YXIgc2VsZWN0ZWQgPSBldmVudC50YXJnZXQub3B0aW9uc1tldmVudC50YXJnZXQuc2VsZWN0ZWRJbmRleF07XG4gICAgICAgIHJlY2VudGVyKGFuZ3VsYXIuZWxlbWVudChzZWxlY3RlZCkpO1xuICAgICAgfTtcblxuICAgICAgJGVsZW1lbnQub24oe1xuICAgICAgICBjaGFuZ2U6IGNlXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9SZWNlbnRlcicsIG1hcFJlc2VudGVyQ29tcG9uZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJtYXBSZXNpemVDb21wb25lbnQuJGluamVjdCA9IFtcIiR3aW5kb3dcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBvbE1hcCBmcm9tICdvbC9NYXAuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvUmVzaXplbWFwJywgW10pO1xuXG5mdW5jdGlvbiBtYXBSZXNpemVDb21wb25lbnQoJHdpbmRvdykge1xuICB2YXIgZHVyYXRpb24gPSAxMDAwO1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIHZhciBhdHRyID0gJ25nZW9SZXNpemVtYXAnO1xuICAgICAgdmFyIHByb3AgPSBhdHRyc1thdHRyXTtcbiAgICAgIHZhciBtYXAgPSBzY29wZS4kZXZhbChwcm9wKTtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KG1hcCBpbnN0YW5jZW9mIG9sTWFwKTtcbiAgICAgIHZhciBzdGF0ZUV4cHIgPSBhdHRycy5uZ2VvUmVzaXplbWFwU3RhdGU7XG4gICAgICBjb25zb2xlLmFzc2VydChzdGF0ZUV4cHIgIT09IHVuZGVmaW5lZCk7XG4gICAgICB2YXIgc3RhcnQ7XG4gICAgICB2YXIgYW5pbWF0aW9uRGVsYXlLZXk7XG5cbiAgICAgIHZhciBhbmltYXRpb25EZWxheSA9IGZ1bmN0aW9uIGFuaW1hdGlvbkRlbGF5KCkge1xuICAgICAgICBtYXAudXBkYXRlU2l6ZSgpO1xuICAgICAgICBtYXAucmVuZGVyU3luYygpO1xuXG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gc3RhcnQgPCBkdXJhdGlvbikge1xuICAgICAgICAgIGFuaW1hdGlvbkRlbGF5S2V5ID0gJHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0aW9uRGVsYXkpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBlbGVtZW50Lm9uKCd0cmFuc2l0aW9uZW5kJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBtYXAudXBkYXRlU2l6ZSgpO1xuICAgICAgICBtYXAucmVuZGVyU3luYygpO1xuICAgICAgfSk7XG4gICAgICBzY29wZS4kd2F0Y2goc3RhdGVFeHByLCBmdW5jdGlvbiAobmV3VmFsLCBvbGRWYWwpIHtcbiAgICAgICAgaWYgKG5ld1ZhbCAhPSBvbGRWYWwpIHtcbiAgICAgICAgICBzdGFydCA9IERhdGUubm93KCk7XG4gICAgICAgICAgJHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZShhbmltYXRpb25EZWxheUtleSk7XG4gICAgICAgICAgYW5pbWF0aW9uRGVsYXlLZXkgPSAkd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRpb25EZWxheSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb1Jlc2l6ZW1hcCcsIG1hcFJlc2l6ZUNvbXBvbmVudCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdiBjbGFzcz1cImJ0bi1ncm91cCBidG4tYmxvY2tcIiBuZy1jbGFzcz1cIjo6e1xcJ2Ryb3B1cFxcJzogc2NhbGVzZWxlY3RvckN0cmwub3B0aW9ucy5kcm9wdXB9XCI+XFxuICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBkcm9wZG93bi10b2dnbGVcIiBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCIgYXJpYS1leHBhbmRlZD1cImZhbHNlXCI+XFxuICAgIDxzcGFuIG5nLWJpbmQtaHRtbD1cInNjYWxlc2VsZWN0b3JDdHJsLmN1cnJlbnRTY2FsZSB8IG5nZW9TY2FsaWZ5IHwgbmdlb1RydXN0SHRtbFwiPjwvc3Bhbj5cXG4gIDwvYnV0dG9uPlxcbiAgPHVsIGNsYXNzPVwiZHJvcGRvd24tbWVudSBidG4tYmxvY2tcIiByb2xlPVwibWVudVwiPlxcbiAgICA8bGkgbmctcmVwZWF0PVwiem9vbUxldmVsIGluIDo6c2NhbGVzZWxlY3RvckN0cmwuem9vbUxldmVsc1wiPlxcbiAgICAgIDxhIGhyZWYgbmctY2xpY2s9XCJzY2FsZXNlbGVjdG9yQ3RybC5jaGFuZ2Vab29tKHpvb21MZXZlbClcIlxcbiAgICAgICAgIG5nLWJpbmQtaHRtbD1cInNjYWxlc2VsZWN0b3JDdHJsLmdldFNjYWxlKHpvb21MZXZlbCkgfCBuZ2VvU2NhbGlmeSB8IG5nZW9UcnVzdEh0bWxcIj5cXG4gICAgICA8L2E+XFxuICAgIDwvbGk+XFxuICA8L3VsPlxcbjwvZGl2Plxcbic7XG5cbn1cbnJldHVybiBfX3Bcbn0iLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IG51bWJlclNhZmVDb21wYXJlRnVuY3Rpb24gfSBmcm9tICdvbC9hcnJheS5qcyc7XG5pbXBvcnQgb2xNYXAgZnJvbSAnb2wvTWFwLmpzJztcbmltcG9ydCB7IGxpc3RlbiwgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvZHJvcGRvd24uanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvU2NhbGVzZWxlY3RvcicsIFtdKTtcbm1vZHVsZS52YWx1ZSgnbmdlb1NjYWxlc2VsZWN0b3JUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uIChlbGVtZW50LCBhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSBhdHRycy5uZ2VvU2NhbGVzZWxlY3RvclRlbXBsYXRldXJsO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ25nZW8vbWFwL3NjYWxlc2VsZWN0b3InO1xufSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ25nZW8vbWFwL3NjYWxlc2VsZWN0b3InLCByZXF1aXJlKCcuL3NjYWxlc2VsZWN0b3IuaHRtbCcpKTtcbn1dKTtcblxudmFyIG1hcFNjYWxlc2VsZWN0b3JDb21wb25lbnQgPSBmdW5jdGlvbiBtYXBTY2FsZXNlbGVjdG9yQ29tcG9uZW50KG5nZW9TY2FsZXNlbGVjdG9yVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHNjb3BlOiB0cnVlLFxuICAgIGNvbnRyb2xsZXI6ICdOZ2VvU2NhbGVzZWxlY3RvckNvbnRyb2xsZXInLFxuICAgIHRlbXBsYXRlVXJsOiBuZ2VvU2NhbGVzZWxlY3RvclRlbXBsYXRlVXJsXG4gIH07XG59O1xuXG5tYXBTY2FsZXNlbGVjdG9yQ29tcG9uZW50LiRpbmplY3QgPSBbXCJuZ2VvU2NhbGVzZWxlY3RvclRlbXBsYXRlVXJsXCJdO1xubWFwU2NhbGVzZWxlY3RvckNvbXBvbmVudC4kaW5qZWN0ID0gW1wibmdlb1NjYWxlc2VsZWN0b3JUZW1wbGF0ZVVybFwiXTtcbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9TY2FsZXNlbGVjdG9yJywgbWFwU2NhbGVzZWxlY3RvckNvbXBvbmVudCk7XG5cbnZhciBTY2FsZXNlbGVjdG9yQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgU2NhbGVzZWxlY3RvckNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCJdO1xuXG4gIGZ1bmN0aW9uIFNjYWxlc2VsZWN0b3JDb250cm9sbGVyKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgc2NhbGVzRXhwciA9ICRhdHRycy5uZ2VvU2NhbGVzZWxlY3RvcjtcbiAgICB0aGlzLnNjYWxlcyA9ICRzY29wZS4kZXZhbChzY2FsZXNFeHByKTtcbiAgICBjb25zb2xlLmFzc2VydCh0aGlzLnNjYWxlcyAhPT0gdW5kZWZpbmVkKTtcbiAgICB0aGlzLnpvb21MZXZlbHMgPSBbXTtcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhfdGhpcy5zY2FsZXMpLmxlbmd0aDtcbiAgICB9LCBmdW5jdGlvbiAobmV3TGVuZ3RoKSB7XG4gICAgICBfdGhpcy56b29tTGV2ZWxzID0gT2JqZWN0LmtleXMoX3RoaXMuc2NhbGVzKS5tYXAoTnVtYmVyKTtcblxuICAgICAgX3RoaXMuem9vbUxldmVscy5zb3J0KG51bWJlclNhZmVDb21wYXJlRnVuY3Rpb24pO1xuICAgIH0pO1xuICAgIHZhciBtYXBFeHByID0gJGF0dHJzLm5nZW9TY2FsZXNlbGVjdG9yTWFwO1xuICAgIHRoaXMubWFwXyA9ICRzY29wZS4kZXZhbChtYXBFeHByKTtcbiAgICBjb25zb2xlLmFzc2VydCh0aGlzLm1hcF8gaW5zdGFuY2VvZiBvbE1hcCk7XG4gICAgdmFyIG9wdGlvbnNFeHByID0gJGF0dHJzLm5nZW9TY2FsZXNlbGVjdG9yT3B0aW9ucztcbiAgICB2YXIgb3B0aW9ucyA9ICRzY29wZS4kZXZhbChvcHRpb25zRXhwcik7XG4gICAgdGhpcy5vcHRpb25zID0gZ2V0T3B0aW9uc18ob3B0aW9ucyk7XG4gICAgdGhpcy4kc2NvcGVfID0gJHNjb3BlO1xuICAgIHRoaXMucmVzb2x1dGlvbkNoYW5nZUtleV8gPSBudWxsO1xuICAgIHRoaXMuY3VycmVudFNjYWxlID0gdW5kZWZpbmVkO1xuICAgIHZhciB2aWV3ID0gdGhpcy5tYXBfLmdldFZpZXcoKTtcblxuICAgIGlmICh2aWV3ICE9PSBudWxsKSB7XG4gICAgICB2YXIgY3VycmVudFpvb20gPSB0aGlzLm1hcF8uZ2V0VmlldygpLmdldFpvb20oKTtcblxuICAgICAgaWYgKGN1cnJlbnRab29tICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50U2NhbGUgPSB0aGlzLmdldFNjYWxlKGN1cnJlbnRab29tKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBsaXN0ZW4odGhpcy5tYXBfLCAnY2hhbmdlOnZpZXcnLCB0aGlzLmhhbmRsZVZpZXdDaGFuZ2VfLCB0aGlzKTtcbiAgICB0aGlzLnJlZ2lzdGVyUmVzb2x1dGlvbkNoYW5nZUxpc3RlbmVyXygpO1xuICAgICRzY29wZS5zY2FsZXNlbGVjdG9yQ3RybCA9IHRoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gU2NhbGVzZWxlY3RvckNvbnRyb2xsZXIucHJvdG90eXBlO1xuXG4gIF9wcm90by5nZXRTY2FsZSA9IGZ1bmN0aW9uIGdldFNjYWxlKHpvb20pIHtcbiAgICByZXR1cm4gdGhpcy5zY2FsZXNbem9vbV07XG4gIH07XG5cbiAgX3Byb3RvLmNoYW5nZVpvb20gPSBmdW5jdGlvbiBjaGFuZ2Vab29tKHpvb20pIHtcbiAgICB0aGlzLm1hcF8uZ2V0VmlldygpLnNldFpvb20oem9vbSk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZVJlc29sdXRpb25DaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlUmVzb2x1dGlvbkNoYW5nZV8oZSkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIHZpZXcgPSB0aGlzLm1hcF8uZ2V0VmlldygpO1xuICAgIHZhciBjdXJyZW50U2NhbGUgPSB0aGlzLnNjYWxlc1t2aWV3LmdldFpvb20oKV07XG5cbiAgICBpZiAoY3VycmVudFNjYWxlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuJHNjb3BlXy4kYXBwbHlBc3luYyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMi5jdXJyZW50U2NhbGUgPSBjdXJyZW50U2NhbGU7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZVZpZXdDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlVmlld0NoYW5nZV8oZSkge1xuICAgIHRoaXMucmVnaXN0ZXJSZXNvbHV0aW9uQ2hhbmdlTGlzdGVuZXJfKCk7XG4gICAgdGhpcy5oYW5kbGVSZXNvbHV0aW9uQ2hhbmdlXyhudWxsKTtcbiAgfTtcblxuICBfcHJvdG8ucmVnaXN0ZXJSZXNvbHV0aW9uQ2hhbmdlTGlzdGVuZXJfID0gZnVuY3Rpb24gcmVnaXN0ZXJSZXNvbHV0aW9uQ2hhbmdlTGlzdGVuZXJfKCkge1xuICAgIGlmICh0aGlzLnJlc29sdXRpb25DaGFuZ2VLZXlfICE9PSBudWxsKSB7XG4gICAgICB1bmxpc3RlbkJ5S2V5KHRoaXMucmVzb2x1dGlvbkNoYW5nZUtleV8pO1xuICAgIH1cblxuICAgIHZhciB2aWV3ID0gdGhpcy5tYXBfLmdldFZpZXcoKTtcbiAgICB0aGlzLnJlc29sdXRpb25DaGFuZ2VLZXlfID0gbGlzdGVuKHZpZXcsICdjaGFuZ2U6cmVzb2x1dGlvbicsIHRoaXMuaGFuZGxlUmVzb2x1dGlvbkNoYW5nZV8sIHRoaXMpO1xuICB9O1xuXG4gIHJldHVybiBTY2FsZXNlbGVjdG9yQ29udHJvbGxlcjtcbn0oKTtcblxuZnVuY3Rpb24gZ2V0T3B0aW9uc18ob3B0aW9ucykge1xuICB2YXIgZHJvcHVwID0gZmFsc2U7XG5cbiAgaWYgKG9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgIGRyb3B1cCA9IG9wdGlvbnMuZHJvcHVwID09IHRydWU7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGRyb3B1cDogZHJvcHVwXG4gIH07XG59XG5cbm1vZHVsZS5jb250cm9sbGVyKCdOZ2VvU2NhbGVzZWxlY3RvckNvbnRyb2xsZXInLCBTY2FsZXNlbGVjdG9yQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdiBjbGFzcz1cIm5nZW8tc3dpcGUtbGluZS1kcmFnZ2FibGVcIj5cXG4gIDxidXR0b24gY2xhc3M9XCJuZ2VvLXN3aXBlLWNsb3NlIGJ0biBwcmltZSBidG4tc21cIiBuZy1jbGljaz1cIiRjdHJsLmRlYWN0aXZhdGUoKVwiPlxcbiAgICA8aSBjbGFzcz1cImZhcyBmYS10aW1lc1wiPjwvaT5cXG4gIDwvYnV0dG9uPlxcbiAgPGRpdiBjbGFzcz1cIm5nZW8tc3dpcGUtbGluZVwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cIm5nZW8tc3dpcGUtYXJyb3dcIj4nICtcbigoX190ID0gKHJlcXVpcmUoJ25nZW8vaWNvbnMvc3dpcGUuc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nPC9kaXY+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgbGlzdGVuLCB1bmxpc3RlbkJ5S2V5IH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBSZW5kZXJFdmVudCBmcm9tICdvbC9yZW5kZXIvRXZlbnQuanMnO1xuaW1wb3J0IFJlc2l6ZU9ic2VydmVyIGZyb20gJ3Jlc2l6ZS1vYnNlcnZlci1wb2x5ZmlsbCc7XG5pbXBvcnQgJ2pxdWVyeS11aS91aS93aWRnZXRzL2RyYWdnYWJsZS5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9NYXBzd2lwZScsIFtdKTtcbm1vZHVsZS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnbmdlby9zcmMvbWFwL3N3aXBlJywgcmVxdWlyZSgnLi9zd2lwZS5odG1sJykpO1xufV0pO1xubW9kdWxlLnZhbHVlKCduZ2VvTWFwc3dpcGVUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uICgkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzLm5nZW9NYXBzd2lwZVRlbXBsYXRlVXJsO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ25nZW8vc3JjL21hcC9zd2lwZSc7XG59KTtcbm5nZW9NYXBzd2lwZVRlbXBsYXRlVXJsLiRpbmplY3QgPSBbXCIkYXR0cnNcIiwgXCJuZ2VvTWFwc3dpcGVUZW1wbGF0ZVVybFwiXTtcblxuZnVuY3Rpb24gbmdlb01hcHN3aXBlVGVtcGxhdGVVcmwoJGF0dHJzLCBuZ2VvTWFwc3dpcGVUZW1wbGF0ZVVybCkge1xuICByZXR1cm4gbmdlb01hcHN3aXBlVGVtcGxhdGVVcmwoJGF0dHJzKTtcbn1cblxudmFyIFN3aXBlQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgU3dpcGVDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRpbmplY3RvclwiXTtcblxuICBmdW5jdGlvbiBTd2lwZUNvbnRyb2xsZXIoJHNjb3BlLCAkZWxlbWVudCwgJGluamVjdG9yKSB7XG4gICAgdGhpcy5tYXA7XG4gICAgdGhpcy5sYXllcjtcbiAgICB0aGlzLnNjb3BlXyA9ICRzY29wZTtcbiAgICB0aGlzLnN3aXBlVmFsdWU7XG4gICAgdGhpcy5kcmFnZ2FibGVFbGVtZW50XyA9ICRlbGVtZW50LmZpbmQoJy5uZ2VvLXN3aXBlLWxpbmUtZHJhZ2dhYmxlJyk7XG4gICAgdGhpcy5sYXllcktleXNfID0gW107XG4gICAgdGhpcy5yZXNpemVPYnNlcnZlcl87XG4gIH1cblxuICB2YXIgX3Byb3RvID0gU3dpcGVDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uJG9uSW5pdCA9IGZ1bmN0aW9uICRvbkluaXQoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHRoaXMuc3dpcGVWYWx1ZSA9IHRoaXMuc3dpcGVWYWx1ZSAhPT0gdW5kZWZpbmVkID8gdGhpcy5zd2lwZVZhbHVlIDogMC41O1xuICAgIHRoaXMubGF5ZXJLZXlzXy5wdXNoKGxpc3Rlbih0aGlzLmxheWVyLCAncHJlcmVuZGVyJywgdGhpcy5oYW5kbGVMYXllclByZXJlbmRlcl8sIHRoaXMpKTtcbiAgICB0aGlzLmxheWVyS2V5c18ucHVzaChsaXN0ZW4odGhpcy5sYXllciwgJ3Bvc3RyZW5kZXInLCB0aGlzLmhhbmRsZUxheWVyUG9zdHJlbmRlcl8sIHRoaXMpKTtcbiAgICB0aGlzLmxheWVyS2V5c18ucHVzaChsaXN0ZW4odGhpcy5sYXllciwgJ2NoYW5nZTp2aXNpYmxlJywgdGhpcy5oYW5kbGVMYXllclZpc2libGVDaGFuZ2VfLCB0aGlzKSk7XG4gICAgdmFyIGhhbGZEcmFnZ2FibGVXaWR0aCA9IHRoaXMuZHJhZ2dhYmxlRWxlbWVudF8ud2lkdGgoKSAvIDI7XG4gICAgdGhpcy5kcmFnZ2FibGVFbGVtZW50Xy5kcmFnZ2FibGUoe1xuICAgICAgYXhpczogJ3gnLFxuICAgICAgY29udGFpbm1lbnQ6ICdwYXJlbnQnLFxuICAgICAgZHJhZzogZnVuY3Rpb24gZHJhZygpIHtcbiAgICAgICAgdmFyIHBhcmVudFdpZHRoID0gX3RoaXMuZHJhZ2dhYmxlRWxlbWVudF8ucGFyZW50KCkud2lkdGgoKTtcblxuICAgICAgICB2YXIgcG9zaXRpb24gPSBfdGhpcy5kcmFnZ2FibGVFbGVtZW50Xy5wb3NpdGlvbigpLmxlZnQgKyBoYWxmRHJhZ2dhYmxlV2lkdGg7XG4gICAgICAgIF90aGlzLnN3aXBlVmFsdWUgPSBwb3NpdGlvbiAvIHBhcmVudFdpZHRoO1xuXG4gICAgICAgIF90aGlzLm1hcC5yZW5kZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLnJlc2l6ZU9ic2VydmVyXyA9IG5ldyBSZXNpemVPYnNlcnZlcihmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgcGFyZW50V2lkdGggPSBfdGhpcy5kcmFnZ2FibGVFbGVtZW50Xy5wYXJlbnQoKS53aWR0aCgpO1xuXG4gICAgICBfdGhpcy5kcmFnZ2FibGVFbGVtZW50Xy5jc3MoJ2xlZnQnLCBwYXJlbnRXaWR0aCAqIF90aGlzLnN3aXBlVmFsdWUgLSBoYWxmRHJhZ2dhYmxlV2lkdGgpO1xuICAgIH0pO1xuICAgIHRoaXMucmVzaXplT2JzZXJ2ZXJfLm9ic2VydmUodGhpcy5kcmFnZ2FibGVFbGVtZW50Xy5wYXJlbnQoKS5nZXQoMCkpO1xuICB9O1xuXG4gIF9wcm90by5kZWFjdGl2YXRlID0gZnVuY3Rpb24gZGVhY3RpdmF0ZSgpIHtcbiAgICB0aGlzLmxheWVyID0gbnVsbDtcbiAgICB0aGlzLm1hcC5yZW5kZXIoKTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlTGF5ZXJQcmVyZW5kZXJfID0gZnVuY3Rpb24gaGFuZGxlTGF5ZXJQcmVyZW5kZXJfKGV2dCkge1xuICAgIGlmICghKGV2dCBpbnN0YW5jZW9mIFJlbmRlckV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBjdHggPSBldnQuY29udGV4dDtcblxuICAgIGlmICghY3R4KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHdpZHRoID0gY3R4LmNhbnZhcy53aWR0aCAqIHRoaXMuc3dpcGVWYWx1ZTtcbiAgICBjdHguc2F2ZSgpO1xuICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICBjdHgucmVjdCgwLCAwLCB3aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpO1xuICAgIGN0eC5jbGlwKCk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUxheWVyUG9zdHJlbmRlcl8gPSBmdW5jdGlvbiBoYW5kbGVMYXllclBvc3RyZW5kZXJfKGV2dCkge1xuICAgIGlmIChldnQgaW5zdGFuY2VvZiBSZW5kZXJFdmVudCkge1xuICAgICAgdmFyIGN0eCA9IGV2dC5jb250ZXh0O1xuXG4gICAgICBpZiAoIWN0eCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5oYW5kbGVMYXllclZpc2libGVDaGFuZ2VfID0gZnVuY3Rpb24gaGFuZGxlTGF5ZXJWaXNpYmxlQ2hhbmdlXygpIHtcbiAgICBpZiAoIXRoaXMubGF5ZXIuZ2V0VmlzaWJsZSgpKSB7XG4gICAgICB0aGlzLmRlYWN0aXZhdGUoKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLiRvbkRlc3Ryb3kgPSBmdW5jdGlvbiAkb25EZXN0cm95KCkge1xuICAgIHRoaXMubGF5ZXJLZXlzXy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgIHRoaXMubGF5ZXJLZXlzXy5sZW5ndGggPSAwO1xuICAgIHRoaXMuZHJhZ2dhYmxlRWxlbWVudF8uZHJhZ2dhYmxlKCdkZXN0cm95Jyk7XG4gICAgdGhpcy5yZXNpemVPYnNlcnZlcl8uZGlzY29ubmVjdCgpO1xuICB9O1xuXG4gIHJldHVybiBTd2lwZUNvbnRyb2xsZXI7XG59KCk7XG5cbm1vZHVsZS5jb21wb25lbnQoJ25nZW9NYXBzd2lwZScsIHtcbiAgY29udHJvbGxlcjogU3dpcGVDb250cm9sbGVyLFxuICBiaW5kaW5nczoge1xuICAgIG1hcDogJzwnLFxuICAgIGxheWVyOiAnPScsXG4gICAgc3dpcGVWYWx1ZTogJz0nXG4gIH0sXG4gIHRlbXBsYXRlVXJsOiBuZ2VvTWFwc3dpcGVUZW1wbGF0ZVVybFxufSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibWVhc3VyZUFyZWFDb21wb25lbnQuJGluamVjdCA9IFtcIiRjb21waWxlXCIsIFwiZ2V0dGV4dENhdGFsb2dcIiwgXCIkZmlsdGVyXCIsIFwiJGluamVjdG9yXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb0RyYXdDb250cm9sbGVyIGZyb20gJ25nZW8vZHJhdy9Db250cm9sbGVyLmpzJztcbmltcG9ydCBuZ2VvR2VvbWV0cnlUeXBlIGZyb20gJ25nZW8vR2VvbWV0cnlUeXBlLmpzJztcbmltcG9ydCBuZ2VvSW50ZXJhY3Rpb25NZWFzdXJlQXJlYSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL01lYXN1cmVBcmVhLmpzJztcbmltcG9ydCB7IGxpc3RlbiB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xTdHlsZVN0eWxlIGZyb20gJ29sL3N0eWxlL1N0eWxlLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb01lYXN1cmVhcmVhJywgW25nZW9EcmF3Q29udHJvbGxlci5uYW1lXSk7XG5cbmZ1bmN0aW9uIG1lYXN1cmVBcmVhQ29tcG9uZW50KCRjb21waWxlLCBnZXR0ZXh0Q2F0YWxvZywgJGZpbHRlciwgJGluamVjdG9yKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICByZXF1aXJlOiAnXl5uZ2VvRHJhd2ZlYXR1cmUnLFxuICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsoJHNjb3BlLCBlbGVtZW50LCBhdHRycywgZHJhd0ZlYXR1cmVDdHJsKSB7XG4gICAgICBpZiAoIWRyYXdGZWF0dXJlQ3RybCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZHJhd0ZlYXR1cmVDdHJsJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBoZWxwTXNnID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdDbGljayB0byBzdGFydCBkcmF3aW5nIHBvbHlnb24nKTtcbiAgICAgIHZhciBjb250TXNnID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdDbGljayB0byBjb250aW51ZSBkcmF3aW5nPGJyPicgKyAnRG91YmxlLWNsaWNrIG9yIGNsaWNrIHN0YXJ0aW5nIHBvaW50IHRvIGZpbmlzaCcpO1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIHN0eWxlOiBuZXcgb2xTdHlsZVN0eWxlKCksXG4gICAgICAgIHN0YXJ0TXNnOiAkY29tcGlsZShcIjxkaXYgdHJhbnNsYXRlPlwiICsgaGVscE1zZyArIFwiPC9kaXY+XCIpKCRzY29wZSlbMF0sXG4gICAgICAgIGNvbnRpbnVlTXNnOiAkY29tcGlsZShcIjxkaXYgdHJhbnNsYXRlPlwiICsgY29udE1zZyArIFwiPC9kaXY+XCIpKCRzY29wZSlbMF1cbiAgICAgIH07XG5cbiAgICAgIGlmICgkaW5qZWN0b3IuaGFzKCduZ2VvTWVhc3VyZVByZWNpc2lvbicpKSB7XG4gICAgICAgIG9wdGlvbnMucHJlY2lzaW9uID0gJGluamVjdG9yLmdldCgnbmdlb01lYXN1cmVQcmVjaXNpb24nKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG1lYXN1cmVBcmVhID0gbmV3IG5nZW9JbnRlcmFjdGlvbk1lYXN1cmVBcmVhKCRmaWx0ZXIoJ25nZW9Vbml0UHJlZml4JyksIGdldHRleHRDYXRhbG9nLCBvcHRpb25zKTtcbiAgICAgIGRyYXdGZWF0dXJlQ3RybC5yZWdpc3RlckludGVyYWN0aW9uKG1lYXN1cmVBcmVhKTtcbiAgICAgIGRyYXdGZWF0dXJlQ3RybC5tZWFzdXJlQXJlYSA9IG1lYXN1cmVBcmVhO1xuICAgICAgbGlzdGVuKG1lYXN1cmVBcmVhLCAnbWVhc3VyZWVuZCcsIGRyYXdGZWF0dXJlQ3RybC5oYW5kbGVEcmF3RW5kLmJpbmQoZHJhd0ZlYXR1cmVDdHJsLCBuZ2VvR2VvbWV0cnlUeXBlLlBPTFlHT04pLCBkcmF3RmVhdHVyZUN0cmwpO1xuICAgICAgbGlzdGVuKG1lYXN1cmVBcmVhLCAnY2hhbmdlOmFjdGl2ZScsIGRyYXdGZWF0dXJlQ3RybC5oYW5kbGVBY3RpdmVDaGFuZ2UsIGRyYXdGZWF0dXJlQ3RybCk7XG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvTWVhc3VyZWFyZWEnLCBtZWFzdXJlQXJlYUNvbXBvbmVudCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibWVhc3VyZUF6aW11dENvbXBvbmVudC4kaW5qZWN0ID0gW1wiJGNvbXBpbGVcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIiRmaWx0ZXJcIiwgXCIkaW5qZWN0b3JcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvRHJhd0NvbnRyb2xsZXIgZnJvbSAnbmdlby9kcmF3L0NvbnRyb2xsZXIuanMnO1xuaW1wb3J0IG5nZW9NaXNjRmlsdGVycyBmcm9tICduZ2VvL21pc2MvZmlsdGVycy5qcyc7XG5pbXBvcnQgbmdlb0dlb21ldHJ5VHlwZSBmcm9tICduZ2VvL0dlb21ldHJ5VHlwZS5qcyc7XG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uTWVhc3VyZUF6aW11dCwgeyBnZXRBemltdXQgfSBmcm9tICduZ2VvL2ludGVyYWN0aW9uL01lYXN1cmVBemltdXQuanMnO1xuaW1wb3J0IHsgbGlzdGVuIH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBmcm9tQ2lyY2xlIH0gZnJvbSAnb2wvZ2VvbS9Qb2x5Z29uLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvTWVhc3VyZWF6aW11dCcsIFtuZ2VvRHJhd0NvbnRyb2xsZXIubmFtZSwgbmdlb01pc2NGaWx0ZXJzLm5hbWVdKTtcblxuZnVuY3Rpb24gbWVhc3VyZUF6aW11dENvbXBvbmVudCgkY29tcGlsZSwgZ2V0dGV4dENhdGFsb2csICRmaWx0ZXIsICRpbmplY3Rvcikge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgcmVxdWlyZTogJ15ebmdlb0RyYXdmZWF0dXJlJyxcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKCRzY29wZSwgZWxlbWVudCwgYXR0cnMsIGRyYXdGZWF0dXJlQ3RybCkge1xuICAgICAgaWYgKCFkcmF3RmVhdHVyZUN0cmwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGRyYXdGZWF0dXJlQ3RybCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgaGVscE1zZyA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQ2xpY2sgdG8gc3RhcnQgZHJhd2luZyBjaXJjbGUnKTtcbiAgICAgIHZhciBjb250TXNnID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdDbGljayB0byBmaW5pc2gnKTtcbiAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBzdHlsZTogbmV3IG9sU3R5bGVTdHlsZSgpLFxuICAgICAgICBzdGFydE1zZzogJGNvbXBpbGUoXCI8ZGl2IHRyYW5zbGF0ZT5cIiArIGhlbHBNc2cgKyBcIjwvZGl2PlwiKSgkc2NvcGUpWzBdLFxuICAgICAgICBjb250aW51ZU1zZzogJGNvbXBpbGUoXCI8ZGl2IHRyYW5zbGF0ZT5cIiArIGNvbnRNc2cgKyBcIjwvZGl2PlwiKSgkc2NvcGUpWzBdXG4gICAgICB9O1xuXG4gICAgICBpZiAoJGluamVjdG9yLmdldCgnbmdlb01lYXN1cmVQcmVjaXNpb24nKSkge1xuICAgICAgICBvcHRpb25zLnByZWNpc2lvbiA9ICRpbmplY3Rvci5nZXQoJ25nZW9NZWFzdXJlUHJlY2lzaW9uJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICgkaW5qZWN0b3IuZ2V0KCduZ2VvTWVhc3VyZURlY2ltYWxzJykpIHtcbiAgICAgICAgb3B0aW9ucy5kZWNpbWFscyA9ICRpbmplY3Rvci5nZXQoJ25nZW9NZWFzdXJlRGVjaW1hbHMnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG1lYXN1cmVBemltdXQgPSBuZXcgbmdlb0ludGVyYWN0aW9uTWVhc3VyZUF6aW11dCgkZmlsdGVyKCduZ2VvVW5pdFByZWZpeCcpLCAkZmlsdGVyKCdudW1iZXInKSwgb3B0aW9ucyk7XG4gICAgICBkcmF3RmVhdHVyZUN0cmwucmVnaXN0ZXJJbnRlcmFjdGlvbihtZWFzdXJlQXppbXV0KTtcbiAgICAgIGRyYXdGZWF0dXJlQ3RybC5tZWFzdXJlQXppbXV0ID0gbWVhc3VyZUF6aW11dDtcbiAgICAgIGxpc3RlbihtZWFzdXJlQXppbXV0LCAnbWVhc3VyZWVuZCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgbXlFdmVudCA9IGV2ZW50O1xuICAgICAgICB2YXIgZ2VvbWV0cnkgPSBteUV2ZW50LmRldGFpbC5mZWF0dXJlLmdldEdlb21ldHJ5KCk7XG4gICAgICAgIHZhciBjaXJjbGUgPSBnZW9tZXRyeS5nZXRHZW9tZXRyaWVzKClbMV07XG4gICAgICAgIHZhciBwb2x5Z29uID0gZnJvbUNpcmNsZShjaXJjbGUsIDY0KTtcbiAgICAgICAgbXlFdmVudC5kZXRhaWwuZmVhdHVyZSA9IG5ldyBvbEZlYXR1cmUocG9seWdvbik7XG4gICAgICAgIHZhciBhemltdXQgPSBnZXRBemltdXQoZ2VvbWV0cnkuZ2V0R2VvbWV0cmllcygpWzBdKTtcbiAgICAgICAgbXlFdmVudC5kZXRhaWwuZmVhdHVyZS5zZXQoJ2F6aW11dCcsIGF6aW11dCk7XG4gICAgICAgIGRyYXdGZWF0dXJlQ3RybC5oYW5kbGVEcmF3RW5kKG5nZW9HZW9tZXRyeVR5cGUuQ0lSQ0xFLCBldmVudCk7XG4gICAgICB9LCBkcmF3RmVhdHVyZUN0cmwpO1xuICAgICAgbGlzdGVuKG1lYXN1cmVBemltdXQsICdjaGFuZ2U6YWN0aXZlJywgZHJhd0ZlYXR1cmVDdHJsLmhhbmRsZUFjdGl2ZUNoYW5nZSwgZHJhd0ZlYXR1cmVDdHJsKTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9NZWFzdXJlYXppbXV0JywgbWVhc3VyZUF6aW11dENvbXBvbmVudCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibWVhc3VyZUxlbmd0aENvbXBvbmVudC4kaW5qZWN0ID0gW1wiJGNvbXBpbGVcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIiRmaWx0ZXJcIiwgXCIkaW5qZWN0b3JcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvRHJhd0NvbnRyb2xsZXIgZnJvbSAnbmdlby9kcmF3L0NvbnRyb2xsZXIuanMnO1xuaW1wb3J0IG5nZW9NaXNjRmlsdGVycyBmcm9tICduZ2VvL21pc2MvZmlsdGVycy5qcyc7XG5pbXBvcnQgbmdlb0dlb21ldHJ5VHlwZSBmcm9tICduZ2VvL0dlb21ldHJ5VHlwZS5qcyc7XG5pbXBvcnQgbmdlb0ludGVyYWN0aW9uTWVhc3VyZUxlbmd0aCBmcm9tICduZ2VvL2ludGVyYWN0aW9uL01lYXN1cmVMZW5ndGguanMnO1xuaW1wb3J0IHsgbGlzdGVuIH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvTWVhc3VyZWxlbmd0aCcsIFtuZ2VvRHJhd0NvbnRyb2xsZXIubmFtZSwgbmdlb01pc2NGaWx0ZXJzLm5hbWVdKTtcblxuZnVuY3Rpb24gbWVhc3VyZUxlbmd0aENvbXBvbmVudCgkY29tcGlsZSwgZ2V0dGV4dENhdGFsb2csICRmaWx0ZXIsICRpbmplY3Rvcikge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgcmVxdWlyZTogJ15ebmdlb0RyYXdmZWF0dXJlJyxcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKCRzY29wZSwgZWxlbWVudCwgYXR0cnMsIGRyYXdGZWF0dXJlQ3RybCkge1xuICAgICAgaWYgKCFkcmF3RmVhdHVyZUN0cmwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGRyYXdGZWF0dXJlQ3RybCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgaGVscE1zZyA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQ2xpY2sgdG8gc3RhcnQgZHJhd2luZyBsaW5lJyk7XG4gICAgICB2YXIgY29udE1zZyA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQ2xpY2sgdG8gY29udGludWUgZHJhd2luZzxicj4nICsgJ0RvdWJsZS1jbGljayBvciBjbGljayBsYXN0IHBvaW50IHRvIGZpbmlzaCcpO1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIHN0eWxlOiBuZXcgb2xTdHlsZVN0eWxlKCksXG4gICAgICAgIHN0YXJ0TXNnOiAkY29tcGlsZShcIjxkaXYgdHJhbnNsYXRlPlwiICsgaGVscE1zZyArIFwiPC9kaXY+XCIpKCRzY29wZSlbMF0sXG4gICAgICAgIGNvbnRpbnVlTXNnOiAkY29tcGlsZShcIjxkaXYgdHJhbnNsYXRlPlwiICsgY29udE1zZyArIFwiPC9kaXY+XCIpKCRzY29wZSlbMF1cbiAgICAgIH07XG5cbiAgICAgIGlmICgkaW5qZWN0b3IuaGFzKCduZ2VvTWVhc3VyZVByZWNpc2lvbicpKSB7XG4gICAgICAgIG9wdGlvbnMucHJlY2lzaW9uID0gJGluamVjdG9yLmdldCgnbmdlb01lYXN1cmVQcmVjaXNpb24nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCRpbmplY3Rvci5oYXMoJ25nZW9TbmFwcGluZ1RvbGVyYW5jZScpKSB7XG4gICAgICAgIG9wdGlvbnMudG9sZXJhbmNlID0gJGluamVjdG9yLmdldCgnbmdlb1NuYXBwaW5nVG9sZXJhbmNlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICgkaW5qZWN0b3IuaGFzKCduZ2VvU25hcHBpbmdTb3VyY2UnKSkge1xuICAgICAgICBvcHRpb25zLnNvdXJjZSA9ICRpbmplY3Rvci5nZXQoJ25nZW9TbmFwcGluZ1NvdXJjZScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbWVhc3VyZUxlbmd0aCA9IG5ldyBuZ2VvSW50ZXJhY3Rpb25NZWFzdXJlTGVuZ3RoKCRmaWx0ZXIoJ25nZW9Vbml0UHJlZml4JyksIGdldHRleHRDYXRhbG9nLCBvcHRpb25zKTtcbiAgICAgIGRyYXdGZWF0dXJlQ3RybC5yZWdpc3RlckludGVyYWN0aW9uKG1lYXN1cmVMZW5ndGgpO1xuICAgICAgZHJhd0ZlYXR1cmVDdHJsLm1lYXN1cmVMZW5ndGggPSBtZWFzdXJlTGVuZ3RoO1xuICAgICAgbGlzdGVuKG1lYXN1cmVMZW5ndGgsICdtZWFzdXJlZW5kJywgZHJhd0ZlYXR1cmVDdHJsLmhhbmRsZURyYXdFbmQuYmluZChkcmF3RmVhdHVyZUN0cmwsIG5nZW9HZW9tZXRyeVR5cGUuTElORV9TVFJJTkcpLCBkcmF3RmVhdHVyZUN0cmwpO1xuICAgICAgbGlzdGVuKG1lYXN1cmVMZW5ndGgsICdjaGFuZ2U6YWN0aXZlJywgZHJhd0ZlYXR1cmVDdHJsLmhhbmRsZUFjdGl2ZUNoYW5nZSwgZHJhd0ZlYXR1cmVDdHJsKTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9NZWFzdXJlbGVuZ3RoJywgbWVhc3VyZUxlbmd0aENvbXBvbmVudCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0ICdib290c3RyYXAvanMvc3JjL2FsZXJ0LmpzJztcbmltcG9ydCBuZ2VvTWVzc2FnZVBvcHVwLCB7IE1lc3NhZ2VQb3B1cCB9IGZyb20gJ25nZW8vbWVzc2FnZS9Qb3B1cC5qcyc7XG5pbXBvcnQgbmdlb01lc3NhZ2VNZXNzYWdlLCB7IE1lc3NhZ2VUeXBlIH0gZnJvbSAnbmdlby9tZXNzYWdlL01lc3NhZ2UuanMnO1xuaW1wb3J0ICduZ2VvL3Nhc3MvZm9udC5zY3NzJztcbmV4cG9ydCB2YXIgTWVzc2FnZURpc2NsYWltZXJTZXJ2aWNlID0gZnVuY3Rpb24gKF9uZ2VvTWVzc2FnZU1lc3NhZ2UpIHtcbiAgTWVzc2FnZURpc2NsYWltZXJTZXJ2aWNlLiRpbmplY3QgPSBbXCIkc2NlXCIsIFwiZ2V0dGV4dENhdGFsb2dcIiwgXCJuZ2VvQ3JlYXRlUG9wdXBcIl07XG5cbiAgX2luaGVyaXRzTG9vc2UoTWVzc2FnZURpc2NsYWltZXJTZXJ2aWNlLCBfbmdlb01lc3NhZ2VNZXNzYWdlKTtcblxuICBmdW5jdGlvbiBNZXNzYWdlRGlzY2xhaW1lclNlcnZpY2UoJHNjZSwgZ2V0dGV4dENhdGFsb2csIG5nZW9DcmVhdGVQb3B1cCkge1xuICAgIHZhciBfdGhpcztcblxuICAgIF90aGlzID0gX25nZW9NZXNzYWdlTWVzc2FnZS5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgX3RoaXMuc2NlXyA9ICRzY2U7XG4gICAgX3RoaXMuZ2V0dGV4dENhdGFsb2dfID0gZ2V0dGV4dENhdGFsb2c7XG4gICAgX3RoaXMuY3JlYXRlUG9wdXBfID0gbmdlb0NyZWF0ZVBvcHVwO1xuICAgIHZhciBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXYgY2xhc3M9XCJuZ2VvLWRpc2NsYWltZXJcIj48L2Rpdj4nKTtcbiAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkuYXBwZW5kKGNvbnRhaW5lcik7XG4gICAgX3RoaXMuY29udGFpbmVyXyA9IGNvbnRhaW5lcjtcbiAgICBfdGhpcy5tZXNzYWdlc18gPSB7fTtcbiAgICBfdGhpcy5tZXNzYWdlc0NvbnN1bWVyQ291bnRfID0ge307XG4gICAgX3RoaXMudWlkc18gPSB7fTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gTWVzc2FnZURpc2NsYWltZXJTZXJ2aWNlLnByb3RvdHlwZTtcblxuICBfcHJvdG8uYWxlcnQgPSBmdW5jdGlvbiBhbGVydChvYmplY3QpIHtcbiAgICB0aGlzLnNob3cob2JqZWN0KTtcbiAgfTtcblxuICBfcHJvdG8uY2xvc2UgPSBmdW5jdGlvbiBjbG9zZShvYmplY3QpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHZhciBtc2dPYmplY3RzID0gdGhpcy5nZXRNZXNzYWdlT2JqZWN0cyhvYmplY3QpO1xuICAgIG1zZ09iamVjdHMuZm9yRWFjaChmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgcmV0dXJuIF90aGlzMi5jbG9zZU1lc3NhZ2VfKG1lc3NhZ2UpO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5zaG93TWVzc2FnZSA9IGZ1bmN0aW9uIHNob3dNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgIHZhciBnZXR0ZXh0Q2F0YWxvZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfO1xuICAgIHZhciB0eXBlID0gbWVzc2FnZS50eXBlO1xuICAgIGNvbnNvbGUuYXNzZXJ0KHR5cGVvZiB0eXBlID09ICdzdHJpbmcnLCAnVHlwZSBzaG91bGQgYmUgc2V0LicpO1xuICAgIHZhciB1aWQgPSB0aGlzLmdldE1lc3NhZ2VVaWRfKG1lc3NhZ2UpO1xuXG4gICAgaWYgKHRoaXMudWlkc19bdWlkXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudWlkc19bdWlkXSA9IHRydWU7XG5cbiAgICBpZiAobWVzc2FnZS5wb3B1cCA9PT0gdHJ1ZSkge1xuICAgICAgdmFyIHBvcHVwID0gdGhpcy5jcmVhdGVQb3B1cF8oKTtcbiAgICAgIHZhciBjb250ZW50ID0gdGhpcy5zY2VfLnRydXN0QXNIdG1sKG1lc3NhZ2UubXNnKTtcbiAgICAgIHBvcHVwLm9wZW4oe1xuICAgICAgICBhdXRvRGVzdHJveTogdHJ1ZSxcbiAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgdGl0bGU6ICcmbmJzcDsnXG4gICAgICB9KTtcbiAgICAgIHBvcHVwLnNjb3BlLiR3YXRjaCgnb3BlbicsIGZ1bmN0aW9uIChuZXdWYWwpIHtcbiAgICAgICAgaWYgKCFuZXdWYWwpIHtcbiAgICAgICAgICBfdGhpczMuY2xvc2VNZXNzYWdlXyhtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICB0aGlzLm1lc3NhZ2VzX1t1aWRdID0gcG9wdXA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBjb21wYXRpYmxlTWVzc2FnZVVpZCA9IHRoaXMuZ2V0Q29tcGF0aWJsZU1lc3NhZ2VVaWRfKG1lc3NhZ2UpO1xuXG4gICAgICBpZiAodGhpcy5tZXNzYWdlc19bY29tcGF0aWJsZU1lc3NhZ2VVaWRdKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZXNDb25zdW1lckNvdW50X1tjb21wYXRpYmxlTWVzc2FnZVVpZF0rKztcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2xhc3NOYW1lcyA9IFsnYWxlcnQnLCAnZmFkZScsICdhbGVydC1kaXNtaXNzaWJsZScsICdzaG93J107XG5cbiAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlIE1lc3NhZ2VUeXBlLkVSUk9SOlxuICAgICAgICAgIGNsYXNzTmFtZXMucHVzaCgnYWxlcnQtZGFuZ2VyJyk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBNZXNzYWdlVHlwZS5JTkZPUk1BVElPTjpcbiAgICAgICAgICBjbGFzc05hbWVzLnB1c2goJ2FsZXJ0LWluZm8nKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIE1lc3NhZ2VUeXBlLlNVQ0NFU1M6XG4gICAgICAgICAgY2xhc3NOYW1lcy5wdXNoKCdhbGVydC1zdWNjZXNzJyk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBNZXNzYWdlVHlwZS5XQVJOSU5HOlxuICAgICAgICAgIGNsYXNzTmFtZXMucHVzaCgnYWxlcnQtd2FybmluZycpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIHZhciBlbCA9IGFuZ3VsYXIuZWxlbWVudChcIjxkaXYgcm9sZT1cXFwiYWxlcnRcXFwiIGNsYXNzPVxcXCJcIiArIGNsYXNzTmFtZXMuam9pbignICcpICsgXCJcXFwiPjwvZGl2PlwiKTtcbiAgICAgIHZhciBidXR0b24gPSBhbmd1bGFyLmVsZW1lbnQoXCI8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgY2xhc3M9XFxcImNsb3NlXFxcIiBkYXRhLWRpc21pc3M9XFxcImFsZXJ0XFxcIiBhcmlhLWxhYmVsPVxcXCJcIiArIGdldHRleHRDYXRhbG9nLmdldFN0cmluZygnQ2xvc2UnKSArIFwiXFxcIj48c3BhbiBhcmlhLWhpZGRlbj1cXFwidHJ1ZVxcXCIgY2xhc3M9XFxcImZhIGZhLXRpbWVzXFxcIj48L3NwYW4+PC9idXR0b24+XCIpO1xuICAgICAgdmFyIG1zZyA9IGFuZ3VsYXIuZWxlbWVudCgnPHNwYW4gLz4nKS5odG1sKG1lc3NhZ2UubXNnKTtcbiAgICAgIGVsLmFwcGVuZChidXR0b24pLmFwcGVuZChtc2cpO1xuICAgICAgdmFyIGNvbnRhaW5lcjtcblxuICAgICAgaWYgKG1lc3NhZ2UudGFyZ2V0KSB7XG4gICAgICAgIGNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChtZXNzYWdlLnRhcmdldCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcl87XG4gICAgICB9XG5cbiAgICAgIGNvbnRhaW5lci5hcHBlbmQoZWwpO1xuICAgICAgZWwuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICAgIGVsLm9uKCdjbG9zZWQuYnMuYWxlcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMy5jbG9zZU1lc3NhZ2VfKG1lc3NhZ2UsIHRydWUpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLm1lc3NhZ2VzX1tjb21wYXRpYmxlTWVzc2FnZVVpZF0gPSBlbDtcbiAgICAgIHRoaXMubWVzc2FnZXNDb25zdW1lckNvdW50X1tjb21wYXRpYmxlTWVzc2FnZVVpZF0gPSAxO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uZ2V0TWVzc2FnZVVpZF8gPSBmdW5jdGlvbiBnZXRNZXNzYWdlVWlkXyhtZXNzYWdlKSB7XG4gICAgcmV0dXJuIG1lc3NhZ2UubXNnICsgXCItXCIgKyBtZXNzYWdlLnR5cGUgKyBcIi1cIiArIG1lc3NhZ2UubGF5ZXJVaWQ7XG4gIH07XG5cbiAgX3Byb3RvLmdldENvbXBhdGlibGVNZXNzYWdlVWlkXyA9IGZ1bmN0aW9uIGdldENvbXBhdGlibGVNZXNzYWdlVWlkXyhtZXNzYWdlKSB7XG4gICAgcmV0dXJuIG1lc3NhZ2UubXNnICsgXCItXCIgKyBtZXNzYWdlLnR5cGU7XG4gIH07XG5cbiAgX3Byb3RvLmNsb3NlTWVzc2FnZV8gPSBmdW5jdGlvbiBjbG9zZU1lc3NhZ2VfKG1lc3NhZ2UsIGZvcmNlKSB7XG4gICAgaWYgKGZvcmNlID09PSB2b2lkIDApIHtcbiAgICAgIGZvcmNlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIHVpZCA9IHRoaXMuZ2V0TWVzc2FnZVVpZF8obWVzc2FnZSk7XG5cbiAgICBpZiAoIXRoaXMudWlkc19bdWlkXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRlbGV0ZSB0aGlzLnVpZHNfW3VpZF07XG4gICAgdmFyIGNvbXBhdGlibGVNZXNzYWdlVWlkID0gdGhpcy5nZXRDb21wYXRpYmxlTWVzc2FnZVVpZF8obWVzc2FnZSk7XG5cbiAgICBpZiAoZm9yY2UpIHtcbiAgICAgIHRoaXMubWVzc2FnZXNDb25zdW1lckNvdW50X1tjb21wYXRpYmxlTWVzc2FnZVVpZF0gPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1lc3NhZ2VzQ29uc3VtZXJDb3VudF9bY29tcGF0aWJsZU1lc3NhZ2VVaWRdLS07XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubWVzc2FnZXNDb25zdW1lckNvdW50X1tjb21wYXRpYmxlTWVzc2FnZVVpZF0gPiAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG9iaiA9IHRoaXMubWVzc2FnZXNfW2NvbXBhdGlibGVNZXNzYWdlVWlkXTtcblxuICAgIGlmIChvYmogaW5zdGFuY2VvZiBNZXNzYWdlUG9wdXApIHtcbiAgICAgIHZhciBtcE9iaiA9IG9iajtcblxuICAgICAgaWYgKG1wT2JqLmdldE9wZW4oKSkge1xuICAgICAgICBtcE9iai5zZXRPcGVuKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGpxdWVyeU9iaiA9IG9iajtcblxuICAgICAgaWYgKGpxdWVyeU9iai5oYXNDbGFzcygnc2hvdycpKSB7XG4gICAgICAgIGpxdWVyeU9iai5hbGVydCgnY2xvc2UnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkZWxldGUgdGhpcy5tZXNzYWdlc19bY29tcGF0aWJsZU1lc3NhZ2VVaWRdO1xuICAgIGRlbGV0ZSB0aGlzLm1lc3NhZ2VzQ29uc3VtZXJDb3VudF9bY29tcGF0aWJsZU1lc3NhZ2VVaWRdO1xuICB9O1xuXG4gIHJldHVybiBNZXNzYWdlRGlzY2xhaW1lclNlcnZpY2U7XG59KG5nZW9NZXNzYWdlTWVzc2FnZSk7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9EaXNjbGFpbWVyJywgW25nZW9NZXNzYWdlUG9wdXAubmFtZV0pO1xubW9kdWxlLnNlcnZpY2UoJ25nZW9EaXNjbGFpbWVyJywgTWVzc2FnZURpc2NsYWltZXJTZXJ2aWNlKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJleHBvcnQgdmFyIE1lc3NhZ2VUeXBlID0ge1xuICBFUlJPUjogJ2Vycm9yJyxcbiAgSU5GT1JNQVRJT046ICdpbmZvcm1hdGlvbicsXG4gIFNVQ0NFU1M6ICdzdWNjZXNzJyxcbiAgV0FSTklORzogJ3dhcm5pbmcnXG59O1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIF9kZWZhdWx0KCkge31cblxuICB2YXIgX3Byb3RvID0gX2RlZmF1bHQucHJvdG90eXBlO1xuXG4gIF9wcm90by5zaG93TWVzc2FnZSA9IGZ1bmN0aW9uIHNob3dNZXNzYWdlKG1lc3NhZ2UpIHt9O1xuXG4gIF9wcm90by5zaG93ID0gZnVuY3Rpb24gc2hvdyhvYmplY3QpIHtcbiAgICB2YXIgbXNnT2JqZWN0cyA9IHRoaXMuZ2V0TWVzc2FnZU9iamVjdHMob2JqZWN0KTtcbiAgICBtc2dPYmplY3RzLmZvckVhY2godGhpcy5zaG93TWVzc2FnZSwgdGhpcyk7XG4gIH07XG5cbiAgX3Byb3RvLmVycm9yID0gZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkge1xuICAgIHRoaXMuc2hvdyh0aGlzLmdldE1lc3NhZ2VPYmplY3RzKG1lc3NhZ2UsIE1lc3NhZ2VUeXBlLkVSUk9SKSk7XG4gIH07XG5cbiAgX3Byb3RvLmluZm8gPSBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UpIHtcbiAgICB0aGlzLnNob3codGhpcy5nZXRNZXNzYWdlT2JqZWN0cyhtZXNzYWdlLCBNZXNzYWdlVHlwZS5JTkZPUk1BVElPTikpO1xuICB9O1xuXG4gIF9wcm90by5zdWNjZXNzID0gZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlKSB7XG4gICAgdGhpcy5zaG93KHRoaXMuZ2V0TWVzc2FnZU9iamVjdHMobWVzc2FnZSwgTWVzc2FnZVR5cGUuU1VDQ0VTUykpO1xuICB9O1xuXG4gIF9wcm90by53YXJuID0gZnVuY3Rpb24gd2FybihtZXNzYWdlKSB7XG4gICAgdGhpcy5zaG93KHRoaXMuZ2V0TWVzc2FnZU9iamVjdHMobWVzc2FnZSwgTWVzc2FnZVR5cGUuV0FSTklORykpO1xuICB9O1xuXG4gIF9wcm90by5nZXRNZXNzYWdlT2JqZWN0cyA9IGZ1bmN0aW9uIGdldE1lc3NhZ2VPYmplY3RzKG9iamVjdCwgb3B0X3R5cGUpIHtcbiAgICB2YXIgbXNnT2JqZWN0cyA9IFtdO1xuICAgIHZhciBkZWZhdWx0VHlwZSA9IE1lc3NhZ2VUeXBlLklORk9STUFUSU9OO1xuXG4gICAgaWYgKHR5cGVvZiBvYmplY3QgPT09ICdzdHJpbmcnKSB7XG4gICAgICBtc2dPYmplY3RzLnB1c2goe1xuICAgICAgICBtc2c6IG9iamVjdCxcbiAgICAgICAgdHlwZTogb3B0X3R5cGUgIT09IHVuZGVmaW5lZCA/IG9wdF90eXBlIDogZGVmYXVsdFR5cGVcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShvYmplY3QpKSB7XG4gICAgICBvYmplY3QuZm9yRWFjaChmdW5jdGlvbiAobXNnKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygb2JqZWN0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIG1zZ09iamVjdHMucHVzaCh7XG4gICAgICAgICAgICBtc2c6IG1zZyxcbiAgICAgICAgICAgIHR5cGU6IG9wdF90eXBlICE9PSB1bmRlZmluZWQgPyBvcHRfdHlwZSA6IGRlZmF1bHRUeXBlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBtc2cgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgbXNnIHR5cGUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0X3R5cGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbXNnLnR5cGUgPSBvcHRfdHlwZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBtc2dPYmplY3RzLnB1c2gobXNnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBtc2dPYmplY3QgPSBvYmplY3Q7XG5cbiAgICAgIGlmIChvcHRfdHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG1zZ09iamVjdC50eXBlID0gb3B0X3R5cGU7XG4gICAgICB9XG5cbiAgICAgIGlmIChtc2dPYmplY3QudHlwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG1zZ09iamVjdC50eXBlID0gZGVmYXVsdFR5cGU7XG4gICAgICB9XG5cbiAgICAgIG1zZ09iamVjdHMucHVzaChtc2dPYmplY3QpO1xuICAgIH1cblxuICAgIHJldHVybiBtc2dPYmplY3RzO1xuICB9O1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0oKTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCAnYm9vdHN0cmFwL2pzL3NyYy9hbGVydC5qcyc7XG5pbXBvcnQgbmdlb01lc3NhZ2VNZXNzYWdlLCB7IE1lc3NhZ2VUeXBlIH0gZnJvbSAnbmdlby9tZXNzYWdlL01lc3NhZ2UuanMnO1xuaW1wb3J0IHsgZ2V0VWlkIGFzIG9sVXRpbEdldFVpZCB9IGZyb20gJ29sL3V0aWwuanMnO1xudmFyIERFRkFVTFRfREVMQVkgPSA3MDAwO1xuZXhwb3J0IHZhciBNZXNzYWdlTm90aWZpY2F0aW9uID0gZnVuY3Rpb24gKF9uZ2VvTWVzc2FnZU1lc3NhZ2UpIHtcbiAgTWVzc2FnZU5vdGlmaWNhdGlvbi4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIl07XG5cbiAgX2luaGVyaXRzTG9vc2UoTWVzc2FnZU5vdGlmaWNhdGlvbiwgX25nZW9NZXNzYWdlTWVzc2FnZSk7XG5cbiAgZnVuY3Rpb24gTWVzc2FnZU5vdGlmaWNhdGlvbigkdGltZW91dCkge1xuICAgIHZhciBfdGhpcztcblxuICAgIF90aGlzID0gX25nZW9NZXNzYWdlTWVzc2FnZS5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgX3RoaXMudGltZW91dF8gPSAkdGltZW91dDtcbiAgICB2YXIgY29udGFpbmVyID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2IGNsYXNzPVwibmdlby1ub3RpZmljYXRpb25cIj48L2Rpdj4nKTtcbiAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkuYXBwZW5kKGNvbnRhaW5lcik7XG4gICAgX3RoaXMuY29udGFpbmVyXyA9IGNvbnRhaW5lcjtcbiAgICBfdGhpcy5jYWNoZV8gPSB7fTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gTWVzc2FnZU5vdGlmaWNhdGlvbi5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLm5vdGlmeSA9IGZ1bmN0aW9uIG5vdGlmeShvYmplY3QpIHtcbiAgICB0aGlzLnNob3cob2JqZWN0KTtcbiAgfTtcblxuICBfcHJvdG8uY2xlYXIgPSBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICBmb3IgKHZhciB1aWQgaW4gdGhpcy5jYWNoZV8pIHtcbiAgICAgIHRoaXMuY2xlYXJNZXNzYWdlQnlDYWNoZUl0ZW1fKHRoaXMuY2FjaGVfW3BhcnNlSW50KHVpZCwgMTApXSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5zaG93TWVzc2FnZSA9IGZ1bmN0aW9uIHNob3dNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHZhciB0eXBlID0gbWVzc2FnZS50eXBlO1xuICAgIGNvbnNvbGUuYXNzZXJ0KHR5cGVvZiB0eXBlID09ICdzdHJpbmcnLCAnVHlwZSBzaG91bGQgYmUgc2V0LicpO1xuICAgIHZhciBjbGFzc05hbWVzID0gWydhbGVydCcsICdmYWRlJywgJ3Nob3cnXTtcblxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSBNZXNzYWdlVHlwZS5FUlJPUjpcbiAgICAgICAgY2xhc3NOYW1lcy5wdXNoKCdhbGVydC1kYW5nZXInKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgTWVzc2FnZVR5cGUuSU5GT1JNQVRJT046XG4gICAgICAgIGNsYXNzTmFtZXMucHVzaCgnYWxlcnQtaW5mbycpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBNZXNzYWdlVHlwZS5TVUNDRVNTOlxuICAgICAgICBjbGFzc05hbWVzLnB1c2goJ2FsZXJ0LXN1Y2Nlc3MnKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgTWVzc2FnZVR5cGUuV0FSTklORzpcbiAgICAgICAgY2xhc3NOYW1lcy5wdXNoKCdhbGVydC13YXJuaW5nJyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICB2YXIgZWwgPSBhbmd1bGFyLmVsZW1lbnQoXCI8ZGl2IGNsYXNzPVxcXCJcIiArIGNsYXNzTmFtZXMuam9pbignICcpICsgXCJcXFwiPjwvZGl2PlwiKTtcbiAgICB2YXIgY29udGFpbmVyO1xuXG4gICAgaWYgKG1lc3NhZ2UudGFyZ2V0KSB7XG4gICAgICBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQobWVzc2FnZS50YXJnZXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcl87XG4gICAgfVxuXG4gICAgY29udGFpbmVyLmFwcGVuZChlbCk7XG4gICAgZWwuaHRtbChtZXNzYWdlLm1zZykuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICB2YXIgZGVsYXkgPSBtZXNzYWdlLmRlbGF5ICE9PSB1bmRlZmluZWQgPyBtZXNzYWdlLmRlbGF5IDogREVGQVVMVF9ERUxBWTtcbiAgICB2YXIgaXRlbSA9IHtcbiAgICAgIGVsOiBlbFxuICAgIH07XG4gICAgdmFyIHVpZCA9IG9sVXRpbEdldFVpZChlbCk7XG4gICAgaXRlbS5wcm9taXNlID0gdGhpcy50aW1lb3V0XyhmdW5jdGlvbiAoKSB7XG4gICAgICBlbC5hbGVydCgnY2xvc2UnKTtcbiAgICAgIGRlbGV0ZSBfdGhpczIuY2FjaGVfW3VpZF07XG4gICAgfSwgZGVsYXkpO1xuICAgIHRoaXMuY2FjaGVfW3VpZF0gPSBpdGVtO1xuICB9O1xuXG4gIF9wcm90by5jbGVhck1lc3NhZ2VCeUNhY2hlSXRlbV8gPSBmdW5jdGlvbiBjbGVhck1lc3NhZ2VCeUNhY2hlSXRlbV8oaXRlbSkge1xuICAgIHZhciBlbCA9IGl0ZW0uZWw7XG4gICAgdmFyIHByb21pc2UgPSBpdGVtLnByb21pc2U7XG4gICAgdmFyIHVpZCA9IG9sVXRpbEdldFVpZChlbCk7XG4gICAgZWwuYWxlcnQoJ2Nsb3NlJyk7XG4gICAgdGhpcy50aW1lb3V0Xy5jYW5jZWwocHJvbWlzZSk7XG4gICAgZGVsZXRlIHRoaXMuY2FjaGVfW3VpZF07XG4gIH07XG5cbiAgcmV0dXJuIE1lc3NhZ2VOb3RpZmljYXRpb247XG59KG5nZW9NZXNzYWdlTWVzc2FnZSk7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9Ob3RpZmljYXRpb24nLCBbXSk7XG5tb2R1bGUuc2VydmljZSgnbmdlb05vdGlmaWNhdGlvbicsIE1lc3NhZ2VOb3RpZmljYXRpb24pO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIkZhY3RvcnkuJGluamVjdCA9IFtcIiRjb21waWxlXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRzY2VcIiwgXCIkdGltZW91dFwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9NZXNzYWdlUG9wdXBDb21wb25lbnQgZnJvbSAnbmdlby9tZXNzYWdlL3BvcHVwQ29tcG9uZW50LmpzJztcbmV4cG9ydCBmdW5jdGlvbiBNZXNzYWdlUG9wdXAoJGNvbXBpbGUsICRyb290U2NvcGUsICRzY2UsICR0aW1lb3V0KSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgdGhpcy5zY29wZSA9ICRyb290U2NvcGUuJG5ldyh0cnVlKTtcbiAgdGhpcy5zY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBfdGhpcy5zY29wZS5vcGVuO1xuICB9LCBmdW5jdGlvbiAob3Blbikge1xuICAgIGlmICghb3BlbiAmJiBfdGhpcy5hdXRvRGVzdHJveV8pIHtcbiAgICAgIF90aGlzLnRpbWVvdXRfKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMuZGVzdHJveSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbiAgdGhpcy5zY2VfID0gJHNjZTtcbiAgdGhpcy50aW1lb3V0XyA9ICR0aW1lb3V0O1xuICB0aGlzLmVsZW1lbnRfID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2IG5nZW8tcG9wdXA+PC9kaXY+Jyk7XG4gIHRoaXMuYXV0b0Rlc3Ryb3lfID0gZmFsc2U7XG4gICRjb21waWxlKHRoaXMuZWxlbWVudF8pKHRoaXMuc2NvcGUpO1xuICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkuYXBwZW5kKHRoaXMuZWxlbWVudF8pO1xufVxuXG5NZXNzYWdlUG9wdXAucHJvdG90eXBlLmdldE9wZW4gPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLnNjb3BlLm9wZW47XG59O1xuXG5NZXNzYWdlUG9wdXAucHJvdG90eXBlLnNldE9wZW4gPSBmdW5jdGlvbiAob3Blbikge1xuICB0aGlzLnNjb3BlLm9wZW4gPSBvcGVuO1xufTtcblxuTWVzc2FnZVBvcHVwLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnNjb3BlLiRkZXN0cm95KCk7XG4gIHRoaXMuZWxlbWVudF8ucmVtb3ZlKCk7XG59O1xuXG5NZXNzYWdlUG9wdXAucHJvdG90eXBlLnNldFRpdGxlID0gZnVuY3Rpb24gKHRpdGxlKSB7XG4gIHZhciB0cnVzdGVkVGl0bGUgPSB0aGlzLnNjZV8udHJ1c3RBc0h0bWwodGl0bGUpO1xuICB0aGlzLnNjb3BlLnRpdGxlID0gdHJ1c3RlZFRpdGxlO1xufTtcblxuTWVzc2FnZVBvcHVwLnByb3RvdHlwZS5zZXRDb250ZW50ID0gZnVuY3Rpb24gKGNvbnRlbnQsIG9wdF90cnVzdGVkKSB7XG4gIHRoaXMuc2NvcGUuY29udGVudCA9IG9wdF90cnVzdGVkID8gdGhpcy5zY2VfLnRydXN0QXNIdG1sKGNvbnRlbnQpIDogY29udGVudDtcbn07XG5cbk1lc3NhZ2VQb3B1cC5wcm90b3R5cGUuc2V0VXJsID0gZnVuY3Rpb24gKHVybCkge1xuICB2YXIgY29udGVudCA9IHRoaXMuc2NlXy50cnVzdEFzSHRtbChcIjxpZnJhbWUgc3JjPVxcXCJcIiArIHVybCArIFwiXFxcIiB3aWR0aD1cXFwiMTAwJVxcXCIgaGVpZ2h0PVxcXCIxMDAlXFxcIj48L2lmcmFtZT5cIik7XG4gIHRoaXMuc2V0Q29udGVudChjb250ZW50KTtcbn07XG5cbk1lc3NhZ2VQb3B1cC5wcm90b3R5cGUuc2V0V2lkdGggPSBmdW5jdGlvbiAod2lkdGgpIHtcbiAgdGhpcy5lbGVtZW50Xy53aWR0aCh3aWR0aCk7XG59O1xuXG5NZXNzYWdlUG9wdXAucHJvdG90eXBlLnNldEhlaWdodCA9IGZ1bmN0aW9uIChoZWlnaHQpIHtcbiAgdGhpcy5lbGVtZW50Xy5oZWlnaHQoaGVpZ2h0KTtcbn07XG5cbk1lc3NhZ2VQb3B1cC5wcm90b3R5cGUuc2V0U2l6ZSA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG4gIHRoaXMuc2V0V2lkdGgod2lkdGgpO1xuICB0aGlzLnNldEhlaWdodChoZWlnaHQpO1xufTtcblxuTWVzc2FnZVBvcHVwLnByb3RvdHlwZS5zZXRBdXRvRGVzdHJveSA9IGZ1bmN0aW9uIChhdXRvRGVzdHJveSkge1xuICB0aGlzLmF1dG9EZXN0cm95XyA9IGF1dG9EZXN0cm95O1xufTtcblxuTWVzc2FnZVBvcHVwLnByb3RvdHlwZS5hZGRDbGFzcyA9IGZ1bmN0aW9uIChjbHMpIHtcbiAgdGhpcy5lbGVtZW50Xy5hZGRDbGFzcyhjbHMpO1xufTtcblxuTWVzc2FnZVBvcHVwLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgaWYgKG9wdGlvbnMudXJsKSB7XG4gICAgdGhpcy5zZXRVcmwob3B0aW9ucy51cmwpO1xuICB9IGVsc2UgaWYgKG9wdGlvbnMuY29udGVudCkge1xuICAgIHRoaXMuc2V0Q29udGVudChvcHRpb25zLmNvbnRlbnQpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUuYXNzZXJ0KGZhbHNlLCAnbmdlby5tZXNzYWdlLlBvcHVwIG9wdGlvbnMgcmVxdWlyZXN0IFwidXJsXCIgb3IgXCJjb250ZW50XCIuJyk7XG4gIH1cblxuICBpZiAob3B0aW9ucy5hdXRvRGVzdHJveSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5zZXRBdXRvRGVzdHJveShvcHRpb25zLmF1dG9EZXN0cm95KTtcbiAgfVxuXG4gIGlmIChvcHRpb25zLmNscyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5hZGRDbGFzcyhvcHRpb25zLmNscyk7XG4gIH1cblxuICBpZiAob3B0aW9ucy5oZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuc2V0SGVpZ2h0KG9wdGlvbnMuaGVpZ2h0KTtcbiAgfVxuXG4gIGlmIChvcHRpb25zLnRpdGxlICE9PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzLnNldFRpdGxlKG9wdGlvbnMudGl0bGUpO1xuICB9XG5cbiAgaWYgKG9wdGlvbnMud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuc2V0V2lkdGgob3B0aW9ucy53aWR0aCk7XG4gIH1cblxuICB0aGlzLnNldE9wZW4odHJ1ZSk7XG59O1xuXG5mdW5jdGlvbiBGYWN0b3J5KCRjb21waWxlLCAkcm9vdFNjb3BlLCAkc2NlLCAkdGltZW91dCkge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgTWVzc2FnZVBvcHVwKCRjb21waWxlLCAkcm9vdFNjb3BlLCAkc2NlLCAkdGltZW91dCk7XG4gIH07XG59XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0NyZWF0ZVBvcHVwJywgW25nZW9NZXNzYWdlUG9wdXBDb21wb25lbnQubmFtZV0pO1xubW9kdWxlLmZhY3RvcnkoJ25nZW9DcmVhdGVQb3B1cCcsIEZhY3RvcnkpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXZcXG4gIGNsYXNzPVwibmdlby1kaXNwbGF5d2luZG93XCJcXG4gIG5nLXNob3c9XCIkY3RybC5vcGVuXCJcXG4gIHRpdGxlPVwiXCJcXG4+XFxuXFxuICA8ZGl2IGNsYXNzPVwid2luZG93Y29udGFpbmVyXCIgbmctc3R5bGU9XCIkY3RybC5zdHlsZVwiPlxcblxcbiAgICA8YnV0dG9uXFxuICAgICAgdHlwZT1cImJ1dHRvblwiXFxuICAgICAgY2xhc3M9XCJidG4gZmEtdGltZXMgY2xvc2VcIlxcbiAgICAgIG5nLWNsaWNrPVwiJGN0cmwuY2xvc2UoKVwiPlxcbiAgICA8L2J1dHRvbj5cXG5cXG4gICAgPGRpdiBjbGFzcz1cImFuaW1hdGlvbi1jb250YWluZXJcIj5cXG4gICAgICA8ZGl2IGNsYXNzPVwic2xpZGUtYW5pbWF0aW9uIFwiPlxcbiAgICAgICAgPGRpdlxcbiAgICAgICAgICBjbGFzcz1cImhlYWRlciB1aS1kcmFnZ2FibGUtaGFuZGxlXCJcXG4gICAgICAgICAgbmctaWY9XCIkY3RybC50aXRsZSAhPT0gbnVsbFwiPlxcbiAgICAgICAgICA8cCBjbGFzcz1cInRpdGxlXCI+e3skY3RybC50aXRsZSB8IHRyYW5zbGF0ZX19PC9wPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2XFxuICAgICAgICAgIGNsYXNzPVwiZGV0YWlscyBjb250ZW50XCJcXG4gICAgICAgICAgbmctaWY9XCIkY3RybC5jb250ZW50XCJcXG4gICAgICAgICAgbmctYmluZC1odG1sPVwiJGN0cmwuY29udGVudFwiPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2XFxuICAgICAgICAgIGNsYXNzPVwiZGV0YWlscyBpZnJhbWVcIlxcbiAgICAgICAgICBuZy1pZj1cIiRjdHJsLnVybCAhPT0gbnVsbFwiPlxcbiAgICAgICAgICA8aWZyYW1lXFxuICAgICAgICAgICAgZnJhbWVib3JkZXI9XCIwXCJcXG4gICAgICAgICAgICB0eXBlPVwidGV4dC9odG1sXCJcXG4gICAgICAgICAgICBoZWlnaHQ9XCIxMDAlXCJcXG4gICAgICAgICAgICB3aWR0aD1cIjEwMCVcIlxcbiAgICAgICAgICAgIG5nLXNyYz1cInt7ICRjdHJsLnVybFRydXN0ZWQgfX1cIj48L2lmcmFtZT5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRlbnQtdGVtcGxhdGUtY29udGFpbmVyXCI+PC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcblxcbiAgPC9kaXY+XFxuXFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgJ25nZW8vc2Fzcy9mb250LnNjc3MnO1xuaW1wb3J0ICdqcXVlcnktdWkvdWkvd2lkZ2V0cy9yZXNpemFibGUuanMnO1xuaW1wb3J0ICdqcXVlcnktdWkvdWkvd2lkZ2V0cy9kcmFnZ2FibGUuanMnO1xuaW1wb3J0ICduZ2VvL3Nhc3MvanF1ZXJ5LXVpLnNjc3MnO1xuaW1wb3J0ICdhbmd1bGFyLXNhbml0aXplJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb01lc3NhZ2VEaXNwbGF5d2luZG93Q29tcG9uZW50JywgWyduZ1Nhbml0aXplJ10pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCduZ2VvL21lc3NhZ2UvZGlzcGxheXdpbmRvd0NvbXBvbmVudCcsIHJlcXVpcmUoJy4vZGlzcGxheXdpbmRvd0NvbXBvbmVudC5odG1sJykpO1xufV0pO1xubW9kdWxlLnZhbHVlKCduZ2VvTWVzc2FnZURpc3BsYXl3aW5kb3dUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uICgkYXR0cnMpIHtcbiAgdmFyIHRlbXBsYXRlVXJsID0gJGF0dHJzWyduZ2VvTWVzc2FnZURpc3BsYXl3aW5kb3dUZW1wbGF0ZVVybCddO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ25nZW8vbWVzc2FnZS9kaXNwbGF5d2luZG93Q29tcG9uZW50Jztcbn0pO1xubmdlb01lc3NhZ2VEaXNwbGF5d2luZG93VGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRhdHRyc1wiLCBcIm5nZW9NZXNzYWdlRGlzcGxheXdpbmRvd1RlbXBsYXRlVXJsXCJdO1xuXG5mdW5jdGlvbiBuZ2VvTWVzc2FnZURpc3BsYXl3aW5kb3dUZW1wbGF0ZVVybCgkYXR0cnMsIG5nZW9NZXNzYWdlRGlzcGxheXdpbmRvd1RlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBuZ2VvTWVzc2FnZURpc3BsYXl3aW5kb3dUZW1wbGF0ZVVybCgkYXR0cnMpO1xufVxuXG52YXIgQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIiwgXCIkc2NlXCIsIFwiJHNjb3BlXCIsIFwiJGNvbXBpbGVcIl07XG5cbiAgZnVuY3Rpb24gQ29udHJvbGxlcigkZWxlbWVudCwgJHNjZSwgJHNjb3BlLCAkY29tcGlsZSkge1xuICAgIHRoaXMuY2xlYXJPbkNsb3NlID0gZmFsc2U7XG4gICAgdGhpcy5jb250ZW50ID0gbnVsbDtcbiAgICB0aGlzLmNvbnRlbnRUZW1wbGF0ZSA9IG51bGw7XG4gICAgdGhpcy5jb250ZW50U2NvcGUgPSBudWxsO1xuICAgIHRoaXMuZHJhZ2dhYmxlID0gZmFsc2U7XG4gICAgdGhpcy5kcmFnZ2FibGVDb250YWlubWVudCA9ICcnO1xuICAgIHRoaXMuZGVza3RvcCA9IGZhbHNlO1xuICAgIHRoaXMuaGVpZ2h0ID0gJyc7XG4gICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgdGhpcy5yZXNpemFibGUgPSBmYWxzZTtcbiAgICB0aGlzLnRpdGxlID0gbnVsbDtcbiAgICB0aGlzLnVybCA9IG51bGw7XG4gICAgdGhpcy53aWR0aCA9ICcnO1xuICAgIHRoaXMuZWxlbWVudF8gPSAkZWxlbWVudDtcbiAgICB0aGlzLnNjZV8gPSAkc2NlO1xuICAgIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICAgIHRoaXMuY29tcGlsZV8gPSAkY29tcGlsZTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uJG9uSW5pdCA9IGZ1bmN0aW9uICRvbkluaXQoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHRoaXMuY2xlYXJPbkNsb3NlID0gdGhpcy5jbGVhck9uQ2xvc2UgIT09IGZhbHNlO1xuICAgIHRoaXMuY29udGVudCA9IHRoaXMuY29udGVudCB8fCBudWxsO1xuICAgIHRoaXMuY29udGVudFRlbXBsYXRlID0gdGhpcy5jb250ZW50VGVtcGxhdGUgfHwgbnVsbDtcbiAgICB0aGlzLmNvbnRlbnRTY29wZSA9IHRoaXMuY29udGVudFNjb3BlIHx8IG51bGw7XG4gICAgdGhpcy5kZXNrdG9wID0gdGhpcy5kZXNrdG9wICE9PSBmYWxzZTtcbiAgICB0aGlzLmRyYWdnYWJsZUNvbnRhaW5tZW50ID0gdGhpcy5kcmFnZ2FibGVDb250YWlubWVudCB8fCAnZG9jdW1lbnQnO1xuICAgIHRoaXMub3BlbiA9IHRoaXMub3BlbiA9PT0gdHJ1ZTtcbiAgICB0aGlzLmhlaWdodCA9IHRoaXMuaGVpZ2h0IHx8ICcyNDBweCc7XG4gICAgdGhpcy53aWR0aCA9IHRoaXMud2lkdGggfHwgJzI0MHB4JztcbiAgICB0aGlzLmRyYWdnYWJsZSA9IHRoaXMuZHJhZ2dhYmxlICE9PSB1bmRlZmluZWQgPyB0aGlzLmRyYWdnYWJsZSA6IHRoaXMuZGVza3RvcDtcbiAgICB0aGlzLnJlc2l6YWJsZSA9IHRoaXMucmVzaXphYmxlICE9PSB1bmRlZmluZWQgPyB0aGlzLnJlc2l6YWJsZSA6IHRoaXMuZGVza3RvcDtcblxuICAgIGlmICh0aGlzLmRyYWdnYWJsZSkge1xuICAgICAgdGhpcy5lbGVtZW50Xy5maW5kKCcubmdlby1kaXNwbGF5d2luZG93IC53aW5kb3djb250YWluZXInKS5kcmFnZ2FibGUoe1xuICAgICAgICAnY29udGFpbm1lbnQnOiB0aGlzLmRyYWdnYWJsZUNvbnRhaW5tZW50LFxuICAgICAgICAnaGFuZGxlJzogJ2Rpdi5oZWFkZXInXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5yZXNpemFibGUpIHtcbiAgICAgIHRoaXMuZWxlbWVudF8uZmluZCgnLm5nZW8tZGlzcGxheXdpbmRvdyAud2luZG93Y29udGFpbmVyJykucmVzaXphYmxlKHtcbiAgICAgICAgJ21pbkhlaWdodCc6IDI0MCxcbiAgICAgICAgJ21pbldpZHRoJzogMjQwXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb250ZW50VGVtcGxhdGUpIHtcbiAgICAgIHRoaXMudXBkYXRlQ29udGVudFRlbXBsYXRlXygpO1xuICAgIH1cblxuICAgIHRoaXMuc2NvcGVfLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMuY29udGVudFRlbXBsYXRlO1xuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy51cGRhdGVDb250ZW50VGVtcGxhdGVfKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLnVwZGF0ZUNvbnRlbnRUZW1wbGF0ZV8gPSBmdW5jdGlvbiB1cGRhdGVDb250ZW50VGVtcGxhdGVfKCkge1xuICAgIGlmICghdGhpcy5jb250ZW50VGVtcGxhdGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgc2NvcGUgPSB0aGlzLmNvbnRlbnRTY29wZSB8fCB0aGlzLnNjb3BlXztcbiAgICB2YXIgY29tcGlsZWQgPSB0aGlzLmNvbXBpbGVfKHRoaXMuY29udGVudFRlbXBsYXRlKShzY29wZSk7XG4gICAgdmFyIGRpc3BsYXlXaW5kb3cgPSB0aGlzLmVsZW1lbnRfLmZpbmQoJy5uZ2VvLWRpc3BsYXl3aW5kb3cgLndpbmRvd2NvbnRhaW5lciAuYW5pbWF0aW9uLWNvbnRhaW5lciAuY29udGVudC10ZW1wbGF0ZS1jb250YWluZXInKTtcbiAgICBkaXNwbGF5V2luZG93LmVtcHR5KCk7XG4gICAgZGlzcGxheVdpbmRvdy5hcHBlbmQoY29tcGlsZWQpO1xuICB9O1xuXG4gIF9wcm90by5jbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMuY2xlYXJPbkNsb3NlKSB7XG4gICAgICB0aGlzLmNsZWFyXygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uY2xlYXJfID0gZnVuY3Rpb24gY2xlYXJfKCkge1xuICAgIHRoaXMuY29udGVudCA9IG51bGw7XG4gICAgdGhpcy50aXRsZSA9IG51bGw7XG4gICAgdGhpcy51cmwgPSBudWxsO1xuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhDb250cm9sbGVyLCBbe1xuICAgIGtleTogXCJzdHlsZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCxcbiAgICAgICAgd2lkdGg6IHRoaXMud2lkdGhcbiAgICAgIH07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInVybFRydXN0ZWRcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIGlmICh0aGlzLnVybCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2VfLnRydXN0QXNSZXNvdXJjZVVybCh0aGlzLnVybCk7XG4gICAgICB9XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIENvbnRyb2xsZXI7XG59KCk7XG5cbnZhciBuZ2VvTWVzc2FnZURpc3BsYXl3aW5kb3dDb21wb25lbnQgPSB7XG4gIGJpbmRpbmdzOiB7XG4gICAgJ2NsZWFyT25DbG9zZSc6ICc8PycsXG4gICAgJ2NvbnRlbnQnOiAnPT8nLFxuICAgICdjb250ZW50VGVtcGxhdGUnOiAnPT8nLFxuICAgICdjb250ZW50U2NvcGUnOiAnPD8nLFxuICAgICdkZXNrdG9wJzogJzw/JyxcbiAgICAnZHJhZ2dhYmxlJzogJzw/JyxcbiAgICAnZHJhZ2dhYmxlQ29udGFpbm1lbnQnOiAnPD8nLFxuICAgICdoZWlnaHQnOiAnPT8nLFxuICAgICdvcGVuJzogJz0/JyxcbiAgICAncmVzaXphYmxlJzogJzw/JyxcbiAgICAndGl0bGUnOiAnPT8nLFxuICAgICd1cmwnOiAnPT8nLFxuICAgICd3aWR0aCc6ICc9PydcbiAgfSxcbiAgY29udHJvbGxlcjogQ29udHJvbGxlcixcbiAgdGVtcGxhdGVVcmw6IG5nZW9NZXNzYWdlRGlzcGxheXdpbmRvd1RlbXBsYXRlVXJsXG59O1xubW9kdWxlLmNvbXBvbmVudCgnbmdlb0Rpc3BsYXl3aW5kb3cnLCBuZ2VvTWVzc2FnZURpc3BsYXl3aW5kb3dDb21wb25lbnQpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0ICdqcXVlcnktdWkvdWkvd2lkZ2V0cy9kcmFnZ2FibGUuanMnO1xuaW1wb3J0ICduZ2VvL3Nhc3MvanF1ZXJ5LXVpLnNjc3MnO1xuaW1wb3J0ICdib290c3RyYXAvanMvc3JjL21vZGFsLmpzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb01vZGFsJywgW10pO1xudmFyIG1lc3NhZ2VNb2RhbENvbXBvbmVudCA9IHtcbiAgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwibW9kYWwgZmFkZVxcXCIgdGFiaW5kZXg9XFxcIi0xXFxcIiByb2xlPVxcXCJkaWFsb2dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJtb2RhbC1kaWFsb2dcXFwiPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcIm1vZGFsLWNvbnRlbnRcXFwiPlxcbiAgICAgICAgPG5nLXRyYW5zY2x1ZGU+PC9uZy10cmFuc2NsdWRlPlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gIDwvZGl2PlwiLFxuICByZXF1aXJlOiB7XG4gICAgJ25nTW9kZWwnOiAnbmdNb2RlbCdcbiAgfSxcbiAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgY29udHJvbGxlcjogJ25nZW9Nb2RhbENvbnRyb2xsZXInLFxuICBiaW5kaW5nczoge1xuICAgICdkcmFnZ2FibGVIYW5kbGUnOiAnPT9uZ2VvZHJhZ2dhYmxlSGFuZGxlJyxcbiAgICAncmVzaXphYmxlJzogJzxuZ2VvTW9kYWxSZXNpemFibGUnLFxuICAgICdjbG9zYWJsZSc6ICc8bmdlb01vZGFsQ2xvc2FibGUnXG4gIH1cbn07XG5tb2R1bGUuY29tcG9uZW50KCduZ2VvTW9kYWwnLCBtZXNzYWdlTW9kYWxDb21wb25lbnQpO1xuXG52YXIgQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIl07XG5cbiAgZnVuY3Rpb24gQ29udHJvbGxlcigkc2NvcGUsICRlbGVtZW50KSB7XG4gICAgdGhpcy4kZWxlbWVudF8gPSAkZWxlbWVudDtcbiAgICB0aGlzLiRzY29wZV8gPSAkc2NvcGU7XG4gICAgdGhpcy5tb2RhbF8gPSBudWxsO1xuICAgIHRoaXMuZHJhZ2dhYmxlSGFuZGxlID0gJyc7XG4gICAgdGhpcy5jbG9zYWJsZSA9IGZhbHNlO1xuICAgIHRoaXMucmVzaXphYmxlID0gZmFsc2U7XG4gICAgdGhpcy5uZ01vZGVsID0gbnVsbDtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBDb250cm9sbGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uJG9uSW5pdCA9IGZ1bmN0aW9uICRvbkluaXQoKSB7XG4gICAgdGhpcy5jbG9zYWJsZSA9IHRoaXMuY2xvc2FibGUgIT09IGZhbHNlO1xuICAgIHRoaXMucmVzaXphYmxlID0gISF0aGlzLnJlc2l6YWJsZTtcbiAgICB0aGlzLmRyYWdnYWJsZUhhbmRsZSA9IHRoaXMuZHJhZ2dhYmxlSGFuZGxlIHx8ICcudWktZHJhZ2dhYmxlLWhhbmRsZSc7XG4gIH07XG5cbiAgX3Byb3RvLiRwb3N0TGluayA9IGZ1bmN0aW9uICRwb3N0TGluaygpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdGhpcy5tb2RhbF8gPSB0aGlzLiRlbGVtZW50Xy5jaGlsZHJlbigpO1xuXG4gICAgaWYgKCF0aGlzLmNsb3NhYmxlKSB7XG4gICAgICB0aGlzLm1vZGFsXy5hdHRyKCdkYXRhLWtleWJvYXJkJywgJ2ZhbHNlJyk7XG4gICAgICB0aGlzLm1vZGFsXy5hdHRyKCdkYXRhLWJhY2tkcm9wJywgJ3N0YXRpYycpO1xuICAgIH1cblxuICAgIHZhciBkaWFsb2cgPSB0aGlzLm1vZGFsXy5maW5kKCcubW9kYWwtZGlhbG9nJyk7XG4gICAgZGlhbG9nLmRyYWdnYWJsZSh7XG4gICAgICBoYW5kbGU6IHRoaXMuZHJhZ2dhYmxlSGFuZGxlXG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5yZXNpemFibGUpIHtcbiAgICAgIGRpYWxvZy5yZXNpemFibGUoKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMubmdNb2RlbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1vZGVsJyk7XG4gICAgfVxuXG4gICAgdGhpcy5uZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIV90aGlzLm5nTW9kZWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1vZGVsJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghX3RoaXMubW9kYWxfKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtb2RhbCcpO1xuICAgICAgfVxuXG4gICAgICBfdGhpcy5tb2RhbF8ubW9kYWwoX3RoaXMubmdNb2RlbC4kdmlld1ZhbHVlID8gJ3Nob3cnIDogJ2hpZGUnKTtcbiAgICB9O1xuXG4gICAgdGhpcy5tb2RhbF8ub24oJ3Nob3duLmJzLm1vZGFsIGhpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoIV90aGlzLm5nTW9kZWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1vZGVsJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciB0eXBlID0gZS50eXBlO1xuICAgICAgY29uc29sZS5hc3NlcnQodHlwZSA9PSAnc2hvd24nIHx8IHR5cGUgPT0gJ2hpZGRlbicpO1xuXG4gICAgICBfdGhpcy5uZ01vZGVsLiRzZXRWaWV3VmFsdWUodHlwZSA9PSAnc2hvd24nKTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uJG9uRGVzdHJveSA9IGZ1bmN0aW9uICRvbkRlc3Ryb3koKSB7XG4gICAgaWYgKCF0aGlzLm1vZGFsXykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1vZGFsJyk7XG4gICAgfVxuXG4gICAgdGhpcy5tb2RhbF8ubW9kYWwoJ2hpZGUnKTtcbiAgICB2YXIgZGlhbG9nID0gdGhpcy5tb2RhbF8uZmluZCgnLm1vZGFsLWRpYWxvZycpO1xuICAgIGRpYWxvZy5kcmFnZ2FibGUoJ2Rlc3Ryb3knKTtcblxuICAgIGlmICh0aGlzLnJlc2l6YWJsZSkge1xuICAgICAgZGlhbG9nLnJlc2l6YWJsZSgnZGVzdHJveScpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gQ29udHJvbGxlcjtcbn0oKTtcblxubW9kdWxlLmNvbnRyb2xsZXIoJ25nZW9Nb2RhbENvbnRyb2xsZXInLCBDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJQb3BvdmVyQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvdG9vbHRpcC5qcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9qcy9zcmMvcG9wb3Zlci5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9Qb3BvdmVyJywgW10pO1xuXG5mdW5jdGlvbiBtZXNzYWdlUG9wb3ZlckNvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHNjb3BlOiB0cnVlLFxuICAgIGNvbnRyb2xsZXI6ICdOZ2VvUG9wb3ZlckNvbnRyb2xsZXIgYXMgcG9wb3ZlckN0cmwnLFxuICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0sIGF0dHJzLCBuZ2VvUG9wb3ZlckN0cmwpIHtcbiAgICAgIGlmICghbmdlb1BvcG92ZXJDdHJsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBuZ2VvUG9wb3ZlckN0cmwnKTtcbiAgICAgIH1cblxuICAgICAgbmdlb1BvcG92ZXJDdHJsLmFuY2hvckVsbS5vbignaW5zZXJ0ZWQuYnMucG9wb3ZlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbmdlb1BvcG92ZXJDdHJsLmJvZHlFbG0uc2hvdygpO1xuICAgICAgICBuZ2VvUG9wb3ZlckN0cmwuc2hvd24gPSB0cnVlO1xuICAgICAgfSk7XG4gICAgICBuZ2VvUG9wb3ZlckN0cmwuYW5jaG9yRWxtLnBvcG92ZXIoe1xuICAgICAgICBjb250YWluZXI6ICdib2R5JyxcbiAgICAgICAgaHRtbDogdHJ1ZSxcbiAgICAgICAgY29udGVudDogbmdlb1BvcG92ZXJDdHJsLmJvZHlFbG0sXG4gICAgICAgIGJvdW5kYXJ5OiAndmlld3BvcnQnLFxuICAgICAgICBwbGFjZW1lbnQ6IGF0dHJzWyduZ2VvUG9wb3ZlclBsYWNlbWVudCddIHx8ICdyaWdodCdcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoYXR0cnNbJ25nZW9Qb3BvdmVyRGlzbWlzcyddKSB7XG4gICAgICAgICQoYXR0cnNbJ25nZW9Qb3BvdmVyRGlzbWlzcyddKS5vbignc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIG5nZW9Qb3BvdmVyQ3RybC5kaXNtaXNzUG9wb3ZlcigpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbmdlb1BvcG92ZXJDdHJsLmFuY2hvckVsbS5wb3BvdmVyKCdkaXNwb3NlJyk7XG4gICAgICAgIG5nZW9Qb3BvdmVyQ3RybC5hbmNob3JFbG0udW5iaW5kKCdpbnNlcnRlZC5icy5wb3BvdmVyJyk7XG4gICAgICAgIG5nZW9Qb3BvdmVyQ3RybC5hbmNob3JFbG0udW5iaW5kKCdoaWRkZW4uYnMucG9wb3ZlcicpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBtZXNzYWdlUG9wb3ZlckFuY2hvckNvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHJlcXVpcmU6ICdeXm5nZW9Qb3BvdmVyJyxcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtLCBhdHRycywgbmdlb1BvcG92ZXJDdHJsKSB7XG4gICAgICBpZiAoIW5nZW9Qb3BvdmVyQ3RybCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgbmdlb1BvcG92ZXJDdHJsJyk7XG4gICAgICB9XG5cbiAgICAgIG5nZW9Qb3BvdmVyQ3RybC5hbmNob3JFbG0gPSBlbGVtO1xuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gbWVzc2FnZVBvcG92ZXJDb250ZW50Q29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgcmVxdWlyZTogJ15ebmdlb1BvcG92ZXInLFxuICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0sIGF0dHJzLCBuZ2VvUG9wb3ZlckN0cmwpIHtcbiAgICAgIGlmICghbmdlb1BvcG92ZXJDdHJsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBuZ2VvUG9wb3ZlckN0cmwnKTtcbiAgICAgIH1cblxuICAgICAgbmdlb1BvcG92ZXJDdHJsLmJvZHlFbG0gPSBlbGVtO1xuICAgICAgZWxlbS5oaWRlKCk7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBQb3BvdmVyQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB0aGlzLnNob3duID0gZmFsc2U7XG4gIHRoaXMuYW5jaG9yRWxtID0gbnVsbDtcbiAgdGhpcy5ib2R5RWxtID0gbnVsbDtcblxuICB2YXIgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gY2xpY2tIYW5kbGVyKGNsaWNrRXZlbnQpIHtcbiAgICBpZiAoIV90aGlzLmFuY2hvckVsbSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGFuY2hvckVsbScpO1xuICAgIH1cblxuICAgIGlmICghX3RoaXMuYm9keUVsbSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGJvZHlFbG0nKTtcbiAgICB9XG5cbiAgICBpZiAoX3RoaXMuYW5jaG9yRWxtWzBdICE9PSBjbGlja0V2ZW50LnRhcmdldCAmJiBfdGhpcy5ib2R5RWxtLnBhcmVudCgpWzBdICE9PSBjbGlja0V2ZW50LnRhcmdldCAmJiBfdGhpcy5ib2R5RWxtLnBhcmVudCgpLmZpbmQoY2xpY2tFdmVudC50YXJnZXQpLmxlbmd0aCA9PT0gMCAmJiBfdGhpcy5zaG93bikge1xuICAgICAgX3RoaXMuZGlzbWlzc1BvcG92ZXIoKTtcbiAgICB9XG4gIH07XG5cbiAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XG4gICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja0hhbmRsZXIpO1xuICB9KTtcbn1cblxuUG9wb3ZlckNvbnRyb2xsZXIucHJvdG90eXBlLmRpc21pc3NQb3BvdmVyID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMuYW5jaG9yRWxtKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGFuY2hvckVsbScpO1xuICB9XG5cbiAgdGhpcy5zaG93biA9IGZhbHNlO1xuICB0aGlzLmFuY2hvckVsbS5wb3BvdmVyKCdoaWRlJyk7XG59O1xuXG5tb2R1bGUuY29udHJvbGxlcignTmdlb1BvcG92ZXJDb250cm9sbGVyJywgUG9wb3ZlckNvbnRyb2xsZXIpO1xubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb1BvcG92ZXInLCBtZXNzYWdlUG9wb3ZlckNvbXBvbmVudCk7XG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvUG9wb3ZlckFuY2hvcicsIG1lc3NhZ2VQb3BvdmVyQW5jaG9yQ29tcG9uZW50KTtcbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9Qb3BvdmVyQ29udGVudCcsIG1lc3NhZ2VQb3BvdmVyQ29udGVudENvbXBvbmVudCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibWVzc2FnZVBvcG9wQ29tcG9uZW50LiRpbmplY3QgPSBbXCJuZ2VvUG9wdXBUZW1wbGF0ZVVybFwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0ICdhbmd1bGFyLXNhbml0aXplJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb1BvcHVwJywgWyduZ1Nhbml0aXplJ10pO1xubW9kdWxlLnZhbHVlKCduZ2VvUG9wdXBUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uIChlbGVtZW50LCBhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSBhdHRyc1snbmdlb1BvcHVwVGVtcGxhdGV1cmwnXTtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICduZ2VvL21lc3NhZ2UvcG9wdXBjb21wb25lbnQnO1xufSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ25nZW8vbWVzc2FnZS9wb3B1cGNvbXBvbmVudCcsIHJlcXVpcmUoJy4vcG9wdXBjb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcblxuZnVuY3Rpb24gbWVzc2FnZVBvcG9wQ29tcG9uZW50KG5nZW9Qb3B1cFRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICB0ZW1wbGF0ZVVybDogbmdlb1BvcHVwVGVtcGxhdGVVcmwsXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ3BvcG92ZXInKTtcblxuICAgICAgc2NvcGVbJ2Nsb3NlJ10gPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgIGlmIChldnQpIHtcbiAgICAgICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgIH07XG5cbiAgICAgIHNjb3BlLiR3YXRjaCgnb3BlbicsIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xuICAgICAgICBlbGVtZW50LmNzcygnZGlzcGxheScsIG5ld1ZhbCA/ICdibG9jaycgOiAnbm9uZScpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvUG9wdXAnLCBtZXNzYWdlUG9wb3BDb21wb25lbnQpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxoNCBjbGFzcz1cInBvcG92ZXItdGl0bGUgbmdlby1wb3B1cC10aXRsZVwiPlxcbiAgPHNwYW4gbmctYmluZC1odG1sPVwidGl0bGVcIj48L3NwYW4+XFxuICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgbmctY2xpY2s9XCJvcGVuID0gZmFsc2VcIj4gJnRpbWVzOzwvYnV0dG9uPlxcbjwvaDQ+XFxuPGRpdiBjbGFzcz1cInBvcG92ZXItYm9keVwiIG5nLWJpbmQtaHRtbD1cImNvbnRlbnRcIj48L2Rpdj5cXG4nO1xuXG59XG5yZXR1cm4gX19wXG59IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgKiBhcyBvbFByb2ogZnJvbSAnb2wvcHJvai5qcyc7XG5pbXBvcnQgKiBhcyBvbEV4dGVudCBmcm9tICdvbC9leHRlbnQuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIEF1dG9Qcm9qZWN0aW9uU2VydmljZSgpIHt9XG5cbkF1dG9Qcm9qZWN0aW9uU2VydmljZS5wcm90b3R5cGUuc3RyaW5nVG9Db29yZGluYXRlcyA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgdmFyIGNvb3JkcyA9IHN0ci5tYXRjaCgvKFtcXGRcXC4nXSspW1xccyxdKyhbXFxkXFwuJ10rKS8pO1xuXG4gIGlmIChjb29yZHMpIHtcbiAgICB2YXIgeCA9IHBhcnNlRmxvYXQoY29vcmRzWzFdLnJlcGxhY2UoJ1xcJycsICcnKSk7XG4gICAgdmFyIHkgPSBwYXJzZUZsb2F0KGNvb3Jkc1syXS5yZXBsYWNlKCdcXCcnLCAnJykpO1xuXG4gICAgaWYgKCFpc05hTih4KSAmJiAhaXNOYU4oeSkpIHtcbiAgICAgIHJldHVybiBbeCwgeV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59O1xuXG5BdXRvUHJvamVjdGlvblNlcnZpY2UucHJvdG90eXBlLmdldFByb2plY3Rpb25MaXN0ID0gZnVuY3Rpb24gKHByb2plY3Rpb25zQ29kZXMpIHtcbiAgdmFyIGNvZGUsIHByb2o7XG4gIHZhciBwcm9qZWN0aW9ucyA9IFtdO1xuICBwcm9qZWN0aW9uc0NvZGVzLmZvckVhY2goZnVuY3Rpb24gKHByb2plY3Rpb24pIHtcbiAgICBjb2RlID0gcHJvamVjdGlvbi50b1VwcGVyQ2FzZSgpO1xuXG4gICAgaWYgKGNvZGUuc3Vic3RyKDAsIDUpICE9ICdFUFNHOicpIHtcbiAgICAgIGNvZGUgPSBcIkVQU0c6XCIgKyBjb2RlO1xuICAgIH1cblxuICAgIHByb2ogPSBvbFByb2ouZ2V0KGNvZGUpO1xuXG4gICAgaWYgKHByb2ogIT09IG51bGwpIHtcbiAgICAgIHByb2plY3Rpb25zLnB1c2gocHJvaik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUaGUgcHJvamVjdGlvbiBcIiArIGNvZGUgKyBcIiBpcyBub3QgZGVmaW5lZCBpbiBvbC5wcm9qLlwiKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcHJvamVjdGlvbnM7XG59O1xuXG5BdXRvUHJvamVjdGlvblNlcnZpY2UucHJvdG90eXBlLnRyeVByb2plY3Rpb25zID0gZnVuY3Rpb24gKGNvb3JkaW5hdGVzLCBleHRlbnQsIHZpZXdQcm9qZWN0aW9uLCBvcHRfcHJvamVjdGlvbnMpIHtcbiAgdmFyIHBvc2l0aW9uID0gbnVsbDtcblxuICBpZiAob3B0X3Byb2plY3Rpb25zID09PSB1bmRlZmluZWQpIHtcbiAgICBvcHRfcHJvamVjdGlvbnMgPSBbdmlld1Byb2plY3Rpb25dO1xuICB9XG5cbiAgb3B0X3Byb2plY3Rpb25zLnNvbWUoZnVuY3Rpb24gKHByb2plY3Rpb24pIHtcbiAgICB0cnkge1xuICAgICAgcG9zaXRpb24gPSBvbFByb2oudHJhbnNmb3JtKGNvb3JkaW5hdGVzLCBwcm9qZWN0aW9uLCB2aWV3UHJvamVjdGlvbik7XG5cbiAgICAgIGlmIChvbEV4dGVudC5jb250YWluc0Nvb3JkaW5hdGUoZXh0ZW50LCBwb3NpdGlvbikpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge31cblxuICAgIHBvc2l0aW9uID0gbnVsbDtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuICByZXR1cm4gcG9zaXRpb247XG59O1xuXG5BdXRvUHJvamVjdGlvblNlcnZpY2UucHJvdG90eXBlLnRyeVByb2plY3Rpb25zV2l0aEludmVyc2lvbiA9IGZ1bmN0aW9uIChjb29yZGluYXRlcywgZXh0ZW50LCB2aWV3UHJvamVjdGlvbiwgb3B0X3Byb2plY3Rpb25zKSB7XG4gIHZhciBwb3NpdGlvbiA9IHRoaXMudHJ5UHJvamVjdGlvbnMoY29vcmRpbmF0ZXMsIGV4dGVudCwgdmlld1Byb2plY3Rpb24sIG9wdF9wcm9qZWN0aW9ucyk7XG5cbiAgaWYgKHBvc2l0aW9uID09PSBudWxsKSB7XG4gICAgcG9zaXRpb24gPSB0aGlzLnRyeVByb2plY3Rpb25zKGNvb3JkaW5hdGVzLnJldmVyc2UoKSwgZXh0ZW50LCB2aWV3UHJvamVjdGlvbiwgb3B0X3Byb2plY3Rpb25zKTtcbiAgfVxuXG4gIHJldHVybiBwb3NpdGlvbjtcbn07XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0F1dG9Qcm9qZWN0aW9uJywgW10pO1xubW9kdWxlLnNlcnZpY2UoJ25nZW9BdXRvUHJvamVjdGlvbicsIEF1dG9Qcm9qZWN0aW9uU2VydmljZSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyB1bmxpc3RlbkJ5S2V5IH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmV4cG9ydCBmdW5jdGlvbiBFdmVudEhlbHBlcigpIHtcbiAgdGhpcy5saXN0ZW5lcktleXNfID0ge307XG59XG5cbkV2ZW50SGVscGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lcktleSA9IGZ1bmN0aW9uICh1aWQsIGtleSkge1xuICBpZiAoIXRoaXMubGlzdGVuZXJLZXlzX1t1aWRdKSB7XG4gICAgdGhpcy5pbml0TGlzdGVuZXJLZXlfKHVpZCk7XG4gIH1cblxuICB0aGlzLmxpc3RlbmVyS2V5c19bdWlkXS5wdXNoKGtleSk7XG59O1xuXG5FdmVudEhlbHBlci5wcm90b3R5cGUuY2xlYXJMaXN0ZW5lcktleSA9IGZ1bmN0aW9uICh1aWQpIHtcbiAgdGhpcy5pbml0TGlzdGVuZXJLZXlfKHVpZCk7XG59O1xuXG5FdmVudEhlbHBlci5wcm90b3R5cGUuaW5pdExpc3RlbmVyS2V5XyA9IGZ1bmN0aW9uICh1aWQpIHtcbiAgaWYgKCF0aGlzLmxpc3RlbmVyS2V5c19bdWlkXSkge1xuICAgIHRoaXMubGlzdGVuZXJLZXlzX1t1aWRdID0gW107XG4gIH0gZWxzZSB7XG4gICAgaWYgKHRoaXMubGlzdGVuZXJLZXlzX1t1aWRdLmxlbmd0aCkge1xuICAgICAgdGhpcy5saXN0ZW5lcktleXNfW3VpZF0uZm9yRWFjaCh1bmxpc3RlbkJ5S2V5KTtcbiAgICAgIHRoaXMubGlzdGVuZXJLZXlzX1t1aWRdLmxlbmd0aCA9IDA7XG4gICAgfVxuICB9XG59O1xuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9FdmVudEhlbHBlcicsIFtdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvRXZlbnRIZWxwZXInLCBFdmVudEhlbHBlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiRmVhdHVyZUhlbHBlci4kaW5qZWN0ID0gW1wiJGluamVjdG9yXCIsIFwiJGZpbHRlclwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9NaXNjRmlsdGVycyBmcm9tICduZ2VvL21pc2MvZmlsdGVycy5qcyc7XG5pbXBvcnQgbmdlb0Rvd25sb2FkU2VydmljZSBmcm9tICduZ2VvL2Rvd25sb2FkL3NlcnZpY2UuanMnO1xuaW1wb3J0IG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcyBmcm9tICduZ2VvL2Zvcm1hdC9GZWF0dXJlUHJvcGVydGllcy5qcyc7XG5pbXBvcnQgbmdlb0dlb21ldHJ5VHlwZSBmcm9tICduZ2VvL0dlb21ldHJ5VHlwZS5qcyc7XG5pbXBvcnQgeyBnZXRGb3JtYXR0ZWRMZW5ndGgsIGdldEZvcm1hdHRlZEFyZWEsIGdldEZvcm1hdHRlZFBvaW50IH0gZnJvbSAnbmdlby9pbnRlcmFjdGlvbi9NZWFzdXJlLmpzJztcbmltcG9ydCB7IGdldEZvcm1hdHRlZEF6aW11dFJhZGl1cyB9IGZyb20gJ25nZW8vaW50ZXJhY3Rpb24vTWVhc3VyZUF6aW11dC5qcyc7XG5pbXBvcnQgeyBmcm9tU3RyaW5nIGFzIGNvbG9yRnJvbVN0cmluZyB9IGZyb20gJ29sL2NvbG9yLmpzJztcbmltcG9ydCAqIGFzIG9sRXh0ZW50IGZyb20gJ29sL2V4dGVudC5qcyc7XG5pbXBvcnQgb2xGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuaW1wb3J0IG9sR2VvbUxpbmVTdHJpbmcgZnJvbSAnb2wvZ2VvbS9MaW5lU3RyaW5nLmpzJztcbmltcG9ydCBvbEdlb21NdWx0aUxpbmVTdHJpbmcgZnJvbSAnb2wvZ2VvbS9NdWx0aUxpbmVTdHJpbmcuanMnO1xuaW1wb3J0IG9sR2VvbU11bHRpUG9pbnQgZnJvbSAnb2wvZ2VvbS9NdWx0aVBvaW50LmpzJztcbmltcG9ydCBvbEdlb21Qb2ludCBmcm9tICdvbC9nZW9tL1BvaW50LmpzJztcbmltcG9ydCBvbEdlb21Qb2x5Z29uIGZyb20gJ29sL2dlb20vUG9seWdvbi5qcyc7XG5pbXBvcnQgb2xHZW9tTXVsdGlQb2x5Z29uIGZyb20gJ29sL2dlb20vTXVsdGlQb2x5Z29uLmpzJztcbmltcG9ydCBvbEdlb21TaW1wbGVHZW9tZXRyeSBmcm9tICdvbC9nZW9tL1NpbXBsZUdlb21ldHJ5LmpzJztcbmltcG9ydCBvbEZvcm1hdEdQWCBmcm9tICdvbC9mb3JtYXQvR1BYLmpzJztcbmltcG9ydCBvbEZvcm1hdEtNTCBmcm9tICdvbC9mb3JtYXQvS01MLmpzJztcbmltcG9ydCBvbFN0eWxlQ2lyY2xlIGZyb20gJ29sL3N0eWxlL0NpcmNsZS5qcyc7XG5pbXBvcnQgb2xTdHlsZUZpbGwgZnJvbSAnb2wvc3R5bGUvRmlsbC5qcyc7XG5pbXBvcnQgb2xTdHlsZVJlZ3VsYXJTaGFwZSBmcm9tICdvbC9zdHlsZS9SZWd1bGFyU2hhcGUuanMnO1xuaW1wb3J0IG9sU3R5bGVTdHJva2UgZnJvbSAnb2wvc3R5bGUvU3Ryb2tlLmpzJztcbmltcG9ydCBvbFN0eWxlU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUuanMnO1xuaW1wb3J0IG9sU3R5bGVUZXh0IGZyb20gJ29sL3N0eWxlL1RleHQuanMnO1xudmFyIFZlcnRleFN0eWxlUmVndWxhclNoYXBlUmFkaXVzID0gNjtcbmV4cG9ydCB2YXIgRmVhdHVyZUZvcm1hdFR5cGUgPSB7XG4gIEdQWDogJ0dQWCcsXG4gIEtNTDogJ0tNTCdcbn07XG5leHBvcnQgZnVuY3Rpb24gRmVhdHVyZUhlbHBlcigkaW5qZWN0b3IsICRmaWx0ZXIpIHtcbiAgdGhpcy4kZmlsdGVyXyA9ICRmaWx0ZXI7XG4gIHRoaXMuZGVjaW1hbHNfID0gdW5kZWZpbmVkO1xuXG4gIGlmICgkaW5qZWN0b3IuaGFzKCduZ2VvTWVhc3VyZURlY2ltYWxzJykpIHtcbiAgICB0aGlzLmRlY2ltYWxzXyA9ICRpbmplY3Rvci5nZXQoJ25nZW9NZWFzdXJlRGVjaW1hbHMnKTtcbiAgfVxuXG4gIHRoaXMucHJlY2lzaW9uXyA9IHVuZGVmaW5lZDtcblxuICBpZiAoJGluamVjdG9yLmhhcygnbmdlb01lYXN1cmVQcmVjaXNpb24nKSkge1xuICAgIHRoaXMucHJlY2lzaW9uXyA9ICRpbmplY3Rvci5nZXQoJ25nZW9NZWFzdXJlUHJlY2lzaW9uJyk7XG4gIH1cblxuICB0aGlzLm51bWJlckZvcm1hdF8gPSAkZmlsdGVyKCdudW1iZXInKTtcbiAgdGhpcy51bml0UHJlZml4Rm9ybWF0XyA9ICRmaWx0ZXIoJ25nZW9Vbml0UHJlZml4Jyk7XG4gIHRoaXMubmdlb051bWJlckNvb3JkaW5hdGVzXyA9ICRmaWx0ZXIoJ25nZW9OdW1iZXJDb29yZGluYXRlcycpO1xuICB0aGlzLnBvaW50RmlsdGVyRm5fID0gbnVsbDtcbiAgdGhpcy5wb2ludEZpbHRlckFyZ3NfID0gW107XG5cbiAgaWYgKCRpbmplY3Rvci5oYXMoJ25nZW9Qb2ludGZpbHRlcicpKSB7XG4gICAgdmFyIGZpbHRlckVsZW1lbnRzID0gJGluamVjdG9yLmdldCgnbmdlb1BvaW50ZmlsdGVyJykuc3BsaXQoJzonKTtcbiAgICB2YXIgZmlsdGVyTmFtZSA9IGZpbHRlckVsZW1lbnRzLnNoaWZ0KCk7XG4gICAgdmFyIGZpbHRlciA9IHRoaXMuJGZpbHRlcl8oZmlsdGVyTmFtZSk7XG4gICAgY29uc29sZS5hc3NlcnQodHlwZW9mIGZpbHRlciA9PSAnZnVuY3Rpb24nKTtcbiAgICB0aGlzLnBvaW50RmlsdGVyRm5fID0gZmlsdGVyO1xuICAgIHRoaXMucG9pbnRGaWx0ZXJBcmdzXyA9IGZpbHRlckVsZW1lbnRzO1xuICB9IGVsc2Uge1xuICAgIHRoaXMucG9pbnRGaWx0ZXJGbl8gPSBudWxsO1xuICB9XG5cbiAgdGhpcy5wcm9qZWN0aW9uXyA9IG51bGw7XG4gIHRoaXMuZG93bmxvYWRfID0gJGluamVjdG9yLmdldCgnbmdlb0Rvd25sb2FkJyk7XG59XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLnNldFByb2plY3Rpb24gPSBmdW5jdGlvbiAocHJvamVjdGlvbikge1xuICB0aGlzLnByb2plY3Rpb25fID0gcHJvamVjdGlvbjtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLnNldFN0eWxlID0gZnVuY3Rpb24gKGZlYXR1cmUsIG9wdF9zZWxlY3QpIHtcbiAgdmFyIHN0eWxlcyA9IHRoaXMuZ2V0U3R5bGUoZmVhdHVyZSk7XG5cbiAgaWYgKG9wdF9zZWxlY3QpIHtcbiAgICBpZiAodGhpcy5zdXBwb3J0c1ZlcnRleF8oZmVhdHVyZSkpIHtcbiAgICAgIHN0eWxlcy5wdXNoKHRoaXMuZ2V0VmVydGV4U3R5bGUoKSk7XG4gICAgfVxuXG4gICAgc3R5bGVzLnVuc2hpZnQodGhpcy5nZXRIYWxvU3R5bGVfKGZlYXR1cmUpKTtcbiAgfVxuXG4gIGZlYXR1cmUuc2V0U3R5bGUoc3R5bGVzKTtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldFN0eWxlID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgdmFyIHR5cGUgPSB0aGlzLmdldFR5cGUoZmVhdHVyZSk7XG4gIHZhciBzdHlsZTtcblxuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlIG5nZW9HZW9tZXRyeVR5cGUuTElORV9TVFJJTkc6XG4gICAgICBzdHlsZSA9IHRoaXMuZ2V0TGluZVN0cmluZ1N0eWxlXyhmZWF0dXJlKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBuZ2VvR2VvbWV0cnlUeXBlLlBPSU5UOlxuICAgICAgc3R5bGUgPSB0aGlzLmdldFBvaW50U3R5bGVfKGZlYXR1cmUpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIG5nZW9HZW9tZXRyeVR5cGUuQ0lSQ0xFOlxuICAgIGNhc2Ugbmdlb0dlb21ldHJ5VHlwZS5QT0xZR09OOlxuICAgIGNhc2Ugbmdlb0dlb21ldHJ5VHlwZS5SRUNUQU5HTEU6XG4gICAgICBzdHlsZSA9IHRoaXMuZ2V0UG9seWdvblN0eWxlXyhmZWF0dXJlKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBuZ2VvR2VvbWV0cnlUeXBlLlRFWFQ6XG4gICAgICBzdHlsZSA9IHRoaXMuZ2V0VGV4dFN0eWxlXyhmZWF0dXJlKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIGJyZWFrO1xuICB9XG5cbiAgaWYgKCFzdHlsZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBzdHlsZScpO1xuICB9XG5cbiAgdmFyIHN0eWxlcztcblxuICBpZiAoc3R5bGUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgIHN0eWxlcyA9IHN0eWxlO1xuICB9IGVsc2Uge1xuICAgIHN0eWxlcyA9IFtzdHlsZV07XG4gIH1cblxuICByZXR1cm4gc3R5bGVzO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZ2V0TGluZVN0cmluZ1N0eWxlXyA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHZhciBzdHJva2VXaWR0aCA9IHRoaXMuZ2V0U3Ryb2tlUHJvcGVydHkoZmVhdHVyZSk7XG4gIHZhciBzaG93TGFiZWwgPSB0aGlzLmdldFNob3dMYWJlbFByb3BlcnR5KGZlYXR1cmUpO1xuICB2YXIgc2hvd01lYXN1cmUgPSB0aGlzLmdldFNob3dNZWFzdXJlUHJvcGVydHkoZmVhdHVyZSk7XG4gIHZhciBjb2xvciA9IHRoaXMuZ2V0UkdCQUNvbG9yUHJvcGVydHkoZmVhdHVyZSk7XG4gIHZhciBzdHlsZXMgPSBbbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgc3Ryb2tlOiBuZXcgb2xTdHlsZVN0cm9rZSh7XG4gICAgICBjb2xvcjogY29sb3IsXG4gICAgICB3aWR0aDogc3Ryb2tlV2lkdGhcbiAgICB9KVxuICB9KV07XG4gIHZhciB0ZXh0TGFiZWxWYWx1ZXMgPSBbXTtcblxuICBpZiAoc2hvd01lYXN1cmUpIHtcbiAgICB0ZXh0TGFiZWxWYWx1ZXMucHVzaCh0aGlzLmdldE1lYXN1cmUoZmVhdHVyZSkpO1xuICB9XG5cbiAgaWYgKHNob3dMYWJlbCkge1xuICAgIHRleHRMYWJlbFZhbHVlcy5wdXNoKHRoaXMuZ2V0TmFtZVByb3BlcnR5KGZlYXR1cmUpKTtcbiAgfVxuXG4gIGlmIChzaG93TGFiZWwgfHwgc2hvd01lYXN1cmUpIHtcbiAgICB2YXIgdGV4dExhYmVsVmFsdWUgPSB0ZXh0TGFiZWxWYWx1ZXMuam9pbignXFxuJyk7XG4gICAgc3R5bGVzLnB1c2gobmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICB0ZXh0OiB0aGlzLmNyZWF0ZVRleHRTdHlsZV8oe1xuICAgICAgICBwcm9wZXJ0eU5hbWU6ICcnLFxuICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgdGV4dDogdGV4dExhYmVsVmFsdWVcbiAgICAgIH0pXG4gICAgfSkpO1xuICB9XG5cbiAgcmV0dXJuIHN0eWxlcztcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldFBvaW50U3R5bGVfID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgdmFyIHNpemUgPSB0aGlzLmdldFNpemVQcm9wZXJ0eShmZWF0dXJlKTtcbiAgdmFyIGNvbG9yID0gdGhpcy5nZXRSR0JBQ29sb3JQcm9wZXJ0eShmZWF0dXJlKTtcbiAgdmFyIHNob3dMYWJlbCA9IHRoaXMuZ2V0U2hvd0xhYmVsUHJvcGVydHkoZmVhdHVyZSk7XG4gIHZhciBzaG93TWVhc3VyZSA9IHRoaXMuZ2V0U2hvd01lYXN1cmVQcm9wZXJ0eShmZWF0dXJlKTtcbiAgdmFyIHN0eWxlcyA9IFtuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICBpbWFnZTogbmV3IG9sU3R5bGVDaXJjbGUoe1xuICAgICAgcmFkaXVzOiBzaXplLFxuICAgICAgZmlsbDogbmV3IG9sU3R5bGVGaWxsKHtcbiAgICAgICAgY29sb3I6IGNvbG9yXG4gICAgICB9KVxuICAgIH0pXG4gIH0pXTtcbiAgdmFyIHRleHRMYWJlbFZhbHVlcyA9IFtdO1xuXG4gIGlmIChzaG93TWVhc3VyZSkge1xuICAgIHRleHRMYWJlbFZhbHVlcy5wdXNoKHRoaXMuZ2V0TWVhc3VyZShmZWF0dXJlKSk7XG4gIH1cblxuICBpZiAoc2hvd0xhYmVsKSB7XG4gICAgdGV4dExhYmVsVmFsdWVzLnB1c2godGhpcy5nZXROYW1lUHJvcGVydHkoZmVhdHVyZSkpO1xuICB9XG5cbiAgaWYgKHNob3dMYWJlbCB8fCBzaG93TWVhc3VyZSkge1xuICAgIHZhciB0ZXh0TGFiZWxWYWx1ZSA9IHRleHRMYWJlbFZhbHVlcy5qb2luKCdcXG4nKTtcbiAgICB2YXIgZm9udF9zaXplID0gMTA7XG4gICAgdmFyIHBvaW50X3RvX3B4ID0gMS4zO1xuICAgIHN0eWxlcy5wdXNoKG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgdGV4dDogdGhpcy5jcmVhdGVUZXh0U3R5bGVfKHtcbiAgICAgICAgcHJvcGVydHlOYW1lOiAnJyxcbiAgICAgICAgbmFtZTogJycsXG4gICAgICAgIHRleHQ6IHRleHRMYWJlbFZhbHVlLFxuICAgICAgICBzaXplOiBmb250X3NpemUsXG4gICAgICAgIG9mZnNldFk6IC0oc2l6ZSArIGZvbnRfc2l6ZSAvIDIgKiB0ZXh0TGFiZWxWYWx1ZXMubGVuZ3RoICogcG9pbnRfdG9fcHggKyA0KVxuICAgICAgfSlcbiAgICB9KSk7XG4gIH1cblxuICByZXR1cm4gc3R5bGVzO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUub3B0TnVtYmVyID0gZnVuY3Rpb24gKGZlYXR1cmUsIGF0dHJpYikge1xuICB2YXIgdmFsdWUgPSBmZWF0dXJlLmdldChhdHRyaWIpO1xuXG4gIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuICt2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5nZXROdW1iZXIgPSBmdW5jdGlvbiAoZmVhdHVyZSwgYXR0cmliKSB7XG4gIHZhciB2YWx1ZSA9IGZlYXR1cmUuZ2V0KGF0dHJpYik7XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiArdmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5nZXRQb2x5Z29uU3R5bGVfID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgdmFyIHN0cm9rZVdpZHRoID0gdGhpcy5nZXRTdHJva2VQcm9wZXJ0eShmZWF0dXJlKTtcbiAgdmFyIG9wYWNpdHkgPSB0aGlzLmdldE9wYWNpdHlQcm9wZXJ0eShmZWF0dXJlKTtcbiAgdmFyIGNvbG9yID0gdGhpcy5nZXRSR0JBQ29sb3JQcm9wZXJ0eShmZWF0dXJlKTtcbiAgdmFyIHNob3dMYWJlbCA9IHRoaXMuZ2V0U2hvd0xhYmVsUHJvcGVydHkoZmVhdHVyZSk7XG4gIHZhciBzaG93TWVhc3VyZSA9IHRoaXMuZ2V0U2hvd01lYXN1cmVQcm9wZXJ0eShmZWF0dXJlKTtcbiAgdmFyIGZpbGxDb2xvciA9IGNvbG9yLnNsaWNlKCk7XG4gIGZpbGxDb2xvclszXSA9IG9wYWNpdHk7XG4gIHZhciBhemltdXQgPSB0aGlzLm9wdE51bWJlcihmZWF0dXJlLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuQVpJTVVUKTtcbiAgdmFyIHN0eWxlcyA9IFtuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICBmaWxsOiBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgY29sb3I6IGZpbGxDb2xvclxuICAgIH0pLFxuICAgIHN0cm9rZTogbmV3IG9sU3R5bGVTdHJva2Uoe1xuICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgd2lkdGg6IHN0cm9rZVdpZHRoXG4gICAgfSlcbiAgfSldO1xuXG4gIGlmIChzaG93TWVhc3VyZSB8fCBzaG93TGFiZWwpIHtcbiAgICBpZiAoc2hvd01lYXN1cmUgJiYgYXppbXV0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICghdGhpcy5wcm9qZWN0aW9uXykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcHJvamVjdGlvbicpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbGluZSA9IHRoaXMuZ2V0UmFkaXVzTGluZShmZWF0dXJlLCBhemltdXQpO1xuICAgICAgdmFyIGxlbmd0aCA9IGdldEZvcm1hdHRlZExlbmd0aChsaW5lLCB0aGlzLnByb2plY3Rpb25fLCB0aGlzLnByZWNpc2lvbl8sIHRoaXMudW5pdFByZWZpeEZvcm1hdF8pO1xuICAgICAgc3R5bGVzLnB1c2gobmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICAgIGdlb21ldHJ5OiBsaW5lLFxuICAgICAgICBmaWxsOiBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgICAgIGNvbG9yOiBmaWxsQ29sb3JcbiAgICAgICAgfSksXG4gICAgICAgIHN0cm9rZTogbmV3IG9sU3R5bGVTdHJva2Uoe1xuICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICB3aWR0aDogc3Ryb2tlV2lkdGhcbiAgICAgICAgfSksXG4gICAgICAgIHRleHQ6IHRoaXMuY3JlYXRlVGV4dFN0eWxlXyh7XG4gICAgICAgICAgcHJvcGVydHlOYW1lOiAnJyxcbiAgICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgICB0ZXh0OiBsZW5ndGgsXG4gICAgICAgICAgYW5nbGU6IChhemltdXQgJSAxODAgKyAxODApICUgMTgwIC0gOTBcbiAgICAgICAgfSlcbiAgICAgIH0pKTtcbiAgICAgIHN0eWxlcy5wdXNoKG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgICBnZW9tZXRyeTogbmV3IG9sR2VvbVBvaW50KGxpbmUuZ2V0TGFzdENvb3JkaW5hdGUoKSksXG4gICAgICAgIHRleHQ6IHRoaXMuY3JlYXRlVGV4dFN0eWxlXyh7XG4gICAgICAgICAgcHJvcGVydHlOYW1lOiAnJyxcbiAgICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgICB0ZXh0OiB0aGlzLm51bWJlckZvcm1hdF8oYXppbXV0LCB0aGlzLmRlY2ltYWxzXykgKyBcIlxceEIwXCIsXG4gICAgICAgICAgc2l6ZTogMTAsXG4gICAgICAgICAgb2Zmc2V0WDogTWF0aC5jb3MoKGF6aW11dCAtIDkwKSAqIE1hdGguUEkgLyAxODApICogMjAsXG4gICAgICAgICAgb2Zmc2V0WTogTWF0aC5zaW4oKGF6aW11dCAtIDkwKSAqIE1hdGguUEkgLyAxODApICogMjBcbiAgICAgICAgfSlcbiAgICAgIH0pKTtcblxuICAgICAgaWYgKHNob3dMYWJlbCkge1xuICAgICAgICBzdHlsZXMucHVzaChuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICAgICAgICB0ZXh0OiB0aGlzLmNyZWF0ZVRleHRTdHlsZV8oe1xuICAgICAgICAgICAgcHJvcGVydHlOYW1lOiAnJyxcbiAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgdGV4dDogdGhpcy5nZXROYW1lUHJvcGVydHkoZmVhdHVyZSksXG4gICAgICAgICAgICBvZmZzZXRZOiAtOCxcbiAgICAgICAgICAgIGV4Y2VlZExlbmd0aDogdHJ1ZVxuICAgICAgICAgIH0pXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHRleHRMYWJlbFZhbHVlcyA9IFtdO1xuXG4gICAgICBpZiAoc2hvd01lYXN1cmUpIHtcbiAgICAgICAgdGV4dExhYmVsVmFsdWVzLnB1c2godGhpcy5nZXRNZWFzdXJlKGZlYXR1cmUpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHNob3dMYWJlbCkge1xuICAgICAgICB0ZXh0TGFiZWxWYWx1ZXMucHVzaCh0aGlzLmdldE5hbWVQcm9wZXJ0eShmZWF0dXJlKSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChzaG93TGFiZWwgfHwgc2hvd01lYXN1cmUpIHtcbiAgICAgICAgdmFyIHRleHRMYWJlbFZhbHVlID0gdGV4dExhYmVsVmFsdWVzLmpvaW4oJ1xcbicpO1xuICAgICAgICBzdHlsZXMucHVzaChuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICAgICAgICB0ZXh0OiB0aGlzLmNyZWF0ZVRleHRTdHlsZV8oe1xuICAgICAgICAgICAgcHJvcGVydHlOYW1lOiAnJyxcbiAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgdGV4dDogdGV4dExhYmVsVmFsdWUsXG4gICAgICAgICAgICBleGNlZWRMZW5ndGg6IHRydWVcbiAgICAgICAgICB9KVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHN0eWxlcztcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldFRleHRTdHlsZV8gPSBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICByZXR1cm4gbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgdGV4dDogdGhpcy5jcmVhdGVUZXh0U3R5bGVfKHtcbiAgICAgIHByb3BlcnR5TmFtZTogJycsXG4gICAgICBuYW1lOiAnJyxcbiAgICAgIHJvdGF0ZVdpdGhWaWV3OiB0cnVlLFxuICAgICAgdGV4dDogdGhpcy5nZXROYW1lUHJvcGVydHkoZmVhdHVyZSksXG4gICAgICBzaXplOiB0aGlzLmdldFNpemVQcm9wZXJ0eShmZWF0dXJlKSxcbiAgICAgIGFuZ2xlOiB0aGlzLmdldEFuZ2xlUHJvcGVydHkoZmVhdHVyZSksXG4gICAgICBjb2xvcjogdGhpcy5nZXRSR0JBQ29sb3JQcm9wZXJ0eShmZWF0dXJlKSxcbiAgICAgIHdpZHRoOiB0aGlzLmdldFN0cm9rZVByb3BlcnR5KGZlYXR1cmUpXG4gICAgfSlcbiAgfSk7XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5jcmVhdGVFZGl0aW5nU3R5bGVzID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgdmFyIHdoaXRlID0gWzI1NSwgMjU1LCAyNTUsIDFdO1xuICB2YXIgYmx1ZSA9IFswLCAxNTMsIDI1NSwgMV07XG4gIHZhciB3aWR0aCA9IDM7XG4gIHZhciBzdHlsZXMgPSBbXTtcbiAgdmFyIGdlb20gPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgaWYgKCFnZW9tKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdlb20nKTtcbiAgfVxuXG4gIHZhciB0eXBlID0gZ2VvbS5nZXRUeXBlKCk7XG5cbiAgaWYgKHR5cGUgPT09ICdQb2ludCcpIHtcbiAgICBzdHlsZXMucHVzaChuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICAgIGltYWdlOiBuZXcgb2xTdHlsZUNpcmNsZSh7XG4gICAgICAgIHJhZGl1czogd2lkdGggKiAyLFxuICAgICAgICBmaWxsOiBuZXcgb2xTdHlsZUZpbGwoe1xuICAgICAgICAgIGNvbG9yOiBibHVlXG4gICAgICAgIH0pLFxuICAgICAgICBzdHJva2U6IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICAgICAgICBjb2xvcjogd2hpdGUsXG4gICAgICAgICAgd2lkdGg6IHdpZHRoIC8gMlxuICAgICAgICB9KVxuICAgICAgfSksXG4gICAgICB6SW5kZXg6IEluZmluaXR5XG4gICAgfSkpO1xuICB9IGVsc2Uge1xuICAgIGlmICh0eXBlID09PSAnTGluZVN0cmluZycpIHtcbiAgICAgIHN0eWxlcy5wdXNoKG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgICBzdHJva2U6IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICAgICAgICBjb2xvcjogd2hpdGUsXG4gICAgICAgICAgd2lkdGg6IHdpZHRoICsgMlxuICAgICAgICB9KVxuICAgICAgfSkpO1xuICAgICAgc3R5bGVzLnB1c2gobmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICAgIHN0cm9rZTogbmV3IG9sU3R5bGVTdHJva2Uoe1xuICAgICAgICAgIGNvbG9yOiBibHVlLFxuICAgICAgICAgIHdpZHRoOiB3aWR0aFxuICAgICAgICB9KVxuICAgICAgfSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHlsZXMucHVzaChuZXcgb2xTdHlsZVN0eWxlKHtcbiAgICAgICAgc3Ryb2tlOiBuZXcgb2xTdHlsZVN0cm9rZSh7XG4gICAgICAgICAgY29sb3I6IGJsdWUsXG4gICAgICAgICAgd2lkdGg6IHdpZHRoIC8gMlxuICAgICAgICB9KSxcbiAgICAgICAgZmlsbDogbmV3IG9sU3R5bGVGaWxsKHtcbiAgICAgICAgICBjb2xvcjogWzI1NSwgMjU1LCAyNTUsIDAuNV1cbiAgICAgICAgfSlcbiAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBzdHlsZXMucHVzaCh0aGlzLmdldFZlcnRleFN0eWxlKHRydWUpKTtcbiAgfVxuXG4gIHJldHVybiBzdHlsZXM7XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5nZXRWZXJ0ZXhJbmZvQXRDb29yZGluYXRlID0gZnVuY3Rpb24gKGZlYXR1cmUsIGNvb3JkaW5hdGUsIHJlc29sdXRpb24pIHtcbiAgdmFyIGluZm8gPSBudWxsO1xuXG4gIGlmICh0aGlzLnN1cHBvcnRzVmVydGV4UmVtb3ZhbF8oZmVhdHVyZSkpIHtcbiAgICB2YXIgYnVmZmVyID0gcmVzb2x1dGlvbiAqIFZlcnRleFN0eWxlUmVndWxhclNoYXBlUmFkaXVzO1xuICAgIHZhciBjb29yZGluYXRlcyA9IG51bGw7XG4gICAgdmFyIGNvb3JkaW5hdGVzcyA9IG51bGw7XG4gICAgdmFyIGNvb3JkaW5hdGVzc3MgPSBudWxsO1xuICAgIHZhciBtaW5OdW1Db29yZGluYXRlcyA9IC0xO1xuICAgIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbUxpbmVTdHJpbmcpIHtcbiAgICAgIGNvb3JkaW5hdGVzID0gZ2VvbWV0cnkuZ2V0Q29vcmRpbmF0ZXMoKTtcbiAgICAgIG1pbk51bUNvb3JkaW5hdGVzID0gMjtcbiAgICB9IGVsc2UgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tUG9seWdvbikge1xuICAgICAgY29vcmRpbmF0ZXNzID0gZ2VvbWV0cnkuZ2V0Q29vcmRpbmF0ZXMoKTtcbiAgICAgIG1pbk51bUNvb3JkaW5hdGVzID0gNDtcbiAgICB9IGVsc2UgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTXVsdGlMaW5lU3RyaW5nKSB7XG4gICAgICBjb29yZGluYXRlc3MgPSBnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpO1xuICAgICAgbWluTnVtQ29vcmRpbmF0ZXMgPSAyO1xuICAgIH0gZWxzZSBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21NdWx0aVBvbHlnb24pIHtcbiAgICAgIGNvb3JkaW5hdGVzc3MgPSBnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpO1xuICAgICAgbWluTnVtQ29vcmRpbmF0ZXMgPSA0O1xuICAgIH1cblxuICAgIGlmIChjb29yZGluYXRlcykge1xuICAgICAgdmFyIGluZGV4ID0gdGhpcy5nZXRDb29yZGluYXRlSW5kZXhUaGF0SGl0c0F0Xyhjb29yZGluYXRlcywgY29vcmRpbmF0ZSwgbWluTnVtQ29vcmRpbmF0ZXMsIGJ1ZmZlcik7XG5cbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgaW5mbyA9IFtpbmRleF07XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChjb29yZGluYXRlc3MpIHtcbiAgICAgIHZhciBpaSA9IGNvb3JkaW5hdGVzcy5sZW5ndGg7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaWk7IGkrKykge1xuICAgICAgICB2YXIgX2luZGV4ID0gdGhpcy5nZXRDb29yZGluYXRlSW5kZXhUaGF0SGl0c0F0Xyhjb29yZGluYXRlc3NbaV0sIGNvb3JkaW5hdGUsIG1pbk51bUNvb3JkaW5hdGVzLCBidWZmZXIpO1xuXG4gICAgICAgIGlmIChfaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgaW5mbyA9IFtpLCBfaW5kZXhdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChjb29yZGluYXRlc3NzKSB7XG4gICAgICB2YXIgX2lpID0gY29vcmRpbmF0ZXNzcy5sZW5ndGg7XG5cbiAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBfaWk7IF9pKyspIHtcbiAgICAgICAgdmFyIF9jb29yZGluYXRlc3MgPSBjb29yZGluYXRlc3NzW19pXTtcbiAgICAgICAgdmFyIGpqID0gX2Nvb3JkaW5hdGVzcy5sZW5ndGg7XG5cbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBqajsgaisrKSB7XG4gICAgICAgICAgdmFyIF9pbmRleDIgPSB0aGlzLmdldENvb3JkaW5hdGVJbmRleFRoYXRIaXRzQXRfKF9jb29yZGluYXRlc3Nbal0sIGNvb3JkaW5hdGUsIG1pbk51bUNvb3JkaW5hdGVzLCBidWZmZXIpO1xuXG4gICAgICAgICAgaWYgKF9pbmRleDIgIT09IC0xKSB7XG4gICAgICAgICAgICBpbmZvID0gW19pLCBqLCBfaW5kZXgyXTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gaW5mbztcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldENvb3JkaW5hdGVJbmRleFRoYXRIaXRzQXRfID0gZnVuY3Rpb24gKGNvb3JkaW5hdGVzLCBjb29yZGluYXRlLCBtaW4sIGJ1ZmZlcikge1xuICB2YXIgaW5kZXggPSAtMTtcbiAgdmFyIGlpID0gY29vcmRpbmF0ZXMubGVuZ3RoO1xuXG4gIGlmIChpaSA+IG1pbikge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaWk7IGkrKykge1xuICAgICAgdmFyIGhpdHMgPSBvbEV4dGVudC5jb250YWluc0Nvb3JkaW5hdGUob2xFeHRlbnQuYnVmZmVyKG9sRXh0ZW50LmNyZWF0ZU9yVXBkYXRlRnJvbUNvb3JkaW5hdGUoY29vcmRpbmF0ZXNbaV0pLCBidWZmZXIpLCBjb29yZGluYXRlKTtcblxuICAgICAgaWYgKGhpdHMpIHtcbiAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gaW5kZXg7XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5nZXRWZXJ0ZXhTdHlsZSA9IGZ1bmN0aW9uIChvcHRfaW5jR2VvbUZ1bmMpIHtcbiAgdmFyIGluY0dlb21GdW5jID0gb3B0X2luY0dlb21GdW5jICE9PSB1bmRlZmluZWQgPyBvcHRfaW5jR2VvbUZ1bmMgOiB0cnVlO1xuICB2YXIgb3B0aW9ucyA9IHtcbiAgICBpbWFnZTogbmV3IG9sU3R5bGVSZWd1bGFyU2hhcGUoe1xuICAgICAgcmFkaXVzOiBWZXJ0ZXhTdHlsZVJlZ3VsYXJTaGFwZVJhZGl1cyxcbiAgICAgIHBvaW50czogNCxcbiAgICAgIGFuZ2xlOiBNYXRoLlBJIC8gNCxcbiAgICAgIGZpbGw6IG5ldyBvbFN0eWxlRmlsbCh7XG4gICAgICAgIGNvbG9yOiBbMjU1LCAyNTUsIDI1NSwgMC41XVxuICAgICAgfSksXG4gICAgICBzdHJva2U6IG5ldyBvbFN0eWxlU3Ryb2tlKHtcbiAgICAgICAgY29sb3I6IFswLCAwLCAwLCAxXVxuICAgICAgfSlcbiAgICB9KVxuICB9O1xuXG4gIGlmIChpbmNHZW9tRnVuYykge1xuICAgIG9wdGlvbnMuZ2VvbWV0cnkgPSBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgdmFyIGdlb20gPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICAgIGlmICghKGdlb20gaW5zdGFuY2VvZiBvbEdlb21TaW1wbGVHZW9tZXRyeSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoZ2VvbS5nZXRUeXBlKCkgPT0gJ1BvaW50Jykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBpbm5lck11bHRpQ29vcmRpbmF0ZXM7XG4gICAgICB2YXIgbXVsdGlDb29yZGluYXRlcyA9IFtdO1xuICAgICAgdmFyIGNvb3JkaW5hdGVzID0gW107XG5cbiAgICAgIGlmIChnZW9tIGluc3RhbmNlb2Ygb2xHZW9tTGluZVN0cmluZykge1xuICAgICAgICBjb29yZGluYXRlcyA9IGdlb20uZ2V0Q29vcmRpbmF0ZXMoKTtcbiAgICAgIH0gZWxzZSBpZiAoZ2VvbSBpbnN0YW5jZW9mIG9sR2VvbU11bHRpTGluZVN0cmluZykge1xuICAgICAgICBtdWx0aUNvb3JkaW5hdGVzID0gZ2VvbS5nZXRDb29yZGluYXRlcygpO1xuICAgICAgfSBlbHNlIGlmIChnZW9tIGluc3RhbmNlb2Ygb2xHZW9tUG9seWdvbikge1xuICAgICAgICBjb29yZGluYXRlcyA9IGdlb20uZ2V0Q29vcmRpbmF0ZXMoKVswXTtcbiAgICAgIH0gZWxzZSBpZiAoZ2VvbSBpbnN0YW5jZW9mIG9sR2VvbU11bHRpUG9seWdvbikge1xuICAgICAgICBpbm5lck11bHRpQ29vcmRpbmF0ZXMgPSBnZW9tLmdldENvb3JkaW5hdGVzKCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpbm5lck11bHRpQ29vcmRpbmF0ZXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gaW5uZXJNdWx0aUNvb3JkaW5hdGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICBtdWx0aUNvb3JkaW5hdGVzID0gbXVsdGlDb29yZGluYXRlcy5jb25jYXQoaW5uZXJNdWx0aUNvb3JkaW5hdGVzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBfaTIgPSAwLCBfaWkyID0gbXVsdGlDb29yZGluYXRlcy5sZW5ndGg7IF9pMiA8IF9paTI7IF9pMisrKSB7XG4gICAgICAgIGNvb3JkaW5hdGVzID0gY29vcmRpbmF0ZXMuY29uY2F0KG11bHRpQ29vcmRpbmF0ZXNbX2kyXSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb29yZGluYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvbEdlb21NdWx0aVBvaW50KGNvb3JkaW5hdGVzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBnZW9tO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICByZXR1cm4gbmV3IG9sU3R5bGVTdHlsZShvcHRpb25zKTtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLnJlbW92ZVZlcnRleCA9IGZ1bmN0aW9uIChmZWF0dXJlLCB2ZXJ0ZXhJbmZvKSB7XG4gIHZhciBkZWxldGVkID0gZmFsc2U7XG4gIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICBpZiAoIShnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbVNpbXBsZUdlb21ldHJ5KSkge1xuICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZ2VvbWV0cnkgdHlwZScpO1xuICB9XG5cbiAgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTGluZVN0cmluZykge1xuICAgIHZhciBjb29yZGluYXRlcyA9IGdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCk7XG4gICAgdmFyIGluZGV4ID0gdmVydGV4SW5mb1swXTtcblxuICAgIGlmIChjb29yZGluYXRlcy5sZW5ndGggPiAyKSB7XG4gICAgICBjb29yZGluYXRlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgZGVsZXRlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgIGdlb21ldHJ5LnNldENvb3JkaW5hdGVzKGNvb3JkaW5hdGVzKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21Qb2x5Z29uKSB7XG4gICAgdmFyIF9jb29yZGluYXRlcyA9IGdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCk7XG5cbiAgICB2YXIgaW5kZXhPbmUgPSB2ZXJ0ZXhJbmZvWzBdO1xuICAgIHZhciBpbmRleFR3byA9IHZlcnRleEluZm9bMV07XG4gICAgdmFyIGNvbXBvbmVudCA9IF9jb29yZGluYXRlc1tpbmRleE9uZV07XG5cbiAgICBpZiAoY29tcG9uZW50Lmxlbmd0aCA+IDQpIHtcbiAgICAgIGNvbXBvbmVudC5zcGxpY2UoaW5kZXhUd28sIDEpO1xuICAgICAgZGVsZXRlZCA9IHRydWU7XG5cbiAgICAgIGlmIChpbmRleFR3byA9PT0gMCkge1xuICAgICAgICBjb21wb25lbnQucG9wKCk7XG4gICAgICAgIGNvbXBvbmVudC5wdXNoKGNvbXBvbmVudFswXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgIGdlb21ldHJ5LnNldENvb3JkaW5hdGVzKF9jb29yZGluYXRlcyk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTXVsdGlMaW5lU3RyaW5nKSB7XG4gICAgdmFyIF9jb29yZGluYXRlczIgPSBnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpO1xuXG4gICAgdmFyIF9pbmRleE9uZSA9IHZlcnRleEluZm9bMF07XG4gICAgdmFyIF9pbmRleFR3byA9IHZlcnRleEluZm9bMV07XG4gICAgdmFyIF9jb21wb25lbnQgPSBfY29vcmRpbmF0ZXMyW19pbmRleE9uZV07XG5cbiAgICBpZiAoX2NvbXBvbmVudC5sZW5ndGggPiAyKSB7XG4gICAgICBfY29tcG9uZW50LnNwbGljZShfaW5kZXhUd28sIDEpO1xuXG4gICAgICBkZWxldGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoZGVsZXRlZCkge1xuICAgICAgZ2VvbWV0cnkuc2V0Q29vcmRpbmF0ZXMoX2Nvb3JkaW5hdGVzMik7XG4gICAgfVxuICB9IGVsc2UgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTXVsdGlQb2x5Z29uKSB7XG4gICAgdmFyIF9jb29yZGluYXRlczMgPSBnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpO1xuXG4gICAgdmFyIF9pbmRleE9uZTIgPSB2ZXJ0ZXhJbmZvWzBdO1xuICAgIHZhciBfaW5kZXhUd28yID0gdmVydGV4SW5mb1sxXTtcbiAgICB2YXIgaW5kZXhUaHJlZSA9IHZlcnRleEluZm9bMl07XG4gICAgdmFyIF9jb21wb25lbnQyID0gX2Nvb3JkaW5hdGVzM1tfaW5kZXhPbmUyXVtfaW5kZXhUd28yXTtcblxuICAgIGlmIChfY29tcG9uZW50Mi5sZW5ndGggPiA0KSB7XG4gICAgICBfY29tcG9uZW50Mi5zcGxpY2UoaW5kZXhUaHJlZSwgMSk7XG5cbiAgICAgIGRlbGV0ZWQgPSB0cnVlO1xuXG4gICAgICBpZiAoaW5kZXhUaHJlZSA9PT0gMCkge1xuICAgICAgICBfY29tcG9uZW50Mi5wb3AoKTtcblxuICAgICAgICBfY29tcG9uZW50Mi5wdXNoKF9jb21wb25lbnQyWzBdKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZGVsZXRlZCkge1xuICAgICAgZ2VvbWV0cnkuc2V0Q29vcmRpbmF0ZXMoX2Nvb3JkaW5hdGVzMyk7XG4gICAgfVxuICB9XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5zdXBwb3J0c1ZlcnRleF8gPSBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICB2YXIgc3VwcG9ydGVkID0gW25nZW9HZW9tZXRyeVR5cGUuTElORV9TVFJJTkcsIG5nZW9HZW9tZXRyeVR5cGUuTVVMVElfTElORV9TVFJJTkcsIG5nZW9HZW9tZXRyeVR5cGUuTVVMVElfUE9MWUdPTiwgbmdlb0dlb21ldHJ5VHlwZS5QT0xZR09OLCBuZ2VvR2VvbWV0cnlUeXBlLlJFQ1RBTkdMRV07XG4gIHZhciB0eXBlID0gdGhpcy5nZXRUeXBlKGZlYXR1cmUpO1xuICByZXR1cm4gc3VwcG9ydGVkLmluY2x1ZGVzKHR5cGUpO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuc3VwcG9ydHNWZXJ0ZXhSZW1vdmFsXyA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHZhciBzdXBwb3J0ZWQgPSBbbmdlb0dlb21ldHJ5VHlwZS5MSU5FX1NUUklORywgbmdlb0dlb21ldHJ5VHlwZS5NVUxUSV9MSU5FX1NUUklORywgbmdlb0dlb21ldHJ5VHlwZS5NVUxUSV9QT0xZR09OLCBuZ2VvR2VvbWV0cnlUeXBlLlBPTFlHT05dO1xuICB2YXIgdHlwZSA9IHRoaXMuZ2V0VHlwZShmZWF0dXJlKTtcbiAgcmV0dXJuIHN1cHBvcnRlZC5pbmNsdWRlcyh0eXBlKTtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldEhhbG9TdHlsZV8gPSBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICB2YXIgdHlwZSA9IHRoaXMuZ2V0VHlwZShmZWF0dXJlKTtcbiAgdmFyIHN0eWxlO1xuICB2YXIgaGFsb1NpemUgPSAzO1xuXG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2Ugbmdlb0dlb21ldHJ5VHlwZS5QT0lOVDpcbiAgICAgIHZhciBzaXplID0gdGhpcy5nZXRTaXplUHJvcGVydHkoZmVhdHVyZSk7XG4gICAgICBzdHlsZSA9IG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgICBpbWFnZTogbmV3IG9sU3R5bGVDaXJjbGUoe1xuICAgICAgICAgIHJhZGl1czogc2l6ZSArIGhhbG9TaXplLFxuICAgICAgICAgIGZpbGw6IG5ldyBvbFN0eWxlRmlsbCh7XG4gICAgICAgICAgICBjb2xvcjogWzI1NSwgMjU1LCAyNTUsIDFdXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIG5nZW9HZW9tZXRyeVR5cGUuTElORV9TVFJJTkc6XG4gICAgY2FzZSBuZ2VvR2VvbWV0cnlUeXBlLkNJUkNMRTpcbiAgICBjYXNlIG5nZW9HZW9tZXRyeVR5cGUuUE9MWUdPTjpcbiAgICBjYXNlIG5nZW9HZW9tZXRyeVR5cGUuUkVDVEFOR0xFOlxuICAgICAgdmFyIHN0cm9rZVdpZHRoID0gdGhpcy5nZXRTdHJva2VQcm9wZXJ0eShmZWF0dXJlKTtcbiAgICAgIHN0eWxlID0gbmV3IG9sU3R5bGVTdHlsZSh7XG4gICAgICAgIHN0cm9rZTogbmV3IG9sU3R5bGVTdHJva2Uoe1xuICAgICAgICAgIGNvbG9yOiBbMjU1LCAyNTUsIDI1NSwgMV0sXG4gICAgICAgICAgd2lkdGg6IHN0cm9rZVdpZHRoICsgaGFsb1NpemUgKiAyXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBuZ2VvR2VvbWV0cnlUeXBlLlRFWFQ6XG4gICAgICBzdHlsZSA9IG5ldyBvbFN0eWxlU3R5bGUoe1xuICAgICAgICB0ZXh0OiB0aGlzLmNyZWF0ZVRleHRTdHlsZV8oe1xuICAgICAgICAgIHByb3BlcnR5TmFtZTogJycsXG4gICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgcm90YXRlV2l0aFZpZXc6IHRydWUsXG4gICAgICAgICAgdGV4dDogdGhpcy5nZXROYW1lUHJvcGVydHkoZmVhdHVyZSksXG4gICAgICAgICAgc2l6ZTogdGhpcy5nZXRTaXplUHJvcGVydHkoZmVhdHVyZSksXG4gICAgICAgICAgYW5nbGU6IHRoaXMuZ2V0QW5nbGVQcm9wZXJ0eShmZWF0dXJlKSxcbiAgICAgICAgICB3aWR0aDogaGFsb1NpemUgKiAzXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgIGJyZWFrO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIGJyZWFrO1xuICB9XG5cbiAgaWYgKCFzdHlsZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBzdHlsZScpO1xuICB9XG5cbiAgcmV0dXJuIHN0eWxlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbHRlcmVkRmVhdHVyZVZhbHVlcyhmZWF0dXJlKSB7XG4gIHZhciBwcm9wZXJ0aWVzID0gZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCk7XG4gIGRlbGV0ZSBwcm9wZXJ0aWVzLmJvdW5kZWRCeTtcbiAgZGVsZXRlIHByb3BlcnRpZXNbZmVhdHVyZS5nZXRHZW9tZXRyeU5hbWUoKV07XG4gIGRlbGV0ZSBwcm9wZXJ0aWVzLm5nZW9fZmVhdHVyZV90eXBlXztcbiAgcmV0dXJuIHByb3BlcnRpZXM7XG59XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldEFuZ2xlUHJvcGVydHkgPSBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICB2YXIgYW5nbGUgPSArZmVhdHVyZS5nZXQobmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLkFOR0xFKTtcbiAgY29uc29sZS5hc3NlcnQodHlwZW9mIGFuZ2xlID09ICdudW1iZXInKTtcbiAgcmV0dXJuIGFuZ2xlO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZ2V0Q29sb3JQcm9wZXJ0eSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHZhciBjb2xvciA9IGZlYXR1cmUuZ2V0KG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5DT0xPUik7XG4gIGNvbnNvbGUuYXNzZXJ0KHR5cGVvZiBjb2xvciA9PSAnc3RyaW5nJyk7XG4gIHJldHVybiBjb2xvcjtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldFJHQkFDb2xvclByb3BlcnR5ID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgdmFyIGNvbG9yID0gdGhpcy5nZXRDb2xvclByb3BlcnR5KGZlYXR1cmUpO1xuICByZXR1cm4gY29sb3JGcm9tU3RyaW5nKGNvbG9yKTtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldE5hbWVQcm9wZXJ0eSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHZhciBuYW1lID0gZmVhdHVyZS5nZXQobmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLk5BTUUpO1xuICBjb25zb2xlLmFzc2VydCh0eXBlb2YgbmFtZSA9PSAnc3RyaW5nJyk7XG4gIHJldHVybiBuYW1lO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZ2V0T3BhY2l0eVByb3BlcnR5ID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgcmV0dXJuIHRoaXMuZ2V0TnVtYmVyKGZlYXR1cmUsIG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5PUEFDSVRZKTtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldFNob3dNZWFzdXJlUHJvcGVydHkgPSBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICB2YXIgc2hvd01lYXN1cmUgPSBmZWF0dXJlLmdldChuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU0hPV19NRUFTVVJFKTtcblxuICBpZiAoc2hvd01lYXN1cmUgPT09IHVuZGVmaW5lZCkge1xuICAgIHNob3dNZWFzdXJlID0gZmFsc2U7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHNob3dNZWFzdXJlID09PSAnc3RyaW5nJykge1xuICAgIHNob3dNZWFzdXJlID0gc2hvd01lYXN1cmUgPT09ICd0cnVlJyA/IHRydWUgOiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiBzaG93TWVhc3VyZTtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldFNob3dMYWJlbFByb3BlcnR5ID0gZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgdmFyIHNob3dMYWJlbCA9IGZlYXR1cmUuZ2V0KG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5TSE9XX0xBQkVMKTtcblxuICBpZiAoc2hvd0xhYmVsID09PSB1bmRlZmluZWQpIHtcbiAgICBzaG93TGFiZWwgPSBmYWxzZTtcbiAgfSBlbHNlIGlmICh0eXBlb2Ygc2hvd0xhYmVsID09PSAnc3RyaW5nJykge1xuICAgIHNob3dMYWJlbCA9IHNob3dMYWJlbCA9PT0gJ3RydWUnID8gdHJ1ZSA6IGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHNob3dMYWJlbDtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldFNpemVQcm9wZXJ0eSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHJldHVybiB0aGlzLmdldE51bWJlcihmZWF0dXJlLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU0laRSk7XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5nZXRTdHJva2VQcm9wZXJ0eSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHJldHVybiB0aGlzLmdldE51bWJlcihmZWF0dXJlLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuU1RST0tFKTtcbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmV4cG9ydCA9IGZ1bmN0aW9uIChmZWF0dXJlcywgZm9ybWF0VHlwZSkge1xuICBzd2l0Y2ggKGZvcm1hdFR5cGUpIHtcbiAgICBjYXNlIEZlYXR1cmVGb3JtYXRUeXBlLkdQWDpcbiAgICAgIHRoaXMuZXhwb3J0R1BYKGZlYXR1cmVzKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBGZWF0dXJlRm9ybWF0VHlwZS5LTUw6XG4gICAgICB0aGlzLmV4cG9ydEtNTChmZWF0dXJlcyk7XG4gICAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICBicmVhaztcbiAgfVxufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZXhwb3J0R1BYID0gZnVuY3Rpb24gKGZlYXR1cmVzKSB7XG4gIHZhciBmb3JtYXQgPSBuZXcgb2xGb3JtYXRHUFgoKTtcbiAgdmFyIG1pbWVUeXBlID0gJ2FwcGxpY2F0aW9uL2dweCt4bWwnO1xuICB2YXIgZmlsZU5hbWUgPSAnZXhwb3J0LmdweCc7XG4gIHRoaXMuZXhwb3J0XyhmZWF0dXJlcywgZm9ybWF0LCBmaWxlTmFtZSwgbWltZVR5cGUpO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZXhwb3J0S01MID0gZnVuY3Rpb24gKGZlYXR1cmVzKSB7XG4gIHZhciBmb3JtYXQgPSBuZXcgb2xGb3JtYXRLTUwoKTtcbiAgdmFyIG1pbWVUeXBlID0gJ2FwcGxpY2F0aW9uL3ZuZC5nb29nbGUtZWFydGgua21sK3htbCc7XG4gIHZhciBmaWxlTmFtZSA9ICdleHBvcnQua21sJztcbiAgdGhpcy5leHBvcnRfKGZlYXR1cmVzLCBmb3JtYXQsIGZpbGVOYW1lLCBtaW1lVHlwZSk7XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5leHBvcnRfID0gZnVuY3Rpb24gKGZlYXR1cmVzLCBmb3JtYXQsIGZpbGVOYW1lLCBvcHRfbWltZVR5cGUpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB2YXIgbWltZVR5cGUgPSBvcHRfbWltZVR5cGUgIT09IHVuZGVmaW5lZCA/IG9wdF9taW1lVHlwZSA6ICd0ZXh0L3BsYWluJztcbiAgdmFyIGNsb25lcyA9IFtdO1xuICB2YXIgY2xvbmU7XG4gIGZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICBjbG9uZSA9IG5ldyBvbEZlYXR1cmUoZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCkpO1xuXG4gICAgX3RoaXMuc2V0U3R5bGUoY2xvbmUsIGZhbHNlKTtcblxuICAgIGNsb25lcy5wdXNoKGNsb25lKTtcbiAgfSk7XG4gIHZhciB3cml0ZU9wdGlvbnMgPSB0aGlzLnByb2plY3Rpb25fID8ge1xuICAgIGRhdGFQcm9qZWN0aW9uOiAnRVBTRzo0MzI2JyxcbiAgICBmZWF0dXJlUHJvamVjdGlvbjogdGhpcy5wcm9qZWN0aW9uX1xuICB9IDoge307XG4gIHZhciBkYXRhID0gZm9ybWF0LndyaXRlRmVhdHVyZXMoY2xvbmVzLCB3cml0ZU9wdGlvbnMpO1xuICB0aGlzLmRvd25sb2FkXyhkYXRhLCBmaWxlTmFtZSwgbWltZVR5cGUgKyBcIjtjaGFyc2V0PXV0Zi04XCIpO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuY3JlYXRlVGV4dFN0eWxlXyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIHZhciB0ZXh0X29wdGlvbnMgPSBvcHRpb25zO1xuXG4gIGlmIChvcHRpb25zLmFuZ2xlKSB7XG4gICAgdmFyIGFuZ2xlID0gb3B0aW9ucy5hbmdsZSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5hbmdsZSA6IDA7XG4gICAgdmFyIHJvdGF0aW9uID0gYW5nbGUgKiBNYXRoLlBJIC8gMTgwO1xuICAgIHRleHRfb3B0aW9ucy5yb3RhdGlvbiA9IHJvdGF0aW9uO1xuICAgIGRlbGV0ZSBvcHRpb25zLmFuZ2xlO1xuICB9XG5cbiAgdGV4dF9vcHRpb25zLmZvbnQgPSBbJ25vcm1hbCcsIChvcHRpb25zLnNpemUgfHwgMTApICsgXCJwdFwiLCAnQXJpYWwnXS5qb2luKCcgJyk7XG5cbiAgaWYgKG9wdGlvbnMuY29sb3IpIHtcbiAgICB0ZXh0X29wdGlvbnMuZmlsbCA9IG5ldyBvbFN0eWxlRmlsbCh7XG4gICAgICBjb2xvcjogb3B0aW9ucy5jb2xvciB8fCBbMCwgMCwgMCwgMV1cbiAgICB9KTtcbiAgICBkZWxldGUgb3B0aW9ucy5jb2xvcjtcbiAgfVxuXG4gIHRleHRfb3B0aW9ucy5zdHJva2UgPSBuZXcgb2xTdHlsZVN0cm9rZSh7XG4gICAgY29sb3I6IFsyNTUsIDI1NSwgMjU1LCAxXSxcbiAgICB3aWR0aDogb3B0aW9ucy53aWR0aCB8fCAzXG4gIH0pO1xuICBkZWxldGUgb3B0aW9ucy53aWR0aDtcbiAgcmV0dXJuIG5ldyBvbFN0eWxlVGV4dCh0ZXh0X29wdGlvbnMpO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZ2V0TWVhc3VyZSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIGlmICghdGhpcy5wcm9qZWN0aW9uXykge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBwcm9qZWN0aW9uJyk7XG4gIH1cblxuICB2YXIgZ2VvbWV0cnkgPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgaWYgKCFnZW9tZXRyeSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZW9tZXRyeScpO1xuICB9XG5cbiAgdmFyIG1lYXN1cmUgPSAnJztcblxuICBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21Qb2x5Z29uKSB7XG4gICAgaWYgKHRoaXMuZ2V0VHlwZShmZWF0dXJlKSA9PT0gbmdlb0dlb21ldHJ5VHlwZS5DSVJDTEUpIHtcbiAgICAgIHZhciBhemltdXQgPSB0aGlzLm9wdE51bWJlcihmZWF0dXJlLCBuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuQVpJTVVUKTtcblxuICAgICAgaWYgKHR5cGVvZiBhemltdXQgIT0gJ251bWJlcicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGF6aW11dCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbGluZSA9IHRoaXMuZ2V0UmFkaXVzTGluZShmZWF0dXJlLCBhemltdXQpO1xuICAgICAgbWVhc3VyZSA9IGdldEZvcm1hdHRlZEF6aW11dFJhZGl1cyhsaW5lLCB0aGlzLnByb2plY3Rpb25fLCB0aGlzLmRlY2ltYWxzXywgdGhpcy5wcmVjaXNpb25fLCB0aGlzLnVuaXRQcmVmaXhGb3JtYXRfLCB0aGlzLm51bWJlckZvcm1hdF8pO1xuICAgIH0gZWxzZSB7XG4gICAgICBtZWFzdXJlID0gZ2V0Rm9ybWF0dGVkQXJlYShnZW9tZXRyeSwgdGhpcy5wcm9qZWN0aW9uXywgdGhpcy5wcmVjaXNpb25fLCB0aGlzLnVuaXRQcmVmaXhGb3JtYXRfKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21MaW5lU3RyaW5nKSB7XG4gICAgbWVhc3VyZSA9IGdldEZvcm1hdHRlZExlbmd0aChnZW9tZXRyeSwgdGhpcy5wcm9qZWN0aW9uXywgdGhpcy5wcmVjaXNpb25fLCB0aGlzLnVuaXRQcmVmaXhGb3JtYXRfKTtcbiAgfSBlbHNlIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbVBvaW50KSB7XG4gICAgaWYgKHRoaXMucG9pbnRGaWx0ZXJGbl8gPT09IG51bGwpIHtcbiAgICAgIG1lYXN1cmUgPSBnZXRGb3JtYXR0ZWRQb2ludChnZW9tZXRyeSwgdGhpcy5kZWNpbWFsc18sIHRoaXMubmdlb051bWJlckNvb3JkaW5hdGVzXyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBjb29yZGluYXRlcyA9IGdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCk7XG5cbiAgICAgIGlmICh0aGlzLnBvaW50RmlsdGVyQXJnc18ubGVuZ3RoID4gMSkge1xuICAgICAgICBtZWFzdXJlID0gdGhpcy5wb2ludEZpbHRlckZuXyhjb29yZGluYXRlcywgdGhpcy5wb2ludEZpbHRlckFyZ3NfWzBdLCB0aGlzLnBvaW50RmlsdGVyQXJnc19bMV0pLmpvaW4oJywgJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtZWFzdXJlID0gdGhpcy5wb2ludEZpbHRlckZuXyhjb29yZGluYXRlcywgdGhpcy5wb2ludEZpbHRlckFyZ3NfWzBdKS5qb2luKCcsICcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBtZWFzdXJlO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcbiAgY29uc29sZS5hc3NlcnQoZ2VvbWV0cnksICdHZW9tZXRyeSBzaG91bGQgYmUgdGhydXRoeScpO1xuICB2YXIgdHlwZTtcblxuICBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21Qb2ludCkge1xuICAgIGlmIChmZWF0dXJlLmdldChuZ2VvRm9ybWF0RmVhdHVyZVByb3BlcnRpZXMuSVNfVEVYVCkpIHtcbiAgICAgIHR5cGUgPSBuZ2VvR2VvbWV0cnlUeXBlLlRFWFQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHR5cGUgPSBuZ2VvR2VvbWV0cnlUeXBlLlBPSU5UO1xuICAgIH1cbiAgfSBlbHNlIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbU11bHRpUG9pbnQpIHtcbiAgICB0eXBlID0gbmdlb0dlb21ldHJ5VHlwZS5NVUxUSV9QT0lOVDtcbiAgfSBlbHNlIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbVBvbHlnb24pIHtcbiAgICBpZiAoZmVhdHVyZS5nZXQobmdlb0Zvcm1hdEZlYXR1cmVQcm9wZXJ0aWVzLklTX0NJUkNMRSkpIHtcbiAgICAgIHR5cGUgPSBuZ2VvR2VvbWV0cnlUeXBlLkNJUkNMRTtcbiAgICB9IGVsc2UgaWYgKGZlYXR1cmUuZ2V0KG5nZW9Gb3JtYXRGZWF0dXJlUHJvcGVydGllcy5JU19SRUNUQU5HTEUpKSB7XG4gICAgICB0eXBlID0gbmdlb0dlb21ldHJ5VHlwZS5SRUNUQU5HTEU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHR5cGUgPSBuZ2VvR2VvbWV0cnlUeXBlLlBPTFlHT047XG4gICAgfVxuICB9IGVsc2UgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTXVsdGlQb2x5Z29uKSB7XG4gICAgdHlwZSA9IG5nZW9HZW9tZXRyeVR5cGUuTVVMVElfUE9MWUdPTjtcbiAgfSBlbHNlIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbUxpbmVTdHJpbmcpIHtcbiAgICB0eXBlID0gbmdlb0dlb21ldHJ5VHlwZS5MSU5FX1NUUklORztcbiAgfSBlbHNlIGlmIChnZW9tZXRyeSBpbnN0YW5jZW9mIG9sR2VvbU11bHRpTGluZVN0cmluZykge1xuICAgIHR5cGUgPSBuZ2VvR2VvbWV0cnlUeXBlLk1VTFRJX0xJTkVfU1RSSU5HO1xuICB9XG5cbiAgaWYgKCF0eXBlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHR5cGUnKTtcbiAgfVxuXG4gIHJldHVybiB0eXBlO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZml0TWFwVG9GZWF0dXJlID0gZnVuY3Rpb24gKGZlYXR1cmUsIG1hcCwgb3B0X2R1cmF0aW9uKSB7XG4gIHZhciBkdXJhdGlvbiA9IG9wdF9kdXJhdGlvbiAhPT0gdW5kZWZpbmVkID8gb3B0X2R1cmF0aW9uIDogMjUwO1xuICB2YXIgc2l6ZSA9IG1hcC5nZXRTaXplKCk7XG5cbiAgaWYgKCFBcnJheS5pc0FycmF5KHNpemUpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNpemUnKTtcbiAgfVxuXG4gIHZhciB2aWV3ID0gbWFwLmdldFZpZXcoKTtcbiAgdmFyIHZpZXdFeHRlbnQgPSB2aWV3LmNhbGN1bGF0ZUV4dGVudChzaXplKTtcbiAgdmFyIGdlb21ldHJ5ID0gZmVhdHVyZS5nZXRHZW9tZXRyeSgpO1xuXG4gIGlmICghZ2VvbWV0cnkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnknKTtcbiAgfVxuXG4gIHZhciBnZW9tSXNWaXNpYmxlID0gZ2VvbWV0cnkuaW50ZXJzZWN0c0V4dGVudCh2aWV3RXh0ZW50KTtcbiAgdmFyIG1hcENlbnRlciA9IHZpZXcuZ2V0Q2VudGVyKCk7XG5cbiAgaWYgKCFBcnJheS5pc0FycmF5KG1hcENlbnRlcikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWFwQ2VudGVyJyk7XG4gIH1cblxuICB2YXIgZmVhdHVyZUV4dGVudCA9IGdlb21ldHJ5LmdldEV4dGVudCgpO1xuXG4gIGlmIChnZW9tSXNWaXNpYmxlKSB7XG4gICAgaWYgKCEoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21Qb2ludCkpIHtcbiAgICAgIHZhciBmZWF0dXJlUmVzb2x1dGlvbiA9IHZpZXcuZ2V0UmVzb2x1dGlvbkZvckV4dGVudChmZWF0dXJlRXh0ZW50KTtcbiAgICAgIHZhciBmZWF0dXJlWm9vbVRtcCA9IHZpZXcuZ2V0Wm9vbUZvclJlc29sdXRpb24oZmVhdHVyZVJlc29sdXRpb24pO1xuXG4gICAgICBpZiAoIWZlYXR1cmVab29tVG1wKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBmZWF0dXJlWm9vbScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZmVhdHVyZVpvb20gPSBNYXRoLmZsb29yKGZlYXR1cmVab29tVG1wKTtcbiAgICAgIHZhciB6b29tID0gdmlldy5nZXRab29tKCk7XG5cbiAgICAgIGlmICghem9vbSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgem9vbScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZmVhdHVyZVpvb20gPCB6b29tKSB7XG4gICAgICAgIHZpZXcuYW5pbWF0ZSh7XG4gICAgICAgICAgY2VudGVyOiBtYXBDZW50ZXIsXG4gICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBjZW50ZXI6IG1hcENlbnRlcixcbiAgICAgICAgICBkdXJhdGlvbjogZHVyYXRpb24sXG4gICAgICAgICAgem9vbTogZmVhdHVyZVpvb21cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBmZWF0dXJlRXh0ZW50SGVpZ2h0ID0gb2xFeHRlbnQuZ2V0SGVpZ2h0KGZlYXR1cmVFeHRlbnQpO1xuICAgIHZhciBmZWF0dXJlRXh0ZW50V2lkdGggPSBvbEV4dGVudC5nZXRXaWR0aChmZWF0dXJlRXh0ZW50KTtcbiAgICB2YXIgdmlld0V4dGVudEhlaWdodCA9IG9sRXh0ZW50LmdldEhlaWdodCh2aWV3RXh0ZW50KTtcbiAgICB2YXIgdmlld0V4dGVudFdpZHRoID0gb2xFeHRlbnQuZ2V0V2lkdGgodmlld0V4dGVudCk7XG4gICAgdmFyIGdlb21GaXRzSW5FeHRlbnQgPSB2aWV3RXh0ZW50SGVpZ2h0ID49IGZlYXR1cmVFeHRlbnRIZWlnaHQgJiYgdmlld0V4dGVudFdpZHRoID49IGZlYXR1cmVFeHRlbnRXaWR0aDtcblxuICAgIGlmIChnZW9tRml0c0luRXh0ZW50KSB7XG4gICAgICB2YXIgZmVhdHVyZUNlbnRlcjtcblxuICAgICAgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tTGluZVN0cmluZykge1xuICAgICAgICBmZWF0dXJlQ2VudGVyID0gZ2VvbWV0cnkuZ2V0Q29vcmRpbmF0ZUF0KDAuNSk7XG4gICAgICB9IGVsc2UgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tUG9seWdvbikge1xuICAgICAgICBmZWF0dXJlQ2VudGVyID0gZ2VvbWV0cnkuZ2V0SW50ZXJpb3JQb2ludCgpLmdldENvb3JkaW5hdGVzKCk7XG4gICAgICB9IGVsc2UgaWYgKGdlb21ldHJ5IGluc3RhbmNlb2Ygb2xHZW9tUG9pbnQpIHtcbiAgICAgICAgZmVhdHVyZUNlbnRlciA9IGdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmZWF0dXJlQ2VudGVyID0gb2xFeHRlbnQuZ2V0Q2VudGVyKGdlb21ldHJ5LmdldEV4dGVudCgpKTtcbiAgICAgIH1cblxuICAgICAgdmlldy5hbmltYXRlKHtcbiAgICAgICAgY2VudGVyOiBtYXBDZW50ZXIsXG4gICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvblxuICAgICAgfSwge1xuICAgICAgICBjZW50ZXI6IGZlYXR1cmVDZW50ZXIsXG4gICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvblxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZpZXcuZml0KGZlYXR1cmVFeHRlbnQsIHtcbiAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uLFxuICAgICAgICBzaXplOiBzaXplXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn07XG5cbkZlYXR1cmVIZWxwZXIucHJvdG90eXBlLmdldFJhZGl1c0xpbmUgPSBmdW5jdGlvbiAoZmVhdHVyZSwgYXppbXV0KSB7XG4gIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdlb21ldHJ5Jyk7XG4gIH1cblxuICB2YXIgZXh0ZW50ID0gZ2VvbWV0cnkuZ2V0RXh0ZW50KCk7XG4gIHZhciByYWRpdXMgPSAoZXh0ZW50WzNdIC0gZXh0ZW50WzFdKSAvIDI7XG4gIHZhciBjZW50ZXIgPSBvbEV4dGVudC5nZXRDZW50ZXIoZ2VvbWV0cnkuZ2V0RXh0ZW50KCkpO1xuICB2YXIgeCA9IE1hdGguY29zKChhemltdXQgLSA5MCkgKiBNYXRoLlBJIC8gMTgwKSAqIHJhZGl1cztcbiAgdmFyIHkgPSAtTWF0aC5zaW4oKGF6aW11dCAtIDkwKSAqIE1hdGguUEkgLyAxODApICogcmFkaXVzO1xuICB2YXIgZW5kUG9pbnQgPSBbeCArIGNlbnRlclswXSwgeSArIGNlbnRlclsxXV07XG4gIHJldHVybiBuZXcgb2xHZW9tTGluZVN0cmluZyhbY2VudGVyLCBlbmRQb2ludF0pO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuZ2V0Tm9uU3BhdGlhbFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoZmVhdHVyZSkge1xuICB2YXIgZ2VvbWV0cnlOYW1lID0gZmVhdHVyZS5nZXRHZW9tZXRyeU5hbWUoKTtcbiAgdmFyIG5vblNwYXRpYWxQcm9wZXJ0aWVzID0ge307XG4gIHZhciBwcm9wZXJ0aWVzID0gZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCk7XG5cbiAgZm9yICh2YXIga2V5IGluIHByb3BlcnRpZXMpIHtcbiAgICBpZiAoa2V5ICE9PSBnZW9tZXRyeU5hbWUpIHtcbiAgICAgIG5vblNwYXRpYWxQcm9wZXJ0aWVzW2tleV0gPSBwcm9wZXJ0aWVzW2tleV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5vblNwYXRpYWxQcm9wZXJ0aWVzO1xufTtcblxuRmVhdHVyZUhlbHBlci5wcm90b3R5cGUuY2xlYXJOb25TcGF0aWFsUHJvcGVydGllcyA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gIHZhciBnZW9tZXRyeU5hbWUgPSBmZWF0dXJlLmdldEdlb21ldHJ5TmFtZSgpO1xuICB2YXIgcHJvcGVydGllcyA9IGZlYXR1cmUuZ2V0UHJvcGVydGllcygpO1xuXG4gIGZvciAodmFyIGtleSBpbiBwcm9wZXJ0aWVzKSB7XG4gICAgaWYgKGtleSAhPT0gZ2VvbWV0cnlOYW1lKSB7XG4gICAgICBmZWF0dXJlLnNldChrZXksIHVuZGVmaW5lZCk7XG4gICAgfVxuICB9XG59O1xuXG5GZWF0dXJlSGVscGVyLnByb3RvdHlwZS5maW5kRmVhdHVyZUluZGV4QnlGaWQgPSBmdW5jdGlvbiAoZmVhdHVyZXMsIGZpZCkge1xuICB2YXIgaW5kZXggPSAtMTtcblxuICBmb3IgKHZhciBpID0gMCwgaWkgPSBmZWF0dXJlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgaWYgKGZlYXR1cmVzW2ldLmdldElkKCkgPT0gZmlkKSB7XG4gICAgICBpbmRleCA9IGk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gaW5kZXg7XG59O1xuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9GZWF0dXJlSGVscGVyJywgW25nZW9Eb3dubG9hZFNlcnZpY2UubmFtZSwgbmdlb01pc2NGaWx0ZXJzLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvRmVhdHVyZUhlbHBlcicsIEZlYXR1cmVIZWxwZXIpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIkZpbGVTZXJ2aWNlLiRpbmplY3QgPSBbXCIkcVwiLCBcIiRodHRwXCIsIFwiZ2V0dGV4dFwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuZXhwb3J0IGZ1bmN0aW9uIEZpbGVTZXJ2aWNlKCRxLCAkaHR0cCwgZ2V0dGV4dCkge1xuICB0aGlzLmlzVmFsaWRGaWxlU2l6ZSA9IGZ1bmN0aW9uIChmaWxlU2l6ZSkge1xuICAgIHJldHVybiBmaWxlU2l6ZSA8PSAyMDAwMDAwMDtcbiAgfTtcblxuICB0aGlzLmlzV21zR2V0Q2FwID0gZnVuY3Rpb24gKGZpbGVDb250ZW50KSB7XG4gICAgcmV0dXJuIC88KFdNVF9NU19DYXBhYmlsaXRpZXN8V01TX0NhcGFiaWxpdGllcykvLnRlc3QoZmlsZUNvbnRlbnQpO1xuICB9O1xuXG4gIHRoaXMuaXNXbXRzR2V0Q2FwID0gZnVuY3Rpb24gKGZpbGVDb250ZW50KSB7XG4gICAgcmV0dXJuIGZpbGVDb250ZW50LmluY2x1ZGVzKCc8Q2FwYWJpbGl0aWVzJyk7XG4gIH07XG5cbiAgdGhpcy5pc0ttbCA9IGZ1bmN0aW9uIChmaWxlQ29udGVudCkge1xuICAgIHJldHVybiBmaWxlQ29udGVudC5pbmNsdWRlcygnPGttbCcpICYmIGZpbGVDb250ZW50LmluY2x1ZGVzKCc8L2ttbD4nKTtcbiAgfTtcblxuICB0aGlzLmlzR3B4ID0gZnVuY3Rpb24gKGZpbGVDb250ZW50KSB7XG4gICAgcmV0dXJuIGZpbGVDb250ZW50LmluY2x1ZGVzKCc8Z3B4JykgJiYgZmlsZUNvbnRlbnQuaW5jbHVkZXMoJzwvZ3B4PicpO1xuICB9O1xuXG4gIHZhciBmaWxlUmVhZGVyID0gbnVsbDtcblxuICB0aGlzLnJlYWQgPSBmdW5jdGlvbiAoZmlsZSkge1xuICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XG5cbiAgICBpZiAoZmlsZVJlYWRlciAmJiBmaWxlUmVhZGVyLnJlYWR5U3RhdGUgPT09IEZpbGVSZWFkZXIuTE9BRElORykge1xuICAgICAgZmlsZVJlYWRlci5hYm9ydCgpO1xuICAgIH1cblxuICAgIGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICB2YXIgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcblxuICAgICAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgRmlsZVJlYWRlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyB0YXJnZXQgdHlwZScpO1xuICAgICAgfVxuXG4gICAgICBkZWZlci5yZXNvbHZlKHRhcmdldC5yZXN1bHQpO1xuICAgIH07XG5cbiAgICBmaWxlUmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICB2YXIgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcblxuICAgICAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgRmlsZVJlYWRlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyB0YXJnZXQgdHlwZScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZXJyID0gdGFyZ2V0LmVycm9yO1xuXG4gICAgICBpZiAoIWVycikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5lcnJvcignUmVhZGluZyBmaWxlIGZhaWxlZDogJywgZXJyKTtcbiAgICAgIGRlZmVyLnJlamVjdCh7XG4gICAgICAgICdtZXNzYWdlJzogZXJyLmNvZGUgPT0gMjAgPyBnZXR0ZXh0KCdPcGVyYXRpb24gY2FuY2VsZWQnKSA6IGdldHRleHQoJ1JlYWQgZmFpbGVkJyksXG4gICAgICAgICdyZWFzb24nOiBlcnIubWVzc2FnZVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGZpbGVSZWFkZXIub25wcm9ncmVzcyA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICAgIGRlZmVyLm5vdGlmeShldnQpO1xuICAgIH07XG5cbiAgICBmaWxlUmVhZGVyLnJlYWRBc1RleHQoZmlsZSk7XG4gICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XG4gIH07XG5cbiAgdmFyIGNhbmNlbGVyO1xuXG4gIHRoaXMubG9hZCA9IGZ1bmN0aW9uICh1cmwsIG9wdF9jYW5jZWxQKSB7XG4gICAgaWYgKGNhbmNlbGVyKSB7XG4gICAgICBjYW5jZWxlci5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgY2FuY2VsZXIgPSBvcHRfY2FuY2VsUCB8fCAkcS5kZWZlcigpO1xuICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XG4gICAgJGh0dHAuZ2V0KHVybCwge1xuICAgICAgdGltZW91dDogY2FuY2VsZXIucHJvbWlzZVxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBkZWZlci5yZXNvbHZlKHJlc3BvbnNlLmRhdGEpO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1VwbG9hZGluZyBmaWxlIGZhaWxlZDogJywgcmVhc29uKTtcbiAgICAgIGRlZmVyLnJlamVjdCh7XG4gICAgICAgICdtZXNzYWdlJzogZ2V0dGV4dCgnVXBsb2FkIGZhaWxlZCcpLFxuICAgICAgICAncmVhc29uJzogcmVhc29uXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcbiAgfTtcbn1cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0ZpbGUnLCBbXSk7XG5tb2R1bGUuc2VydmljZSgnbmdlb0ZpbGUnLCBGaWxlU2VydmljZSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5leHBvcnQgZnVuY3Rpb24gVGltZSgpIHt9XG5cblRpbWUucHJvdG90eXBlLmNyZWF0ZURhdGUgPSBmdW5jdGlvbiAodmFsdWUsIGRlZmF1bHRWYWx1ZSkge1xuICBpZiAoZGVmYXVsdFZhbHVlID09PSB2b2lkIDApIHtcbiAgICBkZWZhdWx0VmFsdWUgPSBudWxsO1xuICB9XG5cbiAgcmV0dXJuIHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9IHVuZGVmaW5lZCA/IG5ldyBEYXRlKHZhbHVlKSA6IGRlZmF1bHRWYWx1ZTtcbn07XG5cblRpbWUucHJvdG90eXBlLmdldFRpbWUgPSBmdW5jdGlvbiAoZGF0ZSwgZGVmYXVsdFZhbHVlKSB7XG4gIGlmIChkZWZhdWx0VmFsdWUgPT09IHZvaWQgMCkge1xuICAgIGRlZmF1bHRWYWx1ZSA9IG51bGw7XG4gIH1cblxuICByZXR1cm4gZGF0ZSA/IGRhdGUuZ2V0VGltZSgpIDogZGVmYXVsdFZhbHVlO1xufTtcblxuVGltZS5wcm90b3R5cGUuZ2V0T3B0aW9ucyA9IGZ1bmN0aW9uICh0aW1lKSB7XG4gIHZhciBtaW5EYXRlID0gdGhpcy5jcmVhdGVEYXRlKHRpbWUubWluVmFsdWUpO1xuICB2YXIgbWF4RGF0ZSA9IHRoaXMuY3JlYXRlRGF0ZSh0aW1lLm1heFZhbHVlKTtcbiAgdmFyIG1pbkRlZmF1bHREYXRlID0gdGhpcy5jcmVhdGVEYXRlKHRpbWUubWluRGVmVmFsdWUsIG1pbkRhdGUpO1xuICB2YXIgbWF4RGVmYXVsdERhdGUgPSB0aGlzLmNyZWF0ZURhdGUodGltZS5tYXhEZWZWYWx1ZSwgbWF4RGF0ZSk7XG5cbiAgaWYgKCFtaW5EZWZhdWx0RGF0ZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtaW5EZWZhdWx0RGF0ZScpO1xuICB9XG5cbiAgaWYgKCFtYXhEZWZhdWx0RGF0ZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYXhEZWZhdWx0RGF0ZScpO1xuICB9XG5cbiAgdmFyIG1pblRpbWUgPSB0aGlzLmdldFRpbWUobWluRGF0ZSk7XG4gIHZhciBtYXhUaW1lID0gdGhpcy5nZXRUaW1lKG1heERhdGUpO1xuXG4gIGlmICghbWluVGltZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtaW5UaW1lJyk7XG4gIH1cblxuICBpZiAoIW1heFRpbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWF4VGltZScpO1xuICB9XG5cbiAgdmFyIG1pbkRlZmF1bHRUaW1lID0gdGhpcy5nZXRUaW1lKG1pbkRlZmF1bHREYXRlKTtcbiAgdmFyIG1heERlZmF1bHRUaW1lID0gdGhpcy5nZXRUaW1lKG1heERlZmF1bHREYXRlKTtcblxuICBpZiAoIW1pbkRlZmF1bHRUaW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1pbkRlZmF1bHRUaW1lJyk7XG4gIH1cblxuICB2YXIgZGVmYXVsdFZhbHVlcyA9IG1pbkRlZmF1bHRUaW1lO1xuXG4gIGlmICh0aW1lLm1vZGUgPT09ICdyYW5nZScpIHtcbiAgICBpZiAoIW1heERlZmF1bHRUaW1lKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWF4RGVmYXVsdFRpbWUnKTtcbiAgICB9XG5cbiAgICBkZWZhdWx0VmFsdWVzID0gW21pbkRlZmF1bHRUaW1lLCBtYXhEZWZhdWx0VGltZV07XG4gIH1cblxuICByZXR1cm4ge1xuICAgIG1pbkRhdGU6IG1pblRpbWUsXG4gICAgbWF4RGF0ZTogbWF4VGltZSxcbiAgICB2YWx1ZXM6IGRlZmF1bHRWYWx1ZXNcbiAgfTtcbn07XG5cblRpbWUucHJvdG90eXBlLmdldFVUQ0RhdGUgPSBmdW5jdGlvbiAobG9jYWxEYXRlKSB7XG4gIHJldHVybiBuZXcgRGF0ZShsb2NhbERhdGUuZ2V0VVRDRnVsbFllYXIoKSwgbG9jYWxEYXRlLmdldFVUQ01vbnRoKCksIGxvY2FsRGF0ZS5nZXRVVENEYXRlKCkpO1xufTtcblxudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvVGltZScsIFtdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvVGltZScsIFRpbWUpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uICh0b29sQ29udGV4dCwgYWN0aXZlUHJvcGVydHlOYW1lKSB7XG4gIHRoaXMuZ2V0QWN0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0b29sQ29udGV4dFthY3RpdmVQcm9wZXJ0eU5hbWVdO1xuICB9O1xuXG4gIHRoaXMuc2V0QWN0aXZlID0gZnVuY3Rpb24gKG5ld1ZhbCkge1xuICAgIHRvb2xDb250ZXh0W2FjdGl2ZVByb3BlcnR5TmFtZV0gPSBuZXdWYWw7XG4gIH07XG59IiwiVG9vbEFjdGl2YXRlTWdyLiRpbmplY3QgPSBbXCIkcm9vdFNjb3BlXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5leHBvcnQgZnVuY3Rpb24gVG9vbEFjdGl2YXRlTWdyKCRyb290U2NvcGUpIHtcbiAgdGhpcy5ncm91cHNfID0ge307XG4gIHRoaXMuc2NvcGVfID0gJHJvb3RTY29wZTtcbn1cblxuVG9vbEFjdGl2YXRlTWdyLnByb3RvdHlwZS5yZWdpc3RlclRvb2wgPSBmdW5jdGlvbiAoZ3JvdXBOYW1lLCB0b29sLCBvcHRfZGVmYXVsdEFjdGl2YXRlKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgaWYgKCF0aGlzLmdyb3Vwc19bZ3JvdXBOYW1lXSkge1xuICAgIHRoaXMuZ3JvdXBzX1tncm91cE5hbWVdID0gW107XG4gIH1cblxuICB2YXIgdW5saXN0ZW4gPSB0aGlzLnNjb3BlXy4kd2F0Y2godG9vbC5nZXRBY3RpdmUsIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xuICAgIGlmIChuZXdWYWwgPT09IG9sZFZhbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChuZXdWYWwpIHtcbiAgICAgIF90aGlzLmRlYWN0aXZhdGVUb29sc18oZ3JvdXBOYW1lLCB0b29sKTtcbiAgICB9IGVsc2Uge1xuICAgICAgX3RoaXMuYWN0aXZhdGVEZWZhdWx0Xyhncm91cE5hbWUpO1xuICAgIH1cbiAgfSk7XG4gIHRoaXMuZ3JvdXBzX1tncm91cE5hbWVdLnB1c2goe1xuICAgIHRvb2w6IHRvb2wsXG4gICAgZGVmYXVsdFRvb2w6IG9wdF9kZWZhdWx0QWN0aXZhdGUgfHwgZmFsc2UsXG4gICAgdW5saXN0ZW46IHVubGlzdGVuXG4gIH0pO1xufTtcblxuVG9vbEFjdGl2YXRlTWdyLnByb3RvdHlwZS51bnJlZ2lzdGVyVG9vbCA9IGZ1bmN0aW9uIChncm91cE5hbWUsIHRvb2wpIHtcbiAgdmFyIGVudHJpZXMgPSB0aGlzLmdyb3Vwc19bZ3JvdXBOYW1lXTtcblxuICBpZiAoZW50cmllcykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZW50cmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGVudHJpZXNbaV0udG9vbCA9PSB0b29sKSB7XG4gICAgICAgIGVudHJpZXNbaV0udW5saXN0ZW4oKTtcbiAgICAgICAgZW50cmllcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuVG9vbEFjdGl2YXRlTWdyLnByb3RvdHlwZS51bnJlZ2lzdGVyR3JvdXAgPSBmdW5jdGlvbiAoZ3JvdXBOYW1lKSB7XG4gIHZhciBlbnRyaWVzID0gdGhpcy5ncm91cHNfW2dyb3VwTmFtZV07XG5cbiAgaWYgKGVudHJpZXMpIHtcbiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBlbnRyaWVzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZW50cnkgPSBfcmVmO1xuICAgICAgZW50cnkudW5saXN0ZW4oKTtcbiAgICB9XG5cbiAgICBkZWxldGUgdGhpcy5ncm91cHNfW2dyb3VwTmFtZV07XG4gIH1cbn07XG5cblRvb2xBY3RpdmF0ZU1nci5wcm90b3R5cGUuYWN0aXZhdGVUb29sID0gZnVuY3Rpb24gKHRvb2wpIHtcbiAgdG9vbC5zZXRBY3RpdmUodHJ1ZSk7XG59O1xuXG5Ub29sQWN0aXZhdGVNZ3IucHJvdG90eXBlLmRlYWN0aXZhdGVUb29sID0gZnVuY3Rpb24gKHRvb2wpIHtcbiAgdG9vbC5zZXRBY3RpdmUoZmFsc2UpO1xufTtcblxuVG9vbEFjdGl2YXRlTWdyLnByb3RvdHlwZS5kZWFjdGl2YXRlVG9vbHNfID0gZnVuY3Rpb24gKGdyb3VwTmFtZSwgdG9vbCkge1xuICB2YXIgZW50cmllcyA9IHRoaXMuZ3JvdXBzX1tncm91cE5hbWVdO1xuXG4gIGZvciAodmFyIF9pdGVyYXRvcjIgPSBlbnRyaWVzLCBfaXNBcnJheTIgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjIpLCBfaTIgPSAwLCBfaXRlcmF0b3IyID0gX2lzQXJyYXkyID8gX2l0ZXJhdG9yMiA6IF9pdGVyYXRvcjJbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICB2YXIgX3JlZjI7XG5cbiAgICBpZiAoX2lzQXJyYXkyKSB7XG4gICAgICBpZiAoX2kyID49IF9pdGVyYXRvcjIubGVuZ3RoKSBicmVhaztcbiAgICAgIF9yZWYyID0gX2l0ZXJhdG9yMltfaTIrK107XG4gICAgfSBlbHNlIHtcbiAgICAgIF9pMiA9IF9pdGVyYXRvcjIubmV4dCgpO1xuICAgICAgaWYgKF9pMi5kb25lKSBicmVhaztcbiAgICAgIF9yZWYyID0gX2kyLnZhbHVlO1xuICAgIH1cblxuICAgIHZhciBlbnRyeSA9IF9yZWYyO1xuXG4gICAgaWYgKHRvb2wgIT0gZW50cnkudG9vbCkge1xuICAgICAgZW50cnkudG9vbC5zZXRBY3RpdmUoZmFsc2UpO1xuICAgIH1cbiAgfVxufTtcblxuVG9vbEFjdGl2YXRlTWdyLnByb3RvdHlwZS5hY3RpdmF0ZURlZmF1bHRfID0gZnVuY3Rpb24gKGdyb3VwTmFtZSkge1xuICB2YXIgZW50cmllcyA9IHRoaXMuZ3JvdXBzX1tncm91cE5hbWVdO1xuICB2YXIgZGVmYXVsdFRvb2wgPSBudWxsO1xuICB2YXIgaGFzQWN0aXZlVG9vbCA9IGZhbHNlO1xuXG4gIGZvciAodmFyIF9pdGVyYXRvcjMgPSBlbnRyaWVzLCBfaXNBcnJheTMgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjMpLCBfaTMgPSAwLCBfaXRlcmF0b3IzID0gX2lzQXJyYXkzID8gX2l0ZXJhdG9yMyA6IF9pdGVyYXRvcjNbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICB2YXIgX3JlZjM7XG5cbiAgICBpZiAoX2lzQXJyYXkzKSB7XG4gICAgICBpZiAoX2kzID49IF9pdGVyYXRvcjMubGVuZ3RoKSBicmVhaztcbiAgICAgIF9yZWYzID0gX2l0ZXJhdG9yM1tfaTMrK107XG4gICAgfSBlbHNlIHtcbiAgICAgIF9pMyA9IF9pdGVyYXRvcjMubmV4dCgpO1xuICAgICAgaWYgKF9pMy5kb25lKSBicmVhaztcbiAgICAgIF9yZWYzID0gX2kzLnZhbHVlO1xuICAgIH1cblxuICAgIHZhciBlbnRyeSA9IF9yZWYzO1xuICAgIGhhc0FjdGl2ZVRvb2wgPSBoYXNBY3RpdmVUb29sIHx8IGVudHJ5LnRvb2wuZ2V0QWN0aXZlKCk7XG5cbiAgICBpZiAoZW50cnkuZGVmYXVsdFRvb2wpIHtcbiAgICAgIGRlZmF1bHRUb29sID0gZW50cnkudG9vbDtcbiAgICB9XG4gIH1cblxuICBpZiAoIWhhc0FjdGl2ZVRvb2wgJiYgZGVmYXVsdFRvb2wgIT09IG51bGwpIHtcbiAgICBkZWZhdWx0VG9vbC5zZXRBY3RpdmUodHJ1ZSk7XG4gIH1cbn07XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb1Rvb2xBY3RpdmF0ZU1ncicsIFtdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvVG9vbEFjdGl2YXRlTWdyJywgVG9vbEFjdGl2YXRlTWdyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJmdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb01pc2NUaW1lLCB7IFRpbWUgfSBmcm9tICduZ2VvL21pc2MvVGltZS5qcyc7XG5leHBvcnQgdmFyIFdNU1RpbWUgPSBmdW5jdGlvbiAoX1RpbWUpIHtcbiAgV01TVGltZS4kaW5qZWN0ID0gW1wiJGZpbHRlclwiLCBcImdldHRleHRDYXRhbG9nXCJdO1xuXG4gIF9pbmhlcml0c0xvb3NlKFdNU1RpbWUsIF9UaW1lKTtcblxuICBmdW5jdGlvbiBXTVNUaW1lKCRmaWx0ZXIsIGdldHRleHRDYXRhbG9nKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX3RoaXMgPSBfVGltZS5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgX3RoaXMuJGZpbHRlcl8gPSAkZmlsdGVyO1xuICAgIF90aGlzLmdldHRleHRDYXRhbG9nXyA9IGdldHRleHRDYXRhbG9nO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBXTVNUaW1lLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZm9ybWF0VGltZVZhbHVlID0gZnVuY3Rpb24gZm9ybWF0VGltZVZhbHVlKHRpbWUsIHJlc29sdXRpb24sIG9wdF91c2VJU09Gb3JtYXQsIG9wdF90b1VUQykge1xuICAgIHZhciBkYXRlID0gbmV3IERhdGUodGltZSk7XG4gICAgdmFyIHV0YyA9IG9wdF90b1VUQyA/ICdVVEMnIDogdW5kZWZpbmVkO1xuICAgIHZhciB5ZWFyUmVzb2x1dGlvbiA9ICd5eXl5JztcbiAgICB2YXIgbW9udGhSZXNvbHV0aW9uID0gJ3l5eXktTU0nO1xuICAgIHZhciBkYXlSZXNvbHV0aW9uID0gJ3l5eXktTU0tZGQnO1xuICAgIHZhciBzZWNvbmRSZXNvbHV0aW9uID0gbnVsbDtcblxuICAgIGlmICghb3B0X3VzZUlTT0Zvcm1hdCkge1xuICAgICAgdmFyIGdldHRleHRDYXRhbG9nID0gdGhpcy5nZXR0ZXh0Q2F0YWxvZ187XG4gICAgICB5ZWFyUmVzb2x1dGlvbiA9IGdldHRleHRDYXRhbG9nLmdldFN0cmluZygneXl5eScpO1xuICAgICAgbW9udGhSZXNvbHV0aW9uID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdNL3l5eXknKTtcbiAgICAgIGRheVJlc29sdXRpb24gPSBnZXR0ZXh0Q2F0YWxvZy5nZXRTdHJpbmcoJ00vZC95eXl5Jyk7XG4gICAgICBzZWNvbmRSZXNvbHV0aW9uID0gZ2V0dGV4dENhdGFsb2cuZ2V0U3RyaW5nKCdNL2QveXl5eSBISDpNTTpzcycpO1xuICAgIH1cblxuICAgIHN3aXRjaCAocmVzb2x1dGlvbikge1xuICAgICAgY2FzZSAneWVhcic6XG4gICAgICAgIHJldHVybiB0aGlzLiRmaWx0ZXJfKCdkYXRlJykoZGF0ZSwgeWVhclJlc29sdXRpb24sIHV0Yyk7XG5cbiAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuJGZpbHRlcl8oJ2RhdGUnKShkYXRlLCBtb250aFJlc29sdXRpb24sIHV0Yyk7XG5cbiAgICAgIGNhc2UgJ2RheSc6XG4gICAgICAgIHJldHVybiB0aGlzLiRmaWx0ZXJfKCdkYXRlJykoZGF0ZSwgZGF5UmVzb2x1dGlvbiwgdXRjKTtcblxuICAgICAgY2FzZSAnc2Vjb25kJzpcbiAgICAgICAgaWYgKHNlY29uZFJlc29sdXRpb24pIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy4kZmlsdGVyXygnZGF0ZScpKGRhdGUsIHNlY29uZFJlc29sdXRpb24sIHV0Yyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9cXC5cXGR7M30vLCAnJyk7XG4gICAgICAgIH1cblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9cXC5cXGR7M30vLCAnJyk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5mb3JtYXRXTVNUaW1lUGFyYW0gPSBmdW5jdGlvbiBmb3JtYXRXTVNUaW1lUGFyYW0od21zVGltZVByb3BlcnR5LCB0aW1lcywgb3B0X3RvVVRDKSB7XG4gICAgY29uc29sZS5hc3NlcnQod21zVGltZVByb3BlcnR5LnJlc29sdXRpb24gIT09IHVuZGVmaW5lZCk7XG5cbiAgICBpZiAod21zVGltZVByb3BlcnR5Lm1vZGUgPT09ICdyYW5nZScpIHtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KHRpbWVzLmVuZCAhPT0gdW5kZWZpbmVkKTtcbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdFRpbWVWYWx1ZSh0aW1lcy5zdGFydCwgd21zVGltZVByb3BlcnR5LnJlc29sdXRpb24sIHRydWUsIG9wdF90b1VUQykgKyBcIi9cIiArIHRoaXMuZm9ybWF0VGltZVZhbHVlKHRpbWVzLmVuZCwgd21zVGltZVByb3BlcnR5LnJlc29sdXRpb24sIHRydWUsIG9wdF90b1VUQyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdFRpbWVWYWx1ZSh0aW1lcy5zdGFydCwgd21zVGltZVByb3BlcnR5LnJlc29sdXRpb24sIHRydWUsIG9wdF90b1VUQyk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBXTVNUaW1lO1xufShUaW1lKTtcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb1dNU1RpbWUnLCBbbmdlb01pc2NUaW1lLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvV01TVGltZScsIFdNU1RpbWUpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImJ1dHRvbkNvbXBvbmVudC4kaW5qZWN0ID0gW1wiJHBhcnNlXCJdO1xuYnV0dG9uR3JvdXBDb21wb25lbnQuJGluamVjdCA9IFtcIiRwYXJzZVwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvQnRuQ29tcG9uZW50JywgW10pO1xuXG5mdW5jdGlvbiBidXR0b25Hcm91cENvbXBvbmVudCgkcGFyc2UpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIGNvbnRyb2xsZXI6ICduZ2VvQnRuR3JvdXBDb250cm9sbGVyJyxcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY29udHJvbGxlcikge1xuICAgICAgaWYgKCFjb250cm9sbGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjb250cm9sbGVyJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBzZXRBY3RpdmUgPSAkcGFyc2UoYXR0cnMubmdlb0J0bkdyb3VwQWN0aXZlKS5hc3NpZ247XG5cbiAgICAgIGlmIChzZXRBY3RpdmUpIHtcbiAgICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gY29udHJvbGxlci5idXR0b25zXy5zb21lKGZ1bmN0aW9uIChidXR0b25Nb2RlbCkge1xuICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbk1vZGVsKHNjb3BlKSA9PT0gdHJ1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgc2V0QWN0aXZlKHNjb3BlLCBuZXdWYWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb0J0bkdyb3VwJywgYnV0dG9uR3JvdXBDb21wb25lbnQpO1xuXG52YXIgQnRuR3JvdXBDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICBCdG5Hcm91cENvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiXTtcblxuICBmdW5jdGlvbiBCdG5Hcm91cENvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgdGhpcy5idXR0b25zXyA9IFtdO1xuICAgIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IEJ0bkdyb3VwQ29udHJvbGxlci5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmFjdGl2YXRlID0gZnVuY3Rpb24gYWN0aXZhdGUoaW5kZXgpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdGhpcy5idXR0b25zXy5mb3JFYWNoKGZ1bmN0aW9uIChleHByZXNzaW9uRm4sIGkpIHtcbiAgICAgIGlmIChpICE9IGluZGV4KSB7XG4gICAgICAgIGV4cHJlc3Npb25Gbi5hc3NpZ24oX3RoaXMuc2NvcGVfLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLmFkZEJ1dHRvbiA9IGZ1bmN0aW9uIGFkZEJ1dHRvbihleHByZXNzaW9uRm4pIHtcbiAgICB0aGlzLmJ1dHRvbnNfLnB1c2goZXhwcmVzc2lvbkZuKTtcbiAgICByZXR1cm4gdGhpcy5idXR0b25zXy5sZW5ndGggLSAxO1xuICB9O1xuXG4gIHJldHVybiBCdG5Hcm91cENvbnRyb2xsZXI7XG59KCk7XG5cbm1vZHVsZS5jb250cm9sbGVyKCduZ2VvQnRuR3JvdXBDb250cm9sbGVyJywgQnRuR3JvdXBDb250cm9sbGVyKTtcblxuZnVuY3Rpb24gYnV0dG9uQ29tcG9uZW50KCRwYXJzZSkge1xuICByZXR1cm4ge1xuICAgIHJlcXVpcmU6IFsnP15uZ2VvQnRuR3JvdXAnLCAnbmdNb2RlbCddLFxuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmxzKSB7XG4gICAgICBpZiAoIWN0cmxzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjdHJscycpO1xuICAgICAgfVxuXG4gICAgICB2YXIgYnV0dG9uc0N0cmwgPSBjdHJsc1swXTtcbiAgICAgIHZhciBuZ01vZGVsQ3RybCA9IGN0cmxzWzFdO1xuICAgICAgdmFyIGluZGV4SW5Hcm91cCA9IC0xO1xuICAgICAgdmFyIG5nTW9kZWxHZXQgPSAkcGFyc2UoYXR0cnMubmdNb2RlbCk7XG4gICAgICB2YXIgbmdNb2RlbFNldCA9IG5nTW9kZWxHZXQuYXNzaWduO1xuXG4gICAgICBpZiAobmdNb2RlbEdldChzY29wZSkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBuZ01vZGVsU2V0KHNjb3BlLCBmYWxzZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChidXR0b25zQ3RybCAhPT0gbnVsbCkge1xuICAgICAgICBpbmRleEluR3JvdXAgPSBidXR0b25zQ3RybC5hZGRCdXR0b24obmdNb2RlbEdldCk7XG4gICAgICB9XG5cbiAgICAgIGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoIW5nTW9kZWxDdHJsLiR2aWV3VmFsdWUpO1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgJiYgYnV0dG9uc0N0cmwgIT09IG51bGwpIHtcbiAgICAgICAgICBidXR0b25zQ3RybC5hY3RpdmF0ZShpbmRleEluR3JvdXApO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxlbWVudC50b2dnbGVDbGFzcygnYWN0aXZlJywgbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSk7XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb0J0bicsIGJ1dHRvbkNvbXBvbmVudCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPHRhYmxlIGNsYXNzPVwibmdlby1jb2xvcnBpY2tlci1wYWxldHRlXCI+XFxuICA8dHIgbmctcmVwZWF0PVwiY29sb3JzIGluIDo6Y3RybC5jb2xvcnNcIj5cXG4gICAgPHRkXFxuICAgICAgbmctcmVwZWF0PVwiY29sb3IgaW4gOjpjb2xvcnNcIlxcbiAgICAgIG5nLWNsaWNrPVwiY3RybC5zZXRDb2xvcihjb2xvcilcIlxcbiAgICAgIG5nLWNsYXNzPVwie1xcJ25nZW8tY29sb3JwaWNrZXItc2VsZWN0ZWRcXCc6IGNvbG9yID09IGN0cmwuY29sb3J9XCI+XFxuICAgICAgPGRpdiBuZy1zdHlsZT1cIjo6e1xcJ2JhY2tncm91bmQtY29sb3JcXCc6IGNvbG9yfVwiPjwvZGl2PlxcbiAgICA8L3RkPlxcbiAgPC90cj5cXG48L3RhYmxlPlxcbic7XG5cbn1cbnJldHVybiBfX3Bcbn0iLCJjb2xvclBpY2tlckNvbXBvbmVudC4kaW5qZWN0ID0gW1wibmdlb0NvbG9ycGlja2VyVGVtcGxhdGVVcmxcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0NvbG9ycGlja2VyJywgW10pO1xubW9kdWxlLnZhbHVlKCduZ2VvQ29sb3JwaWNrZXJUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uIChlbGVtZW50LCBhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSBhdHRyc1snbmdlb0NvbG9ycGlja2VyVGVtcGxhdGV1cmwnXTtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICduZ2VvL21pc2MvY29sb3JwaWNrZXJDb21wb25lbnQnO1xufSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ25nZW8vbWlzYy9jb2xvcnBpY2tlckNvbXBvbmVudCcsIHJlcXVpcmUoJy4vY29sb3JwaWNrZXJDb21wb25lbnQuaHRtbCcpKTtcbn1dKTtcblxuZnVuY3Rpb24gY29sb3JQaWNrZXJDb21wb25lbnQobmdlb0NvbG9ycGlja2VyVGVtcGxhdGVVcmwpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHNjb3BlOiB7XG4gICAgICBjb2xvcnM6ICc8P25nZW9Db2xvcnBpY2tlcicsXG4gICAgICBjb2xvcjogJz0/bmdlb0NvbG9ycGlja2VyQ29sb3InXG4gICAgfSxcbiAgICBjb250cm9sbGVyOiAnTmdlb0NvbG9ycGlja2VyQ29udHJvbGxlciBhcyBjdHJsJyxcbiAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgIHRlbXBsYXRlVXJsOiBuZ2VvQ29sb3JwaWNrZXJUZW1wbGF0ZVVybFxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvQ29sb3JwaWNrZXInLCBjb2xvclBpY2tlckNvbXBvbmVudCk7XG52YXIgREVGQVVMVF9DT0xPUlMgPSBbWycjRjRFQjM3JywgJyNDRERDMzknLCAnIzYyQUY0NCcsICcjMDA5RDU3JywgJyMwQkE5Q0MnLCAnIzQxODZGMCcsICcjM0Y1QkE5JywgJyM3QzM1OTInLCAnI0E2MUI0QScsICcjREI0NDM2JywgJyNGODk3MUInLCAnI0Y0QjQwMCcsICcjNzk1MDQ2J10sIFsnI0Y5RjdBNicsICcjRTZFRUEzJywgJyNCN0RCQUInLCAnIzdDQ0ZBOScsICcjOTNEN0U4JywgJyM5RkMzRkYnLCAnI0E3QjVENycsICcjQzZBNENGJywgJyNENjk4QUQnLCAnI0VFOUM5NicsICcjRkFEMTk5JywgJyNGRkRENUUnLCAnI0IyOTE4OSddLCBbJyNmZmZmZmYnLCAnI0NDQ0NDQycsICcjNzc3JywgJyMwMDAwMDAnXV07XG5cbmZ1bmN0aW9uIENvbnRyb2xsZXIoKSB7XG4gIHRoaXMuY29sb3JzID0gdGhpcy5jb2xvcnMgfHwgREVGQVVMVF9DT0xPUlM7XG4gIHRoaXMuY29sb3I7XG59XG5cbkNvbnRyb2xsZXIucHJvdG90eXBlLnNldENvbG9yID0gZnVuY3Rpb24gKGNvbG9yKSB7XG4gIHRoaXMuY29sb3IgPSBjb2xvcjtcbn07XG5cbm1vZHVsZS5jb250cm9sbGVyKCdOZ2VvQ29sb3JwaWNrZXJDb250cm9sbGVyJywgQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgb2xNYXAgZnJvbSAnb2wvTWFwLmpzJztcbmltcG9ydCBvbENvbnRyb2xDb250cm9sIGZyb20gJ29sL2NvbnRyb2wvQ29udHJvbC5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9Db250cm9sJywgW10pO1xuXG5mdW5jdGlvbiBjb250cm9sQ29tcG9uZW50KCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIHZhciBjb250cm9sID0gc2NvcGUuJGV2YWwoYXR0cnNbJ25nZW9Db250cm9sJ10pO1xuICAgICAgY29uc29sZS5hc3NlcnQoY29udHJvbCBpbnN0YW5jZW9mIG9sQ29udHJvbENvbnRyb2wpO1xuICAgICAgdmFyIG1hcCA9IHNjb3BlLiRldmFsKGF0dHJzWyduZ2VvQ29udHJvbE1hcCddKTtcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KG1hcCBpbnN0YW5jZW9mIG9sTWFwKTtcbiAgICAgIGNvbnRyb2wuc2V0VGFyZ2V0KGVsZW1lbnRbMF0pO1xuICAgICAgbWFwLmFkZENvbnRyb2woY29udHJvbCk7XG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvQ29udHJvbCcsIGNvbnRyb2xDb21wb25lbnQpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqKSB7XG5vYmogfHwgKG9iaiA9IHt9KTtcbnZhciBfX3QsIF9fcCA9ICcnO1xud2l0aCAob2JqKSB7XG5fX3AgKz0gJzxkaXYgY2xhc3M9XCJuZ2VvLWRhdGVwaWNrZXJcIj5cXG4gIDxmb3JtIG5hbWU9XCJkYXRlRm9ybVwiIGNsYXNzPVwibmdlby1kYXRlcGlja2VyLWZvcm1cIiBub3ZhbGlkYXRlPlxcbiAgICA8ZGl2IG5nLWlmPVwiOjpkYXRlcGlja2VyQ3RybC50aW1lLndpZGdldCA9PT0gXFwnZGF0ZXBpY2tlclxcJ1wiPlxcbiAgICAgIDxkaXYgY2xhc3M9XCJuZ2VvLWRhdGVwaWNrZXItc3RhcnQtZGF0ZVwiPlxcbiAgICAgICAgPHNwYW4gbmctaWY9XCI6OmRhdGVwaWNrZXJDdHJsLnRpbWUubW9kZSA9PT0gXFwncmFuZ2VcXCdcIiB0cmFuc2xhdGU+RnJvbTo8L3NwYW4+XFxuICAgICAgICA8c3BhbiBuZy1pZj1cIjo6ZGF0ZXBpY2tlckN0cmwudGltZS5tb2RlICE9PSBcXCdyYW5nZVxcJ1wiIHRyYW5zbGF0ZT5EYXRlOjwvc3Bhbj5cXG4gICAgICAgIDxpbnB1dCBuYW1lPVwic2RhdGVcIiB1aS1kYXRlPVwiZGF0ZXBpY2tlckN0cmwuc2RhdGVPcHRpb25zXCIgbmctbW9kZWw9XCJkYXRlcGlja2VyQ3RybC5zZGF0ZVwiIHJlcXVpcmVkPVwiXCIvPlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXZcXG4gICAgICAgIGNsYXNzPVwibmdlby1kYXRlcGlja2VyLWVuZC1kYXRlXCJcXG4gICAgICAgIG5nLWlmPVwiOjpkYXRlcGlja2VyQ3RybC50aW1lLm1vZGUgPT09IFxcJ3JhbmdlXFwnXCI+XFxuICAgICAgICA8c3BhbiB0cmFuc2xhdGU+VG86PC9zcGFuPlxcbiAgICAgICAgPGlucHV0IG5hbWU9XCJlZGF0ZVwiIHVpLWRhdGU9XCJkYXRlcGlja2VyQ3RybC5lZGF0ZU9wdGlvbnNcIiBuZy1tb2RlbD1cImRhdGVwaWNrZXJDdHJsLmVkYXRlXCIgcmVxdWlyZWQ9XCJcIi8+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9mb3JtPlxcbjwvZGl2Plxcbic7XG5cbn1cbnJldHVybiBfX3Bcbn0iLCJDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCJuZ2VvVGltZVwiLCBcImdldHRleHRDYXRhbG9nXCJdO1xuZGF0ZVBpY2tlckNvbXBvbmVudC4kaW5qZWN0ID0gW1wibmdlb0RhdGVQaWNrZXJUZW1wbGF0ZVVybFwiLCBcIiR0aW1lb3V0XCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb01pc2NUaW1lIGZyb20gJ25nZW8vbWlzYy9UaW1lLmpzJztcbmltcG9ydCAnYW5ndWxhci11aS1kYXRlJztcbmltcG9ydCAnbmdlby9zYXNzL2pxdWVyeS11aS5zY3NzJztcbmltcG9ydCAnanF1ZXJ5LXVpL3VpL2kxOG4vZGF0ZXBpY2tlci1mci5qcyc7XG5pbXBvcnQgJ2pxdWVyeS11aS91aS9pMThuL2RhdGVwaWNrZXItZW4tR0IuanMnO1xuaW1wb3J0ICdqcXVlcnktdWkvdWkvaTE4bi9kYXRlcGlja2VyLWRlLmpzJztcbmltcG9ydCAnanF1ZXJ5LXVpL3VpL2kxOG4vZGF0ZXBpY2tlci1pdC5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9EYXRlUGlja2VyJywgW25nZW9NaXNjVGltZS5uYW1lLCAndWkuZGF0ZSddKTtcbm1vZHVsZS52YWx1ZSgnbmdlb0RhdGVQaWNrZXJUZW1wbGF0ZVVybCcsIGZ1bmN0aW9uIChlbGVtZW50LCBhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSBhdHRycy5uZ2VvRGF0ZVBpY2tlclRlbXBsYXRlVXJsO1xuICByZXR1cm4gdGVtcGxhdGVVcmwgIT09IHVuZGVmaW5lZCA/IHRlbXBsYXRlVXJsIDogJ25nZW8vbWlzYy9kYXRlcGlja2VyQ29tcG9uZW50Jztcbn0pO1xubW9kdWxlLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCduZ2VvL21pc2MvZGF0ZXBpY2tlckNvbXBvbmVudCcsIHJlcXVpcmUoJy4vZGF0ZXBpY2tlckNvbXBvbmVudC5odG1sJykpO1xufV0pO1xuXG5mdW5jdGlvbiBkYXRlUGlja2VyQ29tcG9uZW50KG5nZW9EYXRlUGlja2VyVGVtcGxhdGVVcmwsICR0aW1lb3V0KSB7XG4gIHJldHVybiB7XG4gICAgc2NvcGU6IHtcbiAgICAgIG9uRGF0ZVNlbGVjdGVkOiAnJicsXG4gICAgICB0aW1lOiAnPSdcbiAgICB9LFxuICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgY29udHJvbGxlcjogJ25nZW9EYXRlUGlja2VyQ29udHJvbGxlciBhcyBkYXRlcGlja2VyQ3RybCcsXG4gICAgcmVzdHJpY3Q6ICdBRScsXG4gICAgdGVtcGxhdGVVcmw6IG5nZW9EYXRlUGlja2VyVGVtcGxhdGVVcmwsXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmwpIHtcbiAgICAgIGlmICghY3RybCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgY3RybCcpO1xuICAgICAgfVxuXG4gICAgICBjdHJsLmluaXQoKTtcbiAgICAgIHZhciBsYW5nID0gY3RybC5nZXR0ZXh0Q2F0YWxvZ18uZ2V0Q3VycmVudExhbmd1YWdlKCk7XG4gICAgICAkLmRhdGVwaWNrZXIuc2V0RGVmYXVsdHMoJC5kYXRlcGlja2VyLnJlZ2lvbmFsW2xhbmddKTtcbiAgICAgIGN0cmwuc2RhdGVPcHRpb25zID0gYW5ndWxhci5leHRlbmQoe30sIGN0cmwuc2RhdGVPcHRpb25zLCB7XG4gICAgICAgICdtaW5EYXRlJzogY3RybC5pbml0aWFsTWluRGF0ZSxcbiAgICAgICAgJ21heERhdGUnOiBjdHJsLmluaXRpYWxNYXhEYXRlLFxuICAgICAgICAnb25DbG9zZSc6IGZ1bmN0aW9uIG9uQ2xvc2Uoc2VsZWN0ZWREYXRlKSB7XG4gICAgICAgICAgaWYgKHNlbGVjdGVkRGF0ZSkge1xuICAgICAgICAgICAgJChlbGVtZW50WzBdKS5maW5kKCdpbnB1dFtuYW1lPVwiZWRhdGVcIl0nKS5kYXRlcGlja2VyKCdvcHRpb24nLCAnbWluRGF0ZScsIHNlbGVjdGVkRGF0ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGN0cmwuZWRhdGVPcHRpb25zID0gYW5ndWxhci5leHRlbmQoe30sIGN0cmwuZWRhdGVPcHRpb25zLCB7XG4gICAgICAgICdtaW5EYXRlJzogY3RybC5pbml0aWFsTWluRGF0ZSxcbiAgICAgICAgJ21heERhdGUnOiBjdHJsLmluaXRpYWxNYXhEYXRlLFxuICAgICAgICAnb25DbG9zZSc6IGZ1bmN0aW9uIG9uQ2xvc2Uoc2VsZWN0ZWREYXRlKSB7XG4gICAgICAgICAgaWYgKHNlbGVjdGVkRGF0ZSkge1xuICAgICAgICAgICAgJChlbGVtZW50WzBdKS5maW5kKCdpbnB1dFtuYW1lPVwic2RhdGVcIl0nKS5kYXRlcGlja2VyKCdvcHRpb24nLCAnbWF4RGF0ZScsIHNlbGVjdGVkRGF0ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgnYm9keScpLm9uKCdoaWRkZW4uYnMucG9wb3ZlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRwID0gYW5ndWxhci5lbGVtZW50KCcjdWktZGF0ZXBpY2tlci1kaXYnKTtcblxuICAgICAgICBpZiAoZHAgJiYgZHAuY3NzKCdkaXNwbGF5JykgPT09ICdibG9jaycpIHtcbiAgICAgICAgICAkKGVsZW1lbnRbMF0pLmZpbmQoJ2lucHV0W25hbWUkPVwiZGF0ZVwiXScpLmRhdGVwaWNrZXIoJ2hpZGUnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnI3VpLWRhdGVwaWNrZXItZGl2Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb0RhdGVQaWNrZXInLCBkYXRlUGlja2VyQ29tcG9uZW50KTtcblxuZnVuY3Rpb24gQ29udHJvbGxlcigkc2NvcGUsIG5nZW9UaW1lLCBnZXR0ZXh0Q2F0YWxvZykge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHRoaXMubmdlb1RpbWVfID0gbmdlb1RpbWU7XG4gIHRoaXMudGltZSA9IG51bGw7XG4gIHRoaXMuZ2V0dGV4dENhdGFsb2dfID0gZ2V0dGV4dENhdGFsb2c7XG4gIHRoaXMuaXNNb2RlUmFuZ2UgPSBmYWxzZTtcbiAgdGhpcy5vbkRhdGVTZWxlY3RlZCA9IG51bGw7XG4gIHRoaXMuaW5pdGlhbE1pbkRhdGUgPSBudWxsO1xuICB0aGlzLmluaXRpYWxNYXhEYXRlID0gbnVsbDtcbiAgdGhpcy5lZGF0ZU9wdGlvbnMgPSB7XG4gICAgJ2NoYW5nZU1vbnRoJzogdHJ1ZSxcbiAgICAnY2hhbmdlWWVhcic6IHRydWVcbiAgfTtcbiAgdGhpcy5zZGF0ZU9wdGlvbnMgPSB7XG4gICAgJ2NoYW5nZU1vbnRoJzogdHJ1ZSxcbiAgICAnY2hhbmdlWWVhcic6IHRydWVcbiAgfTtcbiAgdGhpcy5zZGF0ZSA9IG51bGw7XG4gIHRoaXMuZWRhdGUgPSBudWxsO1xuICAkc2NvcGUuJHdhdGNoR3JvdXAoWydkYXRlcGlja2VyQ3RybC5zZGF0ZScsICdkYXRlcGlja2VyQ3RybC5lZGF0ZSddLCBmdW5jdGlvbiAobmV3RGF0ZXMsIG9sZERhdGVzKSB7XG4gICAgaWYgKCFfdGhpcy5vbkRhdGVTZWxlY3RlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG9uRGF0ZVNlbGVjdGVkJyk7XG4gICAgfVxuXG4gICAgdmFyIHNEYXRlID0gbmV3RGF0ZXNbMF07XG4gICAgdmFyIGVEYXRlID0gbmV3RGF0ZXNbMV07XG5cbiAgICBpZiAoYW5ndWxhci5pc0RhdGUoc0RhdGUpICYmICghX3RoaXMuaXNNb2RlUmFuZ2UgfHwgYW5ndWxhci5pc0RhdGUoZURhdGUpKSkge1xuICAgICAgdmFyIHN0YXJ0ID0gX3RoaXMubmdlb1RpbWVfLmdldFRpbWUoc0RhdGUpO1xuXG4gICAgICB2YXIgZW5kID0gX3RoaXMubmdlb1RpbWVfLmdldFRpbWUoZURhdGUpO1xuXG4gICAgICBpZiAoIXN0YXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBzdGFydCcpO1xuICAgICAgfVxuXG4gICAgICBfdGhpcy5vbkRhdGVTZWxlY3RlZCh7XG4gICAgICAgIHRpbWU6IHtcbiAgICAgICAgICBzdGFydDogc3RhcnQsXG4gICAgICAgICAgZW5kOiBlbmRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn1cblxuQ29udHJvbGxlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLnRpbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdGltZScpO1xuICB9XG5cbiAgdmFyIGluaXRpYWxPcHRpb25zXyA9IHRoaXMubmdlb1RpbWVfLmdldE9wdGlvbnModGhpcy50aW1lKTtcbiAgdGhpcy5pbml0aWFsTWluRGF0ZSA9IHRoaXMubmdlb1RpbWVfLmNyZWF0ZURhdGUoaW5pdGlhbE9wdGlvbnNfLm1pbkRhdGUpO1xuICB0aGlzLmluaXRpYWxNYXhEYXRlID0gdGhpcy5uZ2VvVGltZV8uY3JlYXRlRGF0ZShpbml0aWFsT3B0aW9uc18ubWF4RGF0ZSk7XG4gIHRoaXMuaXNNb2RlUmFuZ2UgPSB0aGlzLnRpbWUubW9kZSA9PT0gJ3JhbmdlJztcblxuICBpZiAodGhpcy5pc01vZGVSYW5nZSkge1xuICAgIGlmICghQXJyYXkuaXNBcnJheShpbml0aWFsT3B0aW9uc18udmFsdWVzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdWYWx1ZSBzaG91bGQgYmUgYW4gYXJyYXknKTtcbiAgICB9XG5cbiAgICB0aGlzLnNkYXRlID0gdGhpcy5uZ2VvVGltZV8uY3JlYXRlRGF0ZShpbml0aWFsT3B0aW9uc18udmFsdWVzWzBdKTtcbiAgICB0aGlzLmVkYXRlID0gdGhpcy5uZ2VvVGltZV8uY3JlYXRlRGF0ZShpbml0aWFsT3B0aW9uc18udmFsdWVzWzFdKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAodHlwZW9mIGluaXRpYWxPcHRpb25zXy52YWx1ZXMgIT0gJ251bWJlcicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVmFsdWUgc2hvdWxkIGJlIGEgbnVtYmVyJyk7XG4gICAgfVxuXG4gICAgdGhpcy5zZGF0ZSA9IHRoaXMubmdlb1RpbWVfLmNyZWF0ZURhdGUoaW5pdGlhbE9wdGlvbnNfLnZhbHVlcyk7XG4gIH1cbn07XG5cbm1vZHVsZS5jb250cm9sbGVyKCduZ2VvRGF0ZVBpY2tlckNvbnRyb2xsZXInLCBDb250cm9sbGVyKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkZWxlbWVudFwiLCBcImdldHRleHRDYXRhbG9nXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgRGF0ZUZvcm1hdHRlciBmcm9tICduZ2VvL21pc2MvcGhwLWRhdGUtZm9ybWF0dGVyLmpzJztcbmltcG9ydCAnanF1ZXJ5LWRhdGV0aW1lcGlja2VyL2pxdWVyeS5kYXRldGltZXBpY2tlci5qcyc7XG5pbXBvcnQgJ2pxdWVyeS1kYXRldGltZXBpY2tlci9qcXVlcnkuZGF0ZXRpbWVwaWNrZXIuY3NzJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0RhdGVUaW1lUGlja2VyJywgWydnZXR0ZXh0J10pO1xuXG5mdW5jdGlvbiBkYXRlVGltZUNvbXBvbmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIGNvbnRyb2xsZXI6IENvbnRyb2xsZXIsXG4gICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICBzY29wZToge1xuICAgICAgJ29wdGlvbnMnOiAnPG5nZW9EYXRldGltZXBpY2tlck9wdGlvbnMnXG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvRGF0ZXRpbWVwaWNrZXInLCBkYXRlVGltZUNvbXBvbmVudCk7XG5cbmZ1bmN0aW9uIENvbnRyb2xsZXIoJGVsZW1lbnQsIGdldHRleHRDYXRhbG9nKSB7XG4gIHRoaXMuZWxlbWVudF8gPSAkZWxlbWVudDtcbiAgdGhpcy5nZXR0ZXh0Q2F0YWxvZ18gPSBnZXR0ZXh0Q2F0YWxvZztcbiAgdGhpcy5vcHRpb25zO1xufVxuXG5Db250cm9sbGVyLnByb3RvdHlwZS4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgbGFuZyA9IHRoaXMuZ2V0dGV4dENhdGFsb2dfLmdldEN1cnJlbnRMYW5ndWFnZSgpO1xuICAkLmRhdGV0aW1lcGlja2VyLnNldExvY2FsZShsYW5nKTtcbiAgJC5kYXRldGltZXBpY2tlci5zZXREYXRlRm9ybWF0dGVyKG5ldyBEYXRlRm9ybWF0dGVyKCkpO1xuXG4gIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zID09PSAnc3RyaW5nJykge1xuICAgIHRoaXMub3B0aW9ucyA9IGFuZ3VsYXIuZnJvbUpzb24odGhpcy5vcHRpb25zKTtcbiAgfVxuXG4gIHRoaXMuZWxlbWVudF8uZGF0ZXRpbWVwaWNrZXIodGhpcy5vcHRpb25zKTtcbn07XG5cbm1vZHVsZS5jb250cm9sbGVyKCduZ2VvRGF0ZVRpbWVQaWNrZXJDb250cm9sbGVyJywgQ29udHJvbGxlcik7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiZmFjdG9yeS4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0RlYm91bmNlJywgW10pO1xuZXhwb3J0IGZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIGludm9rZUFwcGx5LCAkdGltZW91dCkge1xuICB2YXIgdGltZW91dCA9IG51bGw7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbiBsYXRlcigpIHtcbiAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgZnVuYy5hcHBseShfdGhpcywgYXJncyk7XG4gICAgfTtcblxuICAgIGlmICh0aW1lb3V0ICE9PSBudWxsKSB7XG4gICAgICAkdGltZW91dC5jYW5jZWwodGltZW91dCk7XG4gICAgfVxuXG4gICAgdGltZW91dCA9ICR0aW1lb3V0KGxhdGVyLCB3YWl0LCBpbnZva2VBcHBseSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGZhY3RvcnkoJHRpbWVvdXQpIHtcbiAgdmFyIGRlYiA9IGRlYm91bmNlO1xuICByZXR1cm4gZnVuY3Rpb24gKGZ1bmMsIHdhaXQsIGludm9rZUFwcGx5KSB7XG4gICAgcmV0dXJuIGRlYihmdW5jLCB3YWl0LCBpbnZva2VBcHBseSwgJHRpbWVvdXQpO1xuICB9O1xufVxuXG5tb2R1bGUuZmFjdG9yeSgnbmdlb0RlYm91bmNlJywgZmFjdG9yeSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IG9sSW50ZXJhY3Rpb25JbnRlcmFjdGlvbiBmcm9tICdvbC9pbnRlcmFjdGlvbi9JbnRlcmFjdGlvbi5qcyc7XG5pbXBvcnQgb2xMYXllckJhc2UgZnJvbSAnb2wvbGF5ZXIvQmFzZS5qcyc7XG5pbXBvcnQgb2xMYXllckdyb3VwIGZyb20gJ29sL2xheWVyL0dyb3VwLmpzJztcbmltcG9ydCBvbExheWVyTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvTGF5ZXIuanMnO1xuaW1wb3J0IG9sU291cmNlSW1hZ2UgZnJvbSAnb2wvc291cmNlL0ltYWdlLmpzJztcbmltcG9ydCBvbFNvdXJjZVRpbGUgZnJvbSAnb2wvc291cmNlL1RpbGUuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIGludGVyYWN0aW9uRGVjb3JhdGlvbihpbnRlcmFjdGlvbikge1xuICBjb25zb2xlLmFzc2VydChpbnRlcmFjdGlvbiBpbnN0YW5jZW9mIG9sSW50ZXJhY3Rpb25JbnRlcmFjdGlvbik7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpbnRlcmFjdGlvbiwgJ2FjdGl2ZScsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBpbnRlcmFjdGlvbi5nZXRBY3RpdmUoKTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbCkge1xuICAgICAgaW50ZXJhY3Rpb24uc2V0QWN0aXZlKHZhbCk7XG4gICAgfVxuICB9KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBsYXllckRlY29yYXRpb24obGF5ZXIpIHtcbiAgY29uc29sZS5hc3NlcnQobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyQmFzZSk7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXllciwgJ3Zpc2libGUnLCB7XG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIGxheWVyLmdldFZpc2libGUoKTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbCkge1xuICAgICAgbGF5ZXIuc2V0VmlzaWJsZSh2YWwpO1xuICAgIH1cbiAgfSk7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXllciwgJ29wYWNpdHknLCB7XG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIGxheWVyLmdldE9wYWNpdHkoKTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbCkge1xuICAgICAgbGF5ZXIuc2V0T3BhY2l0eSh2YWwpO1xuICAgIH1cbiAgfSk7XG59XG5leHBvcnQgZnVuY3Rpb24gbGF5ZXJMb2FkaW5nKGxheWVyLCAkc2NvcGUpIHtcbiAgdmFyIHNvdXJjZTtcbiAgdmFyIGluY3JlbWVudEV2ZW50cyA9IFtdO1xuICB2YXIgZGVjcmVtZW50RXZlbnRzID0gW107XG4gIHZhciBpbmNyZW1lbnRMb2FkQ291bnRfID0gaW5jcmVtZW50XztcbiAgdmFyIGRlY3JlbWVudExvYWRDb3VudF8gPSBkZWNyZW1lbnRfO1xuICBsYXllci5zZXQoJ2xvYWRfY291bnQnLCAwLCB0cnVlKTtcblxuICBpZiAobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyR3JvdXApIHtcbiAgICBsYXllci5nZXRMYXllcnMoKS5vbignYWRkJywgZnVuY3Rpb24gKG9sRXZlbnQpIHtcbiAgICAgIHZhciBuZXdMYXllciA9IG9sRXZlbnQuZWxlbWVudDtcbiAgICAgIG5ld0xheWVyLnNldCgncGFyZW50X2dyb3VwJywgbGF5ZXIpO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckxheWVyKSB7XG4gICAgc291cmNlID0gbGF5ZXIuZ2V0U291cmNlKCk7XG5cbiAgICBpZiAoc291cmNlID09PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChzb3VyY2UgaW5zdGFuY2VvZiBvbFNvdXJjZVRpbGUpIHtcbiAgICAgIGluY3JlbWVudEV2ZW50cyA9IFsndGlsZWxvYWRzdGFydCddO1xuICAgICAgZGVjcmVtZW50RXZlbnRzID0gWyd0aWxlbG9hZGVuZCcsICd0aWxlbG9hZGVycm9yJ107XG4gICAgfSBlbHNlIGlmIChzb3VyY2UgaW5zdGFuY2VvZiBvbFNvdXJjZUltYWdlKSB7XG4gICAgICBpbmNyZW1lbnRFdmVudHMgPSBbJ2ltYWdlbG9hZHN0YXJ0J107XG4gICAgICBkZWNyZW1lbnRFdmVudHMgPSBbJ2ltYWdlbG9hZGVuZCcsICdpbWFnZWxvYWRlcnJvciddO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmFzc2VydChmYWxzZSwgJ3Vuc3VwcG9ydGVkIHNvdXJjZSB0eXBlJyk7XG4gICAgfVxuXG4gICAgc291cmNlLm9uKGluY3JlbWVudEV2ZW50cywgZnVuY3Rpb24gKCkge1xuICAgICAgaW5jcmVtZW50TG9hZENvdW50XyhsYXllcik7XG4gICAgICAkc2NvcGUuJGFwcGx5QXN5bmMoKTtcbiAgICB9KTtcbiAgICBzb3VyY2Uub24oZGVjcmVtZW50RXZlbnRzLCBmdW5jdGlvbiAoKSB7XG4gICAgICBkZWNyZW1lbnRMb2FkQ291bnRfKGxheWVyKTtcbiAgICAgICRzY29wZS4kYXBwbHlBc3luYygpO1xuICAgIH0pO1xuICB9XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGxheWVyLCAnbG9hZGluZycsIHtcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gbGF5ZXIuZ2V0KCdsb2FkX2NvdW50JykgPiAwO1xuICAgIH1cbiAgfSk7XG5cbiAgZnVuY3Rpb24gaW5jcmVtZW50XyhsYXllcikge1xuICAgIHZhciBsb2FkX2NvdW50ID0gbGF5ZXIuZ2V0KCdsb2FkX2NvdW50Jyk7XG4gICAgdmFyIHBhcmVudCA9IGxheWVyLmdldCgncGFyZW50X2dyb3VwJyk7XG4gICAgbGF5ZXIuc2V0KCdsb2FkX2NvdW50JywgKytsb2FkX2NvdW50LCB0cnVlKTtcblxuICAgIGlmIChwYXJlbnQpIHtcbiAgICAgIGluY3JlbWVudF8ocGFyZW50KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBkZWNyZW1lbnRfKGxheWVyKSB7XG4gICAgdmFyIGxvYWRfY291bnQgPSBsYXllci5nZXQoJ2xvYWRfY291bnQnKTtcbiAgICB2YXIgcGFyZW50ID0gbGF5ZXIuZ2V0KCdwYXJlbnRfZ3JvdXAnKTtcbiAgICBsYXllci5zZXQoJ2xvYWRfY291bnQnLCAtLWxvYWRfY291bnQsIHRydWUpO1xuXG4gICAgaWYgKHBhcmVudCkge1xuICAgICAgZGVjcmVtZW50XyhwYXJlbnQpO1xuICAgIH1cbiAgfVxufSIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9NaXNjQXV0b1Byb2plY3Rpb24gZnJvbSAnbmdlby9taXNjL0F1dG9Qcm9qZWN0aW9uLmpzJztcbmltcG9ydCBuZ2VvTWlzY0J0bkNvbXBvbmVudCBmcm9tICduZ2VvL21pc2MvYnRuQ29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvTWlzY0NvbnRyb2xDb21wb25lbnQgZnJvbSAnbmdlby9taXNjL2NvbnRyb2xDb21wb25lbnQuanMnO1xuaW1wb3J0IG5nZW9NaXNjRGF0ZXBpY2tlckNvbXBvbmVudCBmcm9tICduZ2VvL21pc2MvZGF0ZXBpY2tlckNvbXBvbmVudC5qcyc7XG5pbXBvcnQgbmdlb01pc2NEZWJvdW5jZSBmcm9tICduZ2VvL21pc2MvZGVib3VuY2UuanMnO1xuaW1wb3J0IG5nZW9NaXNjRXZlbnRIZWxwZXIgZnJvbSAnbmdlby9taXNjL0V2ZW50SGVscGVyLmpzJztcbmltcG9ydCBuZ2VvTWlzY0ZlYXR1cmVIZWxwZXIgZnJvbSAnbmdlby9taXNjL0ZlYXR1cmVIZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9NaXNjRmlsZSBmcm9tICduZ2VvL21pc2MvRmlsZS5qcyc7XG5pbXBvcnQgbmdlb01pc2NGaWxlcmVhZGVyQ29tcG9uZW50IGZyb20gJ25nZW8vbWlzYy9maWxlcmVhZGVyQ29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvTWlzY0ZpbHRlcnMgZnJvbSAnbmdlby9taXNjL2ZpbHRlcnMuanMnO1xuaW1wb3J0IG5nZW9NaXNjU29ydGFibGVDb21wb25lbnQgZnJvbSAnbmdlby9taXNjL3NvcnRhYmxlQ29tcG9uZW50LmpzJztcbmltcG9ydCBuZ2VvTWlzY1RpbWUgZnJvbSAnbmdlby9taXNjL1RpbWUuanMnO1xuaW1wb3J0IG5nZW9NaXNjVG9vbEFjdGl2YXRlTWdyIGZyb20gJ25nZW8vbWlzYy9Ub29sQWN0aXZhdGVNZ3IuanMnO1xuaW1wb3J0IG5nZW9NaXNjV01TVGltZSBmcm9tICduZ2VvL21pc2MvV01TVGltZS5qcyc7XG5leHBvcnQgZGVmYXVsdCBhbmd1bGFyLm1vZHVsZSgnbmdlb01pc2NFeHRyYU1vZHVsZScsIFtuZ2VvTWlzY0F1dG9Qcm9qZWN0aW9uLm5hbWUsIG5nZW9NaXNjQnRuQ29tcG9uZW50Lm5hbWUsIG5nZW9NaXNjQ29udHJvbENvbXBvbmVudC5uYW1lLCBuZ2VvTWlzY0RhdGVwaWNrZXJDb21wb25lbnQubmFtZSwgbmdlb01pc2NEZWJvdW5jZS5uYW1lLCBuZ2VvTWlzY0V2ZW50SGVscGVyLm5hbWUsIG5nZW9NaXNjRmVhdHVyZUhlbHBlci5uYW1lLCBuZ2VvTWlzY0ZpbGUubmFtZSwgbmdlb01pc2NGaWxlcmVhZGVyQ29tcG9uZW50Lm5hbWUsIG5nZW9NaXNjRmlsdGVycy5uYW1lLCBuZ2VvTWlzY1NvcnRhYmxlQ29tcG9uZW50Lm5hbWUsIG5nZW9NaXNjVGltZS5uYW1lLCBuZ2VvTWlzY1Rvb2xBY3RpdmF0ZU1nci5uYW1lLCBuZ2VvTWlzY1dNU1RpbWUubmFtZV0pOyIsImZpbGVyZWFkZXJDb21wb25lbnQuJGluamVjdCA9IFtcIiR3aW5kb3dcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0ZpbGVyZWFkZXInLCBbXSk7XG5cbmZ1bmN0aW9uIGZpbGVyZWFkZXJDb21wb25lbnQoJHdpbmRvdykge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgc2NvcGU6IHtcbiAgICAgICdmaWxlQ29udGVudCc6ICc9bmdlb0ZpbGVyZWFkZXInLFxuICAgICAgJ3N1cHBvcnRlZCc6ICc9P25nZW9GaWxlcmVhZGVyU3VwcG9ydGVkJ1xuICAgIH0sXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCkge1xuICAgICAgdmFyIHN1cHBvcnRlZCA9ICdGaWxlUmVhZGVyJyBpbiAkd2luZG93O1xuICAgICAgc2NvcGUuc3VwcG9ydGVkID0gc3VwcG9ydGVkO1xuXG4gICAgICBpZiAoIXN1cHBvcnRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBjZSA9IGZ1bmN0aW9uIGNlKGNoYW5nZUV2ZW50KSB7XG4gICAgICAgIHZhciBmaWxlUmVhZGVyID0gbmV3ICR3aW5kb3cuRmlsZVJlYWRlcigpO1xuXG4gICAgICAgIGZpbGVSZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgIHZhciB0YXJnZXQgPSBldnQudGFyZ2V0O1xuICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzY29wZS5maWxlQ29udGVudCA9IHRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGZpbGVzID0gY2hhbmdlRXZlbnQudGFyZ2V0LmZpbGVzO1xuXG4gICAgICAgIGlmICghZmlsZXMpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmlsZXMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZpbGVSZWFkZXIucmVhZEFzVGV4dChmaWxlc1swXSk7XG4gICAgICB9O1xuXG4gICAgICBlbGVtZW50Lm9uKHtcbiAgICAgICAgY2hhbmdlOiBjZVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvRmlsZXJlYWRlcicsIGZpbGVyZWFkZXJDb21wb25lbnQpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsIkR1cmF0aW9uRmlsdGVyLiRpbmplY3QgPSBbXCJnZXR0ZXh0Q2F0YWxvZ1wiXTtcbnRydXN0SHRtbEF1dG9GaWx0ZXIuJGluamVjdCA9IFtcIiRzY2VcIiwgXCJuZ2VvU3RyaW5nVG9IdG1sUmVwbGFjZW1lbnRzXCJdO1xudHJ1c3RIdG1sRmlsdGVyLiRpbmplY3QgPSBbXCIkc2NlXCJdO1xuTnVtYmVyQ29vcmRpbmF0ZXNGaWx0ZXIuJGluamVjdCA9IFtcIiRmaWx0ZXJcIl07XG5Vbml0UHJlZml4RmlsdGVyLiRpbmplY3QgPSBbXCIkZmlsdGVyXCJdO1xuTnVtYmVyRmlsdGVyLiRpbmplY3QgPSBbXCIkbG9jYWxlXCJdO1xuU2NhbGlmeUZpbHRlci4kaW5qZWN0ID0gW1wiJGZpbHRlclwiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgbW9kdWxvIH0gZnJvbSAnb2wvbWF0aC5qcyc7XG5pbXBvcnQgeyBwYWROdW1iZXIgfSBmcm9tICdvbC9zdHJpbmcuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvQW5ndWxhckZpbHRlcnMnLCBbXSk7XG5cbmZ1bmN0aW9uIFNjYWxpZnlGaWx0ZXIoJGZpbHRlcikge1xuICB2YXIgbnVtYmVyRmlsdGVyID0gJGZpbHRlcignbnVtYmVyJyk7XG5cbiAgdmFyIGZpbHRlckZuID0gZnVuY3Rpb24gZmlsdGVyRm4oc2NhbGUpIHtcbiAgICB2YXIgdGV4dCA9IG51bWJlckZpbHRlcihzY2FsZSwgMCk7XG4gICAgcmV0dXJuIHRleHQgPyBcIjFcXHhBMDpcXHhBMFwiICsgdGV4dCA6ICcnO1xuICB9O1xuXG4gIGZpbHRlckZuLiRzdGF0ZWZ1bCA9IHRydWU7XG4gIHJldHVybiBmaWx0ZXJGbjtcbn1cblxubW9kdWxlLmZpbHRlcignbmdlb1NjYWxpZnknLCBTY2FsaWZ5RmlsdGVyKTtcblxuZnVuY3Rpb24gTnVtYmVyRmlsdGVyKCRsb2NhbGUpIHtcbiAgdmFyIGZvcm1hdHMgPSAkbG9jYWxlLk5VTUJFUl9GT1JNQVRTO1xuXG4gIHZhciByZXN1bHQgPSBmdW5jdGlvbiByZXN1bHQobnVtYmVyLCBvcHRfcHJlY2lzaW9uKSB7XG4gICAgdmFyIGdyb3VwU2VwID0gZm9ybWF0cy5HUk9VUF9TRVA7XG4gICAgdmFyIGRlY2ltYWxTZXAgPSBmb3JtYXRzLkRFQ0lNQUxfU0VQO1xuXG4gICAgaWYgKG9wdF9wcmVjaXNpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgb3B0X3ByZWNpc2lvbiA9IDM7XG4gICAgfVxuXG4gICAgaWYgKG51bWJlciA9PT0gSW5maW5pdHkpIHtcbiAgICAgIHJldHVybiBcIlxcdTIyMUVcIjtcbiAgICB9IGVsc2UgaWYgKG51bWJlciA9PT0gLUluZmluaXR5KSB7XG4gICAgICByZXR1cm4gXCItXFx1MjIxRVwiO1xuICAgIH0gZWxzZSBpZiAobnVtYmVyID09PSAwKSB7XG4gICAgICByZXR1cm4gJzAnO1xuICAgIH1cblxuICAgIHZhciBzaWduID0gbnVtYmVyIDwgMDtcbiAgICBudW1iZXIgPSBNYXRoLmFicyhudW1iZXIpO1xuICAgIHZhciBuYl9kZWNpbWFsID0gb3B0X3ByZWNpc2lvbiAtIE1hdGguZmxvb3IoTWF0aC5sb2cobnVtYmVyKSAvIE1hdGgubG9nKDEwKSkgLSAxO1xuICAgIHZhciBmYWN0b3IgPSBNYXRoLnBvdygxMCwgbmJfZGVjaW1hbCk7XG4gICAgbnVtYmVyID0gTWF0aC5yb3VuZChudW1iZXIgKiBmYWN0b3IpO1xuICAgIHZhciBkZWNpbWFsID0gJyc7XG4gICAgdmFyIHVuaXQgPSBNYXRoLmZsb29yKG51bWJlciAvIGZhY3Rvcik7XG5cbiAgICBpZiAobmJfZGVjaW1hbCA+IDApIHtcbiAgICAgIHZhciBzdHJfbnVtYmVyID0gXCJcIiArIG51bWJlcjtcblxuICAgICAgd2hpbGUgKHN0cl9udW1iZXIubGVuZ3RoIDwgbmJfZGVjaW1hbCkge1xuICAgICAgICBzdHJfbnVtYmVyID0gXCIwXCIgKyBzdHJfbnVtYmVyO1xuICAgICAgfVxuXG4gICAgICBkZWNpbWFsID0gc3RyX251bWJlci5zdWJzdHJpbmcoc3RyX251bWJlci5sZW5ndGggLSBuYl9kZWNpbWFsKTtcblxuICAgICAgd2hpbGUgKGRlY2ltYWwuZW5kc1dpdGgoJzAnKSkge1xuICAgICAgICBkZWNpbWFsID0gZGVjaW1hbC5zdWJzdHJpbmcoMCwgZGVjaW1hbC5sZW5ndGggLSAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZ3JvdXBzID0gW107XG4gICAgdmFyIHN0cl91bml0ID0gXCJcIiArIHVuaXQ7XG5cbiAgICB3aGlsZSAoc3RyX3VuaXQubGVuZ3RoID4gMykge1xuICAgICAgdmFyIGluZGV4ID0gc3RyX3VuaXQubGVuZ3RoIC0gMztcbiAgICAgIGdyb3Vwcy51bnNoaWZ0KHN0cl91bml0LnN1YnN0cmluZyhpbmRleCkpO1xuICAgICAgc3RyX3VuaXQgPSBzdHJfdW5pdC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xuICAgIH1cblxuICAgIGdyb3Vwcy51bnNoaWZ0KHN0cl91bml0KTtcbiAgICByZXR1cm4gKHNpZ24gPyAnLScgOiAnJykgKyBncm91cHMuam9pbihncm91cFNlcCkgKyAoZGVjaW1hbC5sZW5ndGggPT09IDAgPyAnJyA6IGRlY2ltYWxTZXAgKyBkZWNpbWFsKTtcbiAgfTtcblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZmlsdGVyKCduZ2VvTnVtYmVyJywgTnVtYmVyRmlsdGVyKTtcblxuZnVuY3Rpb24gVW5pdFByZWZpeEZpbHRlcigkZmlsdGVyKSB7XG4gIHZhciBudW1iZXJGaWx0ZXIgPSAkZmlsdGVyKCduZ2VvTnVtYmVyJyk7XG4gIHZhciBzdGFuZGFyZFByZWZpeCA9IFsnJywgJ2snLCAnTScsICdHJywgJ1QnLCAnUCddO1xuICB2YXIgYmluYXJ5UHJlZml4ID0gWycnLCAnS2knLCAnTWknLCAnR2knLCAnVGknLCAnUGknXTtcblxuICB2YXIgcmVzdWx0ID0gZnVuY3Rpb24gcmVzdWx0KG51bWJlciwgb3B0X3VuaXQsIG9wdF90eXBlLCBvcHRfcHJlY2lzaW9uKSB7XG4gICAgaWYgKG9wdF91bml0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG9wdF91bml0ID0gJyc7XG4gICAgfVxuXG4gICAgdmFyIGRpdmlzb3IgPSAxMDAwO1xuICAgIHZhciBwcmVmaXggPSBzdGFuZGFyZFByZWZpeDtcblxuICAgIGlmIChvcHRfdHlwZSA9PT0gJ3NxdWFyZScpIHtcbiAgICAgIGRpdmlzb3IgPSAxMDAwMDAwO1xuICAgIH0gZWxzZSBpZiAob3B0X3R5cGUgPT09ICdiaW5hcnknKSB7XG4gICAgICBkaXZpc29yID0gMTAyNDtcbiAgICAgIHByZWZpeCA9IGJpbmFyeVByZWZpeDtcbiAgICB9XG5cbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBpbmRleF9tYXggPSBwcmVmaXgubGVuZ3RoIC0gMTtcblxuICAgIHdoaWxlIChudW1iZXIgPj0gZGl2aXNvciAmJiBpbmRleCA8IGluZGV4X21heCkge1xuICAgICAgbnVtYmVyID0gbnVtYmVyIC8gZGl2aXNvcjtcbiAgICAgIGluZGV4Kys7XG4gICAgfVxuXG4gICAgdmFyIHBvc3RmaXggPSBwcmVmaXhbaW5kZXhdICsgb3B0X3VuaXQ7XG4gICAgdmFyIHNwYWNlID0gcG9zdGZpeC5sZW5ndGggPT0gMCA/ICcnIDogXCJcXHhBMFwiO1xuICAgIHJldHVybiBudW1iZXJGaWx0ZXIobnVtYmVyLCBvcHRfcHJlY2lzaW9uKSArIHNwYWNlICsgcG9zdGZpeDtcbiAgfTtcblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZmlsdGVyKCduZ2VvVW5pdFByZWZpeCcsIFVuaXRQcmVmaXhGaWx0ZXIpO1xuXG5mdW5jdGlvbiBOdW1iZXJDb29yZGluYXRlc0ZpbHRlcigkZmlsdGVyKSB7XG4gIHZhciBmaWx0ZXJGbiA9IGZ1bmN0aW9uIGZpbHRlckZuKGNvb3JkaW5hdGVzLCBvcHRfZnJhY3Rpb25EaWdpdHMsIG9wdF90ZW1wbGF0ZSkge1xuICAgIHZhciB0ZW1wbGF0ZSA9IG9wdF90ZW1wbGF0ZSA/IG9wdF90ZW1wbGF0ZSA6ICd7eH0ge3l9JztcbiAgICB2YXIgeCA9IGNvb3JkaW5hdGVzWzBdO1xuICAgIHZhciB5ID0gY29vcmRpbmF0ZXNbMV07XG4gICAgdmFyIGZyYWN0aW9uRGlnaXRzID0gcGFyc2VJbnQob3B0X2ZyYWN0aW9uRGlnaXRzLCAxMCkgfCAwO1xuICAgIHZhciB4X3N0ciA9ICRmaWx0ZXIoJ251bWJlcicpKHgsIGZyYWN0aW9uRGlnaXRzKTtcbiAgICB2YXIgeV9zdHIgPSAkZmlsdGVyKCdudW1iZXInKSh5LCBmcmFjdGlvbkRpZ2l0cyk7XG4gICAgcmV0dXJuIHRlbXBsYXRlLnJlcGxhY2UoJ3t4fScsIHhfc3RyKS5yZXBsYWNlKCd7eX0nLCB5X3N0cik7XG4gIH07XG5cbiAgcmV0dXJuIGZpbHRlckZuO1xufVxuXG5tb2R1bGUuZmlsdGVyKCduZ2VvTnVtYmVyQ29vcmRpbmF0ZXMnLCBOdW1iZXJDb29yZGluYXRlc0ZpbHRlcik7XG5cbmZ1bmN0aW9uIERNU0Nvb3JkaW5hdGVzRmlsdGVyKCkge1xuICB2YXIgZGVncmVlc1RvU3RyaW5nSERNUyA9IGZ1bmN0aW9uIGRlZ3JlZXNUb1N0cmluZ0hETVMoZGVncmVlcywgaGVtaXNwaGVyZXMsIGZyYWN0aW9uRGlnaXRzKSB7XG4gICAgdmFyIG5vcm1hbGl6ZWREZWdyZWVzID0gbW9kdWxvKGRlZ3JlZXMgKyAxODAsIDM2MCkgLSAxODA7XG4gICAgdmFyIGRtcyA9IE1hdGguYWJzKDM2MDAgKiBub3JtYWxpemVkRGVncmVlcyk7XG4gICAgdmFyIGQgPSBNYXRoLmZsb29yKGRtcyAvIDM2MDApO1xuICAgIHZhciBtID0gTWF0aC5mbG9vcihkbXMgLyA2MCAlIDYwKTtcbiAgICB2YXIgcyA9IGRtcyAlIDYwO1xuICAgIHJldHVybiBkICsgXCJcXHhCMCBcIiArIHBhZE51bWJlcihtLCAyKSArIFwiXFx1MjAzMiBcIiArIHBhZE51bWJlcihzLCAyLCBmcmFjdGlvbkRpZ2l0cykgKyBcIlxcdTIwMzMgXCIgKyBoZW1pc3BoZXJlcy5jaGFyQXQobm9ybWFsaXplZERlZ3JlZXMgPCAwID8gMSA6IDApO1xuICB9O1xuXG4gIHZhciBmaWx0ZXJGbiA9IGZ1bmN0aW9uIGZpbHRlckZuKGNvb3JkaW5hdGVzLCBvcHRfZnJhY3Rpb25EaWdpdHMsIG9wdF90ZW1wbGF0ZSkge1xuICAgIHZhciBmcmFjdGlvbkRpZ2l0cyA9IHBhcnNlSW50KG9wdF9mcmFjdGlvbkRpZ2l0cywgMTApIHwgMDtcbiAgICB2YXIgdGVtcGxhdGUgPSBvcHRfdGVtcGxhdGUgPyBvcHRfdGVtcGxhdGUgOiAne3h9IHt5fSc7XG4gICAgdmFyIHhkbXMgPSBkZWdyZWVzVG9TdHJpbmdIRE1TKGNvb3JkaW5hdGVzWzBdLCAnRVcnLCBmcmFjdGlvbkRpZ2l0cyk7XG4gICAgdmFyIHlkbXMgPSBkZWdyZWVzVG9TdHJpbmdIRE1TKGNvb3JkaW5hdGVzWzFdLCAnTlMnLCBmcmFjdGlvbkRpZ2l0cyk7XG4gICAgcmV0dXJuIHRlbXBsYXRlLnJlcGxhY2UoJ3t4fScsIHhkbXMpLnJlcGxhY2UoJ3t5fScsIHlkbXMpO1xuICB9O1xuXG4gIHJldHVybiBmaWx0ZXJGbjtcbn1cblxubW9kdWxlLmZpbHRlcignbmdlb0RNU0Nvb3JkaW5hdGVzJywgRE1TQ29vcmRpbmF0ZXNGaWx0ZXIpO1xuXG5mdW5jdGlvbiB0cnVzdEh0bWxGaWx0ZXIoJHNjZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgaWYgKGlucHV0ICE9PSB1bmRlZmluZWQgJiYgaW5wdXQgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKFwiXCIgKyBpbnB1dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKCcmbmJzcDsnKTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5maWx0ZXIoJ25nZW9UcnVzdEh0bWwnLCB0cnVzdEh0bWxGaWx0ZXIpO1xuXG5mdW5jdGlvbiB0cnVzdEh0bWxBdXRvRmlsdGVyKCRzY2UsIG5nZW9TdHJpbmdUb0h0bWxSZXBsYWNlbWVudHMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIGlmIChpbnB1dCAhPT0gdW5kZWZpbmVkICYmIGlucHV0ICE9PSBudWxsKSB7XG4gICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBuZ2VvU3RyaW5nVG9IdG1sUmVwbGFjZW1lbnRzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICAgIHZhciBfcmVmO1xuXG4gICAgICAgICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmID0gX2l0ZXJhdG9yW19pKytdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgICAgICBpZiAoX2kuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHJlcGxhY2VtZW50ID0gX3JlZjtcblxuICAgICAgICAgIGlmIChpbnB1dC5tYXRjaChyZXBsYWNlbWVudC5leHByZXNzaW9uKSkge1xuICAgICAgICAgICAgaW5wdXQgPSByZXBsYWNlbWVudC50ZW1wbGF0ZS5yZXBsYWNlKC9cXCQxL2csIGlucHV0KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKFwiXCIgKyBpbnB1dCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbChcIlwiICsgaW5wdXQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbCgnJm5ic3A7Jyk7XG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZmlsdGVyKCduZ2VvVHJ1c3RIdG1sQXV0bycsIHRydXN0SHRtbEF1dG9GaWx0ZXIpO1xuXG5mdW5jdGlvbiBEdXJhdGlvbkZpbHRlcihnZXR0ZXh0Q2F0YWxvZykge1xuICB2YXIgVGltZVVuaXRzID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgU0VDT05EUzogU3ltYm9sKCdzZWNvbmRzJyksXG4gICAgTUlOVVRFUzogU3ltYm9sKCdtaW51dGVzJyksXG4gICAgSE9VUlM6IFN5bWJvbCgnaG91cnMnKSxcbiAgICBEQVlTOiBTeW1ib2woJ2RheXMnKVxuICB9KTtcblxuICB2YXIgcGx1cmFsaXplID0gZnVuY3Rpb24gcGx1cmFsaXplKGFtb3VudCwgdW5pdCkge1xuICAgIHZhciBmb3JtYXR0ZWRVbml0ID0gJyc7XG5cbiAgICBzd2l0Y2ggKHVuaXQpIHtcbiAgICAgIGNhc2UgVGltZVVuaXRzLlNFQ09ORFM6XG4gICAgICAgIGZvcm1hdHRlZFVuaXQgPSBnZXR0ZXh0Q2F0YWxvZy5nZXRQbHVyYWwoYW1vdW50LCAnc2Vjb25kJywgJ3NlY29uZHMnKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgVGltZVVuaXRzLk1JTlVURVM6XG4gICAgICAgIGZvcm1hdHRlZFVuaXQgPSBnZXR0ZXh0Q2F0YWxvZy5nZXRQbHVyYWwoYW1vdW50LCAnbWludXRlJywgJ21pbnV0ZXMnKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgVGltZVVuaXRzLkhPVVJTOlxuICAgICAgICBmb3JtYXR0ZWRVbml0ID0gZ2V0dGV4dENhdGFsb2cuZ2V0UGx1cmFsKGFtb3VudCwgJ2hvdXInLCAnaG91cnMnKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgVGltZVVuaXRzLkRBWVM6XG4gICAgICAgIGZvcm1hdHRlZFVuaXQgPSBnZXR0ZXh0Q2F0YWxvZy5nZXRQbHVyYWwoYW1vdW50LCAnZGF5JywgJ2RheXMnKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiBhbW91bnQgKyBcIiBcIiArIGZvcm1hdHRlZFVuaXQ7XG4gIH07XG5cbiAgdmFyIHJlc3VsdCA9IGZ1bmN0aW9uIHJlc3VsdChkdXJhdGlvbikge1xuICAgIGR1cmF0aW9uID0gTWF0aC5yb3VuZChkdXJhdGlvbik7XG4gICAgdmFyIG91dHB1dDtcblxuICAgIGlmIChkdXJhdGlvbiA8IDYwKSB7XG4gICAgICByZXR1cm4gcGx1cmFsaXplKGR1cmF0aW9uLCBUaW1lVW5pdHMuU0VDT05EUyk7XG4gICAgfVxuXG4gICAgdmFyIHJlbWFpbmRlciA9IGR1cmF0aW9uICUgNjA7XG4gICAgZHVyYXRpb24gPSBNYXRoLmZsb29yKGR1cmF0aW9uIC8gNjApO1xuXG4gICAgaWYgKGR1cmF0aW9uIDwgNjApIHtcbiAgICAgIG91dHB1dCA9IHBsdXJhbGl6ZShkdXJhdGlvbiwgVGltZVVuaXRzLk1JTlVURVMpO1xuXG4gICAgICBpZiAocmVtYWluZGVyID4gMCkge1xuICAgICAgICBvdXRwdXQgKz0gXCIgXCIgKyBwbHVyYWxpemUocmVtYWluZGVyLCBUaW1lVW5pdHMuU0VDT05EUyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuXG4gICAgcmVtYWluZGVyID0gZHVyYXRpb24gJSA2MDtcbiAgICBkdXJhdGlvbiA9IE1hdGguZmxvb3IoZHVyYXRpb24gLyA2MCk7XG5cbiAgICBpZiAoZHVyYXRpb24gPCAyNCkge1xuICAgICAgb3V0cHV0ID0gcGx1cmFsaXplKGR1cmF0aW9uLCBUaW1lVW5pdHMuSE9VUlMpO1xuXG4gICAgICBpZiAocmVtYWluZGVyID4gMCkge1xuICAgICAgICBvdXRwdXQgKz0gXCIgXCIgKyBwbHVyYWxpemUocmVtYWluZGVyLCBUaW1lVW5pdHMuTUlOVVRFUyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuXG4gICAgcmVtYWluZGVyID0gZHVyYXRpb24gJSAyNDtcbiAgICBkdXJhdGlvbiA9IE1hdGguZmxvb3IoZHVyYXRpb24gLyAyNCk7XG4gICAgb3V0cHV0ID0gcGx1cmFsaXplKGR1cmF0aW9uLCBUaW1lVW5pdHMuREFZUyk7XG5cbiAgICBpZiAocmVtYWluZGVyID4gMCkge1xuICAgICAgb3V0cHV0ICs9IFwiIFwiICsgcGx1cmFsaXplKHJlbWFpbmRlciwgVGltZVVuaXRzLkhPVVJTKTtcbiAgICB9XG5cbiAgICByZXR1cm4gb3V0cHV0O1xuICB9O1xuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbm1vZHVsZS5maWx0ZXIoJ25nZW9EdXJhdGlvbicsIER1cmF0aW9uRmlsdGVyKTtcbnZhciBTdHJpbmdUb0h0bWxSZXBsYWNlbWVudHMgPSBbe1xuICBleHByZXNzaW9uOiAvXihodHRwcz86XFwvXFwvLispJC9nbSxcbiAgdGVtcGxhdGU6ICc8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiJDFcIj4kMTwvYT4nXG59LCB7XG4gIGV4cHJlc3Npb246IC9eW0EtWjAtOS5fJSstXStAW0EtWjAtOS4tXStcXC5bQS1aXXsyLH0kL2dtaSxcbiAgdGVtcGxhdGU6ICc8YSBocmVmPVwibWFpbHRvOiQxXCI+JDE8L2E+J1xufV07XG5tb2R1bGUuY29uc3RhbnQoJ25nZW9TdHJpbmdUb0h0bWxSZXBsYWNlbWVudHMnLCBTdHJpbmdUb0h0bWxSZXBsYWNlbWVudHMpO1xuXG52YXIgcmVtb3ZlQ0RBVEEgPSBmdW5jdGlvbiByZW1vdmVDREFUQSgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIGlmIChpbnB1dCAmJiBpbnB1dC5yZXBsYWNlKSB7XG4gICAgICByZXR1cm4gaW5wdXQucmVwbGFjZSgvPCFcXFtDREFUQVxcWyguKilcXF1cXF0+LywgJyQxJyk7XG4gICAgfVxuICB9O1xufTtcblxubW9kdWxlLmZpbHRlcigncmVtb3ZlQ0RBVEEnLCByZW1vdmVDREFUQSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBEQVkgPSAxMDAwICogNjAgKiA2MCAqIDI0O1xudmFyIEhPVVIgPSAzNjAwO1xuXG5mdW5jdGlvbiBfY29tcGFyZShzdHIxLCBzdHIyKSB7XG4gIHJldHVybiB0eXBlb2Ygc3RyMSA9PT0gJ3N0cmluZycgJiYgdHlwZW9mIHN0cjIgPT09ICdzdHJpbmcnICYmIHN0cjEudG9Mb3dlckNhc2UoKSA9PT0gc3RyMi50b0xvd2VyQ2FzZSgpO1xufVxuXG5mdW5jdGlvbiBfbHBhZCh2YWx1ZSwgbGVuZ3RoLCBjaHIpIHtcbiAgdmFyIHZhbCA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gIGNociA9IGNociB8fCAnMCc7XG4gIHJldHVybiB2YWwubGVuZ3RoIDwgbGVuZ3RoID8gX2xwYWQoY2hyICsgdmFsLCBsZW5ndGgpIDogdmFsO1xufVxuXG5mdW5jdGlvbiBfZXh0ZW5kKG91dCkge1xuICBvdXQgPSBvdXQgfHwge307XG5cbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgb2JqID0gYXJndW1lbnRzW2ldO1xuXG4gICAgaWYgKCFvYmopIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICBpZiAodHlwZW9mIG9ialtrZXldID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIF9leHRlbmQob3V0W2tleV0sIG9ialtrZXldKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvdXRba2V5XSA9IG9ialtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG91dDtcbn1cblxuZnVuY3Rpb24gX2luZGV4T2YodmFsLCBhcnIpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoYXJyW2ldLnRvTG93ZXJDYXNlKCkgPT09IHZhbC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gLTE7XG59XG5cbnZhciBkZWZhdWx0U2V0dGluZ3MgPSB7XG4gIGRhdGVTZXR0aW5nczoge1xuICAgIGRheXM6IFsnU3VuZGF5JywgJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknXSxcbiAgICBkYXlzU2hvcnQ6IFsnU3VuJywgJ01vbicsICdUdWUnLCAnV2VkJywgJ1RodScsICdGcmknLCAnU2F0J10sXG4gICAgbW9udGhzOiBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXSxcbiAgICBtb250aHNTaG9ydDogWydKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1bicsICdKdWwnLCAnQXVnJywgJ1NlcCcsICdPY3QnLCAnTm92JywgJ0RlYyddLFxuICAgIG1lcmlkaWVtOiBbJ0FNJywgJ1BNJ10sXG4gICAgb3JkaW5hbDogZnVuY3Rpb24gb3JkaW5hbChudW1iZXIpIHtcbiAgICAgIHZhciBuID0gbnVtYmVyICUgMTAsXG4gICAgICAgICAgc3VmZml4ZXMgPSB7XG4gICAgICAgIDE6ICdzdCcsXG4gICAgICAgIDI6ICduZCcsXG4gICAgICAgIDM6ICdyZCdcbiAgICAgIH07XG4gICAgICByZXR1cm4gTWF0aC5mbG9vcihudW1iZXIgJSAxMDAgLyAxMCkgPT09IDEgfHwgIXN1ZmZpeGVzW25dID8gJ3RoJyA6IHN1ZmZpeGVzW25dO1xuICAgIH1cbiAgfSxcbiAgc2VwYXJhdG9yczogL1sgXFwtKy8uVDpAXS9nLFxuICB2YWxpZFBhcnRzOiAvW2REamxOU3d6V0ZtTW50TG9ZeWFBQmdHaEhpc3VlVElPUFpjclVdL2csXG4gIGludFBhcnRzOiAvW2Rqd056bW55WWhIZ0dpc10vZyxcbiAgdHpQYXJ0czogL1xcYig/OltQTUNFQV1bU0RQXVR8KD86UGFjaWZpY3xNb3VudGFpbnxDZW50cmFsfEVhc3Rlcm58QXRsYW50aWMpICg/OlN0YW5kYXJkfERheWxpZ2h0fFByZXZhaWxpbmcpIFRpbWV8KD86R01UfFVUQykoPzpbLStdXFxkezR9KT8pXFxiL2csXG4gIHR6Q2xpcDogL1teLStcXGRBLVpdL2dcbn07XG5cbnZhciBEYXRlRm9ybWF0dGVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBEYXRlRm9ybWF0dGVyKG9wdGlvbnMpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICAgIGNvbmZpZyA9IF9leHRlbmQoZGVmYXVsdFNldHRpbmdzLCBvcHRpb25zKTtcblxuICAgIHNlbGYuZGF0ZVNldHRpbmdzID0gY29uZmlnLmRhdGVTZXR0aW5ncztcbiAgICBzZWxmLnNlcGFyYXRvcnMgPSBjb25maWcuc2VwYXJhdG9ycztcbiAgICBzZWxmLnZhbGlkUGFydHMgPSBjb25maWcudmFsaWRQYXJ0cztcbiAgICBzZWxmLmludFBhcnRzID0gY29uZmlnLmludFBhcnRzO1xuICAgIHNlbGYudHpQYXJ0cyA9IGNvbmZpZy50elBhcnRzO1xuICAgIHNlbGYudHpDbGlwID0gY29uZmlnLnR6Q2xpcDtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBEYXRlRm9ybWF0dGVyLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZ2V0TW9udGggPSBmdW5jdGlvbiBnZXRNb250aCh2YWwpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGkgPSBfaW5kZXhPZih2YWwsIHNlbGYuZGF0ZVNldHRpbmdzLm1vbnRoc1Nob3J0KSArIDE7XG5cbiAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgaSA9IF9pbmRleE9mKHZhbCwgc2VsZi5kYXRlU2V0dGluZ3MubW9udGhzKSArIDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIGk7XG4gIH07XG5cbiAgX3Byb3RvLnBhcnNlRGF0ZSA9IGZ1bmN0aW9uIHBhcnNlRGF0ZSh2RGF0ZSwgdkZvcm1hdCkge1xuICAgIHZhciBzZWxmID0gdGhpcyxcbiAgICAgICAgdlNldHRpbmdzID0gc2VsZi5kYXRlU2V0dGluZ3MsXG4gICAgICAgIG91dCA9IHtcbiAgICAgIGRhdGU6IG51bGwsXG4gICAgICB5ZWFyOiBudWxsLFxuICAgICAgbW9udGg6IG51bGwsXG4gICAgICBkYXk6IG51bGwsXG4gICAgICBob3VyOiAwLFxuICAgICAgbWluOiAwLFxuICAgICAgc2VjOiAwXG4gICAgfTtcbiAgICB2YXIgdkRhdGVGbGFnID0gZmFsc2UsXG4gICAgICAgIHZUaW1lRmxhZyA9IGZhbHNlLFxuICAgICAgICBpO1xuXG4gICAgaWYgKCF2RGF0ZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKHZEYXRlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgcmV0dXJuIHZEYXRlO1xuICAgIH1cblxuICAgIGlmICh2Rm9ybWF0ID09PSAnVScpIHtcbiAgICAgIGkgPSBwYXJzZUludCh2RGF0ZSk7XG4gICAgICByZXR1cm4gaSA/IG5ldyBEYXRlKGkgKiAxMDAwKSA6IHZEYXRlO1xuICAgIH1cblxuICAgIHN3aXRjaCAodHlwZW9mIHZEYXRlKSB7XG4gICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICByZXR1cm4gbmV3IERhdGUodkRhdGUpO1xuXG4gICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdmFyIHZGb3JtYXRQYXJ0cyA9IHZGb3JtYXQubWF0Y2goc2VsZi52YWxpZFBhcnRzKTtcblxuICAgIGlmICghdkZvcm1hdFBhcnRzIHx8IHZGb3JtYXRQYXJ0cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgZGF0ZSBmb3JtYXQgZGVmaW5pdGlvbi5cIik7XG4gICAgfVxuXG4gICAgdmFyIHZEYXRlUGFydHMgPSB2RGF0ZS5yZXBsYWNlKHNlbGYuc2VwYXJhdG9ycywgJ1xcMCcpLnNwbGl0KCdcXDAnKTtcblxuICAgIGZvciAoaSA9IDA7IGkgPCB2RGF0ZVBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdkRhdGVQYXJ0ID0gdkRhdGVQYXJ0c1tpXTtcbiAgICAgIHZhciBpRGF0ZVBhcnQgPSBwYXJzZUludCh2RGF0ZVBhcnQpO1xuXG4gICAgICBzd2l0Y2ggKHZGb3JtYXRQYXJ0c1tpXSkge1xuICAgICAgICBjYXNlICd5JzpcbiAgICAgICAgY2FzZSAnWSc6XG4gICAgICAgICAgaWYgKGlEYXRlUGFydCkge1xuICAgICAgICAgICAgdmFyIGxlbiA9IHZEYXRlUGFydC5sZW5ndGg7XG4gICAgICAgICAgICBvdXQueWVhciA9IGxlbiA9PT0gMiA/IHBhcnNlSW50KChpRGF0ZVBhcnQgPCA3MCA/ICcyMCcgOiAnMTknKSArIHZEYXRlUGFydCkgOiBpRGF0ZVBhcnQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZEYXRlRmxhZyA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnbSc6XG4gICAgICAgIGNhc2UgJ24nOlxuICAgICAgICBjYXNlICdNJzpcbiAgICAgICAgY2FzZSAnRic6XG4gICAgICAgICAgaWYgKGlzTmFOKGlEYXRlUGFydCkpIHtcbiAgICAgICAgICAgIHZhciB2TW9udGggPSBzZWxmLmdldE1vbnRoKHZEYXRlUGFydCk7XG5cbiAgICAgICAgICAgIGlmICh2TW9udGggPiAwKSB7XG4gICAgICAgICAgICAgIG91dC5tb250aCA9IHZNb250aDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoaURhdGVQYXJ0ID49IDEgJiYgaURhdGVQYXJ0IDw9IDEyKSB7XG4gICAgICAgICAgICAgIG91dC5tb250aCA9IGlEYXRlUGFydDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZEYXRlRmxhZyA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZCc6XG4gICAgICAgIGNhc2UgJ2onOlxuICAgICAgICAgIGlmIChpRGF0ZVBhcnQgPj0gMSAmJiBpRGF0ZVBhcnQgPD0gMzEpIHtcbiAgICAgICAgICAgIG91dC5kYXkgPSBpRGF0ZVBhcnQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZEYXRlRmxhZyA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZyc6XG4gICAgICAgIGNhc2UgJ2gnOlxuICAgICAgICAgIHZhciB2TWVyaUluZGV4ID0gdkZvcm1hdFBhcnRzLmluY2x1ZGVzKCdhJykgPyB2Rm9ybWF0UGFydHMuaW5kZXhPZignYScpIDogdkZvcm1hdFBhcnRzLmluY2x1ZGVzKCdBJykgPyB2Rm9ybWF0UGFydHMuaW5kZXhPZignQScpIDogLTE7XG4gICAgICAgICAgdmFyIG1lciA9IHZEYXRlUGFydHNbdk1lcmlJbmRleF07XG5cbiAgICAgICAgICBpZiAodk1lcmlJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHZhciB2TWVyaU9mZnNldCA9IF9jb21wYXJlKG1lciwgdlNldHRpbmdzLm1lcmlkaWVtWzBdKSA/IDAgOiBfY29tcGFyZShtZXIsIHZTZXR0aW5ncy5tZXJpZGllbVsxXSkgPyAxMiA6IC0xO1xuXG4gICAgICAgICAgICBpZiAoaURhdGVQYXJ0ID49IDEgJiYgaURhdGVQYXJ0IDw9IDEyICYmIHZNZXJpT2Zmc2V0ICE9PSAtMSkge1xuICAgICAgICAgICAgICBvdXQuaG91ciA9IGlEYXRlUGFydCAlIDEyID09PSAwID8gdk1lcmlPZmZzZXQgOiBpRGF0ZVBhcnQgKyB2TWVyaU9mZnNldDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmIChpRGF0ZVBhcnQgPj0gMCAmJiBpRGF0ZVBhcnQgPD0gMjMpIHtcbiAgICAgICAgICAgICAgICBvdXQuaG91ciA9IGlEYXRlUGFydDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoaURhdGVQYXJ0ID49IDAgJiYgaURhdGVQYXJ0IDw9IDIzKSB7XG4gICAgICAgICAgICAgIG91dC5ob3VyID0gaURhdGVQYXJ0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdlRpbWVGbGFnID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdHJzpcbiAgICAgICAgY2FzZSAnSCc6XG4gICAgICAgICAgaWYgKGlEYXRlUGFydCA+PSAwICYmIGlEYXRlUGFydCA8PSAyMykge1xuICAgICAgICAgICAgb3V0LmhvdXIgPSBpRGF0ZVBhcnQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZUaW1lRmxhZyA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnaSc6XG4gICAgICAgICAgaWYgKGlEYXRlUGFydCA+PSAwICYmIGlEYXRlUGFydCA8PSA1OSkge1xuICAgICAgICAgICAgb3V0Lm1pbiA9IGlEYXRlUGFydDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdlRpbWVGbGFnID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdzJzpcbiAgICAgICAgICBpZiAoaURhdGVQYXJ0ID49IDAgJiYgaURhdGVQYXJ0IDw9IDU5KSB7XG4gICAgICAgICAgICBvdXQuc2VjID0gaURhdGVQYXJ0O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2VGltZUZsYWcgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh2RGF0ZUZsYWcgPT09IHRydWUgJiYgb3V0LnllYXIgJiYgb3V0Lm1vbnRoICYmIG91dC5kYXkpIHtcbiAgICAgIG91dC5kYXRlID0gbmV3IERhdGUob3V0LnllYXIsIG91dC5tb250aCAtIDEsIG91dC5kYXksIG91dC5ob3VyLCBvdXQubWluLCBvdXQuc2VjLCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHZUaW1lRmxhZyAhPT0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgb3V0LmRhdGUgPSBuZXcgRGF0ZSgwLCAwLCAwLCBvdXQuaG91ciwgb3V0Lm1pbiwgb3V0LnNlYywgMCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dC5kYXRlO1xuICB9O1xuXG4gIF9wcm90by5ndWVzc0RhdGUgPSBmdW5jdGlvbiBndWVzc0RhdGUodkRhdGVTdHIsIHZGb3JtYXQpIHtcbiAgICBpZiAodHlwZW9mIHZEYXRlU3RyICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIHZEYXRlU3RyO1xuICAgIH1cblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgdlBhcnRzID0gdkRhdGVTdHIucmVwbGFjZShzZWxmLnNlcGFyYXRvcnMsICdcXDAnKS5zcGxpdCgnXFwwJyksXG4gICAgICAgIHZQYXR0ZXJuID0gL15bZGptbl0vZztcbiAgICB2YXIgdkZvcm1hdFBhcnRzID0gdkZvcm1hdC5tYXRjaChzZWxmLnZhbGlkUGFydHMpO1xuICAgIHZhciB2RGF0ZSA9IG5ldyBEYXRlKCk7XG5cbiAgICBpZiAoIXZQYXR0ZXJuLnRlc3QodkZvcm1hdFBhcnRzWzBdKSkge1xuICAgICAgcmV0dXJuIHZEYXRlU3RyO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdlBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdkRpZ2l0ID0gMjtcbiAgICAgIHZhciBpUGFydCA9IHZQYXJ0c1tpXTtcbiAgICAgIHZhciBpU2VjID0gcGFyc2VJbnQoaVBhcnQuc3Vic3RyKDAsIDIpKTtcblxuICAgICAgaWYgKGlzTmFOKGlTZWMpKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBzd2l0Y2ggKGkpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgIGlmICh2Rm9ybWF0UGFydHNbMF0gPT09ICdtJyB8fCB2Rm9ybWF0UGFydHNbMF0gPT09ICduJykge1xuICAgICAgICAgICAgdkRhdGUuc2V0TW9udGgoaVNlYyAtIDEpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2RGF0ZS5zZXREYXRlKGlTZWMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBpZiAodkZvcm1hdFBhcnRzWzBdID09PSAnbScgfHwgdkZvcm1hdFBhcnRzWzBdID09PSAnbicpIHtcbiAgICAgICAgICAgIHZEYXRlLnNldERhdGUoaVNlYyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZEYXRlLnNldE1vbnRoKGlTZWMgLSAxKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgdmFyIHZZZWFyID0gdkRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICB2YXIgbGVuID0gaVBhcnQubGVuZ3RoO1xuICAgICAgICAgIHZEaWdpdCA9IGxlbiA8IDQgPyBsZW4gOiA0O1xuICAgICAgICAgIHZZZWFyID0gcGFyc2VJbnQobGVuIDwgNCA/IHZZZWFyLnRvU3RyaW5nKCkuc3Vic3RyKDAsIDQgLSBsZW4pICsgaVBhcnQgOiBpUGFydC5zdWJzdHIoMCwgNCkpO1xuXG4gICAgICAgICAgaWYgKCF2WWVhcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdkRhdGUuc2V0RnVsbFllYXIodlllYXIpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICB2RGF0ZS5zZXRIb3VycyhpU2VjKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgdkRhdGUuc2V0TWludXRlcyhpU2VjKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgdkRhdGUuc2V0U2Vjb25kcyhpU2VjKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgdmFyIG4gPSBpUGFydC5zdWJzdHIodkRpZ2l0KTtcblxuICAgICAgaWYgKG4ubGVuZ3RoID4gMCkge1xuICAgICAgICB2UGFydHMuc3BsaWNlKGkgKyAxLCAwLCBuKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdkRhdGU7XG4gIH07XG5cbiAgX3Byb3RvLnBhcnNlRm9ybWF0ID0gZnVuY3Rpb24gcGFyc2VGb3JtYXQodkNoYXIsIHZEYXRlKSB7XG4gICAgdmFyIGZtdCA9IG51bGw7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICAgIHZTZXR0aW5ncyA9IHNlbGYuZGF0ZVNldHRpbmdzLFxuICAgICAgICBiYWNrc2xhc2ggPSAvXFxcXD8oLj8pL2dpLFxuICAgICAgICBkb0Zvcm1hdCA9IGZ1bmN0aW9uIGRvRm9ybWF0KHQsIHMpIHtcbiAgICAgIHJldHVybiBmbXRbdF0gPyBmbXRbdF0oKSA6IHM7XG4gICAgfTtcblxuICAgIGZtdCA9IHtcbiAgICAgIGQ6IGZ1bmN0aW9uIGQoKSB7XG4gICAgICAgIHJldHVybiBfbHBhZChmbXQuaigpLCAyKTtcbiAgICAgIH0sXG4gICAgICBEOiBmdW5jdGlvbiBEKCkge1xuICAgICAgICByZXR1cm4gdlNldHRpbmdzLmRheXNTaG9ydFtmbXQudygpXTtcbiAgICAgIH0sXG4gICAgICBqOiBmdW5jdGlvbiBqKCkge1xuICAgICAgICByZXR1cm4gdkRhdGUuZ2V0RGF0ZSgpO1xuICAgICAgfSxcbiAgICAgIGw6IGZ1bmN0aW9uIGwoKSB7XG4gICAgICAgIHJldHVybiB2U2V0dGluZ3MuZGF5c1tmbXQudygpXTtcbiAgICAgIH0sXG4gICAgICBOOiBmdW5jdGlvbiBOKCkge1xuICAgICAgICByZXR1cm4gZm10LncoKSB8fCA3O1xuICAgICAgfSxcbiAgICAgIHc6IGZ1bmN0aW9uIHcoKSB7XG4gICAgICAgIHJldHVybiB2RGF0ZS5nZXREYXkoKTtcbiAgICAgIH0sXG4gICAgICB6OiBmdW5jdGlvbiB6KCkge1xuICAgICAgICB2YXIgYSA9IG5ldyBEYXRlKGZtdC5ZKCksIGZtdC5uKCkgLSAxLCBmbXQuaigpKSxcbiAgICAgICAgICAgIGIgPSBuZXcgRGF0ZShmbXQuWSgpLCAwLCAxKTtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoKGEgLSBiKSAvIERBWSk7XG4gICAgICB9LFxuICAgICAgVzogZnVuY3Rpb24gVygpIHtcbiAgICAgICAgdmFyIGEgPSBuZXcgRGF0ZShmbXQuWSgpLCBmbXQubigpIC0gMSwgZm10LmooKSAtIGZtdC5OKCkgKyAzKTtcbiAgICAgICAgdmFyIGIgPSBuZXcgRGF0ZShhLmdldEZ1bGxZZWFyKCksIDAsIDQpO1xuICAgICAgICByZXR1cm4gX2xwYWQoMSArIE1hdGgucm91bmQoKGEgLSBiKSAvIERBWSAvIDcpLCAyKTtcbiAgICAgIH0sXG4gICAgICBGOiBmdW5jdGlvbiBGKCkge1xuICAgICAgICByZXR1cm4gdlNldHRpbmdzLm1vbnRoc1t2RGF0ZS5nZXRNb250aCgpXTtcbiAgICAgIH0sXG4gICAgICBtOiBmdW5jdGlvbiBtKCkge1xuICAgICAgICByZXR1cm4gX2xwYWQoZm10Lm4oKSwgMik7XG4gICAgICB9LFxuICAgICAgTTogZnVuY3Rpb24gTSgpIHtcbiAgICAgICAgcmV0dXJuIHZTZXR0aW5ncy5tb250aHNTaG9ydFt2RGF0ZS5nZXRNb250aCgpXTtcbiAgICAgIH0sXG4gICAgICBuOiBmdW5jdGlvbiBuKCkge1xuICAgICAgICByZXR1cm4gdkRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgICB9LFxuICAgICAgdDogZnVuY3Rpb24gdCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGZtdC5ZKCksIGZtdC5uKCksIDApLmdldERhdGUoKTtcbiAgICAgIH0sXG4gICAgICBMOiBmdW5jdGlvbiBMKCkge1xuICAgICAgICB2YXIgWSA9IGZtdC5ZKCk7XG4gICAgICAgIHJldHVybiBZICUgNCA9PT0gMCAmJiBZICUgMTAwICE9PSAwIHx8IFkgJSA0MDAgPT09IDAgPyAxIDogMDtcbiAgICAgIH0sXG4gICAgICBvOiBmdW5jdGlvbiBvKCkge1xuICAgICAgICB2YXIgbiA9IGZtdC5uKCksXG4gICAgICAgICAgICBXID0gZm10LlcoKSxcbiAgICAgICAgICAgIFkgPSBmbXQuWSgpO1xuICAgICAgICByZXR1cm4gWSArIChuID09PSAxMiAmJiBXIDwgOSA/IDEgOiBuID09PSAxICYmIFcgPiA5ID8gLTEgOiAwKTtcbiAgICAgIH0sXG4gICAgICBZOiBmdW5jdGlvbiBZKCkge1xuICAgICAgICByZXR1cm4gdkRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgIH0sXG4gICAgICB5OiBmdW5jdGlvbiB5KCkge1xuICAgICAgICByZXR1cm4gZm10LlkoKS50b1N0cmluZygpLnNsaWNlKC0yKTtcbiAgICAgIH0sXG4gICAgICBhOiBmdW5jdGlvbiBhKCkge1xuICAgICAgICByZXR1cm4gZm10LkEoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgfSxcbiAgICAgIEE6IGZ1bmN0aW9uIEEoKSB7XG4gICAgICAgIHZhciBuID0gZm10LkcoKSA8IDEyID8gMCA6IDE7XG4gICAgICAgIHJldHVybiB2U2V0dGluZ3MubWVyaWRpZW1bbl07XG4gICAgICB9LFxuICAgICAgQjogZnVuY3Rpb24gQigpIHtcbiAgICAgICAgdmFyIEggPSB2RGF0ZS5nZXRVVENIb3VycygpICogSE9VUjtcbiAgICAgICAgdmFyIGkgPSB2RGF0ZS5nZXRVVENNaW51dGVzKCkgKiA2MDtcbiAgICAgICAgdmFyIHMgPSB2RGF0ZS5nZXRVVENTZWNvbmRzKCk7XG4gICAgICAgIHJldHVybiBfbHBhZChNYXRoLmZsb29yKChIICsgaSArIHMgKyBIT1VSKSAvIDg2LjQpICUgMTAwMCwgMyk7XG4gICAgICB9LFxuICAgICAgZzogZnVuY3Rpb24gZygpIHtcbiAgICAgICAgcmV0dXJuIGZtdC5HKCkgJSAxMiB8fCAxMjtcbiAgICAgIH0sXG4gICAgICBHOiBmdW5jdGlvbiBHKCkge1xuICAgICAgICByZXR1cm4gdkRhdGUuZ2V0SG91cnMoKTtcbiAgICAgIH0sXG4gICAgICBoOiBmdW5jdGlvbiBoKCkge1xuICAgICAgICByZXR1cm4gX2xwYWQoZm10LmcoKSwgMik7XG4gICAgICB9LFxuICAgICAgSDogZnVuY3Rpb24gSCgpIHtcbiAgICAgICAgcmV0dXJuIF9scGFkKGZtdC5HKCksIDIpO1xuICAgICAgfSxcbiAgICAgIGk6IGZ1bmN0aW9uIGkoKSB7XG4gICAgICAgIHJldHVybiBfbHBhZCh2RGF0ZS5nZXRNaW51dGVzKCksIDIpO1xuICAgICAgfSxcbiAgICAgIHM6IGZ1bmN0aW9uIHMoKSB7XG4gICAgICAgIHJldHVybiBfbHBhZCh2RGF0ZS5nZXRTZWNvbmRzKCksIDIpO1xuICAgICAgfSxcbiAgICAgIHU6IGZ1bmN0aW9uIHUoKSB7XG4gICAgICAgIHJldHVybiBfbHBhZCh2RGF0ZS5nZXRNaWxsaXNlY29uZHMoKSAqIDEwMDAsIDYpO1xuICAgICAgfSxcbiAgICAgIGU6IGZ1bmN0aW9uIGUoKSB7XG4gICAgICAgIHZhciBzdHIgPSAvXFwoKC4qKVxcKS8uZXhlYyhTdHJpbmcodkRhdGUpKVsxXTtcbiAgICAgICAgcmV0dXJuIHN0ciB8fCAnQ29vcmRpbmF0ZWQgVW5pdmVyc2FsIFRpbWUnO1xuICAgICAgfSxcbiAgICAgIEk6IGZ1bmN0aW9uIEkoKSB7XG4gICAgICAgIHZhciBhID0gbmV3IERhdGUoZm10LlkoKSwgMCksXG4gICAgICAgICAgICBjID0gRGF0ZS5VVEMoZm10LlkoKSwgMCksXG4gICAgICAgICAgICBiID0gbmV3IERhdGUoZm10LlkoKSwgNiksXG4gICAgICAgICAgICBkID0gRGF0ZS5VVEMoZm10LlkoKSwgNik7XG4gICAgICAgIHJldHVybiBhIC0gYyAhPT0gYiAtIGQgPyAxIDogMDtcbiAgICAgIH0sXG4gICAgICBPOiBmdW5jdGlvbiBPKCkge1xuICAgICAgICB2YXIgdHpvID0gdkRhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKSxcbiAgICAgICAgICAgIGEgPSBNYXRoLmFicyh0em8pO1xuICAgICAgICByZXR1cm4gKHR6byA+IDAgPyAnLScgOiAnKycpICsgX2xwYWQoTWF0aC5mbG9vcihhIC8gNjApICogMTAwICsgYSAlIDYwLCA0KTtcbiAgICAgIH0sXG4gICAgICBQOiBmdW5jdGlvbiBQKCkge1xuICAgICAgICB2YXIgTyA9IGZtdC5PKCk7XG4gICAgICAgIHJldHVybiBPLnN1YnN0cigwLCAzKSArICc6JyArIE8uc3Vic3RyKDMsIDIpO1xuICAgICAgfSxcbiAgICAgIFQ6IGZ1bmN0aW9uIFQoKSB7XG4gICAgICAgIHZhciBzdHIgPSAoU3RyaW5nKHZEYXRlKS5tYXRjaChzZWxmLnR6UGFydHMpIHx8IFtcIlwiXSkucG9wKCkucmVwbGFjZShzZWxmLnR6Q2xpcCwgXCJcIik7XG4gICAgICAgIHJldHVybiBzdHIgfHwgJ1VUQyc7XG4gICAgICB9LFxuICAgICAgWjogZnVuY3Rpb24gWigpIHtcbiAgICAgICAgcmV0dXJuIC12RGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpICogNjA7XG4gICAgICB9LFxuICAgICAgYzogZnVuY3Rpb24gYygpIHtcbiAgICAgICAgcmV0dXJuICdZLW0tZFxcXFxUSDppOnNQJy5yZXBsYWNlKGJhY2tzbGFzaCwgZG9Gb3JtYXQpO1xuICAgICAgfSxcbiAgICAgIHI6IGZ1bmN0aW9uIHIoKSB7XG4gICAgICAgIHJldHVybiAnRCwgZCBNIFkgSDppOnMgTycucmVwbGFjZShiYWNrc2xhc2gsIGRvRm9ybWF0KTtcbiAgICAgIH0sXG4gICAgICBVOiBmdW5jdGlvbiBVKCkge1xuICAgICAgICByZXR1cm4gdkRhdGUuZ2V0VGltZSgpIC8gMTAwMCB8fCAwO1xuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIGRvRm9ybWF0KHZDaGFyLCB2Q2hhcik7XG4gIH07XG5cbiAgX3Byb3RvLmZvcm1hdERhdGUgPSBmdW5jdGlvbiBmb3JtYXREYXRlKHZEYXRlLCB2Rm9ybWF0KSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICBCQUNLU0xBU0ggPSAnXFxcXCc7XG5cbiAgICBpZiAodHlwZW9mIHZEYXRlID09PSAnc3RyaW5nJykge1xuICAgICAgdkRhdGUgPSBzZWxmLnBhcnNlRGF0ZSh2RGF0ZSwgdkZvcm1hdCk7XG5cbiAgICAgIGlmICghdkRhdGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHZEYXRlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgdmFyIHZEYXRlU3RyID0gJyc7XG4gICAgICB2YXIgbGVuID0gdkZvcm1hdC5sZW5ndGg7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIHZDaGFyID0gdkZvcm1hdC5jaGFyQXQoaSk7XG5cbiAgICAgICAgaWYgKHZDaGFyID09PSAnUycgfHwgdkNoYXIgPT09IEJBQ0tTTEFTSCkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGkgPiAwICYmIHZGb3JtYXQuY2hhckF0KGkgLSAxKSA9PT0gQkFDS1NMQVNIKSB7XG4gICAgICAgICAgdkRhdGVTdHIgKz0gdkNoYXI7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3RyID0gc2VsZi5wYXJzZUZvcm1hdCh2Q2hhciwgdkRhdGUpO1xuXG4gICAgICAgIGlmIChpICE9PSBsZW4gLSAxICYmIHNlbGYuaW50UGFydHMudGVzdCh2Q2hhcikgJiYgdkZvcm1hdC5jaGFyQXQoaSArIDEpID09PSAnUycpIHtcbiAgICAgICAgICB2YXIgbiA9IHBhcnNlSW50KHN0cikgfHwgMDtcbiAgICAgICAgICBzdHIgKz0gc2VsZi5kYXRlU2V0dGluZ3Mub3JkaW5hbChuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZEYXRlU3RyICs9IHN0cjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZEYXRlU3RyO1xuICAgIH1cblxuICAgIHJldHVybiAnJztcbiAgfTtcblxuICByZXR1cm4gRGF0ZUZvcm1hdHRlcjtcbn0oKTtcblxuZXhwb3J0IHsgRGF0ZUZvcm1hdHRlciBhcyBkZWZhdWx0IH07Iiwic29ydGFibGVDb21wb25lbnQuJGluamVjdCA9IFtcIiR0aW1lb3V0XCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgJ2pxdWVyeS11aS91aS93aWRnZXRzL3NvcnRhYmxlLmpzJztcbmltcG9ydCAnbmdlby9zYXNzL2pxdWVyeS11aS5zY3NzJztcbmltcG9ydCAnanF1ZXJ5LXVpLXRvdWNoLXB1bmNoJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb1NvcnRhYmxlJywgW10pO1xuXG5mdW5jdGlvbiBzb3J0YWJsZUNvbXBvbmVudCgkdGltZW91dCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIHZhciBzb3J0YWJsZSA9IHNjb3BlLiRldmFsKGF0dHJzLm5nZW9Tb3J0YWJsZSkgfHwgW107XG4gICAgICBjb25zb2xlLmFzc2VydChBcnJheS5pc0FycmF5KHNvcnRhYmxlKSk7XG4gICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNvcnRhYmxlO1xuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBzb3J0YWJsZS5sZW5ndGggJiYgJHRpbWVvdXQocmVzZXRVcERyYWdEcm9wLCAwKTtcbiAgICAgIH0pO1xuICAgICAgdmFyIG9wdGlvbnNPYmplY3QgPSBzY29wZS4kZXZhbChhdHRycy5uZ2VvU29ydGFibGVPcHRpb25zKTtcbiAgICAgIHZhciBvcHRpb25zID0gZ2V0T3B0aW9ucyhvcHRpb25zT2JqZWN0KTtcbiAgICAgIHZhciBjYWxsYmFja0ZuID0gc2NvcGUuJGV2YWwoYXR0cnMubmdlb1NvcnRhYmxlQ2FsbGJhY2spO1xuICAgICAgdmFyIGNhbGxiYWNrQ3R4ID0gc2NvcGUuJGV2YWwoYXR0cnMubmdlb1NvcnRhYmxlQ2FsbGJhY2tDdHgpO1xuXG4gICAgICBmdW5jdGlvbiByZXNldFVwRHJhZ0Ryb3AoKSB7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IGVsZW1lbnQuY2hpbGRyZW4oKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgYW5ndWxhci5lbGVtZW50KGNoaWxkcmVuW2ldKS5kYXRhKCdpZHgnLCBpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzb3J0YWJsZUVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuXG4gICAgICAgIGlmIChzb3J0YWJsZUVsZW1lbnQuZGF0YSgndWktc29ydGFibGUnKSkge1xuICAgICAgICAgIHNvcnRhYmxlRWxlbWVudC5vZmYoJ3NvcnR1cGRhdGUnKTtcbiAgICAgICAgICBzb3J0YWJsZUVsZW1lbnQuc29ydGFibGUoJ2Rlc3Ryb3knKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzb3J0YWJsZU9wdGlvbnMgPSB7XG4gICAgICAgICAgYXhpczogJ3knLFxuICAgICAgICAgIGNsYXNzZXM6IHtcbiAgICAgICAgICAgICd1aS1zb3J0YWJsZS1oZWxwZXInOiBvcHRpb25zLmRyYWdnZXJDbGFzc05hbWVcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuaGFuZGxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgc29ydGFibGVPcHRpb25zLmhhbmRsZSA9IFwiLlwiICsgb3B0aW9ucy5oYW5kbGVDbGFzc05hbWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0aW9ucy5wbGFjZWhvbGRlckNsYXNzTmFtZSkge1xuICAgICAgICAgIHNvcnRhYmxlT3B0aW9ucy5wbGFjZWhvbGRlciA9IG9wdGlvbnMucGxhY2Vob2xkZXJDbGFzc05hbWU7XG4gICAgICAgICAgc29ydGFibGVPcHRpb25zLmZvcmNlUGxhY2Vob2xkZXJTaXplID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNvcnRhYmxlRWxlbWVudC5zb3J0YWJsZShzb3J0YWJsZU9wdGlvbnMpO1xuICAgICAgICBzb3J0YWJsZUVsZW1lbnQub24oJ3NvcnR1cGRhdGUnLCBmdW5jdGlvbiAoZXZlbnQsIHVpKSB7XG4gICAgICAgICAgdmFyIG9sZEluZGV4ID0gJCh1aS5pdGVtWzBdKS5kYXRhKCdpZHgnKTtcbiAgICAgICAgICB2YXIgbmV3SW5kZXggPSB1aS5pdGVtLmluZGV4KCk7XG4gICAgICAgICAgJCh1aS5pdGVtWzBdKS5kYXRhKCdpZHgnLCBuZXdJbmRleCk7XG4gICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNvcnRhYmxlLnNwbGljZShuZXdJbmRleCwgMCwgc29ydGFibGUuc3BsaWNlKG9sZEluZGV4LCAxKVswXSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAoY2FsbGJhY2tGbiBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICAgICAgICBjYWxsYmFja0ZuLmFwcGx5KGNhbGxiYWNrQ3R4LCBbZWxlbWVudCwgc29ydGFibGVdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHJldDtcbiAgICAgICAgdmFyIGRlZmF1bHRIYW5kbGVDbGFzc05hbWUgPSAnbmdlby1zb3J0YWJsZS1oYW5kbGUnO1xuXG4gICAgICAgIGlmIChvcHRpb25zID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICByZXQgPSB7XG4gICAgICAgICAgICAnaGFuZGxlQ2xhc3NOYW1lJzogZGVmYXVsdEhhbmRsZUNsYXNzTmFtZVxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKG9wdGlvbnMuaGFuZGxlQ2xhc3NOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9wdGlvbnMuaGFuZGxlQ2xhc3NOYW1lID0gZGVmYXVsdEhhbmRsZUNsYXNzTmFtZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXQgPSBvcHRpb25zO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5kaXJlY3RpdmUoJ25nZW9Tb3J0YWJsZScsIHNvcnRhYmxlQ29tcG9uZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb01pc2NTd2lwZScsIFtdKTtcbm1vZHVsZS5mYWN0b3J5KCckdmVydGljYWxTd2lwZScsIFtmdW5jdGlvbiAoKSB7XG4gIHZhciBNT1ZFX0JVRkZFUl9SQURJVVMgPSAxMDtcbiAgdmFyIFBPSU5URVJfRVZFTlRTID0ge1xuICAgIG1vdXNlOiB7XG4gICAgICBzdGFydDogJ21vdXNlZG93bicsXG4gICAgICBtb3ZlOiAnbW91c2Vtb3ZlJyxcbiAgICAgIGVuZDogJ21vdXNldXAnXG4gICAgfSxcbiAgICB0b3VjaDoge1xuICAgICAgc3RhcnQ6ICd0b3VjaHN0YXJ0JyxcbiAgICAgIG1vdmU6ICd0b3VjaG1vdmUnLFxuICAgICAgZW5kOiAndG91Y2hlbmQnLFxuICAgICAgY2FuY2VsOiAndG91Y2hjYW5jZWwnXG4gICAgfSxcbiAgICBwb2ludGVyOiB7XG4gICAgICBzdGFydDogJ3BvaW50ZXJkb3duJyxcbiAgICAgIG1vdmU6ICdwb2ludGVybW92ZScsXG4gICAgICBlbmQ6ICdwb2ludGVydXAnLFxuICAgICAgY2FuY2VsOiAncG9pbnRlcmNhbmNlbCdcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0Q29vcmRpbmF0ZXMoZXZlbnQpIHtcbiAgICB2YXIgdWlFdmVudDtcbiAgICB2YXIgdG91Y2hFdmVudCA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQ7XG5cbiAgICBpZiAodG91Y2hFdmVudC5jaGFuZ2VkVG91Y2hlcyAmJiB0b3VjaEV2ZW50LmNoYW5nZWRUb3VjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHVpRXZlbnQgPSB0b3VjaEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdO1xuICAgIH0gZWxzZSB7XG4gICAgICB1aUV2ZW50ID0gZXZlbnQub3JpZ2luYWxFdmVudDtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgeDogdWlFdmVudC5jbGllbnRYLFxuICAgICAgeTogdWlFdmVudC5jbGllbnRZXG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEV2ZW50cyhwb2ludGVyVHlwZXMsIGV2ZW50VHlwZSkge1xuICAgIHZhciByZXMgPSBbXTtcbiAgICBhbmd1bGFyLmZvckVhY2gocG9pbnRlclR5cGVzLCBmdW5jdGlvbiAocG9pbnRlclR5cGUpIHtcbiAgICAgIHZhciBldmVudE5hbWUgPSBQT0lOVEVSX0VWRU5UU1twb2ludGVyVHlwZV1bZXZlbnRUeXBlXTtcblxuICAgICAgaWYgKGV2ZW50TmFtZSkge1xuICAgICAgICByZXMucHVzaChldmVudE5hbWUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXMuam9pbignICcpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBiaW5kOiBmdW5jdGlvbiBiaW5kKGVsZW1lbnQsIGV2ZW50SGFuZGxlcnMsIHBvaW50ZXJUeXBlcykge1xuICAgICAgdmFyIHRvdGFsWDtcbiAgICAgIHZhciB0b3RhbFk7XG4gICAgICB2YXIgc3RhcnRDb29yZHM7XG4gICAgICB2YXIgbGFzdFBvcztcbiAgICAgIHZhciBhY3RpdmUgPSBmYWxzZTtcbiAgICAgIHBvaW50ZXJUeXBlcyA9IHBvaW50ZXJUeXBlcyB8fCBbJ21vdXNlJywgJ3RvdWNoJywgJ3BvaW50ZXInXTtcbiAgICAgIGVsZW1lbnQub24oZ2V0RXZlbnRzKHBvaW50ZXJUeXBlcywgJ3N0YXJ0JyksIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBzdGFydENvb3JkcyA9IGdldENvb3JkaW5hdGVzKGV2ZW50KTtcbiAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdG90YWxYID0gMDtcbiAgICAgICAgdG90YWxZID0gMDtcbiAgICAgICAgbGFzdFBvcyA9IHN0YXJ0Q29vcmRzO1xuXG4gICAgICAgIGlmIChldmVudEhhbmRsZXJzLnN0YXJ0KSB7XG4gICAgICAgICAgZXZlbnRIYW5kbGVycy5zdGFydChzdGFydENvb3JkcywgZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHZhciBldmVudHMgPSBnZXRFdmVudHMocG9pbnRlclR5cGVzLCAnY2FuY2VsJyk7XG5cbiAgICAgIGlmIChldmVudHMpIHtcbiAgICAgICAgZWxlbWVudC5vbihldmVudHMsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgaWYgKGV2ZW50SGFuZGxlcnMuY2FuY2VsKSB7XG4gICAgICAgICAgICBldmVudEhhbmRsZXJzLmNhbmNlbChldmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZWxlbWVudC5vbihnZXRFdmVudHMocG9pbnRlclR5cGVzLCAnbW92ZScpLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKCFhY3RpdmUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXN0YXJ0Q29vcmRzKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGNvb3JkcyA9IGdldENvb3JkaW5hdGVzKGV2ZW50KTtcbiAgICAgICAgdG90YWxYICs9IE1hdGguYWJzKGNvb3Jkcy54IC0gbGFzdFBvcy54KTtcbiAgICAgICAgdG90YWxZICs9IE1hdGguYWJzKGNvb3Jkcy55IC0gbGFzdFBvcy55KTtcbiAgICAgICAgbGFzdFBvcyA9IGNvb3JkcztcblxuICAgICAgICBpZiAodG90YWxYIDwgTU9WRV9CVUZGRVJfUkFESVVTICYmIHRvdGFsWSA8IE1PVkVfQlVGRkVSX1JBRElVUykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0b3RhbFggPiB0b3RhbFkpIHtcbiAgICAgICAgICBhY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICAgIGlmIChldmVudEhhbmRsZXJzLmNhbmNlbCkge1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVycy5jYW5jZWwoZXZlbnQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgaWYgKGV2ZW50SGFuZGxlcnMubW92ZSkge1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVycy5tb3ZlKGNvb3JkcywgZXZlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBlbGVtZW50Lm9uKGdldEV2ZW50cyhwb2ludGVyVHlwZXMsICdlbmQnKSwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmICghYWN0aXZlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKGV2ZW50SGFuZGxlcnMuZW5kKSB7XG4gICAgICAgICAgZXZlbnRIYW5kbGVycy5lbmQoZ2V0Q29vcmRpbmF0ZXMoZXZlbnQpLCBldmVudCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1dKTtcblxuZnVuY3Rpb24gbWFrZVN3aXBlRGlyZWN0aXZlXyhkaXJlY3RpdmVOYW1lLCBkaXJlY3Rpb24sIGV2ZW50TmFtZSkge1xuICBtb2R1bGUuZGlyZWN0aXZlKGRpcmVjdGl2ZU5hbWUsIFsnJHBhcnNlJywgJyR2ZXJ0aWNhbFN3aXBlJywgZnVuY3Rpb24gKCRwYXJzZSwgJHZlcnRpY2FsU3dpcGUpIHtcbiAgICB2YXIgTUFYX0hPUklaT05UQUxfRElTVEFOQ0UgPSA3NTtcbiAgICB2YXIgTUFYX0hPUklaT05UQUxfUkFUSU8gPSAwLjM7XG4gICAgdmFyIE1JTl9WRVJUSUNBTF9ESVNUQU5DRSA9IDMwO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgIHZhciBzd2lwZUhhbmRsZXIgPSAkcGFyc2UoYXR0cltkaXJlY3RpdmVOYW1lXSk7XG4gICAgICB2YXIgc3RhcnRDb29yZHM7XG4gICAgICB2YXIgdmFsaWQ7XG5cbiAgICAgIGZ1bmN0aW9uIHZhbGlkU3dpcGUoY29vcmRzKSB7XG4gICAgICAgIGlmICghc3RhcnRDb29yZHMpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZGVsdGFZID0gKGNvb3Jkcy55IC0gc3RhcnRDb29yZHMueSkgKiBkaXJlY3Rpb247XG4gICAgICAgIHZhciBkZWx0YVggPSBNYXRoLmFicyhjb29yZHMueCAtIHN0YXJ0Q29vcmRzLngpO1xuICAgICAgICByZXR1cm4gdmFsaWQgJiYgZGVsdGFYIDwgTUFYX0hPUklaT05UQUxfRElTVEFOQ0UgJiYgZGVsdGFZID4gMCAmJiBkZWx0YVkgPiBNSU5fVkVSVElDQUxfRElTVEFOQ0UgJiYgZGVsdGFYIC8gZGVsdGFZIDwgTUFYX0hPUklaT05UQUxfUkFUSU87XG4gICAgICB9XG5cbiAgICAgIHZhciBwb2ludGVyVHlwZXMgPSBbJ3RvdWNoJ107XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm5nZW9Td2lwZURpc2FibGVNb3VzZSkpIHtcbiAgICAgICAgcG9pbnRlclR5cGVzLnB1c2goJ21vdXNlJyk7XG4gICAgICB9XG5cbiAgICAgICR2ZXJ0aWNhbFN3aXBlLmJpbmQoZWxlbWVudCwge1xuICAgICAgICAnc3RhcnQnOiBmdW5jdGlvbiBzdGFydChjb29yZHMsIGV2ZW50KSB7XG4gICAgICAgICAgc3RhcnRDb29yZHMgPSBjb29yZHM7XG4gICAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICAnY2FuY2VsJzogZnVuY3Rpb24gY2FuY2VsKGV2ZW50KSB7XG4gICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgJ2VuZCc6IGZ1bmN0aW9uIGVuZChjb29yZHMsIGV2ZW50KSB7XG4gICAgICAgICAgaWYgKHZhbGlkU3dpcGUoY29vcmRzKSkge1xuICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC50cmlnZ2VySGFuZGxlcihldmVudE5hbWUpO1xuICAgICAgICAgICAgICBzd2lwZUhhbmRsZXIoc2NvcGUsIHtcbiAgICAgICAgICAgICAgICAkZXZlbnQ6IGV2ZW50XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBwb2ludGVyVHlwZXMpO1xuICAgIH07XG4gIH1dKTtcbn1cblxubWFrZVN3aXBlRGlyZWN0aXZlXygnbmdlb1N3aXBlRG93bicsIDEsICdzd2lwZWRvd24nKTtcbm1ha2VTd2lwZURpcmVjdGl2ZV8oJ25nZW9Td2lwZVVwJywgLTEsICdzd2lwZXVwJyk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiZnVuY3Rpb24gc3luY0FycmF5cyhhcnIxLCBhcnIyLCByZXZlcnNlLCBzY29wZSwgZmlsdGVyKSB7XG4gIHZhciBkZXJlZzEgPSBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gYXJyMTtcbiAgfSwgZnVuY3Rpb24gKCkge1xuICAgIHZhciBpLCBpaSwgajtcblxuICAgIGlmIChyZXZlcnNlKSB7XG4gICAgICBmb3IgKGkgPSBhcnIxLmxlbmd0aCAtIDEsIGogPSAwOyBpID49IDA7IC0taSkge1xuICAgICAgICBpZiAoZmlsdGVyKGFycjFbaV0pKSB7XG4gICAgICAgICAgYXJyMltqKytdID0gYXJyMVtpXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IGFycjEubGVuZ3RoLCBqID0gMDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgaWYgKGZpbHRlcihhcnIxW2ldKSkge1xuICAgICAgICAgIGFycjJbaisrXSA9IGFycjFbaV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBhcnIyLmxlbmd0aCA9IGo7XG4gIH0pO1xuICB2YXIgZGVyZWcyID0gc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGFycjI7XG4gIH0sIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSwgaWksIGo7XG5cbiAgICBpZiAocmV2ZXJzZSkge1xuICAgICAgZm9yIChpID0gMCwgaWkgPSBhcnIxLmxlbmd0aCwgaiA9IGFycjIubGVuZ3RoIC0gMTsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgaWYgKGZpbHRlcihhcnIxW2ldKSkge1xuICAgICAgICAgIGFycjFbaV0gPSBhcnIyW2otLV07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc29sZS5hc3NlcnQoaiA9PSAtMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoaSA9IDAsIGlpID0gYXJyMS5sZW5ndGgsIGogPSAwOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBpZiAoZmlsdGVyKGFycjFbaV0pKSB7XG4gICAgICAgICAgYXJyMVtpXSA9IGFycjJbaisrXTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmFzc2VydChqID09IGFycjIubGVuZ3RoKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGRlcmVnMSgpO1xuICAgIGRlcmVnMigpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBzeW5jQXJyYXlzOyIsImV4cG9ydCB2YXIgUGVybWFsaW5rM2RQYXJhbSA9IHtcbiAgRU5BQkxFRDogJzNkX2VuYWJsZWQnLFxuICBMT046ICczZF9sb24nLFxuICBMQVQ6ICczZF9sYXQnLFxuICBFTEVWQVRJT046ICczZF9lbGV2YXRpb24nLFxuICBIRUFESU5HOiAnM2RfaGVhZGluZycsXG4gIFBJVENIOiAnM2RfcGl0Y2gnLFxuICBQUkVGSVg6ICczZF8nXG59OyIsImZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgTGF5ZXIgZnJvbSAnb2wvbGF5ZXIvTGF5ZXIuanMnO1xuaW1wb3J0IHsgY3JlYXRlQ2FudmFzQ29udGV4dDJEIH0gZnJvbSAnb2wvZG9tLmpzJztcbmltcG9ydCB7IElOQ0hFU19QRVJfTUVURVIsIERPVFNfUEVSX0lOQ0ggfSBmcm9tICduZ2VvL3ByaW50L1V0aWxzLmpzJztcblxudmFyIE1hc2sgPSBmdW5jdGlvbiAoX0xheWVyKSB7XG4gIF9pbmhlcml0c0xvb3NlKE1hc2ssIF9MYXllcik7XG5cbiAgZnVuY3Rpb24gTWFzayhvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkge1xuICAgICAgb3B0aW9ucyA9IHt9O1xuICAgIH1cblxuICAgIF90aGlzID0gX0xheWVyLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICBfdGhpcy5jb250ZXh0XyA9IGNyZWF0ZUNhbnZhc0NvbnRleHQyRCgpO1xuICAgIF90aGlzLmNvbnRleHRfLmNhbnZhcy5zdHlsZS5vcGFjaXR5ID0gJzAuNSc7XG4gICAgX3RoaXMuY29udGV4dF8uY2FudmFzLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBfdGhpcy5nZXRTY2FsZTtcbiAgICBfdGhpcy5nZXRTaXplO1xuICAgIF90aGlzLmdldFJvdGF0aW9uO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBNYXNrLnByb3RvdHlwZTtcblxuICBfcHJvdG8ucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyKGZyYW1lU3RhdGUpIHtcbiAgICB0aGlzLmNvbnRleHRfLmNhbnZhcy53aWR0aCA9IGZyYW1lU3RhdGUuc2l6ZVswXSAqIGZyYW1lU3RhdGUucGl4ZWxSYXRpbztcbiAgICB0aGlzLmNvbnRleHRfLmNhbnZhcy5oZWlnaHQgPSBmcmFtZVN0YXRlLnNpemVbMV0gKiBmcmFtZVN0YXRlLnBpeGVsUmF0aW87XG4gICAgdmFyIGNlbnRlciA9IFt0aGlzLmNvbnRleHRfLmNhbnZhcy53aWR0aCAvIDIsIHRoaXMuY29udGV4dF8uY2FudmFzLmhlaWdodCAvIDJdO1xuICAgIHRoaXMuY29udGV4dF8uYmVnaW5QYXRoKCk7XG4gICAgdGhpcy5jb250ZXh0Xy5tb3ZlVG8oMCwgMCk7XG4gICAgdGhpcy5jb250ZXh0Xy5saW5lVG8odGhpcy5jb250ZXh0Xy5jYW52YXMud2lkdGgsIDApO1xuICAgIHRoaXMuY29udGV4dF8ubGluZVRvKHRoaXMuY29udGV4dF8uY2FudmFzLndpZHRoLCB0aGlzLmNvbnRleHRfLmNhbnZhcy5oZWlnaHQpO1xuICAgIHRoaXMuY29udGV4dF8ubGluZVRvKDAsIHRoaXMuY29udGV4dF8uY2FudmFzLmhlaWdodCk7XG4gICAgdGhpcy5jb250ZXh0Xy5saW5lVG8oMCwgMCk7XG4gICAgdGhpcy5jb250ZXh0Xy5jbG9zZVBhdGgoKTtcbiAgICB2YXIgc2l6ZSA9IHRoaXMuZ2V0U2l6ZSgpO1xuICAgIHZhciBoZWlnaHQgPSBzaXplWzFdICogZnJhbWVTdGF0ZS5waXhlbFJhdGlvO1xuICAgIHZhciB3aWR0aCA9IHNpemVbMF0gKiBmcmFtZVN0YXRlLnBpeGVsUmF0aW87XG4gICAgdmFyIHNjYWxlID0gdGhpcy5nZXRTY2FsZShmcmFtZVN0YXRlKTtcbiAgICB2YXIgcmVzb2x1dGlvbiA9IGZyYW1lU3RhdGUudmlld1N0YXRlLnJlc29sdXRpb247XG4gICAgdmFyIGV4dGVudEhhbGZXaWR0aCA9IHdpZHRoIC8gRE9UU19QRVJfSU5DSCAvIElOQ0hFU19QRVJfTUVURVIgKiBzY2FsZSAvIHJlc29sdXRpb24gLyAyO1xuICAgIHZhciBleHRlbnRIYWxmSGVpZ2h0ID0gaGVpZ2h0IC8gRE9UU19QRVJfSU5DSCAvIElOQ0hFU19QRVJfTUVURVIgKiBzY2FsZSAvIHJlc29sdXRpb24gLyAyO1xuICAgIHZhciByb3RhdGlvbiA9IHRoaXMuZ2V0Um90YXRpb24gIT09IHVuZGVmaW5lZCA/IHRoaXMuZ2V0Um90YXRpb24oKSA6IDA7XG4gICAgdmFyIGRpYWdvbmFsID0gTWF0aC5zcXJ0KE1hdGgucG93KGV4dGVudEhhbGZXaWR0aCwgMikgKyBNYXRoLnBvdyhleHRlbnRIYWxmSGVpZ2h0LCAyKSk7XG4gICAgdmFyIGdhbW1hID0gTWF0aC5hdGFuKGV4dGVudEhhbGZIZWlnaHQgLyBleHRlbnRIYWxmV2lkdGgpIC0gcm90YXRpb247XG4gICAgdmFyIG9tZWdhID0gTWF0aC5hdGFuKGV4dGVudEhhbGZXaWR0aCAvIGV4dGVudEhhbGZIZWlnaHQpIC0gcm90YXRpb247XG4gICAgdmFyIHgxID0gY2VudGVyWzBdIC0gTWF0aC5jb3MoZ2FtbWEpICogZGlhZ29uYWw7XG4gICAgdmFyIHkxID0gY2VudGVyWzFdICsgTWF0aC5zaW4oZ2FtbWEpICogZGlhZ29uYWw7XG4gICAgdmFyIHgyID0gY2VudGVyWzBdICsgTWF0aC5zaW4ob21lZ2EpICogZGlhZ29uYWw7XG4gICAgdmFyIHkyID0gY2VudGVyWzFdICsgTWF0aC5jb3Mob21lZ2EpICogZGlhZ29uYWw7XG4gICAgdmFyIHgzID0gY2VudGVyWzBdICsgTWF0aC5jb3MoZ2FtbWEpICogZGlhZ29uYWw7XG4gICAgdmFyIHkzID0gY2VudGVyWzFdIC0gTWF0aC5zaW4oZ2FtbWEpICogZGlhZ29uYWw7XG4gICAgdmFyIHg0ID0gY2VudGVyWzBdIC0gTWF0aC5zaW4ob21lZ2EpICogZGlhZ29uYWw7XG4gICAgdmFyIHk0ID0gY2VudGVyWzFdIC0gTWF0aC5jb3Mob21lZ2EpICogZGlhZ29uYWw7XG4gICAgdGhpcy5jb250ZXh0Xy5tb3ZlVG8oeDEsIHkxKTtcbiAgICB0aGlzLmNvbnRleHRfLmxpbmVUbyh4MiwgeTIpO1xuICAgIHRoaXMuY29udGV4dF8ubGluZVRvKHgzLCB5Myk7XG4gICAgdGhpcy5jb250ZXh0Xy5saW5lVG8oeDQsIHk0KTtcbiAgICB0aGlzLmNvbnRleHRfLmxpbmVUbyh4MSwgeTEpO1xuICAgIHRoaXMuY29udGV4dF8uY2xvc2VQYXRoKCk7XG4gICAgdGhpcy5jb250ZXh0Xy5maWxsU3R5bGUgPSAnIzAwMCc7XG4gICAgdGhpcy5jb250ZXh0Xy5maWxsKCk7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dF8uY2FudmFzO1xuICB9O1xuXG4gIHJldHVybiBNYXNrO1xufShMYXllcik7XG5cbmV4cG9ydCB7IE1hc2sgYXMgZGVmYXVsdCB9OyIsIlByaW50U2VydmljZS4kaW5qZWN0ID0gW1widXJsXCIsIFwiJGh0dHBcIiwgXCJnZXR0ZXh0Q2F0YWxvZ1wiLCBcIm5nZW9MYXllckhlbHBlclwiXTtcbmNyZWF0ZVByaW50U2VydmljZUZhY3RvcnkuJGluamVjdCA9IFtcIiRodHRwXCIsIFwiZ2V0dGV4dENhdGFsb2dcIiwgXCJuZ2VvTGF5ZXJIZWxwZXJcIl07XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvUHJpbnRWZWN0b3JFbmNvZGVyIGZyb20gJ25nZW8vcHJpbnQvVmVjdG9yRW5jb2Rlci5qcyc7XG5pbXBvcnQgbmdlb01hcExheWVySGVscGVyIGZyb20gJ25nZW8vbWFwL0xheWVySGVscGVyLmpzJztcbmltcG9ydCB7IHN0YWJsZVNvcnQgfSBmcm9tICdvbC9hcnJheS5qcyc7XG5pbXBvcnQgb2xMYXllckltYWdlIGZyb20gJ29sL2xheWVyL0ltYWdlLmpzJztcbmltcG9ydCBvbExheWVyVGlsZSBmcm9tICdvbC9sYXllci9UaWxlLmpzJztcbmltcG9ydCBvbExheWVyVmVjdG9yIGZyb20gJ29sL2xheWVyL1ZlY3Rvci5qcyc7XG5pbXBvcnQgeyB0b0RlZ3JlZXMgfSBmcm9tICdvbC9tYXRoLmpzJztcbmltcG9ydCAqIGFzIG9sU2l6ZSBmcm9tICdvbC9zaXplLmpzJztcbmltcG9ydCBvbFNvdXJjZUltYWdlV01TIGZyb20gJ29sL3NvdXJjZS9JbWFnZVdNUy5qcyc7XG5pbXBvcnQgb2xTb3VyY2VUaWxlV01TIGZyb20gJ29sL3NvdXJjZS9UaWxlV01TLmpzJztcbmltcG9ydCBvbFNvdXJjZVdNVFMgZnJvbSAnb2wvc291cmNlL1dNVFMuanMnO1xuaW1wb3J0IG9sVGlsZWdyaWRXTVRTIGZyb20gJ29sL3RpbGVncmlkL1dNVFMuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIFByaW50U2VydmljZSh1cmwsICRodHRwLCBnZXR0ZXh0Q2F0YWxvZywgbmdlb0xheWVySGVscGVyKSB7XG4gIHRoaXMudXJsXyA9IHVybDtcbiAgdGhpcy4kaHR0cF8gPSAkaHR0cDtcbiAgdGhpcy5nZXR0ZXh0Q2F0YWxvZ18gPSBnZXR0ZXh0Q2F0YWxvZztcbiAgdGhpcy5uZ2VvTGF5ZXJIZWxwZXJfID0gbmdlb0xheWVySGVscGVyO1xuICB0aGlzLnZlY3RvckVuY29kZXIgPSBuZXcgbmdlb1ByaW50VmVjdG9yRW5jb2RlcigpO1xuICB0aGlzLnByaW50TmF0aXZlQW5nbGVfID0gdHJ1ZTtcbn1cblxuUHJpbnRTZXJ2aWNlLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAocmVmLCBvcHRfaHR0cENvbmZpZykge1xuICB2YXIgaHR0cENvbmZpZyA9IG9wdF9odHRwQ29uZmlnICE9PSB1bmRlZmluZWQgPyBvcHRfaHR0cENvbmZpZyA6IHt9O1xuICB2YXIgdXJsID0gdGhpcy51cmxfICsgXCIvY2FuY2VsL1wiICsgcmVmO1xuICByZXR1cm4gdGhpcy4kaHR0cF9bJ2RlbGV0ZSddKHVybCwgaHR0cENvbmZpZyk7XG59O1xuXG5QcmludFNlcnZpY2UucHJvdG90eXBlLmNyZWF0ZVNwZWMgPSBmdW5jdGlvbiAobWFwLCBzY2FsZSwgZHBpLCBsYXlvdXQsIGZvcm1hdCwgY3VzdG9tQXR0cmlidXRlcywgZW1haWwpIHtcbiAgdmFyIHNwZWNNYXAgPSB7XG4gICAgZHBpOiBkcGksXG4gICAgcm90YXRpb246IGN1c3RvbUF0dHJpYnV0ZXMucm90YXRpb25cbiAgfTtcbiAgdGhpcy5lbmNvZGVNYXBfKG1hcCwgc2NhbGUsIHNwZWNNYXApO1xuICB2YXIgYXR0cmlidXRlcyA9IHtcbiAgICBtYXA6IHNwZWNNYXBcbiAgfTtcbiAgT2JqZWN0LmFzc2lnbihhdHRyaWJ1dGVzLCBjdXN0b21BdHRyaWJ1dGVzKTtcbiAgdmFyIGxhbmcgPSB0aGlzLmdldHRleHRDYXRhbG9nXy5nZXRDdXJyZW50TGFuZ3VhZ2UoKTtcbiAgdmFyIHNwZWMgPSB7XG4gICAgYXR0cmlidXRlczogYXR0cmlidXRlcyxcbiAgICBmb3JtYXQ6IGZvcm1hdCxcbiAgICBsYW5nOiBsYW5nLFxuICAgIGxheW91dDogbGF5b3V0XG4gIH07XG5cbiAgaWYgKGVtYWlsKSB7XG4gICAgc3BlYy5zbXRwID0ge1xuICAgICAgdG86IGVtYWlsXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBzcGVjO1xufTtcblxuUHJpbnRTZXJ2aWNlLnByb3RvdHlwZS5lbmNvZGVNYXBfID0gZnVuY3Rpb24gKG1hcCwgc2NhbGUsIG9iamVjdCkge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHZhciB2aWV3ID0gbWFwLmdldFZpZXcoKTtcbiAgdmFyIHZpZXdDZW50ZXIgPSB2aWV3LmdldENlbnRlcigpO1xuICB2YXIgdmlld1Byb2plY3Rpb24gPSB2aWV3LmdldFByb2plY3Rpb24oKTtcbiAgdmFyIHZpZXdSZXNvbHV0aW9uID0gdmlldy5nZXRSZXNvbHV0aW9uKCk7XG4gIHZhciB2aWV3Um90YXRpb24gPSBvYmplY3Qucm90YXRpb24gfHwgdG9EZWdyZWVzKHZpZXcuZ2V0Um90YXRpb24oKSk7XG5cbiAgaWYgKCF2aWV3Q2VudGVyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHZpZXdDZW50ZXInKTtcbiAgfVxuXG4gIGlmICghdmlld1Byb2plY3Rpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgdmlld1Byb2plY3Rpb24nKTtcbiAgfVxuXG4gIGlmICghdmlld1Jlc29sdXRpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgdmlld1Jlc29sdXRpb24nKTtcbiAgfVxuXG4gIG9iamVjdC5jZW50ZXIgPSB2aWV3Q2VudGVyO1xuICBvYmplY3QucHJvamVjdGlvbiA9IHZpZXdQcm9qZWN0aW9uLmdldENvZGUoKTtcbiAgb2JqZWN0LnJvdGF0aW9uID0gdmlld1JvdGF0aW9uO1xuICBvYmplY3Quc2NhbGUgPSBzY2FsZTtcbiAgb2JqZWN0LmxheWVycyA9IFtdO1xuICB2YXIgbWFwTGF5ZXJHcm91cCA9IG1hcC5nZXRMYXllckdyb3VwKCk7XG5cbiAgaWYgKCFtYXBMYXllckdyb3VwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hcExheWVyR3JvdXAnKTtcbiAgfVxuXG4gIHRoaXMucHJpbnROYXRpdmVBbmdsZV8gPSBtYXBMYXllckdyb3VwLmdldCgncHJpbnROYXRpdmVBbmdsZScpICE9PSBmYWxzZTtcbiAgdmFyIGxheWVycyA9IHRoaXMubmdlb0xheWVySGVscGVyXy5nZXRGbGF0TGF5ZXJzKG1hcExheWVyR3JvdXApO1xuICBzdGFibGVTb3J0KGxheWVycywgZnVuY3Rpb24gKGxheWVyX2EsIGxheWVyX2IpIHtcbiAgICByZXR1cm4gKGxheWVyX2EuZ2V0WkluZGV4KCkgfHwgMCkgLSAobGF5ZXJfYi5nZXRaSW5kZXgoKSB8fCAwKTtcbiAgfSk7XG4gIGxheWVycyA9IGxheWVycy5zbGljZSgpLnJldmVyc2UoKTtcbiAgbGF5ZXJzLmZvckVhY2goZnVuY3Rpb24gKGxheWVyKSB7XG4gICAgaWYgKGxheWVyLmdldFZpc2libGUoKSkge1xuICAgICAgX3RoaXMuZW5jb2RlTGF5ZXIob2JqZWN0LmxheWVycywgbGF5ZXIsIHZpZXdSZXNvbHV0aW9uKTtcbiAgICB9XG4gIH0pO1xufTtcblxuUHJpbnRTZXJ2aWNlLnByb3RvdHlwZS5lbmNvZGVMYXllciA9IGZ1bmN0aW9uIChhcnIsIGxheWVyLCByZXNvbHV0aW9uKSB7XG4gIGlmIChsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJJbWFnZSkge1xuICAgIHRoaXMuZW5jb2RlSW1hZ2VMYXllcl8oYXJyLCBsYXllcik7XG4gIH0gZWxzZSBpZiAobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyVGlsZSkge1xuICAgIHRoaXMuZW5jb2RlVGlsZUxheWVyXyhhcnIsIGxheWVyKTtcbiAgfSBlbHNlIGlmIChsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJWZWN0b3IpIHtcbiAgICB0aGlzLmVuY29kZVZlY3RvckxheWVyKGFyciwgbGF5ZXIsIHJlc29sdXRpb24pO1xuICB9XG59O1xuXG5QcmludFNlcnZpY2UucHJvdG90eXBlLmVuY29kZVZlY3RvckxheWVyID0gZnVuY3Rpb24gKGFyciwgbGF5ZXIsIHJlc29sdXRpb24pIHtcbiAgdGhpcy52ZWN0b3JFbmNvZGVyLmVuY29kZVZlY3RvckxheWVyKGFyciwgbGF5ZXIsIHJlc29sdXRpb24pO1xufTtcblxuUHJpbnRTZXJ2aWNlLnByb3RvdHlwZS5lbmNvZGVJbWFnZUxheWVyXyA9IGZ1bmN0aW9uIChhcnIsIGxheWVyKSB7XG4gIGlmICghKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckltYWdlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignbGF5ZXIgbm90IGluc3RhbmNlIG9mIG9sTGF5ZXJJbWFnZScpO1xuICB9XG5cbiAgdmFyIHNvdXJjZSA9IGxheWVyLmdldFNvdXJjZSgpO1xuXG4gIGlmIChzb3VyY2UgaW5zdGFuY2VvZiBvbFNvdXJjZUltYWdlV01TKSB7XG4gICAgdGhpcy5lbmNvZGVJbWFnZVdtc0xheWVyXyhhcnIsIGxheWVyKTtcbiAgfVxufTtcblxuUHJpbnRTZXJ2aWNlLnByb3RvdHlwZS5lbmNvZGVJbWFnZVdtc0xheWVyXyA9IGZ1bmN0aW9uIChhcnIsIGxheWVyKSB7XG4gIGlmICghKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllckltYWdlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignbGF5ZXIgbm90IGluc3RhbmNlIG9mIG9sTGF5ZXJJbWFnZScpO1xuICB9XG5cbiAgdmFyIHNvdXJjZSA9IGxheWVyLmdldFNvdXJjZSgpO1xuXG4gIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIG9sU291cmNlSW1hZ2VXTVMpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzb3VyY2Ugbm90IGluc3RhbmNlIG9mIG9sU291cmNlSW1hZ2VXTVMnKTtcbiAgfVxuXG4gIHZhciB1cmwgPSBzb3VyY2UuZ2V0VXJsKCk7XG5cbiAgaWYgKHVybCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5lbmNvZGVXbXNMYXllcl8oYXJyLCBsYXllciwgdXJsLCBzb3VyY2UuZ2V0UGFyYW1zKCkpO1xuICB9XG59O1xuXG5QcmludFNlcnZpY2UucHJvdG90eXBlLmVuY29kZVdtc0xheWVyXyA9IGZ1bmN0aW9uIChhcnIsIGxheWVyLCB1cmwsIHBhcmFtcykge1xuICBpZiAodXJsLnN0YXJ0c1dpdGgoJy8vJykpIHtcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyB1cmw7XG4gIH1cblxuICB2YXIgdXJsX3VybCA9IG5ldyBVUkwodXJsKTtcbiAgdmFyIGN1c3RvbVBhcmFtcyA9IHtcbiAgICAnVFJBTlNQQVJFTlQnOiAndHJ1ZSdcbiAgfTtcblxuICBpZiAodXJsX3VybC5zZWFyY2hQYXJhbXMpIHtcbiAgICB1cmxfdXJsLnNlYXJjaFBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICBjdXN0b21QYXJhbXNba2V5XSA9IHZhbHVlO1xuICAgIH0pO1xuICB9XG5cbiAgZm9yICh2YXIga2V5IGluIHBhcmFtcykge1xuICAgIHZhciB2YWx1ZSA9IHBhcmFtc1trZXldO1xuXG4gICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGN1c3RvbVBhcmFtc1trZXldID0gdmFsdWU7XG4gICAgfVxuICB9XG5cbiAgZGVsZXRlIGN1c3RvbVBhcmFtcy5MQVlFUlM7XG4gIGRlbGV0ZSBjdXN0b21QYXJhbXMuRk9STUFUO1xuICBkZWxldGUgY3VzdG9tUGFyYW1zLlNFUlZFUlRZUEU7XG4gIGRlbGV0ZSBjdXN0b21QYXJhbXMuVkVSU0lPTjtcbiAgdmFyIHNlcnZlclR5cGUgPSB1bmRlZmluZWQ7XG5cbiAgaWYgKHBhcmFtcy5TRVJWRVJUWVBFICE9PSAnYXJjZ2lzJykge1xuICAgIHNlcnZlclR5cGUgPSBwYXJhbXMuU0VSVkVSVFlQRTtcbiAgfVxuXG4gIHZhciBvYmplY3QgPSB7XG4gICAgYmFzZVVSTDogZ2V0QWJzb2x1dGVVcmxfKHVybF91cmwub3JpZ2luICsgdXJsX3VybC5wYXRobmFtZSksXG4gICAgaW1hZ2VGb3JtYXQ6ICdGT1JNQVQnIGluIHBhcmFtcyA/IHBhcmFtcy5GT1JNQVQgOiAnaW1hZ2UvcG5nJyxcbiAgICBsYXllcnM6IHBhcmFtcy5MQVlFUlMuc3BsaXQoJywnKSxcbiAgICBjdXN0b21QYXJhbXM6IGN1c3RvbVBhcmFtcyxcbiAgICBzZXJ2ZXJUeXBlOiBzZXJ2ZXJUeXBlLFxuICAgIHR5cGU6ICd3bXMnLFxuICAgIG9wYWNpdHk6IHRoaXMuZ2V0T3BhY2l0eU9ySW5oZXJpdGVkXyhsYXllciksXG4gICAgdmVyc2lvbjogcGFyYW1zLlZFUlNJT04sXG4gICAgdXNlTmF0aXZlQW5nbGU6IHRoaXMucHJpbnROYXRpdmVBbmdsZV9cbiAgfTtcbiAgYXJyLnB1c2gob2JqZWN0KTtcbn07XG5cbmZ1bmN0aW9uIGdldEFic29sdXRlVXJsXyh1cmwpIHtcbiAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gIGEuaHJlZiA9IGVuY29kZVVSSSh1cmwpO1xuICByZXR1cm4gZGVjb2RlVVJJKGEuaHJlZik7XG59XG5cblByaW50U2VydmljZS5wcm90b3R5cGUuZW5jb2RlVGlsZUxheWVyXyA9IGZ1bmN0aW9uIChhcnIsIGxheWVyKSB7XG4gIGlmICghKGxheWVyIGluc3RhbmNlb2Ygb2xMYXllclRpbGUpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdsYXllciBub3QgaW5zdGFuY2Ugb2Ygb2xMYXllclRpbGUnKTtcbiAgfVxuXG4gIHZhciBzb3VyY2UgPSBsYXllci5nZXRTb3VyY2UoKTtcblxuICBpZiAoc291cmNlIGluc3RhbmNlb2Ygb2xTb3VyY2VXTVRTKSB7XG4gICAgdGhpcy5lbmNvZGVUaWxlV210c0xheWVyXyhhcnIsIGxheWVyKTtcbiAgfSBlbHNlIGlmIChzb3VyY2UgaW5zdGFuY2VvZiBvbFNvdXJjZVRpbGVXTVMpIHtcbiAgICB0aGlzLmVuY29kZVRpbGVXbXNMYXllcl8oYXJyLCBsYXllcik7XG4gIH1cbn07XG5cblByaW50U2VydmljZS5wcm90b3R5cGUuZW5jb2RlVGlsZVdtdHNMYXllcl8gPSBmdW5jdGlvbiAoYXJyLCBsYXllcikge1xuICBpZiAoIShsYXllciBpbnN0YW5jZW9mIG9sTGF5ZXJUaWxlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignbGF5ZXIgbm90IGluc3RhbmNlIG9mIG9sTGF5ZXJUaWxlJyk7XG4gIH1cblxuICB2YXIgc291cmNlID0gbGF5ZXIuZ2V0U291cmNlKCk7XG5cbiAgaWYgKCEoc291cmNlIGluc3RhbmNlb2Ygb2xTb3VyY2VXTVRTKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignc291cmNlIG5vdCBpbnN0YW5jZSBvZiBvbFNvdXJjZVdNVFMnKTtcbiAgfVxuXG4gIHZhciBwcm9qZWN0aW9uID0gc291cmNlLmdldFByb2plY3Rpb24oKTtcblxuICBpZiAoIXByb2plY3Rpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcHJvamVjdGlvbicpO1xuICB9XG5cbiAgdmFyIG1ldGVyc1BlclVuaXQgPSBwcm9qZWN0aW9uLmdldE1ldGVyc1BlclVuaXQoKTtcblxuICBpZiAoIW1ldGVyc1BlclVuaXQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgbWV0ZXJzUGVyVW5pdCcpO1xuICB9XG5cbiAgdmFyIHRpbGVHcmlkID0gc291cmNlLmdldFRpbGVHcmlkKCk7XG5cbiAgaWYgKCEodGlsZUdyaWQgaW5zdGFuY2VvZiBvbFRpbGVncmlkV01UUykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3RpbGVHcmlkIG5vdCBpbnN0YW5jZSBvZiBvbFRpbGVncmlkV01UUycpO1xuICB9XG5cbiAgdmFyIG1hdHJpeElkcyA9IHRpbGVHcmlkLmdldE1hdHJpeElkcygpO1xuICB2YXIgbWF0cmljZXMgPSBbXTtcblxuICBmb3IgKHZhciBpID0gMCwgaWkgPSBtYXRyaXhJZHMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgIHZhciB0aWxlUmFuZ2UgPSB0aWxlR3JpZC5nZXRGdWxsVGlsZVJhbmdlKGkpO1xuICAgIG1hdHJpY2VzLnB1c2goe1xuICAgICAgaWRlbnRpZmllcjogbWF0cml4SWRzW2ldLFxuICAgICAgc2NhbGVEZW5vbWluYXRvcjogdGlsZUdyaWQuZ2V0UmVzb2x1dGlvbihpKSAqIG1ldGVyc1BlclVuaXQgLyAwLjI4RS0zLFxuICAgICAgdGlsZVNpemU6IG9sU2l6ZS50b1NpemUodGlsZUdyaWQuZ2V0VGlsZVNpemUoaSkpLFxuICAgICAgdG9wTGVmdENvcm5lcjogdGlsZUdyaWQuZ2V0T3JpZ2luKGkpLFxuICAgICAgbWF0cml4U2l6ZTogW3RpbGVSYW5nZS5tYXhYIC0gdGlsZVJhbmdlLm1pblgsIHRpbGVSYW5nZS5tYXhZIC0gdGlsZVJhbmdlLm1pblldXG4gICAgfSk7XG4gIH1cblxuICB2YXIgZGltZW5zaW9ucyA9IHNvdXJjZS5nZXREaW1lbnNpb25zKCk7XG4gIHZhciBkaW1lbnNpb25LZXlzID0gT2JqZWN0LmtleXMoZGltZW5zaW9ucyk7XG4gIHZhciBvYmplY3QgPSB7XG4gICAgYmFzZVVSTDogdGhpcy5nZXRXbXRzVXJsXyhzb3VyY2UpLFxuICAgIGRpbWVuc2lvbnM6IGRpbWVuc2lvbktleXMsXG4gICAgZGltZW5zaW9uUGFyYW1zOiBkaW1lbnNpb25zLFxuICAgIGltYWdlRm9ybWF0OiBzb3VyY2UuZ2V0Rm9ybWF0KCksXG4gICAgbGF5ZXI6IHNvdXJjZS5nZXRMYXllcigpLFxuICAgIG1hdHJpY2VzOiBtYXRyaWNlcyxcbiAgICBtYXRyaXhTZXQ6IHNvdXJjZS5nZXRNYXRyaXhTZXQoKSxcbiAgICBvcGFjaXR5OiB0aGlzLmdldE9wYWNpdHlPckluaGVyaXRlZF8obGF5ZXIpLFxuICAgIHJlcXVlc3RFbmNvZGluZzogc291cmNlLmdldFJlcXVlc3RFbmNvZGluZygpLFxuICAgIHN0eWxlOiBzb3VyY2UuZ2V0U3R5bGUoKSxcbiAgICB0eXBlOiAnV01UUycsXG4gICAgdmVyc2lvbjogc291cmNlLmdldFZlcnNpb24oKVxuICB9O1xuICBhcnIucHVzaChvYmplY3QpO1xufTtcblxuUHJpbnRTZXJ2aWNlLnByb3RvdHlwZS5lbmNvZGVUaWxlV21zTGF5ZXJfID0gZnVuY3Rpb24gKGFyciwgbGF5ZXIpIHtcbiAgaWYgKCEobGF5ZXIgaW5zdGFuY2VvZiBvbExheWVyVGlsZSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2xheWVyIG5vdCBpbnN0YW5jZSBvZiBvbExheWVyVGlsZScpO1xuICB9XG5cbiAgdmFyIHNvdXJjZSA9IGxheWVyLmdldFNvdXJjZSgpO1xuXG4gIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIG9sU291cmNlVGlsZVdNUykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NvdXJjZSBub3QgaW5zdGFuY2Ugb2Ygb2xTb3VyY2VUaWxlV01TJyk7XG4gIH1cblxuICB2YXIgdXJscyA9IHNvdXJjZS5nZXRVcmxzKCk7XG5cbiAgaWYgKCF1cmxzKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHVybHMnKTtcbiAgfVxuXG4gIHRoaXMuZW5jb2RlV21zTGF5ZXJfKGFyciwgbGF5ZXIsIHVybHNbMF0sIHNvdXJjZS5nZXRQYXJhbXMoKSk7XG59O1xuXG5QcmludFNlcnZpY2UucHJvdG90eXBlLmdldFdtdHNVcmxfID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICB2YXIgdXJscyA9IHNvdXJjZS5nZXRVcmxzKCk7XG5cbiAgaWYgKCF1cmxzKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHVybHMnKTtcbiAgfVxuXG4gIHJldHVybiBnZXRBYnNvbHV0ZVVybF8odXJsc1swXSk7XG59O1xuXG5QcmludFNlcnZpY2UucHJvdG90eXBlLmdldE9wYWNpdHlPckluaGVyaXRlZF8gPSBmdW5jdGlvbiAobGF5ZXIpIHtcbiAgaWYgKGxheWVyLmdldCgnaW5oZXJpdGVkT3BhY2l0eScpICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gbGF5ZXIuZ2V0KCdpbmhlcml0ZWRPcGFjaXR5Jyk7XG4gIH1cblxuICByZXR1cm4gbGF5ZXIuZ2V0T3BhY2l0eSgpO1xufTtcblxuUHJpbnRTZXJ2aWNlLnByb3RvdHlwZS5jcmVhdGVSZXBvcnQgPSBmdW5jdGlvbiAocHJpbnRTcGVjLCBvcHRfaHR0cENvbmZpZykge1xuICB2YXIgZm9ybWF0ID0gcHJpbnRTcGVjLmZvcm1hdCB8fCAncGRmJztcbiAgdmFyIHVybCA9IHRoaXMudXJsXyArIFwiL3JlcG9ydC5cIiArIGZvcm1hdDtcbiAgdmFyIGh0dHBDb25maWcgPSB7XG4gICAgaGVhZGVyczoge1xuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04J1xuICAgIH1cbiAgfTtcbiAgT2JqZWN0LmFzc2lnbihodHRwQ29uZmlnLCBvcHRfaHR0cENvbmZpZyAhPT0gdW5kZWZpbmVkID8gb3B0X2h0dHBDb25maWcgOiB7fSk7XG4gIHJldHVybiB0aGlzLiRodHRwXy5wb3N0KHVybCwgcHJpbnRTcGVjLCBodHRwQ29uZmlnKTtcbn07XG5cblByaW50U2VydmljZS5wcm90b3R5cGUuZ2V0U3RhdHVzID0gZnVuY3Rpb24gKHJlZiwgb3B0X2h0dHBDb25maWcpIHtcbiAgdmFyIGh0dHBDb25maWcgPSBvcHRfaHR0cENvbmZpZyAhPT0gdW5kZWZpbmVkID8gb3B0X2h0dHBDb25maWcgOiB7fTtcbiAgdmFyIHVybCA9IHRoaXMudXJsXyArIFwiL3N0YXR1cy9cIiArIHJlZiArIFwiLmpzb25cIjtcbiAgcmV0dXJuIHRoaXMuJGh0dHBfLmdldCh1cmwsIGh0dHBDb25maWcpO1xufTtcblxuUHJpbnRTZXJ2aWNlLnByb3RvdHlwZS5nZXRSZXBvcnRVcmwgPSBmdW5jdGlvbiAocmVmKSB7XG4gIHJldHVybiB0aGlzLnVybF8gKyBcIi9yZXBvcnQvXCIgKyByZWY7XG59O1xuXG5QcmludFNlcnZpY2UucHJvdG90eXBlLmdldENhcGFiaWxpdGllcyA9IGZ1bmN0aW9uIChvcHRfaHR0cENvbmZpZykge1xuICB2YXIgaHR0cENvbmZpZyA9IG9wdF9odHRwQ29uZmlnICE9PSB1bmRlZmluZWQgPyBvcHRfaHR0cENvbmZpZyA6IHtcbiAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWVcbiAgfTtcbiAgdmFyIHVybCA9IHRoaXMudXJsXyArIFwiL2NhcGFiaWxpdGllcy5qc29uXCI7XG4gIHJldHVybiB0aGlzLiRodHRwXy5nZXQodXJsLCBodHRwQ29uZmlnKTtcbn07XG5cbmZ1bmN0aW9uIGNyZWF0ZVByaW50U2VydmljZUZhY3RvcnkoJGh0dHAsIGdldHRleHRDYXRhbG9nLCBuZ2VvTGF5ZXJIZWxwZXIpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh1cmwpIHtcbiAgICByZXR1cm4gbmV3IFByaW50U2VydmljZSh1cmwsICRodHRwLCBnZXR0ZXh0Q2F0YWxvZywgbmdlb0xheWVySGVscGVyKTtcbiAgfTtcbn1cblxudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvUHJpbnQnLCBbbmdlb01hcExheWVySGVscGVyLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvUHJpbnRTZXJ2aWNlJywgUHJpbnRTZXJ2aWNlKTtcbm1vZHVsZS5mYWN0b3J5KCduZ2VvQ3JlYXRlUHJpbnQnLCBjcmVhdGVQcmludFNlcnZpY2VGYWN0b3J5KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmV4cG9ydCBmdW5jdGlvbiBQcmludFV0aWxzKCkge1xuICB0aGlzLmV4dGVudEhhbGZIb3Jpem9udGFsRGlzdGFuY2VfID0gLTE7XG4gIHRoaXMuZXh0ZW50SGFsZlZlcnRpY2FsRGlzdGFuY2VfID0gLTE7XG59XG5leHBvcnQgdmFyIElOQ0hFU19QRVJfTUVURVIgPSAzOS4zNztcbmV4cG9ydCB2YXIgRE9UU19QRVJfSU5DSCA9IDcyO1xuXG5QcmludFV0aWxzLnByb3RvdHlwZS5nZXRPcHRpbWFsU2NhbGUgPSBmdW5jdGlvbiAobWFwU2l6ZSwgbWFwUmVzb2x1dGlvbiwgcHJpbnRNYXBTaXplLCBwcmludE1hcFNjYWxlcykge1xuICB2YXIgbWFwV2lkdGggPSBtYXBTaXplWzBdICogbWFwUmVzb2x1dGlvbjtcbiAgdmFyIG1hcEhlaWdodCA9IG1hcFNpemVbMV0gKiBtYXBSZXNvbHV0aW9uO1xuICB2YXIgc2NhbGVXaWR0aCA9IG1hcFdpZHRoICogSU5DSEVTX1BFUl9NRVRFUiAqIERPVFNfUEVSX0lOQ0ggLyBwcmludE1hcFNpemVbMF07XG4gIHZhciBzY2FsZUhlaWdodCA9IG1hcEhlaWdodCAqIElOQ0hFU19QRVJfTUVURVIgKiBET1RTX1BFUl9JTkNIIC8gcHJpbnRNYXBTaXplWzFdO1xuICB2YXIgc2NhbGUgPSBNYXRoLm1pbihzY2FsZVdpZHRoLCBzY2FsZUhlaWdodCk7XG4gIHZhciBvcHRpbWFsID0gLTE7XG5cbiAgZm9yICh2YXIgaSA9IDAsIGlpID0gcHJpbnRNYXBTY2FsZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgIGlmIChzY2FsZSA+IHByaW50TWFwU2NhbGVzW2ldKSB7XG4gICAgICBvcHRpbWFsID0gcHJpbnRNYXBTY2FsZXNbaV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9wdGltYWw7XG59O1xuXG5QcmludFV0aWxzLnByb3RvdHlwZS5nZXRPcHRpbWFsUmVzb2x1dGlvbiA9IGZ1bmN0aW9uIChtYXBTaXplLCBwcmludE1hcFNpemUsIHByaW50TWFwU2NhbGUpIHtcbiAgdmFyIGRvdHNQZXJNZXRlciA9IERPVFNfUEVSX0lOQ0ggKiBJTkNIRVNfUEVSX01FVEVSO1xuICB2YXIgcmVzb2x1dGlvblggPSBwcmludE1hcFNpemVbMF0gKiBwcmludE1hcFNjYWxlIC8gKGRvdHNQZXJNZXRlciAqIG1hcFNpemVbMF0pO1xuICB2YXIgcmVzb2x1dGlvblkgPSBwcmludE1hcFNpemVbMV0gKiBwcmludE1hcFNjYWxlIC8gKGRvdHNQZXJNZXRlciAqIG1hcFNpemVbMV0pO1xuICB2YXIgb3B0aW1hbFJlc29sdXRpb24gPSBNYXRoLm1heChyZXNvbHV0aW9uWCwgcmVzb2x1dGlvblkpO1xuICByZXR1cm4gb3B0aW1hbFJlc29sdXRpb247XG59O1xuXG5QcmludFV0aWxzLnByb3RvdHlwZS5nZXRCb3R0b21MZWZ0Q29ybmVyID0gZnVuY3Rpb24gKG1hcENlbnRlcikge1xuICByZXR1cm4gW21hcENlbnRlclswXSAtIHRoaXMuZXh0ZW50SGFsZkhvcml6b250YWxEaXN0YW5jZV8sIG1hcENlbnRlclsxXSAtIHRoaXMuZXh0ZW50SGFsZlZlcnRpY2FsRGlzdGFuY2VfXTtcbn07XG5cblByaW50VXRpbHMucHJvdG90eXBlLmdldEJvdHRvbVJpZ2h0Q29ybmVyID0gZnVuY3Rpb24gKG1hcENlbnRlcikge1xuICByZXR1cm4gW21hcENlbnRlclswXSArIHRoaXMuZXh0ZW50SGFsZkhvcml6b250YWxEaXN0YW5jZV8sIG1hcENlbnRlclsxXSAtIHRoaXMuZXh0ZW50SGFsZlZlcnRpY2FsRGlzdGFuY2VfXTtcbn07XG5cblByaW50VXRpbHMucHJvdG90eXBlLmdldFVwTGVmdENvcm5lciA9IGZ1bmN0aW9uIChtYXBDZW50ZXIpIHtcbiAgcmV0dXJuIFttYXBDZW50ZXJbMF0gLSB0aGlzLmV4dGVudEhhbGZIb3Jpem9udGFsRGlzdGFuY2VfLCBtYXBDZW50ZXJbMV0gKyB0aGlzLmV4dGVudEhhbGZWZXJ0aWNhbERpc3RhbmNlX107XG59O1xuXG5QcmludFV0aWxzLnByb3RvdHlwZS5nZXRVcFJpZ2h0Q29ybmVyID0gZnVuY3Rpb24gKG1hcENlbnRlcikge1xuICByZXR1cm4gW21hcENlbnRlclswXSArIHRoaXMuZXh0ZW50SGFsZkhvcml6b250YWxEaXN0YW5jZV8sIG1hcENlbnRlclsxXSArIHRoaXMuZXh0ZW50SGFsZlZlcnRpY2FsRGlzdGFuY2VfXTtcbn07XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb1ByaW50VXRpbHMnLCBbXSk7XG5tb2R1bGUuc2VydmljZSgnbmdlb1ByaW50VXRpbHMnLCBQcmludFV0aWxzKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgeyByZ2JBcnJheVRvSGV4IH0gZnJvbSAnbmdlby91dGlscy5qcyc7XG5pbXBvcnQgeyBnZXRVaWQgYXMgb2xVdGlsR2V0VWlkIH0gZnJvbSAnb2wvdXRpbC5qcyc7XG5pbXBvcnQgb2xGb3JtYXRHZW9KU09OIGZyb20gJ29sL2Zvcm1hdC9HZW9KU09OLmpzJztcbmltcG9ydCBvbFN0eWxlUmVndWxhclNoYXBlIGZyb20gJ29sL3N0eWxlL1JlZ3VsYXJTaGFwZS5qcyc7XG5pbXBvcnQgeyB0b0RlZ3JlZXMgfSBmcm9tICdvbC9tYXRoLmpzJztcbmltcG9ydCBvbFN0eWxlSWNvbiBmcm9tICdvbC9zdHlsZS9JY29uLmpzJztcbmltcG9ydCBvbFN0eWxlQ2lyY2xlIGZyb20gJ29sL3N0eWxlL0NpcmNsZS5qcyc7XG5pbXBvcnQgeyBhc0FycmF5IGFzIGFzQ29sb3JBcnJheSB9IGZyb20gJ29sL2NvbG9yLmpzJztcblxuZnVuY3Rpb24gVmVjdG9yRW5jb2RlcigpIHtcbiAgdGhpcy5nZW9qc29uRm9ybWF0ID0gbmV3IG9sRm9ybWF0R2VvSlNPTigpO1xufVxuXG52YXIgUHJpbnRTdHlsZVR5cGUgPSB7XG4gIExJTkVfU1RSSU5HOiAnTGluZVN0cmluZycsXG4gIFBPSU5UOiAnUG9pbnQnLFxuICBQT0xZR09OOiAnUG9seWdvbidcbn07XG52YXIgUFJJTlRfU1RZTEVfVFlQRVMgPSB7XG4gICdMaW5lU3RyaW5nJzogUHJpbnRTdHlsZVR5cGUuTElORV9TVFJJTkcsXG4gICdQb2ludCc6IFByaW50U3R5bGVUeXBlLlBPSU5ULFxuICAnUG9seWdvbic6IFByaW50U3R5bGVUeXBlLlBPTFlHT04sXG4gICdNdWx0aUxpbmVTdHJpbmcnOiBQcmludFN0eWxlVHlwZS5MSU5FX1NUUklORyxcbiAgJ011bHRpUG9pbnQnOiBQcmludFN0eWxlVHlwZS5QT0lOVCxcbiAgJ011bHRpUG9seWdvbic6IFByaW50U3R5bGVUeXBlLlBPTFlHT05cbn07XG5cblZlY3RvckVuY29kZXIucHJvdG90eXBlLmVuY29kZVZlY3RvckxheWVyID0gZnVuY3Rpb24gKGFyciwgbGF5ZXIsIHJlc29sdXRpb24pIHtcbiAgdmFyIHNvdXJjZSA9IGxheWVyLmdldFNvdXJjZSgpO1xuICB2YXIgZmVhdHVyZXMgPSBzb3VyY2UuZ2V0RmVhdHVyZXMoKTtcbiAgdmFyIGdlb2pzb25GZWF0dXJlcyA9IFtdO1xuICB2YXIgbWFwZmlzaFN0eWxlT2JqZWN0ID0ge1xuICAgIHZlcnNpb246IDJcbiAgfTtcblxuICBmb3IgKHZhciBpID0gMCwgaWkgPSBmZWF0dXJlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgdmFyIG9yaWdpbmFsRmVhdHVyZSA9IGZlYXR1cmVzW2ldO1xuICAgIHZhciBzdHlsZURhdGEgPSBudWxsO1xuICAgIHZhciBzdHlsZUZ1bmN0aW9uID0gb3JpZ2luYWxGZWF0dXJlLmdldFN0eWxlRnVuY3Rpb24oKSB8fCBsYXllci5nZXRTdHlsZUZ1bmN0aW9uKCk7XG5cbiAgICBpZiAoc3R5bGVGdW5jdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzdHlsZURhdGEgPSBzdHlsZUZ1bmN0aW9uLmNhbGwobGF5ZXIsIG9yaWdpbmFsRmVhdHVyZSwgcmVzb2x1dGlvbik7XG4gICAgfVxuXG4gICAgdmFyIG9yaWdHZW9qc29uRmVhdHVyZSA9IHRoaXMuZ2VvanNvbkZvcm1hdC53cml0ZUZlYXR1cmVPYmplY3Qob3JpZ2luYWxGZWF0dXJlKTtcbiAgICB2YXIgc3R5bGVzID0gQXJyYXkuaXNBcnJheShzdHlsZURhdGEpID8gc3R5bGVEYXRhIDogc3R5bGVEYXRhID09PSBudWxsID8gbnVsbCA6IFtzdHlsZURhdGFdO1xuXG4gICAgaWYgKHN0eWxlcyAhPT0gbnVsbCAmJiBzdHlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgdmFyIGlzT3JpZ2luYWxGZWF0dXJlQWRkZWQgPSBmYWxzZTtcblxuICAgICAgZm9yICh2YXIgaiA9IDAsIGpqID0gc3R5bGVzLmxlbmd0aDsgaiA8IGpqOyArK2opIHtcbiAgICAgICAgdmFyIHN0eWxlID0gc3R5bGVzW2pdO1xuICAgICAgICB2YXIgZ2VvbWV0cnkgPSBzdHlsZS5nZXRHZW9tZXRyeSgpO1xuICAgICAgICB2YXIgZ2VvanNvbkZlYXR1cmUgPSB2b2lkIDA7XG5cbiAgICAgICAgaWYgKCFnZW9tZXRyeSkge1xuICAgICAgICAgIGdlb2pzb25GZWF0dXJlID0gb3JpZ0dlb2pzb25GZWF0dXJlO1xuICAgICAgICAgIGdlb21ldHJ5ID0gb3JpZ2luYWxGZWF0dXJlLmdldEdlb21ldHJ5KCk7XG5cbiAgICAgICAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIWlzT3JpZ2luYWxGZWF0dXJlQWRkZWQpIHtcbiAgICAgICAgICAgIGdlb2pzb25GZWF0dXJlcy5wdXNoKGdlb2pzb25GZWF0dXJlKTtcbiAgICAgICAgICAgIGlzT3JpZ2luYWxGZWF0dXJlQWRkZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgc3R5bGVkRmVhdHVyZSA9IG9yaWdpbmFsRmVhdHVyZS5jbG9uZSgpO1xuICAgICAgICAgIHN0eWxlZEZlYXR1cmUuc2V0R2VvbWV0cnkoZ2VvbWV0cnkpO1xuICAgICAgICAgIGdlb2pzb25GZWF0dXJlID0gdGhpcy5nZW9qc29uRm9ybWF0LndyaXRlRmVhdHVyZU9iamVjdChzdHlsZWRGZWF0dXJlKTtcbiAgICAgICAgICBnZW9tZXRyeSA9IHN0eWxlZEZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcbiAgICAgICAgICBnZW9qc29uRmVhdHVyZXMucHVzaChnZW9qc29uRmVhdHVyZSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZ2VvbWV0cnlUeXBlID0gZ2VvbWV0cnkuZ2V0VHlwZSgpO1xuXG4gICAgICAgIGlmIChnZW9qc29uRmVhdHVyZS5wcm9wZXJ0aWVzID09PSBudWxsKSB7XG4gICAgICAgICAgZ2VvanNvbkZlYXR1cmUucHJvcGVydGllcyA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGZlYXR1cmVTdHlsZVByb3AgPSBcIl9uZ2VvX3N0eWxlX1wiICsgajtcbiAgICAgICAgdmFyIHN0eWxlSWQgPSBvbFV0aWxHZXRVaWQoc3R5bGUpLnRvU3RyaW5nKCkgKyBcIi1cIiArIGdlb21ldHJ5VHlwZTtcbiAgICAgICAgdGhpcy5lbmNvZGVWZWN0b3JTdHlsZShtYXBmaXNoU3R5bGVPYmplY3QsIGdlb21ldHJ5VHlwZSwgc3R5bGUsIHN0eWxlSWQsIGZlYXR1cmVTdHlsZVByb3ApO1xuICAgICAgICBnZW9qc29uRmVhdHVyZS5wcm9wZXJ0aWVzW2ZlYXR1cmVTdHlsZVByb3BdID0gc3R5bGVJZDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoZ2VvanNvbkZlYXR1cmVzLmxlbmd0aCA+IDApIHtcbiAgICB2YXIgZ2VvanNvbkZlYXR1cmVDb2xsZWN0aW9uID0ge1xuICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJyxcbiAgICAgIGZlYXR1cmVzOiBnZW9qc29uRmVhdHVyZXNcbiAgICB9O1xuICAgIHZhciBvYmplY3QgPSB7XG4gICAgICBnZW9Kc29uOiBnZW9qc29uRmVhdHVyZUNvbGxlY3Rpb24sXG4gICAgICBvcGFjaXR5OiBsYXllci5nZXRPcGFjaXR5KCksXG4gICAgICBzdHlsZTogbWFwZmlzaFN0eWxlT2JqZWN0LFxuICAgICAgdHlwZTogJ2dlb2pzb24nXG4gICAgfTtcbiAgICBhcnIucHVzaChvYmplY3QpO1xuICB9XG59O1xuXG5WZWN0b3JFbmNvZGVyLnByb3RvdHlwZS5lbmNvZGVWZWN0b3JTdHlsZSA9IGZ1bmN0aW9uIChvYmplY3QsIGdlb21ldHJ5VHlwZSwgc3R5bGUsIHN0eWxlSWQsIGZlYXR1cmVTdHlsZVByb3ApIHtcbiAgaWYgKCEoZ2VvbWV0cnlUeXBlIGluIFBSSU5UX1NUWUxFX1RZUEVTKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBzdHlsZVR5cGUgPSBQUklOVF9TVFlMRV9UWVBFU1tnZW9tZXRyeVR5cGVdO1xuICB2YXIga2V5ID0gXCJbXCIgKyBmZWF0dXJlU3R5bGVQcm9wICsgXCIgPSAnXCIgKyBzdHlsZUlkICsgXCInXVwiO1xuXG4gIGlmIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHN0eWxlT2JqZWN0ID0ge1xuICAgIHN5bWJvbGl6ZXJzOiBbXVxuICB9O1xuICBvYmplY3Rba2V5XSA9IHN0eWxlT2JqZWN0O1xuICB2YXIgZmlsbFN0eWxlID0gc3R5bGUuZ2V0RmlsbCgpO1xuICB2YXIgaW1hZ2VTdHlsZSA9IHN0eWxlLmdldEltYWdlKCk7XG4gIHZhciBzdHJva2VTdHlsZSA9IHN0eWxlLmdldFN0cm9rZSgpO1xuICB2YXIgdGV4dFN0eWxlID0gc3R5bGUuZ2V0VGV4dCgpO1xuXG4gIGlmIChzdHlsZVR5cGUgPT09IFByaW50U3R5bGVUeXBlLlBPTFlHT04pIHtcbiAgICBpZiAoZmlsbFN0eWxlICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmVuY29kZVZlY3RvclN0eWxlUG9seWdvbihzdHlsZU9iamVjdC5zeW1ib2xpemVycywgZmlsbFN0eWxlLCBzdHJva2VTdHlsZSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHN0eWxlVHlwZSA9PT0gUHJpbnRTdHlsZVR5cGUuTElORV9TVFJJTkcpIHtcbiAgICBpZiAoc3Ryb2tlU3R5bGUgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuZW5jb2RlVmVjdG9yU3R5bGVMaW5lKHN0eWxlT2JqZWN0LnN5bWJvbGl6ZXJzLCBzdHJva2VTdHlsZSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHN0eWxlVHlwZSA9PT0gUHJpbnRTdHlsZVR5cGUuUE9JTlQpIHtcbiAgICBpZiAoaW1hZ2VTdHlsZSAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5lbmNvZGVWZWN0b3JTdHlsZVBvaW50KHN0eWxlT2JqZWN0LnN5bWJvbGl6ZXJzLCBpbWFnZVN0eWxlKTtcbiAgICB9XG4gIH1cblxuICBpZiAodGV4dFN0eWxlICE9PSBudWxsKSB7XG4gICAgdGhpcy5lbmNvZGVUZXh0U3R5bGUoc3R5bGVPYmplY3Quc3ltYm9saXplcnMsIHRleHRTdHlsZSk7XG4gIH1cbn07XG5cblZlY3RvckVuY29kZXIucHJvdG90eXBlLmVuY29kZVZlY3RvclN0eWxlRmlsbCA9IGZ1bmN0aW9uIChzeW1ib2xpemVyLCBmaWxsU3R5bGUpIHtcbiAgdmFyIGZpbGxDb2xvciA9IGZpbGxTdHlsZS5nZXRDb2xvcigpO1xuXG4gIGlmIChmaWxsQ29sb3IgIT09IG51bGwpIHtcbiAgICBjb25zb2xlLmFzc2VydCh0eXBlb2YgZmlsbENvbG9yID09PSAnc3RyaW5nJyB8fCBBcnJheS5pc0FycmF5KGZpbGxDb2xvcikpO1xuICAgIGZpbGxDb2xvciA9IGFzQ29sb3JBcnJheShmaWxsQ29sb3IpO1xuICAgIGNvbnNvbGUuYXNzZXJ0KEFycmF5LmlzQXJyYXkoZmlsbENvbG9yKSwgJ29ubHkgc3VwcG9ydGluZyBmaWxsIGNvbG9ycycpO1xuICAgIHN5bWJvbGl6ZXIuZmlsbENvbG9yID0gcmdiQXJyYXlUb0hleChmaWxsQ29sb3IpO1xuICAgIHN5bWJvbGl6ZXIuZmlsbE9wYWNpdHkgPSBmaWxsQ29sb3JbM107XG4gIH1cbn07XG5cblZlY3RvckVuY29kZXIucHJvdG90eXBlLmVuY29kZVZlY3RvclN0eWxlTGluZSA9IGZ1bmN0aW9uIChzeW1ib2xpemVycywgc3Ryb2tlU3R5bGUpIHtcbiAgdmFyIHN5bWJvbGl6ZXIgPSB7XG4gICAgdHlwZTogJ2xpbmUnXG4gIH07XG4gIHRoaXMuZW5jb2RlVmVjdG9yU3R5bGVTdHJva2Uoc3ltYm9saXplciwgc3Ryb2tlU3R5bGUpO1xuICBzeW1ib2xpemVycy5wdXNoKHN5bWJvbGl6ZXIpO1xufTtcblxuVmVjdG9yRW5jb2Rlci5wcm90b3R5cGUuZW5jb2RlVmVjdG9yU3R5bGVQb2ludCA9IGZ1bmN0aW9uIChzeW1ib2xpemVycywgaW1hZ2VTdHlsZSkge1xuICB2YXIgc3ltYm9saXplcjtcblxuICBpZiAoaW1hZ2VTdHlsZSBpbnN0YW5jZW9mIG9sU3R5bGVDaXJjbGUpIHtcbiAgICBzeW1ib2xpemVyID0ge1xuICAgICAgdHlwZTogJ3BvaW50J1xuICAgIH07XG4gICAgc3ltYm9saXplci5wb2ludFJhZGl1cyA9IGltYWdlU3R5bGUuZ2V0UmFkaXVzKCk7XG4gICAgdmFyIGZpbGxTdHlsZSA9IGltYWdlU3R5bGUuZ2V0RmlsbCgpO1xuXG4gICAgaWYgKGZpbGxTdHlsZSAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5lbmNvZGVWZWN0b3JTdHlsZUZpbGwoc3ltYm9saXplciwgZmlsbFN0eWxlKTtcbiAgICB9XG5cbiAgICB2YXIgc3Ryb2tlU3R5bGUgPSBpbWFnZVN0eWxlLmdldFN0cm9rZSgpO1xuXG4gICAgaWYgKHN0cm9rZVN0eWxlICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmVuY29kZVZlY3RvclN0eWxlU3Ryb2tlKHN5bWJvbGl6ZXIsIHN0cm9rZVN0eWxlKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoaW1hZ2VTdHlsZSBpbnN0YW5jZW9mIG9sU3R5bGVJY29uKSB7XG4gICAgdmFyIGltZ1NyYyA9IGltYWdlU3R5bGUuZ2V0U3JjKCk7XG5cbiAgICBpZiAoIWltZ1NyYykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGltZ1NyYycpO1xuICAgIH1cblxuICAgIHZhciBzcmMgPSBuZXcgVVJMKGltZ1NyYywgd2luZG93LmxvY2F0aW9uLmhyZWYpLmhyZWY7XG5cbiAgICBpZiAoc3JjICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHN5bWJvbGl6ZXIgPSB7XG4gICAgICAgIHR5cGU6ICdwb2ludCcsXG4gICAgICAgIGV4dGVybmFsR3JhcGhpYzogc3JjXG4gICAgICB9O1xuICAgICAgdmFyIG9wYWNpdHkgPSBpbWFnZVN0eWxlLmdldE9wYWNpdHkoKTtcblxuICAgICAgaWYgKG9wYWNpdHkgIT09IG51bGwpIHtcbiAgICAgICAgc3ltYm9saXplci5ncmFwaGljT3BhY2l0eSA9IG9wYWNpdHk7XG4gICAgICB9XG5cbiAgICAgIHZhciBzaXplID0gaW1hZ2VTdHlsZS5nZXRTaXplKCk7XG5cbiAgICAgIGlmIChzaXplICE9PSBudWxsKSB7XG4gICAgICAgIHZhciBzY2FsZSA9IGltYWdlU3R5bGUuZ2V0U2NhbGUoKTtcblxuICAgICAgICBpZiAoaXNOYU4oc2NhbGUpKSB7XG4gICAgICAgICAgc2NhbGUgPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgc3ltYm9saXplci5ncmFwaGljV2lkdGggPSBzaXplWzBdICogc2NhbGU7XG4gICAgICAgIHN5bWJvbGl6ZXIuZ3JhcGhpY0hlaWdodCA9IHNpemVbMV0gKiBzY2FsZTtcbiAgICAgIH1cblxuICAgICAgdmFyIHJvdGF0aW9uID0gaW1hZ2VTdHlsZS5nZXRSb3RhdGlvbigpO1xuXG4gICAgICBpZiAoaXNOYU4ocm90YXRpb24pKSB7XG4gICAgICAgIHJvdGF0aW9uID0gMDtcbiAgICAgIH1cblxuICAgICAgc3ltYm9saXplci5yb3RhdGlvbiA9IHRvRGVncmVlcyhyb3RhdGlvbik7XG4gICAgfVxuICB9IGVsc2UgaWYgKGltYWdlU3R5bGUgaW5zdGFuY2VvZiBvbFN0eWxlUmVndWxhclNoYXBlKSB7XG4gICAgdmFyIHBvaW50cyA9IGltYWdlU3R5bGUuZ2V0UG9pbnRzKCk7XG5cbiAgICBpZiAocG9pbnRzICE9PSBudWxsKSB7XG4gICAgICBzeW1ib2xpemVyID0ge1xuICAgICAgICB0eXBlOiAncG9pbnQnXG4gICAgICB9O1xuXG4gICAgICBpZiAocG9pbnRzID09PSA0KSB7XG4gICAgICAgIHN5bWJvbGl6ZXIuZ3JhcGhpY05hbWUgPSAnc3F1YXJlJztcbiAgICAgIH0gZWxzZSBpZiAocG9pbnRzID09PSAzKSB7XG4gICAgICAgIHN5bWJvbGl6ZXIuZ3JhcGhpY05hbWUgPSAndHJpYW5nbGUnO1xuICAgICAgfSBlbHNlIGlmIChwb2ludHMgPT09IDUpIHtcbiAgICAgICAgc3ltYm9saXplci5ncmFwaGljTmFtZSA9ICdzdGFyJztcbiAgICAgIH0gZWxzZSBpZiAocG9pbnRzID09PSA4KSB7XG4gICAgICAgIHN5bWJvbGl6ZXIuZ3JhcGhpY05hbWUgPSAnY3Jvc3MnO1xuICAgICAgfVxuXG4gICAgICB2YXIgc2l6ZVNoYXBlID0gaW1hZ2VTdHlsZS5nZXRTaXplKCk7XG5cbiAgICAgIGlmIChzaXplU2hhcGUgIT09IG51bGwpIHtcbiAgICAgICAgc3ltYm9saXplci5ncmFwaGljV2lkdGggPSBzaXplU2hhcGVbMF07XG4gICAgICAgIHN5bWJvbGl6ZXIuZ3JhcGhpY0hlaWdodCA9IHNpemVTaGFwZVsxXTtcbiAgICAgIH1cblxuICAgICAgdmFyIHJvdGF0aW9uU2hhcGUgPSBpbWFnZVN0eWxlLmdldFJvdGF0aW9uKCk7XG5cbiAgICAgIGlmICghaXNOYU4ocm90YXRpb25TaGFwZSkgJiYgcm90YXRpb25TaGFwZSAhPT0gMCkge1xuICAgICAgICBzeW1ib2xpemVyLnJvdGF0aW9uID0gdG9EZWdyZWVzKHJvdGF0aW9uU2hhcGUpO1xuICAgICAgfVxuXG4gICAgICB2YXIgb3BhY2l0eVNoYXBlID0gaW1hZ2VTdHlsZS5nZXRPcGFjaXR5KCk7XG5cbiAgICAgIGlmIChvcGFjaXR5U2hhcGUgIT09IG51bGwpIHtcbiAgICAgICAgc3ltYm9saXplci5ncmFwaGljT3BhY2l0eSA9IG9wYWNpdHlTaGFwZTtcbiAgICAgIH1cblxuICAgICAgdmFyIHN0cm9rZVNoYXBlID0gaW1hZ2VTdHlsZS5nZXRTdHJva2UoKTtcblxuICAgICAgaWYgKHN0cm9rZVNoYXBlICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuZW5jb2RlVmVjdG9yU3R5bGVTdHJva2Uoc3ltYm9saXplciwgc3Ryb2tlU2hhcGUpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZmlsbFNoYXBlID0gaW1hZ2VTdHlsZS5nZXRGaWxsKCk7XG5cbiAgICAgIGlmIChmaWxsU2hhcGUgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5lbmNvZGVWZWN0b3JTdHlsZUZpbGwoc3ltYm9saXplciwgZmlsbFNoYXBlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoc3ltYm9saXplciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgc3ltYm9saXplcnMucHVzaChzeW1ib2xpemVyKTtcbiAgfVxufTtcblxuVmVjdG9yRW5jb2Rlci5wcm90b3R5cGUuZW5jb2RlVmVjdG9yU3R5bGVQb2x5Z29uID0gZnVuY3Rpb24gKHN5bWJvbGl6ZXJzLCBmaWxsU3R5bGUsIHN0cm9rZVN0eWxlKSB7XG4gIHZhciBzeW1ib2xpemVyID0ge1xuICAgIHR5cGU6ICdwb2x5Z29uJ1xuICB9O1xuICB0aGlzLmVuY29kZVZlY3RvclN0eWxlRmlsbChzeW1ib2xpemVyLCBmaWxsU3R5bGUpO1xuXG4gIGlmIChzdHJva2VTdHlsZSAhPT0gbnVsbCkge1xuICAgIHRoaXMuZW5jb2RlVmVjdG9yU3R5bGVTdHJva2Uoc3ltYm9saXplciwgc3Ryb2tlU3R5bGUpO1xuICB9XG5cbiAgc3ltYm9saXplcnMucHVzaChzeW1ib2xpemVyKTtcbn07XG5cblZlY3RvckVuY29kZXIucHJvdG90eXBlLmVuY29kZVZlY3RvclN0eWxlU3Ryb2tlID0gZnVuY3Rpb24gKHN5bWJvbGl6ZXIsIHN0cm9rZVN0eWxlKSB7XG4gIHZhciBzdHJva2VDb2xvciA9IHN0cm9rZVN0eWxlLmdldENvbG9yKCk7XG5cbiAgaWYgKHN0cm9rZUNvbG9yICE9PSBudWxsKSB7XG4gICAgaWYgKCEodHlwZW9mIHN0cm9rZUNvbG9yID09PSAnc3RyaW5nJyB8fCBBcnJheS5pc0FycmF5KHN0cm9rZUNvbG9yKSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignV3Jvbmcgc3Ryb2tlQ29sb3IgdHlwZScpO1xuICAgIH1cblxuICAgIHZhciBzdHJva2VDb2xvclJnYmEgPSBhc0NvbG9yQXJyYXkoc3Ryb2tlQ29sb3IpO1xuXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHN0cm9rZUNvbG9yUmdiYSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigncGFyc2VkIFN0cm9rZUNvbG9yIGlzIG5vdCBhbiBhcnJheScpO1xuICAgIH1cblxuICAgIHN5bWJvbGl6ZXIuc3Ryb2tlQ29sb3IgPSByZ2JBcnJheVRvSGV4KHN0cm9rZUNvbG9yUmdiYSk7XG4gICAgc3ltYm9saXplci5zdHJva2VPcGFjaXR5ID0gc3Ryb2tlQ29sb3JSZ2JhWzNdO1xuICB9XG5cbiAgdmFyIHN0cm9rZURhc2hzdHlsZSA9IHN0cm9rZVN0eWxlLmdldExpbmVEYXNoKCk7XG5cbiAgaWYgKHN0cm9rZURhc2hzdHlsZSAhPT0gbnVsbCkge1xuICAgIHN5bWJvbGl6ZXIuc3Ryb2tlRGFzaHN0eWxlID0gc3Ryb2tlRGFzaHN0eWxlLmpvaW4oJyAnKTtcbiAgfVxuXG4gIHZhciBzdHJva2VXaWR0aCA9IHN0cm9rZVN0eWxlLmdldFdpZHRoKCk7XG5cbiAgaWYgKHN0cm9rZVdpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICBzeW1ib2xpemVyLnN0cm9rZVdpZHRoID0gc3Ryb2tlV2lkdGg7XG4gIH1cblxuICB2YXIgc3Ryb2tlTGluZUNhcCA9IHN0cm9rZVN0eWxlLmdldExpbmVDYXAoKTtcblxuICBpZiAoc3Ryb2tlTGluZUNhcCkge1xuICAgIHN5bWJvbGl6ZXIuc3Ryb2tlTGluZWNhcCA9IHN0cm9rZUxpbmVDYXA7XG4gIH1cbn07XG5cblZlY3RvckVuY29kZXIucHJvdG90eXBlLmVuY29kZVRleHRTdHlsZSA9IGZ1bmN0aW9uIChzeW1ib2xpemVycywgdGV4dFN0eWxlKSB7XG4gIHZhciBzeW1ib2xpemVyID0ge1xuICAgIHR5cGU6ICdUZXh0J1xuICB9O1xuICB2YXIgbGFiZWwgPSB0ZXh0U3R5bGUuZ2V0VGV4dCgpO1xuXG4gIGlmIChsYWJlbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgc3ltYm9saXplci5sYWJlbCA9IGxhYmVsO1xuICAgIHZhciB4QWxpZ24gPSAnYyc7XG4gICAgdmFyIHlBbGlnbiA9ICdtJztcbiAgICB2YXIgb2xUZXh0QWxpZ24gPSB0ZXh0U3R5bGUuZ2V0VGV4dEFsaWduKCk7XG5cbiAgICBpZiAob2xUZXh0QWxpZ24gPT09ICdsZWZ0JyB8fCBvbFRleHRBbGlnbiA9PT0gJ3N0YXJ0Jykge1xuICAgICAgeEFsaWduID0gJ2wnO1xuICAgIH0gZWxzZSBpZiAob2xUZXh0QWxpZ24gPT09ICdyaWdodCcgfHwgb2xUZXh0QWxpZ24gPT09ICdlbmQnKSB7XG4gICAgICB4QWxpZ24gPSAncic7XG4gICAgfVxuXG4gICAgdmFyIG9sVGV4dEJhc2VsaW5lID0gdGV4dFN0eWxlLmdldFRleHRCYXNlbGluZSgpO1xuXG4gICAgaWYgKG9sVGV4dEJhc2VsaW5lID09PSAnYm90dG9tJykge1xuICAgICAgeUFsaWduID0gJ2wnO1xuICAgIH0gZWxzZSBpZiAob2xUZXh0QmFzZWxpbmUgPT09ICd0b3AnKSB7XG4gICAgICB5QWxpZ24gPSAndCc7XG4gICAgfVxuXG4gICAgc3ltYm9saXplci5sYWJlbEFsaWduID0gXCJcIiArIHhBbGlnbiArIHlBbGlnbjtcbiAgICB2YXIgbGFiZWxSb3RhdGlvbiA9IHRleHRTdHlsZS5nZXRSb3RhdGlvbigpO1xuXG4gICAgaWYgKGxhYmVsUm90YXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgc3ltYm9saXplci5sYWJlbFJvdGF0aW9uID0gKGxhYmVsUm90YXRpb24gKiAxODAgLyBNYXRoLlBJKS50b1N0cmluZygpO1xuICAgICAgc3ltYm9saXplci5sYWJlbEFsaWduID0gJ2NtJztcbiAgICB9XG5cbiAgICB2YXIgZm9udFN0eWxlID0gdGV4dFN0eWxlLmdldEZvbnQoKTtcblxuICAgIGlmIChmb250U3R5bGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFyIGZvbnQgPSBmb250U3R5bGUuc3BsaXQoJyAnKTtcblxuICAgICAgaWYgKGZvbnQubGVuZ3RoID49IDMpIHtcbiAgICAgICAgc3ltYm9saXplci5mb250V2VpZ2h0ID0gZm9udFswXTtcbiAgICAgICAgc3ltYm9saXplci5mb250U2l6ZSA9IGZvbnRbMV07XG4gICAgICAgIHN5bWJvbGl6ZXIuZm9udEZhbWlseSA9IGZvbnQuc3BsaWNlKDIpLmpvaW4oJyAnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgc3Ryb2tlU3R5bGUgPSB0ZXh0U3R5bGUuZ2V0U3Ryb2tlKCk7XG5cbiAgICBpZiAoc3Ryb2tlU3R5bGUgIT09IG51bGwpIHtcbiAgICAgIHZhciBzdHJva2VDb2xvciA9IHN0cm9rZVN0eWxlLmdldENvbG9yKCk7XG5cbiAgICAgIGlmICghKHR5cGVvZiBzdHJva2VDb2xvciA9PT0gJ3N0cmluZycgfHwgQXJyYXkuaXNBcnJheShzdHJva2VDb2xvcikpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3Jvbmcgc3Ryb2tlQ29sb3IgdHlwZScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgc3Ryb2tlQ29sb3JSZ2JhID0gYXNDb2xvckFycmF5KHN0cm9rZUNvbG9yKTtcblxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHN0cm9rZUNvbG9yKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIHN0cm9rZUNvbG9yIHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgc3ltYm9saXplci5oYWxvQ29sb3IgPSByZ2JBcnJheVRvSGV4KHN0cm9rZUNvbG9yUmdiYSk7XG4gICAgICBzeW1ib2xpemVyLmhhbG9PcGFjaXR5ID0gc3Ryb2tlQ29sb3JSZ2JhWzNdO1xuICAgICAgdmFyIHdpZHRoID0gc3Ryb2tlU3R5bGUuZ2V0V2lkdGgoKTtcblxuICAgICAgaWYgKHdpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgc3ltYm9saXplci5oYWxvUmFkaXVzID0gd2lkdGggLyAyO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBmaWxsU3R5bGUgPSB0ZXh0U3R5bGUuZ2V0RmlsbCgpO1xuXG4gICAgaWYgKGZpbGxTdHlsZSAhPT0gbnVsbCkge1xuICAgICAgdmFyIGZpbGxDb2xvciA9IGZpbGxTdHlsZS5nZXRDb2xvcigpO1xuXG4gICAgICBpZiAoISh0eXBlb2YgZmlsbENvbG9yID09PSAnc3RyaW5nJyB8fCBBcnJheS5pc0FycmF5KGZpbGxDb2xvcikpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgZmlsbENvbG9yIHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGZpbGxDb2xvclJnYmEgPSBhc0NvbG9yQXJyYXkoZmlsbENvbG9yKTtcblxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGZpbGxDb2xvcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBmaWxsQ29sb3IgdHlwZScpO1xuICAgICAgfVxuXG4gICAgICBzeW1ib2xpemVyLmZvbnRDb2xvciA9IHJnYkFycmF5VG9IZXgoZmlsbENvbG9yUmdiYSk7XG4gICAgfVxuXG4gICAgaWYgKHN5bWJvbGl6ZXIubGFiZWxBbGlnbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzeW1ib2xpemVyLmxhYmVsWE9mZnNldCA9IHRleHRTdHlsZS5nZXRPZmZzZXRYKCk7XG4gICAgICBzeW1ib2xpemVyLmxhYmVsWU9mZnNldCA9IC10ZXh0U3R5bGUuZ2V0T2Zmc2V0WSgpO1xuICAgIH1cblxuICAgIHN5bWJvbGl6ZXJzLnB1c2goc3ltYm9saXplcik7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IFZlY3RvckVuY29kZXI7IiwiaW1wb3J0IHsgYXJlYSBhcyBkM2FyZWEsIGJpc2VjdG9yIGFzIGQzYmlzZWN0b3IsIGV4dGVudCBhcyBkM2V4dGVudCwgc2VsZWN0IGFzIGQzc2VsZWN0LCBzY2FsZUxpbmVhciBhcyBkM3NjYWxlTGluZWFyLCBheGlzQm90dG9tIGFzIGQzYXhpc0JvdHRvbSwgYXhpc0xlZnQgYXMgZDNheGlzTGVmdCwgbGluZSBhcyBkM2xpbmUsIG1vdXNlIGFzIGQzbW91c2UgfSBmcm9tICdkMyc7XG5cbmZ1bmN0aW9uIGQzRWxldmF0aW9uKG9wdGlvbnMpIHtcbiAgdmFyIGxpZ2h0ID0gb3B0aW9ucy5saWdodCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5saWdodCA6IGZhbHNlO1xuICB2YXIgbWFyZ2luID0gbGlnaHQgPyB7XG4gICAgdG9wOiAwLFxuICAgIHJpZ2h0OiAwLFxuICAgIGJvdHRvbTogMCxcbiAgICBsZWZ0OiAwXG4gIH0gOiB7XG4gICAgdG9wOiAxMCxcbiAgICByaWdodDogMjAsXG4gICAgYm90dG9tOiAzMCxcbiAgICBsZWZ0OiA0MFxuICB9O1xuICB2YXIgaG92ZXJDYWxsYmFjayA9IG9wdGlvbnMuaG92ZXJDYWxsYmFjayAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5ob3ZlckNhbGxiYWNrIDogZnVuY3Rpb24gKCkge307XG4gIHZhciBvdXRDYWxsYmFjayA9IG9wdGlvbnMub3V0Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMub3V0Q2FsbGJhY2sgOiBmdW5jdGlvbiAoKSB7fTtcbiAgdmFyIGRpc3RhbmNlRXh0cmFjdG9yID0gb3B0aW9ucy5kaXN0YW5jZUV4dHJhY3RvcjtcbiAgdmFyIGxpbmVzQ29uZmlndXJhdGlvbiA9IG9wdGlvbnMubGluZXNDb25maWd1cmF0aW9uO1xuICB2YXIgbnVtYmVyT2ZMaW5lcyA9IE9iamVjdC5rZXlzKGxpbmVzQ29uZmlndXJhdGlvbikubGVuZ3RoO1xuICB2YXIgYmlzZWN0RGlzdGFuY2UgPSBkM2Jpc2VjdG9yKGZ1bmN0aW9uIChkKSB7XG4gICAgcmV0dXJuIGRpc3RhbmNlRXh0cmFjdG9yKGQpO1xuICB9KS5sZWZ0O1xuICB2YXIgcG9pRXh0cmFjdG9yID0gb3B0aW9ucy5wb2lFeHRyYWN0b3I7XG4gIHZhciBzdHlsZURlZnMgPSBvcHRpb25zLnN0eWxlRGVmcztcbiAgdmFyIHBvaUxhYmVsQW5nbGUgPSBvcHRpb25zLnBvaUxhYmVsQW5nbGUgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucG9pTGFiZWxBbmdsZSA6IC02MDtcbiAgdmFyIGkxOG4gPSBvcHRpb25zLmkxOG4gfHwge307XG4gIHZhciB4QXhpc0xhYmVsID0gaTE4bi54QXhpcyB8fCAnRGlzdGFuY2UnO1xuICB2YXIgeUF4aXNMYWJlbCA9IGkxOG4ueUF4aXMgfHwgJ0VsZXZhdGlvbic7XG4gIHZhciBmb3JtYXR0ZXIgPSB7XG4gICAgeGhvdmVyOiBmdW5jdGlvbiB4aG92ZXIoZGlzdCwgdW5pdHMpIHtcbiAgICAgIHJldHVybiBwYXJzZUZsb2F0KGRpc3QudG9QcmVjaXNpb24oMykpICsgXCIgXCIgKyB1bml0cztcbiAgICB9LFxuICAgIHlob3ZlcjogZnVuY3Rpb24geWhvdmVyKGVsZSwgdW5pdHMpIHtcbiAgICAgIHJldHVybiBlbGUgIT09IG51bGwgPyBNYXRoLnJvdW5kKGVsZSkgKyBcIiBtXCIgOiAnJztcbiAgICB9LFxuICAgIHh0aWNrOiBmdW5jdGlvbiB4dGljayhkaXN0LCB1bml0cykge1xuICAgICAgcmV0dXJuIGRpc3Q7XG4gICAgfSxcbiAgICB5dGljazogZnVuY3Rpb24geXRpY2soZWxlLCB1bml0cykge1xuICAgICAgcmV0dXJuIGVsZTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKG9wdGlvbnMuZm9ybWF0dGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICBPYmplY3QuYXNzaWduKGZvcm1hdHRlciwgb3B0aW9ucy5mb3JtYXR0ZXIpO1xuICB9XG5cbiAgdmFyIGxpZ2h0WEF4aXMgPSBvcHRpb25zLmxpZ2h0WEF4aXMgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMubGlnaHRYQXhpcyA6IGZhbHNlO1xuICB2YXIgc3ZnO1xuICB2YXIgeDtcbiAgdmFyIHk7XG4gIHZhciBzY2FsZU1vZGlmaWVyID0gb3B0aW9ucy5zY2FsZU1vZGlmaWVyO1xuICB2YXIgZztcbiAgdmFyIGhlaWdodDtcbiAgdmFyIHdpZHRoO1xuICB2YXIgeEZhY3RvcjtcbiAgdmFyIHhVbml0cztcbiAgdmFyIHhEb21haW47XG5cbiAgdmFyIHByb2ZpbGUgPSBmdW5jdGlvbiBwcm9maWxlKHNlbGVjdGlvbikge1xuICAgIHZhciBmdW5jID0gZnVuY3Rpb24gZnVuYyhkYXRhKSB7XG4gICAgICBkM3NlbGVjdCh0aGlzKS5zZWxlY3RBbGwoJ3N2ZycpLnJlbW92ZSgpO1xuXG4gICAgICBpZiAoZGF0YSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgd2lkdGggPSBNYXRoLm1heCh0aGlzLmNsaWVudFdpZHRoIC0gbWFyZ2luLnJpZ2h0IC0gbWFyZ2luLmxlZnQsIDApO1xuICAgICAgeCA9IGQzc2NhbGVMaW5lYXIoKS5yYW5nZShbMCwgd2lkdGhdKTtcbiAgICAgIGhlaWdodCA9IE1hdGgubWF4KHRoaXMuY2xpZW50SGVpZ2h0IC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b20sIDApO1xuICAgICAgeSA9IGQzc2NhbGVMaW5lYXIoKS5yYW5nZShbaGVpZ2h0LCAwXSk7XG4gICAgICB2YXIgeEF4aXMgPSBkM2F4aXNCb3R0b20oeCk7XG4gICAgICB2YXIgeUF4aXMgPSBkM2F4aXNMZWZ0KHkpO1xuICAgICAgdmFyIGFyZWEgPSBudWxsO1xuXG4gICAgICBpZiAobnVtYmVyT2ZMaW5lcyA9PT0gMSkge1xuICAgICAgICBhcmVhID0gZDNhcmVhKCkueChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgIHJldHVybiB4KGRpc3RhbmNlRXh0cmFjdG9yKGQpKTtcbiAgICAgICAgfSkueTAoaGVpZ2h0KS55MShmdW5jdGlvbiAoZCkge1xuICAgICAgICAgIHZhciBmaXJzdExpbmVOYW1lID0gT2JqZWN0LmtleXMobGluZXNDb25maWd1cmF0aW9uKVswXTtcbiAgICAgICAgICByZXR1cm4geShsaW5lc0NvbmZpZ3VyYXRpb25bZmlyc3RMaW5lTmFtZV0uekV4dHJhY3RvcihkKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBzdmcgPSBkM3NlbGVjdCh0aGlzKS5zZWxlY3RBbGwoJ3N2ZycpLmRhdGEoW2RhdGFdKTtcbiAgICAgIHZhciBzdmdFbnRlciA9IHN2Zy5lbnRlcigpLmFwcGVuZCgnc3ZnJyk7XG4gICAgICBzdmcgPSBkM3NlbGVjdCh0aGlzKS5zZWxlY3RBbGwoJ3N2ZycpLmRhdGEoW2RhdGFdKTtcblxuICAgICAgaWYgKHN0eWxlRGVmcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHN2Z0VudGVyLmFwcGVuZCgnZGVmcycpLmFwcGVuZCgnc3R5bGUnKS5hdHRyKCd0eXBlJywgJ3RleHQvY3NzJykudGV4dChzdHlsZURlZnMpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZ0VudGVyID0gc3ZnRW50ZXIuYXBwZW5kKCdnJyk7XG4gICAgICBjbGVhclBvaXMoKTtcbiAgICAgIGdFbnRlci5zdHlsZSgnZm9udCcsICcxMXB4IEFyaWFsJyk7XG5cbiAgICAgIGlmIChudW1iZXJPZkxpbmVzID09PSAxKSB7XG4gICAgICAgIGdFbnRlci5hcHBlbmQoJ3BhdGgnKS5hdHRyKCdjbGFzcycsICdhcmVhJykuc3R5bGUoJ2ZpbGwnLCAncmdiYSgyMjIsIDIyMiwgMjIyLCAwLjUpJyk7XG4gICAgICB9XG5cbiAgICAgIGdFbnRlci5pbnNlcnQoJ2cnLCAnOmZpcnN0LWNoaWxkJykuYXR0cignY2xhc3MnLCAnZ3JpZC15Jyk7XG5cbiAgICAgIGlmICghbGlnaHQpIHtcbiAgICAgICAgZ0VudGVyLmFwcGVuZCgnZycpLmF0dHIoJ2NsYXNzJywgJ3ggYXhpcycpLmF0dHIoJ3RyYW5zZm9ybScsIFwidHJhbnNsYXRlKDAsXCIgKyBoZWlnaHQgKyBcIilcIik7XG4gICAgICAgIGdFbnRlci5hcHBlbmQoJ3RleHQnKS5hdHRyKCdjbGFzcycsICd4IGxhYmVsJykuYXR0cigndGV4dC1hbmNob3InLCAnZW5kJykuYXR0cigneCcsIHdpZHRoIC0gNCkuYXR0cigneScsIGhlaWdodCAtIDQpO1xuICAgICAgICBnRW50ZXIuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAneSBheGlzJyk7XG4gICAgICAgIGdFbnRlci5hcHBlbmQoJ3RleHQnKS5hdHRyKCdjbGFzcycsICd5IGxhYmVsJykuYXR0cigndGV4dC1hbmNob3InLCAnZW5kJykuYXR0cigneScsIDYpLmF0dHIoJ2R5JywgJy43NWVtJykuYXR0cigndHJhbnNmb3JtJywgJ3JvdGF0ZSgtOTApJykuc3R5bGUoJ2ZpbGwnLCAnZ3JleScpLnRleHQoeUF4aXNMYWJlbCArIFwiIFttXVwiKTtcbiAgICAgICAgZ0VudGVyLmFwcGVuZCgnZycpLmF0dHIoJ2NsYXNzJywgJ21ldGFzJykuYXR0cigndHJhbnNmb3JtJywgXCJ0cmFuc2xhdGUoXCIgKyAod2lkdGggKyAzKSArIFwiLCAwKVwiKTtcbiAgICAgIH1cblxuICAgICAgZ0VudGVyLmFwcGVuZCgnZycpLmF0dHIoJ2NsYXNzJywgJ3BvaXMnKTtcbiAgICAgIHZhciB4SG92ZXIgPSBnRW50ZXIuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAneCBncmlkLWhvdmVyJyk7XG4gICAgICB4SG92ZXIuYXBwZW5kKCdzdmc6bGluZScpLmF0dHIoJ3N0cm9rZS1kYXNoYXJyYXknLCAnNSw1Jyk7XG4gICAgICB4SG92ZXIuYXBwZW5kKCd0ZXh0Jyk7XG4gICAgICBnRW50ZXIuYXBwZW5kKCdyZWN0JykuYXR0cignY2xhc3MnLCAnb3ZlcmxheScpLmF0dHIoJ3dpZHRoJywgd2lkdGgpLmF0dHIoJ2hlaWdodCcsIGhlaWdodCkuc3R5bGUoJ2ZpbGwnLCAnbm9uZScpLnN0eWxlKCdwb2ludGVyLWV2ZW50cycsICdhbGwnKTtcbiAgICAgIHN2Zy5hdHRyKCd3aWR0aCcsIHdpZHRoICsgbWFyZ2luLmxlZnQgKyBtYXJnaW4ucmlnaHQpLmF0dHIoJ2hlaWdodCcsIGhlaWdodCArIG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tKTtcbiAgICAgIGcgPSBzdmcuc2VsZWN0KCdnJykuYXR0cigndHJhbnNmb3JtJywgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLFwiICsgbWFyZ2luLnRvcCArIFwiKVwiKTtcbiAgICAgIHhEb21haW4gPSBkM2V4dGVudChkYXRhLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICByZXR1cm4gZGlzdGFuY2VFeHRyYWN0b3IoZCk7XG4gICAgICB9KTtcbiAgICAgIHguZG9tYWluKHhEb21haW4pO1xuXG4gICAgICB2YXIgeURvbWFpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVsZXZhdGlvbnNWYWx1ZXMgPSBbXTtcblxuICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChuYW1lKSB7XG4gICAgICAgICAgdmFyIGV4dGVudCA9IGQzZXh0ZW50KGRhdGEsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICByZXR1cm4gbGluZXNDb25maWd1cmF0aW9uW25hbWVdLnpFeHRyYWN0b3IoZCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAoZXh0ZW50LmV2ZXJ5KE51bWJlci5pc0Zpbml0ZSkpIHtcbiAgICAgICAgICAgIGVsZXZhdGlvbnNWYWx1ZXMgPSBlbGV2YXRpb25zVmFsdWVzLmNvbmNhdChleHRlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBuYW1lIGluIGxpbmVzQ29uZmlndXJhdGlvbikge1xuICAgICAgICAgIF9sb29wKG5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtNYXRoLm1pbi5hcHBseShNYXRoLCBlbGV2YXRpb25zVmFsdWVzKSwgTWF0aC5tYXguYXBwbHkoTWF0aCwgZWxldmF0aW9uc1ZhbHVlcyldO1xuICAgICAgfSgpO1xuXG4gICAgICB5LmRvbWFpbih5RG9tYWluKTtcblxuICAgICAgaWYgKHNjYWxlTW9kaWZpZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBzY2FsZU1vZGlmaWVyKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHBhZGRpbmcgPSAoeURvbWFpblsxXSAtIHlEb21haW5bMF0pICogMC4xO1xuICAgICAgICB5LmRvbWFpbihbeURvbWFpblswXSAtIHBhZGRpbmcsIHlEb21haW5bMV0gKyBwYWRkaW5nXSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChudW1iZXJPZkxpbmVzID09PSAxKSB7XG4gICAgICAgIGlmICghYXJlYSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBhcmVhJyk7XG4gICAgICAgIH1cblxuICAgICAgICBnLnNlbGVjdCgnLmFyZWEnKS50cmFuc2l0aW9uKCkuYXR0cignZCcsIGFyZWEpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbGluZSwgeUhvdmVyO1xuXG4gICAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKG5hbWUpIHtcbiAgICAgICAgZ0VudGVyLmFwcGVuZCgncGF0aCcpLmF0dHIoJ2NsYXNzJywgXCJsaW5lIFwiICsgbmFtZSkuc3R5bGUoJ3N0cm9rZScsIGxpbmVzQ29uZmlndXJhdGlvbltuYW1lXS5jb2xvciB8fCAnI0YwMCcpLnN0eWxlKCdmaWxsJywgJ25vbmUnKTtcbiAgICAgICAgeUhvdmVyID0gZ0VudGVyLmFwcGVuZCgnZycpLmF0dHIoJ2NsYXNzJywgXCJ5IGdyaWQtaG92ZXIgXCIgKyBuYW1lKTtcbiAgICAgICAgeUhvdmVyLmFwcGVuZCgnc3ZnOmxpbmUnKS5hdHRyKCdzdHJva2UtZGFzaGFycmF5JywgJzUsNScpO1xuICAgICAgICB5SG92ZXIuYXBwZW5kKCd0ZXh0Jyk7XG4gICAgICAgIGxpbmUgPSBkM2xpbmUoKS54KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgcmV0dXJuIHgoZGlzdGFuY2VFeHRyYWN0b3IoZCkpO1xuICAgICAgICB9KS55KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgcmV0dXJuIHkobGluZXNDb25maWd1cmF0aW9uW25hbWVdLnpFeHRyYWN0b3IoZCkpO1xuICAgICAgICB9KS5kZWZpbmVkKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgcmV0dXJuIGxpbmVzQ29uZmlndXJhdGlvbltuYW1lXS56RXh0cmFjdG9yKGQpICE9PSBudWxsO1xuICAgICAgICB9KTtcbiAgICAgICAgZy5zZWxlY3QoXCIubGluZS5cIiArIG5hbWUpLnRyYW5zaXRpb24oKS5hdHRyKCdkJywgbGluZSk7XG4gICAgICB9O1xuXG4gICAgICBmb3IgKHZhciBuYW1lIGluIGxpbmVzQ29uZmlndXJhdGlvbikge1xuICAgICAgICBfbG9vcDIobmFtZSk7XG4gICAgICB9XG5cbiAgICAgIHhGYWN0b3IgPSB4RG9tYWluWzFdID4gMjAwMCA/IDEwMDAgOiAxO1xuICAgICAgeFVuaXRzID0geERvbWFpblsxXSA+IDIwMDAgPyAna20nIDogJ20nO1xuXG4gICAgICBpZiAoIWxpZ2h0KSB7XG4gICAgICAgIHhBeGlzLnRpY2tGb3JtYXQoZnVuY3Rpb24gKGRvbWFpblZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIGZvcm1hdHRlci54dGljayhkb21haW5WYWx1ZSAvIHhGYWN0b3IsIHhVbml0cyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChsaWdodFhBeGlzKSB7XG4gICAgICAgICAgeEF4aXMudGlja1ZhbHVlcyhbMCwgeC5kb21haW4oKVsxXV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgeUF4aXMudGlja0Zvcm1hdChmdW5jdGlvbiAoZG9tbWFpblZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIGZvcm1hdHRlci55dGljayhkb21tYWluVmFsdWUsICdtJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBnLnNlbGVjdCgnLnguYXhpcycpLnRyYW5zaXRpb24oKS5jYWxsKHhBeGlzKTtcbiAgICAgICAgZy5zZWxlY3QoJy54LmxhYmVsJykudGV4dCh4QXhpc0xhYmVsICsgXCIgW1wiICsgeFVuaXRzICsgXCJdXCIpLnN0eWxlKCdmaWxsJywgJ2dyZXknKS5zdHlsZSgnc2hhcGUtcmVuZGVyaW5nJywgJ2NyaXNwRWRnZXMnKTtcblxuICAgICAgICBpZiAoaGVpZ2h0IC8gMTUgPCAxMCkge1xuICAgICAgICAgIHlBeGlzLnRpY2tzKGhlaWdodCAvIDE1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGcuc2VsZWN0KCcueS5heGlzJykudHJhbnNpdGlvbigpLmNhbGwoeUF4aXMpO1xuICAgICAgfVxuXG4gICAgICBnLnNlbGVjdCgnLmdyaWQteScpLnRyYW5zaXRpb24oKS5jYWxsKHlBeGlzLnRpY2tTaXplKC13aWR0aCkudGlja0Zvcm1hdChudWxsKSkuc2VsZWN0QWxsKCcudGljayBsaW5lJykuc3R5bGUoJ3N0cm9rZScsICcjY2NjJykuc3R5bGUoJ29wYWNpdHknLCAwLjcpO1xuICAgICAgZy5zZWxlY3QoJy5ncmlkLXknKS5zZWxlY3RBbGwoJy50aWNrIHRleHQnKS5yZW1vdmUoKTtcbiAgICAgIGcuc2VsZWN0QWxsKCcuYXhpcycpLnNlbGVjdEFsbCgncGF0aCwgbGluZScpLnN0eWxlKCdmaWxsJywgJ25vbmUnKS5zdHlsZSgnc3Ryb2tlJywgJyMwMDAnKS5zdHlsZSgnc2hhcGUtcmVuZGVyaW5nJywgJ2NyaXNwRWRnZXMnKTtcbiAgICAgIGcuc2VsZWN0KCcuZ3JpZC15Jykuc2VsZWN0KCdwYXRoJykuc3R5bGUoJ3N0cm9rZScsICdub25lJyk7XG4gICAgICBnLnNlbGVjdEFsbCgnLmdyaWQtaG92ZXIgbGluZScpLnN0eWxlKCdzdHJva2UnLCAnIzIyMicpLnN0eWxlKCdvcGFjaXR5JywgMC44KTtcbiAgICAgIGcuc2VsZWN0KCcub3ZlcmxheScpLm9uKCdtb3VzZW91dCcsIG1vdXNlb3V0KS5vbignbW91c2Vtb3ZlJywgbW91c2Vtb3ZlKTtcblxuICAgICAgZnVuY3Rpb24gbW91c2Vtb3ZlKCkge1xuICAgICAgICB2YXIgbW91c2VYID0gZDNtb3VzZSh0aGlzKVswXTtcbiAgICAgICAgdmFyIHgwID0geC5pbnZlcnQobW91c2VYKTtcbiAgICAgICAgcHJvZmlsZS5oaWdobGlnaHQoeDApO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBtb3VzZW91dCgpIHtcbiAgICAgICAgcHJvZmlsZS5jbGVhckhpZ2hsaWdodCgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBzZWxlY3Rpb24uZWFjaChmdW5jKTtcbiAgfTtcblxuICBwcm9maWxlLmNsZWFySGlnaGxpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgIGcuc2VsZWN0QWxsKCcuZ3JpZC1ob3ZlcicpLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICBvdXRDYWxsYmFjay5jYWxsKG51bGwpO1xuICB9O1xuXG4gIHByb2ZpbGUuaGlnaGxpZ2h0ID0gZnVuY3Rpb24gKGRpc3RhbmNlKSB7XG4gICAgdmFyIGRhdGEgPSBzdmcuZGF0dW0oKTtcbiAgICB2YXIgaSA9IGJpc2VjdERpc3RhbmNlKGRhdGEsIGRpc3RhbmNlKTtcblxuICAgIGlmIChpID49IGRhdGEubGVuZ3RoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHBvaW50ID0gZGF0YVtpXTtcbiAgICB2YXIgZGlzdCA9IGRpc3RhbmNlRXh0cmFjdG9yKHBvaW50KTtcbiAgICB2YXIgZWxldmF0aW9uO1xuICAgIHZhciBlbGV2YXRpb25zID0gW107XG4gICAgdmFyIGVsZXZhdGlvbnNSZWYgPSB7fTtcbiAgICB2YXIgbGluZU5hbWU7XG5cbiAgICBmb3IgKGxpbmVOYW1lIGluIGxpbmVzQ29uZmlndXJhdGlvbikge1xuICAgICAgZWxldmF0aW9uID0gbGluZXNDb25maWd1cmF0aW9uW2xpbmVOYW1lXS56RXh0cmFjdG9yKHBvaW50KTtcblxuICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShlbGV2YXRpb24pKSB7XG4gICAgICAgIGVsZXZhdGlvbnMucHVzaChlbGV2YXRpb24pO1xuICAgICAgICBlbGV2YXRpb25zUmVmW2xpbmVOYW1lXSA9IGVsZXZhdGlvbjtcbiAgICAgICAgZy5zZWxlY3QoXCIueS5ncmlkLWhvdmVyLlwiICsgbGluZU5hbWUpLnN0eWxlKCdkaXNwbGF5JywgJ2lubGluZScpLnNlbGVjdCgnbGluZScpLmF0dHIoJ3gxJywgeCgwKSkuYXR0cigneTEnLCB5KGVsZXZhdGlvbikpLmF0dHIoJ3gyJywgd2lkdGgpLmF0dHIoJ3kyJywgeShlbGV2YXRpb24pKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGcuc2VsZWN0KFwiLnkuZ3JpZC1ob3Zlci5cIiArIGxpbmVOYW1lKS5zdHlsZSgnZGlzcGxheScsICdub25lJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHkyID0geShNYXRoLm1heC5hcHBseShudWxsLCBlbGV2YXRpb25zKSk7XG4gICAgZy5zZWxlY3QoJy54LmdyaWQtaG92ZXInKS5zdHlsZSgnZGlzcGxheScsICdpbmxpbmUnKS5zZWxlY3QoJ2xpbmUnKS5hdHRyKCd4MScsIHgoZGlzdCkpLmF0dHIoJ3kxJywgaGVpZ2h0KS5hdHRyKCd4MicsIHgoZGlzdCkpLmF0dHIoJ3kyJywgTnVtYmVyLmlzRmluaXRlKHkyKSA/IHkyIDogMCk7XG4gICAgdmFyIHJpZ2h0ID0gZGlzdCA+IHhEb21haW5bMV0gLyAyO1xuICAgIHZhciB4dHJhbnNsYXRlID0geChkaXN0KTtcbiAgICB4dHJhbnNsYXRlICs9IHJpZ2h0ID8gLTEwIDogMTA7XG4gICAgZy5zZWxlY3QoJy54LmdyaWQtaG92ZXIgdGV4dCcpLnRleHQoZm9ybWF0dGVyLnhob3ZlcihkaXN0IC8geEZhY3RvciwgeFVuaXRzKSkuc3R5bGUoJ3RleHQtYW5jaG9yJywgcmlnaHQgPyAnZW5kJyA6ICdzdGFydCcpLmF0dHIoJ3RyYW5zZm9ybScsIFwidHJhbnNsYXRlKFwiICsgeHRyYW5zbGF0ZSArIFwiLFwiICsgKGhlaWdodCAtIDEwKSArIFwiKVwiKTtcblxuICAgIGlmIChudW1iZXJPZkxpbmVzID09PSAxKSB7XG4gICAgICB2YXIgaGFzVmFsdWUgPSBOdW1iZXIuaXNGaW5pdGUoZWxldmF0aW9uc1swXSk7XG4gICAgICBnLnNlbGVjdCgnLnkuZ3JpZC1ob3ZlciB0ZXh0JykudGV4dChoYXNWYWx1ZSA/IGZvcm1hdHRlci55aG92ZXIoZWxldmF0aW9uc1swXSwgJ20nKSA6ICdubyB2YWx1ZScpLnN0eWxlKCd0ZXh0LWFuY2hvcicsIHJpZ2h0ID8gJ2VuZCcgOiAnc3RhcnQnKS5hdHRyKCd0cmFuc2Zvcm0nLCBcInRyYW5zbGF0ZShcIiArIHh0cmFuc2xhdGUgKyBcIixcIiArIChoYXNWYWx1ZSA/IHkoZWxldmF0aW9uc1swXSkgLSAxMCA6IDApICsgXCIpXCIpO1xuICAgIH1cblxuICAgIGhvdmVyQ2FsbGJhY2suY2FsbChudWxsLCBwb2ludCwgZGlzdCAvIHhGYWN0b3IsIHhVbml0cywgZWxldmF0aW9uc1JlZiwgJ20nKTtcbiAgfTtcblxuICBwcm9maWxlLnNob3dQb2lzID0gZnVuY3Rpb24gKHBvaXMpIHtcbiAgICBpZiAoIXN2Zykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHBvaXMgPSBwb2lzICE9PSB1bmRlZmluZWQgPyBwb2lzIDogW107XG4gICAgY29uc29sZS5hc3NlcnQocG9pcy5sZW5ndGggPT09IDAgfHwgcG9pRXh0cmFjdG9yICE9PSB1bmRlZmluZWQpO1xuICAgIHZhciBwZSA9IHBvaUV4dHJhY3RvcjtcbiAgICB2YXIgZyA9IHN2Zy5zZWxlY3QoJ2cnKTtcbiAgICB2YXIgcHJvZmlsZURhdGEgPSBzdmcuZGF0dW0oKTtcbiAgICB2YXIgcHMgPSBnLnNlbGVjdCgnLnBvaXMnKTtcbiAgICB2YXIgcCA9IHBzLnNlbGVjdEFsbCgnLnBvaScpLmRhdGEocG9pcywgZnVuY3Rpb24gKGQpIHtcbiAgICAgIHZhciBpID0gYmlzZWN0RGlzdGFuY2UocHJvZmlsZURhdGEsIE1hdGgucm91bmQocGUuZGlzdChkKSAqIDEwKSAvIDEwLCAxKTtcbiAgICAgIHZhciBwb2ludCA9IHByb2ZpbGVEYXRhW2ldO1xuXG4gICAgICBpZiAocG9pbnQpIHtcbiAgICAgICAgdmFyIGxpbmVOYW1lO1xuICAgICAgICB2YXIgZWxldmF0aW9ucyA9IFtdO1xuXG4gICAgICAgIGZvciAobGluZU5hbWUgaW4gbGluZXNDb25maWd1cmF0aW9uKSB7XG4gICAgICAgICAgZWxldmF0aW9ucy5wdXNoKGxpbmVzQ29uZmlndXJhdGlvbltsaW5lTmFtZV0uekV4dHJhY3Rvcihwb2ludCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHogPSBNYXRoLm1heC5hcHBseShudWxsLCBlbGV2YXRpb25zKTtcbiAgICAgICAgcGUueihkLCB6KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHBlLmlkKGQpO1xuICAgIH0pO1xuICAgIHZhciBwb2lFbnRlckcgPSBwLmVudGVyKCkuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAncG9pJyk7XG4gICAgcG9pRW50ZXJHLmFwcGVuZCgndGV4dCcpLmF0dHIoJ3gnLCBsaWdodCA/IDAgOiA5KS5hdHRyKCdkeScsICcuMzVlbScpLmF0dHIoJ3RleHQtYW5jaG9yJywgbGlnaHQgPyAnbWlkZGxlJyA6ICdzdGFydCcpO1xuICAgIHBvaUVudGVyRy5hcHBlbmQoJ2xpbmUnKS5zdHlsZSgnc2hhcGUtcmVuZGVyaW5nJywgJ2NyaXNwRWRnZXMnKTtcbiAgICBwb2lFbnRlckcuc3R5bGUoJ29wYWNpdHknLCAwKS50cmFuc2l0aW9uKCkuZHVyYXRpb24oMTAwMCkuZGVsYXkoMTAwKS5zdHlsZSgnb3BhY2l0eScsIDEpO1xuICAgIHBvaUVudGVyRy5zZWxlY3RBbGwoJ3RleHQnKS5hdHRyKCd0cmFuc2Zvcm0nLCBmdW5jdGlvbiAoZCkge1xuICAgICAgaWYgKGxpZ2h0KSB7XG4gICAgICAgIHJldHVybiBbXCJ0cmFuc2xhdGUoXCIgKyB4KHBlLmRpc3QoZCkpICsgXCIsXCIgKyAoeShwZS56KGQpKSAtIDEwKSArIFwiKVwiXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBbXCJ0cmFuc2xhdGUoXCIgKyB4KHBlLmRpc3QoZCkpICsgXCIsXCIgKyAoeShwZS56KGQpKSAtIDIwKSArIFwiKSByb3RhdGUoXCIgKyBwb2lMYWJlbEFuZ2xlICsgXCIpXCJdO1xuICAgICAgfVxuICAgIH0pLnRleHQoZnVuY3Rpb24gKGQpIHtcbiAgICAgIHJldHVybiBcIlwiICsgcGUuc29ydChkKSArIChsaWdodCA/ICcnIDogXCIgLSBcIiArIHBlLnRpdGxlKGQpKTtcbiAgICB9KTtcbiAgICBwb2lFbnRlckcuc2VsZWN0QWxsKCdsaW5lJykuc3R5bGUoJ3N0cm9rZScsICdncmV5JykuYXR0cigneDEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIHgocGUuZGlzdChkKSk7XG4gICAgfSkuYXR0cigneTEnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIHkoeS5kb21haW4oKVswXSk7XG4gICAgfSkuYXR0cigneDInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIHgocGUuZGlzdChkKSk7XG4gICAgfSkuYXR0cigneTInLCBmdW5jdGlvbiAoZCkge1xuICAgICAgcmV0dXJuIHkocGUueihkKSk7XG4gICAgfSk7XG4gICAgcG9pRW50ZXJHLmV4aXQoKS5yZW1vdmUoKTtcbiAgfTtcblxuICBmdW5jdGlvbiBjbGVhclBvaXMoKSB7XG4gICAgcHJvZmlsZS5zaG93UG9pcyhbXSk7XG4gIH1cblxuICByZXR1cm4gcHJvZmlsZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZDNFbGV2YXRpb247IiwicHJvZmlsZUVsZXZhdGlvbkNvbXBvbmVudC4kaW5qZWN0ID0gW1wibmdlb0RlYm91bmNlXCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBsaXN0ZW4gfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IG5nZW9NaXNjRGVib3VuY2UgZnJvbSAnbmdlby9taXNjL2RlYm91bmNlLmpzJztcbmltcG9ydCBuZ2VvUHJvZmlsZUQzRWxldmF0aW9uIGZyb20gJ25nZW8vcHJvZmlsZS9kM0VsZXZhdGlvbi5qcyc7XG5pbXBvcnQgeyBzZWxlY3QgYXMgZDNzZWxlY3QgfSBmcm9tICdkMyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9Qcm9maWxlJywgW25nZW9NaXNjRGVib3VuY2UubmFtZV0pO1xuXG5mdW5jdGlvbiBwcm9maWxlRWxldmF0aW9uQ29tcG9uZW50KG5nZW9EZWJvdW5jZSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIHZhciBvcHRpb25zQXR0ciA9IGF0dHJzLm5nZW9Qcm9maWxlT3B0aW9ucztcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KG9wdGlvbnNBdHRyICE9PSB1bmRlZmluZWQpO1xuICAgICAgdmFyIHNlbGVjdGlvbiA9IGQzc2VsZWN0KGVsZW1lbnRbMF0pO1xuICAgICAgdmFyIHByb2ZpbGUgPSB1bmRlZmluZWQ7XG4gICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKG9wdGlvbnNBdHRyLCBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgbmV3VmFsKTtcblxuICAgICAgICBpZiAob3B0aW9ucyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYgKG9wdGlvbnMuaG92ZXJDYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgb3JpZ0hvdmVyQ2FsbGJhY2sgPSBvcHRpb25zLmhvdmVyQ2FsbGJhY2s7XG5cbiAgICAgICAgICAgIG9wdGlvbnMuaG92ZXJDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgb3JpZ0hvdmVyQ2FsbGJhY2suYXBwbHkodm9pZCAwLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICBzY29wZS4kYXBwbHlBc3luYygpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy5vdXRDYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgb3JpZ091dENhbGxiYWNrID0gb3B0aW9ucy5vdXRDYWxsYmFjaztcblxuICAgICAgICAgICAgb3B0aW9ucy5vdXRDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgb3JpZ091dENhbGxiYWNrKCk7XG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseUFzeW5jKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHByb2ZpbGUgPSBuZ2VvUHJvZmlsZUQzRWxldmF0aW9uKG9wdGlvbnMpO1xuICAgICAgICAgIHJlZnJlc2hEYXRhKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdmFyIGVsZXZhdGlvbkRhdGEgPSB1bmRlZmluZWQ7XG4gICAgICBzY29wZS4kd2F0Y2goYXR0cnMubmdlb1Byb2ZpbGUsIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xuICAgICAgICBlbGV2YXRpb25EYXRhID0gbmV3VmFsO1xuICAgICAgICByZWZyZXNoRGF0YSgpO1xuICAgICAgfSk7XG4gICAgICB2YXIgcG9pRGF0YSA9IHVuZGVmaW5lZDtcbiAgICAgIHNjb3BlLiR3YXRjaChhdHRycy5uZ2VvUHJvZmlsZVBvaXMsIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xuICAgICAgICBwb2lEYXRhID0gbmV3VmFsO1xuICAgICAgICByZWZyZXNoRGF0YSgpO1xuICAgICAgfSk7XG4gICAgICBzY29wZS4kd2F0Y2goYXR0cnMubmdlb1Byb2ZpbGVIaWdobGlnaHQsIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xuICAgICAgICBpZiAobmV3VmFsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobmV3VmFsID4gMCkge1xuICAgICAgICAgIHByb2ZpbGUuaGlnaGxpZ2h0KG5ld1ZhbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHJvZmlsZS5jbGVhckhpZ2hsaWdodCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxpc3Rlbih3aW5kb3csICdyZXNpemUnLCBuZ2VvRGVib3VuY2UocmVmcmVzaERhdGEsIDUwLCB0cnVlKSk7XG5cbiAgICAgIGZ1bmN0aW9uIHJlZnJlc2hEYXRhKGV2dCkge1xuICAgICAgICBpZiAocHJvZmlsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgc2VsZWN0aW9uLmRhdHVtKGVsZXZhdGlvbkRhdGEpLmNhbGwocHJvZmlsZSk7XG5cbiAgICAgICAgICBpZiAoZWxldmF0aW9uRGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9maWxlLnNob3dQb2lzKHBvaURhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmRpcmVjdGl2ZSgnbmdlb1Byb2ZpbGUnLCBwcm9maWxlRWxldmF0aW9uQ29tcG9uZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJleHBvcnQgZGVmYXVsdCB7XG4gIEFERDogJ2FkZCcsXG4gIFJFTU9WRTogJ3JlbW92ZScsXG4gIFJFUExBQ0U6ICdyZXBsYWNlJ1xufTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IGhhc0NvYXJzZVBvaW50aW5nRGV2aWNlIH0gZnJvbSAnbmdlby91dGlscy5qcyc7XG5pbXBvcnQgbmdlb1F1ZXJ5QWN0aW9uIGZyb20gJ25nZW8vcXVlcnkvQWN0aW9uLmpzJztcbmltcG9ydCBuZ2VvUXVlcnlRdWVyZW50IGZyb20gJ25nZW8vcXVlcnkvUXVlcmVudC5qcyc7XG5pbXBvcnQgbmdlb0RhdGFzb3VyY2VEYXRhU291cmNlcyBmcm9tICduZ2VvL2RhdGFzb3VyY2UvRGF0YVNvdXJjZXMuanMnO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlSGVscGVyIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9IZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9NaXNjRmVhdHVyZUhlbHBlciBmcm9tICduZ2VvL21pc2MvRmVhdHVyZUhlbHBlci5qcyc7XG5leHBvcnQgdmFyIE1hcFF1ZXJlbnQgPSBmdW5jdGlvbiAoKSB7XG4gIE1hcFF1ZXJlbnQuJGluamVjdCA9IFtcIiRpbmplY3RvclwiLCBcIm5nZW9EYXRhU291cmNlc1wiLCBcIm5nZW9EYXRhU291cmNlc0hlbHBlclwiLCBcIm5nZW9GZWF0dXJlSGVscGVyXCIsIFwibmdlb1F1ZXJlbnRcIiwgXCJuZ2VvUXVlcnlSZXN1bHRcIl07XG5cbiAgZnVuY3Rpb24gTWFwUXVlcmVudCgkaW5qZWN0b3IsIG5nZW9EYXRhU291cmNlcywgbmdlb0RhdGFTb3VyY2VzSGVscGVyLCBuZ2VvRmVhdHVyZUhlbHBlciwgbmdlb1F1ZXJlbnQsIG5nZW9RdWVyeVJlc3VsdCkge1xuICAgIHZhciBvcHRpb25zID0gJGluamVjdG9yLmhhcygnbmdlb1F1ZXJ5T3B0aW9ucycpID8gJGluamVjdG9yLmdldCgnbmdlb1F1ZXJ5T3B0aW9ucycpIDoge307XG4gICAgdGhpcy5kYXRhU291cmNlc18gPSBuZ2VvRGF0YVNvdXJjZXMuY29sbGVjdGlvbjtcbiAgICB0aGlzLmZlYXR1cmVIZWxwZXJfID0gbmdlb0ZlYXR1cmVIZWxwZXI7XG4gICAgdGhpcy5uZ2VvRGF0YVNvdXJjZXNIZWxwZXJfID0gbmdlb0RhdGFTb3VyY2VzSGVscGVyO1xuICAgIHRoaXMubmdlb1F1ZXJlbnRfID0gbmdlb1F1ZXJlbnQ7XG4gICAgdGhpcy5yZXN1bHRfID0gbmdlb1F1ZXJ5UmVzdWx0O1xuICAgIHRoaXMubGltaXRfID0gb3B0aW9ucy5saW1pdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5saW1pdCA6IDUwO1xuICAgIHRoaXMucXVlcnlDb3VudEZpcnN0XyA9IG9wdGlvbnMucXVlcnlDb3VudEZpcnN0ICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnF1ZXJ5Q291bnRGaXJzdCA6IGZhbHNlO1xuICAgIHRoaXMudG9sZXJhbmNlUHhfO1xuXG4gICAgaWYgKGhhc0NvYXJzZVBvaW50aW5nRGV2aWNlKCkpIHtcbiAgICAgIHRoaXMudG9sZXJhbmNlUHhfID0gb3B0aW9ucy50b2xlcmFuY2VUb3VjaCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy50b2xlcmFuY2VUb3VjaCA6IDEwO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRvbGVyYW5jZVB4XyA9IG9wdGlvbnMudG9sZXJhbmNlICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnRvbGVyYW5jZSA6IDM7XG4gICAgfVxuXG4gICAgdGhpcy5iYm94QXNHRVRQYXJhbV8gPSBvcHRpb25zLmJib3hBc0dFVFBhcmFtIHx8IGZhbHNlO1xuICAgIHRoaXMuZGF0YVNvdXJjZU5hbWVzXyA9IHt9O1xuICAgIHRoaXMuY2xlYXJlZF8gPSBmYWxzZTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBNYXBRdWVyZW50LnByb3RvdHlwZTtcblxuICBfcHJvdG8uaXNzdWUgPSBmdW5jdGlvbiBpc3N1ZShvcHRpb25zKSB7XG4gICAgdmFyIGFjdGlvbiA9IG9wdGlvbnMuYWN0aW9uID8gb3B0aW9ucy5hY3Rpb24gOiBuZ2VvUXVlcnlBY3Rpb24uUkVQTEFDRTtcbiAgICB0aGlzLmNsZWFyKGFjdGlvbiAhPT0gbmdlb1F1ZXJ5QWN0aW9uLlJFUExBQ0UpO1xuICAgIHZhciBxdWVyeWFibGVEYXRhU291cmNlcztcblxuICAgIGlmIChvcHRpb25zLmRhdGFTb3VyY2VzID09PSB1bmRlZmluZWQgJiYgb3B0aW9ucy5xdWVyeWFibGVEYXRhU291cmNlcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdWVyeWFibGVEYXRhU291cmNlcyA9IHRoaXMubmdlb1F1ZXJlbnRfLmdldFF1ZXJ5YWJsZURhdGFTb3VyY2VzKHRoaXMuZGF0YVNvdXJjZXNfLmdldEFycmF5KCksIG9wdGlvbnMubWFwKTtcbiAgICB9XG5cbiAgICB2YXIgbGltaXQgPSBvcHRpb25zLmxpbWl0ICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmxpbWl0IDogdGhpcy5saW1pdF87XG4gICAgT2JqZWN0LmFzc2lnbihvcHRpb25zLCB7XG4gICAgICBxdWVyeWFibGVEYXRhU291cmNlczogcXVlcnlhYmxlRGF0YVNvdXJjZXMsXG4gICAgICBsaW1pdDogbGltaXQsXG4gICAgICB0b2xlcmFuY2VQeDogdGhpcy50b2xlcmFuY2VQeF8sXG4gICAgICB3ZnNDb3VudDogdGhpcy5xdWVyeUNvdW50Rmlyc3RfLFxuICAgICAgYmJveEFzR0VUUGFyYW06IHRoaXMuYmJveEFzR0VUUGFyYW1fXG4gICAgfSk7XG4gICAgdGhpcy5yZXN1bHRfLnBlbmRpbmcgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzLm5nZW9RdWVyZW50Xy5pc3N1ZShvcHRpb25zKS50aGVuKHRoaXMuaGFuZGxlUmVzdWx0Xy5iaW5kKHRoaXMsIGFjdGlvbikpO1xuICB9O1xuXG4gIF9wcm90by5jbGVhciA9IGZ1bmN0aW9uIGNsZWFyKGtlZXApIHtcbiAgICBpZiAoa2VlcCA9PT0gdm9pZCAwKSB7XG4gICAgICBrZWVwID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2xlYXJlZF8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnJlc3VsdF8udG90YWwgPSAwO1xuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gdGhpcy5yZXN1bHRfLnNvdXJjZXMsIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IpLCBfaSA9IDAsIF9pdGVyYXRvciA9IF9pc0FycmF5ID8gX2l0ZXJhdG9yIDogX2l0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjtcblxuICAgICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICAgIGlmIChfaSA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pID0gX2l0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBzb3VyY2UgPSBfcmVmO1xuXG4gICAgICBpZiAoIWtlZXApIHtcbiAgICAgICAgc291cmNlLmZlYXR1cmVzLmxlbmd0aCA9IDA7XG4gICAgICAgIGRlbGV0ZSBzb3VyY2UudG90YWxGZWF0dXJlQ291bnQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJlc3VsdF8udG90YWwgKz0gc291cmNlLmZlYXR1cmVzLmxlbmd0aDtcbiAgICAgIH1cblxuICAgICAgc291cmNlLnBlbmRpbmcgPSBmYWxzZTtcbiAgICAgIHNvdXJjZS5xdWVyaWVkID0gZmFsc2U7XG4gICAgICBzb3VyY2UudG9vTWFueVJlc3VsdHMgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoIWtlZXApIHtcbiAgICAgIHRoaXMucmVzdWx0Xy5zb3VyY2VzLmxlbmd0aCA9IDA7XG4gICAgfVxuXG4gICAgdGhpcy5yZXN1bHRfLnBlbmRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmNsZWFyZWRfID0gdHJ1ZTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlUmVzdWx0XyA9IGZ1bmN0aW9uIGhhbmRsZVJlc3VsdF8oYWN0aW9uLCByZXNwb25zZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgdG90YWwgPSBhY3Rpb24gPT09IG5nZW9RdWVyeUFjdGlvbi5SRVBMQUNFID8gMCA6IHRoaXMucmVzdWx0Xy50b3RhbDtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGlkU3RyKSB7XG4gICAgICB2YXIgaWQgPSBOdW1iZXIoaWRTdHIpO1xuXG4gICAgICB2YXIgZGF0YVNvdXJjZSA9IF90aGlzLm5nZW9EYXRhU291cmNlc0hlbHBlcl8uZ2V0RGF0YVNvdXJjZShpZCk7XG5cbiAgICAgIGlmICghZGF0YVNvdXJjZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZGF0YVNvdXJjZScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbGFiZWwgPSBkYXRhU291cmNlLm5hbWU7XG4gICAgICBjb25zb2xlLmFzc2VydChkYXRhU291cmNlKTtcbiAgICAgIHZhciBxdWVyZW50UmVzdWx0SXRlbSA9IHJlc3BvbnNlW2lkXTtcbiAgICAgIHZhciBmZWF0dXJlcyA9IHF1ZXJlbnRSZXN1bHRJdGVtLmZlYXR1cmVzO1xuICAgICAgdmFyIGxpbWl0ID0gcXVlcmVudFJlc3VsdEl0ZW0ubGltaXQ7XG4gICAgICB2YXIgdG9vTWFueVJlc3VsdHMgPSBxdWVyZW50UmVzdWx0SXRlbS50b29NYW55RmVhdHVyZXMgPT09IHRydWU7XG4gICAgICB2YXIgdG90YWxGZWF0dXJlQ291bnQgPSBxdWVyZW50UmVzdWx0SXRlbS50b3RhbEZlYXR1cmVDb3VudDtcbiAgICAgIHZhciB0eXBlU2VwYXJhdGVkRmVhdHVyZXMgPSB7fTtcbiAgICAgIGZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgICAgdmFyIHR5cGUgPSBmZWF0dXJlLmdldCgnbmdlb19mZWF0dXJlX3R5cGVfJyk7XG5cbiAgICAgICAgaWYgKCF0eXBlU2VwYXJhdGVkRmVhdHVyZXNbdHlwZV0pIHtcbiAgICAgICAgICB0eXBlU2VwYXJhdGVkRmVhdHVyZXNbdHlwZV0gPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhU291cmNlLmF0dHJpYnV0ZXMgJiYgZGF0YVNvdXJjZS5hdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgIHZhciBwcm9wZXJ0aWVzID0gZmVhdHVyZS5nZXRQcm9wZXJ0aWVzKCk7XG4gICAgICAgICAgdmFyIGZpbHRlcmVkUHJvcGVydGllcyA9IHt9O1xuICAgICAgICAgIGRhdGFTb3VyY2UuYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUuYWxpYXMpIHtcbiAgICAgICAgICAgICAgZmlsdGVyZWRQcm9wZXJ0aWVzW2F0dHJpYnV0ZS5hbGlhc10gPSBwcm9wZXJ0aWVzW2F0dHJpYnV0ZS5uYW1lXTtcbiAgICAgICAgICAgICAgZmVhdHVyZS51bnNldChhdHRyaWJ1dGUubmFtZSwgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBmaWx0ZXJlZFByb3BlcnRpZXNbYXR0cmlidXRlLm5hbWVdID0gcHJvcGVydGllc1thdHRyaWJ1dGUubmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZmVhdHVyZS5zZXRQcm9wZXJ0aWVzKGZpbHRlcmVkUHJvcGVydGllcywgdHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0eXBlU2VwYXJhdGVkRmVhdHVyZXNbdHlwZV0ucHVzaChmZWF0dXJlKTtcbiAgICAgIH0pO1xuXG4gICAgICBmb3IgKHZhciB0eXBlIGluIHR5cGVTZXBhcmF0ZWRGZWF0dXJlcykge1xuICAgICAgICBsYWJlbCA9IHR5cGUgPyB0eXBlIDogbGFiZWw7XG4gICAgICAgIHZhciBmZWF0dXJlc0J5VHlwZSA9IHR5cGVTZXBhcmF0ZWRGZWF0dXJlc1t0eXBlXTtcbiAgICAgICAgdmFyIHNob3VsZFB1c2ggPSBmYWxzZTtcblxuICAgICAgICBpZiAoYWN0aW9uID09PSBuZ2VvUXVlcnlBY3Rpb24uUkVQTEFDRSkge1xuICAgICAgICAgIHNob3VsZFB1c2ggPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBleGlzdGluZ1NvdXJjZSA9IHZvaWQgMDtcblxuICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSBfdGhpcy5yZXN1bHRfLnNvdXJjZXMsIF9pc0FycmF5MiA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMiksIF9pMiA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICAgICAgdmFyIF9yZWYyO1xuXG4gICAgICAgICAgICBpZiAoX2lzQXJyYXkyKSB7XG4gICAgICAgICAgICAgIGlmIChfaTIgPj0gX2l0ZXJhdG9yMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgICAgICBfcmVmMiA9IF9pdGVyYXRvcjJbX2kyKytdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX2kyID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG4gICAgICAgICAgICAgIGlmIChfaTIuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICAgIF9yZWYyID0gX2kyLnZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc291cmNlID0gX3JlZjI7XG5cbiAgICAgICAgICAgIGlmIChzb3VyY2UuaWQgPT09IGlkICYmIHNvdXJjZS5sYWJlbCA9PT0gbGFiZWwpIHtcbiAgICAgICAgICAgICAgZXhpc3RpbmdTb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChleGlzdGluZ1NvdXJjZSkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IGZlYXR1cmVzQnlUeXBlLCBfaXNBcnJheTMgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjMpLCBfaTMgPSAwLCBfaXRlcmF0b3IzID0gX2lzQXJyYXkzID8gX2l0ZXJhdG9yMyA6IF9pdGVyYXRvcjNbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgICAgICAgdmFyIF9yZWYzO1xuXG4gICAgICAgICAgICAgIGlmIChfaXNBcnJheTMpIHtcbiAgICAgICAgICAgICAgICBpZiAoX2kzID49IF9pdGVyYXRvcjMubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICAgICAgICBfcmVmMyA9IF9pdGVyYXRvcjNbX2kzKytdO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIF9pMyA9IF9pdGVyYXRvcjMubmV4dCgpO1xuICAgICAgICAgICAgICAgIGlmIChfaTMuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgX3JlZjMgPSBfaTMudmFsdWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB2YXIgbmV3RmVhdHVyZSA9IF9yZWYzO1xuXG4gICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZlYXR1cmVJbmRleCA9IF90aGlzLmZlYXR1cmVIZWxwZXJfLmZpbmRGZWF0dXJlSW5kZXhCeUZpZChleGlzdGluZ1NvdXJjZS5mZWF0dXJlcywgXCJcIiArIG5ld0ZlYXR1cmUuZ2V0SWQoKSk7XG5cbiAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRmVhdHVyZUluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgIGlmIChhY3Rpb24gPT09IG5nZW9RdWVyeUFjdGlvbi5BREQpIHtcbiAgICAgICAgICAgICAgICAgIGV4aXN0aW5nU291cmNlLmZlYXR1cmVzLnB1c2gobmV3RmVhdHVyZSk7XG4gICAgICAgICAgICAgICAgICB0b3RhbCArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSBuZ2VvUXVlcnlBY3Rpb24uUkVNT1ZFKSB7XG4gICAgICAgICAgICAgICAgICBleGlzdGluZ1NvdXJjZS5mZWF0dXJlcy5zcGxpY2UoZXhpc3RpbmdGZWF0dXJlSW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgdG90YWwgLT0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGFjdGlvbiA9PT0gbmdlb1F1ZXJ5QWN0aW9uLkFERCkge1xuICAgICAgICAgICAgICBzaG91bGRQdXNoID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2hvdWxkUHVzaCkge1xuICAgICAgICAgIF90aGlzLnJlc3VsdF8uc291cmNlcy5wdXNoKHtcbiAgICAgICAgICAgIGZlYXR1cmVzOiBmZWF0dXJlc0J5VHlwZSxcbiAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgICAgIGxpbWl0OiBsaW1pdCxcbiAgICAgICAgICAgIHBlbmRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgcXVlcmllZDogdHJ1ZSxcbiAgICAgICAgICAgIHRvb01hbnlSZXN1bHRzOiB0b29NYW55UmVzdWx0cyxcbiAgICAgICAgICAgIHRvdGFsRmVhdHVyZUNvdW50OiB0b3RhbEZlYXR1cmVDb3VudFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdG90YWwgKz0gZmVhdHVyZXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZvciAodmFyIGlkU3RyIGluIHJlc3BvbnNlKSB7XG4gICAgICBfbG9vcChpZFN0cik7XG4gICAgfVxuXG4gICAgdGhpcy5yZXN1bHRfLnRvdGFsID0gdG90YWw7XG4gICAgdGhpcy5yZXN1bHRfLnBlbmRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmNsZWFyZWRfID0gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIE1hcFF1ZXJlbnQ7XG59KCk7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9NYXBRdWVyZW50JywgW25nZW9EYXRhc291cmNlRGF0YVNvdXJjZXMubmFtZSwgbmdlb0RhdGFzb3VyY2VIZWxwZXIubmFtZSwgbmdlb1F1ZXJ5UXVlcmVudC5uYW1lLCBuZ2VvTWlzY0ZlYXR1cmVIZWxwZXIubmFtZV0pO1xubW9kdWxlLnNlcnZpY2UoJ25nZW9NYXBRdWVyZW50JywgTWFwUXVlcmVudCk7XG5tb2R1bGUudmFsdWUoJ25nZW9RdWVyeVJlc3VsdCcsIHtcbiAgc291cmNlczogW10sXG4gIHRvdGFsOiAwLFxuICBwZW5kaW5nOiBmYWxzZVxufSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiZXhwb3J0IGRlZmF1bHQge1xuICBDTElDSzogJ2NsaWNrJyxcbiAgRFJBV19CT1g6ICdkcmF3Ym94JyxcbiAgRFJBV19QT0xZR09OOiAnZHJhd3BvbHlnb24nXG59OyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgbmdlb1F1ZXJ5QWN0aW9uIGZyb20gJ25nZW8vcXVlcnkvQWN0aW9uLmpzJztcbmltcG9ydCBuZ2VvUXVlcnlNb2RlIGZyb20gJ25nZW8vcXVlcnkvTW9kZS5qcyc7XG5pbXBvcnQgeyBsaXN0ZW4gYXMgb2xFdmVudHNMaXN0ZW4gfSBmcm9tICdvbC9ldmVudHMuanMnO1xuaW1wb3J0IHsgTUFDIH0gZnJvbSAnb2wvaGFzLmpzJztcbmV4cG9ydCB2YXIgUXVlcnlNb2RlU2VsZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gIFF1ZXJ5TW9kZVNlbGVjdG9yLiRpbmplY3QgPSBbXCIkcm9vdFNjb3BlXCJdO1xuXG4gIGZ1bmN0aW9uIFF1ZXJ5TW9kZVNlbGVjdG9yKCRyb290U2NvcGUpIHtcbiAgICB0aGlzLmtleUFjdGlvbkFkZF8gPSAnYSc7XG4gICAgdGhpcy5rZXlBY3Rpb25SZW1vdmVfID0gJ3gnO1xuICAgIHRoaXMua2V5c0FjdGlvbl8gPSBbdGhpcy5rZXlBY3Rpb25BZGRfLCB0aGlzLmtleUFjdGlvblJlbW92ZV9dO1xuICAgIHRoaXMuYWN0aW9uXyA9IG5nZW9RdWVyeUFjdGlvbi5SRVBMQUNFO1xuICAgIHRoaXMucHJldmlvdXNBY3Rpb25fID0gbnVsbDtcbiAgICB0aGlzLm1vZGVfID0gbmdlb1F1ZXJ5TW9kZS5DTElDSztcbiAgICB0aGlzLnByZXZpb3VzTW9kZV8gPSBudWxsO1xuICAgIHRoaXMuYWN0aXZlQWN0aW9uS2V5XyA9IG51bGw7XG4gICAgdGhpcy5yb290U2NvcGVfID0gJHJvb3RTY29wZTtcbiAgICBvbEV2ZW50c0xpc3Rlbihkb2N1bWVudCwgJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleURvd25fLCB0aGlzKTtcbiAgICBvbEV2ZW50c0xpc3Rlbihkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5oYW5kbGVLZXlVcF8sIHRoaXMpO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IFF1ZXJ5TW9kZVNlbGVjdG9yLnByb3RvdHlwZTtcblxuICBfcHJvdG8uaGFuZGxlS2V5RG93bl8gPSBmdW5jdGlvbiBoYW5kbGVLZXlEb3duXyhldnQpIHtcbiAgICBpZiAoIShldnQgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBrZXkgPSBldnQua2V5O1xuXG4gICAgaWYgKHRoaXMua2V5c0FjdGlvbl8uaW5jbHVkZXMoa2V5KSAmJiAhdGhpcy5wcmV2aW91c0FjdGlvbl8pIHtcbiAgICAgIHRoaXMucHJldmlvdXNBY3Rpb25fID0gdGhpcy5hY3Rpb247XG4gICAgICB2YXIgbmV3QWN0aW9uO1xuXG4gICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICBjYXNlIHRoaXMua2V5QWN0aW9uQWRkXzpcbiAgICAgICAgICBuZXdBY3Rpb24gPSBuZ2VvUXVlcnlBY3Rpb24uQUREO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgdGhpcy5rZXlBY3Rpb25SZW1vdmVfOlxuICAgICAgICAgIG5ld0FjdGlvbiA9IG5nZW9RdWVyeUFjdGlvbi5SRU1PVkU7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgaWYgKG5ld0FjdGlvbikge1xuICAgICAgICB0aGlzLmFjdGlvbiA9IG5ld0FjdGlvbjtcbiAgICAgICAgdGhpcy5hY3RpdmVBY3Rpb25LZXlfID0ga2V5O1xuICAgICAgICB0aGlzLnJvb3RTY29wZV8uJGFwcGx5KCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICgoTUFDID8gZXZ0Lm1ldGFLZXkgOiBldnQuY3RybEtleSkgJiYgIXRoaXMucHJldmlvdXNNb2RlXykge1xuICAgICAgdGhpcy5wcmV2aW91c01vZGVfID0gdGhpcy5tb2RlO1xuICAgICAgdGhpcy5tb2RlID0gbmdlb1F1ZXJ5TW9kZS5EUkFXX0JPWDtcbiAgICAgIHRoaXMucm9vdFNjb3BlXy4kYXBwbHkoKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUtleVVwXyA9IGZ1bmN0aW9uIGhhbmRsZUtleVVwXyhldnQpIHtcbiAgICBpZiAoIShldnQgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciB1cGRhdGVTY29wZSA9IGZhbHNlO1xuXG4gICAgaWYgKCEoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpICYmIHRoaXMucHJldmlvdXNNb2RlXykge1xuICAgICAgdGhpcy5tb2RlID0gdGhpcy5wcmV2aW91c01vZGVfO1xuICAgICAgdGhpcy5wcmV2aW91c01vZGVfID0gbnVsbDtcbiAgICAgIHVwZGF0ZVNjb3BlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIga2V5ID0gZXZ0LmtleTtcblxuICAgIGlmICh0aGlzLmFjdGl2ZUFjdGlvbktleV8gPT09IGtleSAmJiB0aGlzLnByZXZpb3VzQWN0aW9uXykge1xuICAgICAgdGhpcy5hY3Rpb24gPSB0aGlzLnByZXZpb3VzQWN0aW9uXztcbiAgICAgIHRoaXMucHJldmlvdXNBY3Rpb25fID0gbnVsbDtcbiAgICAgIHRoaXMuYWN0aXZlQWN0aW9uS2V5XyA9IG51bGw7XG4gICAgICB1cGRhdGVTY29wZSA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKHVwZGF0ZVNjb3BlKSB7XG4gICAgICB0aGlzLnJvb3RTY29wZV8uJGFwcGx5KCk7XG4gICAgfVxuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhRdWVyeU1vZGVTZWxlY3RvciwgW3tcbiAgICBrZXk6IFwiYWN0aW9uXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5hY3Rpb25fO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQoYWN0aW9uKSB7XG4gICAgICB0aGlzLmFjdGlvbl8gPSBhY3Rpb247XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm1vZGVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1vZGVfO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQobW9kZSkge1xuICAgICAgdGhpcy5tb2RlXyA9IG1vZGU7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFF1ZXJ5TW9kZVNlbGVjdG9yO1xufSgpO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvUXVlcnlNb2RlU2VsZWN0b3InLCBbXSk7XG5tb2R1bGUuc2VydmljZSgnbmdlb1F1ZXJ5TW9kZVNlbGVjdG9yJywgUXVlcnlNb2RlU2VsZWN0b3IpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9EYXRhc291cmNlT0dDIGZyb20gJ25nZW8vZGF0YXNvdXJjZS9PR0MuanMnO1xuaW1wb3J0IG5nZW9GaWx0ZXJSdWxlSGVscGVyIGZyb20gJ25nZW8vZmlsdGVyL1J1bGVIZWxwZXIuanMnO1xuaW1wb3J0IG5nZW9NaXNjV01TVGltZSBmcm9tICduZ2VvL21pc2MvV01TVGltZS5qcyc7XG5pbXBvcnQgKiBhcyBvbEZvcm1hdEZpbHRlciBmcm9tICdvbC9mb3JtYXQvZmlsdGVyLmpzJztcbmltcG9ydCBvbEZvcm1hdFdGUyBmcm9tICdvbC9mb3JtYXQvV0ZTLmpzJztcbmltcG9ydCBuZ2VvV0ZTRGVzY3JpYmVGZWF0dXJlVHlwZSBmcm9tICduZ2VvL1dGU0Rlc2NyaWJlRmVhdHVyZVR5cGUuanMnO1xuaW1wb3J0IG9sRm9ybWF0V01TQ2FwYWJpbGl0aWVzIGZyb20gJ29sL2Zvcm1hdC9XTVNDYXBhYmlsaXRpZXMuanMnO1xuaW1wb3J0IG9sRm9ybWF0V01UU0NhcGFiaWxpdGllcyBmcm9tICdvbC9mb3JtYXQvV01UU0NhcGFiaWxpdGllcy5qcyc7XG5pbXBvcnQgeyBhcHBlbmRQYXJhbXMgYXMgb2xVcmlBcHBlbmRQYXJhbXMgfSBmcm9tICdvbC91cmkuanMnO1xuaW1wb3J0ICogYXMgb2xFeHRlbnQgZnJvbSAnb2wvZXh0ZW50LmpzJztcbmltcG9ydCBvbFNvdXJjZUltYWdlV01TIGZyb20gJ29sL3NvdXJjZS9JbWFnZVdNUy5qcyc7XG5leHBvcnQgdmFyIFF1ZXJlbnQgPSBmdW5jdGlvbiAoKSB7XG4gIFF1ZXJlbnQuJGluamVjdCA9IFtcIiRodHRwXCIsIFwiJHFcIiwgXCJuZ2VvUnVsZUhlbHBlclwiLCBcIm5nZW9XTVNUaW1lXCJdO1xuXG4gIGZ1bmN0aW9uIFF1ZXJlbnQoJGh0dHAsICRxLCBuZ2VvUnVsZUhlbHBlciwgbmdlb1dNU1RpbWUpIHtcbiAgICB0aGlzLmh0dHBfID0gJGh0dHA7XG4gICAgdGhpcy5xXyA9ICRxO1xuICAgIHRoaXMubmdlb1J1bGVIZWxwZXJfID0gbmdlb1J1bGVIZWxwZXI7XG4gICAgdGhpcy5uZ2VvV01TVGltZV8gPSBuZ2VvV01TVGltZTtcbiAgICB0aGlzLnJlcXVlc3RDYW5jZWxlcnNfID0gW107XG4gICAgdGhpcy53bXNHZXRDYXBhYmlsaXRpZXNQcm9taXNlc18gPSB7fTtcbiAgICB0aGlzLndtdHNHZXRDYXBhYmlsaXRpZXNQcm9taXNlc18gPSB7fTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBRdWVyZW50LnByb3RvdHlwZTtcblxuICBfcHJvdG8uaXNzdWUgPSBmdW5jdGlvbiBpc3N1ZShvcHRpb25zKSB7XG4gICAgdmFyIHByb21pc2VzID0gW107XG4gICAgdmFyIG1hcCA9IG9wdGlvbnMubWFwO1xuICAgIHRoaXMuY2FuY2VsU3RpbGxSdW5uaW5nUmVxdWVzdHNfKCk7XG4gICAgdmFyIHF1ZXJ5YWJsZURhdGFTb3VyY2VzO1xuXG4gICAgaWYgKG9wdGlvbnMucXVlcnlhYmxlRGF0YVNvdXJjZXMpIHtcbiAgICAgIHF1ZXJ5YWJsZURhdGFTb3VyY2VzID0gb3B0aW9ucy5xdWVyeWFibGVEYXRhU291cmNlcztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGRhdGFTb3VyY2VzID0gb3B0aW9ucy5kYXRhU291cmNlcztcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KGRhdGFTb3VyY2VzLCAnRGF0YVNvdXJjZXMgc2hvdWxkIGJlIHNldCcpO1xuICAgICAgcXVlcnlhYmxlRGF0YVNvdXJjZXMgPSB0aGlzLmdldFF1ZXJ5YWJsZURhdGFTb3VyY2VzKGRhdGFTb3VyY2VzLCBtYXApO1xuICAgIH1cblxuICAgIHZhciBjb21iaW5lZFdGU0RhdGFTb3VyY2VzID0gdGhpcy5nZXRDb21iaW5hYmxlV0ZTRGF0YVNvdXJjZXNfKHF1ZXJ5YWJsZURhdGFTb3VyY2VzLndmcyk7XG4gICAgcHJvbWlzZXMucHVzaCh0aGlzLmlzc3VlQ29tYmluZWRXRlNfKGNvbWJpbmVkV0ZTRGF0YVNvdXJjZXMsIG9wdGlvbnMpKTtcbiAgICB2YXIgY29vcmRpbmF0ZSA9IG9wdGlvbnMuY29vcmRpbmF0ZTtcblxuICAgIGlmIChjb29yZGluYXRlKSB7XG4gICAgICB2YXIgY29tYmluZWRXTVNEYXRhU291cmNlcyA9IHRoaXMuZ2V0Q29tYmluYWJsZVdNU0RhdGFTb3VyY2VzXyhxdWVyeWFibGVEYXRhU291cmNlcy53bXMpO1xuICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLmlzc3VlQ29tYmluZWRXTVNfKGNvbWJpbmVkV01TRGF0YVNvdXJjZXMsIG9wdGlvbnMpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5xXy5hbGwocHJvbWlzZXMpLnRoZW4oaGFuZGxlQ29tYmluZWRRdWVyeVJlc3VsdF8pO1xuICB9O1xuXG4gIF9wcm90by5nZXRRdWVyeWFibGVEYXRhU291cmNlcyA9IGZ1bmN0aW9uIGdldFF1ZXJ5YWJsZURhdGFTb3VyY2VzKGRhdGFTb3VyY2VzLCBtYXApIHtcbiAgICB2YXIgcXVlcnlhYmxlRGF0YVNvdXJjZXMgPSB7XG4gICAgICB3ZnM6IFtdLFxuICAgICAgd21zOiBbXVxuICAgIH07XG4gICAgdmFyIHJlc29sdXRpb24gPSBtYXAuZ2V0VmlldygpLmdldFJlc29sdXRpb24oKTtcblxuICAgIGlmIChyZXNvbHV0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyByZXNvbHV0aW9uJyk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gZGF0YVNvdXJjZXMsIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IpLCBfaSA9IDAsIF9pdGVyYXRvciA9IF9pc0FycmF5ID8gX2l0ZXJhdG9yIDogX2l0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjtcblxuICAgICAgaWYgKF9pc0FycmF5KSB7XG4gICAgICAgIGlmIChfaSA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pdGVyYXRvcltfaSsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pID0gX2l0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgaWYgKF9pLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmID0gX2kudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBkYXRhU291cmNlID0gX3JlZjtcblxuICAgICAgaWYgKCF0aGlzLmlzRGF0YVNvdXJjZVF1ZXJ5YWJsZV8oZGF0YVNvdXJjZSwgcmVzb2x1dGlvbikpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChkYXRhU291cmNlIGluc3RhbmNlb2Ygbmdlb0RhdGFzb3VyY2VPR0MpIHtcbiAgICAgICAgaWYgKGRhdGFTb3VyY2Uuc3VwcG9ydHNXRlMpIHtcbiAgICAgICAgICBxdWVyeWFibGVEYXRhU291cmNlcy53ZnMucHVzaChkYXRhU291cmNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBxdWVyeWFibGVEYXRhU291cmNlcy53bXMucHVzaChkYXRhU291cmNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBxdWVyeWFibGVEYXRhU291cmNlcztcbiAgfTtcblxuICBfcHJvdG8ud2ZzRGVzY3JpYmVGZWF0dXJlVHlwZSA9IGZ1bmN0aW9uIHdmc0Rlc2NyaWJlRmVhdHVyZVR5cGUoZGF0YVNvdXJjZSkge1xuICAgIGlmICghZGF0YVNvdXJjZS5zdXBwb3J0c0F0dHJpYnV0ZXMpIHtcbiAgICAgIHRocm93IFwiVGhlIGRhdGEgc291cmNlIG11c3Qgc3VwcG9ydCBXRlMsIGhhdmUgYSBzaW5nbGUgT0dDTGF5ZXIgdGhhdFxcbiAgICAgIGlzIHF1ZXJ5YWJsZSBpbiBvcmRlciB0byBpc3N1ZSBXRlMgRGVzY3JpYmVGZWF0dXJlVHlwZSByZXF1ZXN0c1wiO1xuICAgIH1cblxuICAgIGlmICghZGF0YVNvdXJjZS53ZnNVcmwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBXRlMgVVJMJyk7XG4gICAgfVxuXG4gICAgdmFyIHdmc0xheWVyTmFtZXMgPSBkYXRhU291cmNlLmdldFdGU0xheWVyTmFtZXMoKTtcbiAgICB2YXIgdXJsID0gb2xVcmlBcHBlbmRQYXJhbXMoZGF0YVNvdXJjZS53ZnNVcmwsIHtcbiAgICAgICdSRVFVRVNUJzogJ0Rlc2NyaWJlRmVhdHVyZVR5cGUnLFxuICAgICAgJ1NFUlZJQ0UnOiAnV0ZTJyxcbiAgICAgICdWRVJTSU9OJzogJzIuMC4wJyxcbiAgICAgICdUWVBFTkFNRSc6IHdmc0xheWVyTmFtZXNcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5odHRwXy5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgdmFyIGZvcm1hdCA9IG5ldyBuZ2VvV0ZTRGVzY3JpYmVGZWF0dXJlVHlwZSgpO1xuICAgICAgcmV0dXJuIGZvcm1hdC5yZWFkKHJlc3BvbnNlLmRhdGEpO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by53bXNGaW5kTGF5ZXJDYXBhYmlsaXR5ID0gZnVuY3Rpb24gd21zRmluZExheWVyQ2FwYWJpbGl0eShsYXllckNhcGFiaWxpdGllcywgbGF5ZXJOYW1lKSB7XG4gICAgdmFyIGZvdW5kID0gbnVsbDtcblxuICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSBsYXllckNhcGFiaWxpdGllcywgX2lzQXJyYXkyID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IyKSwgX2kyID0gMCwgX2l0ZXJhdG9yMiA9IF9pc0FycmF5MiA/IF9pdGVyYXRvcjIgOiBfaXRlcmF0b3IyW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjI7XG5cbiAgICAgIGlmIChfaXNBcnJheTIpIHtcbiAgICAgICAgaWYgKF9pMiA+PSBfaXRlcmF0b3IyLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYyID0gX2l0ZXJhdG9yMltfaTIrK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaTIgPSBfaXRlcmF0b3IyLm5leHQoKTtcbiAgICAgICAgaWYgKF9pMi5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZjIgPSBfaTIudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBsYXllckNhcGFiaWxpdHkgPSBfcmVmMjtcblxuICAgICAgaWYgKGxheWVyQ2FwYWJpbGl0eS5OYW1lID09PSBsYXllck5hbWUpIHtcbiAgICAgICAgZm91bmQgPSBsYXllckNhcGFiaWxpdHk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBlbHNlIGlmIChsYXllckNhcGFiaWxpdHkuTGF5ZXIpIHtcbiAgICAgICAgZm91bmQgPSB0aGlzLndtc0ZpbmRMYXllckNhcGFiaWxpdHkobGF5ZXJDYXBhYmlsaXR5LkxheWVyLCBsYXllck5hbWUpO1xuXG4gICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZvdW5kO1xuICB9O1xuXG4gIF9wcm90by53bXNHZXRDYXBhYmlsaXRpZXMgPSBmdW5jdGlvbiB3bXNHZXRDYXBhYmlsaXRpZXMoYmFzZVVybCwgb3B0X2NhY2hlKSB7XG4gICAgdmFyIGNhY2hlID0gb3B0X2NhY2hlICE9PSBmYWxzZTtcbiAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgJ1JFUVVFU1QnOiAnR2V0Q2FwYWJpbGl0aWVzJyxcbiAgICAgICdTRVJWSUNFJzogJ1dNUycsXG4gICAgICAnVkVSU0lPTic6ICcxLjMuMCdcbiAgICB9O1xuICAgIHZhciB1cmwgPSBvbFVyaUFwcGVuZFBhcmFtcyhiYXNlVXJsLCBwYXJhbXMpO1xuICAgIHZhciBwcm9taXNlO1xuXG4gICAgaWYgKCFjYWNoZSB8fCAhdGhpcy53bXNHZXRDYXBhYmlsaXRpZXNQcm9taXNlc19bYmFzZVVybF0pIHtcbiAgICAgIHByb21pc2UgPSB0aGlzLmh0dHBfLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHZhciBmb3JtYXQgPSBuZXcgb2xGb3JtYXRXTVNDYXBhYmlsaXRpZXMoKTtcbiAgICAgICAgcmV0dXJuIGZvcm1hdC5yZWFkKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChjYWNoZSAmJiB0aGlzLndtc0dldENhcGFiaWxpdGllc1Byb21pc2VzX1tiYXNlVXJsXSkge1xuICAgICAgcHJvbWlzZSA9IHRoaXMud21zR2V0Q2FwYWJpbGl0aWVzUHJvbWlzZXNfW2Jhc2VVcmxdO1xuICAgIH1cblxuICAgIGlmICghcHJvbWlzZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHByb21pc2UnKTtcbiAgICB9XG5cbiAgICBpZiAoY2FjaGUgJiYgIXRoaXMud21zR2V0Q2FwYWJpbGl0aWVzUHJvbWlzZXNfW2Jhc2VVcmxdKSB7XG4gICAgICB0aGlzLndtc0dldENhcGFiaWxpdGllc1Byb21pc2VzX1tiYXNlVXJsXSA9IHByb21pc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH07XG5cbiAgX3Byb3RvLndtdHNGaW5kTGF5ZXJDYXBhYmlsaXR5ID0gZnVuY3Rpb24gd210c0ZpbmRMYXllckNhcGFiaWxpdHkobGF5ZXJDYXBhYmlsaXRpZXMsIGxheWVyTmFtZSkge1xuICAgIHZhciBmb3VuZCA9IG51bGw7XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IzID0gbGF5ZXJDYXBhYmlsaXRpZXMsIF9pc0FycmF5MyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMyksIF9pMyA9IDAsIF9pdGVyYXRvcjMgPSBfaXNBcnJheTMgPyBfaXRlcmF0b3IzIDogX2l0ZXJhdG9yM1tTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYzO1xuXG4gICAgICBpZiAoX2lzQXJyYXkzKSB7XG4gICAgICAgIGlmIChfaTMgPj0gX2l0ZXJhdG9yMy5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmMyA9IF9pdGVyYXRvcjNbX2kzKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kzID0gX2l0ZXJhdG9yMy5uZXh0KCk7XG4gICAgICAgIGlmIChfaTMuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYzID0gX2kzLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgbGF5ZXJDYXBhYmlsaXR5ID0gX3JlZjM7XG5cbiAgICAgIGlmIChsYXllckNhcGFiaWxpdHkuSWRlbnRpZmllciA9PT0gbGF5ZXJOYW1lKSB7XG4gICAgICAgIGZvdW5kID0gbGF5ZXJDYXBhYmlsaXR5O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZm91bmQ7XG4gIH07XG5cbiAgX3Byb3RvLndtdHNHZXRDYXBhYmlsaXRpZXMgPSBmdW5jdGlvbiB3bXRzR2V0Q2FwYWJpbGl0aWVzKHVybCwgb3B0X2NhY2hlKSB7XG4gICAgdmFyIGNhY2hlID0gb3B0X2NhY2hlICE9PSBmYWxzZTtcbiAgICB2YXIgcHJvbWlzZTtcblxuICAgIGlmICghY2FjaGUgfHwgIXRoaXMud210c0dldENhcGFiaWxpdGllc1Byb21pc2VzX1t1cmxdKSB7XG4gICAgICBwcm9taXNlID0gdGhpcy5odHRwXy5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICB2YXIgZm9ybWF0ID0gbmV3IG9sRm9ybWF0V01UU0NhcGFiaWxpdGllcygpO1xuICAgICAgICByZXR1cm4gZm9ybWF0LnJlYWQocmVzcG9uc2UuZGF0YSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGNhY2hlICYmIHRoaXMud210c0dldENhcGFiaWxpdGllc1Byb21pc2VzX1t1cmxdKSB7XG4gICAgICBwcm9taXNlID0gdGhpcy53bXRzR2V0Q2FwYWJpbGl0aWVzUHJvbWlzZXNfW3VybF07XG4gICAgfVxuXG4gICAgaWYgKCFwcm9taXNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcHJvbWlzZScpO1xuICAgIH1cblxuICAgIGlmIChjYWNoZSAmJiAhdGhpcy53bXRzR2V0Q2FwYWJpbGl0aWVzUHJvbWlzZXNfW3VybF0pIHtcbiAgICAgIHRoaXMud210c0dldENhcGFiaWxpdGllc1Byb21pc2VzX1t1cmxdID0gcHJvbWlzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJvbWlzZTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlUXVlcnlSZXN1bHRfID0gZnVuY3Rpb24gaGFuZGxlUXVlcnlSZXN1bHRfKGRhdGFTb3VyY2VzLCBsaW1pdCwgd2ZzLCByZXNwb25zZSkge1xuICAgIHZhciBoYXNoID0ge307XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3I0ID0gZGF0YVNvdXJjZXMsIF9pc0FycmF5NCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNCksIF9pNCA9IDAsIF9pdGVyYXRvcjQgPSBfaXNBcnJheTQgPyBfaXRlcmF0b3I0IDogX2l0ZXJhdG9yNFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY0O1xuXG4gICAgICBpZiAoX2lzQXJyYXk0KSB7XG4gICAgICAgIGlmIChfaTQgPj0gX2l0ZXJhdG9yNC5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmNCA9IF9pdGVyYXRvcjRbX2k0KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k0ID0gX2l0ZXJhdG9yNC5uZXh0KCk7XG4gICAgICAgIGlmIChfaTQuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWY0ID0gX2k0LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGF0YVNvdXJjZSA9IF9yZWY0O1xuICAgICAgdmFyIGRhdGFTb3VyY2VJZCA9IGRhdGFTb3VyY2UuaWQ7XG5cbiAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2UgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHZhciBmZWF0dXJlcyA9IFtdO1xuICAgICAgICB2YXIgdG9vTWFueUZlYXR1cmVzID0gdHJ1ZTtcbiAgICAgICAgdmFyIHRvdGFsRmVhdHVyZUNvdW50ID0gcmVzcG9uc2U7XG4gICAgICAgIHRoaXMuc2V0VW5pcXVlSWRzXyhmZWF0dXJlcywgZGF0YVNvdXJjZS5pZCk7XG4gICAgICAgIGhhc2hbZGF0YVNvdXJjZUlkXSA9IHtcbiAgICAgICAgICBmZWF0dXJlczogZmVhdHVyZXMsXG4gICAgICAgICAgbGltaXQ6IGxpbWl0LFxuICAgICAgICAgIHRvb01hbnlGZWF0dXJlczogdG9vTWFueUZlYXR1cmVzLFxuICAgICAgICAgIHRvdGFsRmVhdHVyZUNvdW50OiB0b3RhbEZlYXR1cmVDb3VudFxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIF9mZWF0dXJlcyA9IGRhdGFTb3VyY2UgaW5zdGFuY2VvZiBuZ2VvRGF0YXNvdXJjZU9HQyA/IHRoaXMucmVhZEFuZFR5cGVGZWF0dXJlc18oZGF0YVNvdXJjZSwgcmVzcG9uc2UuZGF0YSwgd2ZzKSA6IFtdO1xuXG4gICAgICAgIHRoaXMuc2V0VW5pcXVlSWRzXyhfZmVhdHVyZXMsIGRhdGFTb3VyY2UuaWQpO1xuICAgICAgICBoYXNoW2RhdGFTb3VyY2VJZF0gPSB7XG4gICAgICAgICAgZmVhdHVyZXM6IF9mZWF0dXJlcyxcbiAgICAgICAgICBsaW1pdDogbGltaXRcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaGFzaDtcbiAgfTtcblxuICBfcHJvdG8ucmVhZEFuZFR5cGVGZWF0dXJlc18gPSBmdW5jdGlvbiByZWFkQW5kVHlwZUZlYXR1cmVzXyhkYXRhU291cmNlLCBkYXRhLCB3ZnMpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdmFyIGZlYXR1cmVzID0gW107XG4gICAgdmFyIHJlYWRGZWF0dXJlcztcbiAgICB2YXIgZmVhdHVyZVR5cGVzID0gdGhpcy5nZXRTZXRPbEZvcm1hdFR5cGVzXyhkYXRhU291cmNlLCB3ZnMpLnNsaWNlKCk7XG4gICAgZmVhdHVyZVR5cGVzLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgIF90aGlzLmdldFNldE9sRm9ybWF0VHlwZXNfKGRhdGFTb3VyY2UsIHdmcywgW3R5cGVdKTtcblxuICAgICAgaWYgKHdmcykge1xuICAgICAgICBpZiAoIWRhdGFTb3VyY2Uud2ZzRm9ybWF0KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHdmc0Zvcm1hdCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVhZEZlYXR1cmVzID0gZGF0YVNvdXJjZS53ZnNGb3JtYXQucmVhZEZlYXR1cmVzKGRhdGEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFkYXRhU291cmNlLndtc0Zvcm1hdCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB3bXNGb3JtYXQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlYWRGZWF0dXJlcyA9IGRhdGFTb3VyY2Uud21zRm9ybWF0LnJlYWRGZWF0dXJlcyhkYXRhKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJlYWRGZWF0dXJlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlYWRGZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgICAgICAgZmVhdHVyZS5zZXQoJ25nZW9fZmVhdHVyZV90eXBlXycsIHR5cGUpO1xuICAgICAgICAgIGZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuZ2V0U2V0T2xGb3JtYXRUeXBlc18oZGF0YVNvdXJjZSwgd2ZzLCBmZWF0dXJlVHlwZXMpO1xuICAgIHJldHVybiBmZWF0dXJlcztcbiAgfTtcblxuICBfcHJvdG8uZ2V0U2V0T2xGb3JtYXRUeXBlc18gPSBmdW5jdGlvbiBnZXRTZXRPbEZvcm1hdFR5cGVzXyhkYXRhU291cmNlLCB3ZnMsIG9wdF90eXBlcykge1xuICAgIHZhciB0eXBlcztcblxuICAgIGlmICh3ZnMpIHtcbiAgICAgIGlmICghZGF0YVNvdXJjZS53ZnNGb3JtYXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHdmc0Zvcm1hdCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0X3R5cGVzKSB7XG4gICAgICAgIGRhdGFTb3VyY2Uud2ZzRm9ybWF0LnNldEZlYXR1cmVUeXBlKG9wdF90eXBlcyk7XG4gICAgICB9XG5cbiAgICAgIHR5cGVzID0gZGF0YVNvdXJjZS53ZnNGb3JtYXQuZ2V0RmVhdHVyZVR5cGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFkYXRhU291cmNlLndtc0Zvcm1hdCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgd21zRm9ybWF0Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRfdHlwZXMpIHtcbiAgICAgICAgZGF0YVNvdXJjZS53bXNGb3JtYXQuc2V0TGF5ZXJzKG9wdF90eXBlcyk7XG4gICAgICB9XG5cbiAgICAgIHR5cGVzID0gZGF0YVNvdXJjZS53bXNGb3JtYXQuZ2V0TGF5ZXJzKCk7XG4gICAgfVxuXG4gICAgaWYgKCF0eXBlcykge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHR5cGVzKSA/IHR5cGVzIDogW3R5cGVzXTtcbiAgfTtcblxuICBfcHJvdG8uaXNzdWVDb21iaW5lZFdGU18gPSBmdW5jdGlvbiBpc3N1ZUNvbWJpbmVkV0ZTXyhjb21iaW5lZERhdGFTb3VyY2VzLCBvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgcHJvbWlzZXMgPSBbXTtcbiAgICB2YXIgbWF4RmVhdHVyZXMgPSBvcHRpb25zLmxpbWl0O1xuICAgIHZhciBtYXAgPSBvcHRpb25zLm1hcDtcbiAgICB2YXIgdmlldyA9IG1hcC5nZXRWaWV3KCk7XG4gICAgdmFyIHJlc29sdXRpb24gPSB2aWV3LmdldFJlc29sdXRpb24oKTtcbiAgICB2YXIgcHJvamVjdGlvbiA9IHZpZXcuZ2V0UHJvamVjdGlvbigpO1xuICAgIHZhciBzcnNOYW1lID0gcHJvamVjdGlvbi5nZXRDb2RlKCk7XG4gICAgdmFyIHdmc0NvdW50ID0gZmFsc2U7XG5cbiAgICBpZiAocmVzb2x1dGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVzb2x1dGlvbicpO1xuICAgIH1cblxuICAgIHZhciBiYm94O1xuICAgIHZhciBjb29yZGluYXRlID0gb3B0aW9ucy5jb29yZGluYXRlO1xuXG4gICAgaWYgKGNvb3JkaW5hdGUpIHtcbiAgICAgIHZhciB0b2xlcmFuY2VQeCA9IG9wdGlvbnMudG9sZXJhbmNlUHg7XG4gICAgICBjb25zb2xlLmFzc2VydCh0b2xlcmFuY2VQeCk7XG4gICAgICB2YXIgdG9sZXJhbmNlID0gdG9sZXJhbmNlUHggKiByZXNvbHV0aW9uO1xuICAgICAgYmJveCA9IG9sRXh0ZW50LmJ1ZmZlcihvbEV4dGVudC5jcmVhdGVPclVwZGF0ZUZyb21Db29yZGluYXRlKGNvb3JkaW5hdGUpLCB0b2xlcmFuY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBiYm94ID0gb3B0aW9ucy5leHRlbnQ7XG4gICAgfVxuXG4gICAgdmFyIHdmc0Zvcm1hdCA9IG5ldyBvbEZvcm1hdFdGUygpO1xuICAgIHZhciB4bWxTZXJpYWxpemVyID0gbmV3IFhNTFNlcmlhbGl6ZXIoKTtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKCkge1xuICAgICAgaWYgKF9pc0FycmF5NSkge1xuICAgICAgICBpZiAoX2k1ID49IF9pdGVyYXRvcjUubGVuZ3RoKSByZXR1cm4gXCJicmVha1wiO1xuICAgICAgICBfcmVmNSA9IF9pdGVyYXRvcjVbX2k1KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k1ID0gX2l0ZXJhdG9yNS5uZXh0KCk7XG4gICAgICAgIGlmIChfaTUuZG9uZSkgcmV0dXJuIFwiYnJlYWtcIjtcbiAgICAgICAgX3JlZjUgPSBfaTUudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBkYXRhU291cmNlcyA9IF9yZWY1O1xuICAgICAgdmFyIGdldEZlYXR1cmVDb21tb25PcHRpb25zID0gbnVsbDtcbiAgICAgIHZhciBmZWF0dXJlVHlwZXMgPSBbXTtcbiAgICAgIHZhciB1cmwgPSBudWxsO1xuICAgICAgdmFyIHBhcmFtcyA9IHt9O1xuXG4gICAgICBpZiAob3B0aW9ucy5iYm94QXNHRVRQYXJhbSAmJiBiYm94KSB7XG4gICAgICAgIHBhcmFtcy5iYm94ID0gYmJveC5qb2luKCcsJyk7XG4gICAgICB9XG5cbiAgICAgIGZvciAodmFyIF9pdGVyYXRvcjYgPSBkYXRhU291cmNlcywgX2lzQXJyYXk2ID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3I2KSwgX2k2ID0gMCwgX2l0ZXJhdG9yNiA9IF9pc0FycmF5NiA/IF9pdGVyYXRvcjYgOiBfaXRlcmF0b3I2W1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgIHZhciBfcmVmNjtcblxuICAgICAgICBpZiAoX2lzQXJyYXk2KSB7XG4gICAgICAgICAgaWYgKF9pNiA+PSBfaXRlcmF0b3I2Lmxlbmd0aCkgYnJlYWs7XG4gICAgICAgICAgX3JlZjYgPSBfaXRlcmF0b3I2W19pNisrXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfaTYgPSBfaXRlcmF0b3I2Lm5leHQoKTtcbiAgICAgICAgICBpZiAoX2k2LmRvbmUpIGJyZWFrO1xuICAgICAgICAgIF9yZWY2ID0gX2k2LnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBfcmVmNjtcbiAgICAgICAgdmFyIGN1cnJlbnRGZWF0dXJlVHlwZXMgPSBkYXRhU291cmNlLmdldEluUmFuZ2VXRlNMYXllck5hbWVzKHJlc29sdXRpb24sIHRydWUpO1xuXG4gICAgICAgIGlmICghZ2V0RmVhdHVyZUNvbW1vbk9wdGlvbnMpIHtcbiAgICAgICAgICB2YXIgZmVhdHVyZU5TID0gZGF0YVNvdXJjZS53ZnNGZWF0dXJlTlM7XG4gICAgICAgICAgdmFyIGZlYXR1cmVQcmVmaXggPSBkYXRhU291cmNlLndmc0ZlYXR1cmVQcmVmaXg7XG4gICAgICAgICAgdmFyIGdlb21ldHJ5TmFtZSA9IGRhdGFTb3VyY2UuZ2VvbWV0cnlOYW1lKGN1cnJlbnRGZWF0dXJlVHlwZXNbMF0pO1xuICAgICAgICAgIHZhciBvdXRwdXRGb3JtYXQgPSBkYXRhU291cmNlLndmc091dHB1dEZvcm1hdDtcblxuICAgICAgICAgIGlmICghZ2VvbWV0cnlOYW1lKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZ2VvbWV0cnlOYW1lJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZ2V0RmVhdHVyZUNvbW1vbk9wdGlvbnMgPSB7XG4gICAgICAgICAgICBiYm94OiBiYm94LFxuICAgICAgICAgICAgZmVhdHVyZU5TOiBmZWF0dXJlTlMsXG4gICAgICAgICAgICBmZWF0dXJlUHJlZml4OiBmZWF0dXJlUHJlZml4LFxuICAgICAgICAgICAgZ2VvbWV0cnlOYW1lOiBnZW9tZXRyeU5hbWUsXG4gICAgICAgICAgICBvdXRwdXRGb3JtYXQ6IG91dHB1dEZvcm1hdCxcbiAgICAgICAgICAgIHNyc05hbWU6IHNyc05hbWUsXG4gICAgICAgICAgICBmZWF0dXJlVHlwZXM6IFtdXG4gICAgICAgICAgfTtcbiAgICAgICAgICB1cmwgPSBkYXRhU291cmNlLndmc1VybDtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgZGF0YVNvdXJjZS5hY3RpdmVEaW1lbnNpb25zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZlYXR1cmVUeXBlcyA9IGZlYXR1cmVUeXBlcy5jb25jYXQoY3VycmVudEZlYXR1cmVUeXBlcyk7XG4gICAgICAgIHZhciBmaWx0ZXIgPSBudWxsO1xuXG4gICAgICAgIGlmIChvcHRpb25zLmZpbHRlcikge1xuICAgICAgICAgIGZpbHRlciA9IF90aGlzMi5uZ2VvUnVsZUhlbHBlcl8uY3JlYXRlRmlsdGVyKHtcbiAgICAgICAgICAgIGRhdGFTb3VyY2U6IGRhdGFTb3VyY2UsXG4gICAgICAgICAgICBmaWx0ZXI6IG9wdGlvbnMuZmlsdGVyLFxuICAgICAgICAgICAgaW5jRGltZW5zaW9uczogdHJ1ZSxcbiAgICAgICAgICAgIGluY1RpbWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChkYXRhU291cmNlLmZpbHRlclJ1bGVzICYmIGRhdGFTb3VyY2UuZmlsdGVyUnVsZXMubGVuZ3RoIHx8IGRhdGFTb3VyY2UudGltZVJhbmdlVmFsdWUgfHwgZGF0YVNvdXJjZS5kaW1lbnNpb25zRmlsdGVyc0NvbmZpZyAmJiBPYmplY3Qua2V5cyhkYXRhU291cmNlLmRpbWVuc2lvbnNGaWx0ZXJzQ29uZmlnKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5hc3NlcnQoZGF0YVNvdXJjZXMubGVuZ3RoID09PSAxLCBcIkEgZGF0YSBzb3VyY2UgaGF2aW5nIGZpbHRlclJ1bGVzIG9yIHRpbWVSYW5nZVZhbHVlIHNob3VsZCBpc3N1ZVxcbiAgICAgICAgICAgIGEgc2luZ2xlIHF1ZXJ5LCBhbG9uZS5cIik7XG4gICAgICAgICAgZmlsdGVyID0gX3RoaXMyLm5nZW9SdWxlSGVscGVyXy5jcmVhdGVGaWx0ZXIoe1xuICAgICAgICAgICAgZGF0YVNvdXJjZTogZGF0YVNvdXJjZSxcbiAgICAgICAgICAgIGluY0RpbWVuc2lvbnM6IHRydWUsXG4gICAgICAgICAgICBpbmNUaW1lOiB0cnVlLFxuICAgICAgICAgICAgc3JzTmFtZTogc3JzTmFtZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuZ2VvbWV0cnkpIHtcbiAgICAgICAgICB2YXIgc3BhdGlhbEZpbHRlciA9IG9sRm9ybWF0RmlsdGVyLmludGVyc2VjdHMoZGF0YVNvdXJjZS5nZW9tZXRyeU5hbWUoKSwgb3B0aW9ucy5nZW9tZXRyeSwgc3JzTmFtZSk7XG4gICAgICAgICAgZmlsdGVyID0gX3RoaXMyLm5nZW9SdWxlSGVscGVyXy5qb2luRmlsdGVycyhmaWx0ZXIsIHNwYXRpYWxGaWx0ZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZpbHRlcikge1xuICAgICAgICAgIGdldEZlYXR1cmVDb21tb25PcHRpb25zLmZpbHRlciA9IGZpbHRlcjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIWdldEZlYXR1cmVDb21tb25PcHRpb25zKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBnZXRGZWF0dXJlQ29tbW9uT3B0aW9ucycpO1xuICAgICAgfVxuXG4gICAgICBnZXRGZWF0dXJlQ29tbW9uT3B0aW9ucy5mZWF0dXJlVHlwZXMgPSBmZWF0dXJlVHlwZXM7XG5cbiAgICAgIGlmICghdXJsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB1cmwnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGdldEZlYXR1cmVEZWZlciA9IF90aGlzMi5xXy5kZWZlcigpO1xuXG4gICAgICBwcm9taXNlcy5wdXNoKGdldEZlYXR1cmVEZWZlci5wcm9taXNlLnRoZW4oX3RoaXMyLmhhbmRsZVF1ZXJ5UmVzdWx0Xy5iaW5kKF90aGlzMiwgZGF0YVNvdXJjZXMsIG1heEZlYXR1cmVzLCB0cnVlKSkpO1xuICAgICAgdmFyIGNvdW50UHJvbWlzZSA9IHZvaWQgMDtcblxuICAgICAgaWYgKHdmc0NvdW50KSB7XG4gICAgICAgIHZhciBnZXRDb3VudE9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgICAgICByZXN1bHRUeXBlOiAnaGl0cydcbiAgICAgICAgfSwgZ2V0RmVhdHVyZUNvbW1vbk9wdGlvbnMpO1xuICAgICAgICB2YXIgZmVhdHVyZUNvdW50WG1sID0gd2ZzRm9ybWF0LndyaXRlR2V0RmVhdHVyZShnZXRDb3VudE9wdGlvbnMpO1xuICAgICAgICB2YXIgZmVhdHVyZUNvdW50UmVxdWVzdCA9IHhtbFNlcmlhbGl6ZXIuc2VyaWFsaXplVG9TdHJpbmcoZmVhdHVyZUNvdW50WG1sKTtcblxuICAgICAgICB2YXIgY2FuY2VsZXIgPSBfdGhpczIucmVnaXN0ZXJDYW5jZWxlcl8oKTtcblxuICAgICAgICBjb3VudFByb21pc2UgPSBfdGhpczIuaHR0cF8ucG9zdCh1cmwsIGZlYXR1cmVDb3VudFJlcXVlc3QsIHtcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ3RleHQveG1sOyBjaGFyc2V0PVVURi04J1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdGltZW91dDogY2FuY2VsZXIucHJvbWlzZVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmICghZGF0YVNvdXJjZXNbMF0ud2ZzRm9ybWF0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3Npbmcgd2ZzRm9ybWF0Jyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIG1ldGEgPSBkYXRhU291cmNlc1swXS53ZnNGb3JtYXQucmVhZEZlYXR1cmVDb2xsZWN0aW9uTWV0YWRhdGEocmVzcG9uc2UuZGF0YSk7XG5cbiAgICAgICAgICBpZiAoIW1ldGEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtZXRhJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIG1ldGEubnVtYmVyT2ZGZWF0dXJlcztcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb3VudFByb21pc2UgPSBfdGhpczIucV8ucmVzb2x2ZSgpO1xuICAgICAgfVxuXG4gICAgICB2YXIgYWZ0ZXJDb3VudF8gPSBmdW5jdGlvbiBhZnRlckNvdW50XyhudW1iZXJPZkZlYXR1cmVzKSB7XG4gICAgICAgIGlmIChudW1iZXJPZkZlYXR1cmVzID09PSB1bmRlZmluZWQgfHwgbnVtYmVyT2ZGZWF0dXJlcyA8IG1heEZlYXR1cmVzKSB7XG4gICAgICAgICAgdmFyIGdldEZlYXR1cmVPcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICBtYXhGZWF0dXJlczogbWF4RmVhdHVyZXNcbiAgICAgICAgICB9LCBnZXRGZWF0dXJlQ29tbW9uT3B0aW9ucyk7XG4gICAgICAgICAgdmFyIGZlYXR1cmVSZXF1ZXN0WG1sID0gd2ZzRm9ybWF0LndyaXRlR2V0RmVhdHVyZShnZXRGZWF0dXJlT3B0aW9ucyk7XG4gICAgICAgICAgdmFyIGZlYXR1cmVSZXF1ZXN0ID0geG1sU2VyaWFsaXplci5zZXJpYWxpemVUb1N0cmluZyhmZWF0dXJlUmVxdWVzdFhtbCk7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIHVybCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgVVJMIHR5cGUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgX2NhbmNlbGVyID0gX3RoaXMyLnJlZ2lzdGVyQ2FuY2VsZXJfKCk7XG5cbiAgICAgICAgICBfdGhpczIuaHR0cF8ucG9zdCh1cmwsIGZlYXR1cmVSZXF1ZXN0LCB7XG4gICAgICAgICAgICBwYXJhbXM6IHBhcmFtcyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3htbDsgY2hhcnNldD1VVEYtOCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aW1lb3V0OiBfY2FuY2VsZXIucHJvbWlzZVxuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBnZXRGZWF0dXJlRGVmZXIucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ2V0RmVhdHVyZURlZmVyLnJlc29sdmUobnVtYmVyT2ZGZWF0dXJlcyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG5cbiAgICAgIGNvdW50UHJvbWlzZS50aGVuKGFmdGVyQ291bnRfKTtcbiAgICB9O1xuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yNSA9IGNvbWJpbmVkRGF0YVNvdXJjZXMsIF9pc0FycmF5NSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNSksIF9pNSA9IDAsIF9pdGVyYXRvcjUgPSBfaXNBcnJheTUgPyBfaXRlcmF0b3I1IDogX2l0ZXJhdG9yNVtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY1O1xuXG4gICAgICB2YXIgX3JldCA9IF9sb29wKCk7XG5cbiAgICAgIGlmIChfcmV0ID09PSBcImJyZWFrXCIpIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnFfLmFsbChwcm9taXNlcykudGhlbihoYW5kbGVDb21iaW5lZFF1ZXJ5UmVzdWx0Xyk7XG4gIH07XG5cbiAgX3Byb3RvLmlzc3VlQ29tYmluZWRXTVNfID0gZnVuY3Rpb24gaXNzdWVDb21iaW5lZFdNU18oY29tYmluZWREYXRhU291cmNlcywgb3B0aW9ucykge1xuICAgIHZhciBwcm9taXNlcyA9IFtdO1xuICAgIHZhciBGRUFUVVJFX0NPVU5UID0gb3B0aW9ucy5saW1pdDtcbiAgICB2YXIgbWFwID0gb3B0aW9ucy5tYXA7XG4gICAgdmFyIHZpZXcgPSBtYXAuZ2V0VmlldygpO1xuICAgIHZhciByZXNvbHV0aW9uID0gdmlldy5nZXRSZXNvbHV0aW9uKCk7XG4gICAgdmFyIHByb2plY3Rpb24gPSB2aWV3LmdldFByb2plY3Rpb24oKTtcbiAgICB2YXIgcHJvakNvZGUgPSBwcm9qZWN0aW9uLmdldENvZGUoKTtcblxuICAgIGlmIChyZXNvbHV0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyByZXNvbHV0aW9uJyk7XG4gICAgfVxuXG4gICAgdmFyIGNvb3JkaW5hdGUgPSBvcHRpb25zLmNvb3JkaW5hdGU7XG5cbiAgICBpZiAoIWNvb3JkaW5hdGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjb29yZGluYXRlJyk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yNyA9IGNvbWJpbmVkRGF0YVNvdXJjZXMsIF9pc0FycmF5NyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yNyksIF9pNyA9IDAsIF9pdGVyYXRvcjcgPSBfaXNBcnJheTcgPyBfaXRlcmF0b3I3IDogX2l0ZXJhdG9yN1tTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY3O1xuXG4gICAgICBpZiAoX2lzQXJyYXk3KSB7XG4gICAgICAgIGlmIChfaTcgPj0gX2l0ZXJhdG9yNy5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmNyA9IF9pdGVyYXRvcjdbX2k3KytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2k3ID0gX2l0ZXJhdG9yNy5uZXh0KCk7XG4gICAgICAgIGlmIChfaTcuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWY3ID0gX2k3LnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGF0YVNvdXJjZXMgPSBfcmVmNztcbiAgICAgIHZhciB1cmwgPSB2b2lkIDA7XG4gICAgICB2YXIgTEFZRVJTID0gW107XG4gICAgICB2YXIgSU5GT19GT1JNQVQgPSB2b2lkIDA7XG4gICAgICB2YXIgYWN0aXZlRGltZW5zaW9uc1NldCA9IGZhbHNlO1xuICAgICAgdmFyIHBhcmFtcyA9IHt9O1xuICAgICAgdmFyIGZpbHRlclN0cmluZyA9IG51bGw7XG4gICAgICB2YXIgZmlsdHJhYmxlTGF5ZXJOYW1lID0gbnVsbDtcblxuICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yOCA9IGRhdGFTb3VyY2VzLCBfaXNBcnJheTggPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjgpLCBfaTggPSAwLCBfaXRlcmF0b3I4ID0gX2lzQXJyYXk4ID8gX2l0ZXJhdG9yOCA6IF9pdGVyYXRvcjhbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgICAgdmFyIF9yZWY4O1xuXG4gICAgICAgIGlmIChfaXNBcnJheTgpIHtcbiAgICAgICAgICBpZiAoX2k4ID49IF9pdGVyYXRvcjgubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICBfcmVmOCA9IF9pdGVyYXRvcjhbX2k4KytdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9pOCA9IF9pdGVyYXRvcjgubmV4dCgpO1xuICAgICAgICAgIGlmIChfaTguZG9uZSkgYnJlYWs7XG4gICAgICAgICAgX3JlZjggPSBfaTgudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IF9yZWY4O1xuXG4gICAgICAgIGlmICghSU5GT19GT1JNQVQpIHtcbiAgICAgICAgICBJTkZPX0ZPUk1BVCA9IGRhdGFTb3VyY2Uud21zSW5mb0Zvcm1hdDtcbiAgICAgICAgICB1cmwgPSBkYXRhU291cmNlLndtc1VybDtcbiAgICAgICAgfVxuXG4gICAgICAgIExBWUVSUyA9IExBWUVSUy5jb25jYXQoZGF0YVNvdXJjZS5nZXRXTVNMYXllck5hbWVzKHRydWUpKTtcblxuICAgICAgICBpZiAoIWFjdGl2ZURpbWVuc2lvbnNTZXQpIHtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgZGF0YVNvdXJjZS5hY3RpdmVEaW1lbnNpb25zKTtcbiAgICAgICAgICBhY3RpdmVEaW1lbnNpb25zU2V0ID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhU291cmNlLmZpbHRlclJ1bGVzICYmIGRhdGFTb3VyY2UuZmlsdGVyUnVsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc29sZS5hc3NlcnQoZGF0YVNvdXJjZXMubGVuZ3RoID09PSAxKTtcbiAgICAgICAgICBmaWx0cmFibGVMYXllck5hbWUgPSBkYXRhU291cmNlLmdldEZpbHRyYWJsZVdGU0xheWVyTmFtZSgpO1xuICAgICAgICAgIGZpbHRlclN0cmluZyA9IHRoaXMubmdlb1J1bGVIZWxwZXJfLmNyZWF0ZUZpbHRlclN0cmluZyh7XG4gICAgICAgICAgICBkYXRhU291cmNlOiBkYXRhU291cmNlLFxuICAgICAgICAgICAgc3JzTmFtZTogcHJvakNvZGVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhU291cmNlLnRpbWVSYW5nZVZhbHVlICYmIGRhdGFTb3VyY2UudGltZVByb3BlcnR5KSB7XG4gICAgICAgICAgY29uc29sZS5hc3NlcnQoZGF0YVNvdXJjZXMubGVuZ3RoID09PSAxKTtcbiAgICAgICAgICBwYXJhbXMuVElNRSA9IHRoaXMubmdlb1dNU1RpbWVfLmZvcm1hdFdNU1RpbWVQYXJhbShkYXRhU291cmNlLnRpbWVQcm9wZXJ0eSwgZGF0YVNvdXJjZS50aW1lUmFuZ2VWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcGFyYW1zLkxBWUVSUyA9IExBWUVSUztcbiAgICAgIHBhcmFtcy5RVUVSWV9MQVlFUlMgPSBMQVlFUlM7XG5cbiAgICAgIGlmIChmaWx0ZXJTdHJpbmcgJiYgZmlsdHJhYmxlTGF5ZXJOYW1lKSB7XG4gICAgICAgIHZhciBmaWx0ZXJQYXJhbVZhbHVlID0gbnVsbDtcblxuICAgICAgICBpZiAoTEFZRVJTLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIGZpbHRlclBhcmFtVmFsdWUgPSBmaWx0ZXJTdHJpbmc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIGZpbHRlclBhcmFtVmFsdWVzID0gW107XG5cbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBMQVlFUlMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgaWYgKExBWUVSU1tpXSA9PT0gZmlsdHJhYmxlTGF5ZXJOYW1lKSB7XG4gICAgICAgICAgICAgIGZpbHRlclBhcmFtVmFsdWVzLnB1c2goXCIoXCIgKyBmaWx0ZXJTdHJpbmcgKyBcIilcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBmaWx0ZXJQYXJhbVZhbHVlcy5wdXNoKCcoKScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGZpbHRlclBhcmFtVmFsdWUgPSBmaWx0ZXJQYXJhbVZhbHVlcy5qb2luKCcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmFtcy5GSUxURVIgPSBmaWx0ZXJQYXJhbVZhbHVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXVybCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdXJsJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciB3bXNTb3VyY2UgPSBuZXcgb2xTb3VyY2VJbWFnZVdNUyh7XG4gICAgICAgIHBhcmFtczogcGFyYW1zLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgcHJvamVjdGlvbjogbWFwLmdldFZpZXcoKS5nZXRQcm9qZWN0aW9uKClcbiAgICAgIH0pO1xuICAgICAgdmFyIHdtc0dldEZlYXR1cmVJbmZvVXJsID0gd21zU291cmNlLmdldEZlYXR1cmVJbmZvVXJsKGNvb3JkaW5hdGUsIHJlc29sdXRpb24sIHByb2pDb2RlLCB7XG4gICAgICAgICdGRUFUVVJFX0NPVU5UJzogRkVBVFVSRV9DT1VOVCxcbiAgICAgICAgJ0lORk9fRk9STUFUJzogSU5GT19GT1JNQVRcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXdtc0dldEZlYXR1cmVJbmZvVXJsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyB3bXNHZXRGZWF0dXJlSW5mb1VybCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2FuY2VsZXIgPSB0aGlzLnJlZ2lzdGVyQ2FuY2VsZXJfKCk7XG4gICAgICBwcm9taXNlcy5wdXNoKHRoaXMuaHR0cF8uZ2V0KHdtc0dldEZlYXR1cmVJbmZvVXJsLCB7XG4gICAgICAgIHRpbWVvdXQ6IGNhbmNlbGVyLnByb21pc2VcbiAgICAgIH0pLnRoZW4odGhpcy5oYW5kbGVRdWVyeVJlc3VsdF8uYmluZCh0aGlzLCBkYXRhU291cmNlcywgRkVBVFVSRV9DT1VOVCwgZmFsc2UpKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucV8uYWxsKHByb21pc2VzKS50aGVuKGhhbmRsZUNvbWJpbmVkUXVlcnlSZXN1bHRfKTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0Q29tYmluYWJsZVdGU0RhdGFTb3VyY2VzXyA9IGZ1bmN0aW9uIGdldENvbWJpbmFibGVXRlNEYXRhU291cmNlc18oZGF0YVNvdXJjZXMpIHtcbiAgICB2YXIgY29tYmluYWJsZURhdGFTb3VyY2VzID0gW107XG4gICAgdmFyIG5vdENvbWJpbmFibGVEYXRhU291cmNlcyA9IFtdO1xuXG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yOSA9IGRhdGFTb3VyY2VzLCBfaXNBcnJheTkgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvcjkpLCBfaTkgPSAwLCBfaXRlcmF0b3I5ID0gX2lzQXJyYXk5ID8gX2l0ZXJhdG9yOSA6IF9pdGVyYXRvcjlbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgIHZhciBfcmVmOTtcblxuICAgICAgaWYgKF9pc0FycmF5OSkge1xuICAgICAgICBpZiAoX2k5ID49IF9pdGVyYXRvcjkubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZjkgPSBfaXRlcmF0b3I5W19pOSsrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pOSA9IF9pdGVyYXRvcjkubmV4dCgpO1xuICAgICAgICBpZiAoX2k5LmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmOSA9IF9pOS52YWx1ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIGRhdGFTb3VyY2UgPSBfcmVmOTtcblxuICAgICAgaWYgKGRhdGFTb3VyY2UuY29tYmluYWJsZUZvcldGUykge1xuICAgICAgICB2YXIgY29tYmluZWQgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IxMCA9IGNvbWJpbmFibGVEYXRhU291cmNlcywgX2lzQXJyYXkxMCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMTApLCBfaTEwID0gMCwgX2l0ZXJhdG9yMTAgPSBfaXNBcnJheTEwID8gX2l0ZXJhdG9yMTAgOiBfaXRlcmF0b3IxMFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgICAgIHZhciBfcmVmMTA7XG5cbiAgICAgICAgICBpZiAoX2lzQXJyYXkxMCkge1xuICAgICAgICAgICAgaWYgKF9pMTAgPj0gX2l0ZXJhdG9yMTAubGVuZ3RoKSBicmVhaztcbiAgICAgICAgICAgIF9yZWYxMCA9IF9pdGVyYXRvcjEwW19pMTArK107XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9pMTAgPSBfaXRlcmF0b3IxMC5uZXh0KCk7XG4gICAgICAgICAgICBpZiAoX2kxMC5kb25lKSBicmVhaztcbiAgICAgICAgICAgIF9yZWYxMCA9IF9pMTAudmFsdWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGNvbWJpbmFibGVEYXRhU291cmNlID0gX3JlZjEwO1xuXG4gICAgICAgICAgaWYgKGRhdGFTb3VyY2UuY29tYmluYWJsZVdpdGhEYXRhU291cmNlRm9yV0ZTKGNvbWJpbmFibGVEYXRhU291cmNlWzBdKSkge1xuICAgICAgICAgICAgY29tYmluYWJsZURhdGFTb3VyY2UucHVzaChkYXRhU291cmNlKTtcbiAgICAgICAgICAgIGNvbWJpbmVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWNvbWJpbmVkKSB7XG4gICAgICAgICAgY29tYmluYWJsZURhdGFTb3VyY2VzLnB1c2goW2RhdGFTb3VyY2VdKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbm90Q29tYmluYWJsZURhdGFTb3VyY2VzLnB1c2goW2RhdGFTb3VyY2VdKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY29tYmluYWJsZURhdGFTb3VyY2VzLmNvbmNhdChub3RDb21iaW5hYmxlRGF0YVNvdXJjZXMpO1xuICB9O1xuXG4gIF9wcm90by5nZXRDb21iaW5hYmxlV01TRGF0YVNvdXJjZXNfID0gZnVuY3Rpb24gZ2V0Q29tYmluYWJsZVdNU0RhdGFTb3VyY2VzXyhkYXRhU291cmNlcykge1xuICAgIHZhciBjb21iaW5hYmxlRGF0YVNvdXJjZXMgPSBbXTtcbiAgICB2YXIgbm90Q29tYmluYWJsZURhdGFTb3VyY2VzID0gW107XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IxMSA9IGRhdGFTb3VyY2VzLCBfaXNBcnJheTExID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IxMSksIF9pMTEgPSAwLCBfaXRlcmF0b3IxMSA9IF9pc0FycmF5MTEgPyBfaXRlcmF0b3IxMSA6IF9pdGVyYXRvcjExW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICB2YXIgX3JlZjExO1xuXG4gICAgICBpZiAoX2lzQXJyYXkxMSkge1xuICAgICAgICBpZiAoX2kxMSA+PSBfaXRlcmF0b3IxMS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmMTEgPSBfaXRlcmF0b3IxMVtfaTExKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kxMSA9IF9pdGVyYXRvcjExLm5leHQoKTtcbiAgICAgICAgaWYgKF9pMTEuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYxMSA9IF9pMTEudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBkYXRhU291cmNlID0gX3JlZjExO1xuXG4gICAgICBpZiAoZGF0YVNvdXJjZS5jb21iaW5hYmxlRm9yV01TKSB7XG4gICAgICAgIHZhciBjb21iaW5lZCA9IGZhbHNlO1xuXG4gICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjEyID0gY29tYmluYWJsZURhdGFTb3VyY2VzLCBfaXNBcnJheTEyID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IxMiksIF9pMTIgPSAwLCBfaXRlcmF0b3IxMiA9IF9pc0FycmF5MTIgPyBfaXRlcmF0b3IxMiA6IF9pdGVyYXRvcjEyW1N5bWJvbC5pdGVyYXRvcl0oKTs7KSB7XG4gICAgICAgICAgdmFyIF9yZWYxMjtcblxuICAgICAgICAgIGlmIChfaXNBcnJheTEyKSB7XG4gICAgICAgICAgICBpZiAoX2kxMiA+PSBfaXRlcmF0b3IxMi5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgICAgX3JlZjEyID0gX2l0ZXJhdG9yMTJbX2kxMisrXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2kxMiA9IF9pdGVyYXRvcjEyLm5leHQoKTtcbiAgICAgICAgICAgIGlmIChfaTEyLmRvbmUpIGJyZWFrO1xuICAgICAgICAgICAgX3JlZjEyID0gX2kxMi52YWx1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgY29tYmluYWJsZURhdGFTb3VyY2UgPSBfcmVmMTI7XG5cbiAgICAgICAgICBpZiAoZGF0YVNvdXJjZS5jb21iaW5hYmxlV2l0aERhdGFTb3VyY2VGb3JXTVMoY29tYmluYWJsZURhdGFTb3VyY2VbMF0pKSB7XG4gICAgICAgICAgICBjb21iaW5hYmxlRGF0YVNvdXJjZS5wdXNoKGRhdGFTb3VyY2UpO1xuICAgICAgICAgICAgY29tYmluZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY29tYmluZWQpIHtcbiAgICAgICAgICBjb21iaW5hYmxlRGF0YVNvdXJjZXMucHVzaChbZGF0YVNvdXJjZV0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub3RDb21iaW5hYmxlRGF0YVNvdXJjZXMucHVzaChbZGF0YVNvdXJjZV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBjb21iaW5hYmxlRGF0YVNvdXJjZXMuY29uY2F0KG5vdENvbWJpbmFibGVEYXRhU291cmNlcyk7XG4gIH07XG5cbiAgX3Byb3RvLmlzRGF0YVNvdXJjZVF1ZXJ5YWJsZV8gPSBmdW5jdGlvbiBpc0RhdGFTb3VyY2VRdWVyeWFibGVfKGRzLCByZXMpIHtcbiAgICB2YXIgcXVlcnlhYmxlID0gZHMudmlzaWJsZSAmJiBkcy5pblJhbmdlICYmIGRzLnF1ZXJ5YWJsZTtcblxuICAgIGlmIChxdWVyeWFibGUgJiYgZHMgaW5zdGFuY2VvZiBuZ2VvRGF0YXNvdXJjZU9HQykge1xuICAgICAgdmFyIG9nY0RTID0gZHM7XG4gICAgICBxdWVyeWFibGUgPSBvZ2NEUy5pc0FueU9HQ0xheWVySW5SYW5nZShyZXMsIHRydWUpO1xuICAgIH1cblxuICAgIHJldHVybiBxdWVyeWFibGU7XG4gIH07XG5cbiAgX3Byb3RvLnNldFVuaXF1ZUlkc18gPSBmdW5jdGlvbiBzZXRVbmlxdWVJZHNfKGZlYXR1cmVzLCBkYXRhU291cmNlSWQpIHtcbiAgICBmZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgICBpZiAoZmVhdHVyZS5nZXRJZCgpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIGlkID0gZGF0YVNvdXJjZUlkICsgXCJfXCIgKyBmZWF0dXJlLmdldElkKCk7XG4gICAgICAgIGZlYXR1cmUuc2V0SWQoaWQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5yZWdpc3RlckNhbmNlbGVyXyA9IGZ1bmN0aW9uIHJlZ2lzdGVyQ2FuY2VsZXJfKCkge1xuICAgIHZhciBjYW5jZWxlciA9IHRoaXMucV8uZGVmZXIoKTtcbiAgICB0aGlzLnJlcXVlc3RDYW5jZWxlcnNfLnB1c2goY2FuY2VsZXIpO1xuICAgIHJldHVybiBjYW5jZWxlcjtcbiAgfTtcblxuICBfcHJvdG8uY2FuY2VsU3RpbGxSdW5uaW5nUmVxdWVzdHNfID0gZnVuY3Rpb24gY2FuY2VsU3RpbGxSdW5uaW5nUmVxdWVzdHNfKCkge1xuICAgIGZvciAodmFyIF9pdGVyYXRvcjEzID0gdGhpcy5yZXF1ZXN0Q2FuY2VsZXJzXywgX2lzQXJyYXkxMyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMTMpLCBfaTEzID0gMCwgX2l0ZXJhdG9yMTMgPSBfaXNBcnJheTEzID8gX2l0ZXJhdG9yMTMgOiBfaXRlcmF0b3IxM1tTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWYxMztcblxuICAgICAgaWYgKF9pc0FycmF5MTMpIHtcbiAgICAgICAgaWYgKF9pMTMgPj0gX2l0ZXJhdG9yMTMubGVuZ3RoKSBicmVhaztcbiAgICAgICAgX3JlZjEzID0gX2l0ZXJhdG9yMTNbX2kxMysrXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9pMTMgPSBfaXRlcmF0b3IxMy5uZXh0KCk7XG4gICAgICAgIGlmIChfaTEzLmRvbmUpIGJyZWFrO1xuICAgICAgICBfcmVmMTMgPSBfaTEzLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2FuY2VsZXIgPSBfcmVmMTM7XG4gICAgICBjYW5jZWxlci5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgdGhpcy5yZXF1ZXN0Q2FuY2VsZXJzXy5sZW5ndGggPSAwO1xuICB9O1xuXG4gIHJldHVybiBRdWVyZW50O1xufSgpO1xuXG5mdW5jdGlvbiBoYW5kbGVDb21iaW5lZFF1ZXJ5UmVzdWx0XyhyZXNwb25zZSkge1xuICB2YXIgY29tYmluZWRIYXNoID0ge307XG5cbiAgZm9yICh2YXIgX2l0ZXJhdG9yMTQgPSByZXNwb25zZSwgX2lzQXJyYXkxNCA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMTQpLCBfaTE0ID0gMCwgX2l0ZXJhdG9yMTQgPSBfaXNBcnJheTE0ID8gX2l0ZXJhdG9yMTQgOiBfaXRlcmF0b3IxNFtTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgIHZhciBfcmVmMTQ7XG5cbiAgICBpZiAoX2lzQXJyYXkxNCkge1xuICAgICAgaWYgKF9pMTQgPj0gX2l0ZXJhdG9yMTQubGVuZ3RoKSBicmVhaztcbiAgICAgIF9yZWYxNCA9IF9pdGVyYXRvcjE0W19pMTQrK107XG4gICAgfSBlbHNlIHtcbiAgICAgIF9pMTQgPSBfaXRlcmF0b3IxNC5uZXh0KCk7XG4gICAgICBpZiAoX2kxNC5kb25lKSBicmVhaztcbiAgICAgIF9yZWYxNCA9IF9pMTQudmFsdWU7XG4gICAgfVxuXG4gICAgdmFyIGhhc2ggPSBfcmVmMTQ7XG5cbiAgICBmb3IgKHZhciBkYXRhU291cmNlSWRTdHIgaW4gaGFzaCkge1xuICAgICAgdmFyIGRhdGFTb3VyY2VJZCA9IE51bWJlcihkYXRhU291cmNlSWRTdHIpO1xuICAgICAgY29tYmluZWRIYXNoW2RhdGFTb3VyY2VJZF0gPSBoYXNoW2RhdGFTb3VyY2VJZF07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGNvbWJpbmVkSGFzaDtcbn1cblxudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvUXVlcmVudCcsIFtuZ2VvRmlsdGVyUnVsZUhlbHBlci5uYW1lLCBuZ2VvTWlzY1dNU1RpbWUubmFtZV0pO1xubW9kdWxlLnNlcnZpY2UoJ25nZW9RdWVyZW50JywgUXVlcmVudCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyB1bmxpc3RlbkJ5S2V5cyBhcyBuZ2VvRXZlbnRzVW5saXN0ZW5CeUtleXMgfSBmcm9tICduZ2VvL2V2ZW50cy5qcyc7XG5pbXBvcnQgbmdlb1F1ZXJ5TW9kZSBmcm9tICduZ2VvL3F1ZXJ5L01vZGUuanMnO1xuaW1wb3J0IG5nZW9RdWVyeU1vZGVTZWxlY3RvciBmcm9tICduZ2VvL3F1ZXJ5L01vZGVTZWxlY3Rvci5qcyc7XG5pbXBvcnQgbmdlb1F1ZXJ5TWFwUXVlcmVudCBmcm9tICduZ2VvL3F1ZXJ5L01hcFF1ZXJlbnQuanMnO1xuaW1wb3J0IHsgbGlzdGVuIGFzIG9sRXZlbnRzTGlzdGVuIH0gZnJvbSAnb2wvZXZlbnRzLmpzJztcbmltcG9ydCB7IGFsd2F5cyBhcyBvbEV2ZW50c0NvbmRpdGlvbkFsd2F5cyB9IGZyb20gJ29sL2V2ZW50cy9jb25kaXRpb24uanMnO1xuaW1wb3J0IG9sSW50ZXJhY3Rpb25EcmF3LCB7IGNyZWF0ZUJveCBhcyBvbEludGVyYWN0aW9uRHJhd0NyZWF0ZUJveCB9IGZyb20gJ29sL2ludGVyYWN0aW9uL0RyYXcuanMnO1xuaW1wb3J0IHsgVmVjdG9yIGFzIG9sTGF5ZXJWZWN0b3IgfSBmcm9tICdvbC9sYXllci5qcyc7XG5pbXBvcnQgTWFwQnJvd3NlckV2ZW50IGZyb20gJ29sL01hcEJyb3dzZXJFdmVudC5qcyc7XG5pbXBvcnQgeyBWZWN0b3IgYXMgb2xTb3VyY2VWZWN0b3IgfSBmcm9tICdvbC9zb3VyY2UuanMnO1xudmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCduZ2VvUXVlcnknLCBbbmdlb1F1ZXJ5TW9kZVNlbGVjdG9yLm5hbWUsIG5nZW9RdWVyeU1hcFF1ZXJlbnQubmFtZV0pO1xuXG52YXIgUXVlcnlDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICBRdWVyeUNvbnRyb2xsZXIuJGluamVjdCA9IFtcIm5nZW9NYXBRdWVyZW50XCIsIFwibmdlb1F1ZXJ5TW9kZVNlbGVjdG9yXCIsIFwiJGluamVjdG9yXCIsIFwiJHNjb3BlXCJdO1xuXG4gIGZ1bmN0aW9uIFF1ZXJ5Q29udHJvbGxlcihuZ2VvTWFwUXVlcmVudCwgbmdlb1F1ZXJ5TW9kZVNlbGVjdG9yLCAkaW5qZWN0b3IsICRzY29wZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB0aGlzLmFjdGl2ZTtcbiAgICB0aGlzLmF1dG9jbGVhcjtcbiAgICB0aGlzLm1hcDtcbiAgICB0aGlzLm5nZW9NYXBRdWVyZW50XyA9IG5nZW9NYXBRdWVyZW50O1xuICAgIHRoaXMubmdlb1F1ZXJ5TW9kZVNlbGVjdG9yXyA9IG5nZW9RdWVyeU1vZGVTZWxlY3RvcjtcbiAgICB2YXIgbmdlb1F1ZXJ5T3B0aW9ucyA9ICRpbmplY3Rvci5oYXMoJ25nZW9RdWVyeU9wdGlvbnMnKSA/ICRpbmplY3Rvci5nZXQoJ25nZW9RdWVyeU9wdGlvbnMnKSA6IHt9O1xuICAgIHRoaXMubmdlb1F1ZXJ5T3B0aW9uc18gPSBuZ2VvUXVlcnlPcHRpb25zO1xuICAgIHRoaXMuc2NvcGVfID0gJHNjb3BlO1xuICAgIHRoaXMudmVjdG9yU291cmNlXyA9IG5ldyBvbFNvdXJjZVZlY3Rvcih7XG4gICAgICB3cmFwWDogZmFsc2VcbiAgICB9KTtcbiAgICB0aGlzLnZlY3RvckxheWVyXyA9IG5ldyBvbExheWVyVmVjdG9yKHtcbiAgICAgIHNvdXJjZTogdGhpcy52ZWN0b3JTb3VyY2VfXG4gICAgfSk7XG4gICAgdGhpcy5kcmF3Qm94SW50ZXJhY3Rpb25fID0gbmV3IG9sSW50ZXJhY3Rpb25EcmF3KHtcbiAgICAgIGNvbmRpdGlvbjogb2xFdmVudHNDb25kaXRpb25BbHdheXMsXG4gICAgICBnZW9tZXRyeUZ1bmN0aW9uOiBvbEludGVyYWN0aW9uRHJhd0NyZWF0ZUJveCgpLFxuICAgICAgc291cmNlOiB0aGlzLnZlY3RvclNvdXJjZV8sXG4gICAgICB0eXBlOiAnQ2lyY2xlJ1xuICAgIH0pO1xuICAgIHRoaXMuZHJhd1BvbHlnb25JbnRlcmFjdGlvbl8gPSBuZXcgb2xJbnRlcmFjdGlvbkRyYXcoe1xuICAgICAgY29uZGl0aW9uOiBvbEV2ZW50c0NvbmRpdGlvbkFsd2F5cyxcbiAgICAgIHNvdXJjZTogdGhpcy52ZWN0b3JTb3VyY2VfLFxuICAgICAgdHlwZTogJ1BvbHlnb24nXG4gICAgfSk7XG4gICAgdGhpcy5saXN0ZW5lcktleXNfID0gW107XG4gICAgdGhpcy5tb2RlXyA9IG51bGw7XG4gICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMuYWN0aXZlO1xuICAgIH0sIHRoaXMuaGFuZGxlQWN0aXZlQ2hhbmdlXy5iaW5kKHRoaXMpKTtcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB2YWx1ZSA9IG51bGw7XG5cbiAgICAgIGlmIChfdGhpcy5hY3RpdmUpIHtcbiAgICAgICAgdmFsdWUgPSBfdGhpcy5uZ2VvUXVlcnlNb2RlU2VsZWN0b3JfLm1vZGU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LCB0aGlzLmVuYWJsZU1vZGVfLmJpbmQodGhpcykpO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IFF1ZXJ5Q29udHJvbGxlci5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLiRvbkluaXQgPSBmdW5jdGlvbiAkb25Jbml0KCkge1xuICAgIHRoaXMuYXV0b2NsZWFyID0gISF0aGlzLmF1dG9jbGVhcjtcbiAgfTtcblxuICBfcHJvdG8uJG9uRGVzdHJveSA9IGZ1bmN0aW9uICRvbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5lbmFibGVNb2RlXyhudWxsKTtcbiAgfTtcblxuICBfcHJvdG8uZW5hYmxlTW9kZV8gPSBmdW5jdGlvbiBlbmFibGVNb2RlXyhtb2RlKSB7XG4gICAgdGhpcy5kaXNhYmxlTW9kZV8oKTtcblxuICAgIGlmICghbW9kZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHN3aXRjaCAobW9kZSkge1xuICAgICAgY2FzZSBuZ2VvUXVlcnlNb2RlLkNMSUNLOlxuICAgICAgICB0aGlzLmxpc3RlbmVyS2V5c18ucHVzaChvbEV2ZW50c0xpc3Rlbih0aGlzLm1hcCwgJ3NpbmdsZWNsaWNrJywgdGhpcy5oYW5kbGVNYXBDbGlja18sIHRoaXMpKTtcblxuICAgICAgICBpZiAodGhpcy5uZ2VvUXVlcnlPcHRpb25zXy5jdXJzb3JIb3Zlcikge1xuICAgICAgICAgIHRoaXMubGlzdGVuZXJLZXlzXy5wdXNoKG9sRXZlbnRzTGlzdGVuKHRoaXMubWFwLCAncG9pbnRlcm1vdmUnLCB0aGlzLmhhbmRsZU1hcFBvaW50ZXJNb3ZlXywgdGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2Ugbmdlb1F1ZXJ5TW9kZS5EUkFXX0JPWDpcbiAgICAgICAgdGhpcy5tYXAuYWRkTGF5ZXIodGhpcy52ZWN0b3JMYXllcl8pO1xuICAgICAgICB0aGlzLm1hcC5hZGRJbnRlcmFjdGlvbih0aGlzLmRyYXdCb3hJbnRlcmFjdGlvbl8pO1xuICAgICAgICB0aGlzLmxpc3RlbmVyS2V5c18ucHVzaChvbEV2ZW50c0xpc3Rlbih0aGlzLmRyYXdCb3hJbnRlcmFjdGlvbl8sICdkcmF3ZW5kJywgdGhpcy5oYW5kbGVEcmF3Qm94SW50ZXJhY3Rpb25EcmF3RW5kXywgdGhpcykpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBuZ2VvUXVlcnlNb2RlLkRSQVdfUE9MWUdPTjpcbiAgICAgICAgdGhpcy5tYXAuYWRkTGF5ZXIodGhpcy52ZWN0b3JMYXllcl8pO1xuICAgICAgICB0aGlzLm1hcC5hZGRJbnRlcmFjdGlvbih0aGlzLmRyYXdQb2x5Z29uSW50ZXJhY3Rpb25fKTtcbiAgICAgICAgdGhpcy5saXN0ZW5lcktleXNfLnB1c2gob2xFdmVudHNMaXN0ZW4odGhpcy5kcmF3UG9seWdvbkludGVyYWN0aW9uXywgJ2RyYXdlbmQnLCB0aGlzLmhhbmRsZURyYXdQb2x5Z29uSW50ZXJhY3Rpb25EcmF3RW5kXywgdGhpcykpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgdGhpcy5tb2RlXyA9IG1vZGU7XG4gIH07XG5cbiAgX3Byb3RvLmRpc2FibGVNb2RlXyA9IGZ1bmN0aW9uIGRpc2FibGVNb2RlXygpIHtcbiAgICBpZiAoIXRoaXMubW9kZV8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKHRoaXMubW9kZV8pIHtcbiAgICAgIGNhc2Ugbmdlb1F1ZXJ5TW9kZS5DTElDSzpcbiAgICAgICAgaWYgKHRoaXMubmdlb1F1ZXJ5T3B0aW9uc18uY3Vyc29ySG92ZXIpIHtcbiAgICAgICAgICB0aGlzLm1hcC5nZXRUYXJnZXRFbGVtZW50KCkuc3R5bGUuY3Vyc29yID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBuZ2VvUXVlcnlNb2RlLkRSQVdfQk9YOlxuICAgICAgICB0aGlzLnZlY3RvclNvdXJjZV8uY2xlYXIoKTtcbiAgICAgICAgdGhpcy5tYXAucmVtb3ZlTGF5ZXIodGhpcy52ZWN0b3JMYXllcl8pO1xuICAgICAgICB0aGlzLm1hcC5yZW1vdmVJbnRlcmFjdGlvbih0aGlzLmRyYXdCb3hJbnRlcmFjdGlvbl8pO1xuICAgICAgICB0aGlzLmRyYXdCb3hJbnRlcmFjdGlvbl8uc2tldGNoUG9pbnRfID0gbnVsbDtcbiAgICAgICAgdGhpcy5kcmF3Qm94SW50ZXJhY3Rpb25fLm92ZXJsYXlfLmdldFNvdXJjZSgpLmNsZWFyKHRydWUpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBuZ2VvUXVlcnlNb2RlLkRSQVdfUE9MWUdPTjpcbiAgICAgICAgdGhpcy52ZWN0b3JTb3VyY2VfLmNsZWFyKCk7XG4gICAgICAgIHRoaXMubWFwLnJlbW92ZUxheWVyKHRoaXMudmVjdG9yTGF5ZXJfKTtcbiAgICAgICAgdGhpcy5tYXAucmVtb3ZlSW50ZXJhY3Rpb24odGhpcy5kcmF3UG9seWdvbkludGVyYWN0aW9uXyk7XG4gICAgICAgIHRoaXMuZHJhd1BvbHlnb25JbnRlcmFjdGlvbl8uc2tldGNoUG9pbnRfID0gbnVsbDtcbiAgICAgICAgdGhpcy5kcmF3UG9seWdvbkludGVyYWN0aW9uXy5vdmVybGF5Xy5nZXRTb3VyY2UoKS5jbGVhcih0cnVlKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIG5nZW9FdmVudHNVbmxpc3RlbkJ5S2V5cyh0aGlzLmxpc3RlbmVyS2V5c18pO1xuICAgIHRoaXMubW9kZV8gPSBudWxsO1xuICB9O1xuXG4gIF9wcm90by5nZXRMaW1pdE9wdGlvbl8gPSBmdW5jdGlvbiBnZXRMaW1pdE9wdGlvbl8oKSB7XG4gICAgcmV0dXJuIHRoaXMubmdlb1F1ZXJ5T3B0aW9uc18gJiYgdGhpcy5uZ2VvUXVlcnlPcHRpb25zXy5saW1pdCA/IHRoaXMubmdlb1F1ZXJ5T3B0aW9uc18ubGltaXQgOiB1bmRlZmluZWQ7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUFjdGl2ZUNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVBY3RpdmVDaGFuZ2VfKGFjdGl2ZSkge1xuICAgIGlmICghYWN0aXZlKSB7XG4gICAgICBpZiAodGhpcy5hdXRvY2xlYXIpIHtcbiAgICAgICAgdGhpcy5uZ2VvTWFwUXVlcmVudF8uY2xlYXIoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZURyYXdCb3hJbnRlcmFjdGlvbkRyYXdFbmRfID0gZnVuY3Rpb24gaGFuZGxlRHJhd0JveEludGVyYWN0aW9uRHJhd0VuZF8oZXZ0KSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgZmVhdHVyZSA9IGV2dC5mZWF0dXJlO1xuICAgIHZhciBhY3Rpb24gPSB0aGlzLm5nZW9RdWVyeU1vZGVTZWxlY3Rvcl8uYWN0aW9uO1xuICAgIHZhciBleHRlbnQgPSBmZWF0dXJlLmdldEdlb21ldHJ5KCkuZ2V0RXh0ZW50KCk7XG4gICAgdmFyIGxpbWl0ID0gdGhpcy5nZXRMaW1pdE9wdGlvbl8oKTtcbiAgICB2YXIgbWFwID0gdGhpcy5tYXA7XG4gICAgdGhpcy5uZ2VvTWFwUXVlcmVudF8uaXNzdWUoe1xuICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICBleHRlbnQ6IGV4dGVudCxcbiAgICAgIGxpbWl0OiBsaW1pdCxcbiAgICAgIG1hcDogbWFwXG4gICAgfSkudGhlbihmdW5jdGlvbiAoKSB7fSkuY2F0Y2goZnVuY3Rpb24gKCkge30pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMyLnZlY3RvclNvdXJjZV8uY2xlYXIoKTtcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlRHJhd1BvbHlnb25JbnRlcmFjdGlvbkRyYXdFbmRfID0gZnVuY3Rpb24gaGFuZGxlRHJhd1BvbHlnb25JbnRlcmFjdGlvbkRyYXdFbmRfKGV2dCkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdmFyIGZlYXR1cmUgPSBldnQuZmVhdHVyZTtcbiAgICB2YXIgYWN0aW9uID0gdGhpcy5uZ2VvUXVlcnlNb2RlU2VsZWN0b3JfLmFjdGlvbjtcbiAgICB2YXIgZ2VvbWV0cnkgPSBmZWF0dXJlLmdldEdlb21ldHJ5KCk7XG4gICAgdmFyIGxpbWl0ID0gdGhpcy5nZXRMaW1pdE9wdGlvbl8oKTtcbiAgICB2YXIgbWFwID0gdGhpcy5tYXA7XG4gICAgdGhpcy5uZ2VvTWFwUXVlcmVudF8uaXNzdWUoe1xuICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICBnZW9tZXRyeTogZ2VvbWV0cnksXG4gICAgICBsaW1pdDogbGltaXQsXG4gICAgICBtYXA6IG1hcFxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge30pLmNhdGNoKGZ1bmN0aW9uICgpIHt9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzMy52ZWN0b3JTb3VyY2VfLmNsZWFyKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZU1hcENsaWNrXyA9IGZ1bmN0aW9uIGhhbmRsZU1hcENsaWNrXyhldnQpIHtcbiAgICBpZiAoIShldnQgaW5zdGFuY2VvZiBNYXBCcm93c2VyRXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGFjdGlvbiA9IHRoaXMubmdlb1F1ZXJ5TW9kZVNlbGVjdG9yXy5hY3Rpb247XG4gICAgdmFyIGNvb3JkaW5hdGUgPSBldnQuY29vcmRpbmF0ZTtcbiAgICB2YXIgbWFwID0gdGhpcy5tYXA7XG4gICAgdGhpcy5uZ2VvTWFwUXVlcmVudF8uaXNzdWUoe1xuICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICBjb29yZGluYXRlOiBjb29yZGluYXRlLFxuICAgICAgbWFwOiBtYXBcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uaGFuZGxlTWFwUG9pbnRlck1vdmVfID0gZnVuY3Rpb24gaGFuZGxlTWFwUG9pbnRlck1vdmVfKGV2dCkge1xuICAgIGlmICghKGV2dCBpbnN0YW5jZW9mIE1hcEJyb3dzZXJFdmVudCkgfHwgZXZ0LmRyYWdnaW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHBpeGVsID0gdGhpcy5tYXAuZ2V0RXZlbnRQaXhlbChldnQub3JpZ2luYWxFdmVudCk7XG5cbiAgICB2YXIgcXVlcnlhYmxlID0gZnVuY3Rpb24gcXVlcnlhYmxlKGxheWVyKSB7XG4gICAgICB2YXIgdmlzaWJsZSA9IGxheWVyLmdldCgndmlzaWJsZScpO1xuICAgICAgdmFyIHNvdXJjZWlkcyA9IGxheWVyLmdldCgncXVlcnlTb3VyY2VJZHMnKTtcbiAgICAgIHJldHVybiB2aXNpYmxlICYmICEhc291cmNlaWRzO1xuICAgIH07XG5cbiAgICB2YXIgaGl0ID0gdGhpcy5tYXAuZm9yRWFjaExheWVyQXRQaXhlbChwaXhlbCwgZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSwge1xuICAgICAgbGF5ZXJGaWx0ZXI6IHF1ZXJ5YWJsZVxuICAgIH0pO1xuICAgIHRoaXMubWFwLmdldFRhcmdldEVsZW1lbnQoKS5zdHlsZS5jdXJzb3IgPSBoaXQgPyAncG9pbnRlcicgOiAnJztcbiAgfTtcblxuICByZXR1cm4gUXVlcnlDb250cm9sbGVyO1xufSgpO1xuXG5tb2R1bGUuY29tcG9uZW50KCduZ2VvUXVlcnknLCB7XG4gIGJpbmRpbmdzOiB7XG4gICAgJ2FjdGl2ZSc6ICc9JyxcbiAgICAnYXV0b2NsZWFyJzogJz0/JyxcbiAgICAnbWFwJzogJzwnXG4gIH0sXG4gIGNvbnRyb2xsZXI6IFF1ZXJ5Q29udHJvbGxlclxufSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmopIHtcbm9iaiB8fCAob2JqID0ge30pO1xudmFyIF9fdCwgX19wID0gJyc7XG53aXRoIChvYmopIHtcbl9fcCArPSAnPGRpdlxcbiAgY2xhc3M9XCJidG4tZ3JvdXBcIlxcbj5cXG4gIDxidXR0b25cXG4gICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgdGl0bGU9XCJ7e1xcJ1doaWxlIGFjdGl2ZSwgY2xpY2sgb24gdGhlIG1hcCB0byBpc3N1ZSBhIHF1ZXJ5XFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdFwiXFxuICAgIG5nLWNsYXNzPVwie2FjdGl2ZTogJGN0cmwubmdlb1F1ZXJ5TW9kZVNlbGVjdG9yLm1vZGUgPT09IFxcJ2NsaWNrXFwnfVwiXFxuICAgIG5nLWNsaWNrPVwiJGN0cmwubmdlb1F1ZXJ5TW9kZVNlbGVjdG9yLm1vZGUgPSBcXCdjbGlja1xcJ1wiXFxuICA+XFxuICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnbmdlby9pY29ucy9wb2ludC5zdmc/dmlld2JveCZoZWlnaHQ9MWVtJykpKSA9PSBudWxsID8gJycgOiBfX3QpICtcbidcXG4gIDwvYnV0dG9uPlxcbiAgPGJ1dHRvblxcbiAgICBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIlxcbiAgICB0aXRsZT1cInt7XFwnV2hpbGUgYWN0aXZlLCBjbGljayB0d2ljZSB0aGUgbWFwIHRvIGlzc3VlIGEgcXVlcnkgdXNpbmcgYSBib3hcXCcgfCB0cmFuc2xhdGV9fVwiXFxuICAgIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0XCJcXG4gICAgbmctY2xhc3M9XCJ7YWN0aXZlOiAkY3RybC5uZ2VvUXVlcnlNb2RlU2VsZWN0b3IubW9kZSA9PT0gXFwnZHJhd2JveFxcJ31cIlxcbiAgICBuZy1jbGljaz1cIiRjdHJsLm5nZW9RdWVyeU1vZGVTZWxlY3Rvci5tb2RlID0gXFwnZHJhd2JveFxcJ1wiXFxuICA+XFxuICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnbmdlby9pY29ucy9yZWN0YW5nbGUuc3ZnP3ZpZXdib3gmaGVpZ2h0PTFlbScpKSkgPT0gbnVsbCA/ICcnIDogX190KSArXG4nXFxuICA8L2J1dHRvbj5cXG4gIDxidXR0b25cXG4gICAgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJcXG4gICAgdGl0bGU9XCJ7e1xcJ1doaWxlIGFjdGl2ZSwgY2xpY2sgb24gdGhlIG1hcCBtdWx0aXBsZSB0aW1lcyB0byBkcmF3IGEgcG9seWdvbiwgd2hpY2ggd2lsbCBpc3N1ZSBhIHF1ZXJ5IHVzaW5nIGl0XFwnIHwgdHJhbnNsYXRlfX1cIlxcbiAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdFwiXFxuICAgIG5nLWNsYXNzPVwie2FjdGl2ZTogJGN0cmwubmdlb1F1ZXJ5TW9kZVNlbGVjdG9yLm1vZGUgPT09IFxcJ2RyYXdwb2x5Z29uXFwnfVwiXFxuICAgIG5nLWNsaWNrPVwiJGN0cmwubmdlb1F1ZXJ5TW9kZVNlbGVjdG9yLm1vZGUgPSBcXCdkcmF3cG9seWdvblxcJ1wiXFxuICA+XFxuICAgICcgK1xuKChfX3QgPSAocmVxdWlyZSgnbmdlby9pY29ucy9wb2x5Z29uLnN2Zz92aWV3Ym94JmhlaWdodD0xZW0nKSkpID09IG51bGwgPyAnJyA6IF9fdCkgK1xuJ1xcbiAgPC9idXR0b24+XFxuPC9kaXY+XFxuXFxuPGRpdiBjbGFzcz1cIm5nZW8tcXVlcnktcGFuZWwtYWN0aW9uc1wiPlxcbiAgPGRpdiBjbGFzcz1cImZvcm0tY2hlY2tcIj5cXG4gICAgPGxhYmVsIGNsYXNzPVwiZm9ybS1jaGVjay1sYWJlbFwiPlxcbiAgICAgIDxpbnB1dFxcbiAgICAgICAgdHlwZT1cInJhZGlvXCJcXG4gICAgICAgIGNsYXNzPVwiZm9ybS1jaGVjay1pbnB1dFwiXFxuICAgICAgICBuZy1tb2RlbD1cIiRjdHJsLm5nZW9RdWVyeU1vZGVTZWxlY3Rvci5hY3Rpb25cIlxcbiAgICAgICAgdmFsdWU9XCJhZGRcIlxcbiAgICAgID5cXG4gICAgICAgIDxzcGFuPnt7XFwnQWRkXFwnIHwgdHJhbnNsYXRlIH19PC9zcGFuPlxcbiAgICAgIDwvaW5wdXQ+XFxuICAgIDwvbGFiZWw+XFxuICA8L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XCJmb3JtLWNoZWNrXCI+XFxuICAgIDxsYWJlbCBjbGFzcz1cImZvcm0tY2hlY2stbGFiZWxcIj5cXG4gICAgICA8aW5wdXRcXG4gICAgICAgIHR5cGU9XCJyYWRpb1wiXFxuICAgICAgICBjbGFzcz1cImZvcm0tY2hlY2staW5wdXRcIlxcbiAgICAgICAgbmctbW9kZWw9XCIkY3RybC5uZ2VvUXVlcnlNb2RlU2VsZWN0b3IuYWN0aW9uXCJcXG4gICAgICAgIHZhbHVlPVwicmVtb3ZlXCJcXG4gICAgICA+XFxuICAgICAgICA8c3Bhbj57e1xcJ1JlbW92ZVxcJyB8IHRyYW5zbGF0ZSB9fTwvc3Bhbj5cXG4gICAgICA8L2lucHV0PlxcbiAgICA8L2xhYmVsPlxcbiAgPC9kaXY+XFxuICA8ZGl2IGNsYXNzPVwiZm9ybS1jaGVja1wiPlxcbiAgICA8bGFiZWwgY2xhc3M9XCJmb3JtLWNoZWNrLWxhYmVsXCI+XFxuICAgICAgPGlucHV0XFxuICAgICAgICB0eXBlPVwicmFkaW9cIlxcbiAgICAgICAgY2xhc3M9XCJmb3JtLWNoZWNrLWlucHV0XCJcXG4gICAgICAgIG5nLW1vZGVsPVwiJGN0cmwubmdlb1F1ZXJ5TW9kZVNlbGVjdG9yLmFjdGlvblwiXFxuICAgICAgICB2YWx1ZT1cInJlcGxhY2VcIlxcbiAgICAgID5cXG4gICAgICAgIDxzcGFuPnt7XFwnUmVwbGFjZVxcJyB8IHRyYW5zbGF0ZSB9fTwvc3Bhbj5cXG4gICAgICA8L2lucHV0PlxcbiAgICA8L2xhYmVsPlxcbiAgPC9kaXY+XFxuPC9kaXY+XFxuJztcblxufVxucmV0dXJuIF9fcFxufSIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9RdWVyeU1vZGVTZWxlY3RvciBmcm9tICduZ2VvL3F1ZXJ5L01vZGVTZWxlY3Rvci5qcyc7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9RdWVyeVBhbmVsJywgW25nZW9RdWVyeU1vZGVTZWxlY3Rvci5uYW1lXSk7XG5tb2R1bGUucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ25nZW8vc3JjL3F1ZXJ5L3BhbmVsQ29tcG9uZW50JywgcmVxdWlyZSgnLi9wYW5lbENvbXBvbmVudC5odG1sJykpO1xufV0pO1xubW9kdWxlLnZhbHVlKCduZ2VvUXVlcnlQYW5lbFRlbXBsYXRlVXJsJywgZnVuY3Rpb24gKCRhdHRycykge1xuICB2YXIgdGVtcGxhdGVVcmwgPSAkYXR0cnMubmdlb1F1ZXJ5UGFuZWxUZW1wbGF0ZVVybDtcbiAgcmV0dXJuIHRlbXBsYXRlVXJsICE9PSB1bmRlZmluZWQgPyB0ZW1wbGF0ZVVybCA6ICduZ2VvL3NyYy9xdWVyeS9wYW5lbENvbXBvbmVudCc7XG59KTtcbm5nZW9RdWVyeVBhbmVsVGVtcGxhdGVVcmwuJGluamVjdCA9IFtcIiRhdHRyc1wiLCBcIm5nZW9RdWVyeVBhbmVsVGVtcGxhdGVVcmxcIl07XG5cbmZ1bmN0aW9uIG5nZW9RdWVyeVBhbmVsVGVtcGxhdGVVcmwoJGF0dHJzLCBuZ2VvUXVlcnlQYW5lbFRlbXBsYXRlVXJsKSB7XG4gIHJldHVybiBuZ2VvUXVlcnlQYW5lbFRlbXBsYXRlVXJsKCRhdHRycyk7XG59XG5cbnZhciBRdWVyeVBhbmVsQ29udHJvbGxlciA9IGZ1bmN0aW9uIFF1ZXJ5UGFuZWxDb250cm9sbGVyKG5nZW9RdWVyeU1vZGVTZWxlY3Rvcikge1xuICB0aGlzLm5nZW9RdWVyeU1vZGVTZWxlY3RvciA9IG5nZW9RdWVyeU1vZGVTZWxlY3Rvcjtcbn07XG5cblF1ZXJ5UGFuZWxDb250cm9sbGVyLiRpbmplY3QgPSBbXCJuZ2VvUXVlcnlNb2RlU2VsZWN0b3JcIl07XG5RdWVyeVBhbmVsQ29udHJvbGxlci4kaW5qZWN0ID0gW1wibmdlb1F1ZXJ5TW9kZVNlbGVjdG9yXCJdO1xubW9kdWxlLmNvbXBvbmVudCgnbmdlb1F1ZXJ5UGFuZWwnLCB7XG4gIGNvbnRyb2xsZXI6IFF1ZXJ5UGFuZWxDb250cm9sbGVyLFxuICB0ZW1wbGF0ZVVybDogbmdlb1F1ZXJ5UGFuZWxUZW1wbGF0ZVVybFxufSk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZSBmcm9tICduZ2VvL2Zvcm1hdC9BdHRyaWJ1dGVUeXBlLmpzJztcbmltcG9ydCBuZ2VvUnVsZVJ1bGUgZnJvbSAnbmdlby9ydWxlL1J1bGUuanMnO1xuXG52YXIgX2RlZmF1bHQgPSBmdW5jdGlvbiAoX25nZW9SdWxlUnVsZSkge1xuICBfaW5oZXJpdHNMb29zZShfZGVmYXVsdCwgX25nZW9SdWxlUnVsZSk7XG5cbiAgZnVuY3Rpb24gX2RlZmF1bHQob3B0aW9ucykge1xuICAgIG9wdGlvbnMudHlwZSA9IG9wdGlvbnMudHlwZSB8fCBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5EQVRFO1xuICAgIHJldHVybiBfbmdlb1J1bGVSdWxlLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgfVxuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0obmdlb1J1bGVSdWxlKTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOyBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzczsgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5pbXBvcnQgbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUgZnJvbSAnbmdlby9mb3JtYXQvQXR0cmlidXRlVHlwZS5qcyc7XG5pbXBvcnQgbmdlb1J1bGVSdWxlIGZyb20gJ25nZW8vcnVsZS9SdWxlLmpzJztcbmltcG9ydCB7IGxpc3RlbiwgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5pbXBvcnQgb2xGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuaW1wb3J0IG9sRm9ybWF0R2VvSlNPTiBmcm9tICdvbC9mb3JtYXQvR2VvSlNPTi5qcyc7XG5cbnZhciBfZGVmYXVsdCA9IGZ1bmN0aW9uIChfbmdlb1J1bGVSdWxlKSB7XG4gIF9pbmhlcml0c0xvb3NlKF9kZWZhdWx0LCBfbmdlb1J1bGVSdWxlKTtcblxuICBmdW5jdGlvbiBfZGVmYXVsdChvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgb3B0aW9ucy50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuR0VPTUVUUlk7XG4gICAgX3RoaXMgPSBfbmdlb1J1bGVSdWxlLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICB2YXIgcHJvcGVydGllcyA9IG9wdGlvbnMuZmVhdHVyZVByb3BlcnRpZXMgfHwge307XG4gICAgX3RoaXMuZmVhdHVyZV8gPSBuZXcgb2xGZWF0dXJlKHByb3BlcnRpZXMpO1xuICAgIF90aGlzLmZvcm1hdF8gPSBuZXcgb2xGb3JtYXRHZW9KU09OKCk7XG4gICAgX3RoaXMudXBkYXRpbmdFeHByZXNzaW9uXyA9IGZhbHNlO1xuICAgIF90aGlzLnVwZGF0aW5nR2VvbWV0cnlfID0gZmFsc2U7XG4gICAgX3RoaXMuZ2VvbWV0cnlDaGFuZ2VMaXN0ZW5lcktleV8gPSBudWxsO1xuXG4gICAgX3RoaXMubGlzdGVuZXJLZXlzLnB1c2gobGlzdGVuKF90aGlzLmZlYXR1cmVfLCBcImNoYW5nZTpcIiArIF90aGlzLmZlYXR1cmUuZ2V0R2VvbWV0cnlOYW1lKCksIF90aGlzLmhhbmRsZUZlYXR1cmVHZW9tZXRyeUNoYW5nZV8sIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKSk7XG5cbiAgICBfdGhpcy5zZXRHZW9tZXRyeUZyb21FeHByZXNzaW9uXygpO1xuXG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IF9kZWZhdWx0LnByb3RvdHlwZTtcblxuICBfcHJvdG8uc2V0RXhwcmVzc2lvbiA9IGZ1bmN0aW9uIHNldEV4cHJlc3Npb24oZXhwcmVzc2lvbikge1xuICAgIHRoaXMudXBkYXRpbmdFeHByZXNzaW9uXyA9IHRydWU7XG5cbiAgICBfbmdlb1J1bGVSdWxlLnByb3RvdHlwZS5zZXRFeHByZXNzaW9uLmNhbGwodGhpcywgZXhwcmVzc2lvbik7XG5cbiAgICBpZiAoIXRoaXMudXBkYXRpbmdHZW9tZXRyeV8pIHtcbiAgICAgIHRoaXMuc2V0R2VvbWV0cnlGcm9tRXhwcmVzc2lvbl8oKTtcbiAgICB9XG5cbiAgICB0aGlzLnJlZ2lzdGVyR2VvbWV0cnlDaGFuZ2VfKCk7XG4gICAgdGhpcy51cGRhdGluZ0V4cHJlc3Npb25fID0gZmFsc2U7XG4gIH07XG5cbiAgX3Byb3RvLmhhbmRsZUZlYXR1cmVHZW9tZXRyeUNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVGZWF0dXJlR2VvbWV0cnlDaGFuZ2VfKCkge1xuICAgIGlmICh0aGlzLnVwZGF0aW5nRXhwcmVzc2lvbl8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0aW5nR2VvbWV0cnlfID0gdHJ1ZTtcbiAgICB2YXIgZ2VvbWV0cnkgPSB0aGlzLmZlYXR1cmVfLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoZ2VvbWV0cnkpIHtcbiAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IHRoaXMuZm9ybWF0Xy53cml0ZUdlb21ldHJ5KGdlb21ldHJ5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5leHByZXNzaW9uID0gbnVsbDtcbiAgICB9XG5cbiAgICB0aGlzLnJlZ2lzdGVyR2VvbWV0cnlDaGFuZ2VfKCk7XG4gICAgdGhpcy51cGRhdGluZ0dlb21ldHJ5XyA9IGZhbHNlO1xuICB9O1xuXG4gIF9wcm90by5oYW5kbGVHZW9tZXRyeUNoYW5nZV8gPSBmdW5jdGlvbiBoYW5kbGVHZW9tZXRyeUNoYW5nZV8oZXZ0KSB7XG4gICAgdmFyIGdlb21ldHJ5ID0gZXZ0LnRhcmdldDtcbiAgICB0aGlzLnVwZGF0aW5nR2VvbWV0cnlfID0gdHJ1ZTtcbiAgICB0aGlzLmV4cHJlc3Npb24gPSB0aGlzLmZvcm1hdF8ud3JpdGVHZW9tZXRyeShnZW9tZXRyeSk7XG4gICAgdGhpcy51cGRhdGluZ0dlb21ldHJ5XyA9IGZhbHNlO1xuICB9O1xuXG4gIF9wcm90by5zZXRHZW9tZXRyeUZyb21FeHByZXNzaW9uXyA9IGZ1bmN0aW9uIHNldEdlb21ldHJ5RnJvbUV4cHJlc3Npb25fKCkge1xuICAgIHZhciBnZW9tZXRyeSA9IG51bGw7XG5cbiAgICBpZiAodGhpcy5leHByZXNzaW9uKSB7XG4gICAgICB2YXIgZXhwcmVzc2lvbiA9IHRoaXMuZXhwcmVzc2lvbjtcbiAgICAgIGdlb21ldHJ5ID0gdGhpcy5mb3JtYXRfLnJlYWRHZW9tZXRyeShleHByZXNzaW9uKTtcbiAgICB9XG5cbiAgICB0aGlzLmdlb21ldHJ5ID0gZ2VvbWV0cnk7XG4gIH07XG5cbiAgX3Byb3RvLnJlZ2lzdGVyR2VvbWV0cnlDaGFuZ2VfID0gZnVuY3Rpb24gcmVnaXN0ZXJHZW9tZXRyeUNoYW5nZV8oKSB7XG4gICAgaWYgKHRoaXMuZ2VvbWV0cnlDaGFuZ2VMaXN0ZW5lcktleV8gIT09IG51bGwpIHtcbiAgICAgIHVubGlzdGVuQnlLZXkodGhpcy5nZW9tZXRyeUNoYW5nZUxpc3RlbmVyS2V5Xyk7XG4gICAgICB0aGlzLmdlb21ldHJ5Q2hhbmdlTGlzdGVuZXJLZXlfID0gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgZ2VvbWV0cnkgPSB0aGlzLmZlYXR1cmVfLmdldEdlb21ldHJ5KCk7XG5cbiAgICBpZiAoZ2VvbWV0cnkpIHtcbiAgICAgIHRoaXMuZ2VvbWV0cnlDaGFuZ2VMaXN0ZW5lcktleV8gPSBsaXN0ZW4oZ2VvbWV0cnksICdjaGFuZ2UnLCB0aGlzLmhhbmRsZUdlb21ldHJ5Q2hhbmdlXywgdGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhfZGVmYXVsdCwgW3tcbiAgICBrZXk6IFwiZmVhdHVyZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZmVhdHVyZV87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdlb21ldHJ5XCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5mZWF0dXJlXy5nZXRHZW9tZXRyeSgpIHx8IG51bGw7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChnZW9tZXRyeSkge1xuICAgICAgdGhpcy5mZWF0dXJlXy5zZXRHZW9tZXRyeShnZW9tZXRyeSB8fCB1bmRlZmluZWQpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0obmdlb1J1bGVSdWxlKTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuaW1wb3J0IHsgdW5saXN0ZW5CeUtleSB9IGZyb20gJ29sL2V2ZW50cy5qcyc7XG5leHBvcnQgdmFyIFJ1bGVPcGVyYXRvclR5cGUgPSB7XG4gIEJFVFdFRU46ICcuLicsXG4gIEVRVUFMX1RPOiAnPScsXG4gIEdSRUFURVJfVEhBTjogJz4nLFxuICBHUkVBVEVSX1RIQU5fT1JfRVFVQUxfVE86ICc+PScsXG4gIExFU1NFUl9USEFOOiAnPCcsXG4gIExFU1NFUl9USEFOX09SX0VRVUFMX1RPOiAnPD0nLFxuICBMSUtFOiAnficsXG4gIE5PVF9FUVVBTF9UTzogJyE9J1xufTtcbmV4cG9ydCB2YXIgUnVsZVNwYXRpYWxPcGVyYXRvclR5cGUgPSB7XG4gIENPTlRBSU5TOiAnY29udGFpbnMnLFxuICBJTlRFUlNFQ1RTOiAnaW50ZXJzZWN0cycsXG4gIFdJVEhJTjogJ3dpdGhpbidcbn07XG5leHBvcnQgdmFyIFJ1bGVUZW1wb3JhbE9wZXJhdG9yVHlwZSA9IHtcbiAgQkVHSU5TOiAndGltZV9zdGFydCcsXG4gIERVUklORzogJ3RpbWVfZHVyaW5nJyxcbiAgRU5EUzogJ3RpbWVfZW5kJyxcbiAgRVFVQUxTOiAndGltZV9lcXVhbCdcbn07XG5cbnZhciBSdWxlID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBSdWxlKG9wdGlvbnMpIHtcbiAgICB0aGlzLmFjdGl2ZSA9IG9wdGlvbnMuYWN0aXZlID09PSB0cnVlO1xuICAgIHRoaXMuZXhwcmVzc2lvbiA9IG9wdGlvbnMuZXhwcmVzc2lvbiAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5leHByZXNzaW9uIDogbnVsbDtcbiAgICB0aGlzLmxvd2VyQm91bmRhcnkgPSBvcHRpb25zLmxvd2VyQm91bmRhcnkgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMubG93ZXJCb3VuZGFyeSA6IG51bGw7XG4gICAgdGhpcy5vcGVyYXRvciA9IG9wdGlvbnMub3BlcmF0b3IgfHwgbnVsbDtcbiAgICB0aGlzLnVwcGVyQm91bmRhcnkgPSBvcHRpb25zLnVwcGVyQm91bmRhcnkgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMudXBwZXJCb3VuZGFyeSA6IG51bGw7XG4gICAgdGhpcy5pc0N1c3RvbV8gPSBvcHRpb25zLmlzQ3VzdG9tICE9PSBmYWxzZTtcbiAgICB0aGlzLm5hbWVfID0gb3B0aW9ucy5uYW1lO1xuICAgIHRoaXMub3BlcmF0b3JzXyA9IG9wdGlvbnMub3BlcmF0b3JzIHx8IG51bGw7XG4gICAgdGhpcy5wcm9wZXJ0eU5hbWVfID0gb3B0aW9ucy5wcm9wZXJ0eU5hbWU7XG4gICAgdGhpcy50eXBlXyA9IG9wdGlvbnMudHlwZTtcbiAgICB0aGlzLmxpc3RlbmVyS2V5cyA9IFtdO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IFJ1bGUucHJvdG90eXBlO1xuXG4gIF9wcm90by5nZXRFeHByZXNzaW9uID0gZnVuY3Rpb24gZ2V0RXhwcmVzc2lvbigpIHtcbiAgICByZXR1cm4gdGhpcy5leHByZXNzaW9uO1xuICB9O1xuXG4gIF9wcm90by5zZXRFeHByZXNzaW9uID0gZnVuY3Rpb24gc2V0RXhwcmVzc2lvbihleHByZXNzaW9uKSB7XG4gICAgdGhpcy5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgfTtcblxuICBfcHJvdG8ucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHtcbiAgICBpZiAodGhpcy5nZXRFeHByZXNzaW9uKCkgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuc2V0RXhwcmVzc2lvbihudWxsKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5sb3dlckJvdW5kYXJ5ICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmxvd2VyQm91bmRhcnkgPSBudWxsO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnVwcGVyQm91bmRhcnkgIT09IG51bGwpIHtcbiAgICAgIHRoaXMudXBwZXJCb3VuZGFyeSA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5kZXN0cm95ID0gZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICB0aGlzLmxpc3RlbmVyS2V5cy5mb3JFYWNoKHVubGlzdGVuQnlLZXkpO1xuICAgIHRoaXMubGlzdGVuZXJLZXlzLmxlbmd0aCA9IDA7XG4gIH07XG5cbiAgX2NyZWF0ZUNsYXNzKFJ1bGUsIFt7XG4gICAga2V5OiBcImlzQ3VzdG9tXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0N1c3RvbV87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm5hbWVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLm5hbWVfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJvcGVyYXRvcnNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wZXJhdG9yc187XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInByb3BlcnR5TmFtZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcGVydHlOYW1lXztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidHlwZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMudHlwZV87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInZhbHVlXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICB2YXIgdmFsdWUgPSBudWxsO1xuICAgICAgdmFyIGV4cHJlc3Npb24gPSB0aGlzLmdldEV4cHJlc3Npb24oKTtcbiAgICAgIHZhciBsb3dlckJvdW5kYXJ5ID0gdGhpcy5sb3dlckJvdW5kYXJ5O1xuICAgICAgdmFyIG9wZXJhdG9yID0gdGhpcy5vcGVyYXRvcjtcbiAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSB0aGlzLnByb3BlcnR5TmFtZTtcbiAgICAgIHZhciB1cHBlckJvdW5kYXJ5ID0gdGhpcy51cHBlckJvdW5kYXJ5O1xuXG4gICAgICBpZiAob3BlcmF0b3IpIHtcbiAgICAgICAgaWYgKG9wZXJhdG9yID09PSBSdWxlT3BlcmF0b3JUeXBlLkJFVFdFRU4gfHwgb3BlcmF0b3IgPT09IFJ1bGVUZW1wb3JhbE9wZXJhdG9yVHlwZS5EVVJJTkcpIHtcbiAgICAgICAgICBpZiAobG93ZXJCb3VuZGFyeSAhPT0gbnVsbCAmJiB1cHBlckJvdW5kYXJ5ICE9PSBudWxsKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgb3BlcmF0b3I6IG9wZXJhdG9yLFxuICAgICAgICAgICAgICBsb3dlckJvdW5kYXJ5OiBsb3dlckJvdW5kYXJ5LFxuICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSxcbiAgICAgICAgICAgICAgdXBwZXJCb3VuZGFyeTogdXBwZXJCb3VuZGFyeVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGV4cHJlc3Npb24gIT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhbHVlID0ge1xuICAgICAgICAgICAgICBleHByZXNzaW9uOiBleHByZXNzaW9uLFxuICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3IsXG4gICAgICAgICAgICAgIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFJ1bGU7XG59KCk7XG5cbmV4cG9ydCB7IFJ1bGUgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZSBmcm9tICduZ2VvL2Zvcm1hdC9BdHRyaWJ1dGVUeXBlLmpzJztcbmltcG9ydCBuZ2VvUnVsZVJ1bGUsIHsgUnVsZU9wZXJhdG9yVHlwZSB9IGZyb20gJ25nZW8vcnVsZS9SdWxlLmpzJztcblxudmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gKF9uZ2VvUnVsZVJ1bGUpIHtcbiAgX2luaGVyaXRzTG9vc2UoX2RlZmF1bHQsIF9uZ2VvUnVsZVJ1bGUpO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBvcHRpb25zLm9wZXJhdG9yID0gUnVsZU9wZXJhdG9yVHlwZS5FUVVBTF9UTztcbiAgICBvcHRpb25zLnR5cGUgPSBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZS5TRUxFQ1Q7XG4gICAgX3RoaXMgPSBfbmdlb1J1bGVSdWxlLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICBfdGhpcy5jaG9pY2VzXyA9IG9wdGlvbnMuY2hvaWNlcztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoX2RlZmF1bHQsIFt7XG4gICAga2V5OiBcImNob2ljZXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmNob2ljZXNfO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZWxlY3RlZENob2ljZXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciBzZWxlY3RlZENob2ljZXM7XG5cbiAgICAgIGlmICh0aGlzLmV4cHJlc3Npb24pIHtcbiAgICAgICAgdmFyIHN0cmluZ0V4cHJlc3Npb24gPSBTdHJpbmcodGhpcy5leHByZXNzaW9uKTtcbiAgICAgICAgc2VsZWN0ZWRDaG9pY2VzID0gc3RyaW5nRXhwcmVzc2lvbi5zcGxpdCgnLCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VsZWN0ZWRDaG9pY2VzID0gW107XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzZWxlY3RlZENob2ljZXM7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIF9kZWZhdWx0O1xufShuZ2VvUnVsZVJ1bGUpO1xuXG5leHBvcnQgeyBfZGVmYXVsdCBhcyBkZWZhdWx0IH07IiwiZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmltcG9ydCBuZ2VvRm9ybWF0QXR0cmlidXRlVHlwZSBmcm9tICduZ2VvL2Zvcm1hdC9BdHRyaWJ1dGVUeXBlLmpzJztcbmltcG9ydCBuZ2VvUnVsZVJ1bGUsIHsgUnVsZU9wZXJhdG9yVHlwZSB9IGZyb20gJ25nZW8vcnVsZS9SdWxlLmpzJztcblxudmFyIF9kZWZhdWx0ID0gZnVuY3Rpb24gKF9uZ2VvUnVsZVJ1bGUpIHtcbiAgX2luaGVyaXRzTG9vc2UoX2RlZmF1bHQsIF9uZ2VvUnVsZVJ1bGUpO1xuXG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMpIHtcbiAgICBvcHRpb25zLm9wZXJhdG9yID0gb3B0aW9ucy5vcGVyYXRvciB8fCBSdWxlT3BlcmF0b3JUeXBlLkxJS0U7XG4gICAgb3B0aW9ucy50eXBlID0gbmdlb0Zvcm1hdEF0dHJpYnV0ZVR5cGUuVEVYVDtcbiAgICByZXR1cm4gX25nZW9SdWxlUnVsZS5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gIH1cblxuICByZXR1cm4gX2RlZmF1bHQ7XG59KG5nZW9SdWxlUnVsZSk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBvbEZvcm1hdEdlb0pTT04gZnJvbSAnb2wvZm9ybWF0L0dlb0pTT04uanMnO1xuaW1wb3J0ICdjb3JlanMtdHlwZWFoZWFkJztcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVHZW9KU09OQmxvb2Rob3VuZCh1cmwsIG9wdF9maWx0ZXIsIG9wdF9mZWF0dXJlUHJvamVjdGlvbiwgb3B0X2RhdGFQcm9qZWN0aW9uLCBvcHRfb3B0aW9ucywgb3B0X3JlbW90ZU9wdGlvbnMpIHtcbiAgdmFyIGdlb2pzb25Gb3JtYXQgPSBuZXcgb2xGb3JtYXRHZW9KU09OKCk7XG4gIHZhciBibG9vZGhvdW5kT3B0aW9ucyA9IHtcbiAgICByZW1vdGU6IHtcbiAgICAgIHVybDogdXJsLFxuICAgICAgcHJlcGFyZTogZnVuY3Rpb24gcHJlcGFyZShxdWVyeSwgc2V0dGluZ3MpIHtcbiAgICAgICAgaWYgKHNldHRpbmdzLnVybCkge1xuICAgICAgICAgIHNldHRpbmdzLnVybCA9IHNldHRpbmdzLnVybC5yZXBsYWNlKCclUVVFUlknLCBxdWVyeSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2V0dGluZ3M7XG4gICAgICB9LFxuICAgICAgdHJhbnNmb3JtOiBmdW5jdGlvbiB0cmFuc2Zvcm0ocGFyc2VkUmVzcG9uc2UpIHtcbiAgICAgICAgdmFyIGZlYXR1cmVDb2xsZWN0aW9uID0gcGFyc2VkUmVzcG9uc2U7XG5cbiAgICAgICAgaWYgKG9wdF9maWx0ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGZlYXR1cmVDb2xsZWN0aW9uID0ge1xuICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJyxcbiAgICAgICAgICAgIGZlYXR1cmVzOiBmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlcy5maWx0ZXIob3B0X2ZpbHRlcilcbiAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGdlb2pzb25Gb3JtYXQucmVhZEZlYXR1cmVzKGZlYXR1cmVDb2xsZWN0aW9uLCB7XG4gICAgICAgICAgZmVhdHVyZVByb2plY3Rpb246IG9wdF9mZWF0dXJlUHJvamVjdGlvbixcbiAgICAgICAgICBkYXRhUHJvamVjdGlvbjogb3B0X2RhdGFQcm9qZWN0aW9uXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgZGF0dW1Ub2tlbml6ZXI6IGZ1bmN0aW9uIGRhdHVtVG9rZW5pemVyKGRhdHVtKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfSxcbiAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2VcbiAgfTtcbiAgdmFyIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRfb3B0aW9ucyB8fCB7XG4gICAgZGF0dW1Ub2tlbml6ZXI6IGZ1bmN0aW9uIGRhdHVtVG9rZW5pemVyKGRhdHVtKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfSxcbiAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2VcbiAgfSk7XG4gIHZhciByZW1vdGVPcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgb3B0X3JlbW90ZU9wdGlvbnMgfHwge1xuICAgIHVybDogJydcbiAgfSk7XG5cbiAgaWYgKG9wdGlvbnMucmVtb3RlKSB7XG4gICAgT2JqZWN0LmFzc2lnbihyZW1vdGVPcHRpb25zLCBvcHRpb25zLnJlbW90ZSk7XG4gICAgZGVsZXRlIG9wdGlvbnMucmVtb3RlO1xuICB9XG5cbiAgT2JqZWN0LmFzc2lnbihibG9vZGhvdW5kT3B0aW9ucywgb3B0aW9ucyk7XG4gIE9iamVjdC5hc3NpZ24oYmxvb2Rob3VuZE9wdGlvbnMucmVtb3RlLCByZW1vdGVPcHRpb25zKTtcbiAgcmV0dXJuIG5ldyBCbG9vZGhvdW5kKGJsb29kaG91bmRPcHRpb25zKTtcbn1cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb1NlYXJjaENyZWF0ZWdlb2pzb25ibG9vZGhvdW5kJywgW10pO1xubW9kdWxlLnZhbHVlKCduZ2VvU2VhcmNoQ3JlYXRlR2VvSlNPTkJsb29kaG91bmQnLCBjcmVhdGVHZW9KU09OQmxvb2Rob3VuZCk7XG5leHBvcnQgZGVmYXVsdCBtb2R1bGU7IiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgKiBhcyBvbFByb2ogZnJvbSAnb2wvcHJvai5qcyc7XG5pbXBvcnQgRVBTRzIxNzgxIGZyb20gJ0BnZW9ibG9ja3MvcHJvai9zcmMvRVBTR18yMTc4MS5qcyc7XG5pbXBvcnQgb2xHZW9tUG9pbnQgZnJvbSAnb2wvZ2VvbS9Qb2ludC5qcyc7XG5pbXBvcnQgb2xGZWF0dXJlIGZyb20gJ29sL0ZlYXR1cmUuanMnO1xuaW1wb3J0ICdjb3JlanMtdHlwZWFoZWFkJztcblxuZnVuY3Rpb24gY3JlYXRlTG9jYXRpb25TZWFyY2hCbG9vZGhvdW5kKG9wdF9vcHRpb25zKSB7XG4gIHZhciBvcHRpb25zID0gb3B0X29wdGlvbnMgfHwge307XG4gIHZhciBzb3VyY2VQcm9qZWN0aW9uID0gb2xQcm9qLmdldChFUFNHMjE3ODEpO1xuICB2YXIgdGFyZ2V0UHJvamVjdGlvbiA9IG9wdGlvbnMudGFyZ2V0UHJvamVjdGlvbjtcblxuICB2YXIgcGFyc2VCYm94ID0gZnVuY3Rpb24gcGFyc2VCYm94KGJib3gpIHtcbiAgICB2YXIgcmVnZXggPSAvQk9YXFwoKC4qPykgKC4qPyksKC4qPykgKC4qPylcXCkvZztcbiAgICB2YXIgbWF0Y2ggPSByZWdleC5leGVjKGJib3gpO1xuXG4gICAgaWYgKG1hdGNoICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gW3BhcnNlRmxvYXQobWF0Y2hbMV0pLCBwYXJzZUZsb2F0KG1hdGNoWzJdKSwgcGFyc2VGbG9hdChtYXRjaFszXSksIHBhcnNlRmxvYXQobWF0Y2hbNF0pXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9O1xuXG4gIHZhciByZW1vdmVIdG1sVGFncyA9IGZ1bmN0aW9uIHJlbW92ZUh0bWxUYWdzKGxhYmVsKSB7XG4gICAgcmV0dXJuIGxhYmVsLnJlcGxhY2UoLzxcXC8/W2liXT4vZywgJycpO1xuICB9O1xuXG4gIHZhciBleHRyYWN0TmFtZSA9IGZ1bmN0aW9uIGV4dHJhY3ROYW1lKGxhYmVsKSB7XG4gICAgdmFyIHJlZ2V4ID0gLzxiPiguKj8pPFxcL2I+L2c7XG4gICAgdmFyIG1hdGNoID0gcmVnZXguZXhlYyhsYWJlbCk7XG5cbiAgICBpZiAobWF0Y2ggIT09IG51bGwpIHtcbiAgICAgIHJldHVybiBtYXRjaFsxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGxhYmVsO1xuICAgIH1cbiAgfTtcblxuICB2YXIgYmxvb2Rob3VuZE9wdGlvbnMgPSB7XG4gICAgcmVtb3RlOiB7XG4gICAgICB1cmw6ICdodHRwczovL2FwaTMuZ2VvLmFkbWluLmNoL3Jlc3Qvc2VydmljZXMvYXBpL1NlYXJjaFNlcnZlcj90eXBlPWxvY2F0aW9ucyZzZWFyY2hUZXh0PSVRVUVSWScsXG4gICAgICBwcmVwYXJlOiBmdW5jdGlvbiBwcmVwYXJlKHF1ZXJ5LCBzZXR0aW5ncykge1xuICAgICAgICBpZiAoc2V0dGluZ3MudXJsKSB7XG4gICAgICAgICAgc2V0dGluZ3MudXJsID0gc2V0dGluZ3MudXJsLnJlcGxhY2UoJyVRVUVSWScsIHF1ZXJ5KTtcblxuICAgICAgICAgIGlmIChvcHRpb25zLmxpbWl0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNldHRpbmdzLnVybCArPSBcIiZsaW1pdD1cIiArIG9wdGlvbnMubGltaXQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG9wdGlvbnMub3JpZ2lucyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZXR0aW5ncy51cmwgKz0gXCImb3JpZ2lucz1cIiArIG9wdGlvbnMub3JpZ2lucztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3B0aW9ucy5wcmVwYXJlICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnByZXBhcmUocXVlcnksIHNldHRpbmdzKSA6IHNldHRpbmdzO1xuICAgICAgfSxcbiAgICAgIHRyYW5zZm9ybTogZnVuY3Rpb24gdHJhbnNmb3JtKHBhcnNlZFJlc3BvbnNlXykge1xuICAgICAgICB2YXIgcGFyc2VkUmVzcG9uc2UgPSBwYXJzZWRSZXNwb25zZV87XG5cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyc2VkUmVzcG9uc2UpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXcm9uZyBwYXJzZWRSZXNwb25zZSB0eXBlJyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZmVhdHVyZXMgPSBwYXJzZWRSZXNwb25zZS5yZXN1bHRzLm1hcChmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgdmFyIGF0dHJzID0gcmVzdWx0LmF0dHJzO1xuICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBvbEdlb21Qb2ludChbYXR0cnMueSwgYXR0cnMueF0pO1xuICAgICAgICAgIHZhciBiYm94ID0gcGFyc2VCYm94KGF0dHJzLmdlb21fc3RfYm94MmQpO1xuXG4gICAgICAgICAgaWYgKHRhcmdldFByb2plY3Rpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcG9pbnQudHJhbnNmb3JtKHNvdXJjZVByb2plY3Rpb24sIHRhcmdldFByb2plY3Rpb24pO1xuXG4gICAgICAgICAgICBpZiAoYmJveCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICBiYm94ID0gb2xQcm9qLnRyYW5zZm9ybUV4dGVudChiYm94LCBzb3VyY2VQcm9qZWN0aW9uLCB0YXJnZXRQcm9qZWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhdHRycy5nZW9tZXRyeSA9IHBvaW50O1xuICAgICAgICAgIGF0dHJzLmJib3ggPSBiYm94O1xuICAgICAgICAgIHZhciBsYWJlbCA9IGF0dHJzLmxhYmVsO1xuICAgICAgICAgIGF0dHJzLmxhYmVsX25vX2h0bWwgPSByZW1vdmVIdG1sVGFncyhsYWJlbCk7XG4gICAgICAgICAgYXR0cnMubGFiZWxfc2ltcGxlID0gZXh0cmFjdE5hbWUobGFiZWwpO1xuICAgICAgICAgIHZhciBmZWF0dXJlID0gbmV3IG9sRmVhdHVyZShhdHRycyk7XG4gICAgICAgICAgZmVhdHVyZS5zZXRJZChhdHRycy5mZWF0dXJlSWQpO1xuICAgICAgICAgIHJldHVybiBmZWF0dXJlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZlYXR1cmVzO1xuICAgICAgfVxuICAgIH0sXG4gICAgZGF0dW1Ub2tlbml6ZXI6IGZ1bmN0aW9uIGRhdHVtVG9rZW5pemVyKGRhdHVtKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfSxcbiAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2VcbiAgfTtcbiAgdmFyIGJoT3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMub3B0aW9ucyB8fCB7XG4gICAgZGF0dW1Ub2tlbml6ZXI6IGZ1bmN0aW9uIGRhdHVtVG9rZW5pemVyKGRhdHVtKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfSxcbiAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2VcbiAgfSk7XG4gIHZhciByZW1vdGVPcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucy5yZW1vdGVPcHRpb25zIHx8IHt9KTtcblxuICBpZiAoYmhPcHRpb25zLnJlbW90ZSkge1xuICAgIE9iamVjdC5hc3NpZ24ocmVtb3RlT3B0aW9ucywgYmhPcHRpb25zLnJlbW90ZSk7XG4gICAgZGVsZXRlIGJoT3B0aW9ucy5yZW1vdGU7XG4gIH1cblxuICBPYmplY3QuYXNzaWduKGJsb29kaG91bmRPcHRpb25zLCBiaE9wdGlvbnMpO1xuICBPYmplY3QuYXNzaWduKGJsb29kaG91bmRPcHRpb25zLnJlbW90ZSwgcmVtb3RlT3B0aW9ucyk7XG4gIHJldHVybiBuZXcgQmxvb2Rob3VuZChibG9vZGhvdW5kT3B0aW9ucyk7XG59XG5cbnZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdlb0NyZWF0ZUxvY2F0aW9uU2VhcmNoQmxvb2Rob3VuZCcsIFtdKTtcbm1vZHVsZS52YWx1ZSgnbmdlb0NyZWF0ZUxvY2F0aW9uU2VhcmNoQmxvb2Rob3VuZCcsIGNyZWF0ZUxvY2F0aW9uU2VhcmNoQmxvb2Rob3VuZCk7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTG9jYXRpb25TZWFyY2hCbG9vZGhvdW5kRnVuY3Rpb24oKSB7fVxuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9TZWFyY2hTZWFyY2hEaXJlY3RpdmUgZnJvbSAnbmdlby9zZWFyY2gvc2VhcmNoRGlyZWN0aXZlLmpzJztcbmltcG9ydCBuZ2VvU2VhcmNoQ3JlYXRlR2VvSlNPTkJsb29kaG91bmQgZnJvbSAnbmdlby9zZWFyY2gvY3JlYXRlR2VvSlNPTkJsb29kaG91bmQuanMnO1xuaW1wb3J0IG5nZW9TZWFyY2hDcmVhdGVMb2NhdGlvblNlYXJjaEJsb29kaG91bmQgZnJvbSAnbmdlby9zZWFyY2gvY3JlYXRlTG9jYXRpb25TZWFyY2hCbG9vZGhvdW5kLmpzJztcbmV4cG9ydCBkZWZhdWx0IGFuZ3VsYXIubW9kdWxlKCduZ2VvU2VhcmNoTW9kdWxlJywgW25nZW9TZWFyY2hTZWFyY2hEaXJlY3RpdmUubmFtZSwgbmdlb1NlYXJjaENyZWF0ZUdlb0pTT05CbG9vZGhvdW5kLm5hbWUsIG5nZW9TZWFyY2hDcmVhdGVMb2NhdGlvblNlYXJjaEJsb29kaG91bmQubmFtZV0pOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuXG5mdW5jdGlvbiBzZWFyY2hDb21wb25lbnQoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgdmFyIHR5cGVhaGVhZE9wdGlvbnNFeHByID0gYXR0cnMubmdlb1NlYXJjaDtcbiAgICAgIHZhciB0eXBlYWhlYWRPcHRpb25zID0gc2NvcGUuJGV2YWwodHlwZWFoZWFkT3B0aW9uc0V4cHIpO1xuICAgICAgdmFyIHR5cGVhaGVhZERhdGFzZXRzRXhwciA9IGF0dHJzLm5nZW9TZWFyY2hEYXRhc2V0cztcbiAgICAgIHZhciB0eXBlYWhlYWREYXRhc2V0cyA9IHNjb3BlLiRldmFsKHR5cGVhaGVhZERhdGFzZXRzRXhwcik7XG4gICAgICBlbGVtZW50LnR5cGVhaGVhZCh0eXBlYWhlYWRPcHRpb25zLCB0eXBlYWhlYWREYXRhc2V0cyk7XG4gICAgICB2YXIgdHlwZWFoZWFkTGlzdGVuZXJzRXhwciA9IGF0dHJzLm5nZW9TZWFyY2hMaXN0ZW5lcnM7XG4gICAgICB2YXIgdHlwZWFoZWFkTGlzdGVuZXJzXyA9IHNjb3BlLiRldmFsKHR5cGVhaGVhZExpc3RlbmVyc0V4cHIpO1xuICAgICAgdmFyIHR5cGVhaGVhZExpc3RlbmVycyA9IGFkYXB0TGlzdGVuZXJzXyh0eXBlYWhlYWRMaXN0ZW5lcnNfKTtcbiAgICAgIGVsZW1lbnQub24oJ3R5cGVhaGVhZDpvcGVuJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHR5cGVhaGVhZExpc3RlbmVycy5vcGVuKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBlbGVtZW50Lm9uKCd0eXBlYWhlYWQ6Y2xvc2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdHlwZWFoZWFkTGlzdGVuZXJzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBlbGVtZW50Lm9uKCd0eXBlYWhlYWQ6Y3Vyc29yY2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50LCBzdWdnZXN0aW9uLCBkYXRhc2V0KSB7XG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdHlwZWFoZWFkTGlzdGVuZXJzLmN1cnNvcmNoYW5nZShldmVudCwgc3VnZ2VzdGlvbiwgZGF0YXNldCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBlbGVtZW50Lm9uKCd0eXBlYWhlYWQ6c2VsZWN0JywgZnVuY3Rpb24gKGV2ZW50LCBzdWdnZXN0aW9uLCBkYXRhc2V0KSB7XG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdHlwZWFoZWFkTGlzdGVuZXJzLnNlbGVjdChldmVudCwgc3VnZ2VzdGlvbiwgZGF0YXNldCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBlbGVtZW50Lm9uKCd0eXBlYWhlYWQ6YXV0b2NvbXBsZXRlJywgZnVuY3Rpb24gKGV2ZW50LCBzdWdnZXN0aW9uLCBkYXRhc2V0KSB7XG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdHlwZWFoZWFkTGlzdGVuZXJzLmF1dG9jb21wbGV0ZShldmVudCwgc3VnZ2VzdGlvbiwgZGF0YXNldCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBlbGVtZW50Lm9uKCd0eXBlYWhlYWQ6YXN5bmNyZWNlaXZlJywgZnVuY3Rpb24gKGV2ZW50LCBkYXRhc2V0LCBxdWVyeSkge1xuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBlbXB0eSA9IGVsZW1lbnQuZGF0YSgndHQtdHlwZWFoZWFkJykubWVudS5fYWxsRGF0YXNldHNFbXB0eSgpO1xuXG4gICAgICAgICAgdHlwZWFoZWFkTGlzdGVuZXJzLmRhdGFzZXRzZW1wdHkoZXZlbnQsIHF1ZXJ5LCBlbXB0eSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBlbGVtZW50Lm9uKCd0eXBlYWhlYWQ6Y2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHF1ZXJ5ID0gZWxlbWVudC5kYXRhKCd0dC10eXBlYWhlYWQnKS5pbnB1dC5xdWVyeTtcbiAgICAgICAgICB0eXBlYWhlYWRMaXN0ZW5lcnMuY2hhbmdlKGV2ZW50LCBxdWVyeSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBhZGFwdExpc3RlbmVyc18ob2JqZWN0KSB7XG4gIHZhciB0eXBlYWhlYWRMaXN0ZW5lcnM7XG5cbiAgaWYgKG9iamVjdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdHlwZWFoZWFkTGlzdGVuZXJzID0ge1xuICAgICAgb3BlbjogZnVuY3Rpb24gb3BlbigpIHt9LFxuICAgICAgY2xvc2U6IGZ1bmN0aW9uIGNsb3NlKCkge30sXG4gICAgICBjdXJzb3JjaGFuZ2U6IGZ1bmN0aW9uIGN1cnNvcmNoYW5nZSgpIHt9LFxuICAgICAgZGF0YXNldHNlbXB0eTogZnVuY3Rpb24gZGF0YXNldHNlbXB0eSgpIHt9LFxuICAgICAgc2VsZWN0OiBmdW5jdGlvbiBzZWxlY3QoKSB7fSxcbiAgICAgIGF1dG9jb21wbGV0ZTogZnVuY3Rpb24gYXV0b2NvbXBsZXRlKCkge30sXG4gICAgICBjaGFuZ2U6IGZ1bmN0aW9uIGNoYW5nZSgpIHt9XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICB0eXBlYWhlYWRMaXN0ZW5lcnMgPSB7XG4gICAgICBvcGVuOiBvYmplY3Qub3BlbiAhPT0gdW5kZWZpbmVkID8gb2JqZWN0Lm9wZW4gOiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgIGNsb3NlOiBvYmplY3QuY2xvc2UgIT09IHVuZGVmaW5lZCA/IG9iamVjdC5jbG9zZSA6IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgY3Vyc29yY2hhbmdlOiBvYmplY3QuY3Vyc29yY2hhbmdlICE9PSB1bmRlZmluZWQgPyBvYmplY3QuY3Vyc29yY2hhbmdlIDogZnVuY3Rpb24gKCkge30sXG4gICAgICBkYXRhc2V0c2VtcHR5OiBvYmplY3QuZGF0YXNldHNlbXB0eSAhPT0gdW5kZWZpbmVkID8gb2JqZWN0LmRhdGFzZXRzZW1wdHkgOiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgIHNlbGVjdDogb2JqZWN0LnNlbGVjdCAhPT0gdW5kZWZpbmVkID8gb2JqZWN0LnNlbGVjdCA6IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgYXV0b2NvbXBsZXRlOiBvYmplY3QuYXV0b2NvbXBsZXRlICE9PSB1bmRlZmluZWQgPyBvYmplY3QuYXV0b2NvbXBsZXRlIDogZnVuY3Rpb24gKCkge30sXG4gICAgICBjaGFuZ2U6IG9iamVjdC5jaGFuZ2UgIT09IHVuZGVmaW5lZCA/IG9iamVjdC5jaGFuZ2UgOiBmdW5jdGlvbiAoKSB7fVxuICAgIH07XG4gIH1cblxuICByZXR1cm4gdHlwZWFoZWFkTGlzdGVuZXJzO1xufVxuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9TZWFyY2hEaXJlY3RpdmUnLCBbXSk7XG5tb2R1bGUuZGlyZWN0aXZlKCduZ2VvU2VhcmNoJywgc2VhcmNoQ29tcG9uZW50KTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJMb2NhdGlvbkZhY3RvcnkuJGluamVjdCA9IFtcIiRyb290U2NvcGVcIiwgXCIkd2luZG93XCJdO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBlbmNvZGVRdWVyeVN0cmluZywgZGVjb2RlUXVlcnlTdHJpbmcgfSBmcm9tICduZ2VvL3V0aWxzLmpzJztcbmV4cG9ydCBmdW5jdGlvbiBTdGF0ZW1hbmFnZXJMb2NhdGlvbihsb2NhdGlvbiwgaGlzdG9yeSkge1xuICB0aGlzLmhpc3RvcnlfID0gaGlzdG9yeTtcbiAgdGhpcy5zY2hlbWFfID0gbG9jYXRpb24ucHJvdG9jb2wuc3Vic3RyaW5nKDAsIGxvY2F0aW9uLnByb3RvY29sLmxlbmd0aCAtIDEpO1xuICB0aGlzLmRvbWFpbl8gPSBsb2NhdGlvbi5ob3N0bmFtZTtcbiAgdGhpcy5wb3J0XyA9IGxvY2F0aW9uLnBvcnQgPyBwYXJzZUludChsb2NhdGlvbi5wb3J0LCAxMCkgOiB1bmRlZmluZWQ7XG4gIHRoaXMucGF0aF8gPSBsb2NhdGlvbi5wYXRobmFtZTtcbiAgdGhpcy5xdWVyeURhdGFfID0gZGVjb2RlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoKTtcbiAgdGhpcy5mcmFnbWVudF8gPSBkZWNvZGVRdWVyeVN0cmluZyhsb2NhdGlvbi5oYXNoKTtcbn1cblxuZnVuY3Rpb24gcmVwbGFjZVN0YXRlKGhpc3RvcnksIHN0YXRlKSB7XG4gIHRyeSB7XG4gICAgaGlzdG9yeS5yZXBsYWNlU3RhdGUobnVsbCwgJycsIHN0YXRlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHt9XG59XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5nZXRQYXRoID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5wYXRoXztcbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5nZXRVcmlTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBvdXQgPSBbXTtcblxuICBpZiAodGhpcy5zY2hlbWFfKSB7XG4gICAgb3V0LnB1c2godGhpcy5zY2hlbWFfLCAnOicpO1xuICB9XG5cbiAgaWYgKHRoaXMuZG9tYWluXyB8fCB0aGlzLnNjaGVtYV8gPT09ICdmaWxlJykge1xuICAgIG91dC5wdXNoKCcvLycpO1xuICAgIG91dC5wdXNoKHRoaXMuZG9tYWluXyk7XG5cbiAgICBpZiAodGhpcy5wb3J0XyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBvdXQucHVzaCgnOicsIFN0cmluZyh0aGlzLnBvcnRfKSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHRoaXMucGF0aF8pIHtcbiAgICBpZiAodGhpcy5kb21haW5fICYmICF0aGlzLnBhdGhfLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgb3V0LnB1c2goJy8nKTtcbiAgICB9XG5cbiAgICBvdXQucHVzaCh0aGlzLnBhdGhfKTtcbiAgfVxuXG4gIHZhciBlbmNvZGVkUXVlcnlEYXRhID0gZW5jb2RlUXVlcnlTdHJpbmcodGhpcy5xdWVyeURhdGFfKTtcblxuICBpZiAoZW5jb2RlZFF1ZXJ5RGF0YS5sZW5ndGggPiAwKSB7XG4gICAgb3V0LnB1c2goJz8nLCBlbmNvZGVkUXVlcnlEYXRhKTtcbiAgfVxuXG4gIHZhciBlbmNvZGVkRnJhZ21lbnQgPSBlbmNvZGVRdWVyeVN0cmluZyh0aGlzLmZyYWdtZW50Xyk7XG5cbiAgaWYgKGVuY29kZWRGcmFnbWVudC5sZW5ndGggPiAwKSB7XG4gICAgb3V0LnB1c2goJyMnLCBlbmNvZGVkRnJhZ21lbnQpO1xuICB9XG5cbiAgcmV0dXJuIG91dC5qb2luKCcnKTtcbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5oYXNQYXJhbSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIGtleSBpbiB0aGlzLnF1ZXJ5RGF0YV87XG59O1xuXG5TdGF0ZW1hbmFnZXJMb2NhdGlvbi5wcm90b3R5cGUuaGFzRnJhZ21lbnRQYXJhbSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIGtleSBpbiB0aGlzLmZyYWdtZW50Xztcbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5nZXRQYXJhbSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIHRoaXMucXVlcnlEYXRhX1trZXldO1xufTtcblxuU3RhdGVtYW5hZ2VyTG9jYXRpb24ucHJvdG90eXBlLmdldEZyYWdtZW50UGFyYW0gPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHJldHVybiB0aGlzLmZyYWdtZW50X1trZXldO1xufTtcblxuU3RhdGVtYW5hZ2VyTG9jYXRpb24ucHJvdG90eXBlLmdldFBhcmFtQXNJbnQgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHZhciB2YWx1ZSA9IHRoaXMuZ2V0UGFyYW0oa2V5KTtcblxuICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBjb25zb2xlLmFzc2VydCh0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpO1xuICB2YXIgdmFsdWVBc0ludCA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gIHJldHVybiBpc05hTih2YWx1ZUFzSW50KSA/IHVuZGVmaW5lZCA6IHZhbHVlQXNJbnQ7XG59O1xuXG5TdGF0ZW1hbmFnZXJMb2NhdGlvbi5wcm90b3R5cGUuZ2V0UGFyYW1Bc0Zsb2F0ID0gZnVuY3Rpb24gKGtleSkge1xuICB2YXIgdmFsdWUgPSB0aGlzLmdldFBhcmFtKGtleSk7XG5cbiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgY29uc29sZS5hc3NlcnQodHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKTtcbiAgdmFyIHZhbHVlQXNGbG9hdCA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICByZXR1cm4gaXNOYU4odmFsdWVBc0Zsb2F0KSA/IHVuZGVmaW5lZCA6IHZhbHVlQXNGbG9hdDtcbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5nZXRGcmFnbWVudFBhcmFtQXNJbnQgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHZhciB2YWx1ZSA9IHRoaXMuZ2V0RnJhZ21lbnRQYXJhbShrZXkpO1xuXG4gIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGNvbnNvbGUuYXNzZXJ0KHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJyk7XG4gIHZhciB2YWx1ZUFzSW50ID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgcmV0dXJuIGlzTmFOKHZhbHVlQXNJbnQpID8gdW5kZWZpbmVkIDogdmFsdWVBc0ludDtcbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5nZXRQYXJhbUtleXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBrZXlzID0gW107XG5cbiAgZm9yICh2YXIga2V5IGluIHRoaXMucXVlcnlEYXRhXykge1xuICAgIGtleXMucHVzaChrZXkpO1xuICB9XG5cbiAgcmV0dXJuIGtleXM7XG59O1xuXG5TdGF0ZW1hbmFnZXJMb2NhdGlvbi5wcm90b3R5cGUuZ2V0RnJhZ21lbnRQYXJhbUtleXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBrZXlzID0gW107XG5cbiAgZm9yICh2YXIga2V5IGluIHRoaXMuZnJhZ21lbnRfKSB7XG4gICAga2V5cy5wdXNoKGtleSk7XG4gIH1cblxuICByZXR1cm4ga2V5cztcbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5nZXRQYXJhbUtleXNXaXRoUHJlZml4ID0gZnVuY3Rpb24gKHByZWZpeCkge1xuICB2YXIga2V5cyA9IFtdO1xuXG4gIGZvciAodmFyIGtleSBpbiB0aGlzLnF1ZXJ5RGF0YV8pIHtcbiAgICBpZiAoa2V5LnN0YXJ0c1dpdGgocHJlZml4KSkge1xuICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGtleXM7XG59O1xuXG5TdGF0ZW1hbmFnZXJMb2NhdGlvbi5wcm90b3R5cGUuZ2V0RnJhZ21lbnRQYXJhbUtleXNXaXRoUHJlZml4ID0gZnVuY3Rpb24gKHByZWZpeCkge1xuICB2YXIga2V5cyA9IFtdO1xuXG4gIGZvciAodmFyIGtleSBpbiB0aGlzLmZyYWdtZW50Xykge1xuICAgIGlmIChrZXkuc3RhcnRzV2l0aChwcmVmaXgpKSB7XG4gICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ga2V5cztcbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS51cGRhdGVQYXJhbXMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gIGZvciAodmFyIGtleSBpbiBwYXJhbXMpIHtcbiAgICB0aGlzLnF1ZXJ5RGF0YV9ba2V5XSA9IHBhcmFtc1trZXldO1xuICB9XG59O1xuXG5TdGF0ZW1hbmFnZXJMb2NhdGlvbi5wcm90b3R5cGUudXBkYXRlRnJhZ21lbnRQYXJhbXMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gIGZvciAodmFyIGtleSBpbiBwYXJhbXMpIHtcbiAgICB0aGlzLmZyYWdtZW50X1trZXldID0gcGFyYW1zW2tleV07XG4gIH1cbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5kZWxldGVQYXJhbSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgZGVsZXRlIHRoaXMucXVlcnlEYXRhX1trZXldO1xufTtcblxuU3RhdGVtYW5hZ2VyTG9jYXRpb24ucHJvdG90eXBlLmRlbGV0ZUZyYWdtZW50UGFyYW0gPSBmdW5jdGlvbiAoa2V5KSB7XG4gIGRlbGV0ZSB0aGlzLmZyYWdtZW50X1trZXldO1xufTtcblxuU3RhdGVtYW5hZ2VyTG9jYXRpb24ucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gIHJlcGxhY2VTdGF0ZSh0aGlzLmhpc3RvcnlfLCB0aGlzLmdldFVyaVN0cmluZygpKTtcbn07XG5cblN0YXRlbWFuYWdlckxvY2F0aW9uLnByb3RvdHlwZS5zZXRQYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgdGhpcy5wYXRoXyA9IHBhdGg7XG59O1xuXG5mdW5jdGlvbiBMb2NhdGlvbkZhY3RvcnkoJHJvb3RTY29wZSwgJHdpbmRvdykge1xuICB2YXIgaGlzdG9yeSA9ICR3aW5kb3cuaGlzdG9yeTtcbiAgdmFyIHNlcnZpY2UgPSBuZXcgU3RhdGVtYW5hZ2VyTG9jYXRpb24oJHdpbmRvdy5sb2NhdGlvbiwgJHdpbmRvdy5oaXN0b3J5KTtcbiAgdmFyIGxhc3RVcmkgPSBzZXJ2aWNlLmdldFVyaVN0cmluZygpO1xuICAkcm9vdFNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG5ld1VyaSA9IHNlcnZpY2UuZ2V0VXJpU3RyaW5nKCk7XG5cbiAgICBpZiAobGFzdFVyaSAhPT0gbmV3VXJpKSB7XG4gICAgICAkcm9vdFNjb3BlLiRldmFsQXN5bmMoZnVuY3Rpb24gKCkge1xuICAgICAgICBsYXN0VXJpID0gbmV3VXJpO1xuXG4gICAgICAgIGlmIChoaXN0b3J5ICE9PSB1bmRlZmluZWQgJiYgaGlzdG9yeS5yZXBsYWNlU3RhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHJlcGxhY2VTdGF0ZShoaXN0b3J5LCBuZXdVcmkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCduZ2VvTG9jYXRpb25DaGFuZ2UnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBzZXJ2aWNlO1xufVxuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9Mb2NhdGlvbicsIFtdKTtcbm1vZHVsZS5mYWN0b3J5KCduZ2VvTG9jYXRpb24nLCBMb2NhdGlvbkZhY3RvcnkpO1xuZXhwb3J0IGRlZmF1bHQgbW9kdWxlOyIsImltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IG5nZW9TdGF0ZW1hbmFnZXJMb2NhdGlvbiBmcm9tICduZ2VvL3N0YXRlbWFuYWdlci9Mb2NhdGlvbi5qcyc7XG5leHBvcnQgdmFyIFN0YXRlbWFuYWdlclNlcnZpY2UgPSBmdW5jdGlvbiAoKSB7XG4gIFN0YXRlbWFuYWdlclNlcnZpY2UuJGluamVjdCA9IFtcIm5nZW9Mb2NhdGlvblwiLCBcIm5nZW9Vc2VkS2V5UmVnZXhwXCJdO1xuXG4gIGZ1bmN0aW9uIFN0YXRlbWFuYWdlclNlcnZpY2Uobmdlb0xvY2F0aW9uLCBuZ2VvVXNlZEtleVJlZ2V4cCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB0aGlzLmluaXRpYWxTdGF0ZSA9IHt9O1xuICAgIHRoaXMubmdlb0xvY2F0aW9uID0gbmdlb0xvY2F0aW9uO1xuICAgIHRoaXMudXNlZEtleVJlZ2V4cCA9IG5nZW9Vc2VkS2V5UmVnZXhwO1xuICAgIHRoaXMudXNlTG9jYWxTdG9yYWdlXyA9IGZhbHNlO1xuICAgIHRoaXMuc2V0VXNlTG9jYWxTdG9yYWdlKGZhbHNlKTtcbiAgICB2YXIgcGFyYW1LZXlzID0gbmdlb0xvY2F0aW9uLmdldFBhcmFtS2V5cygpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG4gICAgICByZXR1cm4ga2V5ICE9ICdkZWJ1ZycgJiYga2V5ICE9ICdub19yZWRpcmVjdCc7XG4gICAgfSk7XG5cbiAgICBpZiAocGFyYW1LZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgaWYgKHRoaXMudXNlTG9jYWxTdG9yYWdlXykge1xuICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChrZXkpIHtcbiAgICAgICAgICBjb25zb2xlLmFzc2VydChrZXkpO1xuXG4gICAgICAgICAgX3RoaXMudXNlZEtleVJlZ2V4cC5zb21lKGZ1bmN0aW9uIChrZXlSZWdleHApIHtcbiAgICAgICAgICAgIGlmIChrZXkubWF0Y2goa2V5UmVnZXhwKSkge1xuICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB3aW5kb3cubG9jYWxTdG9yYWdlW2tleV07XG5cbiAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgfHwgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbml0aWFsU3RhdGVba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIF90aGlzLmluaXRpYWxTdGF0ZVtrZXldID0gJyc7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGZvciAodmFyIGtleSBpbiB3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgX2xvb3Aoa2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBwYXJhbUtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIF90aGlzLnVzZWRLZXlSZWdleHAuc29tZShmdW5jdGlvbiAoa2V5UmVnZXhwKSB7XG4gICAgICAgICAgaWYgKGtleS5tYXRjaChrZXlSZWdleHApKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBfdGhpcy5uZ2VvTG9jYXRpb24uZ2V0UGFyYW0oa2V5KTtcblxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgX3RoaXMuaW5pdGlhbFN0YXRlW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBTdGF0ZW1hbmFnZXJTZXJ2aWNlLnByb3RvdHlwZTtcblxuICBfcHJvdG8uc2V0VXNlTG9jYWxTdG9yYWdlID0gZnVuY3Rpb24gc2V0VXNlTG9jYWxTdG9yYWdlKHZhbHVlKSB7XG4gICAgdGhpcy51c2VMb2NhbFN0b3JhZ2VfID0gdmFsdWU7XG5cbiAgICBpZiAodGhpcy51c2VMb2NhbFN0b3JhZ2VfKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoJ2xvY2FsU3RvcmFnZScgaW4gd2luZG93KSB7XG4gICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZVsndGVzdCddID0gJyc7XG4gICAgICAgICAgZGVsZXRlIHdpbmRvdy5sb2NhbFN0b3JhZ2VbJ3Rlc3QnXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnVzZUxvY2FsU3RvcmFnZV8gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgdGhpcy51c2VMb2NhbFN0b3JhZ2VfID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMudXNlTG9jYWxTdG9yYWdlXztcbiAgfTtcblxuICBfcHJvdG8uZ2V0SW5pdGlhbFN0cmluZ1ZhbHVlID0gZnVuY3Rpb24gZ2V0SW5pdGlhbFN0cmluZ1ZhbHVlKGtleSkge1xuICAgIHJldHVybiB0aGlzLmluaXRpYWxTdGF0ZVtrZXldO1xuICB9O1xuXG4gIF9wcm90by5nZXRJbml0aWFsTnVtYmVyVmFsdWUgPSBmdW5jdGlvbiBnZXRJbml0aWFsTnVtYmVyVmFsdWUoa2V5KSB7XG4gICAgdmFyIHZhbHVlID0gdGhpcy5pbml0aWFsU3RhdGVba2V5XTtcblxuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgfTtcblxuICBfcHJvdG8uZ2V0SW5pdGlhbEJvb2xlYW5WYWx1ZSA9IGZ1bmN0aW9uIGdldEluaXRpYWxCb29sZWFuVmFsdWUoa2V5KSB7XG4gICAgdmFyIHZhbHVlID0gdGhpcy5pbml0aWFsU3RhdGVba2V5XTtcblxuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZSA9PT0gJ3RydWUnO1xuICB9O1xuXG4gIF9wcm90by51cGRhdGVTdGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZVN0YXRlKG9iamVjdCkge1xuICAgIHRoaXMubmdlb0xvY2F0aW9uLnVwZGF0ZVBhcmFtcyhvYmplY3QpO1xuXG4gICAgaWYgKHRoaXMudXNlTG9jYWxTdG9yYWdlXykge1xuICAgICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkge1xuICAgICAgICBjb25zb2xlLmFzc2VydChrZXkpO1xuICAgICAgICB2YXIgdmFsdWUgPSBvYmplY3Rba2V5XTtcbiAgICAgICAgY29uc29sZS5hc3NlcnQodmFsdWUgIT09IHVuZGVmaW5lZCk7XG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Vba2V5XSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uZGVsZXRlUGFyYW0gPSBmdW5jdGlvbiBkZWxldGVQYXJhbShrZXkpIHtcbiAgICB0aGlzLm5nZW9Mb2NhdGlvbi5kZWxldGVQYXJhbShrZXkpO1xuXG4gICAgaWYgKHRoaXMudXNlTG9jYWxTdG9yYWdlXykge1xuICAgICAgZGVsZXRlIHdpbmRvdy5sb2NhbFN0b3JhZ2Vba2V5XTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFN0YXRlbWFuYWdlclNlcnZpY2U7XG59KCk7XG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9TdGF0ZU1hbmFnZXInLCBbbmdlb1N0YXRlbWFuYWdlckxvY2F0aW9uLm5hbWVdKTtcbm1vZHVsZS5zZXJ2aWNlKCduZ2VvU3RhdGVNYW5hZ2VyJywgU3RhdGVtYW5hZ2VyU2VydmljZSk7XG5tb2R1bGUudmFsdWUoJ25nZW9Vc2VkS2V5UmVnZXhwJywgW25ldyBSZWdFeHAoJy4qJyldKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJXZnNQZXJtYWxpbmtTZXJ2aWNlLiRpbmplY3QgPSBbXCIkaHR0cFwiLCBcIm5nZW9QZXJtYWxpbmtPZ2NzZXJ2ZXJVcmxcIiwgXCJuZ2VvUXVlcnlSZXN1bHRcIiwgXCJuZ2VvV2ZzUGVybWFsaW5rT3B0aW9uc1wiXTtcbmltcG9ydCBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgZXh0ZW5kIGFzIGV4dGVuZEV4dGVudCwgY3JlYXRlRW1wdHkgYXMgY3JlYXRlRW1wdHlFeHRlbnQgfSBmcm9tICdvbC9leHRlbnQuanMnO1xuaW1wb3J0IEZlYXR1cmUgZnJvbSAnb2wvRmVhdHVyZS5qcyc7XG5pbXBvcnQgeyBlcXVhbFRvLCBhbmQsIG9yIH0gZnJvbSAnb2wvZm9ybWF0L2ZpbHRlci5qcyc7XG5pbXBvcnQgb2xGb3JtYXRXRlMgZnJvbSAnb2wvZm9ybWF0L1dGUy5qcyc7XG5leHBvcnQgZnVuY3Rpb24gV2ZzUGVybWFsaW5rU2VydmljZSgkaHR0cCwgbmdlb1Blcm1hbGlua09nY3NlcnZlclVybCwgbmdlb1F1ZXJ5UmVzdWx0LCBuZ2VvV2ZzUGVybWFsaW5rT3B0aW9ucykge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIHZhciBvcHRpb25zID0gbmdlb1dmc1Blcm1hbGlua09wdGlvbnM7XG4gIHRoaXMudXJsXyA9IG5nZW9QZXJtYWxpbmtPZ2NzZXJ2ZXJVcmw7XG4gIHRoaXMubWF4RmVhdHVyZXNfID0gb3B0aW9ucy5tYXhGZWF0dXJlcyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5tYXhGZWF0dXJlcyA6IDUwO1xuICB0aGlzLndmc1R5cGVzXyA9IHt9O1xuICBjb25zb2xlLmFzc2VydChBcnJheS5pc0FycmF5KG9wdGlvbnMud2ZzVHlwZXMpLCAnd2ZzVHlwZXMgaXMgbm90IGNvcnJlY3RseSBzZXQnKTtcbiAgb3B0aW9ucy53ZnNUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uICh3ZnNUeXBlKSB7XG4gICAgX3RoaXMud2ZzVHlwZXNfW3dmc1R5cGUuZmVhdHVyZVR5cGVdID0gd2ZzVHlwZTtcbiAgfSk7XG4gIHRoaXMuZGVmYXVsdEZlYXR1cmVOU18gPSBvcHRpb25zLmRlZmF1bHRGZWF0dXJlTlM7XG4gIHRoaXMuZGVmYXVsdEZlYXR1cmVQcmVmaXhfID0gb3B0aW9ucy5kZWZhdWx0RmVhdHVyZVByZWZpeDtcbiAgdGhpcy5wb2ludFJlY2VudGVyWm9vbV8gPSBvcHRpb25zLnBvaW50UmVjZW50ZXJab29tO1xuICB0aGlzLiRodHRwXyA9ICRodHRwO1xuICB0aGlzLnJlc3VsdF8gPSBuZ2VvUXVlcnlSZXN1bHQ7XG59XG5cbldmc1Blcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmNsZWFyUmVzdWx0XygpO1xufTtcblxuV2ZzUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuaXNzdWUgPSBmdW5jdGlvbiAocXVlcnlEYXRhLCBtYXApIHtcbiAgY29uc29sZS5hc3NlcnQodGhpcy51cmxfLCAndXJsIGlzIG5vdCBzZXQuIHRvIHVzZSB0aGUgd2ZzIHBlcm1hbGluayBzZXJ2aWNlLCAnICsgJ3NldCB0aGUgdmFsdWUgYG5nZW9XZnNQZXJtYWxpbmtPcHRpb25zYCcpO1xuICB0aGlzLmNsZWFyUmVzdWx0XygpO1xuICB2YXIgdHlwZU5hbWUgPSBxdWVyeURhdGEud2ZzVHlwZTtcblxuICBpZiAoIXRoaXMud2ZzVHlwZXNfLmhhc093blByb3BlcnR5KHR5cGVOYW1lKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciB3ZnNUeXBlID0gdGhpcy53ZnNUeXBlc19bdHlwZU5hbWVdO1xuICB2YXIgZmlsdGVycyA9IHRoaXMuY3JlYXRlRmlsdGVyc18ocXVlcnlEYXRhLmZpbHRlckdyb3Vwcyk7XG5cbiAgaWYgKGZpbHRlcnMgPT09IG51bGwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLmlzc3VlUmVxdWVzdF8od2ZzVHlwZSwgZmlsdGVycywgbWFwLCBxdWVyeURhdGEuc2hvd0ZlYXR1cmVzKTtcbn07XG5cbldmc1Blcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmlzc3VlUmVxdWVzdF8gPSBmdW5jdGlvbiAod2ZzVHlwZSwgZmlsdGVyLCBtYXAsIHNob3dGZWF0dXJlcykge1xuICB2YXIgX3RoaXMyID0gdGhpcztcblxuICB2YXIgd2ZzRm9ybWF0ID0gbmV3IG9sRm9ybWF0V0ZTKCk7XG4gIHZhciBmZWF0dXJlUmVxdWVzdFhtbCA9IHdmc0Zvcm1hdC53cml0ZUdldEZlYXR1cmUoe1xuICAgIHNyc05hbWU6IG1hcC5nZXRWaWV3KCkuZ2V0UHJvamVjdGlvbigpLmdldENvZGUoKSxcbiAgICBmZWF0dXJlTlM6IHdmc1R5cGUuZmVhdHVyZU5TICE9PSB1bmRlZmluZWQgPyB3ZnNUeXBlLmZlYXR1cmVOUyA6IHRoaXMuZGVmYXVsdEZlYXR1cmVOU18sXG4gICAgZmVhdHVyZVByZWZpeDogd2ZzVHlwZS5mZWF0dXJlUHJlZml4ICE9PSB1bmRlZmluZWQgPyB3ZnNUeXBlLmZlYXR1cmVQcmVmaXggOiB0aGlzLmRlZmF1bHRGZWF0dXJlUHJlZml4XyxcbiAgICBmZWF0dXJlVHlwZXM6IFt3ZnNUeXBlLmZlYXR1cmVUeXBlXSxcbiAgICBvdXRwdXRGb3JtYXQ6ICdHTUwzJyxcbiAgICBmaWx0ZXI6IGZpbHRlcixcbiAgICBtYXhGZWF0dXJlczogdGhpcy5tYXhGZWF0dXJlc19cbiAgfSk7XG4gIHZhciBmZWF0dXJlUmVxdWVzdCA9IG5ldyBYTUxTZXJpYWxpemVyKCkuc2VyaWFsaXplVG9TdHJpbmcoZmVhdHVyZVJlcXVlc3RYbWwpO1xuICB2YXIgY29uZmlnID0ge1xuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC94bWw7IGNoYXJzZXQ9VVRGLTgnXG4gICAgfVxuICB9O1xuICB0aGlzLiRodHRwXy5wb3N0KHRoaXMudXJsXywgZmVhdHVyZVJlcXVlc3QsIGNvbmZpZykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICB2YXIgZmVhdHVyZXMgPSB3ZnNGb3JtYXQucmVhZEZlYXR1cmVzKHJlc3BvbnNlLmRhdGEpO1xuXG4gICAgaWYgKGZlYXR1cmVzLmxlbmd0aCA9PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHNpemUgPSBtYXAuZ2V0U2l6ZSgpO1xuXG4gICAgaWYgKHNpemUgIT09IHVuZGVmaW5lZCAmJiBfdGhpczIucG9pbnRSZWNlbnRlclpvb21fICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhciBtYXhab29tID0gX3RoaXMyLnBvaW50UmVjZW50ZXJab29tXztcbiAgICAgIHZhciBwYWRkaW5nID0gWzEwLCAxMCwgMTAsIDEwXTtcbiAgICAgIG1hcC5nZXRWaWV3KCkuZml0KF90aGlzMi5nZXRFeHRlbnRfKGZlYXR1cmVzKSwge1xuICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICBtYXhab29tOiBtYXhab29tLFxuICAgICAgICBwYWRkaW5nOiBwYWRkaW5nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoc2hvd0ZlYXR1cmVzKSB7XG4gICAgICB2YXIgcmVzdWx0U291cmNlID0ge1xuICAgICAgICAnZmVhdHVyZXMnOiBmZWF0dXJlcyxcbiAgICAgICAgJ2lkJzogd2ZzVHlwZS5mZWF0dXJlVHlwZSxcbiAgICAgICAgJ2lkZW50aWZpZXJBdHRyaWJ1dGVGaWVsZCc6IHdmc1R5cGUubGFiZWwsXG4gICAgICAgICdsYWJlbCc6IHdmc1R5cGUuZmVhdHVyZVR5cGUsXG4gICAgICAgICdwZW5kaW5nJzogZmFsc2VcbiAgICAgIH07XG5cbiAgICAgIF90aGlzMi5yZXN1bHRfLnNvdXJjZXMucHVzaChyZXN1bHRTb3VyY2UpO1xuXG4gICAgICBfdGhpczIucmVzdWx0Xy50b3RhbCA9IGZlYXR1cmVzLmxlbmd0aDtcbiAgICB9XG4gIH0pO1xufTtcblxuV2ZzUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuZ2V0RXh0ZW50XyA9IGZ1bmN0aW9uIChmZWF0dXJlcykge1xuICByZXR1cm4gZmVhdHVyZXMucmVkdWNlKGZ1bmN0aW9uIChleHRlbnQsIGZlYXR1cmUpIHtcbiAgICBpZiAoZmVhdHVyZSBpbnN0YW5jZW9mIEZlYXR1cmUpIHtcbiAgICAgIHZhciBnZW9tZXRyeSA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKTtcblxuICAgICAgaWYgKGdlb21ldHJ5KSB7XG4gICAgICAgIHJldHVybiBleHRlbmRFeHRlbnQoZXh0ZW50LCBnZW9tZXRyeS5nZXRFeHRlbnQoKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBleHRlbnQ7XG4gICAgfVxuICB9LCBjcmVhdGVFbXB0eUV4dGVudCgpKTtcbn07XG5cbldmc1Blcm1hbGlua1NlcnZpY2UucHJvdG90eXBlLmNyZWF0ZUZpbHRlcnNfID0gZnVuY3Rpb24gKGZpbHRlckdyb3Vwcykge1xuICBpZiAoZmlsdGVyR3JvdXBzLmxlbmd0aCA9PSAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB2YXIgY3JlYXRlRmlsdGVyc0Zvckdyb3VwID0gZnVuY3Rpb24gY3JlYXRlRmlsdGVyc0Zvckdyb3VwKGZpbHRlckdyb3VwKSB7XG4gICAgdmFyIGZpbHRlcnMgPSBmaWx0ZXJHcm91cC5maWx0ZXJzLm1hcChmdW5jdGlvbiAoZmlsdGVyRGVmKSB7XG4gICAgICB2YXIgY29uZGl0aW9uID0gZmlsdGVyRGVmLmNvbmRpdGlvbjtcblxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29uZGl0aW9uKSkge1xuICAgICAgICByZXR1cm4gV2ZzUGVybWFsaW5rU2VydmljZS5vcl8oY29uZGl0aW9uLm1hcChmdW5jdGlvbiAoY29uZCkge1xuICAgICAgICAgIHJldHVybiBlcXVhbFRvKGZpbHRlckRlZi5wcm9wZXJ0eSwgY29uZCk7XG4gICAgICAgIH0pKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBlcXVhbFRvKGZpbHRlckRlZi5wcm9wZXJ0eSwgY29uZGl0aW9uKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gV2ZzUGVybWFsaW5rU2VydmljZS5hbmRfKGZpbHRlcnMpO1xuICB9O1xuXG4gIHZhciBmaWx0ZXJzID0gZmlsdGVyR3JvdXBzLm1hcChjcmVhdGVGaWx0ZXJzRm9yR3JvdXApO1xuXG4gIGlmIChmaWx0ZXJzKSB7XG4gICAgcmV0dXJuIFdmc1Blcm1hbGlua1NlcnZpY2Uub3JfKGZpbHRlcnMpO1xuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59O1xuXG5XZnNQZXJtYWxpbmtTZXJ2aWNlLmFuZF8gPSBmdW5jdGlvbiAoZmlsdGVycykge1xuICByZXR1cm4gV2ZzUGVybWFsaW5rU2VydmljZS5qb2luRmlsdGVyc18oZmlsdGVycywgYW5kKTtcbn07XG5cbldmc1Blcm1hbGlua1NlcnZpY2Uub3JfID0gZnVuY3Rpb24gKGZpbHRlcnMpIHtcbiAgcmV0dXJuIFdmc1Blcm1hbGlua1NlcnZpY2Uuam9pbkZpbHRlcnNfKGZpbHRlcnMsIG9yKTtcbn07XG5cbldmc1Blcm1hbGlua1NlcnZpY2Uuam9pbkZpbHRlcnNfID0gZnVuY3Rpb24gKGZpbHRlcnMsIGpvaW5Gbikge1xuICByZXR1cm4gZmlsdGVycy5yZWR1Y2UoZnVuY3Rpb24gKGNvbWJpbmVkRmlsdGVycywgY3VycmVudEZpbHRlcikge1xuICAgIGlmIChjb21iaW5lZEZpbHRlcnMgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBjdXJyZW50RmlsdGVyO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmFzc2VydChjdXJyZW50RmlsdGVyICE9PSBudWxsKTtcbiAgICAgIHJldHVybiBqb2luRm4oY29tYmluZWRGaWx0ZXJzLCBjdXJyZW50RmlsdGVyKTtcbiAgICB9XG4gIH0pO1xufTtcblxuV2ZzUGVybWFsaW5rU2VydmljZS5wcm90b3R5cGUuY2xlYXJSZXN1bHRfID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnJlc3VsdF8udG90YWwgPSAwO1xuICB0aGlzLnJlc3VsdF8uc291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICBzb3VyY2UuZmVhdHVyZXMubGVuZ3RoID0gMDtcbiAgfSk7XG59O1xuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nZW9XZnNQZXJtYWxpbmsnLCBbXSk7XG5tb2R1bGUudmFsdWUoJ25nZW9QZXJtYWxpbmtPZ2NzZXJ2ZXJVcmwnLCAnJyk7XG5tb2R1bGUudmFsdWUoJ25nZW9XZnNQZXJtYWxpbmtPcHRpb25zJywge1xuICB1cmw6ICcnLFxuICB3ZnNUeXBlczogW10sXG4gIGRlZmF1bHRGZWF0dXJlTlM6ICcnLFxuICBkZWZhdWx0RmVhdHVyZVByZWZpeDogJydcbn0pO1xubW9kdWxlLnNlcnZpY2UoJ25nZW9XZnNQZXJtYWxpbmsnLCBXZnNQZXJtYWxpbmtTZXJ2aWNlKTtcbmV4cG9ydCBkZWZhdWx0IG1vZHVsZTsiLCJpbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCBuZ2VvU3RhdGVtYW5hZ2VyTG9jYXRpb24gZnJvbSAnbmdlby9zdGF0ZW1hbmFnZXIvTG9jYXRpb24uanMnO1xuaW1wb3J0IG5nZW9TdGF0ZW1hbmFnZXJTZXJ2aWNlIGZyb20gJ25nZW8vc3RhdGVtYW5hZ2VyL1NlcnZpY2UuanMnO1xuZXhwb3J0IGRlZmF1bHQgYW5ndWxhci5tb2R1bGUoJ25nZW9TdGF0ZW1hbmFnZXJNb2R1bGUnLCBbbmdlb1N0YXRlbWFuYWdlckxvY2F0aW9uLm5hbWUsIG5nZW9TdGF0ZW1hbmFnZXJTZXJ2aWNlLm5hbWVdKTsiLCJpbXBvcnQgeyBub01vZGlmaWVyS2V5cywgc2luZ2xlQ2xpY2sgfSBmcm9tICdvbC9ldmVudHMvY29uZGl0aW9uLmpzJztcbmltcG9ydCBvbEdlb21MaW5lU3RyaW5nIGZyb20gJ29sL2dlb20vTGluZVN0cmluZy5qcyc7XG5pbXBvcnQgb2xHZW9tTXVsdGlQb2ludCBmcm9tICdvbC9nZW9tL011bHRpUG9pbnQuanMnO1xuaW1wb3J0IG9sR2VvbU11bHRpTGluZVN0cmluZyBmcm9tICdvbC9nZW9tL011bHRpTGluZVN0cmluZy5qcyc7XG5pbXBvcnQgb2xHZW9tTXVsdGlQb2x5Z29uIGZyb20gJ29sL2dlb20vTXVsdGlQb2x5Z29uLmpzJztcbmltcG9ydCBvbEdlb21Qb2ludCBmcm9tICdvbC9nZW9tL1BvaW50LmpzJztcbmltcG9ydCBvbEdlb21Qb2x5Z29uIGZyb20gJ29sL2dlb20vUG9seWdvbi5qcyc7XG5pbXBvcnQgeyBnZXRUb3BMZWZ0LCBnZXRUb3BSaWdodCwgZ2V0Qm90dG9tTGVmdCwgZ2V0Qm90dG9tUmlnaHQgfSBmcm9tICdvbC9leHRlbnQuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIGhhc0NvYXJzZVBvaW50aW5nRGV2aWNlKCkge1xuICByZXR1cm4gbWF0Y2hNZWRpYSgnKHBvaW50ZXI6IGNvYXJzZSknKS5tYXRjaGVzO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEJyb3dzZXJMYW5ndWFnZShhdmFpbGFibGVMYW5ndWFnZXMpIHtcbiAgdmFyIGJyb3dzZXJMYW5ndWFnZXMgPSB3aW5kb3cubmF2aWdhdG9yLmxhbmd1YWdlcyB8fCBbd2luZG93Lm5hdmlnYXRvci5sYW5ndWFnZV07XG4gIGJyb3dzZXJMYW5ndWFnZXMgPSBicm93c2VyTGFuZ3VhZ2VzLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgIHJldHVybiBpdGVtLnN1YnN0cmluZygwLCAyKTtcbiAgfSk7XG4gIGJyb3dzZXJMYW5ndWFnZXMgPSBicm93c2VyTGFuZ3VhZ2VzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSwgaW5kZXgsIGFycikge1xuICAgIHJldHVybiBhcnIuaW5kZXhPZihpdGVtKSA9PSBpbmRleDtcbiAgfSk7XG4gIHZhciBzdXBwb3J0ZWRMYW5ndWFnZXMgPSBicm93c2VyTGFuZ3VhZ2VzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuICAgIHJldHVybiBhdmFpbGFibGVMYW5ndWFnZXMuaW5jbHVkZXMoaXRlbSk7XG4gIH0pO1xuICByZXR1cm4gc3VwcG9ydGVkTGFuZ3VhZ2VzWzBdO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHRvTXVsdGkoZ2VvbWV0cnkpIHtcbiAgdmFyIG11bHRpR2VvbTtcblxuICBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21Qb2ludCkge1xuICAgIHZhciBtdWx0aUdlb21Qb2ludCA9IG5ldyBvbEdlb21NdWx0aVBvaW50KFtdKTtcbiAgICBtdWx0aUdlb21Qb2ludC5hcHBlbmRQb2ludChnZW9tZXRyeSk7XG4gICAgbXVsdGlHZW9tID0gbXVsdGlHZW9tUG9pbnQ7XG4gIH0gZWxzZSBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21MaW5lU3RyaW5nKSB7XG4gICAgdmFyIG11bHRpR2VvbUxpbmUgPSBuZXcgb2xHZW9tTXVsdGlMaW5lU3RyaW5nKFtdKTtcbiAgICBtdWx0aUdlb21MaW5lLmFwcGVuZExpbmVTdHJpbmcoZ2VvbWV0cnkpO1xuICAgIG11bHRpR2VvbSA9IG11bHRpR2VvbUxpbmU7XG4gIH0gZWxzZSBpZiAoZ2VvbWV0cnkgaW5zdGFuY2VvZiBvbEdlb21Qb2x5Z29uKSB7XG4gICAgdmFyIG11bHRpR2VvbVBvbHlnb24gPSBuZXcgb2xHZW9tTXVsdGlQb2x5Z29uKFtdKTtcbiAgICBtdWx0aUdlb21Qb2x5Z29uLmFwcGVuZFBvbHlnb24oZ2VvbWV0cnkpO1xuICAgIG11bHRpR2VvbSA9IG11bHRpR2VvbVBvbHlnb247XG4gIH0gZWxzZSB7XG4gICAgbXVsdGlHZW9tID0gZ2VvbWV0cnk7XG4gIH1cblxuICByZXR1cm4gbXVsdGlHZW9tO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzU2FmYXJpKCkge1xuICByZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmNsdWRlcygnU2FmYXJpJykgJiYgIW5hdmlnYXRvci51c2VyQWdlbnQuaW5jbHVkZXMoJ0Nocm9tZScpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNvbG9yWmVyb1BhZGRpbmcoaGV4KSB7XG4gIHJldHVybiBoZXgubGVuZ3RoID09IDEgPyBcIjBcIiArIGhleCA6IGhleDtcbn1cbmV4cG9ydCBmdW5jdGlvbiByZ2JBcnJheVRvSGV4KHJnYikge1xuICB2YXIgciA9IHJnYlswXTtcbiAgdmFyIGcgPSByZ2JbMV07XG4gIHZhciBiID0gcmdiWzJdO1xuXG4gIGlmIChyICE9IChyICYgMjU1KSB8fCBnICE9IChnICYgMjU1KSB8fCBiICE9IChiICYgMjU1KSkge1xuICAgIHRocm93IEVycm9yKFwiXFxcIihcIiArIHIgKyBcIixcIiArIGcgKyBcIixcIiArIGIgKyBcIilcXFwiIGlzIG5vdCBhIHZhbGlkIFJHQiBjb2xvclwiKTtcbiAgfVxuXG4gIHZhciBoZXhSID0gY29sb3JaZXJvUGFkZGluZyhyLnRvU3RyaW5nKDE2KSk7XG4gIHZhciBoZXhHID0gY29sb3JaZXJvUGFkZGluZyhnLnRvU3RyaW5nKDE2KSk7XG4gIHZhciBoZXhCID0gY29sb3JaZXJvUGFkZGluZyhiLnRvU3RyaW5nKDE2KSk7XG4gIHJldHVybiBcIiNcIiArIGhleFIgKyBoZXhHICsgaGV4Qjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGVRdWVyeVN0cmluZyhxdWVyeVN0cmluZykge1xuICB2YXIgcXVlcnlEYXRhID0ge307XG5cbiAgaWYgKHF1ZXJ5U3RyaW5nKSB7XG4gICAgdmFyIHBhaXJzID0gcXVlcnlTdHJpbmcuc3Vic3RyaW5nKDEpLnNwbGl0KCcmJyk7XG5cbiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBwYWlycywgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvciksIF9pID0gMCwgX2l0ZXJhdG9yID0gX2lzQXJyYXkgPyBfaXRlcmF0b3IgOiBfaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcbiAgICAgIHZhciBfcmVmO1xuXG4gICAgICBpZiAoX2lzQXJyYXkpIHtcbiAgICAgICAgaWYgKF9pID49IF9pdGVyYXRvci5sZW5ndGgpIGJyZWFrO1xuICAgICAgICBfcmVmID0gX2l0ZXJhdG9yW19pKytdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2kgPSBfaXRlcmF0b3IubmV4dCgpO1xuICAgICAgICBpZiAoX2kuZG9uZSkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaS52YWx1ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIHBhaXIgPSBfcmVmO1xuICAgICAgdmFyIGluZGV4T2ZFcXVhbHMgPSBwYWlyLmluZGV4T2YoJz0nKTtcblxuICAgICAgaWYgKGluZGV4T2ZFcXVhbHMgPj0gMCkge1xuICAgICAgICB2YXIgbmFtZSA9IHBhaXIuc3Vic3RyaW5nKDAsIGluZGV4T2ZFcXVhbHMpO1xuICAgICAgICB2YXIgdmFsdWUgPSBwYWlyLnN1YnN0cmluZyhpbmRleE9mRXF1YWxzICsgMSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBxdWVyeURhdGFbZGVjb2RlVVJJQ29tcG9uZW50KG5hbWUpXSA9IGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIk1hbGZvcm1lZCBwYXJhbWV0ZXI6IFwiICsgbmFtZSArIFwiPVwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBxdWVyeURhdGFbcGFpcl0gPSAnJztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gcXVlcnlEYXRhO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZVF1ZXJ5U3RyaW5nKHF1ZXJ5RGF0YSkge1xuICB2YXIgcXVlcnlJdGVtID0gW107XG5cbiAgZm9yICh2YXIga2V5IGluIHF1ZXJ5RGF0YSkge1xuICAgIHZhciB2YWx1ZSA9IHF1ZXJ5RGF0YVtrZXldO1xuICAgIHF1ZXJ5SXRlbS5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKTtcbiAgfVxuXG4gIHJldHVybiBxdWVyeUl0ZW0uam9pbignJicpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUNvbmRpdGlvbihldmVudCkge1xuICByZXR1cm4gbm9Nb2RpZmllcktleXMoZXZlbnQpICYmIHNpbmdsZUNsaWNrKGV2ZW50KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBleHRlbnRUb1JlY3RhbmdsZShleHRlbnQpIHtcbiAgdmFyIHJlc3VsdCA9IFtnZXRUb3BMZWZ0KGV4dGVudCksIGdldFRvcFJpZ2h0KGV4dGVudCksIGdldEJvdHRvbVJpZ2h0KGV4dGVudCksIGdldEJvdHRvbUxlZnQoZXh0ZW50KSwgZ2V0VG9wTGVmdChleHRlbnQpXTtcbiAgcmV0dXJuIHJlc3VsdDtcbn0iXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDbEZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDNUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdE1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDaFFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUM5SEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaE9BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN6REE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2hlQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDOUtBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbERBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDTEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUM5YUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdkZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNOQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzF6QkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDN0JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3RCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ05BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQ25QQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3BCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDaGVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDeEpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDSEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUM3RUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDOUJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDeGFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3BCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3ZIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNQQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN2SkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUN6V0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDSEE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDbldBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDVkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQ3ZEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3ZEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNwQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDMVlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3RaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3BCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDOWdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNWQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNwRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNQQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN09BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDOUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN6R0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ3g3Q0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDakRBOzs7Ozs7Ozs7Ozs7QUNBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNwRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDLzRCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN0Y0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNwR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0pBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbG5CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDcllBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDNUJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNqTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDenNCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDSkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUM5RUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzdiQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDL0RBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzdFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQSxXQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0EsV0FJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ25nR0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMxQkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDL0JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMxR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzdIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDYkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN4Q0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDaE1BO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNIQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDekJBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbkNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNiQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNmQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUM1RUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdkNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN6QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMvR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ0hBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3RCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdkNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDOUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDakNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDMUZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3ZCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNaQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDSkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNWQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3BCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDSEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3BGQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDUEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDekxBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDSkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDRkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3RDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUM3Q0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3JEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDZEE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0hBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2xFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzlFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMxRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDeERBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNmQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN2REE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMxQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDcERBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ2ZBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0ZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzNHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUM1SUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDM0JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNmQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDWEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDekNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNoQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3pCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3BCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNyV0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNuQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDaEhBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDcERBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDalJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdk1BO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNsQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDaEJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNiQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ2ZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMzREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2pGQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3pDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNsREE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNOQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ05BO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDTkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNkQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDVkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDMURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDakJBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0ZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNUQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDakJBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0ZBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0ZBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0ZBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0ZBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2RBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0ZBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0ZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUNuQkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNUQTtBQUFBO0FBQUE7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNGQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUNsQkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDVkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDTEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbkxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDcERBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDckJBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDVkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7QUN4SUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7OztBQ3ZFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hHQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNWQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNsRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNuSEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDckRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDM0RBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN0SEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDeEhBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzNvQkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQzVCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDN0tBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbEJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3ZIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN4QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNKQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDM0JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDakRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMzQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQ3ZGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3pLQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUM5SEE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbkJBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDSkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNsbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN2ZEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUMvbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzVCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDeEJBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1RBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUM5M0JBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDSkE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNiQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ2pEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDMUxBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzFQQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUM5RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDL0tBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7QUNBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ25OQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3JXQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ3RFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDckZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUMxTEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ2hLQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdFZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdlRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDL1BBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDOUxBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDaEJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDOVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdkJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN6SUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzVEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNwRkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDcldBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNwREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUEE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ2pEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDekhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1ZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzFIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDeENBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNqREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3BMQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDbEZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDcEdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQ2hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMzSkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ2hIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzNFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDL0JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN0aUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDakdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMxRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDcklBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN6RUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUN2R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNyQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDbkpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ3ZDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNqQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2ZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzlDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hUQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDM2hCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDM0ZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN2TEE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbkRBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUN2RUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2pXQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbkRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzNhQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMvVUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMvRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNKQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3ZQQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0pBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2pIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDNzFCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDOU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDZEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQzFCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDZkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ3JIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O0FDcklBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUM3Q0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2hCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN6REE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbEhBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0pBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDdEZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbE5BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNySUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDbkxBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDSEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7OztBIiwic291cmNlUm9vdCI6IiJ9